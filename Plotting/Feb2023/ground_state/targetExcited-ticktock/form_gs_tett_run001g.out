Rank =    0  Free Memory = 90000 MB
Rank =    1  Free Memory = 90000 MB
Rank =    2  Free Memory = 90000 MB
Rank =    3  Free Memory = 90000 MB
Rank =    4  Free Memory = 90000 MB
Rank =    5  Free Memory = 90000 MB
Rank =    6  Free Memory = 90000 MB
Rank =    7  Free Memory = 90000 MB
Rank =    8  Free Memory = 90000 MB
Rank =    9  Free Memory = 90000 MB
Rank =   10  Free Memory = 90000 MB
Rank =   11  Free Memory = 90000 MB
Rank =   12  Free Memory = 90000 MB
Rank =   13  Free Memory = 90000 MB
Rank =   14  Free Memory = 90000 MB
Rank =   15  Free Memory = 89984 MB
Rank =   16  Free Memory = 89984 MB
Rank =   17  Free Memory = 89984 MB
Rank =   18  Free Memory = 89984 MB
Rank =   19  Free Memory = 89984 MB
Rank =   20  Free Memory = 89984 MB
Rank =   21  Free Memory = 89984 MB
Rank =   22  Free Memory = 89984 MB
Rank =   23  Free Memory = 89984 MB
Rank =   24  Free Memory = 89984 MB
Rank =   25  Free Memory = 89984 MB
Rank =   26  Free Memory = 89984 MB
Rank =   27  Free Memory = 89984 MB
Rank =   28  Free Memory = 89984 MB
Rank =   29  Free Memory = 89984 MB
Rank =   30  Free Memory = 89984 MB
Rank =   31  Free Memory = 89984 MB
Rank =   32  Free Memory = 89517 MB
Rank =   33  Free Memory = 89517 MB
Rank =   34  Free Memory = 89517 MB
Rank =   35  Free Memory = 89517 MB
Rank =   36  Free Memory = 89517 MB
Rank =   37  Free Memory = 89517 MB
Rank =   38  Free Memory = 89517 MB
Rank =   39  Free Memory = 89517 MB
Rank =   40  Free Memory = 89517 MB
Rank =   41  Free Memory = 89517 MB
Rank =   42  Free Memory = 89517 MB
Rank =   43  Free Memory = 89517 MB
Rank =   44  Free Memory = 89517 MB
Rank =   45  Free Memory = 89517 MB
Rank =   46  Free Memory = 89517 MB
Rank =   47  Free Memory = 89517 MB
Rank =   48  Free Memory = 89517 MB
Rank =   49  Free Memory = 89517 MB
Rank =   50  Free Memory = 89517 MB
Rank =   51  Free Memory = 89517 MB
Rank =   52  Free Memory = 89516 MB
Rank =   53  Free Memory = 89516 MB
Rank =   54  Free Memory = 89516 MB
Rank =   55  Free Memory = 89516 MB
Rank =   56  Free Memory = 89516 MB
Rank =   57  Free Memory = 89516 MB
Rank =   58  Free Memory = 89516 MB
Rank =   59  Free Memory = 89516 MB
Rank =   60  Free Memory = 89516 MB
Rank =   61  Free Memory = 89516 MB
Rank =   62  Free Memory = 89516 MB
Rank =   63  Free Memory = 89516 MB
Rank =   64  Free Memory = 90513 MB
Rank =   65  Free Memory = 90513 MB
Rank =   66  Free Memory = 90513 MB
Rank =   67  Free Memory = 90513 MB
Rank =   68  Free Memory = 90513 MB
Rank =   69  Free Memory = 90513 MB
Rank =   70  Free Memory = 90513 MB
Rank =   71  Free Memory = 90513 MB
Rank =   72  Free Memory = 90513 MB
Rank =   73  Free Memory = 90513 MB
Rank =   74  Free Memory = 90512 MB
Rank =   75  Free Memory = 90512 MB
Rank =   76  Free Memory = 90512 MB
Rank =   77  Free Memory = 90512 MB
Rank =   78  Free Memory = 90512 MB
Rank =   79  Free Memory = 90512 MB
Rank =   80  Free Memory = 90512 MB
Rank =   81  Free Memory = 90512 MB
Rank =   82  Free Memory = 90512 MB
Rank =   83  Free Memory = 90512 MB
Rank =   84  Free Memory = 90512 MB
Rank =   85  Free Memory = 90512 MB
Rank =   86  Free Memory = 90512 MB
Rank =   87  Free Memory = 90512 MB
Rank =   88  Free Memory = 90512 MB
Rank =   89  Free Memory = 90512 MB
Rank =   90  Free Memory = 90512 MB
Rank =   91  Free Memory = 90512 MB
Rank =   92  Free Memory = 90512 MB
Rank =   93  Free Memory = 90512 MB
Rank =   94  Free Memory = 90512 MB
Rank =   95  Free Memory = 90512 MB
Rank =   96  Free Memory = 89196 MB
Rank =   97  Free Memory = 89196 MB
Rank =   98  Free Memory = 89196 MB
Rank =   99  Free Memory = 89196 MB
Rank =  100  Free Memory = 89196 MB
Rank =  101  Free Memory = 89196 MB
Rank =  102  Free Memory = 89196 MB
Rank =  103  Free Memory = 89196 MB
Rank =  104  Free Memory = 89196 MB
Rank =  105  Free Memory = 89196 MB
Rank =  106  Free Memory = 89196 MB
Rank =  107  Free Memory = 89196 MB
Rank =  108  Free Memory = 89196 MB
Rank =  109  Free Memory = 89196 MB
Rank =  110  Free Memory = 89196 MB
Rank =  111  Free Memory = 89196 MB
Rank =  112  Free Memory = 89196 MB
Rank =  113  Free Memory = 89196 MB
Rank =  114  Free Memory = 89196 MB
Rank =  115  Free Memory = 89196 MB
Rank =  116  Free Memory = 89196 MB
Rank =  117  Free Memory = 89196 MB
Rank =  118  Free Memory = 89196 MB
Rank =  119  Free Memory = 89196 MB
Rank =  120  Free Memory = 89196 MB
Rank =  121  Free Memory = 89196 MB
Rank =  122  Free Memory = 89196 MB
Rank =  123  Free Memory = 89196 MB
Rank =  124  Free Memory = 89196 MB
Rank =  125  Free Memory = 89196 MB
Rank =  126  Free Memory = 89196 MB
Rank =  127  Free Memory = 89196 MB
  Input file(s): opt_form_gs_tett_run001g.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_tett_run001g.xml

  Project = FORM
  date    = 2023-03-19 11:58:18 PDT
  host    = n0062.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 842

  Range of prime numbers to use as seeds over processors and threads = 6529-7669


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.624554e-01    1         1 OFF
     uu_1                 1.011863e-01    1         1 OFF
     uu_2                 3.659226e-03    1         1 OFF
     uu_3                -5.375161e-02    1         1 OFF
     uu_4                -8.591702e-02    1         1 OFF
     uu_5                -1.029990e-01    1         1 OFF
     uu_6                -1.108447e-01    1         1 OFF
     uu_7                -1.087609e-01    1         1 OFF
     uu_8                -9.325173e-02    1         1 OFF
     uu_9                -5.957390e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.378549e-01    1         1 OFF
     ud_1                 9.967815e-02    1         1 OFF
     ud_2                -1.443990e-02    1         1 OFF
     ud_3                -7.376538e-02    1         1 OFF
     ud_4                -1.061181e-01    1         1 OFF
     ud_5                -1.224040e-01    1         1 OFF
     ud_6                -1.277130e-01    1         1 OFF
     ud_7                -1.191873e-01    1         1 OFF
     ud_8                -9.272569e-02    1         1 OFF
     ud_9                -4.447679e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -4.563379e-01    1         1 OFF
     eC_1                -3.182912e-01    1         1 OFF
     eC_2                -6.732177e-02    1         1 OFF
     eC_3                 9.506706e-02    1         1 OFF
     eC_4                 1.375986e-01    1         1 OFF
     eC_5                 1.931335e-01    1         1 OFF
     eC_6                 2.098757e-01    1         1 OFF
     eC_7                 1.661996e-01    1         1 OFF
     eC_8                 3.840237e-02    1         1 OFF
     eC_9                 1.377137e-03    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -8.227972e-01    1         1 OFF
     eO_1                -5.297360e-01    1         1 OFF
     eO_2                -1.492259e-01    1         1 OFF
     eO_3                 1.025706e-01    1         1 OFF
     eO_4                 2.270539e-01    1         1 OFF
     eO_5                 3.212686e-01    1         1 OFF
     eO_6                 3.347758e-01    1         1 OFF
     eO_7                 3.060194e-01    1         1 OFF
     eO_8                 1.433530e-01    1         1 OFF
     eO_9                 3.830540e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.277008e-01    1         1 OFF
     eH1_1                -3.779999e-02    1         1 OFF
     eH1_2                -1.874707e-02    1         1 OFF
     eH1_3                -3.712827e-02    1         1 OFF
     eH1_4                -1.241675e-02    1         1 OFF
     eH1_5                 8.974315e-03    1         1 OFF
     eH1_6                 5.391205e-02    1         1 OFF
     eH1_7                 6.334551e-02    1         1 OFF
     eH1_8                 6.498479e-02    1         1 OFF
     eH1_9                 4.352531e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.183001e-01    1         1 OFF
     eH2_1                -2.576170e-02    1         1 OFF
     eH2_2                -1.319036e-02    1         1 OFF
     eH2_3                -3.560919e-02    1         1 OFF
     eH2_4                -1.653925e-02    1         1 OFF
     eH2_5                 7.920534e-03    1         1 OFF
     eH2_6                 4.215155e-02    1         1 OFF
     eH2_7                 4.045401e-02    1         1 OFF
     eH2_8                 5.493390e-02    1         1 OFF
     eH2_9                 5.404523e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.767113e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.4637e+00 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8218
    reference variance = 0.361287
====================================================
  Execution time = 2.8604e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4850e-01
  Total weights = 1.964444173e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434030285782
                                         uncertainty =       0.001897401024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434030285782
                                         uncertainty =       0.001897401024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466035051
  error estimate for blocks of size 2^( 2) =       0.000491902198
  error estimate for blocks of size 2^( 3) =       0.000515525031
  error estimate for blocks of size 2^( 4) =       0.000533037069
  error estimate for blocks of size 2^( 5) =       0.000544062477
  error estimate for blocks of size 2^( 6) =       0.000551706036
  error estimate for blocks of size 2^( 7) =       0.000556227323

      target function =      -0.746595817005
              le_mean =     -22.814378682404
             les_mean =     520.944369913892
             stat err =       0.000546258226
             autocorr =       1.373911684004
   target nu stat err =       0.000546258226
   target dn stat err =       0.003106754909
      target stat err =       0.002652391308
              std dev =       0.659073089679
             le_variance =       0.434377337540


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.281437868240e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746604375662       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746648969949       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746655071745       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746656516811       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746657082099       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746656848616       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746656872735       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746656862790       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746656870426       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746656889766       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.322049e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746604375662       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746617099651       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746618734241       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746619105079       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746619237851       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746619172714       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746619179288       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746619176992       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746619179124       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746619183227       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.439002e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746604375662       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746607673143       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746608088792       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746608181914       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746608214339       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746608197640       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746608199333       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746608198777       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746608199322       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746608200295       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.673174e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006767 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3156e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01 1.271286e-01                 3 1 ON  0
ci_02 -2.890160e-02                3 1 ON  1
ci_03 -2.895032e-02                3 1 ON  2
ci_04 2.686258e-02                 3 1 ON  3
ci_05 -2.198657e-02                3 1 ON  4
ci_06 -2.166783e-02                3 1 ON  5
ci_07 2.730339e-02                 3 1 ON  6
ci_08 -5.558050e-03                3 1 ON  7
ci_09 -8.976646e-03                3 1 ON  8
ci_10 -8.306722e-03                3 1 ON  9
ci_11 1.317452e-02                 3 1 ON  10
ci_12 6.845537e-03                 3 1 ON  11
ci_13 1.286059e-02                 3 1 ON  12
ci_14 1.276318e-02                 3 1 ON  13
ci_15 6.321523e-03                 3 1 ON  14
ci_16 6.442917e-03                 3 1 ON  15
ci_17 -7.192829e-03                3 1 ON  16
ci_18 -6.004240e-03                3 1 ON  17
ci_19 9.270605e-03                 3 1 ON  18
ci_20 6.489419e-03                 3 1 ON  19
ci_21 9.005437e-03                 3 1 ON  20
ci_22 8.340771e-03                 3 1 ON  21
ci_23 4.767424e-03                 3 1 ON  22
ci_24 4.097817e-03                 3 1 ON  23
ci_25 2.874969e-03                 3 1 ON  24
ci_26 3.143248e-03                 3 1 ON  25
ci_27 3.273450e-03                 3 1 ON  26
ci_28 1.945752e-03                 3 1 ON  27
ci_29 1.381991e-03                 3 1 ON  28
ci_30 -1.802170e-03                3 1 ON  29
ci_31 -6.175337e-04                3 1 ON  30
ci_32 -8.411564e-04                3 1 ON  31
ci_33 -1.448229e-03                3 1 ON  32
ci_34 1.144952e-03                 3 1 ON  33
ci_35 1.488181e-03                 3 1 ON  34
ci_36 -1.014814e-03                3 1 ON  35
ci_37 -1.047842e-03                3 1 ON  36
ci_38 -7.283028e-04                3 1 ON  37
ci_39 -6.170055e-04                3 1 ON  38
ci_40 -1.556893e-03                3 1 ON  39
ci_41 -1.185099e-03                3 1 ON  40
ci_42 -1.164896e-03                3 1 ON  41
ci_43 -2.458831e-03                3 1 ON  42
ci_44 -3.138816e-03                3 1 ON  43
ci_45 -5.144604e-04                3 1 ON  44
ci_46 -8.546708e-04                3 1 ON  45
ci_47 1.573043e-03                 3 1 ON  46
ci_48 1.402239e-03                 3 1 ON  47
ci_49 -1.050581e-03                3 1 ON  48
ci_50 -7.987413e-04                3 1 ON  49
ci_51 1.674494e-04                 3 1 ON  50
ci_52 8.713440e-05                 3 1 ON  51
ci_53 -6.863230e-04                3 1 ON  52
ci_54 -1.088211e-03                3 1 ON  53
ci_55 -6.323885e-04                3 1 ON  54
ci_56 2.588584e-03                 3 1 ON  55
ci_57 1.661380e-03                 3 1 ON  56
ci_58 -1.129253e-03                3 1 ON  57
ci_59 -1.420186e-03                3 1 ON  58
ci_60 5.367282e-04                 3 1 ON  59
ci_61 -1.100010e-04                3 1 ON  60
ci_62 -6.392044e-04                3 1 ON  61
ci_63 -7.931102e-04                3 1 ON  62
ci_64 -2.702654e-04                3 1 ON  63
ci_65 7.106824e-05                 3 1 ON  64
ci_66 -7.297780e-04                3 1 ON  65
ci_67 -9.227267e-04                3 1 ON  66
ci_68 -1.346299e-03                3 1 ON  67
ci_69 5.222393e-05                 3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.9192
    reference variance = 0.702212
====================================================
  Execution time = 2.5383e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4887e-01
  Total weights = 1.9643e+06
  Execution time = 3.5171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436145980567
                                         uncertainty =       0.001656588198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436145980567
                                         uncertainty =       0.001656588198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466984407
  error estimate for blocks of size 2^( 2) =       0.000492350999
  error estimate for blocks of size 2^( 3) =       0.000516554306
  error estimate for blocks of size 2^( 4) =       0.000534533408
  error estimate for blocks of size 2^( 5) =       0.000544788253
  error estimate for blocks of size 2^( 6) =       0.000551106293
  error estimate for blocks of size 2^( 7) =       0.000554612153

      target function =      -0.746138507546
              le_mean =     -22.814368140262
             les_mean =     520.944443622913
             stat err =       0.000546260027
             autocorr =       1.368340193766
   target nu stat err =       0.000546260027
   target dn stat err =       0.002470543480
      target stat err =       0.002138642464
              std dev =       0.660415681925
             le_variance =       0.436148872932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436084889660
                                         uncertainty =       0.001658147234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436084889660
                                         uncertainty =       0.001658147234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466951547
  error estimate for blocks of size 2^( 2) =       0.000492336939
  error estimate for blocks of size 2^( 3) =       0.000516559619
  error estimate for blocks of size 2^( 4) =       0.000534546423
  error estimate for blocks of size 2^( 5) =       0.000544807743
  error estimate for blocks of size 2^( 6) =       0.000551124021
  error estimate for blocks of size 2^( 7) =       0.000554647718

      target function =      -0.745452183776
              le_mean =     -22.814366325215
             les_mean =     520.945188172328
             stat err =       0.000546281476
             autocorr =       1.368640260522
   target nu stat err =       0.000546281476
   target dn stat err =       0.002531107034
      target stat err =       0.002183019443
              std dev =       0.660369211028
             le_variance =       0.436087494874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436106155798
                                         uncertainty =       0.001657382344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436106155798
                                         uncertainty =       0.001657382344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466963004
  error estimate for blocks of size 2^( 2) =       0.000492340521
  error estimate for blocks of size 2^( 3) =       0.000516554822
  error estimate for blocks of size 2^( 4) =       0.000534538747
  error estimate for blocks of size 2^( 5) =       0.000544796834
  error estimate for blocks of size 2^( 6) =       0.000551113853
  error estimate for blocks of size 2^( 7) =       0.000554629528

      target function =      -0.746299933690
              le_mean =     -22.814366028629
             les_mean =     520.944152950237
             stat err =       0.000546269741
             autocorr =       1.368514303567
   target nu stat err =       0.000546269741
   target dn stat err =       0.002446574404
      target stat err =       0.002120451670
              std dev =       0.660385413184
             le_variance =       0.436108893947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436140025959
                                         uncertainty =       0.001656679656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436140025959
                                         uncertainty =       0.001656679656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466981209
  error estimate for blocks of size 2^( 2) =       0.000492349219
  error estimate for blocks of size 2^( 3) =       0.000516553952
  error estimate for blocks of size 2^( 4) =       0.000534533656
  error estimate for blocks of size 2^( 5) =       0.000544788909
  error estimate for blocks of size 2^( 6) =       0.000551106839
  error estimate for blocks of size 2^( 7) =       0.000554613998

      target function =      -0.746185687243
              le_mean =     -22.814367734861
             les_mean =     520.944368309777
             stat err =       0.000546260850
             autocorr =       1.368363061935
   target nu stat err =       0.000546260850
   target dn stat err =       0.002465792723
      target stat err =       0.002135120189
              std dev =       0.660411159299
             le_variance =       0.436142899326


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746138507546        initial
     2.5000e-01     2.5000e+00             5.3220e-04        -0.745452183776
     1.0000e+00     1.0000e+01             1.4390e-04        -0.746299933690  <--
     4.0000e+00     4.0000e+01             3.6732e-05        -0.746185687243

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.2973e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01                 1.271286e-01 3 1  ON 0
ci_02                -2.890160e-02 3 1  ON 1
ci_03                -2.895032e-02 3 1  ON 2
ci_04                 2.686258e-02 3 1  ON 3
ci_05                -2.198657e-02 3 1  ON 4
ci_06                -2.166783e-02 3 1  ON 5
ci_07                 2.730339e-02 3 1  ON 6
ci_08                -5.558050e-03 3 1  ON 7
ci_09                -8.976646e-03 3 1  ON 8
ci_10                -8.306722e-03 3 1  ON 9
ci_11                 1.317452e-02 3 1  ON 10
ci_12                 6.845537e-03 3 1  ON 11
ci_13                 1.286059e-02 3 1  ON 12
ci_14                 1.276318e-02 3 1  ON 13
ci_15                 6.321523e-03 3 1  ON 14
ci_16                 6.442917e-03 3 1  ON 15
ci_17                -7.192829e-03 3 1  ON 16
ci_18                -6.004240e-03 3 1  ON 17
ci_19                 9.270605e-03 3 1  ON 18
ci_20                 6.489419e-03 3 1  ON 19
ci_21                 9.005437e-03 3 1  ON 20
ci_22                 8.340771e-03 3 1  ON 21
ci_23                 4.767424e-03 3 1  ON 22
ci_24                 4.097817e-03 3 1  ON 23
ci_25                 2.874969e-03 3 1  ON 24
ci_26                 3.143248e-03 3 1  ON 25
ci_27                 3.273450e-03 3 1  ON 26
ci_28                 1.945752e-03 3 1  ON 27
ci_29                 1.381991e-03 3 1  ON 28
ci_30                -1.802170e-03 3 1  ON 29
ci_31                -6.175337e-04 3 1  ON 30
ci_32                -8.411564e-04 3 1  ON 31
ci_33                -1.448229e-03 3 1  ON 32
ci_34                 1.144952e-03 3 1  ON 33
ci_35                 1.488181e-03 3 1  ON 34
ci_36                -1.014814e-03 3 1  ON 35
ci_37                -1.047842e-03 3 1  ON 36
ci_38                -7.283028e-04 3 1  ON 37
ci_39                -6.170055e-04 3 1  ON 38
ci_40                -1.556893e-03 3 1  ON 39
ci_41                -1.185099e-03 3 1  ON 40
ci_42                -1.164896e-03 3 1  ON 41
ci_43                -2.458831e-03 3 1  ON 42
ci_44                -3.138816e-03 3 1  ON 43
ci_45                -5.144604e-04 3 1  ON 44
ci_46                -8.546708e-04 3 1  ON 45
ci_47                 1.573043e-03 3 1  ON 46
ci_48                 1.402239e-03 3 1  ON 47
ci_49                -1.050581e-03 3 1  ON 48
ci_50                -7.987413e-04 3 1  ON 49
ci_51                 1.674494e-04 3 1  ON 50
ci_52                 8.713440e-05 3 1  ON 51
ci_53                -6.863230e-04 3 1  ON 52
ci_54                -1.088211e-03 3 1  ON 53
ci_55                -6.323885e-04 3 1  ON 54
ci_56                 2.588584e-03 3 1  ON 55
ci_57                 1.661380e-03 3 1  ON 56
ci_58                -1.129253e-03 3 1  ON 57
ci_59                -1.420186e-03 3 1  ON 58
ci_60                 5.367282e-04 3 1  ON 59
ci_61                -1.100010e-04 3 1  ON 60
ci_62                -6.392044e-04 3 1  ON 61
ci_63                -7.931102e-04 3 1  ON 62
ci_64                -2.702654e-04 3 1  ON 63
ci_65                 7.106824e-05 3 1  ON 64
ci_66                -7.297780e-04 3 1  ON 65
ci_67                -9.227267e-04 3 1  ON 66
ci_68                -1.346299e-03 3 1  ON 67
ci_69                 5.222393e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6135e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2871e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.734
    reference variance = 0.357785
====================================================
  Execution time = 2.6076e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5358e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4904e-01
  Total weights = 1.964364307e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5278e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437094279716
                                         uncertainty =       0.004666283549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437094279716
                                         uncertainty =       0.004666283549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467510956
  error estimate for blocks of size 2^( 2) =       0.000492948754
  error estimate for blocks of size 2^( 3) =       0.000516923987
  error estimate for blocks of size 2^( 4) =       0.000535238336
  error estimate for blocks of size 2^( 5) =       0.000546615892
  error estimate for blocks of size 2^( 6) =       0.000553969854
  error estimate for blocks of size 2^( 7) =       0.000560390950

      target function =      -0.746116973265
              le_mean =     -22.815197539290
             les_mean =     520.982283122744
             stat err =       0.000549053758
             autocorr =       1.379260032668
   target nu stat err =       0.000549053758
   target dn stat err =       0.005925043496
      target stat err =       0.004961478455
              std dev =       0.661160334193
             le_variance =       0.437132987510


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281519753929e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746148655591       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746199649463       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746205478862       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746206467169       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746207551986       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746207405786       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746207497146       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746207508536       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746207505823       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.611030e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746148655591       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746163208326       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746164776068       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746165032293       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746165305425       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746165259951       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746165281873       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746165283722       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746165283255       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.517569e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746148655591       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746152427210       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746152826328       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746152890872       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746152959068       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746152947095       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746152952508       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746152952903       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746152952803       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.873757e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.009952 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0612e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.269768e-01 3 1  ON 0
ci_02                -2.878697e-02 3 1  ON 1
ci_03                -2.889094e-02 3 1  ON 2
ci_04                 2.679557e-02 3 1  ON 3
ci_05                -2.189163e-02 3 1  ON 4
ci_06                -2.163493e-02 3 1  ON 5
ci_07                 2.724720e-02 3 1  ON 6
ci_08                -5.550319e-03 3 1  ON 7
ci_09                -8.937041e-03 3 1  ON 8
ci_10                -8.258645e-03 3 1  ON 9
ci_11                 1.319144e-02 3 1  ON 10
ci_12                 6.807393e-03 3 1  ON 11
ci_13                 1.287753e-02 3 1  ON 12
ci_14                 1.276153e-02 3 1  ON 13
ci_15                 6.312981e-03 3 1  ON 14
ci_16                 6.473772e-03 3 1  ON 15
ci_17                -7.112602e-03 3 1  ON 16
ci_18                -6.034825e-03 3 1  ON 17
ci_19                 9.295819e-03 3 1  ON 18
ci_20                 6.516695e-03 3 1  ON 19
ci_21                 8.995756e-03 3 1  ON 20
ci_22                 8.339481e-03 3 1  ON 21
ci_23                 4.790140e-03 3 1  ON 22
ci_24                 4.182754e-03 3 1  ON 23
ci_25                 2.859329e-03 3 1  ON 24
ci_26                 3.209926e-03 3 1  ON 25
ci_27                 3.238148e-03 3 1  ON 26
ci_28                 1.945428e-03 3 1  ON 27
ci_29                 1.454254e-03 3 1  ON 28
ci_30                -1.811512e-03 3 1  ON 29
ci_31                -5.892665e-04 3 1  ON 30
ci_32                -9.167421e-04 3 1  ON 31
ci_33                -1.417673e-03 3 1  ON 32
ci_34                 1.184510e-03 3 1  ON 33
ci_35                 1.419553e-03 3 1  ON 34
ci_36                -1.043904e-03 3 1  ON 35
ci_37                -9.975382e-04 3 1  ON 36
ci_38                -7.314200e-04 3 1  ON 37
ci_39                -6.402054e-04 3 1  ON 38
ci_40                -1.560781e-03 3 1  ON 39
ci_41                -1.158555e-03 3 1  ON 40
ci_42                -1.145927e-03 3 1  ON 41
ci_43                -2.425170e-03 3 1  ON 42
ci_44                -3.052522e-03 3 1  ON 43
ci_45                -4.952641e-04 3 1  ON 44
ci_46                -7.942673e-04 3 1  ON 45
ci_47                 1.596488e-03 3 1  ON 46
ci_48                 1.444114e-03 3 1  ON 47
ci_49                -1.071717e-03 3 1  ON 48
ci_50                -8.027588e-04 3 1  ON 49
ci_51                 1.670938e-04 3 1  ON 50
ci_52                 6.784418e-05 3 1  ON 51
ci_53                -6.948644e-04 3 1  ON 52
ci_54                -1.093913e-03 3 1  ON 53
ci_55                -6.375377e-04 3 1  ON 54
ci_56                 2.502851e-03 3 1  ON 55
ci_57                 1.703294e-03 3 1  ON 56
ci_58                -1.106461e-03 3 1  ON 57
ci_59                -1.421290e-03 3 1  ON 58
ci_60                 5.314532e-04 3 1  ON 59
ci_61                -1.144967e-04 3 1  ON 60
ci_62                -6.098072e-04 3 1  ON 61
ci_63                -7.767839e-04 3 1  ON 62
ci_64                -2.244471e-04 3 1  ON 63
ci_65                -1.233432e-05 3 1  ON 64
ci_66                -7.662722e-04 3 1  ON 65
ci_67                -8.708279e-04 3 1  ON 66
ci_68                -1.296129e-03 3 1  ON 67
ci_69                 8.727620e-06 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8913
    reference variance = 0.549564
====================================================
  Execution time = 2.5526e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4378e-01
  Total weights = 1.9643e+06
  Execution time = 3.5076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431016279169
                                         uncertainty =       0.001651439238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431016279169
                                         uncertainty =       0.001651439238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464257151
  error estimate for blocks of size 2^( 2) =       0.000489766153
  error estimate for blocks of size 2^( 3) =       0.000514222437
  error estimate for blocks of size 2^( 4) =       0.000533035003
  error estimate for blocks of size 2^( 5) =       0.000544158778
  error estimate for blocks of size 2^( 6) =       0.000550881518
  error estimate for blocks of size 2^( 7) =       0.000557129116

      target function =      -0.749969400699
              le_mean =     -22.814968320176
             les_mean =     520.967242020770
             stat err =       0.000546301104
             autocorr =       1.384672130244
   target nu stat err =       0.000546301104
   target dn stat err =       0.002431137004
      target stat err =       0.002130015532
              std dev =       0.656558760075
             le_variance =       0.431069405431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430939740886
                                         uncertainty =       0.001651669774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430939740886
                                         uncertainty =       0.001651669774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464215766
  error estimate for blocks of size 2^( 2) =       0.000489751948
  error estimate for blocks of size 2^( 3) =       0.000514233440
  error estimate for blocks of size 2^( 4) =       0.000533066270
  error estimate for blocks of size 2^( 5) =       0.000544200018
  error estimate for blocks of size 2^( 6) =       0.000550924278
  error estimate for blocks of size 2^( 7) =       0.000557162581

      target function =      -0.736899335850
              le_mean =     -22.814972722420
             les_mean =     520.983141240501
             stat err =       0.000546338287
             autocorr =       1.385107560736
   target nu stat err =       0.000546338287
   target dn stat err =       0.011969297899
      target stat err =       0.009718720857
              std dev =       0.656500232586
             le_variance =       0.430992555386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430965081603
                                         uncertainty =       0.001651555658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430965081603
                                         uncertainty =       0.001651555658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464229491
  error estimate for blocks of size 2^( 2) =       0.000489752697
  error estimate for blocks of size 2^( 3) =       0.000514222890
  error estimate for blocks of size 2^( 4) =       0.000533047926
  error estimate for blocks of size 2^( 5) =       0.000544174843
  error estimate for blocks of size 2^( 6) =       0.000550896469
  error estimate for blocks of size 2^( 7) =       0.000557139516

      target function =      -0.747352546323
              le_mean =     -22.814968253324
             les_mean =     520.970354700517
             stat err =       0.000546314689
             autocorr =       1.384906019266
   target nu stat err =       0.000546314689
   target dn stat err =       0.004211630542
      target stat err =       0.003562627304
              std dev =       0.656519641817
             le_variance =       0.431018040092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431008766788
                                         uncertainty =       0.001651416413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431008766788
                                         uncertainty =       0.001651416413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464253095
  error estimate for blocks of size 2^( 2) =       0.000489763915
  error estimate for blocks of size 2^( 3) =       0.000514222116
  error estimate for blocks of size 2^( 4) =       0.000533036370
  error estimate for blocks of size 2^( 5) =       0.000544160785
  error estimate for blocks of size 2^( 6) =       0.000550883547
  error estimate for blocks of size 2^( 7) =       0.000557130672

      target function =      -0.750298840827
              le_mean =     -22.814968200932
             les_mean =     520.966844488072
             stat err =       0.000546302843
             autocorr =       1.384705146524
   target nu stat err =       0.000546302843
   target dn stat err =       0.002380525255
      target stat err =       0.002091118092
              std dev =       0.656553023335
             le_variance =       0.431061872450


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749969400699        initial
     2.5000e-01     2.5000e+00             5.6110e-04        -0.736899335850
     1.0000e+00     1.0000e+01             1.5176e-04        -0.747352546323
     4.0000e+00     4.0000e+01             3.8738e-05        -0.750298840827  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.3122e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.270898e-01 3 1  ON 0
ci_02                -2.887193e-02 3 1  ON 1
ci_03                -2.893498e-02 3 1  ON 2
ci_04                 2.684519e-02 3 1  ON 3
ci_05                -2.196205e-02 3 1  ON 4
ci_06                -2.165928e-02 3 1  ON 5
ci_07                 2.728899e-02 3 1  ON 6
ci_08                -5.556093e-03 3 1  ON 7
ci_09                -8.966439e-03 3 1  ON 8
ci_10                -8.294392e-03 3 1  ON 9
ci_11                 1.317886e-02 3 1  ON 10
ci_12                 6.835668e-03 3 1  ON 11
ci_13                 1.286488e-02 3 1  ON 12
ci_14                 1.276274e-02 3 1  ON 13
ci_15                 6.319302e-03 3 1  ON 14
ci_16                 6.450869e-03 3 1  ON 15
ci_17                -7.172156e-03 3 1  ON 16
ci_18                -6.012115e-03 3 1  ON 17
ci_19                 9.277146e-03 3 1  ON 18
ci_20                 6.496470e-03 3 1  ON 19
ci_21                 9.002936e-03 3 1  ON 20
ci_22                 8.340437e-03 3 1  ON 21
ci_23                 4.773322e-03 3 1  ON 22
ci_24                 4.119510e-03 3 1  ON 23
ci_25                 2.870927e-03 3 1  ON 24
ci_26                 3.160426e-03 3 1  ON 25
ci_27                 3.264318e-03 3 1  ON 26
ci_28                 1.945715e-03 3 1  ON 27
ci_29                 1.400698e-03 3 1  ON 28
ci_30                -1.804623e-03 3 1  ON 29
ci_31                -6.103710e-04 3 1  ON 30
ci_32                -8.607829e-04 3 1  ON 31
ci_33                -1.440287e-03 3 1  ON 32
ci_34                 1.155164e-03 3 1  ON 33
ci_35                 1.470469e-03 3 1  ON 34
ci_36                -1.022363e-03 3 1  ON 35
ci_37                -1.034797e-03 3 1  ON 36
ci_38                -7.291396e-04 3 1  ON 37
ci_39                -6.230076e-04 3 1  ON 38
ci_40                -1.557915e-03 3 1  ON 39
ci_41                -1.178217e-03 3 1  ON 40
ci_42                -1.159957e-03 3 1  ON 41
ci_43                -2.450161e-03 3 1  ON 42
ci_44                -3.116578e-03 3 1  ON 43
ci_45                -5.094805e-04 3 1  ON 44
ci_46                -8.390077e-04 3 1  ON 45
ci_47                 1.579011e-03 3 1  ON 46
ci_48                 1.412936e-03 3 1  ON 47
ci_49                -1.056080e-03 3 1  ON 48
ci_50                -7.997931e-04 3 1  ON 49
ci_51                 1.673640e-04 3 1  ON 50
ci_52                 8.215247e-05 3 1  ON 51
ci_53                -6.885550e-04 3 1  ON 52
ci_54                -1.089690e-03 3 1  ON 53
ci_55                -6.337120e-04 3 1  ON 54
ci_56                 2.566325e-03 3 1  ON 55
ci_57                 1.672261e-03 3 1  ON 56
ci_58                -1.123369e-03 3 1  ON 57
ci_59                -1.420468e-03 3 1  ON 58
ci_60                 5.354290e-04 3 1  ON 59
ci_61                -1.111400e-04 3 1  ON 60
ci_62                -6.315539e-04 3 1  ON 61
ci_63                -7.888785e-04 3 1  ON 62
ci_64                -2.584107e-04 3 1  ON 63
ci_65                 4.945758e-05 3 1  ON 64
ci_66                -7.392402e-04 3 1  ON 65
ci_67                -9.092739e-04 3 1  ON 66
ci_68                -1.333337e-03 3 1  ON 67
ci_69                 4.097536e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3741e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2842e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7463
    reference variance = 0.278745
====================================================
  Execution time = 2.8006e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4812e-01
  Total weights = 1.964354811e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435589480779
                                         uncertainty =       0.001944077415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435589480779
                                         uncertainty =       0.001944077415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466619773
  error estimate for blocks of size 2^( 2) =       0.000491972501
  error estimate for blocks of size 2^( 3) =       0.000515227540
  error estimate for blocks of size 2^( 4) =       0.000532517998
  error estimate for blocks of size 2^( 5) =       0.000543735734
  error estimate for blocks of size 2^( 6) =       0.000547621320
  error estimate for blocks of size 2^( 7) =       0.000551870466

      target function =      -0.746909764739
              le_mean =     -22.815082845348
             les_mean =     520.976127570270
             stat err =       0.000543936380
             autocorr =       1.358845047705
   target nu stat err =       0.000543936380
   target dn stat err =       0.002589674935
      target stat err =       0.002239756551
              std dev =       0.659900011894
             le_variance =       0.435468025698


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281508284535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746915567614       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746931846023       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746933625410       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746933918505       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746934034594       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746934044401       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746934047865       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746934034780       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746934033041       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.508305e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746915567614       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746919784614       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746920238197       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746920311436       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746920340055       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746920342153       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746920342899       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746920339682       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746920339275       residual = 6.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.889653e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746915567614       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746916631497       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746916745445       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746916763748       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746916770874       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746916771376       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746916771555       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746916770755       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746916770655       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 9.801427e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.013146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2564e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.270634e-01 3 1  ON 0
ci_02                -2.887032e-02 3 1  ON 1
ci_03                -2.894878e-02 3 1  ON 2
ci_04                 2.683403e-02 3 1  ON 3
ci_05                -2.193933e-02 3 1  ON 4
ci_06                -2.162961e-02 3 1  ON 5
ci_07                 2.729100e-02 3 1  ON 6
ci_08                -5.551618e-03 3 1  ON 7
ci_09                -8.927542e-03 3 1  ON 8
ci_10                -8.286442e-03 3 1  ON 9
ci_11                 1.316496e-02 3 1  ON 10
ci_12                 6.822668e-03 3 1  ON 11
ci_13                 1.287839e-02 3 1  ON 12
ci_14                 1.276512e-02 3 1  ON 13
ci_15                 6.305879e-03 3 1  ON 14
ci_16                 6.454791e-03 3 1  ON 15
ci_17                -7.172079e-03 3 1  ON 16
ci_18                -6.012234e-03 3 1  ON 17
ci_19                 9.271593e-03 3 1  ON 18
ci_20                 6.495201e-03 3 1  ON 19
ci_21                 9.017466e-03 3 1  ON 20
ci_22                 8.348700e-03 3 1  ON 21
ci_23                 4.784828e-03 3 1  ON 22
ci_24                 4.117752e-03 3 1  ON 23
ci_25                 2.888890e-03 3 1  ON 24
ci_26                 3.160426e-03 3 1  ON 25
ci_27                 3.235354e-03 3 1  ON 26
ci_28                 1.959708e-03 3 1  ON 27
ci_29                 1.407447e-03 3 1  ON 28
ci_30                -1.786250e-03 3 1  ON 29
ci_31                -5.977949e-04 3 1  ON 30
ci_32                -8.565174e-04 3 1  ON 31
ci_33                -1.454550e-03 3 1  ON 32
ci_34                 1.134587e-03 3 1  ON 33
ci_35                 1.477118e-03 3 1  ON 34
ci_36                -1.035468e-03 3 1  ON 35
ci_37                -1.034810e-03 3 1  ON 36
ci_38                -7.274289e-04 3 1  ON 37
ci_39                -6.210424e-04 3 1  ON 38
ci_40                -1.554183e-03 3 1  ON 39
ci_41                -1.193634e-03 3 1  ON 40
ci_42                -1.155743e-03 3 1  ON 41
ci_43                -2.414621e-03 3 1  ON 42
ci_44                -3.110629e-03 3 1  ON 43
ci_45                -5.136903e-04 3 1  ON 44
ci_46                -8.413242e-04 3 1  ON 45
ci_47                 1.584518e-03 3 1  ON 46
ci_48                 1.413467e-03 3 1  ON 47
ci_49                -1.050891e-03 3 1  ON 48
ci_50                -7.938147e-04 3 1  ON 49
ci_51                 1.655501e-04 3 1  ON 50
ci_52                 8.312744e-05 3 1  ON 51
ci_53                -6.942100e-04 3 1  ON 52
ci_54                -1.091241e-03 3 1  ON 53
ci_55                -6.356880e-04 3 1  ON 54
ci_56                 2.553657e-03 3 1  ON 55
ci_57                 1.678388e-03 3 1  ON 56
ci_58                -1.118762e-03 3 1  ON 57
ci_59                -1.402801e-03 3 1  ON 58
ci_60                 5.544180e-04 3 1  ON 59
ci_61                -1.154660e-04 3 1  ON 60
ci_62                -6.262615e-04 3 1  ON 61
ci_63                -7.785139e-04 3 1  ON 62
ci_64                -2.594955e-04 3 1  ON 63
ci_65                 4.267615e-05 3 1  ON 64
ci_66                -7.371441e-04 3 1  ON 65
ci_67                -8.985084e-04 3 1  ON 66
ci_68                -1.319287e-03 3 1  ON 67
ci_69                 1.229128e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7677
    reference variance = 0.452635
====================================================
  Execution time = 2.5289e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5093e-01
  Total weights = 1.9644e+06
  Execution time = 3.5028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434943581022
                                         uncertainty =       0.002228713259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434943581022
                                         uncertainty =       0.002228713259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466311149
  error estimate for blocks of size 2^( 2) =       0.000492045917
  error estimate for blocks of size 2^( 3) =       0.000515214283
  error estimate for blocks of size 2^( 4) =       0.000532398950
  error estimate for blocks of size 2^( 5) =       0.000543684523
  error estimate for blocks of size 2^( 6) =       0.000549894696
  error estimate for blocks of size 2^( 7) =       0.000551732908

      target function =      -0.744513219057
              le_mean =     -22.814345933027
             les_mean =     520.945377407752
             stat err =       0.000544427769
             autocorr =       1.363103835183
   target nu stat err =       0.000544427769
   target dn stat err =       0.004478958298
      target stat err =       0.003750215253
              std dev =       0.659463550914
             le_variance =       0.434892174983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434940234810
                                         uncertainty =       0.002228190439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434940234810
                                         uncertainty =       0.002228190439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466309373
  error estimate for blocks of size 2^( 2) =       0.000492047150
  error estimate for blocks of size 2^( 3) =       0.000515218777
  error estimate for blocks of size 2^( 4) =       0.000532406188
  error estimate for blocks of size 2^( 5) =       0.000543693456
  error estimate for blocks of size 2^( 6) =       0.000549899584
  error estimate for blocks of size 2^( 7) =       0.000551733336

      target function =      -0.744461830317
              le_mean =     -22.814346324351
             les_mean =     520.945458836515
             stat err =       0.000544433141
             autocorr =       1.363141118829
   target nu stat err =       0.000544433141
   target dn stat err =       0.004337857773
      target stat err =       0.003634690884
              std dev =       0.659461039332
             le_variance =       0.434888862397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434941006774
                                         uncertainty =       0.002228458619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434941006774
                                         uncertainty =       0.002228458619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466309779
  error estimate for blocks of size 2^( 2) =       0.000492046132
  error estimate for blocks of size 2^( 3) =       0.000515216184
  error estimate for blocks of size 2^( 4) =       0.000532402329
  error estimate for blocks of size 2^( 5) =       0.000543688813
  error estimate for blocks of size 2^( 6) =       0.000549896936
  error estimate for blocks of size 2^( 7) =       0.000551732999

      target function =      -0.744572116932
              le_mean =     -22.814346071696
             les_mean =     520.945313212494
             stat err =       0.000544430269
             autocorr =       1.363124364289
   target nu stat err =       0.000544430269
   target dn stat err =       0.004402842865
      target stat err =       0.003688726558
              std dev =       0.659461613297
             le_variance =       0.434889619413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434943156437
                                         uncertainty =       0.002228682535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434943156437
                                         uncertainty =       0.002228682535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466310923
  error estimate for blocks of size 2^( 2) =       0.000492045895
  error estimate for blocks of size 2^( 3) =       0.000515214475
  error estimate for blocks of size 2^( 4) =       0.000532399329
  error estimate for blocks of size 2^( 5) =       0.000543685017
  error estimate for blocks of size 2^( 6) =       0.000549894943
  error estimate for blocks of size 2^( 7) =       0.000551732888

      target function =      -0.744506414781
              le_mean =     -22.814345936792
             les_mean =     520.945385910885
             stat err =       0.000544428044
             autocorr =       1.363106535502
   target nu stat err =       0.000544428044
   target dn stat err =       0.004469140191
      target stat err =       0.003742140408
              std dev =       0.659463230897
             le_variance =       0.434891752906


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744513219057        initial
     1.0000e+00     1.0000e+01             1.5083e-04        -0.744461830317
     4.0000e+00     4.0000e+01             3.8897e-05        -0.744572116932  <--
     1.6000e+01     1.6000e+02             9.8014e-06        -0.744506414781

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.2849e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.270634e-01 3 1  ON 0
ci_02                -2.887032e-02 3 1  ON 1
ci_03                -2.894878e-02 3 1  ON 2
ci_04                 2.683403e-02 3 1  ON 3
ci_05                -2.193933e-02 3 1  ON 4
ci_06                -2.162961e-02 3 1  ON 5
ci_07                 2.729100e-02 3 1  ON 6
ci_08                -5.551618e-03 3 1  ON 7
ci_09                -8.927542e-03 3 1  ON 8
ci_10                -8.286442e-03 3 1  ON 9
ci_11                 1.316496e-02 3 1  ON 10
ci_12                 6.822668e-03 3 1  ON 11
ci_13                 1.287839e-02 3 1  ON 12
ci_14                 1.276512e-02 3 1  ON 13
ci_15                 6.305879e-03 3 1  ON 14
ci_16                 6.454791e-03 3 1  ON 15
ci_17                -7.172079e-03 3 1  ON 16
ci_18                -6.012234e-03 3 1  ON 17
ci_19                 9.271593e-03 3 1  ON 18
ci_20                 6.495201e-03 3 1  ON 19
ci_21                 9.017466e-03 3 1  ON 20
ci_22                 8.348700e-03 3 1  ON 21
ci_23                 4.784828e-03 3 1  ON 22
ci_24                 4.117752e-03 3 1  ON 23
ci_25                 2.888890e-03 3 1  ON 24
ci_26                 3.160426e-03 3 1  ON 25
ci_27                 3.235354e-03 3 1  ON 26
ci_28                 1.959708e-03 3 1  ON 27
ci_29                 1.407447e-03 3 1  ON 28
ci_30                -1.786250e-03 3 1  ON 29
ci_31                -5.977949e-04 3 1  ON 30
ci_32                -8.565174e-04 3 1  ON 31
ci_33                -1.454550e-03 3 1  ON 32
ci_34                 1.134587e-03 3 1  ON 33
ci_35                 1.477118e-03 3 1  ON 34
ci_36                -1.035468e-03 3 1  ON 35
ci_37                -1.034810e-03 3 1  ON 36
ci_38                -7.274289e-04 3 1  ON 37
ci_39                -6.210424e-04 3 1  ON 38
ci_40                -1.554183e-03 3 1  ON 39
ci_41                -1.193634e-03 3 1  ON 40
ci_42                -1.155743e-03 3 1  ON 41
ci_43                -2.414621e-03 3 1  ON 42
ci_44                -3.110629e-03 3 1  ON 43
ci_45                -5.136903e-04 3 1  ON 44
ci_46                -8.413242e-04 3 1  ON 45
ci_47                 1.584518e-03 3 1  ON 46
ci_48                 1.413467e-03 3 1  ON 47
ci_49                -1.050891e-03 3 1  ON 48
ci_50                -7.938147e-04 3 1  ON 49
ci_51                 1.655501e-04 3 1  ON 50
ci_52                 8.312744e-05 3 1  ON 51
ci_53                -6.942100e-04 3 1  ON 52
ci_54                -1.091241e-03 3 1  ON 53
ci_55                -6.356880e-04 3 1  ON 54
ci_56                 2.553657e-03 3 1  ON 55
ci_57                 1.678388e-03 3 1  ON 56
ci_58                -1.118762e-03 3 1  ON 57
ci_59                -1.402801e-03 3 1  ON 58
ci_60                 5.544180e-04 3 1  ON 59
ci_61                -1.154660e-04 3 1  ON 60
ci_62                -6.262615e-04 3 1  ON 61
ci_63                -7.785139e-04 3 1  ON 62
ci_64                -2.594955e-04 3 1  ON 63
ci_65                 4.267615e-05 3 1  ON 64
ci_66                -7.371441e-04 3 1  ON 65
ci_67                -8.985084e-04 3 1  ON 66
ci_68                -1.319287e-03 3 1  ON 67
ci_69                 1.229128e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5420e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8886
    reference variance = 0.247291
====================================================
  Execution time = 2.6023e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5359e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4956e-01
  Total weights = 1.964448010e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436990080338
                                         uncertainty =       0.003950210697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436990080338
                                         uncertainty =       0.003950210697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467401243
  error estimate for blocks of size 2^( 2) =       0.000493133838
  error estimate for blocks of size 2^( 3) =       0.000516403069
  error estimate for blocks of size 2^( 4) =       0.000533810857
  error estimate for blocks of size 2^( 5) =       0.000545699572
  error estimate for blocks of size 2^( 6) =       0.000550731752
  error estimate for blocks of size 2^( 7) =       0.000555398619

      target function =      -0.745700655370
              le_mean =     -22.814358259675
             les_mean =     520.944503845564
             stat err =       0.000546410200
             autocorr =       1.366651771773
   target nu stat err =       0.000546410200
   target dn stat err =       0.004588734872
      target stat err =       0.003852301824
              std dev =       0.661005177619
             le_variance =       0.436927844839


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281435825968e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745719714020       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745741437734       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745743536249       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745744163757       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745744315397       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745744371644       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745744426184       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745744427546       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745744428224       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.925757e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745719714020       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745725338240       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745725873608       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745726031509       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745726068339       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745726081785       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745726095066       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745726095373       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745726095532       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 7.558263e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745719714020       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745721132697       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745721267220       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745721306753       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745721315888       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745721319210       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745721322507       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745721322581       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745721322620       residual = 2.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.905444e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.016320 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0553e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.269941e-01 3 1  ON 0
ci_02                -2.884655e-02 3 1  ON 1
ci_03                -2.887320e-02 3 1  ON 2
ci_04                 2.681911e-02 3 1  ON 3
ci_05                -2.195045e-02 3 1  ON 4
ci_06                -2.163107e-02 3 1  ON 5
ci_07                 2.728115e-02 3 1  ON 6
ci_08                -5.544747e-03 3 1  ON 7
ci_09                -8.927018e-03 3 1  ON 8
ci_10                -8.301881e-03 3 1  ON 9
ci_11                 1.316288e-02 3 1  ON 10
ci_12                 6.838066e-03 3 1  ON 11
ci_13                 1.287857e-02 3 1  ON 12
ci_14                 1.275767e-02 3 1  ON 13
ci_15                 6.298808e-03 3 1  ON 14
ci_16                 6.458410e-03 3 1  ON 15
ci_17                -7.187565e-03 3 1  ON 16
ci_18                -6.000096e-03 3 1  ON 17
ci_19                 9.273106e-03 3 1  ON 18
ci_20                 6.497984e-03 3 1  ON 19
ci_21                 9.023527e-03 3 1  ON 20
ci_22                 8.357534e-03 3 1  ON 21
ci_23                 4.781195e-03 3 1  ON 22
ci_24                 4.112295e-03 3 1  ON 23
ci_25                 2.883303e-03 3 1  ON 24
ci_26                 3.144086e-03 3 1  ON 25
ci_27                 3.234885e-03 3 1  ON 26
ci_28                 1.933553e-03 3 1  ON 27
ci_29                 1.413762e-03 3 1  ON 28
ci_30                -1.785454e-03 3 1  ON 29
ci_31                -5.935514e-04 3 1  ON 30
ci_32                -8.660445e-04 3 1  ON 31
ci_33                -1.461858e-03 3 1  ON 32
ci_34                 1.103192e-03 3 1  ON 33
ci_35                 1.484271e-03 3 1  ON 34
ci_36                -1.037882e-03 3 1  ON 35
ci_37                -1.036110e-03 3 1  ON 36
ci_38                -7.184060e-04 3 1  ON 37
ci_39                -6.183700e-04 3 1  ON 38
ci_40                -1.557137e-03 3 1  ON 39
ci_41                -1.196765e-03 3 1  ON 40
ci_42                -1.149941e-03 3 1  ON 41
ci_43                -2.371230e-03 3 1  ON 42
ci_44                -3.107976e-03 3 1  ON 43
ci_45                -5.089116e-04 3 1  ON 44
ci_46                -8.336117e-04 3 1  ON 45
ci_47                 1.586615e-03 3 1  ON 46
ci_48                 1.408907e-03 3 1  ON 47
ci_49                -1.055399e-03 3 1  ON 48
ci_50                -8.029298e-04 3 1  ON 49
ci_51                 1.626534e-04 3 1  ON 50
ci_52                 8.682259e-05 3 1  ON 51
ci_53                -6.979765e-04 3 1  ON 52
ci_54                -1.089484e-03 3 1  ON 53
ci_55                -6.357160e-04 3 1  ON 54
ci_56                 2.543196e-03 3 1  ON 55
ci_57                 1.680536e-03 3 1  ON 56
ci_58                -1.114510e-03 3 1  ON 57
ci_59                -1.414017e-03 3 1  ON 58
ci_60                 5.622757e-04 3 1  ON 59
ci_61                -1.165976e-04 3 1  ON 60
ci_62                -6.226755e-04 3 1  ON 61
ci_63                -7.676405e-04 3 1  ON 62
ci_64                -2.752531e-04 3 1  ON 63
ci_65                 4.659440e-05 3 1  ON 64
ci_66                -7.325831e-04 3 1  ON 65
ci_67                -8.948619e-04 3 1  ON 66
ci_68                -1.302336e-03 3 1  ON 67
ci_69                 3.356189e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8649
    reference variance = 0.591394
====================================================
  Execution time = 2.5316e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5312e-01
  Total weights = 1.9647e+06
  Execution time = 3.4895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434042799765
                                         uncertainty =       0.002661617693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434042799765
                                         uncertainty =       0.002661617693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465846016
  error estimate for blocks of size 2^( 2) =       0.000491241914
  error estimate for blocks of size 2^( 3) =       0.000515395106
  error estimate for blocks of size 2^( 4) =       0.000533302711
  error estimate for blocks of size 2^( 5) =       0.000544270373
  error estimate for blocks of size 2^( 6) =       0.000551446415
  error estimate for blocks of size 2^( 7) =       0.000555933505

      target function =      -0.742458756719
              le_mean =     -22.814937997721
             les_mean =     520.974815776971
             stat err =       0.000546238251
             autocorr =       1.374926384633
   target nu stat err =       0.000546238251
   target dn stat err =       0.008988308920
      target stat err =       0.007418400557
              std dev =       0.658805753913
             le_variance =       0.434025021389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433776405104
                                         uncertainty =       0.002485556548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433776405104
                                         uncertainty =       0.002485556548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465703110
  error estimate for blocks of size 2^( 2) =       0.000491114194
  error estimate for blocks of size 2^( 3) =       0.000515281373
  error estimate for blocks of size 2^( 4) =       0.000533198212
  error estimate for blocks of size 2^( 5) =       0.000544175798
  error estimate for blocks of size 2^( 6) =       0.000551350877
  error estimate for blocks of size 2^( 7) =       0.000555845044

      target function =      -0.743349842390
              le_mean =     -22.814941381244
             les_mean =     520.973905498317
             stat err =       0.000546142483
             autocorr =       1.375287972330
   target nu stat err =       0.000546142483
   target dn stat err =       0.008056835286
      target stat err =       0.006670843038
              std dev =       0.658603654053
             le_variance =       0.433758773132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433900749299
                                         uncertainty =       0.002566546141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433900749299
                                         uncertainty =       0.002566546141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465769820
  error estimate for blocks of size 2^( 2) =       0.000491173652
  error estimate for blocks of size 2^( 3) =       0.000515334130
  error estimate for blocks of size 2^( 4) =       0.000533246544
  error estimate for blocks of size 2^( 5) =       0.000544219358
  error estimate for blocks of size 2^( 6) =       0.000551394899
  error estimate for blocks of size 2^( 7) =       0.000555885733

      target function =      -0.742944653036
              le_mean =     -22.814939640359
             les_mean =     520.974309902953
             stat err =       0.000546186634
             autocorr =       1.375116353971
   target nu stat err =       0.000546186634
   target dn stat err =       0.008490519119
      target stat err =       0.007019452165
              std dev =       0.658697995836
             le_variance =       0.433883049718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434024185638
                                         uncertainty =       0.002649009054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434024185638
                                         uncertainty =       0.002649009054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465836032
  error estimate for blocks of size 2^( 2) =       0.000491232946
  error estimate for blocks of size 2^( 3) =       0.000515387068
  error estimate for blocks of size 2^( 4) =       0.000533295288
  error estimate for blocks of size 2^( 5) =       0.000544263606
  error estimate for blocks of size 2^( 6) =       0.000551439585
  error estimate for blocks of size 2^( 7) =       0.000555927165

      target function =      -0.742524273902
              le_mean =     -22.814938193845
             les_mean =     520.974746360594
             stat err =       0.000546231411
             autocorr =       1.374950887227
   target nu stat err =       0.000546231411
   target dn stat err =       0.008922922964
      target stat err =       0.007366082024
              std dev =       0.658791634477
             le_variance =       0.434006417658


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742458756719        initial
     1.0000e+00     1.0000e+01             2.9258e-04        -0.743349842390  <--
     4.0000e+00     4.0000e+01             7.5583e-05        -0.742944653036
     1.6000e+01     1.6000e+02             1.9054e-05        -0.742524273902

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.2781e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.267915e-01 3 1  ON 0
ci_02                -2.877835e-02 3 1  ON 1
ci_03                -2.865621e-02 3 1  ON 2
ci_04                 2.677655e-02 3 1  ON 3
ci_05                -2.198275e-02 3 1  ON 4
ci_06                -2.163581e-02 3 1  ON 5
ci_07                 2.725299e-02 3 1  ON 6
ci_08                -5.524976e-03 3 1  ON 7
ci_09                -8.925561e-03 3 1  ON 8
ci_10                -8.346508e-03 3 1  ON 9
ci_11                 1.315702e-02 3 1  ON 10
ci_12                 6.882112e-03 3 1  ON 11
ci_13                 1.287936e-02 3 1  ON 12
ci_14                 1.273595e-02 3 1  ON 13
ci_15                 6.278501e-03 3 1  ON 14
ci_16                 6.468871e-03 3 1  ON 15
ci_17                -7.232159e-03 3 1  ON 16
ci_18                -5.965260e-03 3 1  ON 17
ci_19                 9.277390e-03 3 1  ON 18
ci_20                 6.505923e-03 3 1  ON 19
ci_21                 9.041094e-03 3 1  ON 20
ci_22                 8.383124e-03 3 1  ON 21
ci_23                 4.770839e-03 3 1  ON 22
ci_24                 4.096416e-03 3 1  ON 23
ci_25                 2.867361e-03 3 1  ON 24
ci_26                 3.097129e-03 3 1  ON 25
ci_27                 3.233556e-03 3 1  ON 26
ci_28                 1.858652e-03 3 1  ON 27
ci_29                 1.431850e-03 3 1  ON 28
ci_30                -1.783189e-03 3 1  ON 29
ci_31                -5.812891e-04 3 1  ON 30
ci_32                -8.932370e-04 3 1  ON 31
ci_33                -1.482687e-03 3 1  ON 32
ci_34                 1.013251e-03 3 1  ON 33
ci_35                 1.504769e-03 3 1  ON 34
ci_36                -1.044779e-03 3 1  ON 35
ci_37                -1.039775e-03 3 1  ON 36
ci_38                -6.925687e-04 3 1  ON 37
ci_39                -6.106835e-04 3 1  ON 38
ci_40                -1.565467e-03 3 1  ON 39
ci_41                -1.205748e-03 3 1  ON 40
ci_42                -1.133445e-03 3 1  ON 41
ci_43                -2.246588e-03 3 1  ON 42
ci_44                -3.100404e-03 3 1  ON 43
ci_45                -4.952588e-04 3 1  ON 44
ci_46                -8.115548e-04 3 1  ON 45
ci_47                 1.592840e-03 3 1  ON 46
ci_48                 1.395897e-03 3 1  ON 47
ci_49                -1.068218e-03 3 1  ON 48
ci_50                -8.287968e-04 3 1  ON 49
ci_51                 1.543615e-04 3 1  ON 50
ci_52                 9.733669e-05 3 1  ON 51
ci_53                -7.086201e-04 3 1  ON 52
ci_54                -1.084393e-03 3 1  ON 53
ci_55                -6.357780e-04 3 1  ON 54
ci_56                 2.513367e-03 3 1  ON 55
ci_57                 1.686650e-03 3 1  ON 56
ci_58                -1.102360e-03 3 1  ON 57
ci_59                -1.446085e-03 3 1  ON 58
ci_60                 5.852458e-04 3 1  ON 59
ci_61                -1.199339e-04 3 1  ON 60
ci_62                -6.124102e-04 3 1  ON 61
ci_63                -7.366560e-04 3 1  ON 62
ci_64                -3.202620e-04 3 1  ON 63
ci_65                 5.781163e-05 3 1  ON 64
ci_66                -7.195602e-04 3 1  ON 65
ci_67                -8.844432e-04 3 1  ON 66
ci_68                -1.253721e-03 3 1  ON 67
ci_69                 9.428246e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2829e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8048
    reference variance = 0.319032
====================================================
  Execution time = 2.8008e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4498e-01
  Total weights = 1.964415805e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5529e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432077036258
                                         uncertainty =       0.002075434314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432077036258
                                         uncertainty =       0.002075434314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464808975
  error estimate for blocks of size 2^( 2) =       0.000490635923
  error estimate for blocks of size 2^( 3) =       0.000514766791
  error estimate for blocks of size 2^( 4) =       0.000532270502
  error estimate for blocks of size 2^( 5) =       0.000543345254
  error estimate for blocks of size 2^( 6) =       0.000548814297
  error estimate for blocks of size 2^( 7) =       0.000553653128

      target function =      -0.749531560636
              le_mean =     -22.814538873637
             les_mean =     520.948164068404
             stat err =       0.000544520795
             autocorr =       1.372397533940
   target nu stat err =       0.000544520795
   target dn stat err =       0.002726875753
      target stat err =       0.002364153146
              std dev =       0.657339156821
             le_variance =       0.432094767090


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281453887364e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749538035183       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749573387490       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749580429195       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749582465460       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749582869290       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749582906474       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749582941355       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749582937388       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749582954427       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749582943546       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 4.742238e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749538035183       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749548192469       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749550116627       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749550644635       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749550740099       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749550741576       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749550748899       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749550747570       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749550751534       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749550748863       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.263742e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749538035183       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749540672929       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749541165113       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749541298076       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749541321432       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749541321242       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749541322987       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749541322639       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749541323607       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749541322948       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.212524e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.019981 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2570e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.266827e-01 3 1  ON 0
ci_02                -2.877087e-02 3 1  ON 1
ci_03                -2.859284e-02 3 1  ON 2
ci_04                 2.674375e-02 3 1  ON 3
ci_05                -2.191174e-02 3 1  ON 4
ci_06                -2.152501e-02 3 1  ON 5
ci_07                 2.718239e-02 3 1  ON 6
ci_08                -5.517421e-03 3 1  ON 7
ci_09                -8.863266e-03 3 1  ON 8
ci_10                -8.336598e-03 3 1  ON 9
ci_11                 1.312535e-02 3 1  ON 10
ci_12                 6.917389e-03 3 1  ON 11
ci_13                 1.291467e-02 3 1  ON 12
ci_14                 1.270307e-02 3 1  ON 13
ci_15                 6.301282e-03 3 1  ON 14
ci_16                 6.460758e-03 3 1  ON 15
ci_17                -7.211635e-03 3 1  ON 16
ci_18                -5.958148e-03 3 1  ON 17
ci_19                 9.249412e-03 3 1  ON 18
ci_20                 6.465215e-03 3 1  ON 19
ci_21                 9.054562e-03 3 1  ON 20
ci_22                 8.399540e-03 3 1  ON 21
ci_23                 4.833845e-03 3 1  ON 22
ci_24                 4.101654e-03 3 1  ON 23
ci_25                 2.854431e-03 3 1  ON 24
ci_26                 3.039776e-03 3 1  ON 25
ci_27                 3.223089e-03 3 1  ON 26
ci_28                 1.811666e-03 3 1  ON 27
ci_29                 1.425759e-03 3 1  ON 28
ci_30                -1.768521e-03 3 1  ON 29
ci_31                -6.192838e-04 3 1  ON 30
ci_32                -9.400995e-04 3 1  ON 31
ci_33                -1.452509e-03 3 1  ON 32
ci_34                 1.022047e-03 3 1  ON 33
ci_35                 1.542722e-03 3 1  ON 34
ci_36                -1.066607e-03 3 1  ON 35
ci_37                -1.018284e-03 3 1  ON 36
ci_38                -6.666183e-04 3 1  ON 37
ci_39                -6.029188e-04 3 1  ON 38
ci_40                -1.494639e-03 3 1  ON 39
ci_41                -1.208272e-03 3 1  ON 40
ci_42                -1.118194e-03 3 1  ON 41
ci_43                -2.202300e-03 3 1  ON 42
ci_44                -3.041891e-03 3 1  ON 43
ci_45                -5.286473e-04 3 1  ON 44
ci_46                -7.786046e-04 3 1  ON 45
ci_47                 1.643006e-03 3 1  ON 46
ci_48                 1.436777e-03 3 1  ON 47
ci_49                -9.870386e-04 3 1  ON 48
ci_50                -8.121542e-04 3 1  ON 49
ci_51                 1.615505e-04 3 1  ON 50
ci_52                 9.504847e-05 3 1  ON 51
ci_53                -7.052971e-04 3 1  ON 52
ci_54                -1.078915e-03 3 1  ON 53
ci_55                -6.803340e-04 3 1  ON 54
ci_56                 2.507357e-03 3 1  ON 55
ci_57                 1.692710e-03 3 1  ON 56
ci_58                -1.165001e-03 3 1  ON 57
ci_59                -1.465772e-03 3 1  ON 58
ci_60                 5.562336e-04 3 1  ON 59
ci_61                -2.463082e-04 3 1  ON 60
ci_62                -5.857472e-04 3 1  ON 61
ci_63                -6.752375e-04 3 1  ON 62
ci_64                -3.131776e-04 3 1  ON 63
ci_65                 1.085716e-05 3 1  ON 64
ci_66                -6.794061e-04 3 1  ON 65
ci_67                -8.561072e-04 3 1  ON 66
ci_68                -1.243542e-03 3 1  ON 67
ci_69                 9.886183e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8086
    reference variance = 0.299145
====================================================
  Execution time = 2.5303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4553e-01
  Total weights = 1.9643e+06
  Execution time = 3.5139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434190274319
                                         uncertainty =       0.001720299005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434190274319
                                         uncertainty =       0.001720299005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465967383
  error estimate for blocks of size 2^( 2) =       0.000491972868
  error estimate for blocks of size 2^( 3) =       0.000515638602
  error estimate for blocks of size 2^( 4) =       0.000533540769
  error estimate for blocks of size 2^( 5) =       0.000544172636
  error estimate for blocks of size 2^( 6) =       0.000550295907
  error estimate for blocks of size 2^( 7) =       0.000549793526

      target function =      -0.748934081484
              le_mean =     -22.814586707706
             les_mean =     520.951063366936
             stat err =       0.000544450709
             autocorr =       1.365230868884
   target nu stat err =       0.000544450709
   target dn stat err =       0.002265069892
      target stat err =       0.001989884913
              std dev =       0.658977393137
             le_variance =       0.434251204666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434178145774
                                         uncertainty =       0.001717317632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434178145774
                                         uncertainty =       0.001717317632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465960894
  error estimate for blocks of size 2^( 2) =       0.000491984195
  error estimate for blocks of size 2^( 3) =       0.000515666412
  error estimate for blocks of size 2^( 4) =       0.000533580270
  error estimate for blocks of size 2^( 5) =       0.000544220082
  error estimate for blocks of size 2^( 6) =       0.000550337240
  error estimate for blocks of size 2^( 7) =       0.000549836259

      target function =      -0.748509905329
              le_mean =     -22.814590032984
             les_mean =     520.951722322088
             stat err =       0.000544493463
             autocorr =       1.365483320920
   target nu stat err =       0.000544493463
   target dn stat err =       0.002299685508
      target stat err =       0.002015318440
              std dev =       0.658968216516
             le_variance =       0.434239110378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434179928237
                                         uncertainty =       0.001718522288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434179928237
                                         uncertainty =       0.001718522288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465961849
  error estimate for blocks of size 2^( 2) =       0.000491977435
  error estimate for blocks of size 2^( 3) =       0.000515652424
  error estimate for blocks of size 2^( 4) =       0.000533561233
  error estimate for blocks of size 2^( 5) =       0.000544197586
  error estimate for blocks of size 2^( 6) =       0.000550317495
  error estimate for blocks of size 2^( 7) =       0.000549816092

      target function =      -0.748987395684
              le_mean =     -22.814587949208
             les_mean =     520.951056289484
             stat err =       0.000544473102
             autocorr =       1.365375607193
   target nu stat err =       0.000544473102
   target dn stat err =       0.002265444922
      target stat err =       0.001990465079
              std dev =       0.658969565924
             le_variance =       0.434240888814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434188397432
                                         uncertainty =       0.001720060252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434188397432
                                         uncertainty =       0.001720060252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465966379
  error estimate for blocks of size 2^( 2) =       0.000491973136
  error estimate for blocks of size 2^( 3) =       0.000515640194
  error estimate for blocks of size 2^( 4) =       0.000533543104
  error estimate for blocks of size 2^( 5) =       0.000544175156
  error estimate for blocks of size 2^( 6) =       0.000550298124
  error estimate for blocks of size 2^( 7) =       0.000549795595

      target function =      -0.746894564141
              le_mean =     -22.814586803442
             les_mean =     520.953504658475
             stat err =       0.000544452995
             autocorr =       1.365248216490
   target nu stat err =       0.000544452995
   target dn stat err =       0.003508293064
      target stat err =       0.002981031025
              std dev =       0.658975972489
             le_variance =       0.434249332317


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748934081484        initial
     2.5000e-01     2.5000e+00             4.7422e-04        -0.748509905329
     1.0000e+00     1.0000e+01             1.2637e-04        -0.748987395684  <--
     4.0000e+00     4.0000e+01             3.2125e-05        -0.746894564141

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.2880e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.266827e-01 3 1  ON 0
ci_02                -2.877087e-02 3 1  ON 1
ci_03                -2.859284e-02 3 1  ON 2
ci_04                 2.674375e-02 3 1  ON 3
ci_05                -2.191174e-02 3 1  ON 4
ci_06                -2.152501e-02 3 1  ON 5
ci_07                 2.718239e-02 3 1  ON 6
ci_08                -5.517421e-03 3 1  ON 7
ci_09                -8.863266e-03 3 1  ON 8
ci_10                -8.336598e-03 3 1  ON 9
ci_11                 1.312535e-02 3 1  ON 10
ci_12                 6.917389e-03 3 1  ON 11
ci_13                 1.291467e-02 3 1  ON 12
ci_14                 1.270307e-02 3 1  ON 13
ci_15                 6.301282e-03 3 1  ON 14
ci_16                 6.460758e-03 3 1  ON 15
ci_17                -7.211635e-03 3 1  ON 16
ci_18                -5.958148e-03 3 1  ON 17
ci_19                 9.249412e-03 3 1  ON 18
ci_20                 6.465215e-03 3 1  ON 19
ci_21                 9.054562e-03 3 1  ON 20
ci_22                 8.399540e-03 3 1  ON 21
ci_23                 4.833845e-03 3 1  ON 22
ci_24                 4.101654e-03 3 1  ON 23
ci_25                 2.854431e-03 3 1  ON 24
ci_26                 3.039776e-03 3 1  ON 25
ci_27                 3.223089e-03 3 1  ON 26
ci_28                 1.811666e-03 3 1  ON 27
ci_29                 1.425759e-03 3 1  ON 28
ci_30                -1.768521e-03 3 1  ON 29
ci_31                -6.192838e-04 3 1  ON 30
ci_32                -9.400995e-04 3 1  ON 31
ci_33                -1.452509e-03 3 1  ON 32
ci_34                 1.022047e-03 3 1  ON 33
ci_35                 1.542722e-03 3 1  ON 34
ci_36                -1.066607e-03 3 1  ON 35
ci_37                -1.018284e-03 3 1  ON 36
ci_38                -6.666183e-04 3 1  ON 37
ci_39                -6.029188e-04 3 1  ON 38
ci_40                -1.494639e-03 3 1  ON 39
ci_41                -1.208272e-03 3 1  ON 40
ci_42                -1.118194e-03 3 1  ON 41
ci_43                -2.202300e-03 3 1  ON 42
ci_44                -3.041891e-03 3 1  ON 43
ci_45                -5.286473e-04 3 1  ON 44
ci_46                -7.786046e-04 3 1  ON 45
ci_47                 1.643006e-03 3 1  ON 46
ci_48                 1.436777e-03 3 1  ON 47
ci_49                -9.870386e-04 3 1  ON 48
ci_50                -8.121542e-04 3 1  ON 49
ci_51                 1.615505e-04 3 1  ON 50
ci_52                 9.504847e-05 3 1  ON 51
ci_53                -7.052971e-04 3 1  ON 52
ci_54                -1.078915e-03 3 1  ON 53
ci_55                -6.803340e-04 3 1  ON 54
ci_56                 2.507357e-03 3 1  ON 55
ci_57                 1.692710e-03 3 1  ON 56
ci_58                -1.165001e-03 3 1  ON 57
ci_59                -1.465772e-03 3 1  ON 58
ci_60                 5.562336e-04 3 1  ON 59
ci_61                -2.463082e-04 3 1  ON 60
ci_62                -5.857472e-04 3 1  ON 61
ci_63                -6.752375e-04 3 1  ON 62
ci_64                -3.131776e-04 3 1  ON 63
ci_65                 1.085716e-05 3 1  ON 64
ci_66                -6.794061e-04 3 1  ON 65
ci_67                -8.561072e-04 3 1  ON 66
ci_68                -1.243542e-03 3 1  ON 67
ci_69                 9.886183e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5457e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.828
    reference variance = 0.493651
====================================================
  Execution time = 2.5947e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5179e-01
  Total weights = 1.964482004e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439385316776
                                         uncertainty =       0.003559906804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439385316776
                                         uncertainty =       0.003559906804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468763088
  error estimate for blocks of size 2^( 2) =       0.000494034860
  error estimate for blocks of size 2^( 3) =       0.000517747124
  error estimate for blocks of size 2^( 4) =       0.000534845704
  error estimate for blocks of size 2^( 5) =       0.000545677792
  error estimate for blocks of size 2^( 6) =       0.000552593511
  error estimate for blocks of size 2^( 7) =       0.000554977451

      target function =      -0.743862211812
              le_mean =     -22.814787005184
             les_mean =     520.966293182940
             stat err =       0.000547023614
             autocorr =       1.361774935333
   target nu stat err =       0.000547023614
   target dn stat err =       0.004157508662
      target stat err =       0.003485091404
              std dev =       0.662931116647
             le_variance =       0.439477665419


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281478700518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743877683944       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743937222907       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743938094658       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743933753275       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743932134315       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743935438166       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743936449193       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743936328599       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743936048086       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743935800377       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743935803629       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.432405e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743877683944       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743894703714       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743894630949       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743893391287       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743893057875       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743893908687       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743894112116       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743894067477       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743893993850       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743893945220       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743893951159       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.815003e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743877683944       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743882097124       residual = 5.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743882053779       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743881733707       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743881656871       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743881870272       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743881917361       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743881905256       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743881886824       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743881875641       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743881877401       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 9.696658e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025207 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0499e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.265016e-01 3 1  ON 0
ci_02                -2.871840e-02 3 1  ON 1
ci_03                -2.856508e-02 3 1  ON 2
ci_04                 2.661271e-02 3 1  ON 3
ci_05                -2.187632e-02 3 1  ON 4
ci_06                -2.154273e-02 3 1  ON 5
ci_07                 2.710168e-02 3 1  ON 6
ci_08                -5.456736e-03 3 1  ON 7
ci_09                -8.842308e-03 3 1  ON 8
ci_10                -8.363863e-03 3 1  ON 9
ci_11                 1.311059e-02 3 1  ON 10
ci_12                 6.948264e-03 3 1  ON 11
ci_13                 1.303874e-02 3 1  ON 12
ci_14                 1.252719e-02 3 1  ON 13
ci_15                 6.372308e-03 3 1  ON 14
ci_16                 6.263827e-03 3 1  ON 15
ci_17                -7.198904e-03 3 1  ON 16
ci_18                -6.024443e-03 3 1  ON 17
ci_19                 9.257709e-03 3 1  ON 18
ci_20                 6.518985e-03 3 1  ON 19
ci_21                 8.966885e-03 3 1  ON 20
ci_22                 8.288972e-03 3 1  ON 21
ci_23                 4.852444e-03 3 1  ON 22
ci_24                 4.086651e-03 3 1  ON 23
ci_25                 2.863718e-03 3 1  ON 24
ci_26                 3.086079e-03 3 1  ON 25
ci_27                 3.185097e-03 3 1  ON 26
ci_28                 1.755703e-03 3 1  ON 27
ci_29                 1.455085e-03 3 1  ON 28
ci_30                -1.778657e-03 3 1  ON 29
ci_31                -4.925170e-04 3 1  ON 30
ci_32                -9.486160e-04 3 1  ON 31
ci_33                -1.370794e-03 3 1  ON 32
ci_34                 1.098334e-03 3 1  ON 33
ci_35                 1.541807e-03 3 1  ON 34
ci_36                -1.076515e-03 3 1  ON 35
ci_37                -1.049908e-03 3 1  ON 36
ci_38                -6.345667e-04 3 1  ON 37
ci_39                -6.045465e-04 3 1  ON 38
ci_40                -1.528334e-03 3 1  ON 39
ci_41                -1.186493e-03 3 1  ON 40
ci_42                -1.176165e-03 3 1  ON 41
ci_43                -2.259831e-03 3 1  ON 42
ci_44                -2.993994e-03 3 1  ON 43
ci_45                -5.582127e-04 3 1  ON 44
ci_46                -7.369610e-04 3 1  ON 45
ci_47                 1.562089e-03 3 1  ON 46
ci_48                 1.418056e-03 3 1  ON 47
ci_49                -9.598990e-04 3 1  ON 48
ci_50                -7.632515e-04 3 1  ON 49
ci_51                 1.269241e-04 3 1  ON 50
ci_52                 1.810425e-04 3 1  ON 51
ci_53                -7.047017e-04 3 1  ON 52
ci_54                -1.080372e-03 3 1  ON 53
ci_55                -6.620170e-04 3 1  ON 54
ci_56                 2.501700e-03 3 1  ON 55
ci_57                 1.712992e-03 3 1  ON 56
ci_58                -1.157579e-03 3 1  ON 57
ci_59                -1.431163e-03 3 1  ON 58
ci_60                 1.747333e-04 3 1  ON 59
ci_61                -2.371934e-04 3 1  ON 60
ci_62                -5.529572e-04 3 1  ON 61
ci_63                -6.346612e-04 3 1  ON 62
ci_64                -3.466333e-04 3 1  ON 63
ci_65                 8.914708e-06 3 1  ON 64
ci_66                -6.619828e-04 3 1  ON 65
ci_67                -8.568745e-04 3 1  ON 66
ci_68                -1.184664e-03 3 1  ON 67
ci_69                 9.423064e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8142
    reference variance = 0.437301
====================================================
  Execution time = 2.5334e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5636e-01
  Total weights = 1.9646e+06
  Execution time = 3.5056e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436976905945
                                         uncertainty =       0.003459626042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436976905945
                                         uncertainty =       0.003459626042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467472750
  error estimate for blocks of size 2^( 2) =       0.000493011216
  error estimate for blocks of size 2^( 3) =       0.000516855113
  error estimate for blocks of size 2^( 4) =       0.000534921533
  error estimate for blocks of size 2^( 5) =       0.000545173205
  error estimate for blocks of size 2^( 6) =       0.000553033371
  error estimate for blocks of size 2^( 7) =       0.000556728400

      target function =      -0.739726245133
              le_mean =     -22.814656094834
             les_mean =     520.965289999214
             stat err =       0.000547464127
             autocorr =       1.371509231630
   target nu stat err =       0.000547464127
   target dn stat err =       0.008970259336
      target stat err =       0.007346409124
              std dev =       0.661106302566
             le_variance =       0.437061543293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436798105294
                                         uncertainty =       0.003292922280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436798105294
                                         uncertainty =       0.003292922280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467378197
  error estimate for blocks of size 2^( 2) =       0.000492927253
  error estimate for blocks of size 2^( 3) =       0.000516792698
  error estimate for blocks of size 2^( 4) =       0.000534866586
  error estimate for blocks of size 2^( 5) =       0.000545118690
  error estimate for blocks of size 2^( 6) =       0.000552897898
  error estimate for blocks of size 2^( 7) =       0.000556610885

      target function =      -0.286662696533
              le_mean =     -22.814659239783
             les_mean =     521.915194902248
             stat err =       0.000547373514
             autocorr =       1.371610059775
   target nu stat err =       0.000547373514
   target dn stat err =       0.947109139858
      target stat err =       0.146278179545
              std dev =       0.660972584720
             le_variance =       0.436884757752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436783993472
                                         uncertainty =       0.003358713572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436783993472
                                         uncertainty =       0.003358713572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467370148
  error estimate for blocks of size 2^( 2) =       0.000492924893
  error estimate for blocks of size 2^( 3) =       0.000516782585
  error estimate for blocks of size 2^( 4) =       0.000534856175
  error estimate for blocks of size 2^( 5) =       0.000545112796
  error estimate for blocks of size 2^( 6) =       0.000552970126
  error estimate for blocks of size 2^( 7) =       0.000556669035

      target function =      -0.739760745288
              le_mean =     -22.814652141660
             les_mean =     520.965075403989
             stat err =       0.000547402033
             autocorr =       1.371800236895
   target nu stat err =       0.000547402033
   target dn stat err =       0.008557757330
      target stat err =       0.007011461780
              std dev =       0.660961201665
             le_variance =       0.436869710106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436949934907
                                         uncertainty =       0.003446031807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436949934907
                                         uncertainty =       0.003446031807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467458394
  error estimate for blocks of size 2^( 2) =       0.000492998980
  error estimate for blocks of size 2^( 3) =       0.000516844552
  error estimate for blocks of size 2^( 4) =       0.000534911885
  error estimate for blocks of size 2^( 5) =       0.000545163475
  error estimate for blocks of size 2^( 6) =       0.000553022271
  error estimate for blocks of size 2^( 7) =       0.000556717376

      target function =      -0.739608961487
              le_mean =     -22.814655212766
             les_mean =     520.965394593226
             stat err =       0.000547453752
             autocorr =       1.371541483301
   target nu stat err =       0.000547453752
   target dn stat err =       0.008915563792
      target stat err =       0.007299591811
              std dev =       0.661086000454
             le_variance =       0.437034699997


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739726245133        initial
     2.5000e-01     2.5000e+00             1.4324e-03        -0.286662696533
     1.0000e+00     1.0000e+01             3.8150e-04        -0.739760745288  <--
     4.0000e+00     4.0000e+01             9.6967e-05        -0.739608961487

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.2913e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.265016e-01 3 1  ON 0
ci_02                -2.871840e-02 3 1  ON 1
ci_03                -2.856508e-02 3 1  ON 2
ci_04                 2.661271e-02 3 1  ON 3
ci_05                -2.187632e-02 3 1  ON 4
ci_06                -2.154273e-02 3 1  ON 5
ci_07                 2.710168e-02 3 1  ON 6
ci_08                -5.456736e-03 3 1  ON 7
ci_09                -8.842308e-03 3 1  ON 8
ci_10                -8.363863e-03 3 1  ON 9
ci_11                 1.311059e-02 3 1  ON 10
ci_12                 6.948264e-03 3 1  ON 11
ci_13                 1.303874e-02 3 1  ON 12
ci_14                 1.252719e-02 3 1  ON 13
ci_15                 6.372308e-03 3 1  ON 14
ci_16                 6.263827e-03 3 1  ON 15
ci_17                -7.198904e-03 3 1  ON 16
ci_18                -6.024443e-03 3 1  ON 17
ci_19                 9.257709e-03 3 1  ON 18
ci_20                 6.518985e-03 3 1  ON 19
ci_21                 8.966885e-03 3 1  ON 20
ci_22                 8.288972e-03 3 1  ON 21
ci_23                 4.852444e-03 3 1  ON 22
ci_24                 4.086651e-03 3 1  ON 23
ci_25                 2.863718e-03 3 1  ON 24
ci_26                 3.086079e-03 3 1  ON 25
ci_27                 3.185097e-03 3 1  ON 26
ci_28                 1.755703e-03 3 1  ON 27
ci_29                 1.455085e-03 3 1  ON 28
ci_30                -1.778657e-03 3 1  ON 29
ci_31                -4.925170e-04 3 1  ON 30
ci_32                -9.486160e-04 3 1  ON 31
ci_33                -1.370794e-03 3 1  ON 32
ci_34                 1.098334e-03 3 1  ON 33
ci_35                 1.541807e-03 3 1  ON 34
ci_36                -1.076515e-03 3 1  ON 35
ci_37                -1.049908e-03 3 1  ON 36
ci_38                -6.345667e-04 3 1  ON 37
ci_39                -6.045465e-04 3 1  ON 38
ci_40                -1.528334e-03 3 1  ON 39
ci_41                -1.186493e-03 3 1  ON 40
ci_42                -1.176165e-03 3 1  ON 41
ci_43                -2.259831e-03 3 1  ON 42
ci_44                -2.993994e-03 3 1  ON 43
ci_45                -5.582127e-04 3 1  ON 44
ci_46                -7.369610e-04 3 1  ON 45
ci_47                 1.562089e-03 3 1  ON 46
ci_48                 1.418056e-03 3 1  ON 47
ci_49                -9.598990e-04 3 1  ON 48
ci_50                -7.632515e-04 3 1  ON 49
ci_51                 1.269241e-04 3 1  ON 50
ci_52                 1.810425e-04 3 1  ON 51
ci_53                -7.047017e-04 3 1  ON 52
ci_54                -1.080372e-03 3 1  ON 53
ci_55                -6.620170e-04 3 1  ON 54
ci_56                 2.501700e-03 3 1  ON 55
ci_57                 1.712992e-03 3 1  ON 56
ci_58                -1.157579e-03 3 1  ON 57
ci_59                -1.431163e-03 3 1  ON 58
ci_60                 1.747333e-04 3 1  ON 59
ci_61                -2.371934e-04 3 1  ON 60
ci_62                -5.529572e-04 3 1  ON 61
ci_63                -6.346612e-04 3 1  ON 62
ci_64                -3.466333e-04 3 1  ON 63
ci_65                 8.914708e-06 3 1  ON 64
ci_66                -6.619828e-04 3 1  ON 65
ci_67                -8.568745e-04 3 1  ON 66
ci_68                -1.184664e-03 3 1  ON 67
ci_69                 9.423064e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3419e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.82
    reference variance = 0.352939
====================================================
  Execution time = 2.7693e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4595e-01
  Total weights = 1.964296596e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432813960907
                                         uncertainty =       0.002030847946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432813960907
                                         uncertainty =       0.002030847946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465174818
  error estimate for blocks of size 2^( 2) =       0.000490812449
  error estimate for blocks of size 2^( 3) =       0.000514966894
  error estimate for blocks of size 2^( 4) =       0.000533305829
  error estimate for blocks of size 2^( 5) =       0.000544090126
  error estimate for blocks of size 2^( 6) =       0.000550532695
  error estimate for blocks of size 2^( 7) =       0.000551863338

      target function =      -0.748715741046
              le_mean =     -22.813916738748
             les_mean =     520.920744172673
             stat err =       0.000544947997
             autocorr =       1.372390581611
   target nu stat err =       0.000544947997
   target dn stat err =       0.003300330942
      target stat err =       0.002822560887
              std dev =       0.657856536246
             le_variance =       0.432775222281


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281391673875e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748725421057       residual = 9.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748753904621       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748760455572       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748761915961       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748762292116       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748762439274       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748762339591       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748762279309       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748762226287       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748762229366       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.354826e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748725421057       residual = 9.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748733557934       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748735341265       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748735720166       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748735810964       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748735840141       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748735812410       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748735798237       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748735786778       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748735787588       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.498885e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748725421057       residual = 9.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748727530515       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748727986213       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748728081660       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748728104019       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748728110728       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748728103637       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748728100177       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748728097445       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748728097648       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.862699e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028899 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2233e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.264094e-01 3 1  ON 0
ci_02                -2.869405e-02 3 1  ON 1
ci_03                -2.849706e-02 3 1  ON 2
ci_04                 2.655730e-02 3 1  ON 3
ci_05                -2.173667e-02 3 1  ON 4
ci_06                -2.153454e-02 3 1  ON 5
ci_07                 2.704765e-02 3 1  ON 6
ci_08                -5.483068e-03 3 1  ON 7
ci_09                -8.826338e-03 3 1  ON 8
ci_10                -8.346825e-03 3 1  ON 9
ci_11                 1.308374e-02 3 1  ON 10
ci_12                 6.903859e-03 3 1  ON 11
ci_13                 1.305741e-02 3 1  ON 12
ci_14                 1.254678e-02 3 1  ON 13
ci_15                 6.374835e-03 3 1  ON 14
ci_16                 6.270075e-03 3 1  ON 15
ci_17                -7.049015e-03 3 1  ON 16
ci_18                -6.018389e-03 3 1  ON 17
ci_19                 9.218064e-03 3 1  ON 18
ci_20                 6.516486e-03 3 1  ON 19
ci_21                 8.975424e-03 3 1  ON 20
ci_22                 8.234417e-03 3 1  ON 21
ci_23                 4.874322e-03 3 1  ON 22
ci_24                 4.109921e-03 3 1  ON 23
ci_25                 2.872210e-03 3 1  ON 24
ci_26                 3.141684e-03 3 1  ON 25
ci_27                 3.191560e-03 3 1  ON 26
ci_28                 1.715630e-03 3 1  ON 27
ci_29                 1.484543e-03 3 1  ON 28
ci_30                -1.817023e-03 3 1  ON 29
ci_31                -4.810765e-04 3 1  ON 30
ci_32                -9.327278e-04 3 1  ON 31
ci_33                -1.379917e-03 3 1  ON 32
ci_34                 1.090289e-03 3 1  ON 33
ci_35                 1.518543e-03 3 1  ON 34
ci_36                -1.060096e-03 3 1  ON 35
ci_37                -1.040139e-03 3 1  ON 36
ci_38                -6.102548e-04 3 1  ON 37
ci_39                -6.213288e-04 3 1  ON 38
ci_40                -1.530488e-03 3 1  ON 39
ci_41                -1.180310e-03 3 1  ON 40
ci_42                -1.225547e-03 3 1  ON 41
ci_43                -2.204295e-03 3 1  ON 42
ci_44                -2.925962e-03 3 1  ON 43
ci_45                -5.141635e-04 3 1  ON 44
ci_46                -7.625192e-04 3 1  ON 45
ci_47                 1.622921e-03 3 1  ON 46
ci_48                 1.388192e-03 3 1  ON 47
ci_49                -9.553804e-04 3 1  ON 48
ci_50                -7.857353e-04 3 1  ON 49
ci_51                 1.263730e-04 3 1  ON 50
ci_52                 1.686244e-04 3 1  ON 51
ci_53                -7.138307e-04 3 1  ON 52
ci_54                -1.068539e-03 3 1  ON 53
ci_55                -6.644203e-04 3 1  ON 54
ci_56                 2.491884e-03 3 1  ON 55
ci_57                 1.715749e-03 3 1  ON 56
ci_58                -1.135494e-03 3 1  ON 57
ci_59                -1.370469e-03 3 1  ON 58
ci_60                 1.037847e-04 3 1  ON 59
ci_61                -1.648521e-04 3 1  ON 60
ci_62                -5.853760e-04 3 1  ON 61
ci_63                -6.330423e-04 3 1  ON 62
ci_64                -3.338577e-04 3 1  ON 63
ci_65                 7.655144e-06 3 1  ON 64
ci_66                -6.462462e-04 3 1  ON 65
ci_67                -8.818605e-04 3 1  ON 66
ci_68                -1.199650e-03 3 1  ON 67
ci_69                -9.413719e-08 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8842
    reference variance = 0.513181
====================================================
  Execution time = 2.5285e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4956e-01
  Total weights = 1.9645e+06
  Execution time = 3.5104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436600583054
                                         uncertainty =       0.002663058313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436600583054
                                         uncertainty =       0.002663058313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467209897
  error estimate for blocks of size 2^( 2) =       0.000492948576
  error estimate for blocks of size 2^( 3) =       0.000516444579
  error estimate for blocks of size 2^( 4) =       0.000534663717
  error estimate for blocks of size 2^( 5) =       0.000546889730
  error estimate for blocks of size 2^( 6) =       0.000551496071
  error estimate for blocks of size 2^( 7) =       0.000554888545

      target function =      -0.745851462891
              le_mean =     -22.813964555278
             les_mean =     520.926366077275
             stat err =       0.000546984516
             autocorr =       1.370648186922
   target nu stat err =       0.000546984516
   target dn stat err =       0.003658385379
      target stat err =       0.003092581554
              std dev =       0.660734573465
             le_variance =       0.436570176572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436591265936
                                         uncertainty =       0.002670140370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436591265936
                                         uncertainty =       0.002670140370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467204954
  error estimate for blocks of size 2^( 2) =       0.000492960205
  error estimate for blocks of size 2^( 3) =       0.000516472920
  error estimate for blocks of size 2^( 4) =       0.000534705423
  error estimate for blocks of size 2^( 5) =       0.000546933559
  error estimate for blocks of size 2^( 6) =       0.000551544501
  error estimate for blocks of size 2^( 7) =       0.000554943481

      target function =      -0.742979400241
              le_mean =     -22.813966472548
             les_mean =     520.929925500476
             stat err =       0.000547031741
             autocorr =       1.370913881213
   target nu stat err =       0.000547031741
   target dn stat err =       0.004402925467
      target stat err =       0.003671637118
              std dev =       0.660727583019
             le_variance =       0.436560938962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436589003616
                                         uncertainty =       0.002665916087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436589003616
                                         uncertainty =       0.002665916087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467203731
  error estimate for blocks of size 2^( 2) =       0.000492951974
  error estimate for blocks of size 2^( 3) =       0.000516457417
  error estimate for blocks of size 2^( 4) =       0.000534684207
  error estimate for blocks of size 2^( 5) =       0.000546911246
  error estimate for blocks of size 2^( 6) =       0.000551520262
  error estimate for blocks of size 2^( 7) =       0.000554915929

      target function =      -0.745293916072
              le_mean =     -22.813964887095
             les_mean =     520.927054107758
             stat err =       0.000547007911
             autocorr =       1.370801623401
   target nu stat err =       0.000547007911
   target dn stat err =       0.003695211493
      target stat err =       0.003117944670
              std dev =       0.660725852297
             le_variance =       0.436558651893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436598263401
                                         uncertainty =       0.002663289448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436598263401
                                         uncertainty =       0.002663289448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467208661
  error estimate for blocks of size 2^( 2) =       0.000492948585
  error estimate for blocks of size 2^( 3) =       0.000516445829
  error estimate for blocks of size 2^( 4) =       0.000534665971
  error estimate for blocks of size 2^( 5) =       0.000546892079
  error estimate for blocks of size 2^( 6) =       0.000551498766
  error estimate for blocks of size 2^( 7) =       0.000554891597

      target function =      -0.745815392074
              le_mean =     -22.813964519114
             les_mean =     520.926407935524
             stat err =       0.000546987103
             autocorr =       1.370668410145
   target nu stat err =       0.000546987103
   target dn stat err =       0.003660011933
      target stat err =       0.003093610408
              std dev =       0.660732824399
             le_variance =       0.436567865239


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745851462891        initial  <--
     2.5000e-01     2.5000e+00             5.3548e-04        -0.742979400241
     1.0000e+00     1.0000e+01             1.4989e-04        -0.745293916072
     4.0000e+00     4.0000e+01             3.8627e-05        -0.745815392074

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8544
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.265016e-01 3 1  ON 0
ci_02                -2.871840e-02 3 1  ON 1
ci_03                -2.856508e-02 3 1  ON 2
ci_04                 2.661271e-02 3 1  ON 3
ci_05                -2.187632e-02 3 1  ON 4
ci_06                -2.154273e-02 3 1  ON 5
ci_07                 2.710168e-02 3 1  ON 6
ci_08                -5.456736e-03 3 1  ON 7
ci_09                -8.842308e-03 3 1  ON 8
ci_10                -8.363863e-03 3 1  ON 9
ci_11                 1.311059e-02 3 1  ON 10
ci_12                 6.948264e-03 3 1  ON 11
ci_13                 1.303874e-02 3 1  ON 12
ci_14                 1.252719e-02 3 1  ON 13
ci_15                 6.372308e-03 3 1  ON 14
ci_16                 6.263827e-03 3 1  ON 15
ci_17                -7.198904e-03 3 1  ON 16
ci_18                -6.024443e-03 3 1  ON 17
ci_19                 9.257709e-03 3 1  ON 18
ci_20                 6.518985e-03 3 1  ON 19
ci_21                 8.966885e-03 3 1  ON 20
ci_22                 8.288972e-03 3 1  ON 21
ci_23                 4.852444e-03 3 1  ON 22
ci_24                 4.086651e-03 3 1  ON 23
ci_25                 2.863718e-03 3 1  ON 24
ci_26                 3.086079e-03 3 1  ON 25
ci_27                 3.185097e-03 3 1  ON 26
ci_28                 1.755703e-03 3 1  ON 27
ci_29                 1.455085e-03 3 1  ON 28
ci_30                -1.778657e-03 3 1  ON 29
ci_31                -4.925170e-04 3 1  ON 30
ci_32                -9.486160e-04 3 1  ON 31
ci_33                -1.370794e-03 3 1  ON 32
ci_34                 1.098334e-03 3 1  ON 33
ci_35                 1.541807e-03 3 1  ON 34
ci_36                -1.076515e-03 3 1  ON 35
ci_37                -1.049908e-03 3 1  ON 36
ci_38                -6.345667e-04 3 1  ON 37
ci_39                -6.045465e-04 3 1  ON 38
ci_40                -1.528334e-03 3 1  ON 39
ci_41                -1.186493e-03 3 1  ON 40
ci_42                -1.176165e-03 3 1  ON 41
ci_43                -2.259831e-03 3 1  ON 42
ci_44                -2.993994e-03 3 1  ON 43
ci_45                -5.582127e-04 3 1  ON 44
ci_46                -7.369610e-04 3 1  ON 45
ci_47                 1.562089e-03 3 1  ON 46
ci_48                 1.418056e-03 3 1  ON 47
ci_49                -9.598990e-04 3 1  ON 48
ci_50                -7.632515e-04 3 1  ON 49
ci_51                 1.269241e-04 3 1  ON 50
ci_52                 1.810425e-04 3 1  ON 51
ci_53                -7.047017e-04 3 1  ON 52
ci_54                -1.080372e-03 3 1  ON 53
ci_55                -6.620170e-04 3 1  ON 54
ci_56                 2.501700e-03 3 1  ON 55
ci_57                 1.712992e-03 3 1  ON 56
ci_58                -1.157579e-03 3 1  ON 57
ci_59                -1.431163e-03 3 1  ON 58
ci_60                 1.747333e-04 3 1  ON 59
ci_61                -2.371934e-04 3 1  ON 60
ci_62                -5.529572e-04 3 1  ON 61
ci_63                -6.346612e-04 3 1  ON 62
ci_64                -3.466333e-04 3 1  ON 63
ci_65                 8.914708e-06 3 1  ON 64
ci_66                -6.619828e-04 3 1  ON 65
ci_67                -8.568745e-04 3 1  ON 66
ci_68                -1.184664e-03 3 1  ON 67
ci_69                 9.423064e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5094e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8235
    reference variance = 0.460641
====================================================
  Execution time = 2.5934e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4951e-01
  Total weights = 1.964695830e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435927697998
                                         uncertainty =       0.002259078067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435927697998
                                         uncertainty =       0.002259078067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466928736
  error estimate for blocks of size 2^( 2) =       0.000492209913
  error estimate for blocks of size 2^( 3) =       0.000515727457
  error estimate for blocks of size 2^( 4) =       0.000532376304
  error estimate for blocks of size 2^( 5) =       0.000541320674
  error estimate for blocks of size 2^( 6) =       0.000546104410
  error estimate for blocks of size 2^( 7) =       0.000549521570

      target function =      -0.745758553165
              le_mean =     -22.815012371939
             les_mean =     520.974294671703
             stat err =       0.000542330739
             autocorr =       1.349047485808
   target nu stat err =       0.000542330739
   target dn stat err =       0.002925784389
      target stat err =       0.002502094687
              std dev =       0.660336951487
             le_variance =       0.436044889499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281501237194e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745766065006       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745769876699       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745770472137       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745770509141       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745770535999       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745770527441       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745770549336       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745770551783       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745770552865       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 3.714164e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745766065006       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745767032219       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745767182401       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745767191545       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745767198231       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745767196074       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745767201511       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745767202115       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745767202378       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 9.401638e-06

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745766065006       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745766307719       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745766345348       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745766347627       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745766349297       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745766348756       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745766350113       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745766350264       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745766350329       residual = 9.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 2.357787e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031969 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0465e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.265040e-01 3 1  ON 0
ci_02                -2.872143e-02 3 1  ON 1
ci_03                -2.856311e-02 3 1  ON 2
ci_04                 2.660699e-02 3 1  ON 3
ci_05                -2.186700e-02 3 1  ON 4
ci_06                -2.154198e-02 3 1  ON 5
ci_07                 2.710091e-02 3 1  ON 6
ci_08                -5.452918e-03 3 1  ON 7
ci_09                -8.839657e-03 3 1  ON 8
ci_10                -8.362339e-03 3 1  ON 9
ci_11                 1.310707e-02 3 1  ON 10
ci_12                 6.944714e-03 3 1  ON 11
ci_13                 1.303452e-02 3 1  ON 12
ci_14                 1.253459e-02 3 1  ON 13
ci_15                 6.366287e-03 3 1  ON 14
ci_16                 6.267381e-03 3 1  ON 15
ci_17                -7.202656e-03 3 1  ON 16
ci_18                -6.026673e-03 3 1  ON 17
ci_19                 9.250921e-03 3 1  ON 18
ci_20                 6.517051e-03 3 1  ON 19
ci_21                 8.967084e-03 3 1  ON 20
ci_22                 8.285116e-03 3 1  ON 21
ci_23                 4.852051e-03 3 1  ON 22
ci_24                 4.090001e-03 3 1  ON 23
ci_25                 2.861711e-03 3 1  ON 24
ci_26                 3.085624e-03 3 1  ON 25
ci_27                 3.181451e-03 3 1  ON 26
ci_28                 1.757161e-03 3 1  ON 27
ci_29                 1.462365e-03 3 1  ON 28
ci_30                -1.777041e-03 3 1  ON 29
ci_31                -4.989672e-04 3 1  ON 30
ci_32                -9.535483e-04 3 1  ON 31
ci_33                -1.373563e-03 3 1  ON 32
ci_34                 1.104105e-03 3 1  ON 33
ci_35                 1.537650e-03 3 1  ON 34
ci_36                -1.075418e-03 3 1  ON 35
ci_37                -1.047543e-03 3 1  ON 36
ci_38                -6.310320e-04 3 1  ON 37
ci_39                -6.031718e-04 3 1  ON 38
ci_40                -1.531131e-03 3 1  ON 39
ci_41                -1.188805e-03 3 1  ON 40
ci_42                -1.173760e-03 3 1  ON 41
ci_43                -2.250429e-03 3 1  ON 42
ci_44                -2.988673e-03 3 1  ON 43
ci_45                -5.612946e-04 3 1  ON 44
ci_46                -7.332170e-04 3 1  ON 45
ci_47                 1.563249e-03 3 1  ON 46
ci_48                 1.413233e-03 3 1  ON 47
ci_49                -9.582056e-04 3 1  ON 48
ci_50                -7.607111e-04 3 1  ON 49
ci_51                 1.272214e-04 3 1  ON 50
ci_52                 1.819842e-04 3 1  ON 51
ci_53                -7.041083e-04 3 1  ON 52
ci_54                -1.080746e-03 3 1  ON 53
ci_55                -6.562892e-04 3 1  ON 54
ci_56                 2.498165e-03 3 1  ON 55
ci_57                 1.710938e-03 3 1  ON 56
ci_58                -1.152032e-03 3 1  ON 57
ci_59                -1.429706e-03 3 1  ON 58
ci_60                 1.814183e-04 3 1  ON 59
ci_61                -2.402760e-04 3 1  ON 60
ci_62                -5.495234e-04 3 1  ON 61
ci_63                -6.298778e-04 3 1  ON 62
ci_64                -3.457279e-04 3 1  ON 63
ci_65                 9.145932e-06 3 1  ON 64
ci_66                -6.558963e-04 3 1  ON 65
ci_67                -8.522490e-04 3 1  ON 66
ci_68                -1.183093e-03 3 1  ON 67
ci_69                 8.565806e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7925
    reference variance = 0.333385
====================================================
  Execution time = 2.5361e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5053e-01
  Total weights = 1.9644e+06
  Execution time = 3.5024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436047724865
                                         uncertainty =       0.002846063363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436047724865
                                         uncertainty =       0.002846063363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466929822
  error estimate for blocks of size 2^( 2) =       0.000492388391
  error estimate for blocks of size 2^( 3) =       0.000516865380
  error estimate for blocks of size 2^( 4) =       0.000534637827
  error estimate for blocks of size 2^( 5) =       0.000545470643
  error estimate for blocks of size 2^( 6) =       0.000550668052
  error estimate for blocks of size 2^( 7) =       0.000554172434

      target function =      -0.744923015874
              le_mean =     -22.813575019498
             les_mean =     520.909715974436
             stat err =       0.000546237239
             autocorr =       1.368545947764
   target nu stat err =       0.000546237239
   target dn stat err =       0.003409775872
      target stat err =       0.002881937461
              std dev =       0.660338487527
             le_variance =       0.436046918109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436048244434
                                         uncertainty =       0.002845784399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436048244434
                                         uncertainty =       0.002845784399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466930119
  error estimate for blocks of size 2^( 2) =       0.000492389968
  error estimate for blocks of size 2^( 3) =       0.000516868121
  error estimate for blocks of size 2^( 4) =       0.000534640956
  error estimate for blocks of size 2^( 5) =       0.000545474213
  error estimate for blocks of size 2^( 6) =       0.000550672228
  error estimate for blocks of size 2^( 7) =       0.000554176572

      target function =      -0.744840162861
              le_mean =     -22.813575175134
             les_mean =     520.909823296602
             stat err =       0.000546240992
             autocorr =       1.368563015140
   target nu stat err =       0.000546240992
   target dn stat err =       0.003417906363
      target stat err =       0.002887879289
              std dev =       0.660338906781
             le_variance =       0.436047471809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436047906630
                                         uncertainty =       0.002845920991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436047906630
                                         uncertainty =       0.002845920991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466929929
  error estimate for blocks of size 2^( 2) =       0.000492389148
  error estimate for blocks of size 2^( 3) =       0.000516866730
  error estimate for blocks of size 2^( 4) =       0.000534639375
  error estimate for blocks of size 2^( 5) =       0.000545472412
  error estimate for blocks of size 2^( 6) =       0.000550670126
  error estimate for blocks of size 2^( 7) =       0.000554174494

      target function =      -0.744888535620
              le_mean =     -22.813575089659
             les_mean =     520.909760878454
             stat err =       0.000546239102
             autocorr =       1.368554655633
   target nu stat err =       0.000546239102
   target dn stat err =       0.003413513510
      target stat err =       0.002884696587
              std dev =       0.660338638304
             le_variance =       0.436047117238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436047738715
                                         uncertainty =       0.002846045350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436047738715
                                         uncertainty =       0.002846045350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466929831
  error estimate for blocks of size 2^( 2) =       0.000492388482
  error estimate for blocks of size 2^( 3) =       0.000516865545
  error estimate for blocks of size 2^( 4) =       0.000534638017
  error estimate for blocks of size 2^( 5) =       0.000545470860
  error estimate for blocks of size 2^( 6) =       0.000550668308
  error estimate for blocks of size 2^( 7) =       0.000554172689

      target function =      -0.744919754140
              le_mean =     -22.813575027368
             les_mean =     520.909720277708
             stat err =       0.000546237468
             autocorr =       1.368547046130
   target nu stat err =       0.000546237468
   target dn stat err =       0.003410208413
      target stat err =       0.002882262300
              std dev =       0.660338499671
             le_variance =       0.436046934148


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744923015874        initial  <--
     2.5000e+00     2.5000e+01             3.7142e-05        -0.744840162861
     1.0000e+01     1.0000e+02             9.4016e-06        -0.744888535620
     4.0000e+01     4.0000e+02             2.3578e-06        -0.744919754140

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9501
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.265016e-01 3 1  ON 0
ci_02                -2.871840e-02 3 1  ON 1
ci_03                -2.856508e-02 3 1  ON 2
ci_04                 2.661271e-02 3 1  ON 3
ci_05                -2.187632e-02 3 1  ON 4
ci_06                -2.154273e-02 3 1  ON 5
ci_07                 2.710168e-02 3 1  ON 6
ci_08                -5.456736e-03 3 1  ON 7
ci_09                -8.842308e-03 3 1  ON 8
ci_10                -8.363863e-03 3 1  ON 9
ci_11                 1.311059e-02 3 1  ON 10
ci_12                 6.948264e-03 3 1  ON 11
ci_13                 1.303874e-02 3 1  ON 12
ci_14                 1.252719e-02 3 1  ON 13
ci_15                 6.372308e-03 3 1  ON 14
ci_16                 6.263827e-03 3 1  ON 15
ci_17                -7.198904e-03 3 1  ON 16
ci_18                -6.024443e-03 3 1  ON 17
ci_19                 9.257709e-03 3 1  ON 18
ci_20                 6.518985e-03 3 1  ON 19
ci_21                 8.966885e-03 3 1  ON 20
ci_22                 8.288972e-03 3 1  ON 21
ci_23                 4.852444e-03 3 1  ON 22
ci_24                 4.086651e-03 3 1  ON 23
ci_25                 2.863718e-03 3 1  ON 24
ci_26                 3.086079e-03 3 1  ON 25
ci_27                 3.185097e-03 3 1  ON 26
ci_28                 1.755703e-03 3 1  ON 27
ci_29                 1.455085e-03 3 1  ON 28
ci_30                -1.778657e-03 3 1  ON 29
ci_31                -4.925170e-04 3 1  ON 30
ci_32                -9.486160e-04 3 1  ON 31
ci_33                -1.370794e-03 3 1  ON 32
ci_34                 1.098334e-03 3 1  ON 33
ci_35                 1.541807e-03 3 1  ON 34
ci_36                -1.076515e-03 3 1  ON 35
ci_37                -1.049908e-03 3 1  ON 36
ci_38                -6.345667e-04 3 1  ON 37
ci_39                -6.045465e-04 3 1  ON 38
ci_40                -1.528334e-03 3 1  ON 39
ci_41                -1.186493e-03 3 1  ON 40
ci_42                -1.176165e-03 3 1  ON 41
ci_43                -2.259831e-03 3 1  ON 42
ci_44                -2.993994e-03 3 1  ON 43
ci_45                -5.582127e-04 3 1  ON 44
ci_46                -7.369610e-04 3 1  ON 45
ci_47                 1.562089e-03 3 1  ON 46
ci_48                 1.418056e-03 3 1  ON 47
ci_49                -9.598990e-04 3 1  ON 48
ci_50                -7.632515e-04 3 1  ON 49
ci_51                 1.269241e-04 3 1  ON 50
ci_52                 1.810425e-04 3 1  ON 51
ci_53                -7.047017e-04 3 1  ON 52
ci_54                -1.080372e-03 3 1  ON 53
ci_55                -6.620170e-04 3 1  ON 54
ci_56                 2.501700e-03 3 1  ON 55
ci_57                 1.712992e-03 3 1  ON 56
ci_58                -1.157579e-03 3 1  ON 57
ci_59                -1.431163e-03 3 1  ON 58
ci_60                 1.747333e-04 3 1  ON 59
ci_61                -2.371934e-04 3 1  ON 60
ci_62                -5.529572e-04 3 1  ON 61
ci_63                -6.346612e-04 3 1  ON 62
ci_64                -3.466333e-04 3 1  ON 63
ci_65                 8.914708e-06 3 1  ON 64
ci_66                -6.619828e-04 3 1  ON 65
ci_67                -8.568745e-04 3 1  ON 66
ci_68                -1.184664e-03 3 1  ON 67
ci_69                 9.423064e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3422e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8118
    reference variance = 0.394973
====================================================
  Execution time = 2.7724e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4909e-01
  Total weights = 1.964555468e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435850149762
                                         uncertainty =       0.002273080247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435850149762
                                         uncertainty =       0.002273080247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466794403
  error estimate for blocks of size 2^( 2) =       0.000492280399
  error estimate for blocks of size 2^( 3) =       0.000516366991
  error estimate for blocks of size 2^( 4) =       0.000534589854
  error estimate for blocks of size 2^( 5) =       0.000545440097
  error estimate for blocks of size 2^( 6) =       0.000550695409
  error estimate for blocks of size 2^( 7) =       0.000553092928

      target function =      -0.746098704467
              le_mean =     -22.814665463384
             les_mean =     520.958055123371
             stat err =       0.000545954572
             autocorr =       1.367923261551
   target nu stat err =       0.000545954572
   target dn stat err =       0.003013555172
      target stat err =       0.002574748183
              std dev =       0.660146974999
             le_variance =       0.435794028600


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281466546338e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746106593769       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746107104035       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746107176149       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746107184517       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746107190605       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746107191721       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746107190077       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746107190009       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746107189858       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746107189856       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 6.525514e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746106593769       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746106721525       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746106739566       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746106741656       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746106743176       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746106743455       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746106743043       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746106743027       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746106742989       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746106742988       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 1.632572e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746106593769       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746106625720       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746106630231       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746106630753       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746106631133       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746106631202       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746106631100       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746106631096       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746106631087       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746106631086       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+02 is 4.082177e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.035512 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2249e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.265000e-01 3 1  ON 0
ci_02                -2.871875e-02 3 1  ON 1
ci_03                -2.856400e-02 3 1  ON 2
ci_04                 2.661227e-02 3 1  ON 3
ci_05                -2.187566e-02 3 1  ON 4
ci_06                -2.154328e-02 3 1  ON 5
ci_07                 2.710070e-02 3 1  ON 6
ci_08                -5.456570e-03 3 1  ON 7
ci_09                -8.841848e-03 3 1  ON 8
ci_10                -8.363950e-03 3 1  ON 9
ci_11                 1.311021e-02 3 1  ON 10
ci_12                 6.948106e-03 3 1  ON 11
ci_13                 1.303826e-02 3 1  ON 12
ci_14                 1.252857e-02 3 1  ON 13
ci_15                 6.372557e-03 3 1  ON 14
ci_16                 6.264325e-03 3 1  ON 15
ci_17                -7.198929e-03 3 1  ON 16
ci_18                -6.024487e-03 3 1  ON 17
ci_19                 9.258114e-03 3 1  ON 18
ci_20                 6.518301e-03 3 1  ON 19
ci_21                 8.965884e-03 3 1  ON 20
ci_22                 8.289115e-03 3 1  ON 21
ci_23                 4.852818e-03 3 1  ON 22
ci_24                 4.086984e-03 3 1  ON 23
ci_25                 2.863956e-03 3 1  ON 24
ci_26                 3.085640e-03 3 1  ON 25
ci_27                 3.184742e-03 3 1  ON 26
ci_28                 1.755094e-03 3 1  ON 27
ci_29                 1.455925e-03 3 1  ON 28
ci_30                -1.778203e-03 3 1  ON 29
ci_31                -4.928887e-04 3 1  ON 30
ci_32                -9.479477e-04 3 1  ON 31
ci_33                -1.370633e-03 3 1  ON 32
ci_34                 1.098535e-03 3 1  ON 33
ci_35                 1.541332e-03 3 1  ON 34
ci_36                -1.077033e-03 3 1  ON 35
ci_37                -1.050379e-03 3 1  ON 36
ci_38                -6.344210e-04 3 1  ON 37
ci_39                -6.047011e-04 3 1  ON 38
ci_40                -1.528191e-03 3 1  ON 39
ci_41                -1.186786e-03 3 1  ON 40
ci_42                -1.176077e-03 3 1  ON 41
ci_43                -2.260350e-03 3 1  ON 42
ci_44                -2.993845e-03 3 1  ON 43
ci_45                -5.578631e-04 3 1  ON 44
ci_46                -7.368394e-04 3 1  ON 45
ci_47                 1.562200e-03 3 1  ON 46
ci_48                 1.418599e-03 3 1  ON 47
ci_49                -9.596138e-04 3 1  ON 48
ci_50                -7.631904e-04 3 1  ON 49
ci_51                 1.266242e-04 3 1  ON 50
ci_52                 1.809657e-04 3 1  ON 51
ci_53                -7.048043e-04 3 1  ON 52
ci_54                -1.080969e-03 3 1  ON 53
ci_55                -6.626162e-04 3 1  ON 54
ci_56                 2.501900e-03 3 1  ON 55
ci_57                 1.713609e-03 3 1  ON 56
ci_58                -1.157406e-03 3 1  ON 57
ci_59                -1.430550e-03 3 1  ON 58
ci_60                 1.747215e-04 3 1  ON 59
ci_61                -2.360261e-04 3 1  ON 60
ci_62                -5.522671e-04 3 1  ON 61
ci_63                -6.344557e-04 3 1  ON 62
ci_64                -3.461574e-04 3 1  ON 63
ci_65                 8.979581e-06 3 1  ON 64
ci_66                -6.619222e-04 3 1  ON 65
ci_67                -8.561699e-04 3 1  ON 66
ci_68                -1.184174e-03 3 1  ON 67
ci_69                 9.308281e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8107
    reference variance = 0.419171
====================================================
  Execution time = 2.5516e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4730e-01
  Total weights = 1.9644e+06
  Execution time = 3.5129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434268324170
                                         uncertainty =       0.001878893888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434268324170
                                         uncertainty =       0.001878893888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465930665
  error estimate for blocks of size 2^( 2) =       0.000491512506
  error estimate for blocks of size 2^( 3) =       0.000514859320
  error estimate for blocks of size 2^( 4) =       0.000533152298
  error estimate for blocks of size 2^( 5) =       0.000544647850
  error estimate for blocks of size 2^( 6) =       0.000549198171
  error estimate for blocks of size 2^( 7) =       0.000553264452

      target function =      -0.747596240744
              le_mean =     -22.814639614320
             les_mean =     520.955078441085
             stat err =       0.000545065693
             autocorr =       1.368532474209
   target nu stat err =       0.000545065693
   target dn stat err =       0.002527682197
      target stat err =       0.002192884722
              std dev =       0.658925465269
             le_variance =       0.434182768780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434268150206
                                         uncertainty =       0.001878935744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434268150206
                                         uncertainty =       0.001878935744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465930568
  error estimate for blocks of size 2^( 2) =       0.000491512554
  error estimate for blocks of size 2^( 3) =       0.000514859521
  error estimate for blocks of size 2^( 4) =       0.000533152724
  error estimate for blocks of size 2^( 5) =       0.000544648288
  error estimate for blocks of size 2^( 6) =       0.000549198838
  error estimate for blocks of size 2^( 7) =       0.000553265187

      target function =      -0.747591149197
              le_mean =     -22.814639660821
             les_mean =     520.955086666505
             stat err =       0.000545066259
             autocorr =       1.368535889172
   target nu stat err =       0.000545066259
   target dn stat err =       0.002528554865
      target stat err =       0.002193555268
              std dev =       0.658925328156
             le_variance =       0.434182588085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434268236212
                                         uncertainty =       0.001878914839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434268236212
                                         uncertainty =       0.001878914839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465930616
  error estimate for blocks of size 2^( 2) =       0.000491512530
  error estimate for blocks of size 2^( 3) =       0.000514859420
  error estimate for blocks of size 2^( 4) =       0.000533152511
  error estimate for blocks of size 2^( 5) =       0.000544648069
  error estimate for blocks of size 2^( 6) =       0.000549198505
  error estimate for blocks of size 2^( 7) =       0.000553264820

      target function =      -0.747593912991
              le_mean =     -22.814639637521
             les_mean =     520.955082289970
             stat err =       0.000545065976
             autocorr =       1.368534184317
   target nu stat err =       0.000545065976
   target dn stat err =       0.002528114939
      target stat err =       0.002193218349
              std dev =       0.658925395969
             le_variance =       0.434182677453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434268313073
                                         uncertainty =       0.001878896507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434268313073
                                         uncertainty =       0.001878896507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465930659
  error estimate for blocks of size 2^( 2) =       0.000491512509
  error estimate for blocks of size 2^( 3) =       0.000514859332
  error estimate for blocks of size 2^( 4) =       0.000533152325
  error estimate for blocks of size 2^( 5) =       0.000544647877
  error estimate for blocks of size 2^( 6) =       0.000549198213
  error estimate for blocks of size 2^( 7) =       0.000553264498

      target function =      -0.747595976830
              le_mean =     -22.814639617212
             les_mean =     520.955078889392
             stat err =       0.000545065728
             autocorr =       1.368532688111
   target nu stat err =       0.000545065728
   target dn stat err =       0.002527735826
      target stat err =       0.002192926206
              std dev =       0.658925456528
             le_variance =       0.434182757261


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747596240744        initial  <--
     2.5000e+01     2.5000e+02             6.5255e-06        -0.747591149197
     1.0000e+02     1.0000e+03             1.6326e-06        -0.747593912991
     4.0000e+02     4.0000e+03             4.0822e-07        -0.747595976830

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.1188
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.265016e-01 3 1  ON 0
ci_02                -2.871840e-02 3 1  ON 1
ci_03                -2.856508e-02 3 1  ON 2
ci_04                 2.661271e-02 3 1  ON 3
ci_05                -2.187632e-02 3 1  ON 4
ci_06                -2.154273e-02 3 1  ON 5
ci_07                 2.710168e-02 3 1  ON 6
ci_08                -5.456736e-03 3 1  ON 7
ci_09                -8.842308e-03 3 1  ON 8
ci_10                -8.363863e-03 3 1  ON 9
ci_11                 1.311059e-02 3 1  ON 10
ci_12                 6.948264e-03 3 1  ON 11
ci_13                 1.303874e-02 3 1  ON 12
ci_14                 1.252719e-02 3 1  ON 13
ci_15                 6.372308e-03 3 1  ON 14
ci_16                 6.263827e-03 3 1  ON 15
ci_17                -7.198904e-03 3 1  ON 16
ci_18                -6.024443e-03 3 1  ON 17
ci_19                 9.257709e-03 3 1  ON 18
ci_20                 6.518985e-03 3 1  ON 19
ci_21                 8.966885e-03 3 1  ON 20
ci_22                 8.288972e-03 3 1  ON 21
ci_23                 4.852444e-03 3 1  ON 22
ci_24                 4.086651e-03 3 1  ON 23
ci_25                 2.863718e-03 3 1  ON 24
ci_26                 3.086079e-03 3 1  ON 25
ci_27                 3.185097e-03 3 1  ON 26
ci_28                 1.755703e-03 3 1  ON 27
ci_29                 1.455085e-03 3 1  ON 28
ci_30                -1.778657e-03 3 1  ON 29
ci_31                -4.925170e-04 3 1  ON 30
ci_32                -9.486160e-04 3 1  ON 31
ci_33                -1.370794e-03 3 1  ON 32
ci_34                 1.098334e-03 3 1  ON 33
ci_35                 1.541807e-03 3 1  ON 34
ci_36                -1.076515e-03 3 1  ON 35
ci_37                -1.049908e-03 3 1  ON 36
ci_38                -6.345667e-04 3 1  ON 37
ci_39                -6.045465e-04 3 1  ON 38
ci_40                -1.528334e-03 3 1  ON 39
ci_41                -1.186493e-03 3 1  ON 40
ci_42                -1.176165e-03 3 1  ON 41
ci_43                -2.259831e-03 3 1  ON 42
ci_44                -2.993994e-03 3 1  ON 43
ci_45                -5.582127e-04 3 1  ON 44
ci_46                -7.369610e-04 3 1  ON 45
ci_47                 1.562089e-03 3 1  ON 46
ci_48                 1.418056e-03 3 1  ON 47
ci_49                -9.598990e-04 3 1  ON 48
ci_50                -7.632515e-04 3 1  ON 49
ci_51                 1.269241e-04 3 1  ON 50
ci_52                 1.810425e-04 3 1  ON 51
ci_53                -7.047017e-04 3 1  ON 52
ci_54                -1.080372e-03 3 1  ON 53
ci_55                -6.620170e-04 3 1  ON 54
ci_56                 2.501700e-03 3 1  ON 55
ci_57                 1.712992e-03 3 1  ON 56
ci_58                -1.157579e-03 3 1  ON 57
ci_59                -1.431163e-03 3 1  ON 58
ci_60                 1.747333e-04 3 1  ON 59
ci_61                -2.371934e-04 3 1  ON 60
ci_62                -5.529572e-04 3 1  ON 61
ci_63                -6.346612e-04 3 1  ON 62
ci_64                -3.466333e-04 3 1  ON 63
ci_65                 8.914708e-06 3 1  ON 64
ci_66                -6.619828e-04 3 1  ON 65
ci_67                -8.568745e-04 3 1  ON 66
ci_68                -1.184664e-03 3 1  ON 67
ci_69                 9.423064e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5379e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7811
    reference variance = 0.32487
====================================================
  Execution time = 2.6022e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5362e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5028e-01
  Total weights = 1.964478856e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5454e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435267643961
                                         uncertainty =       0.002096732367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435267643961
                                         uncertainty =       0.002096732367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466502754
  error estimate for blocks of size 2^( 2) =       0.000491855379
  error estimate for blocks of size 2^( 3) =       0.000515861901
  error estimate for blocks of size 2^( 4) =       0.000532871213
  error estimate for blocks of size 2^( 5) =       0.000544528250
  error estimate for blocks of size 2^( 6) =       0.000551572214
  error estimate for blocks of size 2^( 7) =       0.000556560889

      target function =      -0.745115722066
              le_mean =     -22.814400410443
             les_mean =     520.947143985814
             stat err =       0.000546383141
             autocorr =       1.371785342752
   target nu stat err =       0.000546383141
   target dn stat err =       0.003404508283
      target stat err =       0.002882715273
              std dev =       0.659734521125
             le_variance =       0.435249638364


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281440041044e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745125873684       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745125917460       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745125921461       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745125922582       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745125923149       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745125923170       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745125923383       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745125923454       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745125923472       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745125923469       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 6.503831e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745125873684       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745125884629       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745125885630       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745125885910       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745125886052       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745125886057       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745125886109       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745125886127       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745125886133       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745125886133       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+03 is 1.626166e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745125873684       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745125876420       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745125876670       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745125876741       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745125876769       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745125876781       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745125876792       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745125876793       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745125876792       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745125876799       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+03 is 4.065544e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039042 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0576e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.265015e-01 3 1  ON 0
ci_02                -2.871844e-02 3 1  ON 1
ci_03                -2.856505e-02 3 1  ON 2
ci_04                 2.661268e-02 3 1  ON 3
ci_05                -2.187616e-02 3 1  ON 4
ci_06                -2.154272e-02 3 1  ON 5
ci_07                 2.710168e-02 3 1  ON 6
ci_08                -5.456759e-03 3 1  ON 7
ci_09                -8.842281e-03 3 1  ON 8
ci_10                -8.363850e-03 3 1  ON 9
ci_11                 1.311057e-02 3 1  ON 10
ci_12                 6.948162e-03 3 1  ON 11
ci_13                 1.303881e-02 3 1  ON 12
ci_14                 1.252713e-02 3 1  ON 13
ci_15                 6.372267e-03 3 1  ON 14
ci_16                 6.263846e-03 3 1  ON 15
ci_17                -7.198856e-03 3 1  ON 16
ci_18                -6.024430e-03 3 1  ON 17
ci_19                 9.257671e-03 3 1  ON 18
ci_20                 6.518921e-03 3 1  ON 19
ci_21                 8.966880e-03 3 1  ON 20
ci_22                 8.288991e-03 3 1  ON 21
ci_23                 4.852420e-03 3 1  ON 22
ci_24                 4.086670e-03 3 1  ON 23
ci_25                 2.863727e-03 3 1  ON 24
ci_26                 3.086016e-03 3 1  ON 25
ci_27                 3.185115e-03 3 1  ON 26
ci_28                 1.755714e-03 3 1  ON 27
ci_29                 1.455136e-03 3 1  ON 28
ci_30                -1.778593e-03 3 1  ON 29
ci_31                -4.925138e-04 3 1  ON 30
ci_32                -9.486109e-04 3 1  ON 31
ci_33                -1.370708e-03 3 1  ON 32
ci_34                 1.098357e-03 3 1  ON 33
ci_35                 1.541863e-03 3 1  ON 34
ci_36                -1.076488e-03 3 1  ON 35
ci_37                -1.049938e-03 3 1  ON 36
ci_38                -6.345931e-04 3 1  ON 37
ci_39                -6.045387e-04 3 1  ON 38
ci_40                -1.528321e-03 3 1  ON 39
ci_41                -1.186479e-03 3 1  ON 40
ci_42                -1.176207e-03 3 1  ON 41
ci_43                -2.259796e-03 3 1  ON 42
ci_44                -2.994021e-03 3 1  ON 43
ci_45                -5.582182e-04 3 1  ON 44
ci_46                -7.369562e-04 3 1  ON 45
ci_47                 1.562111e-03 3 1  ON 46
ci_48                 1.418045e-03 3 1  ON 47
ci_49                -9.599500e-04 3 1  ON 48
ci_50                -7.632487e-04 3 1  ON 49
ci_51                 1.269260e-04 3 1  ON 50
ci_52                 1.810436e-04 3 1  ON 51
ci_53                -7.047140e-04 3 1  ON 52
ci_54                -1.080382e-03 3 1  ON 53
ci_55                -6.619812e-04 3 1  ON 54
ci_56                 2.501700e-03 3 1  ON 55
ci_57                 1.713018e-03 3 1  ON 56
ci_58                -1.157537e-03 3 1  ON 57
ci_59                -1.431192e-03 3 1  ON 58
ci_60                 1.746375e-04 3 1  ON 59
ci_61                -2.372177e-04 3 1  ON 60
ci_62                -5.529318e-04 3 1  ON 61
ci_63                -6.346857e-04 3 1  ON 62
ci_64                -3.465814e-04 3 1  ON 63
ci_65                 8.946249e-06 3 1  ON 64
ci_66                -6.619865e-04 3 1  ON 65
ci_67                -8.568617e-04 3 1  ON 66
ci_68                -1.184702e-03 3 1  ON 67
ci_69                 9.417066e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7836
    reference variance = 0.680848
====================================================
  Execution time = 2.5534e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4625e-01
  Total weights = 1.9641e+06
  Execution time = 3.5190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432682022915
                                         uncertainty =       0.001961760831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432682022915
                                         uncertainty =       0.001961760831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465135758
  error estimate for blocks of size 2^( 2) =       0.000490296843
  error estimate for blocks of size 2^( 3) =       0.000514052887
  error estimate for blocks of size 2^( 4) =       0.000531559057
  error estimate for blocks of size 2^( 5) =       0.000544403588
  error estimate for blocks of size 2^( 6) =       0.000552335692
  error estimate for blocks of size 2^( 7) =       0.000557855460

      target function =      -0.748469624212
              le_mean =     -22.814297423508
             les_mean =     520.938414445298
             stat err =       0.000546538449
             autocorr =       1.380644874045
   target nu stat err =       0.000546538449
   target dn stat err =       0.002835249061
      target stat err =       0.002444948273
              std dev =       0.657801297360
             le_variance =       0.432702546808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432682035607
                                         uncertainty =       0.001961772778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432682035607
                                         uncertainty =       0.001961772778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465135766
  error estimate for blocks of size 2^( 2) =       0.000490296863
  error estimate for blocks of size 2^( 3) =       0.000514052916
  error estimate for blocks of size 2^( 4) =       0.000531559097
  error estimate for blocks of size 2^( 5) =       0.000544403625
  error estimate for blocks of size 2^( 6) =       0.000552335730
  error estimate for blocks of size 2^( 7) =       0.000557855505

      target function =      -0.748469358421
              le_mean =     -22.814297420737
             les_mean =     520.938414636831
             stat err =       0.000546538489
             autocorr =       1.380645031236
   target nu stat err =       0.000546538489
   target dn stat err =       0.002835299903
      target stat err =       0.002444987709
              std dev =       0.657801307970
             le_variance =       0.432702560767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432682029252
                                         uncertainty =       0.001961766804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432682029252
                                         uncertainty =       0.001961766804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465135762
  error estimate for blocks of size 2^( 2) =       0.000490296853
  error estimate for blocks of size 2^( 3) =       0.000514052901
  error estimate for blocks of size 2^( 4) =       0.000531559077
  error estimate for blocks of size 2^( 5) =       0.000544403607
  error estimate for blocks of size 2^( 6) =       0.000552335711
  error estimate for blocks of size 2^( 7) =       0.000557855483

      target function =      -0.748469492639
              le_mean =     -22.814297422122
             les_mean =     520.938414539441
             stat err =       0.000546538469
             autocorr =       1.380644952661
   target nu stat err =       0.000546538469
   target dn stat err =       0.002835274485
      target stat err =       0.002444968002
              std dev =       0.657801302659
             le_variance =       0.432702553779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432682023706
                                         uncertainty =       0.001961761577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432682023706
                                         uncertainty =       0.001961761577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465135759
  error estimate for blocks of size 2^( 2) =       0.000490296844
  error estimate for blocks of size 2^( 3) =       0.000514052888
  error estimate for blocks of size 2^( 4) =       0.000531559059
  error estimate for blocks of size 2^( 5) =       0.000544403590
  error estimate for blocks of size 2^( 6) =       0.000552335695
  error estimate for blocks of size 2^( 7) =       0.000557855463

      target function =      -0.748469607908
              le_mean =     -22.814297423334
             les_mean =     520.938414456891
             stat err =       0.000546538452
             autocorr =       1.380644883875
   target nu stat err =       0.000546538452
   target dn stat err =       0.002835252239
      target stat err =       0.002444950740
              std dev =       0.657801298021
             le_variance =       0.432702547679


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748469624212        initial  <--
     2.5000e+02     2.5000e+03             6.5038e-07        -0.748469358421
     1.0000e+03     1.0000e+04             1.6262e-07        -0.748469492639
     4.0000e+03     4.0000e+04             4.0655e-08        -0.748469607908

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.1654
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.265016e-01 3 1  ON 0
ci_02                -2.871840e-02 3 1  ON 1
ci_03                -2.856508e-02 3 1  ON 2
ci_04                 2.661271e-02 3 1  ON 3
ci_05                -2.187632e-02 3 1  ON 4
ci_06                -2.154273e-02 3 1  ON 5
ci_07                 2.710168e-02 3 1  ON 6
ci_08                -5.456736e-03 3 1  ON 7
ci_09                -8.842308e-03 3 1  ON 8
ci_10                -8.363863e-03 3 1  ON 9
ci_11                 1.311059e-02 3 1  ON 10
ci_12                 6.948264e-03 3 1  ON 11
ci_13                 1.303874e-02 3 1  ON 12
ci_14                 1.252719e-02 3 1  ON 13
ci_15                 6.372308e-03 3 1  ON 14
ci_16                 6.263827e-03 3 1  ON 15
ci_17                -7.198904e-03 3 1  ON 16
ci_18                -6.024443e-03 3 1  ON 17
ci_19                 9.257709e-03 3 1  ON 18
ci_20                 6.518985e-03 3 1  ON 19
ci_21                 8.966885e-03 3 1  ON 20
ci_22                 8.288972e-03 3 1  ON 21
ci_23                 4.852444e-03 3 1  ON 22
ci_24                 4.086651e-03 3 1  ON 23
ci_25                 2.863718e-03 3 1  ON 24
ci_26                 3.086079e-03 3 1  ON 25
ci_27                 3.185097e-03 3 1  ON 26
ci_28                 1.755703e-03 3 1  ON 27
ci_29                 1.455085e-03 3 1  ON 28
ci_30                -1.778657e-03 3 1  ON 29
ci_31                -4.925170e-04 3 1  ON 30
ci_32                -9.486160e-04 3 1  ON 31
ci_33                -1.370794e-03 3 1  ON 32
ci_34                 1.098334e-03 3 1  ON 33
ci_35                 1.541807e-03 3 1  ON 34
ci_36                -1.076515e-03 3 1  ON 35
ci_37                -1.049908e-03 3 1  ON 36
ci_38                -6.345667e-04 3 1  ON 37
ci_39                -6.045465e-04 3 1  ON 38
ci_40                -1.528334e-03 3 1  ON 39
ci_41                -1.186493e-03 3 1  ON 40
ci_42                -1.176165e-03 3 1  ON 41
ci_43                -2.259831e-03 3 1  ON 42
ci_44                -2.993994e-03 3 1  ON 43
ci_45                -5.582127e-04 3 1  ON 44
ci_46                -7.369610e-04 3 1  ON 45
ci_47                 1.562089e-03 3 1  ON 46
ci_48                 1.418056e-03 3 1  ON 47
ci_49                -9.598990e-04 3 1  ON 48
ci_50                -7.632515e-04 3 1  ON 49
ci_51                 1.269241e-04 3 1  ON 50
ci_52                 1.810425e-04 3 1  ON 51
ci_53                -7.047017e-04 3 1  ON 52
ci_54                -1.080372e-03 3 1  ON 53
ci_55                -6.620170e-04 3 1  ON 54
ci_56                 2.501700e-03 3 1  ON 55
ci_57                 1.712992e-03 3 1  ON 56
ci_58                -1.157579e-03 3 1  ON 57
ci_59                -1.431163e-03 3 1  ON 58
ci_60                 1.747333e-04 3 1  ON 59
ci_61                -2.371934e-04 3 1  ON 60
ci_62                -5.529572e-04 3 1  ON 61
ci_63                -6.346612e-04 3 1  ON 62
ci_64                -3.466333e-04 3 1  ON 63
ci_65                 8.914708e-06 3 1  ON 64
ci_66                -6.619828e-04 3 1  ON 65
ci_67                -8.568745e-04 3 1  ON 66
ci_68                -1.184664e-03 3 1  ON 67
ci_69                 9.423064e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3768e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7476
    reference variance = 0.452992
====================================================
  Execution time = 2.7750e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5339e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5262e-01
  Total weights = 1.964419317e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436318807411
                                         uncertainty =       0.002431732748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436318807411
                                         uncertainty =       0.002431732748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467086312
  error estimate for blocks of size 2^( 2) =       0.000492353829
  error estimate for blocks of size 2^( 3) =       0.000516882592
  error estimate for blocks of size 2^( 4) =       0.000533952969
  error estimate for blocks of size 2^( 5) =       0.000545381954
  error estimate for blocks of size 2^( 6) =       0.000550992014
  error estimate for blocks of size 2^( 7) =       0.000551119893

      target function =      -0.743176293597
              le_mean =     -22.814665625249
             les_mean =     520.961584659772
             stat err =       0.000545361708
             autocorr =       1.363248412312
   target nu stat err =       0.000545361708
   target dn stat err =       0.004412937770
      target stat err =       0.003685219510
              std dev =       0.660559797453
             le_variance =       0.436339246011


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281466562525e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743193664946       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743193673069       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743193674256       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743193674491       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743193674598       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743193674616       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743193674632       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743193674642       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743193674639       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743193674636       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 8.908234e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743193664946       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743193666977       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743193667273       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743193667332       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743193667359       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743193667364       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743193667367       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743193667370       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743193667386       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743193667385       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+04 is 2.227088e-08

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743193664946       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743193665454       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743193665528       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743193665537       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743193665552       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743193665550       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743193665542       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743193665546       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743193665618       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743193665508       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+04 is 5.567738e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042549 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2256e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.265016e-01 3 1  ON 0
ci_02                -2.871840e-02 3 1  ON 1
ci_03                -2.856508e-02 3 1  ON 2
ci_04                 2.661271e-02 3 1  ON 3
ci_05                -2.187631e-02 3 1  ON 4
ci_06                -2.154273e-02 3 1  ON 5
ci_07                 2.710168e-02 3 1  ON 6
ci_08                -5.456733e-03 3 1  ON 7
ci_09                -8.842306e-03 3 1  ON 8
ci_10                -8.363865e-03 3 1  ON 9
ci_11                 1.311059e-02 3 1  ON 10
ci_12                 6.948255e-03 3 1  ON 11
ci_13                 1.303874e-02 3 1  ON 12
ci_14                 1.252719e-02 3 1  ON 13
ci_15                 6.372325e-03 3 1  ON 14
ci_16                 6.263826e-03 3 1  ON 15
ci_17                -7.198881e-03 3 1  ON 16
ci_18                -6.024448e-03 3 1  ON 17
ci_19                 9.257708e-03 3 1  ON 18
ci_20                 6.518982e-03 3 1  ON 19
ci_21                 8.966878e-03 3 1  ON 20
ci_22                 8.288972e-03 3 1  ON 21
ci_23                 4.852449e-03 3 1  ON 22
ci_24                 4.086637e-03 3 1  ON 23
ci_25                 2.863716e-03 3 1  ON 24
ci_26                 3.086074e-03 3 1  ON 25
ci_27                 3.185092e-03 3 1  ON 26
ci_28                 1.755701e-03 3 1  ON 27
ci_29                 1.455091e-03 3 1  ON 28
ci_30                -1.778653e-03 3 1  ON 29
ci_31                -4.925202e-04 3 1  ON 30
ci_32                -9.486138e-04 3 1  ON 31
ci_33                -1.370794e-03 3 1  ON 32
ci_34                 1.098341e-03 3 1  ON 33
ci_35                 1.541805e-03 3 1  ON 34
ci_36                -1.076519e-03 3 1  ON 35
ci_37                -1.049910e-03 3 1  ON 36
ci_38                -6.345679e-04 3 1  ON 37
ci_39                -6.045498e-04 3 1  ON 38
ci_40                -1.528343e-03 3 1  ON 39
ci_41                -1.186493e-03 3 1  ON 40
ci_42                -1.176169e-03 3 1  ON 41
ci_43                -2.259821e-03 3 1  ON 42
ci_44                -2.993992e-03 3 1  ON 43
ci_45                -5.582074e-04 3 1  ON 44
ci_46                -7.369596e-04 3 1  ON 45
ci_47                 1.562085e-03 3 1  ON 46
ci_48                 1.418046e-03 3 1  ON 47
ci_49                -9.598997e-04 3 1  ON 48
ci_50                -7.632523e-04 3 1  ON 49
ci_51                 1.269224e-04 3 1  ON 50
ci_52                 1.810442e-04 3 1  ON 51
ci_53                -7.047070e-04 3 1  ON 52
ci_54                -1.080373e-03 3 1  ON 53
ci_55                -6.620165e-04 3 1  ON 54
ci_56                 2.501699e-03 3 1  ON 55
ci_57                 1.712990e-03 3 1  ON 56
ci_58                -1.157575e-03 3 1  ON 57
ci_59                -1.431152e-03 3 1  ON 58
ci_60                 1.747228e-04 3 1  ON 59
ci_61                -2.372139e-04 3 1  ON 60
ci_62                -5.529509e-04 3 1  ON 61
ci_63                -6.346540e-04 3 1  ON 62
ci_64                -3.466336e-04 3 1  ON 63
ci_65                 8.913763e-06 3 1  ON 64
ci_66                -6.619841e-04 3 1  ON 65
ci_67                -8.568774e-04 3 1  ON 66
ci_68                -1.184662e-03 3 1  ON 67
ci_69                 9.421763e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8404
    reference variance = 0.621969
====================================================
  Execution time = 2.5292e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5018e-01
  Total weights = 1.9646e+06
  Execution time = 3.5167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436780075059
                                         uncertainty =       0.002879984195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436780075059
                                         uncertainty =       0.002879984195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467333008
  error estimate for blocks of size 2^( 2) =       0.000492260323
  error estimate for blocks of size 2^( 3) =       0.000516101325
  error estimate for blocks of size 2^( 4) =       0.000533675286
  error estimate for blocks of size 2^( 5) =       0.000543538954
  error estimate for blocks of size 2^( 6) =       0.000550823423
  error estimate for blocks of size 2^( 7) =       0.000553573663

      target function =      -0.745196100163
              le_mean =     -22.815280969883
             les_mean =     520.987224909374
             stat err =       0.000545402832
             autocorr =       1.362014914683
   target nu stat err =       0.000545402832
   target dn stat err =       0.003441578554
      target stat err =       0.002916938489
              std dev =       0.660908678419
             le_variance =       0.436800281209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436780061643
                                         uncertainty =       0.002879982898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436780061643
                                         uncertainty =       0.002879982898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467333001
  error estimate for blocks of size 2^( 2) =       0.000492260317
  error estimate for blocks of size 2^( 3) =       0.000516101320
  error estimate for blocks of size 2^( 4) =       0.000533675281
  error estimate for blocks of size 2^( 5) =       0.000543538950
  error estimate for blocks of size 2^( 6) =       0.000550823420
  error estimate for blocks of size 2^( 7) =       0.000553573661

      target function =      -0.745196090230
              le_mean =     -22.815280969987
             les_mean =     520.987224926139
             stat err =       0.000545402828
             autocorr =       1.362014937671
   target nu stat err =       0.000545402828
   target dn stat err =       0.003441574862
      target stat err =       0.002916935419
              std dev =       0.660908668427
             le_variance =       0.436800268002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436780068351
                                         uncertainty =       0.002879983546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436780068351
                                         uncertainty =       0.002879983546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467333005
  error estimate for blocks of size 2^( 2) =       0.000492260320
  error estimate for blocks of size 2^( 3) =       0.000516101323
  error estimate for blocks of size 2^( 4) =       0.000533675284
  error estimate for blocks of size 2^( 5) =       0.000543538952
  error estimate for blocks of size 2^( 6) =       0.000550823422
  error estimate for blocks of size 2^( 7) =       0.000553573662

      target function =      -0.745196095252
              le_mean =     -22.815280969935
             les_mean =     520.987224917689
             stat err =       0.000545402830
             autocorr =       1.362014926176
   target nu stat err =       0.000545402830
   target dn stat err =       0.003441576708
      target stat err =       0.002916936954
              std dev =       0.660908673422
             le_variance =       0.436800274605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436780074221
                                         uncertainty =       0.002879984114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436780074221
                                         uncertainty =       0.002879984114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467333008
  error estimate for blocks of size 2^( 2) =       0.000492260323
  error estimate for blocks of size 2^( 3) =       0.000516101325
  error estimate for blocks of size 2^( 4) =       0.000533675286
  error estimate for blocks of size 2^( 5) =       0.000543538954
  error estimate for blocks of size 2^( 6) =       0.000550823423
  error estimate for blocks of size 2^( 7) =       0.000553573663

      target function =      -0.745196099555
              le_mean =     -22.815280969889
             les_mean =     520.987224910406
             stat err =       0.000545402832
             autocorr =       1.362014916122
   target nu stat err =       0.000545402832
   target dn stat err =       0.003441578323
      target stat err =       0.002916938297
              std dev =       0.660908677794
             le_variance =       0.436800280383


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745196100163        initial  <--
     2.5000e+03     2.5000e+04             8.9082e-08        -0.745196090230
     1.0000e+04     1.0000e+05             2.2271e-08        -0.745196095252
     4.0000e+04     4.0000e+05             5.5677e-09        -0.745196099555

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8672
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.265016e-01 3 1  ON 0
ci_02                -2.871840e-02 3 1  ON 1
ci_03                -2.856508e-02 3 1  ON 2
ci_04                 2.661271e-02 3 1  ON 3
ci_05                -2.187632e-02 3 1  ON 4
ci_06                -2.154273e-02 3 1  ON 5
ci_07                 2.710168e-02 3 1  ON 6
ci_08                -5.456736e-03 3 1  ON 7
ci_09                -8.842308e-03 3 1  ON 8
ci_10                -8.363863e-03 3 1  ON 9
ci_11                 1.311059e-02 3 1  ON 10
ci_12                 6.948264e-03 3 1  ON 11
ci_13                 1.303874e-02 3 1  ON 12
ci_14                 1.252719e-02 3 1  ON 13
ci_15                 6.372308e-03 3 1  ON 14
ci_16                 6.263827e-03 3 1  ON 15
ci_17                -7.198904e-03 3 1  ON 16
ci_18                -6.024443e-03 3 1  ON 17
ci_19                 9.257709e-03 3 1  ON 18
ci_20                 6.518985e-03 3 1  ON 19
ci_21                 8.966885e-03 3 1  ON 20
ci_22                 8.288972e-03 3 1  ON 21
ci_23                 4.852444e-03 3 1  ON 22
ci_24                 4.086651e-03 3 1  ON 23
ci_25                 2.863718e-03 3 1  ON 24
ci_26                 3.086079e-03 3 1  ON 25
ci_27                 3.185097e-03 3 1  ON 26
ci_28                 1.755703e-03 3 1  ON 27
ci_29                 1.455085e-03 3 1  ON 28
ci_30                -1.778657e-03 3 1  ON 29
ci_31                -4.925170e-04 3 1  ON 30
ci_32                -9.486160e-04 3 1  ON 31
ci_33                -1.370794e-03 3 1  ON 32
ci_34                 1.098334e-03 3 1  ON 33
ci_35                 1.541807e-03 3 1  ON 34
ci_36                -1.076515e-03 3 1  ON 35
ci_37                -1.049908e-03 3 1  ON 36
ci_38                -6.345667e-04 3 1  ON 37
ci_39                -6.045465e-04 3 1  ON 38
ci_40                -1.528334e-03 3 1  ON 39
ci_41                -1.186493e-03 3 1  ON 40
ci_42                -1.176165e-03 3 1  ON 41
ci_43                -2.259831e-03 3 1  ON 42
ci_44                -2.993994e-03 3 1  ON 43
ci_45                -5.582127e-04 3 1  ON 44
ci_46                -7.369610e-04 3 1  ON 45
ci_47                 1.562089e-03 3 1  ON 46
ci_48                 1.418056e-03 3 1  ON 47
ci_49                -9.598990e-04 3 1  ON 48
ci_50                -7.632515e-04 3 1  ON 49
ci_51                 1.269241e-04 3 1  ON 50
ci_52                 1.810425e-04 3 1  ON 51
ci_53                -7.047017e-04 3 1  ON 52
ci_54                -1.080372e-03 3 1  ON 53
ci_55                -6.620170e-04 3 1  ON 54
ci_56                 2.501700e-03 3 1  ON 55
ci_57                 1.712992e-03 3 1  ON 56
ci_58                -1.157579e-03 3 1  ON 57
ci_59                -1.431163e-03 3 1  ON 58
ci_60                 1.747333e-04 3 1  ON 59
ci_61                -2.371934e-04 3 1  ON 60
ci_62                -5.529572e-04 3 1  ON 61
ci_63                -6.346612e-04 3 1  ON 62
ci_64                -3.466333e-04 3 1  ON 63
ci_65                 8.914708e-06 3 1  ON 64
ci_66                -6.619828e-04 3 1  ON 65
ci_67                -8.568745e-04 3 1  ON 66
ci_68                -1.184664e-03 3 1  ON 67
ci_69                 9.423064e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5130e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.7754
    reference variance = 0.587181
====================================================
  Execution time = 2.5772e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4568e-01
  Total weights = 1.964437257e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433284229608
                                         uncertainty =       0.001906200895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433284229608
                                         uncertainty =       0.001906200895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465461479
  error estimate for blocks of size 2^( 2) =       0.000490906934
  error estimate for blocks of size 2^( 3) =       0.000514711863
  error estimate for blocks of size 2^( 4) =       0.000532377848
  error estimate for blocks of size 2^( 5) =       0.000543786392
  error estimate for blocks of size 2^( 6) =       0.000550811291
  error estimate for blocks of size 2^( 7) =       0.000554178642

      target function =      -0.748952375373
              le_mean =     -22.814995438631
             les_mean =     520.969692428707
             stat err =       0.000545288543
             autocorr =       1.372414367732
   target nu stat err =       0.000545288543
   target dn stat err =       0.002544418852
      target stat err =       0.002215244756
              std dev =       0.658261936034
             le_variance =       0.433308776431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281499543863e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748957930634       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748957931114       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748957931199       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748957931214       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748957931213       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748957931213       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748957931214       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748957931207       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748957931216       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+04 is 8.023769e-09

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748957930634       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748957930754       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748957930775       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748957930779       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748957930779       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748957930779       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748957930999       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748957930745       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748957930938       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+05 is 2.005944e-09

solving harmonic davidson linear method for identity shift 4.0000e+05, overlap shift 4.0000e+06 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748957930634       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748957930664       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748957930669       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748957930670       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748957930675       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748957930380       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748957930670       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748957930739       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748957930161       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+05 is 5.014862e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045629 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0304e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.265016e-01 3 1  ON 0
ci_02                -2.871840e-02 3 1  ON 1
ci_03                -2.856508e-02 3 1  ON 2
ci_04                 2.661271e-02 3 1  ON 3
ci_05                -2.187632e-02 3 1  ON 4
ci_06                -2.154273e-02 3 1  ON 5
ci_07                 2.710168e-02 3 1  ON 6
ci_08                -5.456736e-03 3 1  ON 7
ci_09                -8.842308e-03 3 1  ON 8
ci_10                -8.363863e-03 3 1  ON 9
ci_11                 1.311059e-02 3 1  ON 10
ci_12                 6.948265e-03 3 1  ON 11
ci_13                 1.303874e-02 3 1  ON 12
ci_14                 1.252719e-02 3 1  ON 13
ci_15                 6.372308e-03 3 1  ON 14
ci_16                 6.263827e-03 3 1  ON 15
ci_17                -7.198903e-03 3 1  ON 16
ci_18                -6.024443e-03 3 1  ON 17
ci_19                 9.257709e-03 3 1  ON 18
ci_20                 6.518985e-03 3 1  ON 19
ci_21                 8.966885e-03 3 1  ON 20
ci_22                 8.288972e-03 3 1  ON 21
ci_23                 4.852444e-03 3 1  ON 22
ci_24                 4.086651e-03 3 1  ON 23
ci_25                 2.863718e-03 3 1  ON 24
ci_26                 3.086079e-03 3 1  ON 25
ci_27                 3.185097e-03 3 1  ON 26
ci_28                 1.755702e-03 3 1  ON 27
ci_29                 1.455085e-03 3 1  ON 28
ci_30                -1.778656e-03 3 1  ON 29
ci_31                -4.925172e-04 3 1  ON 30
ci_32                -9.486155e-04 3 1  ON 31
ci_33                -1.370793e-03 3 1  ON 32
ci_34                 1.098335e-03 3 1  ON 33
ci_35                 1.541808e-03 3 1  ON 34
ci_36                -1.076515e-03 3 1  ON 35
ci_37                -1.049908e-03 3 1  ON 36
ci_38                -6.345667e-04 3 1  ON 37
ci_39                -6.045467e-04 3 1  ON 38
ci_40                -1.528334e-03 3 1  ON 39
ci_41                -1.186492e-03 3 1  ON 40
ci_42                -1.176166e-03 3 1  ON 41
ci_43                -2.259831e-03 3 1  ON 42
ci_44                -2.993992e-03 3 1  ON 43
ci_45                -5.582129e-04 3 1  ON 44
ci_46                -7.369606e-04 3 1  ON 45
ci_47                 1.562089e-03 3 1  ON 46
ci_48                 1.418057e-03 3 1  ON 47
ci_49                -9.598989e-04 3 1  ON 48
ci_50                -7.632519e-04 3 1  ON 49
ci_51                 1.269242e-04 3 1  ON 50
ci_52                 1.810427e-04 3 1  ON 51
ci_53                -7.047022e-04 3 1  ON 52
ci_54                -1.080372e-03 3 1  ON 53
ci_55                -6.620175e-04 3 1  ON 54
ci_56                 2.501699e-03 3 1  ON 55
ci_57                 1.712992e-03 3 1  ON 56
ci_58                -1.157578e-03 3 1  ON 57
ci_59                -1.431163e-03 3 1  ON 58
ci_60                 1.747334e-04 3 1  ON 59
ci_61                -2.371938e-04 3 1  ON 60
ci_62                -5.529570e-04 3 1  ON 61
ci_63                -6.346612e-04 3 1  ON 62
ci_64                -3.466327e-04 3 1  ON 63
ci_65                 8.914187e-06 3 1  ON 64
ci_66                -6.619831e-04 3 1  ON 65
ci_67                -8.568742e-04 3 1  ON 66
ci_68                -1.184663e-03 3 1  ON 67
ci_69                 9.422989e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.7735
    reference variance = 0.353146
====================================================
  Execution time = 2.5339e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5402e-01
  Total weights = 1.9645e+06
  Execution time = 3.4769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437502531953
                                         uncertainty =       0.002272771328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437502531953
                                         uncertainty =       0.002272771328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467678383
  error estimate for blocks of size 2^( 2) =       0.000493387278
  error estimate for blocks of size 2^( 3) =       0.000517226696
  error estimate for blocks of size 2^( 4) =       0.000534961238
  error estimate for blocks of size 2^( 5) =       0.000544976562
  error estimate for blocks of size 2^( 6) =       0.000551800518
  error estimate for blocks of size 2^( 7) =       0.000555824981

      target function =      -0.742015615859
              le_mean =     -22.814420041490
             les_mean =     520.951786602306
             stat err =       0.000546890825
             autocorr =       1.367434969203
   target nu stat err =       0.000546890825
   target dn stat err =       0.004899896971
      target stat err =       0.004067649616
              std dev =       0.661397111887
             le_variance =       0.437446139612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437502530781
                                         uncertainty =       0.002272771201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437502530781
                                         uncertainty =       0.002272771201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467678382
  error estimate for blocks of size 2^( 2) =       0.000493387277
  error estimate for blocks of size 2^( 3) =       0.000517226696
  error estimate for blocks of size 2^( 4) =       0.000534961238
  error estimate for blocks of size 2^( 5) =       0.000544976563
  error estimate for blocks of size 2^( 6) =       0.000551800519
  error estimate for blocks of size 2^( 7) =       0.000555824981

      target function =      -0.742015627656
              le_mean =     -22.814420041474
             les_mean =     520.951786587199
             stat err =       0.000546890825
             autocorr =       1.367434973983
   target nu stat err =       0.000546890825
   target dn stat err =       0.004899896515
      target stat err =       0.004067649374
              std dev =       0.661397110998
             le_variance =       0.437446138437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437502531367
                                         uncertainty =       0.002272771265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437502531367
                                         uncertainty =       0.002272771265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467678383
  error estimate for blocks of size 2^( 2) =       0.000493387278
  error estimate for blocks of size 2^( 3) =       0.000517226696
  error estimate for blocks of size 2^( 4) =       0.000534961238
  error estimate for blocks of size 2^( 5) =       0.000544976562
  error estimate for blocks of size 2^( 6) =       0.000551800518
  error estimate for blocks of size 2^( 7) =       0.000555824981

      target function =      -0.742015621758
              le_mean =     -22.814420041482
             les_mean =     520.951786594752
             stat err =       0.000546890825
             autocorr =       1.367434971597
   target nu stat err =       0.000546890825
   target dn stat err =       0.004899896743
      target stat err =       0.004067649495
              std dev =       0.661397111443
             le_variance =       0.437446139025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437502531880
                                         uncertainty =       0.002272771320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437502531880
                                         uncertainty =       0.002272771320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467678383
  error estimate for blocks of size 2^( 2) =       0.000493387278
  error estimate for blocks of size 2^( 3) =       0.000517226696
  error estimate for blocks of size 2^( 4) =       0.000534961238
  error estimate for blocks of size 2^( 5) =       0.000544976562
  error estimate for blocks of size 2^( 6) =       0.000551800518
  error estimate for blocks of size 2^( 7) =       0.000555824981

      target function =      -0.742015616596
              le_mean =     -22.814420041489
             les_mean =     520.951786601362
             stat err =       0.000546890825
             autocorr =       1.367434969508
   target nu stat err =       0.000546890825
   target dn stat err =       0.004899896943
      target stat err =       0.004067649601
              std dev =       0.661397111831
             le_variance =       0.437446139539


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742015615859        initial
     2.5000e+04     2.5000e+05             8.0238e-09        -0.742015627656  <--
     1.0000e+05     1.0000e+06             2.0059e-09        -0.742015621758
     4.0000e+05     4.0000e+06             5.0149e-10        -0.742015616596

*****************************************************************************
Applying the update for shift_i =   2.5000e+04     and shift_s =   2.5000e+05
*****************************************************************************

  Execution time = 4.2756e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.265016e-01 3 1  ON 0
ci_02                -2.871840e-02 3 1  ON 1
ci_03                -2.856507e-02 3 1  ON 2
ci_04                 2.661271e-02 3 1  ON 3
ci_05                -2.187632e-02 3 1  ON 4
ci_06                -2.154273e-02 3 1  ON 5
ci_07                 2.710168e-02 3 1  ON 6
ci_08                -5.456734e-03 3 1  ON 7
ci_09                -8.842306e-03 3 1  ON 8
ci_10                -8.363860e-03 3 1  ON 9
ci_11                 1.311059e-02 3 1  ON 10
ci_12                 6.948267e-03 3 1  ON 11
ci_13                 1.303874e-02 3 1  ON 12
ci_14                 1.252719e-02 3 1  ON 13
ci_15                 6.372310e-03 3 1  ON 14
ci_16                 6.263827e-03 3 1  ON 15
ci_17                -7.198903e-03 3 1  ON 16
ci_18                -6.024443e-03 3 1  ON 17
ci_19                 9.257707e-03 3 1  ON 18
ci_20                 6.518985e-03 3 1  ON 19
ci_21                 8.966884e-03 3 1  ON 20
ci_22                 8.288973e-03 3 1  ON 21
ci_23                 4.852444e-03 3 1  ON 22
ci_24                 4.086650e-03 3 1  ON 23
ci_25                 2.863720e-03 3 1  ON 24
ci_26                 3.086080e-03 3 1  ON 25
ci_27                 3.185096e-03 3 1  ON 26
ci_28                 1.755701e-03 3 1  ON 27
ci_29                 1.455085e-03 3 1  ON 28
ci_30                -1.778655e-03 3 1  ON 29
ci_31                -4.925176e-04 3 1  ON 30
ci_32                -9.486140e-04 3 1  ON 31
ci_33                -1.370793e-03 3 1  ON 32
ci_34                 1.098336e-03 3 1  ON 33
ci_35                 1.541809e-03 3 1  ON 34
ci_36                -1.076515e-03 3 1  ON 35
ci_37                -1.049909e-03 3 1  ON 36
ci_38                -6.345667e-04 3 1  ON 37
ci_39                -6.045475e-04 3 1  ON 38
ci_40                -1.528335e-03 3 1  ON 39
ci_41                -1.186492e-03 3 1  ON 40
ci_42                -1.176167e-03 3 1  ON 41
ci_43                -2.259832e-03 3 1  ON 42
ci_44                -2.993988e-03 3 1  ON 43
ci_45                -5.582135e-04 3 1  ON 44
ci_46                -7.369594e-04 3 1  ON 45
ci_47                 1.562089e-03 3 1  ON 46
ci_48                 1.418058e-03 3 1  ON 47
ci_49                -9.598986e-04 3 1  ON 48
ci_50                -7.632532e-04 3 1  ON 49
ci_51                 1.269248e-04 3 1  ON 50
ci_52                 1.810433e-04 3 1  ON 51
ci_53                -7.047035e-04 3 1  ON 52
ci_54                -1.080372e-03 3 1  ON 53
ci_55                -6.620192e-04 3 1  ON 54
ci_56                 2.501697e-03 3 1  ON 55
ci_57                 1.712991e-03 3 1  ON 56
ci_58                -1.157578e-03 3 1  ON 57
ci_59                -1.431162e-03 3 1  ON 58
ci_60                 1.747336e-04 3 1  ON 59
ci_61                -2.371952e-04 3 1  ON 60
ci_62                -5.529567e-04 3 1  ON 61
ci_63                -6.346610e-04 3 1  ON 62
ci_64                -3.466309e-04 3 1  ON 63
ci_65                 8.912625e-06 3 1  ON 64
ci_66                -6.619839e-04 3 1  ON 65
ci_67                -8.568734e-04 3 1  ON 66
ci_68                -1.184662e-03 3 1  ON 67
ci_69                 9.422763e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3068e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8447
    reference variance = 0.587074
====================================================
  Execution time = 2.7764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5190e-01
  Total weights = 1.964250667e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437234003475
                                         uncertainty =       0.002313124873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437234003475
                                         uncertainty =       0.002313124873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467565014
  error estimate for blocks of size 2^( 2) =       0.000493129454
  error estimate for blocks of size 2^( 3) =       0.000517147265
  error estimate for blocks of size 2^( 4) =       0.000534708380
  error estimate for blocks of size 2^( 5) =       0.000545265037
  error estimate for blocks of size 2^( 6) =       0.000552337286
  error estimate for blocks of size 2^( 7) =       0.000553975956

      target function =      -0.743773048646
              le_mean =     -22.814565862517
             les_mean =     520.956317916673
             stat err =       0.000546571665
             autocorr =       1.366501810393
   target nu stat err =       0.000546571665
   target dn stat err =       0.003394808654
      target stat err =       0.002865496993
              std dev =       0.661236784482
             le_variance =       0.437234085152


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281456586252e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743783142042       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743783144334       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743783144724       residual = 8.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743783144861       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743783144910       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743783144924       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743783144913       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743783144915       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743783144918       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+03 is 5.139636e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743783142042       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743783142615       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743783142713       residual = 8.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743783142742       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743783142765       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743783142775       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743783142759       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743783142761       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743783142819       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+04 is 1.284913e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743783142042       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743783142186       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743783142210       residual = 8.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743783142219       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743783142160       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743783142147       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743783142102       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743783142268       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743783142137       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+05 is 3.212284e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048768 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2330e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.265016e-01 3 1  ON 0
ci_02                -2.871840e-02 3 1  ON 1
ci_03                -2.856507e-02 3 1  ON 2
ci_04                 2.661271e-02 3 1  ON 3
ci_05                -2.187632e-02 3 1  ON 4
ci_06                -2.154273e-02 3 1  ON 5
ci_07                 2.710168e-02 3 1  ON 6
ci_08                -5.456734e-03 3 1  ON 7
ci_09                -8.842309e-03 3 1  ON 8
ci_10                -8.363856e-03 3 1  ON 9
ci_11                 1.311059e-02 3 1  ON 10
ci_12                 6.948268e-03 3 1  ON 11
ci_13                 1.303874e-02 3 1  ON 12
ci_14                 1.252719e-02 3 1  ON 13
ci_15                 6.372309e-03 3 1  ON 14
ci_16                 6.263826e-03 3 1  ON 15
ci_17                -7.198897e-03 3 1  ON 16
ci_18                -6.024447e-03 3 1  ON 17
ci_19                 9.257707e-03 3 1  ON 18
ci_20                 6.518986e-03 3 1  ON 19
ci_21                 8.966887e-03 3 1  ON 20
ci_22                 8.288972e-03 3 1  ON 21
ci_23                 4.852444e-03 3 1  ON 22
ci_24                 4.086651e-03 3 1  ON 23
ci_25                 2.863719e-03 3 1  ON 24
ci_26                 3.086080e-03 3 1  ON 25
ci_27                 3.185096e-03 3 1  ON 26
ci_28                 1.755702e-03 3 1  ON 27
ci_29                 1.455084e-03 3 1  ON 28
ci_30                -1.778656e-03 3 1  ON 29
ci_31                -4.925181e-04 3 1  ON 30
ci_32                -9.486134e-04 3 1  ON 31
ci_33                -1.370796e-03 3 1  ON 32
ci_34                 1.098336e-03 3 1  ON 33
ci_35                 1.541807e-03 3 1  ON 34
ci_36                -1.076515e-03 3 1  ON 35
ci_37                -1.049910e-03 3 1  ON 36
ci_38                -6.345685e-04 3 1  ON 37
ci_39                -6.045480e-04 3 1  ON 38
ci_40                -1.528333e-03 3 1  ON 39
ci_41                -1.186493e-03 3 1  ON 40
ci_42                -1.176168e-03 3 1  ON 41
ci_43                -2.259832e-03 3 1  ON 42
ci_44                -2.993989e-03 3 1  ON 43
ci_45                -5.582134e-04 3 1  ON 44
ci_46                -7.369574e-04 3 1  ON 45
ci_47                 1.562090e-03 3 1  ON 46
ci_48                 1.418058e-03 3 1  ON 47
ci_49                -9.598996e-04 3 1  ON 48
ci_50                -7.632521e-04 3 1  ON 49
ci_51                 1.269249e-04 3 1  ON 50
ci_52                 1.810440e-04 3 1  ON 51
ci_53                -7.047037e-04 3 1  ON 52
ci_54                -1.080372e-03 3 1  ON 53
ci_55                -6.620208e-04 3 1  ON 54
ci_56                 2.501694e-03 3 1  ON 55
ci_57                 1.712991e-03 3 1  ON 56
ci_58                -1.157577e-03 3 1  ON 57
ci_59                -1.431160e-03 3 1  ON 58
ci_60                 1.747310e-04 3 1  ON 59
ci_61                -2.371951e-04 3 1  ON 60
ci_62                -5.529584e-04 3 1  ON 61
ci_63                -6.346581e-04 3 1  ON 62
ci_64                -3.466338e-04 3 1  ON 63
ci_65                 8.913250e-06 3 1  ON 64
ci_66                -6.619846e-04 3 1  ON 65
ci_67                -8.568725e-04 3 1  ON 66
ci_68                -1.184663e-03 3 1  ON 67
ci_69                 9.422747e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8255
    reference variance = 0.455427
====================================================
  Execution time = 2.5221e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5072e-01
  Total weights = 1.9642e+06
  Execution time = 3.4820e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436365618880
                                         uncertainty =       0.002202213036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436365618880
                                         uncertainty =       0.002202213036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467105925
  error estimate for blocks of size 2^( 2) =       0.000492215582
  error estimate for blocks of size 2^( 3) =       0.000516264241
  error estimate for blocks of size 2^( 4) =       0.000533844225
  error estimate for blocks of size 2^( 5) =       0.000545809097
  error estimate for blocks of size 2^( 6) =       0.000553151044
  error estimate for blocks of size 2^( 7) =       0.000559645881

      target function =      -0.744751235975
              le_mean =     -22.813694971334
             les_mean =     520.915396663563
             stat err =       0.000548112562
             autocorr =       1.376920158476
   target nu stat err =       0.000548112562
   target dn stat err =       0.003475234183
      target stat err =       0.002934470131
              std dev =       0.660587534585
             le_variance =       0.436375890849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436365615736
                                         uncertainty =       0.002202213645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436365615736
                                         uncertainty =       0.002202213645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467105924
  error estimate for blocks of size 2^( 2) =       0.000492215582
  error estimate for blocks of size 2^( 3) =       0.000516264242
  error estimate for blocks of size 2^( 4) =       0.000533844227
  error estimate for blocks of size 2^( 5) =       0.000545809099
  error estimate for blocks of size 2^( 6) =       0.000553151046
  error estimate for blocks of size 2^( 7) =       0.000559645885

      target function =      -0.744751241215
              le_mean =     -22.813694971459
             les_mean =     520.915396662912
             stat err =       0.000548112564
             autocorr =       1.376920180874
   target nu stat err =       0.000548112564
   target dn stat err =       0.003475235194
      target stat err =       0.002934470991
              std dev =       0.660587532205
             le_variance =       0.436375887705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436365617308
                                         uncertainty =       0.002202213340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436365617308
                                         uncertainty =       0.002202213340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467105924
  error estimate for blocks of size 2^( 2) =       0.000492215582
  error estimate for blocks of size 2^( 3) =       0.000516264242
  error estimate for blocks of size 2^( 4) =       0.000533844226
  error estimate for blocks of size 2^( 5) =       0.000545809098
  error estimate for blocks of size 2^( 6) =       0.000553151045
  error estimate for blocks of size 2^( 7) =       0.000559645883

      target function =      -0.744751238597
              le_mean =     -22.813694971396
             les_mean =     520.915396663235
             stat err =       0.000548112563
             autocorr =       1.376920169680
   target nu stat err =       0.000548112563
   target dn stat err =       0.003475234689
      target stat err =       0.002934470561
              std dev =       0.660587533395
             le_variance =       0.436375889277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436365618683
                                         uncertainty =       0.002202213074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436365618683
                                         uncertainty =       0.002202213074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467105925
  error estimate for blocks of size 2^( 2) =       0.000492215582
  error estimate for blocks of size 2^( 3) =       0.000516264241
  error estimate for blocks of size 2^( 4) =       0.000533844225
  error estimate for blocks of size 2^( 5) =       0.000545809097
  error estimate for blocks of size 2^( 6) =       0.000553151044
  error estimate for blocks of size 2^( 7) =       0.000559645882

      target function =      -0.744751236303
              le_mean =     -22.813694971342
             les_mean =     520.915396663522
             stat err =       0.000548112562
             autocorr =       1.376920159888
   target nu stat err =       0.000548112562
   target dn stat err =       0.003475234246
      target stat err =       0.002934470185
              std dev =       0.660587534436
             le_variance =       0.436375890653


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744751235975        initial
     6.2500e+03     6.2500e+04             5.1396e-08        -0.744751241215  <--
     2.5000e+04     2.5000e+05             1.2849e-08        -0.744751238597
     1.0000e+05     1.0000e+06             3.2123e-09        -0.744751236303

*****************************************************************************
Applying the update for shift_i =   6.2500e+03     and shift_s =   6.2500e+04
*****************************************************************************

  Execution time = 4.2650e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.265016e-01 3 1  ON 0
ci_02                -2.871838e-02 3 1  ON 1
ci_03                -2.856506e-02 3 1  ON 2
ci_04                 2.661270e-02 3 1  ON 3
ci_05                -2.187632e-02 3 1  ON 4
ci_06                -2.154274e-02 3 1  ON 5
ci_07                 2.710167e-02 3 1  ON 6
ci_08                -5.456731e-03 3 1  ON 7
ci_09                -8.842315e-03 3 1  ON 8
ci_10                -8.363846e-03 3 1  ON 9
ci_11                 1.311060e-02 3 1  ON 10
ci_12                 6.948270e-03 3 1  ON 11
ci_13                 1.303874e-02 3 1  ON 12
ci_14                 1.252720e-02 3 1  ON 13
ci_15                 6.372306e-03 3 1  ON 14
ci_16                 6.263824e-03 3 1  ON 15
ci_17                -7.198881e-03 3 1  ON 16
ci_18                -6.024459e-03 3 1  ON 17
ci_19                 9.257705e-03 3 1  ON 18
ci_20                 6.518990e-03 3 1  ON 19
ci_21                 8.966895e-03 3 1  ON 20
ci_22                 8.288971e-03 3 1  ON 21
ci_23                 4.852442e-03 3 1  ON 22
ci_24                 4.086652e-03 3 1  ON 23
ci_25                 2.863716e-03 3 1  ON 24
ci_26                 3.086080e-03 3 1  ON 25
ci_27                 3.185095e-03 3 1  ON 26
ci_28                 1.755706e-03 3 1  ON 27
ci_29                 1.455081e-03 3 1  ON 28
ci_30                -1.778659e-03 3 1  ON 29
ci_31                -4.925198e-04 3 1  ON 30
ci_32                -9.486115e-04 3 1  ON 31
ci_33                -1.370806e-03 3 1  ON 32
ci_34                 1.098333e-03 3 1  ON 33
ci_35                 1.541804e-03 3 1  ON 34
ci_36                -1.076514e-03 3 1  ON 35
ci_37                -1.049915e-03 3 1  ON 36
ci_38                -6.345741e-04 3 1  ON 37
ci_39                -6.045496e-04 3 1  ON 38
ci_40                -1.528327e-03 3 1  ON 39
ci_41                -1.186495e-03 3 1  ON 40
ci_42                -1.176170e-03 3 1  ON 41
ci_43                -2.259834e-03 3 1  ON 42
ci_44                -2.993992e-03 3 1  ON 43
ci_45                -5.582130e-04 3 1  ON 44
ci_46                -7.369514e-04 3 1  ON 45
ci_47                 1.562093e-03 3 1  ON 46
ci_48                 1.418057e-03 3 1  ON 47
ci_49                -9.599027e-04 3 1  ON 48
ci_50                -7.632487e-04 3 1  ON 49
ci_51                 1.269252e-04 3 1  ON 50
ci_52                 1.810461e-04 3 1  ON 51
ci_53                -7.047043e-04 3 1  ON 52
ci_54                -1.080375e-03 3 1  ON 53
ci_55                -6.620258e-04 3 1  ON 54
ci_56                 2.501685e-03 3 1  ON 55
ci_57                 1.712989e-03 3 1  ON 56
ci_58                -1.157574e-03 3 1  ON 57
ci_59                -1.431155e-03 3 1  ON 58
ci_60                 1.747231e-04 3 1  ON 59
ci_61                -2.371949e-04 3 1  ON 60
ci_62                -5.529634e-04 3 1  ON 61
ci_63                -6.346493e-04 3 1  ON 62
ci_64                -3.466424e-04 3 1  ON 63
ci_65                 8.915125e-06 3 1  ON 64
ci_66                -6.619865e-04 3 1  ON 65
ci_67                -8.568698e-04 3 1  ON 66
ci_68                -1.184666e-03 3 1  ON 67
ci_69                 9.422697e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4987e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8298
    reference variance = 0.35484
====================================================
  Execution time = 2.5890e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5324e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4336e-01
  Total weights = 1.964545412e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4812e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432438064392
                                         uncertainty =       0.002484776284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432438064392
                                         uncertainty =       0.002484776284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464964839
  error estimate for blocks of size 2^( 2) =       0.000490447569
  error estimate for blocks of size 2^( 3) =       0.000513935416
  error estimate for blocks of size 2^( 4) =       0.000531599941
  error estimate for blocks of size 2^( 5) =       0.000542663858
  error estimate for blocks of size 2^( 6) =       0.000548356673
  error estimate for blocks of size 2^( 7) =       0.000551946258

      target function =      -0.750890987580
              le_mean =     -22.815000939405
             les_mean =     520.967628295340
             stat err =       0.000543641683
             autocorr =       1.367052747644
   target nu stat err =       0.000543641683
   target dn stat err =       0.003297537960
      target stat err =       0.002840588363
              std dev =       0.657559580723
             le_variance =       0.432384602200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281500093940e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750900862791       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750900865872       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750900866354       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750900866546       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750900866567       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750900866583       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750900866582       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750900866582       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750900866580       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 8.941954e-08

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750900862791       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750900863561       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750900863682       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750900863730       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750900863733       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750900863737       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750900863739       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750900863735       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750900863738       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+03 is 2.235518e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750900862791       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750900862984       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750900863014       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750900863022       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750900863026       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750900863039       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750900863018       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750900863021       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750900863053       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+04 is 5.588813e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051850 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0380e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.265016e-01 3 1  ON 0
ci_02                -2.871837e-02 3 1  ON 1
ci_03                -2.856506e-02 3 1  ON 2
ci_04                 2.661270e-02 3 1  ON 3
ci_05                -2.187631e-02 3 1  ON 4
ci_06                -2.154273e-02 3 1  ON 5
ci_07                 2.710167e-02 3 1  ON 6
ci_08                -5.456734e-03 3 1  ON 7
ci_09                -8.842305e-03 3 1  ON 8
ci_10                -8.363837e-03 3 1  ON 9
ci_11                 1.311059e-02 3 1  ON 10
ci_12                 6.948276e-03 3 1  ON 11
ci_13                 1.303874e-02 3 1  ON 12
ci_14                 1.252721e-02 3 1  ON 13
ci_15                 6.372305e-03 3 1  ON 14
ci_16                 6.263826e-03 3 1  ON 15
ci_17                -7.198875e-03 3 1  ON 16
ci_18                -6.024459e-03 3 1  ON 17
ci_19                 9.257700e-03 3 1  ON 18
ci_20                 6.518992e-03 3 1  ON 19
ci_21                 8.966891e-03 3 1  ON 20
ci_22                 8.288978e-03 3 1  ON 21
ci_23                 4.852439e-03 3 1  ON 22
ci_24                 4.086655e-03 3 1  ON 23
ci_25                 2.863717e-03 3 1  ON 24
ci_26                 3.086077e-03 3 1  ON 25
ci_27                 3.185096e-03 3 1  ON 26
ci_28                 1.755711e-03 3 1  ON 27
ci_29                 1.455076e-03 3 1  ON 28
ci_30                -1.778647e-03 3 1  ON 29
ci_31                -4.925214e-04 3 1  ON 30
ci_32                -9.486073e-04 3 1  ON 31
ci_33                -1.370809e-03 3 1  ON 32
ci_34                 1.098332e-03 3 1  ON 33
ci_35                 1.541812e-03 3 1  ON 34
ci_36                -1.076517e-03 3 1  ON 35
ci_37                -1.049922e-03 3 1  ON 36
ci_38                -6.345743e-04 3 1  ON 37
ci_39                -6.045489e-04 3 1  ON 38
ci_40                -1.528326e-03 3 1  ON 39
ci_41                -1.186498e-03 3 1  ON 40
ci_42                -1.176169e-03 3 1  ON 41
ci_43                -2.259831e-03 3 1  ON 42
ci_44                -2.993994e-03 3 1  ON 43
ci_45                -5.582132e-04 3 1  ON 44
ci_46                -7.369489e-04 3 1  ON 45
ci_47                 1.562094e-03 3 1  ON 46
ci_48                 1.418063e-03 3 1  ON 47
ci_49                -9.599059e-04 3 1  ON 48
ci_50                -7.632461e-04 3 1  ON 49
ci_51                 1.269155e-04 3 1  ON 50
ci_52                 1.810459e-04 3 1  ON 51
ci_53                -7.047065e-04 3 1  ON 52
ci_54                -1.080372e-03 3 1  ON 53
ci_55                -6.620296e-04 3 1  ON 54
ci_56                 2.501679e-03 3 1  ON 55
ci_57                 1.712988e-03 3 1  ON 56
ci_58                -1.157571e-03 3 1  ON 57
ci_59                -1.431147e-03 3 1  ON 58
ci_60                 1.747252e-04 3 1  ON 59
ci_61                -2.372034e-04 3 1  ON 60
ci_62                -5.529665e-04 3 1  ON 61
ci_63                -6.346428e-04 3 1  ON 62
ci_64                -3.466409e-04 3 1  ON 63
ci_65                 8.918773e-06 3 1  ON 64
ci_66                -6.619851e-04 3 1  ON 65
ci_67                -8.568681e-04 3 1  ON 66
ci_68                -1.184665e-03 3 1  ON 67
ci_69                 9.422080e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7501
    reference variance = 0.321505
====================================================
  Execution time = 2.5227e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5501e-01
  Total weights = 1.9642e+06
  Execution time = 3.4567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439304974054
                                         uncertainty =       0.004197201713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439304974054
                                         uncertainty =       0.004197201713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468653696
  error estimate for blocks of size 2^( 2) =       0.000494106666
  error estimate for blocks of size 2^( 3) =       0.000517812374
  error estimate for blocks of size 2^( 4) =       0.000535937104
  error estimate for blocks of size 2^( 5) =       0.000547202402
  error estimate for blocks of size 2^( 6) =       0.000553439899
  error estimate for blocks of size 2^( 7) =       0.000556711562

      target function =      -0.741193694319
              le_mean =     -22.815497868581
             les_mean =     521.001953698660
             stat err =       0.000548322742
             autocorr =       1.368889604434
   target nu stat err =       0.000548322742
   target dn stat err =       0.005498644380
      target stat err =       0.004551854821
              std dev =       0.662776412803
             le_variance =       0.439272573369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439304960506
                                         uncertainty =       0.004197196309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439304960506
                                         uncertainty =       0.004197196309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468653689
  error estimate for blocks of size 2^( 2) =       0.000494106662
  error estimate for blocks of size 2^( 3) =       0.000517812372
  error estimate for blocks of size 2^( 4) =       0.000535937104
  error estimate for blocks of size 2^( 5) =       0.000547202403
  error estimate for blocks of size 2^( 6) =       0.000553439900
  error estimate for blocks of size 2^( 7) =       0.000556711562

      target function =      -0.741193756284
              le_mean =     -22.815497868765
             les_mean =     521.001953631666
             stat err =       0.000548322742
             autocorr =       1.368889646288
   target nu stat err =       0.000548322742
   target dn stat err =       0.005498632122
      target stat err =       0.004551845608
              std dev =       0.662776402587
             le_variance =       0.439272559826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439304967280
                                         uncertainty =       0.004197199011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439304967280
                                         uncertainty =       0.004197199011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468653692
  error estimate for blocks of size 2^( 2) =       0.000494106664
  error estimate for blocks of size 2^( 3) =       0.000517812373
  error estimate for blocks of size 2^( 4) =       0.000535937104
  error estimate for blocks of size 2^( 5) =       0.000547202403
  error estimate for blocks of size 2^( 6) =       0.000553439900
  error estimate for blocks of size 2^( 7) =       0.000556711562

      target function =      -0.741193725309
              le_mean =     -22.815497868673
             les_mean =     521.001953665153
             stat err =       0.000548322742
             autocorr =       1.368889625361
   target nu stat err =       0.000548322742
   target dn stat err =       0.005498638250
      target stat err =       0.004551850214
              std dev =       0.662776407695
             le_variance =       0.439272566598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439304973207
                                         uncertainty =       0.004197201376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439304973207
                                         uncertainty =       0.004197201376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468653695
  error estimate for blocks of size 2^( 2) =       0.000494106666
  error estimate for blocks of size 2^( 3) =       0.000517812374
  error estimate for blocks of size 2^( 4) =       0.000535937104
  error estimate for blocks of size 2^( 5) =       0.000547202402
  error estimate for blocks of size 2^( 6) =       0.000553439899
  error estimate for blocks of size 2^( 7) =       0.000556711562

      target function =      -0.741193698193
              le_mean =     -22.815497868593
             les_mean =     521.001953694470
             stat err =       0.000548322742
             autocorr =       1.368889607040
   target nu stat err =       0.000548322742
   target dn stat err =       0.005498643614
      target stat err =       0.004551854245
              std dev =       0.662776412165
             le_variance =       0.439272572523


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741193694319        initial
     1.5625e+03     1.5625e+04             8.9420e-08        -0.741193756284  <--
     6.2500e+03     6.2500e+04             2.2355e-08        -0.741193725309
     2.5000e+04     2.5000e+05             5.5888e-09        -0.741193698193

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 4.2637e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.265015e-01 3 1  ON 0
ci_02                -2.871833e-02 3 1  ON 1
ci_03                -2.856503e-02 3 1  ON 2
ci_04                 2.661269e-02 3 1  ON 3
ci_05                -2.187629e-02 3 1  ON 4
ci_06                -2.154272e-02 3 1  ON 5
ci_07                 2.710165e-02 3 1  ON 6
ci_08                -5.456745e-03 3 1  ON 7
ci_09                -8.842275e-03 3 1  ON 8
ci_10                -8.363810e-03 3 1  ON 9
ci_11                 1.311059e-02 3 1  ON 10
ci_12                 6.948294e-03 3 1  ON 11
ci_13                 1.303875e-02 3 1  ON 12
ci_14                 1.252723e-02 3 1  ON 13
ci_15                 6.372300e-03 3 1  ON 14
ci_16                 6.263833e-03 3 1  ON 15
ci_17                -7.198856e-03 3 1  ON 16
ci_18                -6.024458e-03 3 1  ON 17
ci_19                 9.257685e-03 3 1  ON 18
ci_20                 6.518996e-03 3 1  ON 19
ci_21                 8.966876e-03 3 1  ON 20
ci_22                 8.288999e-03 3 1  ON 21
ci_23                 4.852430e-03 3 1  ON 22
ci_24                 4.086665e-03 3 1  ON 23
ci_25                 2.863717e-03 3 1  ON 24
ci_26                 3.086068e-03 3 1  ON 25
ci_27                 3.185100e-03 3 1  ON 26
ci_28                 1.755724e-03 3 1  ON 27
ci_29                 1.455064e-03 3 1  ON 28
ci_30                -1.778613e-03 3 1  ON 29
ci_31                -4.925264e-04 3 1  ON 30
ci_32                -9.485945e-04 3 1  ON 31
ci_33                -1.370818e-03 3 1  ON 32
ci_34                 1.098328e-03 3 1  ON 33
ci_35                 1.541836e-03 3 1  ON 34
ci_36                -1.076525e-03 3 1  ON 35
ci_37                -1.049945e-03 3 1  ON 36
ci_38                -6.345749e-04 3 1  ON 37
ci_39                -6.045470e-04 3 1  ON 38
ci_40                -1.528321e-03 3 1  ON 39
ci_41                -1.186507e-03 3 1  ON 40
ci_42                -1.176164e-03 3 1  ON 41
ci_43                -2.259822e-03 3 1  ON 42
ci_44                -2.994000e-03 3 1  ON 43
ci_45                -5.582137e-04 3 1  ON 44
ci_46                -7.369412e-04 3 1  ON 45
ci_47                 1.562097e-03 3 1  ON 46
ci_48                 1.418081e-03 3 1  ON 47
ci_49                -9.599154e-04 3 1  ON 48
ci_50                -7.632384e-04 3 1  ON 49
ci_51                 1.268863e-04 3 1  ON 50
ci_52                 1.810452e-04 3 1  ON 51
ci_53                -7.047132e-04 3 1  ON 52
ci_54                -1.080362e-03 3 1  ON 53
ci_55                -6.620409e-04 3 1  ON 54
ci_56                 2.501662e-03 3 1  ON 55
ci_57                 1.712985e-03 3 1  ON 56
ci_58                -1.157562e-03 3 1  ON 57
ci_59                -1.431125e-03 3 1  ON 58
ci_60                 1.747313e-04 3 1  ON 59
ci_61                -2.372290e-04 3 1  ON 60
ci_62                -5.529755e-04 3 1  ON 61
ci_63                -6.346234e-04 3 1  ON 62
ci_64                -3.466364e-04 3 1  ON 63
ci_65                 8.929715e-06 3 1  ON 64
ci_66                -6.619810e-04 3 1  ON 65
ci_67                -8.568630e-04 3 1  ON 66
ci_68                -1.184663e-03 3 1  ON 67
ci_69                 9.420231e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3024e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8118
    reference variance = 0.398822
====================================================
  Execution time = 2.7701e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5328e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4661e-01
  Total weights = 1.964174885e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4989e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434897176264
                                         uncertainty =       0.002105668084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434897176264
                                         uncertainty =       0.002105668084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466280506
  error estimate for blocks of size 2^( 2) =       0.000491222782
  error estimate for blocks of size 2^( 3) =       0.000515056462
  error estimate for blocks of size 2^( 4) =       0.000532195637
  error estimate for blocks of size 2^( 5) =       0.000542260226
  error estimate for blocks of size 2^( 6) =       0.000547534337
  error estimate for blocks of size 2^( 7) =       0.000549462478

      target function =      -0.748176051984
              le_mean =     -22.815399681297
             les_mean =     520.989067776976
             stat err =       0.000542863169
             autocorr =       1.355458541056
   target nu stat err =       0.000542863169
   target dn stat err =       0.002584440945
      target stat err =       0.002243605759
              std dev =       0.659420214919
             le_variance =       0.434835019844


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281539968130e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748181744416       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748181769644       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748181773986       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748181775088       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748181775759       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748181776038       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748181776165       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748181776184       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748181776180       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 4.430799e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748181744416       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748181750724       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748181751809       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748181752084       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748181752252       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748181752322       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748181752354       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748181752361       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748181752358       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 1.107756e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748181744416       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748181745993       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748181746264       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748181746333       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748181746375       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748181746392       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748181746400       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748181746402       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748181746401       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+03 is 2.769426e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2208e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.265014e-01 3 1  ON 0
ci_02                -2.871827e-02 3 1  ON 1
ci_03                -2.856503e-02 3 1  ON 2
ci_04                 2.661266e-02 3 1  ON 3
ci_05                -2.187622e-02 3 1  ON 4
ci_06                -2.154274e-02 3 1  ON 5
ci_07                 2.710162e-02 3 1  ON 6
ci_08                -5.456700e-03 3 1  ON 7
ci_09                -8.842273e-03 3 1  ON 8
ci_10                -8.363821e-03 3 1  ON 9
ci_11                 1.311056e-02 3 1  ON 10
ci_12                 6.948327e-03 3 1  ON 11
ci_13                 1.303870e-02 3 1  ON 12
ci_14                 1.252720e-02 3 1  ON 13
ci_15                 6.372330e-03 3 1  ON 14
ci_16                 6.263863e-03 3 1  ON 15
ci_17                -7.198851e-03 3 1  ON 16
ci_18                -6.024445e-03 3 1  ON 17
ci_19                 9.257676e-03 3 1  ON 18
ci_20                 6.518999e-03 3 1  ON 19
ci_21                 8.966874e-03 3 1  ON 20
ci_22                 8.289013e-03 3 1  ON 21
ci_23                 4.852414e-03 3 1  ON 22
ci_24                 4.086664e-03 3 1  ON 23
ci_25                 2.863702e-03 3 1  ON 24
ci_26                 3.086102e-03 3 1  ON 25
ci_27                 3.185082e-03 3 1  ON 26
ci_28                 1.755677e-03 3 1  ON 27
ci_29                 1.455082e-03 3 1  ON 28
ci_30                -1.778650e-03 3 1  ON 29
ci_31                -4.925479e-04 3 1  ON 30
ci_32                -9.485839e-04 3 1  ON 31
ci_33                -1.370814e-03 3 1  ON 32
ci_34                 1.098347e-03 3 1  ON 33
ci_35                 1.541836e-03 3 1  ON 34
ci_36                -1.076540e-03 3 1  ON 35
ci_37                -1.049934e-03 3 1  ON 36
ci_38                -6.345630e-04 3 1  ON 37
ci_39                -6.045396e-04 3 1  ON 38
ci_40                -1.528294e-03 3 1  ON 39
ci_41                -1.186512e-03 3 1  ON 40
ci_42                -1.176150e-03 3 1  ON 41
ci_43                -2.259848e-03 3 1  ON 42
ci_44                -2.993970e-03 3 1  ON 43
ci_45                -5.582138e-04 3 1  ON 44
ci_46                -7.369424e-04 3 1  ON 45
ci_47                 1.562089e-03 3 1  ON 46
ci_48                 1.418082e-03 3 1  ON 47
ci_49                -9.598909e-04 3 1  ON 48
ci_50                -7.632218e-04 3 1  ON 49
ci_51                 1.268872e-04 3 1  ON 50
ci_52                 1.810498e-04 3 1  ON 51
ci_53                -7.047203e-04 3 1  ON 52
ci_54                -1.080338e-03 3 1  ON 53
ci_55                -6.620316e-04 3 1  ON 54
ci_56                 2.501648e-03 3 1  ON 55
ci_57                 1.712981e-03 3 1  ON 56
ci_58                -1.157556e-03 3 1  ON 57
ci_59                -1.431111e-03 3 1  ON 58
ci_60                 1.747330e-04 3 1  ON 59
ci_61                -2.372055e-04 3 1  ON 60
ci_62                -5.529674e-04 3 1  ON 61
ci_63                -6.346202e-04 3 1  ON 62
ci_64                -3.466518e-04 3 1  ON 63
ci_65                 8.908522e-06 3 1  ON 64
ci_66                -6.619748e-04 3 1  ON 65
ci_67                -8.568435e-04 3 1  ON 66
ci_68                -1.184623e-03 3 1  ON 67
ci_69                 9.413511e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8518
    reference variance = 0.446859
====================================================
  Execution time = 2.5329e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4473e-01
  Total weights = 1.9644e+06
  Execution time = 3.4745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431815101896
                                         uncertainty =       0.002065271922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431815101896
                                         uncertainty =       0.002065271922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464633247
  error estimate for blocks of size 2^( 2) =       0.000489950754
  error estimate for blocks of size 2^( 3) =       0.000514037735
  error estimate for blocks of size 2^( 4) =       0.000531422109
  error estimate for blocks of size 2^( 5) =       0.000542879412
  error estimate for blocks of size 2^( 6) =       0.000550915512
  error estimate for blocks of size 2^( 7) =       0.000552978679

      target function =      -0.749739172899
              le_mean =     -22.814853754875
             les_mean =     520.962286478204
             stat err =       0.000544548928
             autocorr =       1.373577757924
   target nu stat err =       0.000544548928
   target dn stat err =       0.002720410426
      target stat err =       0.002361299841
              std dev =       0.657090639239
             le_variance =       0.431768108176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431815127570
                                         uncertainty =       0.002065278963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431815127570
                                         uncertainty =       0.002065278963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464633260
  error estimate for blocks of size 2^( 2) =       0.000489950779
  error estimate for blocks of size 2^( 3) =       0.000514037775
  error estimate for blocks of size 2^( 4) =       0.000531422157
  error estimate for blocks of size 2^( 5) =       0.000542879470
  error estimate for blocks of size 2^( 6) =       0.000550915578
  error estimate for blocks of size 2^( 7) =       0.000552978749

      target function =      -0.749739482597
              le_mean =     -22.814853753972
             les_mean =     520.962286067519
             stat err =       0.000544548988
             autocorr =       1.373577983035
   target nu stat err =       0.000544548988
   target dn stat err =       0.002720443815
      target stat err =       0.002361328795
              std dev =       0.657090658394
             le_variance =       0.431768133349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431815114732
                                         uncertainty =       0.002065275443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431815114732
                                         uncertainty =       0.002065275443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464633254
  error estimate for blocks of size 2^( 2) =       0.000489950766
  error estimate for blocks of size 2^( 3) =       0.000514037755
  error estimate for blocks of size 2^( 4) =       0.000531422133
  error estimate for blocks of size 2^( 5) =       0.000542879441
  error estimate for blocks of size 2^( 6) =       0.000550915545
  error estimate for blocks of size 2^( 7) =       0.000552978714

      target function =      -0.749739330068
              le_mean =     -22.814853754423
             les_mean =     520.962286270084
             stat err =       0.000544548958
             autocorr =       1.373577870482
   target nu stat err =       0.000544548958
   target dn stat err =       0.002720427017
      target stat err =       0.002361314248
              std dev =       0.657090648816
             le_variance =       0.431768120761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431815103500
                                         uncertainty =       0.002065272362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431815103500
                                         uncertainty =       0.002065272362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464633248
  error estimate for blocks of size 2^( 2) =       0.000489950755
  error estimate for blocks of size 2^( 3) =       0.000514037738
  error estimate for blocks of size 2^( 4) =       0.000531422112
  error estimate for blocks of size 2^( 5) =       0.000542879415
  error estimate for blocks of size 2^( 6) =       0.000550915516
  error estimate for blocks of size 2^( 7) =       0.000552978683

      target function =      -0.749739192799
              le_mean =     -22.814853754818
             les_mean =     520.962286451885
             stat err =       0.000544548932
             autocorr =       1.373577772000
   target nu stat err =       0.000544548932
   target dn stat err =       0.002720412488
      target stat err =       0.002361301634
              std dev =       0.657090640436
             le_variance =       0.431768109749


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749739172899        initial
     3.9062e+02     3.9062e+03             4.4308e-07        -0.749739482597  <--
     1.5625e+03     1.5625e+04             1.1078e-07        -0.749739330068
     6.2500e+03     6.2500e+04             2.7694e-08        -0.749739192799

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 4.3040e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.265011e-01 3 1  ON 0
ci_02                -2.871808e-02 3 1  ON 1
ci_03                -2.856503e-02 3 1  ON 2
ci_04                 2.661254e-02 3 1  ON 3
ci_05                -2.187600e-02 3 1  ON 4
ci_06                -2.154282e-02 3 1  ON 5
ci_07                 2.710153e-02 3 1  ON 6
ci_08                -5.456563e-03 3 1  ON 7
ci_09                -8.842266e-03 3 1  ON 8
ci_10                -8.363854e-03 3 1  ON 9
ci_11                 1.311045e-02 3 1  ON 10
ci_12                 6.948428e-03 3 1  ON 11
ci_13                 1.303854e-02 3 1  ON 12
ci_14                 1.252711e-02 3 1  ON 13
ci_15                 6.372419e-03 3 1  ON 14
ci_16                 6.263953e-03 3 1  ON 15
ci_17                -7.198836e-03 3 1  ON 16
ci_18                -6.024406e-03 3 1  ON 17
ci_19                 9.257648e-03 3 1  ON 18
ci_20                 6.519008e-03 3 1  ON 19
ci_21                 8.966865e-03 3 1  ON 20
ci_22                 8.289056e-03 3 1  ON 21
ci_23                 4.852367e-03 3 1  ON 22
ci_24                 4.086660e-03 3 1  ON 23
ci_25                 2.863656e-03 3 1  ON 24
ci_26                 3.086206e-03 3 1  ON 25
ci_27                 3.185027e-03 3 1  ON 26
ci_28                 1.755536e-03 3 1  ON 27
ci_29                 1.455137e-03 3 1  ON 28
ci_30                -1.778761e-03 3 1  ON 29
ci_31                -4.926123e-04 3 1  ON 30
ci_32                -9.485523e-04 3 1  ON 31
ci_33                -1.370801e-03 3 1  ON 32
ci_34                 1.098404e-03 3 1  ON 33
ci_35                 1.541835e-03 3 1  ON 34
ci_36                -1.076585e-03 3 1  ON 35
ci_37                -1.049899e-03 3 1  ON 36
ci_38                -6.345273e-04 3 1  ON 37
ci_39                -6.045176e-04 3 1  ON 38
ci_40                -1.528211e-03 3 1  ON 39
ci_41                -1.186526e-03 3 1  ON 40
ci_42                -1.176108e-03 3 1  ON 41
ci_43                -2.259926e-03 3 1  ON 42
ci_44                -2.993882e-03 3 1  ON 43
ci_45                -5.582141e-04 3 1  ON 44
ci_46                -7.369458e-04 3 1  ON 45
ci_47                 1.562064e-03 3 1  ON 46
ci_48                 1.418086e-03 3 1  ON 47
ci_49                -9.598175e-04 3 1  ON 48
ci_50                -7.631719e-04 3 1  ON 49
ci_51                 1.268902e-04 3 1  ON 50
ci_52                 1.810635e-04 3 1  ON 51
ci_53                -7.047415e-04 3 1  ON 52
ci_54                -1.080265e-03 3 1  ON 53
ci_55                -6.620037e-04 3 1  ON 54
ci_56                 2.501605e-03 3 1  ON 55
ci_57                 1.712971e-03 3 1  ON 56
ci_58                -1.157539e-03 3 1  ON 57
ci_59                -1.431069e-03 3 1  ON 58
ci_60                 1.747381e-04 3 1  ON 59
ci_61                -2.371350e-04 3 1  ON 60
ci_62                -5.529428e-04 3 1  ON 61
ci_63                -6.346104e-04 3 1  ON 62
ci_64                -3.466983e-04 3 1  ON 63
ci_65                 8.844950e-06 3 1  ON 64
ci_66                -6.619561e-04 3 1  ON 65
ci_67                -8.567850e-04 3 1  ON 66
ci_68                -1.184503e-03 3 1  ON 67
ci_69                 9.393357e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5259e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8617
    reference variance = 0.392768
====================================================
  Execution time = 2.5971e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4860e-01
  Total weights = 1.964325179e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436242336589
                                         uncertainty =       0.002218223053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436242336589
                                         uncertainty =       0.002218223053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467078578
  error estimate for blocks of size 2^( 2) =       0.000492368714
  error estimate for blocks of size 2^( 3) =       0.000516155720
  error estimate for blocks of size 2^( 4) =       0.000534887610
  error estimate for blocks of size 2^( 5) =       0.000545764043
  error estimate for blocks of size 2^( 6) =       0.000552193994
  error estimate for blocks of size 2^( 7) =       0.000555266212

      target function =      -0.746508625928
              le_mean =     -22.815124895219
             les_mean =     520.978527098148
             stat err =       0.000547027965
             autocorr =       1.371636892734
   target nu stat err =       0.000547027965
   target dn stat err =       0.002817079011
      target stat err =       0.002421062652
              std dev =       0.660548860322
             le_variance =       0.436324796872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281512489522e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746515503539       residual = 9.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746515579330       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746515591691       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746515595568       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746515596610       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746515597448       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746515597569       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746515597517       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746515597561       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 1.445428e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746515503539       residual = 9.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746515522494       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746515525585       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746515526554       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746515526814       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746515527024       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746515527054       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746515527041       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746515527051       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 3.614288e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746515503539       residual = 9.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746515508278       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746515509051       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746515509294       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746515509357       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746515509412       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746515509417       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746515509414       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746515509416       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 9.036167e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057995 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0496e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.265007e-01 3 1  ON 0
ci_02                -2.871800e-02 3 1  ON 1
ci_03                -2.856518e-02 3 1  ON 2
ci_04                 2.661250e-02 3 1  ON 3
ci_05                -2.187589e-02 3 1  ON 4
ci_06                -2.154277e-02 3 1  ON 5
ci_07                 2.710140e-02 3 1  ON 6
ci_08                -5.456602e-03 3 1  ON 7
ci_09                -8.842249e-03 3 1  ON 8
ci_10                -8.363905e-03 3 1  ON 9
ci_11                 1.311047e-02 3 1  ON 10
ci_12                 6.948452e-03 3 1  ON 11
ci_13                 1.303859e-02 3 1  ON 12
ci_14                 1.252710e-02 3 1  ON 13
ci_15                 6.372481e-03 3 1  ON 14
ci_16                 6.263978e-03 3 1  ON 15
ci_17                -7.198901e-03 3 1  ON 16
ci_18                -6.024425e-03 3 1  ON 17
ci_19                 9.257803e-03 3 1  ON 18
ci_20                 6.518873e-03 3 1  ON 19
ci_21                 8.966965e-03 3 1  ON 20
ci_22                 8.289160e-03 3 1  ON 21
ci_23                 4.852389e-03 3 1  ON 22
ci_24                 4.086604e-03 3 1  ON 23
ci_25                 2.863703e-03 3 1  ON 24
ci_26                 3.086306e-03 3 1  ON 25
ci_27                 3.185091e-03 3 1  ON 26
ci_28                 1.755444e-03 3 1  ON 27
ci_29                 1.455183e-03 3 1  ON 28
ci_30                -1.778886e-03 3 1  ON 29
ci_31                -4.928984e-04 3 1  ON 30
ci_32                -9.484523e-04 3 1  ON 31
ci_33                -1.370777e-03 3 1  ON 32
ci_34                 1.098349e-03 3 1  ON 33
ci_35                 1.541758e-03 3 1  ON 34
ci_36                -1.076633e-03 3 1  ON 35
ci_37                -1.049926e-03 3 1  ON 36
ci_38                -6.344848e-04 3 1  ON 37
ci_39                -6.043898e-04 3 1  ON 38
ci_40                -1.528331e-03 3 1  ON 39
ci_41                -1.186659e-03 3 1  ON 40
ci_42                -1.176081e-03 3 1  ON 41
ci_43                -2.259880e-03 3 1  ON 42
ci_44                -2.993964e-03 3 1  ON 43
ci_45                -5.581902e-04 3 1  ON 44
ci_46                -7.369967e-04 3 1  ON 45
ci_47                 1.562106e-03 3 1  ON 46
ci_48                 1.418096e-03 3 1  ON 47
ci_49                -9.597017e-04 3 1  ON 48
ci_50                -7.631385e-04 3 1  ON 49
ci_51                 1.268853e-04 3 1  ON 50
ci_52                 1.810965e-04 3 1  ON 51
ci_53                -7.047591e-04 3 1  ON 52
ci_54                -1.080212e-03 3 1  ON 53
ci_55                -6.620175e-04 3 1  ON 54
ci_56                 2.501642e-03 3 1  ON 55
ci_57                 1.713025e-03 3 1  ON 56
ci_58                -1.157590e-03 3 1  ON 57
ci_59                -1.430923e-03 3 1  ON 58
ci_60                 1.750129e-04 3 1  ON 59
ci_61                -2.371904e-04 3 1  ON 60
ci_62                -5.530401e-04 3 1  ON 61
ci_63                -6.345676e-04 3 1  ON 62
ci_64                -3.466592e-04 3 1  ON 63
ci_65                 8.725099e-06 3 1  ON 64
ci_66                -6.619756e-04 3 1  ON 65
ci_67                -8.566417e-04 3 1  ON 66
ci_68                -1.184548e-03 3 1  ON 67
ci_69                 9.373425e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8504
    reference variance = 0.428876
====================================================
  Execution time = 2.5370e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4373e-01
  Total weights = 1.9642e+06
  Execution time = 3.4779e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433504019377
                                         uncertainty =       0.001908128173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433504019377
                                         uncertainty =       0.001908128173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465565835
  error estimate for blocks of size 2^( 2) =       0.000491003057
  error estimate for blocks of size 2^( 3) =       0.000514881222
  error estimate for blocks of size 2^( 4) =       0.000532766185
  error estimate for blocks of size 2^( 5) =       0.000542404878
  error estimate for blocks of size 2^( 6) =       0.000547243373
  error estimate for blocks of size 2^( 7) =       0.000552558027

      target function =      -0.750582410828
              le_mean =     -22.814658035102
             les_mean =     520.952352944933
             stat err =       0.000543743116
             autocorr =       1.364034445330
   target nu stat err =       0.000543743116
   target dn stat err =       0.002137934136
      target stat err =       0.001896743615
              std dev =       0.658409518044
             le_variance =       0.433503093451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433504006780
                                         uncertainty =       0.001908127761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433504006780
                                         uncertainty =       0.001908127761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465565829
  error estimate for blocks of size 2^( 2) =       0.000491003061
  error estimate for blocks of size 2^( 3) =       0.000514881242
  error estimate for blocks of size 2^( 4) =       0.000532766219
  error estimate for blocks of size 2^( 5) =       0.000542404939
  error estimate for blocks of size 2^( 6) =       0.000547243468
  error estimate for blocks of size 2^( 7) =       0.000552558096

      target function =      -0.750584441050
              le_mean =     -22.814658041496
             les_mean =     520.952350820870
             stat err =       0.000543743180
             autocorr =       1.364034807283
   target nu stat err =       0.000543743180
   target dn stat err =       0.002137871635
      target stat err =       0.001896703649
              std dev =       0.658409509190
             le_variance =       0.433503081792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433504013051
                                         uncertainty =       0.001908127966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433504013051
                                         uncertainty =       0.001908127966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465565832
  error estimate for blocks of size 2^( 2) =       0.000491003059
  error estimate for blocks of size 2^( 3) =       0.000514881232
  error estimate for blocks of size 2^( 4) =       0.000532766202
  error estimate for blocks of size 2^( 5) =       0.000542404908
  error estimate for blocks of size 2^( 6) =       0.000547243421
  error estimate for blocks of size 2^( 7) =       0.000552558061

      target function =      -0.750583445552
              le_mean =     -22.814658038296
             les_mean =     520.952351859424
             stat err =       0.000543743148
             autocorr =       1.364034626391
   target nu stat err =       0.000543743148
   target dn stat err =       0.002137902566
      target stat err =       0.001896723472
              std dev =       0.658409513596
             le_variance =       0.433503087594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433504018584
                                         uncertainty =       0.001908128147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433504018584
                                         uncertainty =       0.001908128147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465565835
  error estimate for blocks of size 2^( 2) =       0.000491003057
  error estimate for blocks of size 2^( 3) =       0.000514881223
  error estimate for blocks of size 2^( 4) =       0.000532766187
  error estimate for blocks of size 2^( 5) =       0.000542404882
  error estimate for blocks of size 2^( 6) =       0.000547243379
  error estimate for blocks of size 2^( 7) =       0.000552558031

      target function =      -0.750582542418
              le_mean =     -22.814658035501
             les_mean =     520.952352806550
             stat err =       0.000543743120
             autocorr =       1.364034467961
   target nu stat err =       0.000543743120
   target dn stat err =       0.002137930154
      target stat err =       0.001896741080
              std dev =       0.658409517485
             le_variance =       0.433503092715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750582410828        initial
     9.7656e+01     9.7656e+02             1.4454e-06        -0.750584441050  <--
     3.9062e+02     3.9062e+03             3.6143e-07        -0.750583445552
     1.5625e+03     1.5625e+04             9.0362e-08        -0.750582542418

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 4.2779e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.264996e-01 3 1  ON 0
ci_02                -2.871776e-02 3 1  ON 1
ci_03                -2.856562e-02 3 1  ON 2
ci_04                 2.661237e-02 3 1  ON 3
ci_05                -2.187556e-02 3 1  ON 4
ci_06                -2.154262e-02 3 1  ON 5
ci_07                 2.710100e-02 3 1  ON 6
ci_08                -5.456718e-03 3 1  ON 7
ci_09                -8.842199e-03 3 1  ON 8
ci_10                -8.364056e-03 3 1  ON 9
ci_11                 1.311055e-02 3 1  ON 10
ci_12                 6.948523e-03 3 1  ON 11
ci_13                 1.303873e-02 3 1  ON 12
ci_14                 1.252707e-02 3 1  ON 13
ci_15                 6.372666e-03 3 1  ON 14
ci_16                 6.264052e-03 3 1  ON 15
ci_17                -7.199096e-03 3 1  ON 16
ci_18                -6.024482e-03 3 1  ON 17
ci_19                 9.258265e-03 3 1  ON 18
ci_20                 6.518468e-03 3 1  ON 19
ci_21                 8.967265e-03 3 1  ON 20
ci_22                 8.289473e-03 3 1  ON 21
ci_23                 4.852455e-03 3 1  ON 22
ci_24                 4.086435e-03 3 1  ON 23
ci_25                 2.863845e-03 3 1  ON 24
ci_26                 3.086604e-03 3 1  ON 25
ci_27                 3.185281e-03 3 1  ON 26
ci_28                 1.755168e-03 3 1  ON 27
ci_29                 1.455321e-03 3 1  ON 28
ci_30                -1.779261e-03 3 1  ON 29
ci_31                -4.937564e-04 3 1  ON 30
ci_32                -9.481522e-04 3 1  ON 31
ci_33                -1.370705e-03 3 1  ON 32
ci_34                 1.098186e-03 3 1  ON 33
ci_35                 1.541528e-03 3 1  ON 34
ci_36                -1.076776e-03 3 1  ON 35
ci_37                -1.050004e-03 3 1  ON 36
ci_38                -6.343575e-04 3 1  ON 37
ci_39                -6.040066e-04 3 1  ON 38
ci_40                -1.528692e-03 3 1  ON 39
ci_41                -1.187061e-03 3 1  ON 40
ci_42                -1.176001e-03 3 1  ON 41
ci_43                -2.259740e-03 3 1  ON 42
ci_44                -2.994211e-03 3 1  ON 43
ci_45                -5.581187e-04 3 1  ON 44
ci_46                -7.371494e-04 3 1  ON 45
ci_47                 1.562230e-03 3 1  ON 46
ci_48                 1.418126e-03 3 1  ON 47
ci_49                -9.593543e-04 3 1  ON 48
ci_50                -7.630381e-04 3 1  ON 49
ci_51                 1.268707e-04 3 1  ON 50
ci_52                 1.811953e-04 3 1  ON 51
ci_53                -7.048120e-04 3 1  ON 52
ci_54                -1.080051e-03 3 1  ON 53
ci_55                -6.620588e-04 3 1  ON 54
ci_56                 2.501752e-03 3 1  ON 55
ci_57                 1.713186e-03 3 1  ON 56
ci_58                -1.157744e-03 3 1  ON 57
ci_59                -1.430485e-03 3 1  ON 58
ci_60                 1.758372e-04 3 1  ON 59
ci_61                -2.373565e-04 3 1  ON 60
ci_62                -5.533319e-04 3 1  ON 61
ci_63                -6.344392e-04 3 1  ON 62
ci_64                -3.465420e-04 3 1  ON 63
ci_65                 8.365733e-06 3 1  ON 64
ci_66                -6.620341e-04 3 1  ON 65
ci_67                -8.562119e-04 3 1  ON 66
ci_68                -1.184683e-03 3 1  ON 67
ci_69                 9.313660e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3283e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7242
    reference variance = 0.390283
====================================================
  Execution time = 2.7930e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5361e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4856e-01
  Total weights = 1.964191230e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4726e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435173033952
                                         uncertainty =       0.002267196349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435173033952
                                         uncertainty =       0.002267196349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466452682
  error estimate for blocks of size 2^( 2) =       0.000492217272
  error estimate for blocks of size 2^( 3) =       0.000516307298
  error estimate for blocks of size 2^( 4) =       0.000534195820
  error estimate for blocks of size 2^( 5) =       0.000544862937
  error estimate for blocks of size 2^( 6) =       0.000552823181
  error estimate for blocks of size 2^( 7) =       0.000555937443

      target function =      -0.746543195630
              le_mean =     -22.814625507272
             les_mean =     520.955698348205
             stat err =       0.000546954845
             autocorr =       1.374952703038
   target nu stat err =       0.000546954845
   target dn stat err =       0.002774135145
      target stat err =       0.002384926340
              std dev =       0.659663708902
             le_variance =       0.435156208842


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281462550727e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746549845813       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746550260276       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746550293593       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746550295138       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746550300348       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746550302612       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746550303028       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746550302773       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746550302627       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746550302454       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 4.158276e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746549845813       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746549949585       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746549957920       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746549958305       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746549959608       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746549960173       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746549960277       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746549960213       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746549960176       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746549960133       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 1.040932e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746549845813       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746549871766       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746549873850       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746549873946       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746549874272       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746549874413       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746549874439       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746549874423       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746549874413       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746549874403       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 2.603184e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061524 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2412e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.264986e-01 3 1  ON 0
ci_02                -2.871702e-02 3 1  ON 1
ci_03                -2.856551e-02 3 1  ON 2
ci_04                 2.661149e-02 3 1  ON 3
ci_05                -2.187487e-02 3 1  ON 4
ci_06                -2.154242e-02 3 1  ON 5
ci_07                 2.710083e-02 3 1  ON 6
ci_08                -5.456198e-03 3 1  ON 7
ci_09                -8.842629e-03 3 1  ON 8
ci_10                -8.364029e-03 3 1  ON 9
ci_11                 1.311068e-02 3 1  ON 10
ci_12                 6.948995e-03 3 1  ON 11
ci_13                 1.303864e-02 3 1  ON 12
ci_14                 1.252810e-02 3 1  ON 13
ci_15                 6.372752e-03 3 1  ON 14
ci_16                 6.264232e-03 3 1  ON 15
ci_17                -7.198606e-03 3 1  ON 16
ci_18                -6.025523e-03 3 1  ON 17
ci_19                 9.258106e-03 3 1  ON 18
ci_20                 6.518082e-03 3 1  ON 19
ci_21                 8.967542e-03 3 1  ON 20
ci_22                 8.289174e-03 3 1  ON 21
ci_23                 4.852379e-03 3 1  ON 22
ci_24                 4.086585e-03 3 1  ON 23
ci_25                 2.863794e-03 3 1  ON 24
ci_26                 3.086473e-03 3 1  ON 25
ci_27                 3.185542e-03 3 1  ON 26
ci_28                 1.756068e-03 3 1  ON 27
ci_29                 1.454655e-03 3 1  ON 28
ci_30                -1.779058e-03 3 1  ON 29
ci_31                -4.931059e-04 3 1  ON 30
ci_32                -9.479039e-04 3 1  ON 31
ci_33                -1.371027e-03 3 1  ON 32
ci_34                 1.098479e-03 3 1  ON 33
ci_35                 1.542237e-03 3 1  ON 34
ci_36                -1.076883e-03 3 1  ON 35
ci_37                -1.050090e-03 3 1  ON 36
ci_38                -6.341517e-04 3 1  ON 37
ci_39                -6.039888e-04 3 1  ON 38
ci_40                -1.528745e-03 3 1  ON 39
ci_41                -1.187017e-03 3 1  ON 40
ci_42                -1.176353e-03 3 1  ON 41
ci_43                -2.260137e-03 3 1  ON 42
ci_44                -2.994376e-03 3 1  ON 43
ci_45                -5.576854e-04 3 1  ON 44
ci_46                -7.371406e-04 3 1  ON 45
ci_47                 1.561987e-03 3 1  ON 46
ci_48                 1.418188e-03 3 1  ON 47
ci_49                -9.591920e-04 3 1  ON 48
ci_50                -7.631034e-04 3 1  ON 49
ci_51                 1.268559e-04 3 1  ON 50
ci_52                 1.805950e-04 3 1  ON 51
ci_53                -7.045324e-04 3 1  ON 52
ci_54                -1.079955e-03 3 1  ON 53
ci_55                -6.623822e-04 3 1  ON 54
ci_56                 2.501286e-03 3 1  ON 55
ci_57                 1.713294e-03 3 1  ON 56
ci_58                -1.157561e-03 3 1  ON 57
ci_59                -1.429565e-03 3 1  ON 58
ci_60                 1.752209e-04 3 1  ON 59
ci_61                -2.366525e-04 3 1  ON 60
ci_62                -5.534204e-04 3 1  ON 61
ci_63                -6.342236e-04 3 1  ON 62
ci_64                -3.463782e-04 3 1  ON 63
ci_65                 8.120088e-06 3 1  ON 64
ci_66                -6.619940e-04 3 1  ON 65
ci_67                -8.565096e-04 3 1  ON 66
ci_68                -1.184250e-03 3 1  ON 67
ci_69                 9.287959e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.8101
    reference variance = 0.356566
====================================================
  Execution time = 2.5242e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4722e-01
  Total weights = 1.9645e+06
  Execution time = 3.4708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434042436457
                                         uncertainty =       0.001861274271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434042436457
                                         uncertainty =       0.001861274271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465855601
  error estimate for blocks of size 2^( 2) =       0.000491652788
  error estimate for blocks of size 2^( 3) =       0.000515609978
  error estimate for blocks of size 2^( 4) =       0.000533890588
  error estimate for blocks of size 2^( 5) =       0.000545414375
  error estimate for blocks of size 2^( 6) =       0.000552557992
  error estimate for blocks of size 2^( 7) =       0.000553882359

      target function =      -0.747662143336
              le_mean =     -22.815292524100
             les_mean =     520.984793031541
             stat err =       0.000546436329
             autocorr =       1.375867103235
   target nu stat err =       0.000546436329
   target dn stat err =       0.002601579553
      target stat err =       0.002255127316
              std dev =       0.658819308804
             le_variance =       0.434042881653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434042173968
                                         uncertainty =       0.001861242573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434042173968
                                         uncertainty =       0.001861242573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465855460
  error estimate for blocks of size 2^( 2) =       0.000491652837
  error estimate for blocks of size 2^( 3) =       0.000515610234
  error estimate for blocks of size 2^( 4) =       0.000533890924
  error estimate for blocks of size 2^( 5) =       0.000545414849
  error estimate for blocks of size 2^( 6) =       0.000552558554
  error estimate for blocks of size 2^( 7) =       0.000553883117

      target function =      -0.747655008272
              le_mean =     -22.815292505574
             les_mean =     520.984800734284
             stat err =       0.000546436861
             autocorr =       1.375870615784
   target nu stat err =       0.000546436861
   target dn stat err =       0.002601916398
      target stat err =       0.002255356576
              std dev =       0.658819109834
             le_variance =       0.434042619483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434042304521
                                         uncertainty =       0.001861258387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434042304521
                                         uncertainty =       0.001861258387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465855530
  error estimate for blocks of size 2^( 2) =       0.000491652812
  error estimate for blocks of size 2^( 3) =       0.000515610106
  error estimate for blocks of size 2^( 4) =       0.000533890756
  error estimate for blocks of size 2^( 5) =       0.000545414612
  error estimate for blocks of size 2^( 6) =       0.000552558273
  error estimate for blocks of size 2^( 7) =       0.000553882738

      target function =      -0.747658940781
              le_mean =     -22.815292514744
             les_mean =     520.984796441301
             stat err =       0.000546436595
             autocorr =       1.375868863021
   target nu stat err =       0.000546436595
   target dn stat err =       0.002601742971
      target stat err =       0.002255240048
              std dev =       0.658819208795
             le_variance =       0.434042749877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434042419898
                                         uncertainty =       0.001861272283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434042419898
                                         uncertainty =       0.001861272283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465855592
  error estimate for blocks of size 2^( 2) =       0.000491652791
  error estimate for blocks of size 2^( 3) =       0.000515609994
  error estimate for blocks of size 2^( 4) =       0.000533890609
  error estimate for blocks of size 2^( 5) =       0.000545414405
  error estimate for blocks of size 2^( 6) =       0.000552558027
  error estimate for blocks of size 2^( 7) =       0.000553882406

      target function =      -0.747661783506
              le_mean =     -22.815292522921
             les_mean =     520.984793408822
             stat err =       0.000546436362
             autocorr =       1.375867323404
   target nu stat err =       0.000546436362
   target dn stat err =       0.002601599421
      target stat err =       0.002255141194
              std dev =       0.658819296252
             le_variance =       0.434042865114


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747662143336        initial  <--
     2.4414e+01     2.4414e+02             4.1583e-06        -0.747655008272
     9.7656e+01     9.7656e+02             1.0409e-06        -0.747658940781
     3.9062e+02     3.9062e+03             2.6032e-07        -0.747661783506

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.6535
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.264996e-01 3 1  ON 0
ci_02                -2.871776e-02 3 1  ON 1
ci_03                -2.856562e-02 3 1  ON 2
ci_04                 2.661237e-02 3 1  ON 3
ci_05                -2.187556e-02 3 1  ON 4
ci_06                -2.154262e-02 3 1  ON 5
ci_07                 2.710100e-02 3 1  ON 6
ci_08                -5.456718e-03 3 1  ON 7
ci_09                -8.842199e-03 3 1  ON 8
ci_10                -8.364056e-03 3 1  ON 9
ci_11                 1.311055e-02 3 1  ON 10
ci_12                 6.948523e-03 3 1  ON 11
ci_13                 1.303873e-02 3 1  ON 12
ci_14                 1.252707e-02 3 1  ON 13
ci_15                 6.372666e-03 3 1  ON 14
ci_16                 6.264052e-03 3 1  ON 15
ci_17                -7.199096e-03 3 1  ON 16
ci_18                -6.024482e-03 3 1  ON 17
ci_19                 9.258265e-03 3 1  ON 18
ci_20                 6.518468e-03 3 1  ON 19
ci_21                 8.967265e-03 3 1  ON 20
ci_22                 8.289473e-03 3 1  ON 21
ci_23                 4.852455e-03 3 1  ON 22
ci_24                 4.086435e-03 3 1  ON 23
ci_25                 2.863845e-03 3 1  ON 24
ci_26                 3.086604e-03 3 1  ON 25
ci_27                 3.185281e-03 3 1  ON 26
ci_28                 1.755168e-03 3 1  ON 27
ci_29                 1.455321e-03 3 1  ON 28
ci_30                -1.779261e-03 3 1  ON 29
ci_31                -4.937564e-04 3 1  ON 30
ci_32                -9.481522e-04 3 1  ON 31
ci_33                -1.370705e-03 3 1  ON 32
ci_34                 1.098186e-03 3 1  ON 33
ci_35                 1.541528e-03 3 1  ON 34
ci_36                -1.076776e-03 3 1  ON 35
ci_37                -1.050004e-03 3 1  ON 36
ci_38                -6.343575e-04 3 1  ON 37
ci_39                -6.040066e-04 3 1  ON 38
ci_40                -1.528692e-03 3 1  ON 39
ci_41                -1.187061e-03 3 1  ON 40
ci_42                -1.176001e-03 3 1  ON 41
ci_43                -2.259740e-03 3 1  ON 42
ci_44                -2.994211e-03 3 1  ON 43
ci_45                -5.581187e-04 3 1  ON 44
ci_46                -7.371494e-04 3 1  ON 45
ci_47                 1.562230e-03 3 1  ON 46
ci_48                 1.418126e-03 3 1  ON 47
ci_49                -9.593543e-04 3 1  ON 48
ci_50                -7.630381e-04 3 1  ON 49
ci_51                 1.268707e-04 3 1  ON 50
ci_52                 1.811953e-04 3 1  ON 51
ci_53                -7.048120e-04 3 1  ON 52
ci_54                -1.080051e-03 3 1  ON 53
ci_55                -6.620588e-04 3 1  ON 54
ci_56                 2.501752e-03 3 1  ON 55
ci_57                 1.713186e-03 3 1  ON 56
ci_58                -1.157744e-03 3 1  ON 57
ci_59                -1.430485e-03 3 1  ON 58
ci_60                 1.758372e-04 3 1  ON 59
ci_61                -2.373565e-04 3 1  ON 60
ci_62                -5.533319e-04 3 1  ON 61
ci_63                -6.344392e-04 3 1  ON 62
ci_64                -3.465420e-04 3 1  ON 63
ci_65                 8.365733e-06 3 1  ON 64
ci_66                -6.620341e-04 3 1  ON 65
ci_67                -8.562119e-04 3 1  ON 66
ci_68                -1.184683e-03 3 1  ON 67
ci_69                 9.313660e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5072e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8632
    reference variance = 0.382708
====================================================
  Execution time = 2.5787e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5367e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4825e-01
  Total weights = 1.964440212e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435328073566
                                         uncertainty =       0.002433501591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435328073566
                                         uncertainty =       0.002433501591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466534209
  error estimate for blocks of size 2^( 2) =       0.000492491372
  error estimate for blocks of size 2^( 3) =       0.000516283102
  error estimate for blocks of size 2^( 4) =       0.000533478695
  error estimate for blocks of size 2^( 5) =       0.000545492866
  error estimate for blocks of size 2^( 6) =       0.000550345465
  error estimate for blocks of size 2^( 7) =       0.000550985817

      target function =      -0.746800065424
              le_mean =     -22.814992082506
             les_mean =     520.972111893984
             stat err =       0.000545075711
             autocorr =       1.365044066437
   target nu stat err =       0.000545075711
   target dn stat err =       0.003498830606
      target stat err =       0.002974525744
              std dev =       0.659779005725
             le_variance =       0.435308336396


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281499208251e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746810720934       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746810785098       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746810795628       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746810797143       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746810797468       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746810797606       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746810797676       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746810797695       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746810797681       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 6.841011e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746810720934       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746810736977       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746810739610       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746810739989       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746810740070       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746810740105       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746810740123       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746810740127       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746810740124       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 1.710488e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746810720934       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746810724945       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746810725603       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746810725698       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746810725719       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746810725727       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746810725734       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746810725728       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746810725731       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 4.276367e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064576 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0292e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.264995e-01 3 1  ON 0
ci_02                -2.871759e-02 3 1  ON 1
ci_03                -2.856559e-02 3 1  ON 2
ci_04                 2.661230e-02 3 1  ON 3
ci_05                -2.187549e-02 3 1  ON 4
ci_06                -2.154245e-02 3 1  ON 5
ci_07                 2.710093e-02 3 1  ON 6
ci_08                -5.456642e-03 3 1  ON 7
ci_09                -8.842299e-03 3 1  ON 8
ci_10                -8.364070e-03 3 1  ON 9
ci_11                 1.311054e-02 3 1  ON 10
ci_12                 6.948549e-03 3 1  ON 11
ci_13                 1.303876e-02 3 1  ON 12
ci_14                 1.252704e-02 3 1  ON 13
ci_15                 6.372662e-03 3 1  ON 14
ci_16                 6.264032e-03 3 1  ON 15
ci_17                -7.199026e-03 3 1  ON 16
ci_18                -6.024535e-03 3 1  ON 17
ci_19                 9.258272e-03 3 1  ON 18
ci_20                 6.518441e-03 3 1  ON 19
ci_21                 8.967202e-03 3 1  ON 20
ci_22                 8.289492e-03 3 1  ON 21
ci_23                 4.852488e-03 3 1  ON 22
ci_24                 4.086522e-03 3 1  ON 23
ci_25                 2.863896e-03 3 1  ON 24
ci_26                 3.086674e-03 3 1  ON 25
ci_27                 3.185303e-03 3 1  ON 26
ci_28                 1.755151e-03 3 1  ON 27
ci_29                 1.455316e-03 3 1  ON 28
ci_30                -1.779191e-03 3 1  ON 29
ci_31                -4.938106e-04 3 1  ON 30
ci_32                -9.482261e-04 3 1  ON 31
ci_33                -1.370750e-03 3 1  ON 32
ci_34                 1.098219e-03 3 1  ON 33
ci_35                 1.541582e-03 3 1  ON 34
ci_36                -1.076746e-03 3 1  ON 35
ci_37                -1.050045e-03 3 1  ON 36
ci_38                -6.343400e-04 3 1  ON 37
ci_39                -6.040111e-04 3 1  ON 38
ci_40                -1.528655e-03 3 1  ON 39
ci_41                -1.187033e-03 3 1  ON 40
ci_42                -1.175948e-03 3 1  ON 41
ci_43                -2.259751e-03 3 1  ON 42
ci_44                -2.994110e-03 3 1  ON 43
ci_45                -5.581153e-04 3 1  ON 44
ci_46                -7.371106e-04 3 1  ON 45
ci_47                 1.562264e-03 3 1  ON 46
ci_48                 1.418105e-03 3 1  ON 47
ci_49                -9.593495e-04 3 1  ON 48
ci_50                -7.630698e-04 3 1  ON 49
ci_51                 1.268591e-04 3 1  ON 50
ci_52                 1.812004e-04 3 1  ON 51
ci_53                -7.048730e-04 3 1  ON 52
ci_54                -1.080034e-03 3 1  ON 53
ci_55                -6.620773e-04 3 1  ON 54
ci_56                 2.501710e-03 3 1  ON 55
ci_57                 1.713215e-03 3 1  ON 56
ci_58                -1.157704e-03 3 1  ON 57
ci_59                -1.430478e-03 3 1  ON 58
ci_60                 1.758379e-04 3 1  ON 59
ci_61                -2.373081e-04 3 1  ON 60
ci_62                -5.533306e-04 3 1  ON 61
ci_63                -6.344549e-04 3 1  ON 62
ci_64                -3.465352e-04 3 1  ON 63
ci_65                 8.339558e-06 3 1  ON 64
ci_66                -6.620620e-04 3 1  ON 65
ci_67                -8.561978e-04 3 1  ON 66
ci_68                -1.184691e-03 3 1  ON 67
ci_69                 9.307003e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7579
    reference variance = 0.306607
====================================================
  Execution time = 2.5431e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4497e-01
  Total weights = 1.9642e+06
  Execution time = 3.4755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433629697518
                                         uncertainty =       0.001954367753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433629697518
                                         uncertainty =       0.001954367753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465659641
  error estimate for blocks of size 2^( 2) =       0.000491180766
  error estimate for blocks of size 2^( 3) =       0.000514900633
  error estimate for blocks of size 2^( 4) =       0.000532164542
  error estimate for blocks of size 2^( 5) =       0.000543872823
  error estimate for blocks of size 2^( 6) =       0.000548927264
  error estimate for blocks of size 2^( 7) =       0.000553038524

      target function =      -0.749542092119
              le_mean =     -22.814462535510
             les_mean =     520.944668397024
             stat err =       0.000544500788
             autocorr =       1.367287452212
   target nu stat err =       0.000544500788
   target dn stat err =       0.002615377838
      target stat err =       0.002273815071
              std dev =       0.658542179144
             le_variance =       0.433677801712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433629649443
                                         uncertainty =       0.001954364606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433629649443
                                         uncertainty =       0.001954364606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465659616
  error estimate for blocks of size 2^( 2) =       0.000491180772
  error estimate for blocks of size 2^( 3) =       0.000514900664
  error estimate for blocks of size 2^( 4) =       0.000532164595
  error estimate for blocks of size 2^( 5) =       0.000543872879
  error estimate for blocks of size 2^( 6) =       0.000548927328
  error estimate for blocks of size 2^( 7) =       0.000553038604

      target function =      -0.749541060631
              le_mean =     -22.814462528929
             les_mean =     520.944669327993
             stat err =       0.000544500852
             autocorr =       1.367287916699
   target nu stat err =       0.000544500852
   target dn stat err =       0.002615394731
      target stat err =       0.002273822669
              std dev =       0.658542143965
             le_variance =       0.433677755377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433629673468
                                         uncertainty =       0.001954366179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433629673468
                                         uncertainty =       0.001954366179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465659628
  error estimate for blocks of size 2^( 2) =       0.000491180769
  error estimate for blocks of size 2^( 3) =       0.000514900648
  error estimate for blocks of size 2^( 4) =       0.000532164569
  error estimate for blocks of size 2^( 5) =       0.000543872851
  error estimate for blocks of size 2^( 6) =       0.000548927296
  error estimate for blocks of size 2^( 7) =       0.000553038564

      target function =      -0.749541719622
              le_mean =     -22.814462532217
             les_mean =     520.944668691389
             stat err =       0.000544500820
             autocorr =       1.367287684493
   target nu stat err =       0.000544500820
   target dn stat err =       0.002615385933
      target stat err =       0.002273819424
              std dev =       0.658542161545
             le_variance =       0.433677778533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433629694511
                                         uncertainty =       0.001954367556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433629694511
                                         uncertainty =       0.001954367556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465659639
  error estimate for blocks of size 2^( 2) =       0.000491180767
  error estimate for blocks of size 2^( 3) =       0.000514900635
  error estimate for blocks of size 2^( 4) =       0.000532164545
  error estimate for blocks of size 2^( 5) =       0.000543872827
  error estimate for blocks of size 2^( 6) =       0.000548927268
  error estimate for blocks of size 2^( 7) =       0.000553038529

      target function =      -0.749542075185
              le_mean =     -22.814462535098
             les_mean =     520.944668398437
             stat err =       0.000544500792
             autocorr =       1.367287481257
   target nu stat err =       0.000544500792
   target dn stat err =       0.002615378797
      target stat err =       0.002273815745
              std dev =       0.658542176944
             le_variance =       0.433677798814


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749542092119        initial  <--
     2.4414e+02     2.4414e+03             6.8410e-07        -0.749541060631
     9.7656e+02     9.7656e+03             1.7105e-07        -0.749541719622
     3.9062e+03     3.9062e+04             4.2764e-08        -0.749542075185

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8870
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.264996e-01 3 1  ON 0
ci_02                -2.871776e-02 3 1  ON 1
ci_03                -2.856562e-02 3 1  ON 2
ci_04                 2.661237e-02 3 1  ON 3
ci_05                -2.187556e-02 3 1  ON 4
ci_06                -2.154262e-02 3 1  ON 5
ci_07                 2.710100e-02 3 1  ON 6
ci_08                -5.456718e-03 3 1  ON 7
ci_09                -8.842199e-03 3 1  ON 8
ci_10                -8.364056e-03 3 1  ON 9
ci_11                 1.311055e-02 3 1  ON 10
ci_12                 6.948523e-03 3 1  ON 11
ci_13                 1.303873e-02 3 1  ON 12
ci_14                 1.252707e-02 3 1  ON 13
ci_15                 6.372666e-03 3 1  ON 14
ci_16                 6.264052e-03 3 1  ON 15
ci_17                -7.199096e-03 3 1  ON 16
ci_18                -6.024482e-03 3 1  ON 17
ci_19                 9.258265e-03 3 1  ON 18
ci_20                 6.518468e-03 3 1  ON 19
ci_21                 8.967265e-03 3 1  ON 20
ci_22                 8.289473e-03 3 1  ON 21
ci_23                 4.852455e-03 3 1  ON 22
ci_24                 4.086435e-03 3 1  ON 23
ci_25                 2.863845e-03 3 1  ON 24
ci_26                 3.086604e-03 3 1  ON 25
ci_27                 3.185281e-03 3 1  ON 26
ci_28                 1.755168e-03 3 1  ON 27
ci_29                 1.455321e-03 3 1  ON 28
ci_30                -1.779261e-03 3 1  ON 29
ci_31                -4.937564e-04 3 1  ON 30
ci_32                -9.481522e-04 3 1  ON 31
ci_33                -1.370705e-03 3 1  ON 32
ci_34                 1.098186e-03 3 1  ON 33
ci_35                 1.541528e-03 3 1  ON 34
ci_36                -1.076776e-03 3 1  ON 35
ci_37                -1.050004e-03 3 1  ON 36
ci_38                -6.343575e-04 3 1  ON 37
ci_39                -6.040066e-04 3 1  ON 38
ci_40                -1.528692e-03 3 1  ON 39
ci_41                -1.187061e-03 3 1  ON 40
ci_42                -1.176001e-03 3 1  ON 41
ci_43                -2.259740e-03 3 1  ON 42
ci_44                -2.994211e-03 3 1  ON 43
ci_45                -5.581187e-04 3 1  ON 44
ci_46                -7.371494e-04 3 1  ON 45
ci_47                 1.562230e-03 3 1  ON 46
ci_48                 1.418126e-03 3 1  ON 47
ci_49                -9.593543e-04 3 1  ON 48
ci_50                -7.630381e-04 3 1  ON 49
ci_51                 1.268707e-04 3 1  ON 50
ci_52                 1.811953e-04 3 1  ON 51
ci_53                -7.048120e-04 3 1  ON 52
ci_54                -1.080051e-03 3 1  ON 53
ci_55                -6.620588e-04 3 1  ON 54
ci_56                 2.501752e-03 3 1  ON 55
ci_57                 1.713186e-03 3 1  ON 56
ci_58                -1.157744e-03 3 1  ON 57
ci_59                -1.430485e-03 3 1  ON 58
ci_60                 1.758372e-04 3 1  ON 59
ci_61                -2.373565e-04 3 1  ON 60
ci_62                -5.533319e-04 3 1  ON 61
ci_63                -6.344392e-04 3 1  ON 62
ci_64                -3.465420e-04 3 1  ON 63
ci_65                 8.365733e-06 3 1  ON 64
ci_66                -6.620341e-04 3 1  ON 65
ci_67                -8.562119e-04 3 1  ON 66
ci_68                -1.184683e-03 3 1  ON 67
ci_69                 9.313660e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3186e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7873
    reference variance = 0.467695
====================================================
  Execution time = 2.7468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4716e-01
  Total weights = 1.964506817e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435891911901
                                         uncertainty =       0.002159596969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435891911901
                                         uncertainty =       0.002159596969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466817363
  error estimate for blocks of size 2^( 2) =       0.000492184319
  error estimate for blocks of size 2^( 3) =       0.000515573977
  error estimate for blocks of size 2^( 4) =       0.000532195919
  error estimate for blocks of size 2^( 5) =       0.000542507711
  error estimate for blocks of size 2^( 6) =       0.000547849392
  error estimate for blocks of size 2^( 7) =       0.000551058750

      target function =      -0.747710526408
              le_mean =     -22.815635247505
             les_mean =     521.000374124080
             stat err =       0.000543402943
             autocorr =       1.355033303575
   target nu stat err =       0.000543402943
   target dn stat err =       0.002670372438
      target stat err =       0.002311029830
              std dev =       0.660179446604
             le_variance =       0.435836901718


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281563524750e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747716666420       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747716670968       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747716671402       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747716671469       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747716671564       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747716671615       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747716671631       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747716671650       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747716671652       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747716671652       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 5.906294e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747716666420       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747716667557       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747716667665       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747716667682       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747716667707       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747716667710       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747716667717       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747716667728       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747716667726       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747716667741       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 1.476587e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747716666420       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747716666704       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747716666731       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747716666736       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747716666739       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747716666724       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747716666739       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747716666648       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747716666771       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747716666689       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+04 is 3.691476e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068098 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1956e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.264996e-01 3 1  ON 0
ci_02                -2.871775e-02 3 1  ON 1
ci_03                -2.856562e-02 3 1  ON 2
ci_04                 2.661236e-02 3 1  ON 3
ci_05                -2.187556e-02 3 1  ON 4
ci_06                -2.154263e-02 3 1  ON 5
ci_07                 2.710100e-02 3 1  ON 6
ci_08                -5.456717e-03 3 1  ON 7
ci_09                -8.842199e-03 3 1  ON 8
ci_10                -8.364058e-03 3 1  ON 9
ci_11                 1.311055e-02 3 1  ON 10
ci_12                 6.948526e-03 3 1  ON 11
ci_13                 1.303873e-02 3 1  ON 12
ci_14                 1.252707e-02 3 1  ON 13
ci_15                 6.372678e-03 3 1  ON 14
ci_16                 6.264059e-03 3 1  ON 15
ci_17                -7.199106e-03 3 1  ON 16
ci_18                -6.024480e-03 3 1  ON 17
ci_19                 9.258269e-03 3 1  ON 18
ci_20                 6.518468e-03 3 1  ON 19
ci_21                 8.967264e-03 3 1  ON 20
ci_22                 8.289474e-03 3 1  ON 21
ci_23                 4.852452e-03 3 1  ON 22
ci_24                 4.086421e-03 3 1  ON 23
ci_25                 2.863848e-03 3 1  ON 24
ci_26                 3.086601e-03 3 1  ON 25
ci_27                 3.185278e-03 3 1  ON 26
ci_28                 1.755171e-03 3 1  ON 27
ci_29                 1.455320e-03 3 1  ON 28
ci_30                -1.779247e-03 3 1  ON 29
ci_31                -4.937591e-04 3 1  ON 30
ci_32                -9.481624e-04 3 1  ON 31
ci_33                -1.370710e-03 3 1  ON 32
ci_34                 1.098191e-03 3 1  ON 33
ci_35                 1.541529e-03 3 1  ON 34
ci_36                -1.076776e-03 3 1  ON 35
ci_37                -1.050001e-03 3 1  ON 36
ci_38                -6.343518e-04 3 1  ON 37
ci_39                -6.040081e-04 3 1  ON 38
ci_40                -1.528689e-03 3 1  ON 39
ci_41                -1.187064e-03 3 1  ON 40
ci_42                -1.176006e-03 3 1  ON 41
ci_43                -2.259751e-03 3 1  ON 42
ci_44                -2.994212e-03 3 1  ON 43
ci_45                -5.581213e-04 3 1  ON 44
ci_46                -7.371421e-04 3 1  ON 45
ci_47                 1.562227e-03 3 1  ON 46
ci_48                 1.418128e-03 3 1  ON 47
ci_49                -9.593511e-04 3 1  ON 48
ci_50                -7.630357e-04 3 1  ON 49
ci_51                 1.268679e-04 3 1  ON 50
ci_52                 1.811963e-04 3 1  ON 51
ci_53                -7.048094e-04 3 1  ON 52
ci_54                -1.080048e-03 3 1  ON 53
ci_55                -6.620601e-04 3 1  ON 54
ci_56                 2.501748e-03 3 1  ON 55
ci_57                 1.713185e-03 3 1  ON 56
ci_58                -1.157745e-03 3 1  ON 57
ci_59                -1.430485e-03 3 1  ON 58
ci_60                 1.758330e-04 3 1  ON 59
ci_61                -2.373629e-04 3 1  ON 60
ci_62                -5.533319e-04 3 1  ON 61
ci_63                -6.344350e-04 3 1  ON 62
ci_64                -3.465387e-04 3 1  ON 63
ci_65                 8.364304e-06 3 1  ON 64
ci_66                -6.620329e-04 3 1  ON 65
ci_67                -8.562134e-04 3 1  ON 66
ci_68                -1.184681e-03 3 1  ON 67
ci_69                 9.313568e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8127
    reference variance = 0.342131
====================================================
  Execution time = 2.5157e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4528e-01
  Total weights = 1.9646e+06
  Execution time = 3.4850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432473688427
                                         uncertainty =       0.001679200864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432473688427
                                         uncertainty =       0.001679200864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464969571
  error estimate for blocks of size 2^( 2) =       0.000490408290
  error estimate for blocks of size 2^( 3) =       0.000514219303
  error estimate for blocks of size 2^( 4) =       0.000532269063
  error estimate for blocks of size 2^( 5) =       0.000544949150
  error estimate for blocks of size 2^( 6) =       0.000550052096
  error estimate for blocks of size 2^( 7) =       0.000555195682

      target function =      -0.749279724338
              le_mean =     -22.814322313442
             les_mean =     520.938583873938
             stat err =       0.000545616498
             autocorr =       1.376974577293
   target nu stat err =       0.000545616498
   target dn stat err =       0.002402725440
      target stat err =       0.002101225783
              std dev =       0.657566273792
             le_variance =       0.432393404429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432473687516
                                         uncertainty =       0.001679201208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432473687516
                                         uncertainty =       0.001679201208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464969571
  error estimate for blocks of size 2^( 2) =       0.000490408291
  error estimate for blocks of size 2^( 3) =       0.000514219305
  error estimate for blocks of size 2^( 4) =       0.000532269066
  error estimate for blocks of size 2^( 5) =       0.000544949153
  error estimate for blocks of size 2^( 6) =       0.000550052100
  error estimate for blocks of size 2^( 7) =       0.000555195685

      target function =      -0.749279870924
              le_mean =     -22.814322313146
             les_mean =     520.938583685359
             stat err =       0.000545616501
             autocorr =       1.376974596737
   target nu stat err =       0.000545616501
   target dn stat err =       0.002402709473
      target stat err =       0.002101213782
              std dev =       0.657566273099
             le_variance =       0.432393403517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432473687971
                                         uncertainty =       0.001679201036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432473687971
                                         uncertainty =       0.001679201036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464969571
  error estimate for blocks of size 2^( 2) =       0.000490408291
  error estimate for blocks of size 2^( 3) =       0.000514219304
  error estimate for blocks of size 2^( 4) =       0.000532269064
  error estimate for blocks of size 2^( 5) =       0.000544949151
  error estimate for blocks of size 2^( 6) =       0.000550052098
  error estimate for blocks of size 2^( 7) =       0.000555195684

      target function =      -0.749279797726
              le_mean =     -22.814322313294
             les_mean =     520.938583779535
             stat err =       0.000545616499
             autocorr =       1.376974587016
   target nu stat err =       0.000545616499
   target dn stat err =       0.002402717455
      target stat err =       0.002101219782
              std dev =       0.657566273445
             le_variance =       0.432393403973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432473688370
                                         uncertainty =       0.001679200886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432473688370
                                         uncertainty =       0.001679200886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464969571
  error estimate for blocks of size 2^( 2) =       0.000490408290
  error estimate for blocks of size 2^( 3) =       0.000514219304
  error estimate for blocks of size 2^( 4) =       0.000532269063
  error estimate for blocks of size 2^( 5) =       0.000544949150
  error estimate for blocks of size 2^( 6) =       0.000550052097
  error estimate for blocks of size 2^( 7) =       0.000555195682

      target function =      -0.749279733522
              le_mean =     -22.814322313423
             les_mean =     520.938583862126
             stat err =       0.000545616498
             autocorr =       1.376974578521
   target nu stat err =       0.000545616498
   target dn stat err =       0.002402724442
      target stat err =       0.002101225033
              std dev =       0.657566273749
             le_variance =       0.432393404372


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749279724338        initial
     2.4414e+03     2.4414e+04             5.9063e-08        -0.749279870924  <--
     9.7656e+03     9.7656e+04             1.4766e-08        -0.749279797726
     3.9062e+04     3.9062e+05             3.6915e-09        -0.749279733522

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 4.2575e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.264996e-01 3 1  ON 0
ci_02                -2.871774e-02 3 1  ON 1
ci_03                -2.856562e-02 3 1  ON 2
ci_04                 2.661232e-02 3 1  ON 3
ci_05                -2.187557e-02 3 1  ON 4
ci_06                -2.154264e-02 3 1  ON 5
ci_07                 2.710101e-02 3 1  ON 6
ci_08                -5.456714e-03 3 1  ON 7
ci_09                -8.842199e-03 3 1  ON 8
ci_10                -8.364065e-03 3 1  ON 9
ci_11                 1.311055e-02 3 1  ON 10
ci_12                 6.948536e-03 3 1  ON 11
ci_13                 1.303872e-02 3 1  ON 12
ci_14                 1.252704e-02 3 1  ON 13
ci_15                 6.372715e-03 3 1  ON 14
ci_16                 6.264082e-03 3 1  ON 15
ci_17                -7.199137e-03 3 1  ON 16
ci_18                -6.024472e-03 3 1  ON 17
ci_19                 9.258281e-03 3 1  ON 18
ci_20                 6.518467e-03 3 1  ON 19
ci_21                 8.967261e-03 3 1  ON 20
ci_22                 8.289477e-03 3 1  ON 21
ci_23                 4.852443e-03 3 1  ON 22
ci_24                 4.086376e-03 3 1  ON 23
ci_25                 2.863857e-03 3 1  ON 24
ci_26                 3.086592e-03 3 1  ON 25
ci_27                 3.185266e-03 3 1  ON 26
ci_28                 1.755178e-03 3 1  ON 27
ci_29                 1.455317e-03 3 1  ON 28
ci_30                -1.779208e-03 3 1  ON 29
ci_31                -4.937670e-04 3 1  ON 30
ci_32                -9.481929e-04 3 1  ON 31
ci_33                -1.370726e-03 3 1  ON 32
ci_34                 1.098204e-03 3 1  ON 33
ci_35                 1.541533e-03 3 1  ON 34
ci_36                -1.076773e-03 3 1  ON 35
ci_37                -1.049990e-03 3 1  ON 36
ci_38                -6.343345e-04 3 1  ON 37
ci_39                -6.040128e-04 3 1  ON 38
ci_40                -1.528681e-03 3 1  ON 39
ci_41                -1.187076e-03 3 1  ON 40
ci_42                -1.176021e-03 3 1  ON 41
ci_43                -2.259781e-03 3 1  ON 42
ci_44                -2.994215e-03 3 1  ON 43
ci_45                -5.581289e-04 3 1  ON 44
ci_46                -7.371203e-04 3 1  ON 45
ci_47                 1.562221e-03 3 1  ON 46
ci_48                 1.418133e-03 3 1  ON 47
ci_49                -9.593414e-04 3 1  ON 48
ci_50                -7.630285e-04 3 1  ON 49
ci_51                 1.268596e-04 3 1  ON 50
ci_52                 1.811993e-04 3 1  ON 51
ci_53                -7.048016e-04 3 1  ON 52
ci_54                -1.080038e-03 3 1  ON 53
ci_55                -6.620637e-04 3 1  ON 54
ci_56                 2.501738e-03 3 1  ON 55
ci_57                 1.713183e-03 3 1  ON 56
ci_58                -1.157748e-03 3 1  ON 57
ci_59                -1.430484e-03 3 1  ON 58
ci_60                 1.758202e-04 3 1  ON 59
ci_61                -2.373824e-04 3 1  ON 60
ci_62                -5.533318e-04 3 1  ON 61
ci_63                -6.344222e-04 3 1  ON 62
ci_64                -3.465290e-04 3 1  ON 63
ci_65                 8.360017e-06 3 1  ON 64
ci_66                -6.620294e-04 3 1  ON 65
ci_67                -8.562178e-04 3 1  ON 66
ci_68                -1.184675e-03 3 1  ON 67
ci_69                 9.313290e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4538e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8847
    reference variance = 0.518438
====================================================
  Execution time = 2.5779e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5353e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4577e-01
  Total weights = 1.964285766e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434001443484
                                         uncertainty =       0.002029772624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434001443484
                                         uncertainty =       0.002029772624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465956926
  error estimate for blocks of size 2^( 2) =       0.000491210146
  error estimate for blocks of size 2^( 3) =       0.000514609917
  error estimate for blocks of size 2^( 4) =       0.000531899357
  error estimate for blocks of size 2^( 5) =       0.000542885982
  error estimate for blocks of size 2^( 6) =       0.000548470412
  error estimate for blocks of size 2^( 7) =       0.000550568650

      target function =      -0.748869309572
              le_mean =     -22.814066454354
             les_mean =     520.927397408453
             stat err =       0.000543456100
             autocorr =       1.360308441686
   target nu stat err =       0.000543456100
   target dn stat err =       0.002565238032
      target stat err =       0.002227880916
              std dev =       0.658962604144
             le_variance =       0.434231713661


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281406645435e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748874971052       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748874989248       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748874992023       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748874992571       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748874992887       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748874992923       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748874992935       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748874992951       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748874992956       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+02 is 3.500934e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748874971052       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748874975601       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748874976295       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748874976432       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748874976510       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748874976514       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748874976520       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748874976526       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748874976529       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 8.752624e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748874971052       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748874972189       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748874972363       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748874972396       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748874972422       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748874972421       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748874972405       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748874972428       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748874972421       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 2.188174e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071153 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0246e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.264995e-01 3 1  ON 0
ci_02                -2.871772e-02 3 1  ON 1
ci_03                -2.856563e-02 3 1  ON 2
ci_04                 2.661227e-02 3 1  ON 3
ci_05                -2.187551e-02 3 1  ON 4
ci_06                -2.154263e-02 3 1  ON 5
ci_07                 2.710100e-02 3 1  ON 6
ci_08                -5.456724e-03 3 1  ON 7
ci_09                -8.842194e-03 3 1  ON 8
ci_10                -8.364067e-03 3 1  ON 9
ci_11                 1.311056e-02 3 1  ON 10
ci_12                 6.948488e-03 3 1  ON 11
ci_13                 1.303871e-02 3 1  ON 12
ci_14                 1.252704e-02 3 1  ON 13
ci_15                 6.372730e-03 3 1  ON 14
ci_16                 6.264105e-03 3 1  ON 15
ci_17                -7.199114e-03 3 1  ON 16
ci_18                -6.024473e-03 3 1  ON 17
ci_19                 9.258306e-03 3 1  ON 18
ci_20                 6.518462e-03 3 1  ON 19
ci_21                 8.967246e-03 3 1  ON 20
ci_22                 8.289522e-03 3 1  ON 21
ci_23                 4.852443e-03 3 1  ON 22
ci_24                 4.086352e-03 3 1  ON 23
ci_25                 2.863872e-03 3 1  ON 24
ci_26                 3.086581e-03 3 1  ON 25
ci_27                 3.185242e-03 3 1  ON 26
ci_28                 1.755186e-03 3 1  ON 27
ci_29                 1.455298e-03 3 1  ON 28
ci_30                -1.779195e-03 3 1  ON 29
ci_31                -4.937800e-04 3 1  ON 30
ci_32                -9.481931e-04 3 1  ON 31
ci_33                -1.370725e-03 3 1  ON 32
ci_34                 1.098199e-03 3 1  ON 33
ci_35                 1.541537e-03 3 1  ON 34
ci_36                -1.076779e-03 3 1  ON 35
ci_37                -1.049994e-03 3 1  ON 36
ci_38                -6.343305e-04 3 1  ON 37
ci_39                -6.040095e-04 3 1  ON 38
ci_40                -1.528683e-03 3 1  ON 39
ci_41                -1.187082e-03 3 1  ON 40
ci_42                -1.176009e-03 3 1  ON 41
ci_43                -2.259778e-03 3 1  ON 42
ci_44                -2.994223e-03 3 1  ON 43
ci_45                -5.581364e-04 3 1  ON 44
ci_46                -7.371074e-04 3 1  ON 45
ci_47                 1.562229e-03 3 1  ON 46
ci_48                 1.418161e-03 3 1  ON 47
ci_49                -9.593374e-04 3 1  ON 48
ci_50                -7.630264e-04 3 1  ON 49
ci_51                 1.268697e-04 3 1  ON 50
ci_52                 1.811985e-04 3 1  ON 51
ci_53                -7.047864e-04 3 1  ON 52
ci_54                -1.080026e-03 3 1  ON 53
ci_55                -6.620740e-04 3 1  ON 54
ci_56                 2.501729e-03 3 1  ON 55
ci_57                 1.713212e-03 3 1  ON 56
ci_58                -1.157751e-03 3 1  ON 57
ci_59                -1.430475e-03 3 1  ON 58
ci_60                 1.758168e-04 3 1  ON 59
ci_61                -2.374011e-04 3 1  ON 60
ci_62                -5.533227e-04 3 1  ON 61
ci_63                -6.344231e-04 3 1  ON 62
ci_64                -3.465441e-04 3 1  ON 63
ci_65                 8.359119e-06 3 1  ON 64
ci_66                -6.620241e-04 3 1  ON 65
ci_67                -8.562214e-04 3 1  ON 66
ci_68                -1.184685e-03 3 1  ON 67
ci_69                 9.311665e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7403
    reference variance = 0.52947
====================================================
  Execution time = 2.5225e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4770e-01
  Total weights = 1.9646e+06
  Execution time = 3.4547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434358914951
                                         uncertainty =       0.002036348744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434358914951
                                         uncertainty =       0.002036348744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466037915
  error estimate for blocks of size 2^( 2) =       0.000491606632
  error estimate for blocks of size 2^( 3) =       0.000515434757
  error estimate for blocks of size 2^( 4) =       0.000533419221
  error estimate for blocks of size 2^( 5) =       0.000545141083
  error estimate for blocks of size 2^( 6) =       0.000551969969
  error estimate for blocks of size 2^( 7) =       0.000556356836

      target function =      -0.747258920938
              le_mean =     -22.814750264547
             les_mean =     520.960530218229
             stat err =       0.000546721777
             autocorr =       1.376227540087
   target nu stat err =       0.000546721777
   target dn stat err =       0.002924476331
      target stat err =       0.002511022581
              std dev =       0.659077140587
             le_variance =       0.434382677244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434358885424
                                         uncertainty =       0.002036349376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434358885424
                                         uncertainty =       0.002036349376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466037900
  error estimate for blocks of size 2^( 2) =       0.000491606627
  error estimate for blocks of size 2^( 3) =       0.000515434763
  error estimate for blocks of size 2^( 4) =       0.000533419235
  error estimate for blocks of size 2^( 5) =       0.000545141100
  error estimate for blocks of size 2^( 6) =       0.000551969989
  error estimate for blocks of size 2^( 7) =       0.000556356859

      target function =      -0.747259111324
              le_mean =     -22.814750263833
             les_mean =     520.960529957394
             stat err =       0.000546721796
             autocorr =       1.376227727185
   target nu stat err =       0.000546721796
   target dn stat err =       0.002924427877
      target stat err =       0.002510984671
              std dev =       0.659077118148
             le_variance =       0.434382647667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434358900186
                                         uncertainty =       0.002036349060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434358900186
                                         uncertainty =       0.002036349060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466037907
  error estimate for blocks of size 2^( 2) =       0.000491606629
  error estimate for blocks of size 2^( 3) =       0.000515434760
  error estimate for blocks of size 2^( 4) =       0.000533419228
  error estimate for blocks of size 2^( 5) =       0.000545141092
  error estimate for blocks of size 2^( 6) =       0.000551969979
  error estimate for blocks of size 2^( 7) =       0.000556356847

      target function =      -0.747259016401
              le_mean =     -22.814750264189
             les_mean =     520.960530087480
             stat err =       0.000546721786
             autocorr =       1.376227633644
   target nu stat err =       0.000546721786
   target dn stat err =       0.002924452097
      target stat err =       0.002511003622
              std dev =       0.659077129366
             le_variance =       0.434382662453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434358913106
                                         uncertainty =       0.002036348783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434358913106
                                         uncertainty =       0.002036348783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466037914
  error estimate for blocks of size 2^( 2) =       0.000491606631
  error estimate for blocks of size 2^( 3) =       0.000515434757
  error estimate for blocks of size 2^( 4) =       0.000533419222
  error estimate for blocks of size 2^( 5) =       0.000545141084
  error estimate for blocks of size 2^( 6) =       0.000551969970
  error estimate for blocks of size 2^( 7) =       0.000556356837

      target function =      -0.747258932900
              le_mean =     -22.814750264502
             les_mean =     520.960530201849
             stat err =       0.000546721778
             autocorr =       1.376227551774
   target nu stat err =       0.000546721778
   target dn stat err =       0.002924473301
      target stat err =       0.002511020211
              std dev =       0.659077139184
             le_variance =       0.434382675395


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747258920938        initial
     6.1035e+02     6.1035e+03             3.5009e-07        -0.747259111324  <--
     2.4414e+03     2.4414e+04             8.7526e-08        -0.747259016401
     9.7656e+03     9.7656e+04             2.1882e-08        -0.747258932900

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 4.2559e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.264992e-01 3 1  ON 0
ci_02                -2.871766e-02 3 1  ON 1
ci_03                -2.856567e-02 3 1  ON 2
ci_04                 2.661212e-02 3 1  ON 3
ci_05                -2.187534e-02 3 1  ON 4
ci_06                -2.154260e-02 3 1  ON 5
ci_07                 2.710099e-02 3 1  ON 6
ci_08                -5.456754e-03 3 1  ON 7
ci_09                -8.842178e-03 3 1  ON 8
ci_10                -8.364074e-03 3 1  ON 9
ci_11                 1.311059e-02 3 1  ON 10
ci_12                 6.948344e-03 3 1  ON 11
ci_13                 1.303869e-02 3 1  ON 12
ci_14                 1.252706e-02 3 1  ON 13
ci_15                 6.372773e-03 3 1  ON 14
ci_16                 6.264175e-03 3 1  ON 15
ci_17                -7.199047e-03 3 1  ON 16
ci_18                -6.024478e-03 3 1  ON 17
ci_19                 9.258382e-03 3 1  ON 18
ci_20                 6.518447e-03 3 1  ON 19
ci_21                 8.967198e-03 3 1  ON 20
ci_22                 8.289659e-03 3 1  ON 21
ci_23                 4.852445e-03 3 1  ON 22
ci_24                 4.086279e-03 3 1  ON 23
ci_25                 2.863916e-03 3 1  ON 24
ci_26                 3.086547e-03 3 1  ON 25
ci_27                 3.185167e-03 3 1  ON 26
ci_28                 1.755209e-03 3 1  ON 27
ci_29                 1.455243e-03 3 1  ON 28
ci_30                -1.779154e-03 3 1  ON 29
ci_31                -4.938188e-04 3 1  ON 30
ci_32                -9.481937e-04 3 1  ON 31
ci_33                -1.370722e-03 3 1  ON 32
ci_34                 1.098185e-03 3 1  ON 33
ci_35                 1.541550e-03 3 1  ON 34
ci_36                -1.076796e-03 3 1  ON 35
ci_37                -1.050006e-03 3 1  ON 36
ci_38                -6.343185e-04 3 1  ON 37
ci_39                -6.039994e-04 3 1  ON 38
ci_40                -1.528691e-03 3 1  ON 39
ci_41                -1.187100e-03 3 1  ON 40
ci_42                -1.175973e-03 3 1  ON 41
ci_43                -2.259767e-03 3 1  ON 42
ci_44                -2.994250e-03 3 1  ON 43
ci_45                -5.581589e-04 3 1  ON 44
ci_46                -7.370686e-04 3 1  ON 45
ci_47                 1.562253e-03 3 1  ON 46
ci_48                 1.418242e-03 3 1  ON 47
ci_49                -9.593254e-04 3 1  ON 48
ci_50                -7.630202e-04 3 1  ON 49
ci_51                 1.269000e-04 3 1  ON 50
ci_52                 1.811961e-04 3 1  ON 51
ci_53                -7.047407e-04 3 1  ON 52
ci_54                -1.079991e-03 3 1  ON 53
ci_55                -6.621049e-04 3 1  ON 54
ci_56                 2.501701e-03 3 1  ON 55
ci_57                 1.713297e-03 3 1  ON 56
ci_58                -1.157760e-03 3 1  ON 57
ci_59                -1.430447e-03 3 1  ON 58
ci_60                 1.758063e-04 3 1  ON 59
ci_61                -2.374572e-04 3 1  ON 60
ci_62                -5.532956e-04 3 1  ON 61
ci_63                -6.344256e-04 3 1  ON 62
ci_64                -3.465896e-04 3 1  ON 63
ci_65                 8.356424e-06 3 1  ON 64
ci_66                -6.620081e-04 3 1  ON 65
ci_67                -8.562321e-04 3 1  ON 66
ci_68                -1.184713e-03 3 1  ON 67
ci_69                 9.306789e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2813e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8228
    reference variance = 0.626128
====================================================
  Execution time = 2.6439e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5365e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5011e-01
  Total weights = 1.964348479e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436469182961
                                         uncertainty =       0.002540596965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436469182961
                                         uncertainty =       0.002540596965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467128864
  error estimate for blocks of size 2^( 2) =       0.000492047520
  error estimate for blocks of size 2^( 3) =       0.000516038448
  error estimate for blocks of size 2^( 4) =       0.000534299633
  error estimate for blocks of size 2^( 5) =       0.000545203863
  error estimate for blocks of size 2^( 6) =       0.000552912300
  error estimate for blocks of size 2^( 7) =       0.000558117867

      target function =      -0.745246982756
              le_mean =     -22.816009838552
             les_mean =     521.020418693146
             stat err =       0.000547633416
             autocorr =       1.374378885111
   target nu stat err =       0.000547633416
   target dn stat err =       0.003697469248
      target stat err =       0.003129061391
              std dev =       0.660619974851
             le_variance =       0.436418751173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281600983855e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745259185707       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745259511140       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745259547961       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745259556740       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745259557849       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745259558336       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745259558428       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745259558484       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745259558487       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745259558508       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+02 is 2.369191e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745259185707       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745259267086       residual = 6.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745259276293       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745259278488       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745259278766       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745259278886       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745259278910       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745259278923       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745259278923       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745259278930       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+02 is 5.924492e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745259185707       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745259206053       residual = 6.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745259208355       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745259208904       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745259208968       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745259209003       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745259209011       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745259209011       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745259209011       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745259209012       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 1.481218e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074695 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1193e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.264991e-01 3 1  ON 0
ci_02                -2.871751e-02 3 1  ON 1
ci_03                -2.856568e-02 3 1  ON 2
ci_04                 2.661193e-02 3 1  ON 3
ci_05                -2.187522e-02 3 1  ON 4
ci_06                -2.154263e-02 3 1  ON 5
ci_07                 2.710088e-02 3 1  ON 6
ci_08                -5.456777e-03 3 1  ON 7
ci_09                -8.842015e-03 3 1  ON 8
ci_10                -8.364602e-03 3 1  ON 9
ci_11                 1.311074e-02 3 1  ON 10
ci_12                 6.948263e-03 3 1  ON 11
ci_13                 1.303866e-02 3 1  ON 12
ci_14                 1.252703e-02 3 1  ON 13
ci_15                 6.372820e-03 3 1  ON 14
ci_16                 6.263867e-03 3 1  ON 15
ci_17                -7.198806e-03 3 1  ON 16
ci_18                -6.024608e-03 3 1  ON 17
ci_19                 9.258456e-03 3 1  ON 18
ci_20                 6.518367e-03 3 1  ON 19
ci_21                 8.967039e-03 3 1  ON 20
ci_22                 8.289726e-03 3 1  ON 21
ci_23                 4.852421e-03 3 1  ON 22
ci_24                 4.086210e-03 3 1  ON 23
ci_25                 2.863832e-03 3 1  ON 24
ci_26                 3.085954e-03 3 1  ON 25
ci_27                 3.185150e-03 3 1  ON 26
ci_28                 1.755198e-03 3 1  ON 27
ci_29                 1.455301e-03 3 1  ON 28
ci_30                -1.778872e-03 3 1  ON 29
ci_31                -4.937872e-04 3 1  ON 30
ci_32                -9.480430e-04 3 1  ON 31
ci_33                -1.370643e-03 3 1  ON 32
ci_34                 1.098012e-03 3 1  ON 33
ci_35                 1.541533e-03 3 1  ON 34
ci_36                -1.076819e-03 3 1  ON 35
ci_37                -1.050047e-03 3 1  ON 36
ci_38                -6.342171e-04 3 1  ON 37
ci_39                -6.039728e-04 3 1  ON 38
ci_40                -1.528624e-03 3 1  ON 39
ci_41                -1.187278e-03 3 1  ON 40
ci_42                -1.175911e-03 3 1  ON 41
ci_43                -2.259854e-03 3 1  ON 42
ci_44                -2.994282e-03 3 1  ON 43
ci_45                -5.581935e-04 3 1  ON 44
ci_46                -7.370723e-04 3 1  ON 45
ci_47                 1.562222e-03 3 1  ON 46
ci_48                 1.418526e-03 3 1  ON 47
ci_49                -9.593296e-04 3 1  ON 48
ci_50                -7.630646e-04 3 1  ON 49
ci_51                 1.269630e-04 3 1  ON 50
ci_52                 1.811763e-04 3 1  ON 51
ci_53                -7.048454e-04 3 1  ON 52
ci_54                -1.079920e-03 3 1  ON 53
ci_55                -6.621838e-04 3 1  ON 54
ci_56                 2.501557e-03 3 1  ON 55
ci_57                 1.713346e-03 3 1  ON 56
ci_58                -1.157776e-03 3 1  ON 57
ci_59                -1.430422e-03 3 1  ON 58
ci_60                 1.756466e-04 3 1  ON 59
ci_61                -2.374004e-04 3 1  ON 60
ci_62                -5.531786e-04 3 1  ON 61
ci_63                -6.343328e-04 3 1  ON 62
ci_64                -3.465592e-04 3 1  ON 63
ci_65                 8.379350e-06 3 1  ON 64
ci_66                -6.620288e-04 3 1  ON 65
ci_67                -8.562468e-04 3 1  ON 66
ci_68                -1.184635e-03 3 1  ON 67
ci_69                 9.294087e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7571
    reference variance = 0.865181
====================================================
  Execution time = 2.5357e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6045e-01
  Total weights = 1.9644e+06
  Execution time = 3.4567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948328609
                                         uncertainty =       0.003967803157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948328609
                                         uncertainty =       0.003967803157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470066544
  error estimate for blocks of size 2^( 2) =       0.000495203105
  error estimate for blocks of size 2^( 3) =       0.000518923312
  error estimate for blocks of size 2^( 4) =       0.000536672960
  error estimate for blocks of size 2^( 5) =       0.000545765984
  error estimate for blocks of size 2^( 6) =       0.000551129623
  error estimate for blocks of size 2^( 7) =       0.000552447869

      target function =      -0.736730351315
              le_mean =     -22.813890231053
             les_mean =     520.934038285850
             stat err =       0.000546504109
             autocorr =       1.351662229933
   target nu stat err =       0.000546504109
   target dn stat err =       0.009249616448
      target stat err =       0.007504019190
              std dev =       0.664774482005
             le_variance =       0.441925111925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948227838
                                         uncertainty =       0.003968001514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948227838
                                         uncertainty =       0.003968001514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470066492
  error estimate for blocks of size 2^( 2) =       0.000495203098
  error estimate for blocks of size 2^( 3) =       0.000518923346
  error estimate for blocks of size 2^( 4) =       0.000536673021
  error estimate for blocks of size 2^( 5) =       0.000545766042
  error estimate for blocks of size 2^( 6) =       0.000551129611
  error estimate for blocks of size 2^( 7) =       0.000552447892

      target function =      -0.736731909679
              le_mean =     -22.813890235650
             les_mean =     520.934036558653
             stat err =       0.000546504141
             autocorr =       1.351662687617
   target nu stat err =       0.000546504141
   target dn stat err =       0.009250081480
      target stat err =       0.007504425831
              std dev =       0.664774408727
             le_variance =       0.441925014498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948278088
                                         uncertainty =       0.003967902363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948278088
                                         uncertainty =       0.003967902363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470066518
  error estimate for blocks of size 2^( 2) =       0.000495203101
  error estimate for blocks of size 2^( 3) =       0.000518923329
  error estimate for blocks of size 2^( 4) =       0.000536672990
  error estimate for blocks of size 2^( 5) =       0.000545766013
  error estimate for blocks of size 2^( 6) =       0.000551129617
  error estimate for blocks of size 2^( 7) =       0.000552447880

      target function =      -0.736731144224
              le_mean =     -22.813890233346
             les_mean =     520.934037405061
             stat err =       0.000546504125
             autocorr =       1.351662458717
   target nu stat err =       0.000546504125
   target dn stat err =       0.009249848786
      target stat err =       0.007504222645
              std dev =       0.664774445265
             le_variance =       0.441925063077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948322279
                                         uncertainty =       0.003967815558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948322279
                                         uncertainty =       0.003967815558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470066541
  error estimate for blocks of size 2^( 2) =       0.000495203104
  error estimate for blocks of size 2^( 3) =       0.000518923314
  error estimate for blocks of size 2^( 4) =       0.000536672964
  error estimate for blocks of size 2^( 5) =       0.000545765988
  error estimate for blocks of size 2^( 6) =       0.000551129622
  error estimate for blocks of size 2^( 7) =       0.000552447870

      target function =      -0.736730451931
              le_mean =     -22.813890231339
             les_mean =     520.934038173867
             stat err =       0.000546504111
             autocorr =       1.351662258518
   target nu stat err =       0.000546504111
   target dn stat err =       0.009249645464
      target stat err =       0.007504044631
              std dev =       0.664774477401
             le_variance =       0.441925105804


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.736730351315        initial
     1.5259e+02     1.5259e+03             2.3692e-06        -0.736731909679  <--
     6.1035e+02     6.1035e+03             5.9245e-07        -0.736731144224
     2.4414e+03     2.4414e+04             1.4812e-07        -0.736730451931

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 4.2676e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.264985e-01 3 1  ON 0
ci_02                -2.871706e-02 3 1  ON 1
ci_03                -2.856570e-02 3 1  ON 2
ci_04                 2.661136e-02 3 1  ON 3
ci_05                -2.187488e-02 3 1  ON 4
ci_06                -2.154274e-02 3 1  ON 5
ci_07                 2.710057e-02 3 1  ON 6
ci_08                -5.456848e-03 3 1  ON 7
ci_09                -8.841526e-03 3 1  ON 8
ci_10                -8.366187e-03 3 1  ON 9
ci_11                 1.311121e-02 3 1  ON 10
ci_12                 6.948019e-03 3 1  ON 11
ci_13                 1.303855e-02 3 1  ON 12
ci_14                 1.252697e-02 3 1  ON 13
ci_15                 6.372959e-03 3 1  ON 14
ci_16                 6.262944e-03 3 1  ON 15
ci_17                -7.198083e-03 3 1  ON 16
ci_18                -6.024997e-03 3 1  ON 17
ci_19                 9.258677e-03 3 1  ON 18
ci_20                 6.518126e-03 3 1  ON 19
ci_21                 8.966562e-03 3 1  ON 20
ci_22                 8.289930e-03 3 1  ON 21
ci_23                 4.852348e-03 3 1  ON 22
ci_24                 4.086005e-03 3 1  ON 23
ci_25                 2.863583e-03 3 1  ON 24
ci_26                 3.084177e-03 3 1  ON 25
ci_27                 3.185101e-03 3 1  ON 26
ci_28                 1.755164e-03 3 1  ON 27
ci_29                 1.455475e-03 3 1  ON 28
ci_30                -1.778026e-03 3 1  ON 29
ci_31                -4.936923e-04 3 1  ON 30
ci_32                -9.475910e-04 3 1  ON 31
ci_33                -1.370406e-03 3 1  ON 32
ci_34                 1.097496e-03 3 1  ON 33
ci_35                 1.541483e-03 3 1  ON 34
ci_36                -1.076886e-03 3 1  ON 35
ci_37                -1.050172e-03 3 1  ON 36
ci_38                -6.339130e-04 3 1  ON 37
ci_39                -6.038931e-04 3 1  ON 38
ci_40                -1.528422e-03 3 1  ON 39
ci_41                -1.187812e-03 3 1  ON 40
ci_42                -1.175726e-03 3 1  ON 41
ci_43                -2.260116e-03 3 1  ON 42
ci_44                -2.994377e-03 3 1  ON 43
ci_45                -5.582973e-04 3 1  ON 44
ci_46                -7.370834e-04 3 1  ON 45
ci_47                 1.562129e-03 3 1  ON 46
ci_48                 1.419380e-03 3 1  ON 47
ci_49                -9.593423e-04 3 1  ON 48
ci_50                -7.631975e-04 3 1  ON 49
ci_51                 1.271518e-04 3 1  ON 50
ci_52                 1.811170e-04 3 1  ON 51
ci_53                -7.051596e-04 3 1  ON 52
ci_54                -1.079708e-03 3 1  ON 53
ci_55                -6.624206e-04 3 1  ON 54
ci_56                 2.501127e-03 3 1  ON 55
ci_57                 1.713492e-03 3 1  ON 56
ci_58                -1.157825e-03 3 1  ON 57
ci_59                -1.430348e-03 3 1  ON 58
ci_60                 1.751674e-04 3 1  ON 59
ci_61                -2.372302e-04 3 1  ON 60
ci_62                -5.528275e-04 3 1  ON 61
ci_63                -6.340546e-04 3 1  ON 62
ci_64                -3.464680e-04 3 1  ON 63
ci_65                 8.448105e-06 3 1  ON 64
ci_66                -6.620910e-04 3 1  ON 65
ci_67                -8.562908e-04 3 1  ON 66
ci_68                -1.184400e-03 3 1  ON 67
ci_69                 9.255996e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3906e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.786
    reference variance = 0.426595
====================================================
  Execution time = 2.5819e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5353e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.7610e-01
  Total weights = 1.963988024e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457114005037
                                         uncertainty =       0.018934858833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457114005037
                                         uncertainty =       0.018934858833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478072704
  error estimate for blocks of size 2^( 2) =       0.000503111715
  error estimate for blocks of size 2^( 3) =       0.000526617218
  error estimate for blocks of size 2^( 4) =       0.000543902274
  error estimate for blocks of size 2^( 5) =       0.000555934789
  error estimate for blocks of size 2^( 6) =       0.000562426645
  error estimate for blocks of size 2^( 7) =       0.000564088134

      target function =      -0.723785384585
              le_mean =     -22.814313875347
             les_mean =     520.969014634973
             stat err =       0.000556587961
             autocorr =       1.355438197693
   target nu stat err =       0.000556587961
   target dn stat err =       0.026005760493
      target stat err =       0.020333391053
              std dev =       0.676096901516
             le_variance =       0.457107020239


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281431387535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.724352282189       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.724353486803       residual = 8.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.724353685424       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.724353734085       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.724353750212       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.724353759419       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.724353760491       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.724353760124       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.724353760335       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.724353759983       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.724353759989       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+01 is 8.762752e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.724352282189       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.724352583620       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.724352633300       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.724352645466       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.724352649496       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.724352651796       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.724352652063       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.724352651971       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.724352652024       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.724352651936       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.724352651938       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+02 is 2.192586e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.724352282189       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.724352357564       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.724352369985       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.724352373027       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.724352374035       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.724352374609       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.724352374677       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.724352374653       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.724352374668       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.724352374644       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.724352374645       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+02 is 5.482653e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.078792 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0314e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.264970e-01 3 1  ON 0
ci_02                -2.871710e-02 3 1  ON 1
ci_03                -2.856470e-02 3 1  ON 2
ci_04                 2.661120e-02 3 1  ON 3
ci_05                -2.187613e-02 3 1  ON 4
ci_06                -2.154120e-02 3 1  ON 5
ci_07                 2.710092e-02 3 1  ON 6
ci_08                -5.457707e-03 3 1  ON 7
ci_09                -8.842511e-03 3 1  ON 8
ci_10                -8.366402e-03 3 1  ON 9
ci_11                 1.311121e-02 3 1  ON 10
ci_12                 6.948602e-03 3 1  ON 11
ci_13                 1.303914e-02 3 1  ON 12
ci_14                 1.252797e-02 3 1  ON 13
ci_15                 6.373240e-03 3 1  ON 14
ci_16                 6.262895e-03 3 1  ON 15
ci_17                -7.197749e-03 3 1  ON 16
ci_18                -6.022837e-03 3 1  ON 17
ci_19                 9.258492e-03 3 1  ON 18
ci_20                 6.517870e-03 3 1  ON 19
ci_21                 8.967280e-03 3 1  ON 20
ci_22                 8.289403e-03 3 1  ON 21
ci_23                 4.852433e-03 3 1  ON 22
ci_24                 4.084272e-03 3 1  ON 23
ci_25                 2.863288e-03 3 1  ON 24
ci_26                 3.084682e-03 3 1  ON 25
ci_27                 3.185280e-03 3 1  ON 26
ci_28                 1.755012e-03 3 1  ON 27
ci_29                 1.453282e-03 3 1  ON 28
ci_30                -1.778011e-03 3 1  ON 29
ci_31                -4.935579e-04 3 1  ON 30
ci_32                -9.470878e-04 3 1  ON 31
ci_33                -1.370545e-03 3 1  ON 32
ci_34                 1.097486e-03 3 1  ON 33
ci_35                 1.540749e-03 3 1  ON 34
ci_36                -1.077100e-03 3 1  ON 35
ci_37                -1.050481e-03 3 1  ON 36
ci_38                -6.340135e-04 3 1  ON 37
ci_39                -6.040955e-04 3 1  ON 38
ci_40                -1.528451e-03 3 1  ON 39
ci_41                -1.187881e-03 3 1  ON 40
ci_42                -1.176056e-03 3 1  ON 41
ci_43                -2.260218e-03 3 1  ON 42
ci_44                -2.993385e-03 3 1  ON 43
ci_45                -5.577549e-04 3 1  ON 44
ci_46                -7.368015e-04 3 1  ON 45
ci_47                 1.562147e-03 3 1  ON 46
ci_48                 1.419315e-03 3 1  ON 47
ci_49                -9.595489e-04 3 1  ON 48
ci_50                -7.628963e-04 3 1  ON 49
ci_51                 1.272908e-04 3 1  ON 50
ci_52                 1.813999e-04 3 1  ON 51
ci_53                -7.052265e-04 3 1  ON 52
ci_54                -1.079880e-03 3 1  ON 53
ci_55                -6.620490e-04 3 1  ON 54
ci_56                 2.500729e-03 3 1  ON 55
ci_57                 1.713861e-03 3 1  ON 56
ci_58                -1.157305e-03 3 1  ON 57
ci_59                -1.429822e-03 3 1  ON 58
ci_60                 1.745787e-04 3 1  ON 59
ci_61                -2.359226e-04 3 1  ON 60
ci_62                -5.530078e-04 3 1  ON 61
ci_63                -6.337306e-04 3 1  ON 62
ci_64                -3.458355e-04 3 1  ON 63
ci_65                 8.536878e-06 3 1  ON 64
ci_66                -6.626709e-04 3 1  ON 65
ci_67                -8.561245e-04 3 1  ON 66
ci_68                -1.184641e-03 3 1  ON 67
ci_69                 9.235247e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.666
    reference variance = 0.335644
====================================================
  Execution time = 2.6098e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4847e-01
  Total weights = 1.9641e+06
  Execution time = 3.4638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436308527316
                                         uncertainty =       0.001862813659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436308527316
                                         uncertainty =       0.001862813659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467091053
  error estimate for blocks of size 2^( 2) =       0.000492735490
  error estimate for blocks of size 2^( 3) =       0.000516143427
  error estimate for blocks of size 2^( 4) =       0.000534239633
  error estimate for blocks of size 2^( 5) =       0.000544907307
  error estimate for blocks of size 2^( 6) =       0.000548495460
  error estimate for blocks of size 2^( 7) =       0.000552045301

      target function =      -0.746619822860
              le_mean =     -22.814973406280
             les_mean =     520.971482691697
             stat err =       0.000544921925
             autocorr =       1.361023011666
   target nu stat err =       0.000544921925
   target dn stat err =       0.002498855847
      target stat err =       0.002165398392
              std dev =       0.660566501406
             le_variance =       0.436348102780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436307937098
                                         uncertainty =       0.001862750732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436307937098
                                         uncertainty =       0.001862750732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467090735
  error estimate for blocks of size 2^( 2) =       0.000492735237
  error estimate for blocks of size 2^( 3) =       0.000516143306
  error estimate for blocks of size 2^( 4) =       0.000534239541
  error estimate for blocks of size 2^( 5) =       0.000544907276
  error estimate for blocks of size 2^( 6) =       0.000548495373
  error estimate for blocks of size 2^( 7) =       0.000552045179

      target function =      -0.746617055838
              le_mean =     -22.814973381936
             les_mean =     520.971484906154
             stat err =       0.000544921842
             autocorr =       1.361024450606
   target nu stat err =       0.000544921842
   target dn stat err =       0.002499075734
      target stat err =       0.002165558436
              std dev =       0.660566051839
             le_variance =       0.436347508843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436308230774
                                         uncertainty =       0.001862782148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436308230774
                                         uncertainty =       0.001862782148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467090893
  error estimate for blocks of size 2^( 2) =       0.000492735363
  error estimate for blocks of size 2^( 3) =       0.000516143366
  error estimate for blocks of size 2^( 4) =       0.000534239586
  error estimate for blocks of size 2^( 5) =       0.000544907291
  error estimate for blocks of size 2^( 6) =       0.000548495417
  error estimate for blocks of size 2^( 7) =       0.000552045239

      target function =      -0.746618609346
              le_mean =     -22.814973393905
             les_mean =     520.971483585316
             stat err =       0.000544921883
             autocorr =       1.361023733293
   target nu stat err =       0.000544921883
   target dn stat err =       0.002498960876
      target stat err =       0.002165475437
              std dev =       0.660566275538
             le_variance =       0.436347804379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436308490109
                                         uncertainty =       0.001862809717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436308490109
                                         uncertainty =       0.001862809717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467091033
  error estimate for blocks of size 2^( 2) =       0.000492735474
  error estimate for blocks of size 2^( 3) =       0.000516143420
  error estimate for blocks of size 2^( 4) =       0.000534239627
  error estimate for blocks of size 2^( 5) =       0.000544907305
  error estimate for blocks of size 2^( 6) =       0.000548495455
  error estimate for blocks of size 2^( 7) =       0.000552045293

      target function =      -0.746619688942
              le_mean =     -22.814973404712
             les_mean =     520.971482781049
             stat err =       0.000544921920
             autocorr =       1.361023102072
   target nu stat err =       0.000544921920
   target dn stat err =       0.002498868444
      target stat err =       0.002165407696
              std dev =       0.660566473067
             le_variance =       0.436348065340


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746619822860        initial  <--
     3.8147e+01     3.8147e+02             8.7628e-06        -0.746617055838
     1.5259e+02     1.5259e+03             2.1926e-06        -0.746618609346
     6.1035e+02     6.1035e+03             5.4827e-07        -0.746619688942

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4995
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.264985e-01 3 1  ON 0
ci_02                -2.871706e-02 3 1  ON 1
ci_03                -2.856570e-02 3 1  ON 2
ci_04                 2.661136e-02 3 1  ON 3
ci_05                -2.187488e-02 3 1  ON 4
ci_06                -2.154274e-02 3 1  ON 5
ci_07                 2.710057e-02 3 1  ON 6
ci_08                -5.456848e-03 3 1  ON 7
ci_09                -8.841526e-03 3 1  ON 8
ci_10                -8.366187e-03 3 1  ON 9
ci_11                 1.311121e-02 3 1  ON 10
ci_12                 6.948019e-03 3 1  ON 11
ci_13                 1.303855e-02 3 1  ON 12
ci_14                 1.252697e-02 3 1  ON 13
ci_15                 6.372959e-03 3 1  ON 14
ci_16                 6.262944e-03 3 1  ON 15
ci_17                -7.198083e-03 3 1  ON 16
ci_18                -6.024997e-03 3 1  ON 17
ci_19                 9.258677e-03 3 1  ON 18
ci_20                 6.518126e-03 3 1  ON 19
ci_21                 8.966562e-03 3 1  ON 20
ci_22                 8.289930e-03 3 1  ON 21
ci_23                 4.852348e-03 3 1  ON 22
ci_24                 4.086005e-03 3 1  ON 23
ci_25                 2.863583e-03 3 1  ON 24
ci_26                 3.084177e-03 3 1  ON 25
ci_27                 3.185101e-03 3 1  ON 26
ci_28                 1.755164e-03 3 1  ON 27
ci_29                 1.455475e-03 3 1  ON 28
ci_30                -1.778026e-03 3 1  ON 29
ci_31                -4.936923e-04 3 1  ON 30
ci_32                -9.475910e-04 3 1  ON 31
ci_33                -1.370406e-03 3 1  ON 32
ci_34                 1.097496e-03 3 1  ON 33
ci_35                 1.541483e-03 3 1  ON 34
ci_36                -1.076886e-03 3 1  ON 35
ci_37                -1.050172e-03 3 1  ON 36
ci_38                -6.339130e-04 3 1  ON 37
ci_39                -6.038931e-04 3 1  ON 38
ci_40                -1.528422e-03 3 1  ON 39
ci_41                -1.187812e-03 3 1  ON 40
ci_42                -1.175726e-03 3 1  ON 41
ci_43                -2.260116e-03 3 1  ON 42
ci_44                -2.994377e-03 3 1  ON 43
ci_45                -5.582973e-04 3 1  ON 44
ci_46                -7.370834e-04 3 1  ON 45
ci_47                 1.562129e-03 3 1  ON 46
ci_48                 1.419380e-03 3 1  ON 47
ci_49                -9.593423e-04 3 1  ON 48
ci_50                -7.631975e-04 3 1  ON 49
ci_51                 1.271518e-04 3 1  ON 50
ci_52                 1.811170e-04 3 1  ON 51
ci_53                -7.051596e-04 3 1  ON 52
ci_54                -1.079708e-03 3 1  ON 53
ci_55                -6.624206e-04 3 1  ON 54
ci_56                 2.501127e-03 3 1  ON 55
ci_57                 1.713492e-03 3 1  ON 56
ci_58                -1.157825e-03 3 1  ON 57
ci_59                -1.430348e-03 3 1  ON 58
ci_60                 1.751674e-04 3 1  ON 59
ci_61                -2.372302e-04 3 1  ON 60
ci_62                -5.528275e-04 3 1  ON 61
ci_63                -6.340546e-04 3 1  ON 62
ci_64                -3.464680e-04 3 1  ON 63
ci_65                 8.448105e-06 3 1  ON 64
ci_66                -6.620910e-04 3 1  ON 65
ci_67                -8.562908e-04 3 1  ON 66
ci_68                -1.184400e-03 3 1  ON 67
ci_69                 9.255996e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5229e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7512
    reference variance = 0.539839
====================================================
  Execution time = 2.5924e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5366e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5110e-01
  Total weights = 1.964292084e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436574197862
                                         uncertainty =       0.001864123926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436574197862
                                         uncertainty =       0.001864123926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467255796
  error estimate for blocks of size 2^( 2) =       0.000492682677
  error estimate for blocks of size 2^( 3) =       0.000516582133
  error estimate for blocks of size 2^( 4) =       0.000535148866
  error estimate for blocks of size 2^( 5) =       0.000547074352
  error estimate for blocks of size 2^( 6) =       0.000554818846
  error estimate for blocks of size 2^( 7) =       0.000557328558

      target function =      -0.744437268748
              le_mean =     -22.814576210978
             les_mean =     520.955990544755
             stat err =       0.000548592656
             autocorr =       1.378448622644
   target nu stat err =       0.000548592656
   target dn stat err =       0.002677074341
      target stat err =       0.002294782568
              std dev =       0.660799484065
             le_variance =       0.436655958140


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281457621098e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744443338357       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744443368040       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744443374901       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744443376344       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744443376294       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744443376382       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744443376247       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744443376231       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744443376235       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744443376228       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 5.776111e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744443338357       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744443345778       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744443347494       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744443347855       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744443347842       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744443347864       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744443347830       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744443347826       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744443347823       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744443347827       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 1.444101e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744443338357       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744443340212       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744443340641       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744443340732       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744443340728       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744443340724       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744443340725       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744443340724       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744443340730       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744443340724       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 3.610298e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082308 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0937e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.264984e-01 3 1  ON 0
ci_02                -2.871705e-02 3 1  ON 1
ci_03                -2.856568e-02 3 1  ON 2
ci_04                 2.661132e-02 3 1  ON 3
ci_05                -2.187481e-02 3 1  ON 4
ci_06                -2.154268e-02 3 1  ON 5
ci_07                 2.710060e-02 3 1  ON 6
ci_08                -5.456813e-03 3 1  ON 7
ci_09                -8.841508e-03 3 1  ON 8
ci_10                -8.366177e-03 3 1  ON 9
ci_11                 1.311122e-02 3 1  ON 10
ci_12                 6.948012e-03 3 1  ON 11
ci_13                 1.303850e-02 3 1  ON 12
ci_14                 1.252696e-02 3 1  ON 13
ci_15                 6.372964e-03 3 1  ON 14
ci_16                 6.263004e-03 3 1  ON 15
ci_17                -7.198024e-03 3 1  ON 16
ci_18                -6.024990e-03 3 1  ON 17
ci_19                 9.258677e-03 3 1  ON 18
ci_20                 6.518142e-03 3 1  ON 19
ci_21                 8.966553e-03 3 1  ON 20
ci_22                 8.289928e-03 3 1  ON 21
ci_23                 4.852348e-03 3 1  ON 22
ci_24                 4.085961e-03 3 1  ON 23
ci_25                 2.863592e-03 3 1  ON 24
ci_26                 3.084246e-03 3 1  ON 25
ci_27                 3.185082e-03 3 1  ON 26
ci_28                 1.755167e-03 3 1  ON 27
ci_29                 1.455476e-03 3 1  ON 28
ci_30                -1.778007e-03 3 1  ON 29
ci_31                -4.938163e-04 3 1  ON 30
ci_32                -9.475693e-04 3 1  ON 31
ci_33                -1.370424e-03 3 1  ON 32
ci_34                 1.097512e-03 3 1  ON 33
ci_35                 1.541515e-03 3 1  ON 34
ci_36                -1.076870e-03 3 1  ON 35
ci_37                -1.050171e-03 3 1  ON 36
ci_38                -6.338872e-04 3 1  ON 37
ci_39                -6.038887e-04 3 1  ON 38
ci_40                -1.528389e-03 3 1  ON 39
ci_41                -1.187786e-03 3 1  ON 40
ci_42                -1.175751e-03 3 1  ON 41
ci_43                -2.260138e-03 3 1  ON 42
ci_44                -2.994379e-03 3 1  ON 43
ci_45                -5.583019e-04 3 1  ON 44
ci_46                -7.370984e-04 3 1  ON 45
ci_47                 1.562094e-03 3 1  ON 46
ci_48                 1.419368e-03 3 1  ON 47
ci_49                -9.593514e-04 3 1  ON 48
ci_50                -7.631901e-04 3 1  ON 49
ci_51                 1.271352e-04 3 1  ON 50
ci_52                 1.811024e-04 3 1  ON 51
ci_53                -7.051534e-04 3 1  ON 52
ci_54                -1.079719e-03 3 1  ON 53
ci_55                -6.624231e-04 3 1  ON 54
ci_56                 2.501118e-03 3 1  ON 55
ci_57                 1.713515e-03 3 1  ON 56
ci_58                -1.157809e-03 3 1  ON 57
ci_59                -1.430348e-03 3 1  ON 58
ci_60                 1.751058e-04 3 1  ON 59
ci_61                -2.372106e-04 3 1  ON 60
ci_62                -5.527991e-04 3 1  ON 61
ci_63                -6.340481e-04 3 1  ON 62
ci_64                -3.464655e-04 3 1  ON 63
ci_65                 8.443473e-06 3 1  ON 64
ci_66                -6.621124e-04 3 1  ON 65
ci_67                -8.562459e-04 3 1  ON 66
ci_68                -1.184367e-03 3 1  ON 67
ci_69                 9.250168e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.8688
    reference variance = 0.546618
====================================================
  Execution time = 2.5215e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4576e-01
  Total weights = 1.9640e+06
  Execution time = 3.4963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432377213647
                                         uncertainty =       0.002182742908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432377213647
                                         uncertainty =       0.002182742908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464959024
  error estimate for blocks of size 2^( 2) =       0.000490191107
  error estimate for blocks of size 2^( 3) =       0.000514018287
  error estimate for blocks of size 2^( 4) =       0.000531819567
  error estimate for blocks of size 2^( 5) =       0.000542894944
  error estimate for blocks of size 2^( 6) =       0.000550021368
  error estimate for blocks of size 2^( 7) =       0.000550078102

      target function =      -0.748881961713
              le_mean =     -22.815081707712
             les_mean =     520.973712055474
             stat err =       0.000543703495
             autocorr =       1.367397835710
   target nu stat err =       0.000543703495
   target dn stat err =       0.002784560597
      target stat err =       0.002408558599
              std dev =       0.657551357436
             le_variance =       0.432373787665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432377165121
                                         uncertainty =       0.002182740150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432377165121
                                         uncertainty =       0.002182740150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464958997
  error estimate for blocks of size 2^( 2) =       0.000490191098
  error estimate for blocks of size 2^( 3) =       0.000514018298
  error estimate for blocks of size 2^( 4) =       0.000531819592
  error estimate for blocks of size 2^( 5) =       0.000542894983
  error estimate for blocks of size 2^( 6) =       0.000550021408
  error estimate for blocks of size 2^( 7) =       0.000550078145

      target function =      -0.748882739124
              le_mean =     -22.815081710624
             les_mean =     520.973711260219
             stat err =       0.000543703532
             autocorr =       1.367398175525
   target nu stat err =       0.000543703532
   target dn stat err =       0.002784450806
      target stat err =       0.002408474538
              std dev =       0.657551320193
             le_variance =       0.432373738688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432377189379
                                         uncertainty =       0.002182741529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432377189379
                                         uncertainty =       0.002182741529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464959011
  error estimate for blocks of size 2^( 2) =       0.000490191103
  error estimate for blocks of size 2^( 3) =       0.000514018293
  error estimate for blocks of size 2^( 4) =       0.000531819580
  error estimate for blocks of size 2^( 5) =       0.000542894963
  error estimate for blocks of size 2^( 6) =       0.000550021388
  error estimate for blocks of size 2^( 7) =       0.000550078124

      target function =      -0.748882350876
              le_mean =     -22.815081709168
             les_mean =     520.973711657277
             stat err =       0.000543703514
             autocorr =       1.367398005625
   target nu stat err =       0.000543703514
   target dn stat err =       0.002784505653
      target stat err =       0.002408516532
              std dev =       0.657551338811
             le_variance =       0.432373763172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432377210613
                                         uncertainty =       0.002182742736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432377210613
                                         uncertainty =       0.002182742736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464959022
  error estimate for blocks of size 2^( 2) =       0.000490191107
  error estimate for blocks of size 2^( 3) =       0.000514018288
  error estimate for blocks of size 2^( 4) =       0.000531819569
  error estimate for blocks of size 2^( 5) =       0.000542894946
  error estimate for blocks of size 2^( 6) =       0.000550021370
  error estimate for blocks of size 2^( 7) =       0.000550078105

      target function =      -0.748882010407
              le_mean =     -22.815081707894
             les_mean =     520.973712005639
             stat err =       0.000543703498
             autocorr =       1.367397856949
   target nu stat err =       0.000543703498
   target dn stat err =       0.002784553724
      target stat err =       0.002408553337
              std dev =       0.657551355107
             le_variance =       0.432373784603


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748881961713        initial
     3.8147e+02     3.8147e+03             5.7761e-07        -0.748882739124  <--
     1.5259e+03     1.5259e+04             1.4441e-07        -0.748882350876
     6.1035e+03     6.1035e+04             3.6103e-08        -0.748882010407

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 4.2724e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.264979e-01 3 1  ON 0
ci_02                -2.871700e-02 3 1  ON 1
ci_03                -2.856563e-02 3 1  ON 2
ci_04                 2.661119e-02 3 1  ON 3
ci_05                -2.187459e-02 3 1  ON 4
ci_06                -2.154247e-02 3 1  ON 5
ci_07                 2.710070e-02 3 1  ON 6
ci_08                -5.456707e-03 3 1  ON 7
ci_09                -8.841452e-03 3 1  ON 8
ci_10                -8.366147e-03 3 1  ON 9
ci_11                 1.311124e-02 3 1  ON 10
ci_12                 6.947989e-03 3 1  ON 11
ci_13                 1.303837e-02 3 1  ON 12
ci_14                 1.252695e-02 3 1  ON 13
ci_15                 6.372979e-03 3 1  ON 14
ci_16                 6.263184e-03 3 1  ON 15
ci_17                -7.197848e-03 3 1  ON 16
ci_18                -6.024966e-03 3 1  ON 17
ci_19                 9.258678e-03 3 1  ON 18
ci_20                 6.518188e-03 3 1  ON 19
ci_21                 8.966526e-03 3 1  ON 20
ci_22                 8.289920e-03 3 1  ON 21
ci_23                 4.852345e-03 3 1  ON 22
ci_24                 4.085829e-03 3 1  ON 23
ci_25                 2.863620e-03 3 1  ON 24
ci_26                 3.084450e-03 3 1  ON 25
ci_27                 3.185026e-03 3 1  ON 26
ci_28                 1.755174e-03 3 1  ON 27
ci_29                 1.455480e-03 3 1  ON 28
ci_30                -1.777952e-03 3 1  ON 29
ci_31                -4.941883e-04 3 1  ON 30
ci_32                -9.475041e-04 3 1  ON 31
ci_33                -1.370476e-03 3 1  ON 32
ci_34                 1.097561e-03 3 1  ON 33
ci_35                 1.541611e-03 3 1  ON 34
ci_36                -1.076821e-03 3 1  ON 35
ci_37                -1.050168e-03 3 1  ON 36
ci_38                -6.338098e-04 3 1  ON 37
ci_39                -6.038758e-04 3 1  ON 38
ci_40                -1.528293e-03 3 1  ON 39
ci_41                -1.187706e-03 3 1  ON 40
ci_42                -1.175826e-03 3 1  ON 41
ci_43                -2.260207e-03 3 1  ON 42
ci_44                -2.994385e-03 3 1  ON 43
ci_45                -5.583156e-04 3 1  ON 44
ci_46                -7.371437e-04 3 1  ON 45
ci_47                 1.561991e-03 3 1  ON 46
ci_48                 1.419330e-03 3 1  ON 47
ci_49                -9.593786e-04 3 1  ON 48
ci_50                -7.631681e-04 3 1  ON 49
ci_51                 1.270855e-04 3 1  ON 50
ci_52                 1.810586e-04 3 1  ON 51
ci_53                -7.051350e-04 3 1  ON 52
ci_54                -1.079754e-03 3 1  ON 53
ci_55                -6.624306e-04 3 1  ON 54
ci_56                 2.501091e-03 3 1  ON 55
ci_57                 1.713584e-03 3 1  ON 56
ci_58                -1.157760e-03 3 1  ON 57
ci_59                -1.430348e-03 3 1  ON 58
ci_60                 1.749210e-04 3 1  ON 59
ci_61                -2.371518e-04 3 1  ON 60
ci_62                -5.527138e-04 3 1  ON 61
ci_63                -6.340285e-04 3 1  ON 62
ci_64                -3.464580e-04 3 1  ON 63
ci_65                 8.429578e-06 3 1  ON 64
ci_66                -6.621766e-04 3 1  ON 65
ci_67                -8.561114e-04 3 1  ON 66
ci_68                -1.184268e-03 3 1  ON 67
ci_69                 9.232687e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3670e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8285
    reference variance = 0.359875
====================================================
  Execution time = 8.3470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4463e-01
  Total weights = 1.964309535e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433008494592
                                         uncertainty =       0.002595405844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433008494592
                                         uncertainty =       0.002595405844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465269298
  error estimate for blocks of size 2^( 2) =       0.000490488333
  error estimate for blocks of size 2^( 3) =       0.000514073467
  error estimate for blocks of size 2^( 4) =       0.000531965887
  error estimate for blocks of size 2^( 5) =       0.000543217925
  error estimate for blocks of size 2^( 6) =       0.000549951359
  error estimate for blocks of size 2^( 7) =       0.000551448513

      target function =      -0.749818511619
              le_mean =     -22.813720866391
             les_mean =     520.910489733281
             stat err =       0.000544145921
             autocorr =       1.367798001115
   target nu stat err =       0.000544145921
   target dn stat err =       0.002871956879
      target stat err =       0.002480514477
              std dev =       0.657990151704
             le_variance =       0.432951039739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281372086639e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749825700386       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749825804338       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749825818301       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749825820664       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749825820416       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749825820132       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749825820116       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749825820068       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749825820010       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 1.409316e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749825700386       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749825726384       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749825729876       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749825730467       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749825730404       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749825730334       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749825730330       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749825730318       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749825730304       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 3.523938e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749825700386       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749825706886       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749825707759       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749825707906       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749825707892       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749825707871       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749825707873       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749825707869       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749825707863       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 8.810252e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085396 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 8.7964e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.264976e-01 3 1  ON 0
ci_02                -2.871690e-02 3 1  ON 1
ci_03                -2.856550e-02 3 1  ON 2
ci_04                 2.661102e-02 3 1  ON 3
ci_05                -2.187473e-02 3 1  ON 4
ci_06                -2.154232e-02 3 1  ON 5
ci_07                 2.710060e-02 3 1  ON 6
ci_08                -5.456554e-03 3 1  ON 7
ci_09                -8.841273e-03 3 1  ON 8
ci_10                -8.366300e-03 3 1  ON 9
ci_11                 1.311119e-02 3 1  ON 10
ci_12                 6.948025e-03 3 1  ON 11
ci_13                 1.303836e-02 3 1  ON 12
ci_14                 1.252702e-02 3 1  ON 13
ci_15                 6.372899e-03 3 1  ON 14
ci_16                 6.263128e-03 3 1  ON 15
ci_17                -7.197752e-03 3 1  ON 16
ci_18                -6.025031e-03 3 1  ON 17
ci_19                 9.258532e-03 3 1  ON 18
ci_20                 6.517944e-03 3 1  ON 19
ci_21                 8.966515e-03 3 1  ON 20
ci_22                 8.289879e-03 3 1  ON 21
ci_23                 4.852459e-03 3 1  ON 22
ci_24                 4.085750e-03 3 1  ON 23
ci_25                 2.863500e-03 3 1  ON 24
ci_26                 3.084294e-03 3 1  ON 25
ci_27                 3.185067e-03 3 1  ON 26
ci_28                 1.755118e-03 3 1  ON 27
ci_29                 1.455363e-03 3 1  ON 28
ci_30                -1.777922e-03 3 1  ON 29
ci_31                -4.943197e-04 3 1  ON 30
ci_32                -9.476276e-04 3 1  ON 31
ci_33                -1.370505e-03 3 1  ON 32
ci_34                 1.097432e-03 3 1  ON 33
ci_35                 1.541528e-03 3 1  ON 34
ci_36                -1.076796e-03 3 1  ON 35
ci_37                -1.050161e-03 3 1  ON 36
ci_38                -6.338147e-04 3 1  ON 37
ci_39                -6.038655e-04 3 1  ON 38
ci_40                -1.528338e-03 3 1  ON 39
ci_41                -1.187776e-03 3 1  ON 40
ci_42                -1.175730e-03 3 1  ON 41
ci_43                -2.260237e-03 3 1  ON 42
ci_44                -2.994269e-03 3 1  ON 43
ci_45                -5.584604e-04 3 1  ON 44
ci_46                -7.371303e-04 3 1  ON 45
ci_47                 1.562127e-03 3 1  ON 46
ci_48                 1.419366e-03 3 1  ON 47
ci_49                -9.592950e-04 3 1  ON 48
ci_50                -7.631140e-04 3 1  ON 49
ci_51                 1.271135e-04 3 1  ON 50
ci_52                 1.810260e-04 3 1  ON 51
ci_53                -7.052379e-04 3 1  ON 52
ci_54                -1.079609e-03 3 1  ON 53
ci_55                -6.624039e-04 3 1  ON 54
ci_56                 2.501115e-03 3 1  ON 55
ci_57                 1.713707e-03 3 1  ON 56
ci_58                -1.157790e-03 3 1  ON 57
ci_59                -1.430191e-03 3 1  ON 58
ci_60                 1.747526e-04 3 1  ON 59
ci_61                -2.370887e-04 3 1  ON 60
ci_62                -5.526551e-04 3 1  ON 61
ci_63                -6.339762e-04 3 1  ON 62
ci_64                -3.463684e-04 3 1  ON 63
ci_65                 8.469004e-06 3 1  ON 64
ci_66                -6.620145e-04 3 1  ON 65
ci_67                -8.559980e-04 3 1  ON 66
ci_68                -1.184233e-03 3 1  ON 67
ci_69                 9.218993e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8163
    reference variance = 0.398734
====================================================
  Execution time = 2.7144e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4375e-01
  Total weights = 1.9645e+06
  Execution time = 3.4848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431352237093
                                         uncertainty =       0.001786948469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431352237093
                                         uncertainty =       0.001786948469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464415675
  error estimate for blocks of size 2^( 2) =       0.000489856470
  error estimate for blocks of size 2^( 3) =       0.000513673301
  error estimate for blocks of size 2^( 4) =       0.000532377975
  error estimate for blocks of size 2^( 5) =       0.000544383364
  error estimate for blocks of size 2^( 6) =       0.000550782608
  error estimate for blocks of size 2^( 7) =       0.000552697260

      target function =      -0.750569474814
              le_mean =     -22.815240166996
             les_mean =     520.978933908013
             stat err =       0.000545060302
             autocorr =       1.377448482010
   target nu stat err =       0.000545060302
   target dn stat err =       0.002469686404
      target stat err =       0.002164835198
              std dev =       0.656782946749
             le_variance =       0.431363839141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431352194954
                                         uncertainty =       0.001786957320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431352194954
                                         uncertainty =       0.001786957320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464415652
  error estimate for blocks of size 2^( 2) =       0.000489856491
  error estimate for blocks of size 2^( 3) =       0.000513673377
  error estimate for blocks of size 2^( 4) =       0.000532378103
  error estimate for blocks of size 2^( 5) =       0.000544383520
  error estimate for blocks of size 2^( 6) =       0.000550782798
  error estimate for blocks of size 2^( 7) =       0.000552697505

      target function =      -0.750565073505
              le_mean =     -22.815240171320
             les_mean =     520.978939333940
             stat err =       0.000545060481
             autocorr =       1.377449527438
   target nu stat err =       0.000545060481
   target dn stat err =       0.002470620645
      target stat err =       0.002165564655
              std dev =       0.656782913881
             le_variance =       0.431363795967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431352215978
                                         uncertainty =       0.001786952895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431352215978
                                         uncertainty =       0.001786952895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464415664
  error estimate for blocks of size 2^( 2) =       0.000489856480
  error estimate for blocks of size 2^( 3) =       0.000513673339
  error estimate for blocks of size 2^( 4) =       0.000532378039
  error estimate for blocks of size 2^( 5) =       0.000544383442
  error estimate for blocks of size 2^( 6) =       0.000550782703
  error estimate for blocks of size 2^( 7) =       0.000552697383

      target function =      -0.750567281431
              le_mean =     -22.815240169154
             les_mean =     520.978936612172
             stat err =       0.000545060392
             autocorr =       1.377449004921
   target nu stat err =       0.000545060392
   target dn stat err =       0.002470152129
      target stat err =       0.002165198840
              std dev =       0.656782930281
             le_variance =       0.431363817508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431352234449
                                         uncertainty =       0.001786949022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431352234449
                                         uncertainty =       0.001786949022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464415674
  error estimate for blocks of size 2^( 2) =       0.000489856471
  error estimate for blocks of size 2^( 3) =       0.000513673305
  error estimate for blocks of size 2^( 4) =       0.000532377983
  error estimate for blocks of size 2^( 5) =       0.000544383374
  error estimate for blocks of size 2^( 6) =       0.000550782620
  error estimate for blocks of size 2^( 7) =       0.000552697275

      target function =      -0.750569201504
              le_mean =     -22.815240167265
             les_mean =     520.978934244986
             stat err =       0.000545060313
             autocorr =       1.377448547377
   target nu stat err =       0.000545060313
   target dn stat err =       0.002469744454
      target stat err =       0.002164880524
              std dev =       0.656782944687
             le_variance =       0.431363836432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750569474814        initial  <--
     9.5367e+01     9.5367e+02             1.4093e-06        -0.750565073505
     3.8147e+02     3.8147e+03             3.5239e-07        -0.750567281431
     1.5259e+03     1.5259e+04             8.8103e-08        -0.750569201504

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6001
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.264979e-01 3 1  ON 0
ci_02                -2.871700e-02 3 1  ON 1
ci_03                -2.856563e-02 3 1  ON 2
ci_04                 2.661119e-02 3 1  ON 3
ci_05                -2.187459e-02 3 1  ON 4
ci_06                -2.154247e-02 3 1  ON 5
ci_07                 2.710070e-02 3 1  ON 6
ci_08                -5.456707e-03 3 1  ON 7
ci_09                -8.841452e-03 3 1  ON 8
ci_10                -8.366147e-03 3 1  ON 9
ci_11                 1.311124e-02 3 1  ON 10
ci_12                 6.947989e-03 3 1  ON 11
ci_13                 1.303837e-02 3 1  ON 12
ci_14                 1.252695e-02 3 1  ON 13
ci_15                 6.372979e-03 3 1  ON 14
ci_16                 6.263184e-03 3 1  ON 15
ci_17                -7.197848e-03 3 1  ON 16
ci_18                -6.024966e-03 3 1  ON 17
ci_19                 9.258678e-03 3 1  ON 18
ci_20                 6.518188e-03 3 1  ON 19
ci_21                 8.966526e-03 3 1  ON 20
ci_22                 8.289920e-03 3 1  ON 21
ci_23                 4.852345e-03 3 1  ON 22
ci_24                 4.085829e-03 3 1  ON 23
ci_25                 2.863620e-03 3 1  ON 24
ci_26                 3.084450e-03 3 1  ON 25
ci_27                 3.185026e-03 3 1  ON 26
ci_28                 1.755174e-03 3 1  ON 27
ci_29                 1.455480e-03 3 1  ON 28
ci_30                -1.777952e-03 3 1  ON 29
ci_31                -4.941883e-04 3 1  ON 30
ci_32                -9.475041e-04 3 1  ON 31
ci_33                -1.370476e-03 3 1  ON 32
ci_34                 1.097561e-03 3 1  ON 33
ci_35                 1.541611e-03 3 1  ON 34
ci_36                -1.076821e-03 3 1  ON 35
ci_37                -1.050168e-03 3 1  ON 36
ci_38                -6.338098e-04 3 1  ON 37
ci_39                -6.038758e-04 3 1  ON 38
ci_40                -1.528293e-03 3 1  ON 39
ci_41                -1.187706e-03 3 1  ON 40
ci_42                -1.175826e-03 3 1  ON 41
ci_43                -2.260207e-03 3 1  ON 42
ci_44                -2.994385e-03 3 1  ON 43
ci_45                -5.583156e-04 3 1  ON 44
ci_46                -7.371437e-04 3 1  ON 45
ci_47                 1.561991e-03 3 1  ON 46
ci_48                 1.419330e-03 3 1  ON 47
ci_49                -9.593786e-04 3 1  ON 48
ci_50                -7.631681e-04 3 1  ON 49
ci_51                 1.270855e-04 3 1  ON 50
ci_52                 1.810586e-04 3 1  ON 51
ci_53                -7.051350e-04 3 1  ON 52
ci_54                -1.079754e-03 3 1  ON 53
ci_55                -6.624306e-04 3 1  ON 54
ci_56                 2.501091e-03 3 1  ON 55
ci_57                 1.713584e-03 3 1  ON 56
ci_58                -1.157760e-03 3 1  ON 57
ci_59                -1.430348e-03 3 1  ON 58
ci_60                 1.749210e-04 3 1  ON 59
ci_61                -2.371518e-04 3 1  ON 60
ci_62                -5.527138e-04 3 1  ON 61
ci_63                -6.340285e-04 3 1  ON 62
ci_64                -3.464580e-04 3 1  ON 63
ci_65                 8.429578e-06 3 1  ON 64
ci_66                -6.621766e-04 3 1  ON 65
ci_67                -8.561114e-04 3 1  ON 66
ci_68                -1.184268e-03 3 1  ON 67
ci_69                 9.232687e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4067e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8151
    reference variance = 0.441993
====================================================
  Execution time = 2.5773e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4554e-01
  Total weights = 1.964142294e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5070e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433651068473
                                         uncertainty =       0.001947764832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433651068473
                                         uncertainty =       0.001947764832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465612794
  error estimate for blocks of size 2^( 2) =       0.000491336094
  error estimate for blocks of size 2^( 3) =       0.000515018773
  error estimate for blocks of size 2^( 4) =       0.000532716020
  error estimate for blocks of size 2^( 5) =       0.000543113056
  error estimate for blocks of size 2^( 6) =       0.000548957702
  error estimate for blocks of size 2^( 7) =       0.000552419322

      target function =      -0.749066574857
              le_mean =     -22.814977384256
             les_mean =     520.968730944079
             stat err =       0.000544301525
             autocorr =       1.366561847579
   target nu stat err =       0.000544301525
   target dn stat err =       0.002739811667
      target stat err =       0.002373267359
              std dev =       0.658475928142
             le_variance =       0.433590547943


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281497738426e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749073098671       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749073107848       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749073109665       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749073109904       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749073109968       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749073109992       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749073109992       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749073109999       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749073109998       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+02 is 1.039336e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749073098671       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749073100965       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749073101419       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749073101479       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749073101486       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749073101499       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749073101504       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749073101507       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749073101506       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+03 is 2.598428e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749073098671       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749073099244       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749073099358       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749073099373       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749073099344       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749073099379       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749073099364       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749073099394       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749073099394       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+04 is 6.496124e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088474 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0289e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.264979e-01 3 1  ON 0
ci_02                -2.871700e-02 3 1  ON 1
ci_03                -2.856563e-02 3 1  ON 2
ci_04                 2.661118e-02 3 1  ON 3
ci_05                -2.187456e-02 3 1  ON 4
ci_06                -2.154245e-02 3 1  ON 5
ci_07                 2.710069e-02 3 1  ON 6
ci_08                -5.456695e-03 3 1  ON 7
ci_09                -8.841428e-03 3 1  ON 8
ci_10                -8.366149e-03 3 1  ON 9
ci_11                 1.311123e-02 3 1  ON 10
ci_12                 6.947976e-03 3 1  ON 11
ci_13                 1.303837e-02 3 1  ON 12
ci_14                 1.252696e-02 3 1  ON 13
ci_15                 6.372970e-03 3 1  ON 14
ci_16                 6.263198e-03 3 1  ON 15
ci_17                -7.197834e-03 3 1  ON 16
ci_18                -6.024947e-03 3 1  ON 17
ci_19                 9.258687e-03 3 1  ON 18
ci_20                 6.518178e-03 3 1  ON 19
ci_21                 8.966517e-03 3 1  ON 20
ci_22                 8.289936e-03 3 1  ON 21
ci_23                 4.852331e-03 3 1  ON 22
ci_24                 4.085838e-03 3 1  ON 23
ci_25                 2.863623e-03 3 1  ON 24
ci_26                 3.084448e-03 3 1  ON 25
ci_27                 3.185033e-03 3 1  ON 26
ci_28                 1.755168e-03 3 1  ON 27
ci_29                 1.455475e-03 3 1  ON 28
ci_30                -1.777952e-03 3 1  ON 29
ci_31                -4.941868e-04 3 1  ON 30
ci_32                -9.474959e-04 3 1  ON 31
ci_33                -1.370460e-03 3 1  ON 32
ci_34                 1.097556e-03 3 1  ON 33
ci_35                 1.541621e-03 3 1  ON 34
ci_36                -1.076823e-03 3 1  ON 35
ci_37                -1.050160e-03 3 1  ON 36
ci_38                -6.338104e-04 3 1  ON 37
ci_39                -6.038716e-04 3 1  ON 38
ci_40                -1.528293e-03 3 1  ON 39
ci_41                -1.187700e-03 3 1  ON 40
ci_42                -1.175820e-03 3 1  ON 41
ci_43                -2.260218e-03 3 1  ON 42
ci_44                -2.994380e-03 3 1  ON 43
ci_45                -5.583190e-04 3 1  ON 44
ci_46                -7.371365e-04 3 1  ON 45
ci_47                 1.561997e-03 3 1  ON 46
ci_48                 1.419327e-03 3 1  ON 47
ci_49                -9.593803e-04 3 1  ON 48
ci_50                -7.631723e-04 3 1  ON 49
ci_51                 1.270901e-04 3 1  ON 50
ci_52                 1.810549e-04 3 1  ON 51
ci_53                -7.051368e-04 3 1  ON 52
ci_54                -1.079752e-03 3 1  ON 53
ci_55                -6.624300e-04 3 1  ON 54
ci_56                 2.501079e-03 3 1  ON 55
ci_57                 1.713593e-03 3 1  ON 56
ci_58                -1.157765e-03 3 1  ON 57
ci_59                -1.430352e-03 3 1  ON 58
ci_60                 1.749107e-04 3 1  ON 59
ci_61                -2.371429e-04 3 1  ON 60
ci_62                -5.527123e-04 3 1  ON 61
ci_63                -6.340257e-04 3 1  ON 62
ci_64                -3.464578e-04 3 1  ON 63
ci_65                 8.429910e-06 3 1  ON 64
ci_66                -6.621867e-04 3 1  ON 65
ci_67                -8.561112e-04 3 1  ON 66
ci_68                -1.184261e-03 3 1  ON 67
ci_69                 9.230110e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7934
    reference variance = 0.326624
====================================================
  Execution time = 2.5200e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4546e-01
  Total weights = 1.9642e+06
  Execution time = 3.4983e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434166209135
                                         uncertainty =       0.002625982723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434166209135
                                         uncertainty =       0.002625982723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465899204
  error estimate for blocks of size 2^( 2) =       0.000491424734
  error estimate for blocks of size 2^( 3) =       0.000515789404
  error estimate for blocks of size 2^( 4) =       0.000533161518
  error estimate for blocks of size 2^( 5) =       0.000544041628
  error estimate for blocks of size 2^( 6) =       0.000550606150
  error estimate for blocks of size 2^( 7) =       0.000551939993

      target function =      -0.749121244629
              le_mean =     -22.814068863466
             les_mean =     520.927200425837
             stat err =       0.000544937322
             autocorr =       1.368072680553
   target nu stat err =       0.000544937322
   target dn stat err =       0.003410499268
      target stat err =       0.002916225993
              std dev =       0.658880972527
             le_variance =       0.434124135958

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434166217533
                                         uncertainty =       0.002625988720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434166217533
                                         uncertainty =       0.002625988720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465899208
  error estimate for blocks of size 2^( 2) =       0.000491424743
  error estimate for blocks of size 2^( 3) =       0.000515789418
  error estimate for blocks of size 2^( 4) =       0.000533161536
  error estimate for blocks of size 2^( 5) =       0.000544041648
  error estimate for blocks of size 2^( 6) =       0.000550606170
  error estimate for blocks of size 2^( 7) =       0.000551940015

      target function =      -0.749121263552
              le_mean =     -22.814068862849
             les_mean =     520.927200375094
             stat err =       0.000544937342
             autocorr =       1.368072752573
   target nu stat err =       0.000544937342
   target dn stat err =       0.003410493381
      target stat err =       0.002916221324
              std dev =       0.658880978895
             le_variance =       0.434124144349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434166213334
                                         uncertainty =       0.002625985722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434166213334
                                         uncertainty =       0.002625985722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465899206
  error estimate for blocks of size 2^( 2) =       0.000491424739
  error estimate for blocks of size 2^( 3) =       0.000515789411
  error estimate for blocks of size 2^( 4) =       0.000533161527
  error estimate for blocks of size 2^( 5) =       0.000544041638
  error estimate for blocks of size 2^( 6) =       0.000550606160
  error estimate for blocks of size 2^( 7) =       0.000551940004

      target function =      -0.749121254176
              le_mean =     -22.814068863157
             les_mean =     520.927200400361
             stat err =       0.000544937332
             autocorr =       1.368072716571
   target nu stat err =       0.000544937332
   target dn stat err =       0.003410496323
      target stat err =       0.002916223658
              std dev =       0.658880975710
             le_variance =       0.434124140153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434166209660
                                         uncertainty =       0.002625983098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434166209660
                                         uncertainty =       0.002625983098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465899204
  error estimate for blocks of size 2^( 2) =       0.000491424735
  error estimate for blocks of size 2^( 3) =       0.000515789405
  error estimate for blocks of size 2^( 4) =       0.000533161519
  error estimate for blocks of size 2^( 5) =       0.000544041630
  error estimate for blocks of size 2^( 6) =       0.000550606151
  error estimate for blocks of size 2^( 7) =       0.000551939995

      target function =      -0.749121245832
              le_mean =     -22.814068863427
             les_mean =     520.927200422641
             stat err =       0.000544937323
             autocorr =       1.368072685064
   target nu stat err =       0.000544937323
   target dn stat err =       0.003410498899
      target stat err =       0.002916225701
              std dev =       0.658880972924
             le_variance =       0.434124136482


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749121244629        initial
     9.5367e+02     9.5367e+03             1.0393e-07        -0.749121263552  <--
     3.8147e+03     3.8147e+04             2.5984e-08        -0.749121254176
     1.5259e+04     1.5259e+05             6.4961e-09        -0.749121245832

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 4.2721e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.264978e-01 3 1  ON 0
ci_02                -2.871697e-02 3 1  ON 1
ci_03                -2.856566e-02 3 1  ON 2
ci_04                 2.661113e-02 3 1  ON 3
ci_05                -2.187448e-02 3 1  ON 4
ci_06                -2.154239e-02 3 1  ON 5
ci_07                 2.710065e-02 3 1  ON 6
ci_08                -5.456661e-03 3 1  ON 7
ci_09                -8.841356e-03 3 1  ON 8
ci_10                -8.366154e-03 3 1  ON 9
ci_11                 1.311121e-02 3 1  ON 10
ci_12                 6.947938e-03 3 1  ON 11
ci_13                 1.303837e-02 3 1  ON 12
ci_14                 1.252697e-02 3 1  ON 13
ci_15                 6.372944e-03 3 1  ON 14
ci_16                 6.263238e-03 3 1  ON 15
ci_17                -7.197791e-03 3 1  ON 16
ci_18                -6.024891e-03 3 1  ON 17
ci_19                 9.258714e-03 3 1  ON 18
ci_20                 6.518146e-03 3 1  ON 19
ci_21                 8.966492e-03 3 1  ON 20
ci_22                 8.289985e-03 3 1  ON 21
ci_23                 4.852288e-03 3 1  ON 22
ci_24                 4.085863e-03 3 1  ON 23
ci_25                 2.863631e-03 3 1  ON 24
ci_26                 3.084439e-03 3 1  ON 25
ci_27                 3.185055e-03 3 1  ON 26
ci_28                 1.755150e-03 3 1  ON 27
ci_29                 1.455459e-03 3 1  ON 28
ci_30                -1.777952e-03 3 1  ON 29
ci_31                -4.941821e-04 3 1  ON 30
ci_32                -9.474711e-04 3 1  ON 31
ci_33                -1.370413e-03 3 1  ON 32
ci_34                 1.097541e-03 3 1  ON 33
ci_35                 1.541653e-03 3 1  ON 34
ci_36                -1.076829e-03 3 1  ON 35
ci_37                -1.050139e-03 3 1  ON 36
ci_38                -6.338122e-04 3 1  ON 37
ci_39                -6.038591e-04 3 1  ON 38
ci_40                -1.528295e-03 3 1  ON 39
ci_41                -1.187683e-03 3 1  ON 40
ci_42                -1.175803e-03 3 1  ON 41
ci_43                -2.260254e-03 3 1  ON 42
ci_44                -2.994366e-03 3 1  ON 43
ci_45                -5.583291e-04 3 1  ON 44
ci_46                -7.371149e-04 3 1  ON 45
ci_47                 1.562014e-03 3 1  ON 46
ci_48                 1.419319e-03 3 1  ON 47
ci_49                -9.593854e-04 3 1  ON 48
ci_50                -7.631848e-04 3 1  ON 49
ci_51                 1.271042e-04 3 1  ON 50
ci_52                 1.810436e-04 3 1  ON 51
ci_53                -7.051423e-04 3 1  ON 52
ci_54                -1.079747e-03 3 1  ON 53
ci_55                -6.624283e-04 3 1  ON 54
ci_56                 2.501044e-03 3 1  ON 55
ci_57                 1.713622e-03 3 1  ON 56
ci_58                -1.157780e-03 3 1  ON 57
ci_59                -1.430365e-03 3 1  ON 58
ci_60                 1.748798e-04 3 1  ON 59
ci_61                -2.371161e-04 3 1  ON 60
ci_62                -5.527077e-04 3 1  ON 61
ci_63                -6.340173e-04 3 1  ON 62
ci_64                -3.464569e-04 3 1  ON 63
ci_65                 8.430904e-06 3 1  ON 64
ci_66                -6.622173e-04 3 1  ON 65
ci_67                -8.561104e-04 3 1  ON 66
ci_68                -1.184239e-03 3 1  ON 67
ci_69                 9.222381e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7919
    reference variance = 0.504331
====================================================
  Execution time = 3.0900e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5335e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5130e-01
  Total weights = 1.964485200e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436907572073
                                         uncertainty =       0.001704109549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436907572073
                                         uncertainty =       0.001704109549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467405207
  error estimate for blocks of size 2^( 2) =       0.000492708904
  error estimate for blocks of size 2^( 3) =       0.000515957286
  error estimate for blocks of size 2^( 4) =       0.000532910446
  error estimate for blocks of size 2^( 5) =       0.000543497801
  error estimate for blocks of size 2^( 6) =       0.000550079471
  error estimate for blocks of size 2^( 7) =       0.000551734093

      target function =      -0.744274928866
              le_mean =     -22.815289106988
             les_mean =     520.988713195194
             stat err =       0.000544555453
             autocorr =       1.357366510108
   target nu stat err =       0.000544555453
   target dn stat err =       0.002825352032
      target stat err =       0.002413574562
              std dev =       0.661010782867
             le_variance =       0.436935255066


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281528910699e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744281751342       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744281797211       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744281805714       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744281807174       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744281807117       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744281807101       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744281807109       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744281807140       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744281807124       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744281807138       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+02 is 7.284238e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744281751342       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744281762812       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744281764937       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744281765303       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744281765288       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744281765285       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744281765288       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744281765295       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744281765291       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744281765295       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+02 is 1.821204e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744281751342       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744281754210       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744281754741       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744281754833       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744281754832       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744281754825       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744281754825       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744281754831       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744281754826       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744281754845       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+03 is 4.553099e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091994 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5398e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.264977e-01 3 1  ON 0
ci_02                -2.871684e-02 3 1  ON 1
ci_03                -2.856560e-02 3 1  ON 2
ci_04                 2.661110e-02 3 1  ON 3
ci_05                -2.187444e-02 3 1  ON 4
ci_06                -2.154234e-02 3 1  ON 5
ci_07                 2.710063e-02 3 1  ON 6
ci_08                -5.456629e-03 3 1  ON 7
ci_09                -8.841300e-03 3 1  ON 8
ci_10                -8.366156e-03 3 1  ON 9
ci_11                 1.311116e-02 3 1  ON 10
ci_12                 6.947969e-03 3 1  ON 11
ci_13                 1.303829e-02 3 1  ON 12
ci_14                 1.252696e-02 3 1  ON 13
ci_15                 6.372918e-03 3 1  ON 14
ci_16                 6.263239e-03 3 1  ON 15
ci_17                -7.197738e-03 3 1  ON 16
ci_18                -6.024975e-03 3 1  ON 17
ci_19                 9.258773e-03 3 1  ON 18
ci_20                 6.518053e-03 3 1  ON 19
ci_21                 8.966473e-03 3 1  ON 20
ci_22                 8.290038e-03 3 1  ON 21
ci_23                 4.852301e-03 3 1  ON 22
ci_24                 4.085854e-03 3 1  ON 23
ci_25                 2.863634e-03 3 1  ON 24
ci_26                 3.084466e-03 3 1  ON 25
ci_27                 3.185036e-03 3 1  ON 26
ci_28                 1.755195e-03 3 1  ON 27
ci_29                 1.455481e-03 3 1  ON 28
ci_30                -1.777937e-03 3 1  ON 29
ci_31                -4.942532e-04 3 1  ON 30
ci_32                -9.474778e-04 3 1  ON 31
ci_33                -1.370391e-03 3 1  ON 32
ci_34                 1.097531e-03 3 1  ON 33
ci_35                 1.541647e-03 3 1  ON 34
ci_36                -1.076743e-03 3 1  ON 35
ci_37                -1.050106e-03 3 1  ON 36
ci_38                -6.338630e-04 3 1  ON 37
ci_39                -6.038543e-04 3 1  ON 38
ci_40                -1.528224e-03 3 1  ON 39
ci_41                -1.187714e-03 3 1  ON 40
ci_42                -1.175809e-03 3 1  ON 41
ci_43                -2.260249e-03 3 1  ON 42
ci_44                -2.994379e-03 3 1  ON 43
ci_45                -5.582915e-04 3 1  ON 44
ci_46                -7.370312e-04 3 1  ON 45
ci_47                 1.561997e-03 3 1  ON 46
ci_48                 1.419338e-03 3 1  ON 47
ci_49                -9.593815e-04 3 1  ON 48
ci_50                -7.631946e-04 3 1  ON 49
ci_51                 1.271323e-04 3 1  ON 50
ci_52                 1.810444e-04 3 1  ON 51
ci_53                -7.051966e-04 3 1  ON 52
ci_54                -1.079734e-03 3 1  ON 53
ci_55                -6.624670e-04 3 1  ON 54
ci_56                 2.501023e-03 3 1  ON 55
ci_57                 1.713645e-03 3 1  ON 56
ci_58                -1.157739e-03 3 1  ON 57
ci_59                -1.430366e-03 3 1  ON 58
ci_60                 1.748765e-04 3 1  ON 59
ci_61                -2.371932e-04 3 1  ON 60
ci_62                -5.527172e-04 3 1  ON 61
ci_63                -6.340094e-04 3 1  ON 62
ci_64                -3.464631e-04 3 1  ON 63
ci_65                 8.409088e-06 3 1  ON 64
ci_66                -6.622005e-04 3 1  ON 65
ci_67                -8.560913e-04 3 1  ON 66
ci_68                -1.184230e-03 3 1  ON 67
ci_69                 9.226339e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7983
    reference variance = 1.47531
====================================================
  Execution time = 3.4430e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4508e-01
  Total weights = 1.9644e+06
  Execution time = 3.4844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431568853252
                                         uncertainty =       0.002191808315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431568853252
                                         uncertainty =       0.002191808315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464582651
  error estimate for blocks of size 2^( 2) =       0.000490097029
  error estimate for blocks of size 2^( 3) =       0.000514232372
  error estimate for blocks of size 2^( 4) =       0.000531552973
  error estimate for blocks of size 2^( 5) =       0.000542248119
  error estimate for blocks of size 2^( 6) =       0.000549079337
  error estimate for blocks of size 2^( 7) =       0.000548817855

      target function =      -0.749452228992
              le_mean =     -22.815620947413
             les_mean =     520.997640239132
             stat err =       0.000542924571
             autocorr =       1.365692793100
   target nu stat err =       0.000542924571
   target dn stat err =       0.002734688330
      target stat err =       0.002373365288
              std dev =       0.657019086457
             le_variance =       0.431674079969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431568784950
                                         uncertainty =       0.002191798625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431568784950
                                         uncertainty =       0.002191798625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464582615
  error estimate for blocks of size 2^( 2) =       0.000490097011
  error estimate for blocks of size 2^( 3) =       0.000514232378
  error estimate for blocks of size 2^( 4) =       0.000531552998
  error estimate for blocks of size 2^( 5) =       0.000542248160
  error estimate for blocks of size 2^( 6) =       0.000549079375
  error estimate for blocks of size 2^( 7) =       0.000548817897

      target function =      -0.749451205070
              le_mean =     -22.815620944792
             les_mean =     520.997641340498
             stat err =       0.000542924607
             autocorr =       1.365693190701
   target nu stat err =       0.000542924607
   target dn stat err =       0.002734613518
      target stat err =       0.002373298346
              std dev =       0.657019034603
             le_variance =       0.431674011830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431568819089
                                         uncertainty =       0.002191803469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431568819089
                                         uncertainty =       0.002191803469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464582633
  error estimate for blocks of size 2^( 2) =       0.000490097020
  error estimate for blocks of size 2^( 3) =       0.000514232375
  error estimate for blocks of size 2^( 4) =       0.000531552986
  error estimate for blocks of size 2^( 5) =       0.000542248139
  error estimate for blocks of size 2^( 6) =       0.000549079356
  error estimate for blocks of size 2^( 7) =       0.000548817876

      target function =      -0.749451772482
              le_mean =     -22.815620946101
             les_mean =     520.997640723655
             stat err =       0.000542924589
             autocorr =       1.365692991962
   target nu stat err =       0.000542924589
   target dn stat err =       0.002734649131
      target stat err =       0.002373330702
              std dev =       0.657019060521
             le_variance =       0.431674045888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431568848980
                                         uncertainty =       0.002191807709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431568848980
                                         uncertainty =       0.002191807709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464582649
  error estimate for blocks of size 2^( 2) =       0.000490097027
  error estimate for blocks of size 2^( 3) =       0.000514232372
  error estimate for blocks of size 2^( 4) =       0.000531552975
  error estimate for blocks of size 2^( 5) =       0.000542248122
  error estimate for blocks of size 2^( 6) =       0.000549079340
  error estimate for blocks of size 2^( 7) =       0.000548817857

      target function =      -0.749452177763
              le_mean =     -22.815620947248
             les_mean =     520.997640292735
             stat err =       0.000542924573
             autocorr =       1.365692817956
   target nu stat err =       0.000542924573
   target dn stat err =       0.002734683245
      target stat err =       0.002373360850
              std dev =       0.657019083214
             le_variance =       0.431674075708


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749452228992        initial  <--
     2.3842e+02     2.3842e+03             7.2842e-07        -0.749451205070
     9.5367e+02     9.5367e+03             1.8212e-07        -0.749451772482
     3.8147e+03     3.8147e+04             4.5531e-08        -0.749452177763

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 51.8939
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.264978e-01 3 1  ON 0
ci_02                -2.871697e-02 3 1  ON 1
ci_03                -2.856566e-02 3 1  ON 2
ci_04                 2.661113e-02 3 1  ON 3
ci_05                -2.187448e-02 3 1  ON 4
ci_06                -2.154239e-02 3 1  ON 5
ci_07                 2.710065e-02 3 1  ON 6
ci_08                -5.456661e-03 3 1  ON 7
ci_09                -8.841356e-03 3 1  ON 8
ci_10                -8.366154e-03 3 1  ON 9
ci_11                 1.311121e-02 3 1  ON 10
ci_12                 6.947938e-03 3 1  ON 11
ci_13                 1.303837e-02 3 1  ON 12
ci_14                 1.252697e-02 3 1  ON 13
ci_15                 6.372944e-03 3 1  ON 14
ci_16                 6.263238e-03 3 1  ON 15
ci_17                -7.197791e-03 3 1  ON 16
ci_18                -6.024891e-03 3 1  ON 17
ci_19                 9.258714e-03 3 1  ON 18
ci_20                 6.518146e-03 3 1  ON 19
ci_21                 8.966492e-03 3 1  ON 20
ci_22                 8.289985e-03 3 1  ON 21
ci_23                 4.852288e-03 3 1  ON 22
ci_24                 4.085863e-03 3 1  ON 23
ci_25                 2.863631e-03 3 1  ON 24
ci_26                 3.084439e-03 3 1  ON 25
ci_27                 3.185055e-03 3 1  ON 26
ci_28                 1.755150e-03 3 1  ON 27
ci_29                 1.455459e-03 3 1  ON 28
ci_30                -1.777952e-03 3 1  ON 29
ci_31                -4.941821e-04 3 1  ON 30
ci_32                -9.474711e-04 3 1  ON 31
ci_33                -1.370413e-03 3 1  ON 32
ci_34                 1.097541e-03 3 1  ON 33
ci_35                 1.541653e-03 3 1  ON 34
ci_36                -1.076829e-03 3 1  ON 35
ci_37                -1.050139e-03 3 1  ON 36
ci_38                -6.338122e-04 3 1  ON 37
ci_39                -6.038591e-04 3 1  ON 38
ci_40                -1.528295e-03 3 1  ON 39
ci_41                -1.187683e-03 3 1  ON 40
ci_42                -1.175803e-03 3 1  ON 41
ci_43                -2.260254e-03 3 1  ON 42
ci_44                -2.994366e-03 3 1  ON 43
ci_45                -5.583291e-04 3 1  ON 44
ci_46                -7.371149e-04 3 1  ON 45
ci_47                 1.562014e-03 3 1  ON 46
ci_48                 1.419319e-03 3 1  ON 47
ci_49                -9.593854e-04 3 1  ON 48
ci_50                -7.631848e-04 3 1  ON 49
ci_51                 1.271042e-04 3 1  ON 50
ci_52                 1.810436e-04 3 1  ON 51
ci_53                -7.051423e-04 3 1  ON 52
ci_54                -1.079747e-03 3 1  ON 53
ci_55                -6.624283e-04 3 1  ON 54
ci_56                 2.501044e-03 3 1  ON 55
ci_57                 1.713622e-03 3 1  ON 56
ci_58                -1.157780e-03 3 1  ON 57
ci_59                -1.430365e-03 3 1  ON 58
ci_60                 1.748798e-04 3 1  ON 59
ci_61                -2.371161e-04 3 1  ON 60
ci_62                -5.527077e-04 3 1  ON 61
ci_63                -6.340173e-04 3 1  ON 62
ci_64                -3.464569e-04 3 1  ON 63
ci_65                 8.430904e-06 3 1  ON 64
ci_66                -6.622173e-04 3 1  ON 65
ci_67                -8.561104e-04 3 1  ON 66
ci_68                -1.184239e-03 3 1  ON 67
ci_69                 9.222381e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8447e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7307
    reference variance = 0.265441
====================================================
  Execution time = 2.6398e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5380e-01
  Total weights = 1.964147918e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439337324759
                                         uncertainty =       0.002897300825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439337324759
                                         uncertainty =       0.002897300825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468695910
  error estimate for blocks of size 2^( 2) =       0.000494312690
  error estimate for blocks of size 2^( 3) =       0.000518323040
  error estimate for blocks of size 2^( 4) =       0.000535864175
  error estimate for blocks of size 2^( 5) =       0.000546482745
  error estimate for blocks of size 2^( 6) =       0.000553585836
  error estimate for blocks of size 2^( 7) =       0.000557231695

      target function =      -0.742197270940
              le_mean =     -22.814969660911
             les_mean =     520.976644672689
             stat err =       0.000548291113
             autocorr =       1.368485141079
   target nu stat err =       0.000548291113
   target dn stat err =       0.004542873938
      target stat err =       0.003783234025
              std dev =       0.662836111878
             le_variance =       0.439351711210


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281496966091e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742215448965       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742215454861       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742215455999       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742215456361       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742215456466       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742215456505       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742215456516       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742215456517       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742215456514       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 1.183186e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742215448965       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742215450439       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742215450724       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742215450814       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742215450833       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742215450854       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742215450848       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742215450862       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742215450852       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 2.957987e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742215448965       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742215449334       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742215449405       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742215449428       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742215449434       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742215449473       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742215449446       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742215449341       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742215449299       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+04 is 7.394983e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095089 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0911e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.264978e-01 3 1  ON 0
ci_02                -2.871697e-02 3 1  ON 1
ci_03                -2.856566e-02 3 1  ON 2
ci_04                 2.661112e-02 3 1  ON 3
ci_05                -2.187447e-02 3 1  ON 4
ci_06                -2.154238e-02 3 1  ON 5
ci_07                 2.710065e-02 3 1  ON 6
ci_08                -5.456660e-03 3 1  ON 7
ci_09                -8.841361e-03 3 1  ON 8
ci_10                -8.366156e-03 3 1  ON 9
ci_11                 1.311121e-02 3 1  ON 10
ci_12                 6.947941e-03 3 1  ON 11
ci_13                 1.303838e-02 3 1  ON 12
ci_14                 1.252698e-02 3 1  ON 13
ci_15                 6.372952e-03 3 1  ON 14
ci_16                 6.263238e-03 3 1  ON 15
ci_17                -7.197776e-03 3 1  ON 16
ci_18                -6.024887e-03 3 1  ON 17
ci_19                 9.258718e-03 3 1  ON 18
ci_20                 6.518139e-03 3 1  ON 19
ci_21                 8.966502e-03 3 1  ON 20
ci_22                 8.289983e-03 3 1  ON 21
ci_23                 4.852288e-03 3 1  ON 22
ci_24                 4.085861e-03 3 1  ON 23
ci_25                 2.863632e-03 3 1  ON 24
ci_26                 3.084439e-03 3 1  ON 25
ci_27                 3.185059e-03 3 1  ON 26
ci_28                 1.755146e-03 3 1  ON 27
ci_29                 1.455465e-03 3 1  ON 28
ci_30                -1.777965e-03 3 1  ON 29
ci_31                -4.941811e-04 3 1  ON 30
ci_32                -9.474764e-04 3 1  ON 31
ci_33                -1.370413e-03 3 1  ON 32
ci_34                 1.097542e-03 3 1  ON 33
ci_35                 1.541645e-03 3 1  ON 34
ci_36                -1.076828e-03 3 1  ON 35
ci_37                -1.050131e-03 3 1  ON 36
ci_38                -6.338135e-04 3 1  ON 37
ci_39                -6.038606e-04 3 1  ON 38
ci_40                -1.528294e-03 3 1  ON 39
ci_41                -1.187685e-03 3 1  ON 40
ci_42                -1.175806e-03 3 1  ON 41
ci_43                -2.260251e-03 3 1  ON 42
ci_44                -2.994354e-03 3 1  ON 43
ci_45                -5.583298e-04 3 1  ON 44
ci_46                -7.371114e-04 3 1  ON 45
ci_47                 1.562024e-03 3 1  ON 46
ci_48                 1.419313e-03 3 1  ON 47
ci_49                -9.593829e-04 3 1  ON 48
ci_50                -7.631896e-04 3 1  ON 49
ci_51                 1.271029e-04 3 1  ON 50
ci_52                 1.810436e-04 3 1  ON 51
ci_53                -7.051437e-04 3 1  ON 52
ci_54                -1.079744e-03 3 1  ON 53
ci_55                -6.624309e-04 3 1  ON 54
ci_56                 2.501039e-03 3 1  ON 55
ci_57                 1.713614e-03 3 1  ON 56
ci_58                -1.157779e-03 3 1  ON 57
ci_59                -1.430370e-03 3 1  ON 58
ci_60                 1.748794e-04 3 1  ON 59
ci_61                -2.371208e-04 3 1  ON 60
ci_62                -5.527104e-04 3 1  ON 61
ci_63                -6.340158e-04 3 1  ON 62
ci_64                -3.464541e-04 3 1  ON 63
ci_65                 8.430816e-06 3 1  ON 64
ci_66                -6.622174e-04 3 1  ON 65
ci_67                -8.561081e-04 3 1  ON 66
ci_68                -1.184238e-03 3 1  ON 67
ci_69                 9.221455e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7618
    reference variance = 0.433886
====================================================
  Execution time = 2.5457e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4873e-01
  Total weights = 1.9644e+06
  Execution time = 3.4674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435217792168
                                         uncertainty =       0.002090039932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435217792168
                                         uncertainty =       0.002090039932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466466041
  error estimate for blocks of size 2^( 2) =       0.000491935017
  error estimate for blocks of size 2^( 3) =       0.000516036538
  error estimate for blocks of size 2^( 4) =       0.000533977889
  error estimate for blocks of size 2^( 5) =       0.000544426102
  error estimate for blocks of size 2^( 6) =       0.000551119396
  error estimate for blocks of size 2^( 7) =       0.000555241808

      target function =      -0.746399757184
              le_mean =     -22.814619687870
             les_mean =     520.955603380243
             stat err =       0.000546191299
             autocorr =       1.371037991207
   target nu stat err =       0.000546191299
   target dn stat err =       0.003104871544
      target stat err =       0.002650446914
              std dev =       0.659682601932
             le_variance =       0.435181135292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435217788542
                                         uncertainty =       0.002090041818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435217788542
                                         uncertainty =       0.002090041818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466466039
  error estimate for blocks of size 2^( 2) =       0.000491935017
  error estimate for blocks of size 2^( 3) =       0.000516036539
  error estimate for blocks of size 2^( 4) =       0.000533977892
  error estimate for blocks of size 2^( 5) =       0.000544426106
  error estimate for blocks of size 2^( 6) =       0.000551119402
  error estimate for blocks of size 2^( 7) =       0.000555241815

      target function =      -0.746399825687
              le_mean =     -22.814619687928
             les_mean =     520.955603300498
             stat err =       0.000546191304
             autocorr =       1.371038027694
   target nu stat err =       0.000546191304
   target dn stat err =       0.003104859878
      target stat err =       0.002650437954
              std dev =       0.659682599248
             le_variance =       0.435181131750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435217790355
                                         uncertainty =       0.002090040875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435217790355
                                         uncertainty =       0.002090040875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466466040
  error estimate for blocks of size 2^( 2) =       0.000491935017
  error estimate for blocks of size 2^( 3) =       0.000516036538
  error estimate for blocks of size 2^( 4) =       0.000533977890
  error estimate for blocks of size 2^( 5) =       0.000544426104
  error estimate for blocks of size 2^( 6) =       0.000551119399
  error estimate for blocks of size 2^( 7) =       0.000555241812

      target function =      -0.746399791449
              le_mean =     -22.814619687899
             les_mean =     520.955603340354
             stat err =       0.000546191301
             autocorr =       1.371038009447
   target nu stat err =       0.000546191301
   target dn stat err =       0.003104865711
      target stat err =       0.002650442434
              std dev =       0.659682600590
             le_variance =       0.435181133521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435217791941
                                         uncertainty =       0.002090040050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435217791941
                                         uncertainty =       0.002090040050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466466041
  error estimate for blocks of size 2^( 2) =       0.000491935017
  error estimate for blocks of size 2^( 3) =       0.000516036538
  error estimate for blocks of size 2^( 4) =       0.000533977889
  error estimate for blocks of size 2^( 5) =       0.000544426102
  error estimate for blocks of size 2^( 6) =       0.000551119396
  error estimate for blocks of size 2^( 7) =       0.000555241809

      target function =      -0.746399761469
              le_mean =     -22.814619687874
             les_mean =     520.955603375256
             stat err =       0.000546191299
             autocorr =       1.371037993496
   target nu stat err =       0.000546191299
   target dn stat err =       0.003104870815
      target stat err =       0.002650446354
              std dev =       0.659682601764
             le_variance =       0.435181135071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746399757184        initial
     2.3842e+03     2.3842e+04             1.1832e-07        -0.746399825687  <--
     9.5367e+03     9.5367e+04             2.9580e-08        -0.746399791449
     3.8147e+04     3.8147e+05             7.3950e-09        -0.746399761469

*****************************************************************************
Applying the update for shift_i =   2.3842e+03     and shift_s =   2.3842e+04
*****************************************************************************

  Execution time = 4.2843e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.264977e-01 3 1  ON 0
ci_02                -2.871697e-02 3 1  ON 1
ci_03                -2.856566e-02 3 1  ON 2
ci_04                 2.661110e-02 3 1  ON 3
ci_05                -2.187443e-02 3 1  ON 4
ci_06                -2.154237e-02 3 1  ON 5
ci_07                 2.710062e-02 3 1  ON 6
ci_08                -5.456657e-03 3 1  ON 7
ci_09                -8.841375e-03 3 1  ON 8
ci_10                -8.366161e-03 3 1  ON 9
ci_11                 1.311119e-02 3 1  ON 10
ci_12                 6.947949e-03 3 1  ON 11
ci_13                 1.303840e-02 3 1  ON 12
ci_14                 1.252699e-02 3 1  ON 13
ci_15                 6.372978e-03 3 1  ON 14
ci_16                 6.263237e-03 3 1  ON 15
ci_17                -7.197733e-03 3 1  ON 16
ci_18                -6.024874e-03 3 1  ON 17
ci_19                 9.258730e-03 3 1  ON 18
ci_20                 6.518117e-03 3 1  ON 19
ci_21                 8.966531e-03 3 1  ON 20
ci_22                 8.289980e-03 3 1  ON 21
ci_23                 4.852291e-03 3 1  ON 22
ci_24                 4.085854e-03 3 1  ON 23
ci_25                 2.863635e-03 3 1  ON 24
ci_26                 3.084437e-03 3 1  ON 25
ci_27                 3.185071e-03 3 1  ON 26
ci_28                 1.755133e-03 3 1  ON 27
ci_29                 1.455484e-03 3 1  ON 28
ci_30                -1.778004e-03 3 1  ON 29
ci_31                -4.941778e-04 3 1  ON 30
ci_32                -9.474924e-04 3 1  ON 31
ci_33                -1.370412e-03 3 1  ON 32
ci_34                 1.097544e-03 3 1  ON 33
ci_35                 1.541618e-03 3 1  ON 34
ci_36                -1.076823e-03 3 1  ON 35
ci_37                -1.050108e-03 3 1  ON 36
ci_38                -6.338173e-04 3 1  ON 37
ci_39                -6.038652e-04 3 1  ON 38
ci_40                -1.528291e-03 3 1  ON 39
ci_41                -1.187692e-03 3 1  ON 40
ci_42                -1.175815e-03 3 1  ON 41
ci_43                -2.260243e-03 3 1  ON 42
ci_44                -2.994320e-03 3 1  ON 43
ci_45                -5.583317e-04 3 1  ON 44
ci_46                -7.371008e-04 3 1  ON 45
ci_47                 1.562053e-03 3 1  ON 46
ci_48                 1.419295e-03 3 1  ON 47
ci_49                -9.593753e-04 3 1  ON 48
ci_50                -7.632040e-04 3 1  ON 49
ci_51                 1.270989e-04 3 1  ON 50
ci_52                 1.810438e-04 3 1  ON 51
ci_53                -7.051478e-04 3 1  ON 52
ci_54                -1.079737e-03 3 1  ON 53
ci_55                -6.624388e-04 3 1  ON 54
ci_56                 2.501022e-03 3 1  ON 55
ci_57                 1.713591e-03 3 1  ON 56
ci_58                -1.157778e-03 3 1  ON 57
ci_59                -1.430386e-03 3 1  ON 58
ci_60                 1.748784e-04 3 1  ON 59
ci_61                -2.371348e-04 3 1  ON 60
ci_62                -5.527183e-04 3 1  ON 61
ci_63                -6.340113e-04 3 1  ON 62
ci_64                -3.464457e-04 3 1  ON 63
ci_65                 8.430553e-06 3 1  ON 64
ci_66                -6.622178e-04 3 1  ON 65
ci_67                -8.561010e-04 3 1  ON 66
ci_68                -1.184236e-03 3 1  ON 67
ci_69                 9.218679e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7440e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2806e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.8119
    reference variance = 0.33643
====================================================
  Execution time = 2.9586e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4550e-01
  Total weights = 1.964279627e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433407371061
                                         uncertainty =       0.001960328093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433407371061
                                         uncertainty =       0.001960328093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465503438
  error estimate for blocks of size 2^( 2) =       0.000490906197
  error estimate for blocks of size 2^( 3) =       0.000515046328
  error estimate for blocks of size 2^( 4) =       0.000532825306
  error estimate for blocks of size 2^( 5) =       0.000543611197
  error estimate for blocks of size 2^( 6) =       0.000549930787
  error estimate for blocks of size 2^( 7) =       0.000555507521

      target function =      -0.749093515728
              le_mean =     -22.814625764812
             les_mean =     520.952653412472
             stat err =       0.000545468703
             autocorr =       1.373073828473
   target nu stat err =       0.000545468703
   target dn stat err =       0.002587987449
      target stat err =       0.002249959554
              std dev =       0.658321274936
             le_variance =       0.433386901033


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281462576481e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749099271725       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749099293544       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749099295826       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749099296467       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749099296566       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749099296619       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749099296600       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749099296587       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749099296583       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 2.300912e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749099271725       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749099277180       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749099277751       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749099277911       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749099277936       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749099277947       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749099277945       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749099277942       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749099277940       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 5.752456e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749099271725       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749099273089       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749099273232       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749099273272       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749099273275       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749099273273       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749099273280       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749099273284       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749099273282       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 1.438125e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098167 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4108e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.264977e-01 3 1  ON 0
ci_02                -2.871695e-02 3 1  ON 1
ci_03                -2.856569e-02 3 1  ON 2
ci_04                 2.661105e-02 3 1  ON 3
ci_05                -2.187443e-02 3 1  ON 4
ci_06                -2.154238e-02 3 1  ON 5
ci_07                 2.710062e-02 3 1  ON 6
ci_08                -5.456640e-03 3 1  ON 7
ci_09                -8.841376e-03 3 1  ON 8
ci_10                -8.366114e-03 3 1  ON 9
ci_11                 1.311117e-02 3 1  ON 10
ci_12                 6.947931e-03 3 1  ON 11
ci_13                 1.303839e-02 3 1  ON 12
ci_14                 1.252699e-02 3 1  ON 13
ci_15                 6.372979e-03 3 1  ON 14
ci_16                 6.263237e-03 3 1  ON 15
ci_17                -7.197709e-03 3 1  ON 16
ci_18                -6.024889e-03 3 1  ON 17
ci_19                 9.258711e-03 3 1  ON 18
ci_20                 6.518119e-03 3 1  ON 19
ci_21                 8.966518e-03 3 1  ON 20
ci_22                 8.289992e-03 3 1  ON 21
ci_23                 4.852278e-03 3 1  ON 22
ci_24                 4.085866e-03 3 1  ON 23
ci_25                 2.863667e-03 3 1  ON 24
ci_26                 3.084474e-03 3 1  ON 25
ci_27                 3.185091e-03 3 1  ON 26
ci_28                 1.755156e-03 3 1  ON 27
ci_29                 1.455489e-03 3 1  ON 28
ci_30                -1.777988e-03 3 1  ON 29
ci_31                -4.941690e-04 3 1  ON 30
ci_32                -9.474914e-04 3 1  ON 31
ci_33                -1.370412e-03 3 1  ON 32
ci_34                 1.097578e-03 3 1  ON 33
ci_35                 1.541622e-03 3 1  ON 34
ci_36                -1.076816e-03 3 1  ON 35
ci_37                -1.050094e-03 3 1  ON 36
ci_38                -6.338188e-04 3 1  ON 37
ci_39                -6.038643e-04 3 1  ON 38
ci_40                -1.528276e-03 3 1  ON 39
ci_41                -1.187717e-03 3 1  ON 40
ci_42                -1.175832e-03 3 1  ON 41
ci_43                -2.260223e-03 3 1  ON 42
ci_44                -2.994297e-03 3 1  ON 43
ci_45                -5.583270e-04 3 1  ON 44
ci_46                -7.370837e-04 3 1  ON 45
ci_47                 1.562061e-03 3 1  ON 46
ci_48                 1.419321e-03 3 1  ON 47
ci_49                -9.593565e-04 3 1  ON 48
ci_50                -7.632131e-04 3 1  ON 49
ci_51                 1.271003e-04 3 1  ON 50
ci_52                 1.810542e-04 3 1  ON 51
ci_53                -7.051458e-04 3 1  ON 52
ci_54                -1.079717e-03 3 1  ON 53
ci_55                -6.624163e-04 3 1  ON 54
ci_56                 2.501011e-03 3 1  ON 55
ci_57                 1.713615e-03 3 1  ON 56
ci_58                -1.157764e-03 3 1  ON 57
ci_59                -1.430365e-03 3 1  ON 58
ci_60                 1.748695e-04 3 1  ON 59
ci_61                -2.371097e-04 3 1  ON 60
ci_62                -5.526995e-04 3 1  ON 61
ci_63                -6.339967e-04 3 1  ON 62
ci_64                -3.464310e-04 3 1  ON 63
ci_65                 8.410774e-06 3 1  ON 64
ci_66                -6.622137e-04 3 1  ON 65
ci_67                -8.561065e-04 3 1  ON 66
ci_68                -1.184251e-03 3 1  ON 67
ci_69                 9.215539e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.8117
    reference variance = 0.29077
====================================================
  Execution time = 2.5426e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6783e-01
  Total weights = 1.9642e+06
  Execution time = 3.4904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432323747946
                                         uncertainty =       0.001956985150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432323747946
                                         uncertainty =       0.001956985150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464952817
  error estimate for blocks of size 2^( 2) =       0.000490820021
  error estimate for blocks of size 2^( 3) =       0.000514723231
  error estimate for blocks of size 2^( 4) =       0.000532335391
  error estimate for blocks of size 2^( 5) =       0.000543837070
  error estimate for blocks of size 2^( 6) =       0.000550028391
  error estimate for blocks of size 2^( 7) =       0.000551163205

      target function =      -0.730482814880
              le_mean =     -22.814514514478
             les_mean =     520.969898883714
             stat err =       0.000544341014
             autocorr =       1.370642988883
   target nu stat err =       0.000544341014
   target dn stat err =       0.021286643244
      target stat err =       0.016956925736
              std dev =       0.657542580255
             le_variance =       0.432362244849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432323729727
                                         uncertainty =       0.001956982175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432323729727
                                         uncertainty =       0.001956982175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464952808
  error estimate for blocks of size 2^( 2) =       0.000490820018
  error estimate for blocks of size 2^( 3) =       0.000514723234
  error estimate for blocks of size 2^( 4) =       0.000532335401
  error estimate for blocks of size 2^( 5) =       0.000543837081
  error estimate for blocks of size 2^( 6) =       0.000550028404
  error estimate for blocks of size 2^( 7) =       0.000551163223

      target function =      -0.730477497050
              le_mean =     -22.814514517284
             les_mean =     520.969905396437
             stat err =       0.000544341027
             autocorr =       1.370643112736
   target nu stat err =       0.000544341027
   target dn stat err =       0.021293156513
      target stat err =       0.016961866565
              std dev =       0.657542566407
             le_variance =       0.432362226637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432323738834
                                         uncertainty =       0.001956983662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432323738834
                                         uncertainty =       0.001956983662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464952813
  error estimate for blocks of size 2^( 2) =       0.000490820019
  error estimate for blocks of size 2^( 3) =       0.000514723233
  error estimate for blocks of size 2^( 4) =       0.000532335396
  error estimate for blocks of size 2^( 5) =       0.000543837076
  error estimate for blocks of size 2^( 6) =       0.000550028397
  error estimate for blocks of size 2^( 7) =       0.000551163214

      target function =      -0.730480156179
              le_mean =     -22.814514515881
             les_mean =     520.969902139805
             stat err =       0.000544341021
             autocorr =       1.370643050813
   target nu stat err =       0.000544341021
   target dn stat err =       0.021289899780
      target stat err =       0.016959396099
              std dev =       0.657542573330
             le_variance =       0.432362235741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432323746807
                                         uncertainty =       0.001956984964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432323746807
                                         uncertainty =       0.001956984964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464952817
  error estimate for blocks of size 2^( 2) =       0.000490820021
  error estimate for blocks of size 2^( 3) =       0.000514723231
  error estimate for blocks of size 2^( 4) =       0.000532335392
  error estimate for blocks of size 2^( 5) =       0.000543837071
  error estimate for blocks of size 2^( 6) =       0.000550028392
  error estimate for blocks of size 2^( 7) =       0.000551163206

      target function =      -0.730482482584
              le_mean =     -22.814514514654
             les_mean =     520.969899290673
             stat err =       0.000544341015
             autocorr =       1.370642996631
   target nu stat err =       0.000544341015
   target dn stat err =       0.021287050278
      target stat err =       0.016957234509
              std dev =       0.657542579389
             le_variance =       0.432362243710


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.730482814880        initial  <--
     5.9605e+02     5.9605e+03             2.3009e-07        -0.730477497050
     2.3842e+03     2.3842e+04             5.7525e-08        -0.730480156179
     9.5367e+03     9.5367e+04             1.4381e-08        -0.730482482584

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8762
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.264977e-01 3 1  ON 0
ci_02                -2.871697e-02 3 1  ON 1
ci_03                -2.856566e-02 3 1  ON 2
ci_04                 2.661110e-02 3 1  ON 3
ci_05                -2.187443e-02 3 1  ON 4
ci_06                -2.154237e-02 3 1  ON 5
ci_07                 2.710062e-02 3 1  ON 6
ci_08                -5.456657e-03 3 1  ON 7
ci_09                -8.841375e-03 3 1  ON 8
ci_10                -8.366161e-03 3 1  ON 9
ci_11                 1.311119e-02 3 1  ON 10
ci_12                 6.947949e-03 3 1  ON 11
ci_13                 1.303840e-02 3 1  ON 12
ci_14                 1.252699e-02 3 1  ON 13
ci_15                 6.372978e-03 3 1  ON 14
ci_16                 6.263237e-03 3 1  ON 15
ci_17                -7.197733e-03 3 1  ON 16
ci_18                -6.024874e-03 3 1  ON 17
ci_19                 9.258730e-03 3 1  ON 18
ci_20                 6.518117e-03 3 1  ON 19
ci_21                 8.966531e-03 3 1  ON 20
ci_22                 8.289980e-03 3 1  ON 21
ci_23                 4.852291e-03 3 1  ON 22
ci_24                 4.085854e-03 3 1  ON 23
ci_25                 2.863635e-03 3 1  ON 24
ci_26                 3.084437e-03 3 1  ON 25
ci_27                 3.185071e-03 3 1  ON 26
ci_28                 1.755133e-03 3 1  ON 27
ci_29                 1.455484e-03 3 1  ON 28
ci_30                -1.778004e-03 3 1  ON 29
ci_31                -4.941778e-04 3 1  ON 30
ci_32                -9.474924e-04 3 1  ON 31
ci_33                -1.370412e-03 3 1  ON 32
ci_34                 1.097544e-03 3 1  ON 33
ci_35                 1.541618e-03 3 1  ON 34
ci_36                -1.076823e-03 3 1  ON 35
ci_37                -1.050108e-03 3 1  ON 36
ci_38                -6.338173e-04 3 1  ON 37
ci_39                -6.038652e-04 3 1  ON 38
ci_40                -1.528291e-03 3 1  ON 39
ci_41                -1.187692e-03 3 1  ON 40
ci_42                -1.175815e-03 3 1  ON 41
ci_43                -2.260243e-03 3 1  ON 42
ci_44                -2.994320e-03 3 1  ON 43
ci_45                -5.583317e-04 3 1  ON 44
ci_46                -7.371008e-04 3 1  ON 45
ci_47                 1.562053e-03 3 1  ON 46
ci_48                 1.419295e-03 3 1  ON 47
ci_49                -9.593753e-04 3 1  ON 48
ci_50                -7.632040e-04 3 1  ON 49
ci_51                 1.270989e-04 3 1  ON 50
ci_52                 1.810438e-04 3 1  ON 51
ci_53                -7.051478e-04 3 1  ON 52
ci_54                -1.079737e-03 3 1  ON 53
ci_55                -6.624388e-04 3 1  ON 54
ci_56                 2.501022e-03 3 1  ON 55
ci_57                 1.713591e-03 3 1  ON 56
ci_58                -1.157778e-03 3 1  ON 57
ci_59                -1.430386e-03 3 1  ON 58
ci_60                 1.748784e-04 3 1  ON 59
ci_61                -2.371348e-04 3 1  ON 60
ci_62                -5.527183e-04 3 1  ON 61
ci_63                -6.340113e-04 3 1  ON 62
ci_64                -3.464457e-04 3 1  ON 63
ci_65                 8.430553e-06 3 1  ON 64
ci_66                -6.622178e-04 3 1  ON 65
ci_67                -8.561010e-04 3 1  ON 66
ci_68                -1.184236e-03 3 1  ON 67
ci_69                 9.218679e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6992e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2806e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.6867
    reference variance = 0.422884
====================================================
  Execution time = 2.7824e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4986e-01
  Total weights = 1.964478023e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433164206553
                                         uncertainty =       0.002149084768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433164206553
                                         uncertainty =       0.002149084768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465397181
  error estimate for blocks of size 2^( 2) =       0.000490871856
  error estimate for blocks of size 2^( 3) =       0.000514605614
  error estimate for blocks of size 2^( 4) =       0.000533000236
  error estimate for blocks of size 2^( 5) =       0.000543723536
  error estimate for blocks of size 2^( 6) =       0.000549441215
  error estimate for blocks of size 2^( 7) =       0.000552727867

      target function =      -0.745451735082
              le_mean =     -22.813979988813
             les_mean =     520.927538079133
             stat err =       0.000544723213
             autocorr =       1.369948590432
   target nu stat err =       0.000544723213
   target dn stat err =       0.005163967433
      target stat err =       0.004318336316
              std dev =       0.658171005030
             le_variance =       0.433189071862


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281397998881e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745475809299       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745475810636       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745475810864       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745475810889       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745475810887       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745475810898       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745475810895       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745475810888       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745475810893       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+03 is 2.668622e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745475809299       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745475809634       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745475809690       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745475809705       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745475809681       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745475809697       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745475809697       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745475809697       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745475809681       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+04 is 6.671576e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745475809299       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745475809383       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745475809397       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745475809420       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745475809373       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745475809571       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745475809480       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745475809623       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745475809390       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+04 is 1.667895e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2318e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.264977e-01 3 1  ON 0
ci_02                -2.871697e-02 3 1  ON 1
ci_03                -2.856566e-02 3 1  ON 2
ci_04                 2.661110e-02 3 1  ON 3
ci_05                -2.187443e-02 3 1  ON 4
ci_06                -2.154237e-02 3 1  ON 5
ci_07                 2.710063e-02 3 1  ON 6
ci_08                -5.456658e-03 3 1  ON 7
ci_09                -8.841376e-03 3 1  ON 8
ci_10                -8.366161e-03 3 1  ON 9
ci_11                 1.311118e-02 3 1  ON 10
ci_12                 6.947949e-03 3 1  ON 11
ci_13                 1.303840e-02 3 1  ON 12
ci_14                 1.252699e-02 3 1  ON 13
ci_15                 6.372979e-03 3 1  ON 14
ci_16                 6.263237e-03 3 1  ON 15
ci_17                -7.197733e-03 3 1  ON 16
ci_18                -6.024871e-03 3 1  ON 17
ci_19                 9.258729e-03 3 1  ON 18
ci_20                 6.518117e-03 3 1  ON 19
ci_21                 8.966533e-03 3 1  ON 20
ci_22                 8.289976e-03 3 1  ON 21
ci_23                 4.852291e-03 3 1  ON 22
ci_24                 4.085853e-03 3 1  ON 23
ci_25                 2.863635e-03 3 1  ON 24
ci_26                 3.084439e-03 3 1  ON 25
ci_27                 3.185070e-03 3 1  ON 26
ci_28                 1.755130e-03 3 1  ON 27
ci_29                 1.455486e-03 3 1  ON 28
ci_30                -1.778003e-03 3 1  ON 29
ci_31                -4.941802e-04 3 1  ON 30
ci_32                -9.474927e-04 3 1  ON 31
ci_33                -1.370414e-03 3 1  ON 32
ci_34                 1.097543e-03 3 1  ON 33
ci_35                 1.541619e-03 3 1  ON 34
ci_36                -1.076822e-03 3 1  ON 35
ci_37                -1.050108e-03 3 1  ON 36
ci_38                -6.338156e-04 3 1  ON 37
ci_39                -6.038673e-04 3 1  ON 38
ci_40                -1.528289e-03 3 1  ON 39
ci_41                -1.187691e-03 3 1  ON 40
ci_42                -1.175814e-03 3 1  ON 41
ci_43                -2.260241e-03 3 1  ON 42
ci_44                -2.994322e-03 3 1  ON 43
ci_45                -5.583304e-04 3 1  ON 44
ci_46                -7.371000e-04 3 1  ON 45
ci_47                 1.562055e-03 3 1  ON 46
ci_48                 1.419291e-03 3 1  ON 47
ci_49                -9.593765e-04 3 1  ON 48
ci_50                -7.632034e-04 3 1  ON 49
ci_51                 1.270985e-04 3 1  ON 50
ci_52                 1.810434e-04 3 1  ON 51
ci_53                -7.051479e-04 3 1  ON 52
ci_54                -1.079737e-03 3 1  ON 53
ci_55                -6.624373e-04 3 1  ON 54
ci_56                 2.501021e-03 3 1  ON 55
ci_57                 1.713592e-03 3 1  ON 56
ci_58                -1.157776e-03 3 1  ON 57
ci_59                -1.430386e-03 3 1  ON 58
ci_60                 1.748766e-04 3 1  ON 59
ci_61                -2.371363e-04 3 1  ON 60
ci_62                -5.527180e-04 3 1  ON 61
ci_63                -6.340120e-04 3 1  ON 62
ci_64                -3.464448e-04 3 1  ON 63
ci_65                 8.430063e-06 3 1  ON 64
ci_66                -6.622185e-04 3 1  ON 65
ci_67                -8.560994e-04 3 1  ON 66
ci_68                -1.184236e-03 3 1  ON 67
ci_69                 9.218378e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8326
    reference variance = 0.387522
====================================================
  Execution time = 2.6442e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5486e-01
  Total weights = 1.9644e+06
  Execution time = 3.4953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437194570433
                                         uncertainty =       0.001823181521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437194570433
                                         uncertainty =       0.001823181521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467573304
  error estimate for blocks of size 2^( 2) =       0.000492941047
  error estimate for blocks of size 2^( 3) =       0.000516716487
  error estimate for blocks of size 2^( 4) =       0.000534452645
  error estimate for blocks of size 2^( 5) =       0.000545801505
  error estimate for blocks of size 2^( 6) =       0.000551258216
  error estimate for blocks of size 2^( 7) =       0.000553967314

      target function =      -0.741330441551
              le_mean =     -22.814917369472
             les_mean =     520.975311637121
             stat err =       0.000546369920
             autocorr =       1.365444804025
   target nu stat err =       0.000546369920
   target dn stat err =       0.004836808845
      target stat err =       0.004011997587
              std dev =       0.661248507469
             le_variance =       0.437249588630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437194569099
                                         uncertainty =       0.001823181392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437194569099
                                         uncertainty =       0.001823181392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467573303
  error estimate for blocks of size 2^( 2) =       0.000492941047
  error estimate for blocks of size 2^( 3) =       0.000516716488
  error estimate for blocks of size 2^( 4) =       0.000534452647
  error estimate for blocks of size 2^( 5) =       0.000545801507
  error estimate for blocks of size 2^( 6) =       0.000551258218
  error estimate for blocks of size 2^( 7) =       0.000553967316

      target function =      -0.741330699840
              le_mean =     -22.814917369748
             les_mean =     520.975311334858
             stat err =       0.000546369922
             autocorr =       1.365444818301
   target nu stat err =       0.000546369922
   target dn stat err =       0.004836792532
      target stat err =       0.004011987127
              std dev =       0.661248506459
             le_variance =       0.437249587294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437194569766
                                         uncertainty =       0.001823181457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437194569766
                                         uncertainty =       0.001823181457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467573303
  error estimate for blocks of size 2^( 2) =       0.000492941047
  error estimate for blocks of size 2^( 3) =       0.000516716487
  error estimate for blocks of size 2^( 4) =       0.000534452646
  error estimate for blocks of size 2^( 5) =       0.000545801506
  error estimate for blocks of size 2^( 6) =       0.000551258217
  error estimate for blocks of size 2^( 7) =       0.000553967315

      target function =      -0.741330570790
              le_mean =     -22.814917369610
             les_mean =     520.975311485874
             stat err =       0.000546369921
             autocorr =       1.365444811166
   target nu stat err =       0.000546369921
   target dn stat err =       0.004836800683
      target stat err =       0.004011992354
              std dev =       0.661248506964
             le_variance =       0.437249587962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437194570349
                                         uncertainty =       0.001823181513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437194570349
                                         uncertainty =       0.001823181513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467573304
  error estimate for blocks of size 2^( 2) =       0.000492941047
  error estimate for blocks of size 2^( 3) =       0.000516716487
  error estimate for blocks of size 2^( 4) =       0.000534452645
  error estimate for blocks of size 2^( 5) =       0.000545801505
  error estimate for blocks of size 2^( 6) =       0.000551258216
  error estimate for blocks of size 2^( 7) =       0.000553967314

      target function =      -0.741330457716
              le_mean =     -22.814917369489
             les_mean =     520.975311618203
             stat err =       0.000546369920
             autocorr =       1.365444804920
   target nu stat err =       0.000546369920
   target dn stat err =       0.004836807824
      target stat err =       0.004011996932
              std dev =       0.661248507406
             le_variance =       0.437249588546


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741330441551        initial
     5.9605e+03     5.9605e+04             2.6686e-08        -0.741330699840  <--
     2.3842e+04     2.3842e+05             6.6716e-09        -0.741330570790
     9.5367e+04     9.5367e+05             1.6679e-09        -0.741330457716

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 4.3951e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.264977e-01 3 1  ON 0
ci_02                -2.871697e-02 3 1  ON 1
ci_03                -2.856565e-02 3 1  ON 2
ci_04                 2.661109e-02 3 1  ON 3
ci_05                -2.187442e-02 3 1  ON 4
ci_06                -2.154237e-02 3 1  ON 5
ci_07                 2.710063e-02 3 1  ON 6
ci_08                -5.456659e-03 3 1  ON 7
ci_09                -8.841379e-03 3 1  ON 8
ci_10                -8.366161e-03 3 1  ON 9
ci_11                 1.311118e-02 3 1  ON 10
ci_12                 6.947946e-03 3 1  ON 11
ci_13                 1.303840e-02 3 1  ON 12
ci_14                 1.252699e-02 3 1  ON 13
ci_15                 6.372979e-03 3 1  ON 14
ci_16                 6.263236e-03 3 1  ON 15
ci_17                -7.197735e-03 3 1  ON 16
ci_18                -6.024861e-03 3 1  ON 17
ci_19                 9.258727e-03 3 1  ON 18
ci_20                 6.518114e-03 3 1  ON 19
ci_21                 8.966537e-03 3 1  ON 20
ci_22                 8.289966e-03 3 1  ON 21
ci_23                 4.852290e-03 3 1  ON 22
ci_24                 4.085850e-03 3 1  ON 23
ci_25                 2.863632e-03 3 1  ON 24
ci_26                 3.084444e-03 3 1  ON 25
ci_27                 3.185066e-03 3 1  ON 26
ci_28                 1.755122e-03 3 1  ON 27
ci_29                 1.455492e-03 3 1  ON 28
ci_30                -1.778000e-03 3 1  ON 29
ci_31                -4.941871e-04 3 1  ON 30
ci_32                -9.474935e-04 3 1  ON 31
ci_33                -1.370420e-03 3 1  ON 32
ci_34                 1.097542e-03 3 1  ON 33
ci_35                 1.541619e-03 3 1  ON 34
ci_36                -1.076816e-03 3 1  ON 35
ci_37                -1.050108e-03 3 1  ON 36
ci_38                -6.338103e-04 3 1  ON 37
ci_39                -6.038735e-04 3 1  ON 38
ci_40                -1.528286e-03 3 1  ON 39
ci_41                -1.187690e-03 3 1  ON 40
ci_42                -1.175809e-03 3 1  ON 41
ci_43                -2.260236e-03 3 1  ON 42
ci_44                -2.994328e-03 3 1  ON 43
ci_45                -5.583266e-04 3 1  ON 44
ci_46                -7.370974e-04 3 1  ON 45
ci_47                 1.562063e-03 3 1  ON 46
ci_48                 1.419278e-03 3 1  ON 47
ci_49                -9.593803e-04 3 1  ON 48
ci_50                -7.632015e-04 3 1  ON 49
ci_51                 1.270973e-04 3 1  ON 50
ci_52                 1.810420e-04 3 1  ON 51
ci_53                -7.051484e-04 3 1  ON 52
ci_54                -1.079738e-03 3 1  ON 53
ci_55                -6.624326e-04 3 1  ON 54
ci_56                 2.501015e-03 3 1  ON 55
ci_57                 1.713596e-03 3 1  ON 56
ci_58                -1.157770e-03 3 1  ON 57
ci_59                -1.430388e-03 3 1  ON 58
ci_60                 1.748712e-04 3 1  ON 59
ci_61                -2.371410e-04 3 1  ON 60
ci_62                -5.527168e-04 3 1  ON 61
ci_63                -6.340141e-04 3 1  ON 62
ci_64                -3.464422e-04 3 1  ON 63
ci_65                 8.428591e-06 3 1  ON 64
ci_66                -6.622206e-04 3 1  ON 65
ci_67                -8.560947e-04 3 1  ON 66
ci_68                -1.184236e-03 3 1  ON 67
ci_69                 9.217476e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6276e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2805e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8003
    reference variance = 0.476874
====================================================
  Execution time = 2.8011e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5358e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4957e-01
  Total weights = 1.964248555e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4588e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435984687988
                                         uncertainty =       0.002194866829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435984687988
                                         uncertainty =       0.002194866829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466890599
  error estimate for blocks of size 2^( 2) =       0.000492258815
  error estimate for blocks of size 2^( 3) =       0.000516058385
  error estimate for blocks of size 2^( 4) =       0.000533332861
  error estimate for blocks of size 2^( 5) =       0.000544102728
  error estimate for blocks of size 2^( 6) =       0.000549948744
  error estimate for blocks of size 2^( 7) =       0.000554199572

      target function =      -0.745705901342
              le_mean =     -22.814705686696
             les_mean =     520.960363336252
             stat err =       0.000545395976
             autocorr =       1.364563025193
   target nu stat err =       0.000545395976
   target dn stat err =       0.003082696374
      target stat err =       0.002627887795
              std dev =       0.660283017912
             le_variance =       0.435973663743


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281470568670e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745714204087       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745714212714       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745714214340       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745714214531       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745714214548       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745714214588       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745714214578       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745714214576       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745714214575       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+03 is 1.232373e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745714204087       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745714206244       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745714206650       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745714206698       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745714206707       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745714206715       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745714206711       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745714206709       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745714206711       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+03 is 3.080998e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745714204087       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745714204626       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745714204728       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745714204740       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745714204729       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745714204738       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745714204775       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745714204709       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745714204779       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+04 is 7.702535e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104334 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2479e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.264977e-01 3 1  ON 0
ci_02                -2.871697e-02 3 1  ON 1
ci_03                -2.856565e-02 3 1  ON 2
ci_04                 2.661108e-02 3 1  ON 3
ci_05                -2.187440e-02 3 1  ON 4
ci_06                -2.154239e-02 3 1  ON 5
ci_07                 2.710062e-02 3 1  ON 6
ci_08                -5.456652e-03 3 1  ON 7
ci_09                -8.841348e-03 3 1  ON 8
ci_10                -8.366148e-03 3 1  ON 9
ci_11                 1.311118e-02 3 1  ON 10
ci_12                 6.947937e-03 3 1  ON 11
ci_13                 1.303839e-02 3 1  ON 12
ci_14                 1.252699e-02 3 1  ON 13
ci_15                 6.372980e-03 3 1  ON 14
ci_16                 6.263231e-03 3 1  ON 15
ci_17                -7.197730e-03 3 1  ON 16
ci_18                -6.024868e-03 3 1  ON 17
ci_19                 9.258733e-03 3 1  ON 18
ci_20                 6.518108e-03 3 1  ON 19
ci_21                 8.966536e-03 3 1  ON 20
ci_22                 8.289956e-03 3 1  ON 21
ci_23                 4.852292e-03 3 1  ON 22
ci_24                 4.085851e-03 3 1  ON 23
ci_25                 2.863644e-03 3 1  ON 24
ci_26                 3.084446e-03 3 1  ON 25
ci_27                 3.185052e-03 3 1  ON 26
ci_28                 1.755125e-03 3 1  ON 27
ci_29                 1.455493e-03 3 1  ON 28
ci_30                -1.777988e-03 3 1  ON 29
ci_31                -4.941848e-04 3 1  ON 30
ci_32                -9.474954e-04 3 1  ON 31
ci_33                -1.370415e-03 3 1  ON 32
ci_34                 1.097545e-03 3 1  ON 33
ci_35                 1.541613e-03 3 1  ON 34
ci_36                -1.076827e-03 3 1  ON 35
ci_37                -1.050110e-03 3 1  ON 36
ci_38                -6.338060e-04 3 1  ON 37
ci_39                -6.038714e-04 3 1  ON 38
ci_40                -1.528289e-03 3 1  ON 39
ci_41                -1.187684e-03 3 1  ON 40
ci_42                -1.175811e-03 3 1  ON 41
ci_43                -2.260232e-03 3 1  ON 42
ci_44                -2.994312e-03 3 1  ON 43
ci_45                -5.583300e-04 3 1  ON 44
ci_46                -7.370967e-04 3 1  ON 45
ci_47                 1.562076e-03 3 1  ON 46
ci_48                 1.419286e-03 3 1  ON 47
ci_49                -9.593779e-04 3 1  ON 48
ci_50                -7.632028e-04 3 1  ON 49
ci_51                 1.270942e-04 3 1  ON 50
ci_52                 1.810443e-04 3 1  ON 51
ci_53                -7.051439e-04 3 1  ON 52
ci_54                -1.079738e-03 3 1  ON 53
ci_55                -6.624209e-04 3 1  ON 54
ci_56                 2.501007e-03 3 1  ON 55
ci_57                 1.713600e-03 3 1  ON 56
ci_58                -1.157761e-03 3 1  ON 57
ci_59                -1.430385e-03 3 1  ON 58
ci_60                 1.748781e-04 3 1  ON 59
ci_61                -2.371570e-04 3 1  ON 60
ci_62                -5.527102e-04 3 1  ON 61
ci_63                -6.340067e-04 3 1  ON 62
ci_64                -3.464378e-04 3 1  ON 63
ci_65                 8.422663e-06 3 1  ON 64
ci_66                -6.622208e-04 3 1  ON 65
ci_67                -8.560941e-04 3 1  ON 66
ci_68                -1.184238e-03 3 1  ON 67
ci_69                 9.216627e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7477
    reference variance = 0.260701
====================================================
  Execution time = 2.5304e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4888e-01
  Total weights = 1.9645e+06
  Execution time = 3.4846e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435804129229
                                         uncertainty =       0.002242577070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435804129229
                                         uncertainty =       0.002242577070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466819201
  error estimate for blocks of size 2^( 2) =       0.000492289923
  error estimate for blocks of size 2^( 3) =       0.000516271212
  error estimate for blocks of size 2^( 4) =       0.000534257685
  error estimate for blocks of size 2^( 5) =       0.000545788314
  error estimate for blocks of size 2^( 6) =       0.000552646456
  error estimate for blocks of size 2^( 7) =       0.000556329239

      target function =      -0.746275075777
              le_mean =     -22.814288134673
             les_mean =     520.940628201214
             stat err =       0.000547255424
             autocorr =       1.374303736476
   target nu stat err =       0.000547255424
   target dn stat err =       0.002515587944
      target stat err =       0.002175329420
              std dev =       0.660182044821
             le_variance =       0.435840332305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435804126827
                                         uncertainty =       0.002242576643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435804126827
                                         uncertainty =       0.002242576643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466819199
  error estimate for blocks of size 2^( 2) =       0.000492289924
  error estimate for blocks of size 2^( 3) =       0.000516271215
  error estimate for blocks of size 2^( 4) =       0.000534257689
  error estimate for blocks of size 2^( 5) =       0.000545788318
  error estimate for blocks of size 2^( 6) =       0.000552646459
  error estimate for blocks of size 2^( 7) =       0.000556329241

      target function =      -0.746276638848
              le_mean =     -22.814288134538
             les_mean =     520.940626312405
             stat err =       0.000547255427
             autocorr =       1.374303758952
   target nu stat err =       0.000547255427
   target dn stat err =       0.002515556505
      target stat err =       0.002175313118
              std dev =       0.660182043043
             le_variance =       0.435840329956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435804128028
                                         uncertainty =       0.002242576856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435804128028
                                         uncertainty =       0.002242576856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466819200
  error estimate for blocks of size 2^( 2) =       0.000492289924
  error estimate for blocks of size 2^( 3) =       0.000516271214
  error estimate for blocks of size 2^( 4) =       0.000534257687
  error estimate for blocks of size 2^( 5) =       0.000545788316
  error estimate for blocks of size 2^( 6) =       0.000552646457
  error estimate for blocks of size 2^( 7) =       0.000556329240

      target function =      -0.746275872363
              le_mean =     -22.814288134606
             les_mean =     520.940627238689
             stat err =       0.000547255425
             autocorr =       1.374303747718
   target nu stat err =       0.000547255425
   target dn stat err =       0.002515571750
      target stat err =       0.002175320975
              std dev =       0.660182043932
             le_variance =       0.435840331130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435804129079
                                         uncertainty =       0.002242577043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435804129079
                                         uncertainty =       0.002242577043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466819201
  error estimate for blocks of size 2^( 2) =       0.000492289923
  error estimate for blocks of size 2^( 3) =       0.000516271212
  error estimate for blocks of size 2^( 4) =       0.000534257685
  error estimate for blocks of size 2^( 5) =       0.000545788314
  error estimate for blocks of size 2^( 6) =       0.000552646456
  error estimate for blocks of size 2^( 7) =       0.000556329239

      target function =      -0.746275177048
              le_mean =     -22.814288134665
             les_mean =     520.940628078854
             stat err =       0.000547255424
             autocorr =       1.374303737887
   target nu stat err =       0.000547255424
   target dn stat err =       0.002515585865
      target stat err =       0.002175328330
              std dev =       0.660182044710
             le_variance =       0.435840332158


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746275075777        initial
     1.4901e+03     1.4901e+04             1.2324e-07        -0.746276638848  <--
     5.9605e+03     5.9605e+04             3.0810e-08        -0.746275872363
     2.3842e+04     2.3842e+05             7.7025e-09        -0.746275177048

*****************************************************************************
Applying the update for shift_i =   1.4901e+03     and shift_s =   1.4901e+04
*****************************************************************************

  Execution time = 4.2761e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.264976e-01 3 1  ON 0
ci_02                -2.871698e-02 3 1  ON 1
ci_03                -2.856566e-02 3 1  ON 2
ci_04                 2.661107e-02 3 1  ON 3
ci_05                -2.187433e-02 3 1  ON 4
ci_06                -2.154243e-02 3 1  ON 5
ci_07                 2.710058e-02 3 1  ON 6
ci_08                -5.456628e-03 3 1  ON 7
ci_09                -8.841255e-03 3 1  ON 8
ci_10                -8.366112e-03 3 1  ON 9
ci_11                 1.311119e-02 3 1  ON 10
ci_12                 6.947911e-03 3 1  ON 11
ci_13                 1.303837e-02 3 1  ON 12
ci_14                 1.252698e-02 3 1  ON 13
ci_15                 6.372984e-03 3 1  ON 14
ci_16                 6.263213e-03 3 1  ON 15
ci_17                -7.197717e-03 3 1  ON 16
ci_18                -6.024888e-03 3 1  ON 17
ci_19                 9.258752e-03 3 1  ON 18
ci_20                 6.518090e-03 3 1  ON 19
ci_21                 8.966534e-03 3 1  ON 20
ci_22                 8.289928e-03 3 1  ON 21
ci_23                 4.852298e-03 3 1  ON 22
ci_24                 4.085857e-03 3 1  ON 23
ci_25                 2.863682e-03 3 1  ON 24
ci_26                 3.084451e-03 3 1  ON 25
ci_27                 3.185011e-03 3 1  ON 26
ci_28                 1.755133e-03 3 1  ON 27
ci_29                 1.455497e-03 3 1  ON 28
ci_30                -1.777953e-03 3 1  ON 29
ci_31                -4.941780e-04 3 1  ON 30
ci_32                -9.475009e-04 3 1  ON 31
ci_33                -1.370401e-03 3 1  ON 32
ci_34                 1.097555e-03 3 1  ON 33
ci_35                 1.541595e-03 3 1  ON 34
ci_36                -1.076858e-03 3 1  ON 35
ci_37                -1.050115e-03 3 1  ON 36
ci_38                -6.337930e-04 3 1  ON 37
ci_39                -6.038651e-04 3 1  ON 38
ci_40                -1.528299e-03 3 1  ON 39
ci_41                -1.187667e-03 3 1  ON 40
ci_42                -1.175816e-03 3 1  ON 41
ci_43                -2.260221e-03 3 1  ON 42
ci_44                -2.994265e-03 3 1  ON 43
ci_45                -5.583403e-04 3 1  ON 44
ci_46                -7.370945e-04 3 1  ON 45
ci_47                 1.562114e-03 3 1  ON 46
ci_48                 1.419309e-03 3 1  ON 47
ci_49                -9.593706e-04 3 1  ON 48
ci_50                -7.632069e-04 3 1  ON 49
ci_51                 1.270849e-04 3 1  ON 50
ci_52                 1.810510e-04 3 1  ON 51
ci_53                -7.051303e-04 3 1  ON 52
ci_54                -1.079740e-03 3 1  ON 53
ci_55                -6.623855e-04 3 1  ON 54
ci_56                 2.500985e-03 3 1  ON 55
ci_57                 1.713613e-03 3 1  ON 56
ci_58                -1.157736e-03 3 1  ON 57
ci_59                -1.430378e-03 3 1  ON 58
ci_60                 1.748990e-04 3 1  ON 59
ci_61                -2.372050e-04 3 1  ON 60
ci_62                -5.526904e-04 3 1  ON 61
ci_63                -6.339844e-04 3 1  ON 62
ci_64                -3.464247e-04 3 1  ON 63
ci_65                 8.404879e-06 3 1  ON 64
ci_66                -6.622215e-04 3 1  ON 65
ci_67                -8.560923e-04 3 1  ON 66
ci_68                -1.184242e-03 3 1  ON 67
ci_69                 9.214079e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5267e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2804e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7179
    reference variance = 0.303524
====================================================
  Execution time = 2.5873e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5365e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4785e-01
  Total weights = 1.964403840e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433760313173
                                         uncertainty =       0.001957864562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433760313173
                                         uncertainty =       0.001957864562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465712719
  error estimate for blocks of size 2^( 2) =       0.000491232559
  error estimate for blocks of size 2^( 3) =       0.000515183528
  error estimate for blocks of size 2^( 4) =       0.000533287527
  error estimate for blocks of size 2^( 5) =       0.000545348537
  error estimate for blocks of size 2^( 6) =       0.000550836291
  error estimate for blocks of size 2^( 7) =       0.000555147720

      target function =      -0.747136135546
              le_mean =     -22.814340477813
             les_mean =     520.941980187230
             stat err =       0.000546155019
             autocorr =       1.375294351031
   target nu stat err =       0.000546155019
   target dn stat err =       0.002603742129
      target stat err =       0.002250522745
              std dev =       0.658617243792
             le_variance =       0.433776673820


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281434047781e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747141921074       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747141945942       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747141949298       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747141950087       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747141950110       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747141950215       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747141950169       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747141950185       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747141950166       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 4.482460e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747141921074       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747141927292       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747141928131       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747141928328       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747141928334       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747141928359       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747141928349       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747141928353       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747141928348       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+03 is 1.120710e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747141921074       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747141922629       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747141922839       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747141922888       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747141922889       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747141922896       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747141922893       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747141922893       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747141922891       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+03 is 2.801835e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107379 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0388e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.264975e-01 3 1  ON 0
ci_02                -2.871696e-02 3 1  ON 1
ci_03                -2.856564e-02 3 1  ON 2
ci_04                 2.661099e-02 3 1  ON 3
ci_05                -2.187422e-02 3 1  ON 4
ci_06                -2.154244e-02 3 1  ON 5
ci_07                 2.710055e-02 3 1  ON 6
ci_08                -5.456632e-03 3 1  ON 7
ci_09                -8.841209e-03 3 1  ON 8
ci_10                -8.366082e-03 3 1  ON 9
ci_11                 1.311120e-02 3 1  ON 10
ci_12                 6.947903e-03 3 1  ON 11
ci_13                 1.303836e-02 3 1  ON 12
ci_14                 1.252695e-02 3 1  ON 13
ci_15                 6.372958e-03 3 1  ON 14
ci_16                 6.263189e-03 3 1  ON 15
ci_17                -7.197676e-03 3 1  ON 16
ci_18                -6.024926e-03 3 1  ON 17
ci_19                 9.258776e-03 3 1  ON 18
ci_20                 6.518089e-03 3 1  ON 19
ci_21                 8.966513e-03 3 1  ON 20
ci_22                 8.289989e-03 3 1  ON 21
ci_23                 4.852276e-03 3 1  ON 22
ci_24                 4.085896e-03 3 1  ON 23
ci_25                 2.863677e-03 3 1  ON 24
ci_26                 3.084477e-03 3 1  ON 25
ci_27                 3.184984e-03 3 1  ON 26
ci_28                 1.755156e-03 3 1  ON 27
ci_29                 1.455509e-03 3 1  ON 28
ci_30                -1.777944e-03 3 1  ON 29
ci_31                -4.942007e-04 3 1  ON 30
ci_32                -9.474995e-04 3 1  ON 31
ci_33                -1.370411e-03 3 1  ON 32
ci_34                 1.097586e-03 3 1  ON 33
ci_35                 1.541648e-03 3 1  ON 34
ci_36                -1.076866e-03 3 1  ON 35
ci_37                -1.050095e-03 3 1  ON 36
ci_38                -6.337814e-04 3 1  ON 37
ci_39                -6.038428e-04 3 1  ON 38
ci_40                -1.528286e-03 3 1  ON 39
ci_41                -1.187675e-03 3 1  ON 40
ci_42                -1.175808e-03 3 1  ON 41
ci_43                -2.260166e-03 3 1  ON 42
ci_44                -2.994258e-03 3 1  ON 43
ci_45                -5.583093e-04 3 1  ON 44
ci_46                -7.371006e-04 3 1  ON 45
ci_47                 1.562166e-03 3 1  ON 46
ci_48                 1.419321e-03 3 1  ON 47
ci_49                -9.593696e-04 3 1  ON 48
ci_50                -7.632072e-04 3 1  ON 49
ci_51                 1.270816e-04 3 1  ON 50
ci_52                 1.810566e-04 3 1  ON 51
ci_53                -7.051284e-04 3 1  ON 52
ci_54                -1.079710e-03 3 1  ON 53
ci_55                -6.623815e-04 3 1  ON 54
ci_56                 2.500985e-03 3 1  ON 55
ci_57                 1.713596e-03 3 1  ON 56
ci_58                -1.157750e-03 3 1  ON 57
ci_59                -1.430402e-03 3 1  ON 58
ci_60                 1.749172e-04 3 1  ON 59
ci_61                -2.372462e-04 3 1  ON 60
ci_62                -5.526955e-04 3 1  ON 61
ci_63                -6.339794e-04 3 1  ON 62
ci_64                -3.464221e-04 3 1  ON 63
ci_65                 8.407918e-06 3 1  ON 64
ci_66                -6.621983e-04 3 1  ON 65
ci_67                -8.560911e-04 3 1  ON 66
ci_68                -1.184214e-03 3 1  ON 67
ci_69                 9.207761e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8347
    reference variance = 0.29448
====================================================
  Execution time = 2.5300e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4680e-01
  Total weights = 1.9642e+06
  Execution time = 3.4846e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433461214132
                                         uncertainty =       0.002240913269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433461214132
                                         uncertainty =       0.002240913269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465553289
  error estimate for blocks of size 2^( 2) =       0.000491043867
  error estimate for blocks of size 2^( 3) =       0.000515145004
  error estimate for blocks of size 2^( 4) =       0.000532321241
  error estimate for blocks of size 2^( 5) =       0.000542840470
  error estimate for blocks of size 2^( 6) =       0.000548906190
  error estimate for blocks of size 2^( 7) =       0.000551462665

      target function =      -0.748010509898
              le_mean =     -22.814278961632
             les_mean =     520.938120438756
             stat err =       0.000543882641
             autocorr =       1.364808117760
   target nu stat err =       0.000543882641
   target dn stat err =       0.003073436502
      target stat err =       0.002634136691
              std dev =       0.658391775966
             le_variance =       0.433479730660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433461165210
                                         uncertainty =       0.002240904754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433461165210
                                         uncertainty =       0.002240904754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465553263
  error estimate for blocks of size 2^( 2) =       0.000491043856
  error estimate for blocks of size 2^( 3) =       0.000515145006
  error estimate for blocks of size 2^( 4) =       0.000532321254
  error estimate for blocks of size 2^( 5) =       0.000542840493
  error estimate for blocks of size 2^( 6) =       0.000548906215
  error estimate for blocks of size 2^( 7) =       0.000551462701

      target function =      -0.748010721716
              le_mean =     -22.814278961652
             les_mean =     520.938120185981
             stat err =       0.000543882666
             autocorr =       1.364808393009
   target nu stat err =       0.000543882666
   target dn stat err =       0.003073392474
      target stat err =       0.002634102414
              std dev =       0.658391739196
             le_variance =       0.433479682242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433461189665
                                         uncertainty =       0.002240909011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433461189665
                                         uncertainty =       0.002240909011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465553276
  error estimate for blocks of size 2^( 2) =       0.000491043862
  error estimate for blocks of size 2^( 3) =       0.000515145005
  error estimate for blocks of size 2^( 4) =       0.000532321248
  error estimate for blocks of size 2^( 5) =       0.000542840482
  error estimate for blocks of size 2^( 6) =       0.000548906202
  error estimate for blocks of size 2^( 7) =       0.000551462683

      target function =      -0.748010616242
              le_mean =     -22.814278961642
             les_mean =     520.938120311832
             stat err =       0.000543882654
             autocorr =       1.364808255409
   target nu stat err =       0.000543882654
   target dn stat err =       0.003073414473
      target stat err =       0.002634119544
              std dev =       0.658391757577
             le_variance =       0.433479706446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433461211073
                                         uncertainty =       0.002240912737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433461211073
                                         uncertainty =       0.002240912737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465553288
  error estimate for blocks of size 2^( 2) =       0.000491043866
  error estimate for blocks of size 2^( 3) =       0.000515145004
  error estimate for blocks of size 2^( 4) =       0.000532321242
  error estimate for blocks of size 2^( 5) =       0.000542840472
  error estimate for blocks of size 2^( 6) =       0.000548906191
  error estimate for blocks of size 2^( 7) =       0.000551462667

      target function =      -0.748010523237
              le_mean =     -22.814278961633
             les_mean =     520.938120422833
             stat err =       0.000543882643
             autocorr =       1.364808134965
   target nu stat err =       0.000543882643
   target dn stat err =       0.003073433747
      target stat err =       0.002634134547
              std dev =       0.658391773667
             le_variance =       0.433479727633


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748010509898        initial
     3.7253e+02     3.7253e+03             4.4825e-07        -0.748010721716  <--
     1.4901e+03     1.4901e+04             1.1207e-07        -0.748010616242
     5.9605e+03     5.9605e+04             2.8018e-08        -0.748010523237

*****************************************************************************
Applying the update for shift_i =   3.7253e+02     and shift_s =   3.7253e+03
*****************************************************************************

  Execution time = 4.2753e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.264973e-01 3 1  ON 0
ci_02                -2.871693e-02 3 1  ON 1
ci_03                -2.856561e-02 3 1  ON 2
ci_04                 2.661074e-02 3 1  ON 3
ci_05                -2.187389e-02 3 1  ON 4
ci_06                -2.154250e-02 3 1  ON 5
ci_07                 2.710045e-02 3 1  ON 6
ci_08                -5.456646e-03 3 1  ON 7
ci_09                -8.841070e-03 3 1  ON 8
ci_10                -8.365991e-03 3 1  ON 9
ci_11                 1.311124e-02 3 1  ON 10
ci_12                 6.947879e-03 3 1  ON 11
ci_13                 1.303833e-02 3 1  ON 12
ci_14                 1.252686e-02 3 1  ON 13
ci_15                 6.372879e-03 3 1  ON 14
ci_16                 6.263117e-03 3 1  ON 15
ci_17                -7.197552e-03 3 1  ON 16
ci_18                -6.025038e-03 3 1  ON 17
ci_19                 9.258845e-03 3 1  ON 18
ci_20                 6.518086e-03 3 1  ON 19
ci_21                 8.966452e-03 3 1  ON 20
ci_22                 8.290172e-03 3 1  ON 21
ci_23                 4.852210e-03 3 1  ON 22
ci_24                 4.086014e-03 3 1  ON 23
ci_25                 2.863662e-03 3 1  ON 24
ci_26                 3.084558e-03 3 1  ON 25
ci_27                 3.184901e-03 3 1  ON 26
ci_28                 1.755224e-03 3 1  ON 27
ci_29                 1.455545e-03 3 1  ON 28
ci_30                -1.777917e-03 3 1  ON 29
ci_31                -4.942686e-04 3 1  ON 30
ci_32                -9.474953e-04 3 1  ON 31
ci_33                -1.370440e-03 3 1  ON 32
ci_34                 1.097679e-03 3 1  ON 33
ci_35                 1.541808e-03 3 1  ON 34
ci_36                -1.076889e-03 3 1  ON 35
ci_37                -1.050035e-03 3 1  ON 36
ci_38                -6.337467e-04 3 1  ON 37
ci_39                -6.037759e-04 3 1  ON 38
ci_40                -1.528250e-03 3 1  ON 39
ci_41                -1.187698e-03 3 1  ON 40
ci_42                -1.175781e-03 3 1  ON 41
ci_43                -2.260002e-03 3 1  ON 42
ci_44                -2.994236e-03 3 1  ON 43
ci_45                -5.582164e-04 3 1  ON 44
ci_46                -7.371187e-04 3 1  ON 45
ci_47                 1.562320e-03 3 1  ON 46
ci_48                 1.419356e-03 3 1  ON 47
ci_49                -9.593666e-04 3 1  ON 48
ci_50                -7.632082e-04 3 1  ON 49
ci_51                 1.270715e-04 3 1  ON 50
ci_52                 1.810734e-04 3 1  ON 51
ci_53                -7.051227e-04 3 1  ON 52
ci_54                -1.079619e-03 3 1  ON 53
ci_55                -6.623697e-04 3 1  ON 54
ci_56                 2.500986e-03 3 1  ON 55
ci_57                 1.713545e-03 3 1  ON 56
ci_58                -1.157790e-03 3 1  ON 57
ci_59                -1.430475e-03 3 1  ON 58
ci_60                 1.749718e-04 3 1  ON 59
ci_61                -2.373697e-04 3 1  ON 60
ci_62                -5.527108e-04 3 1  ON 61
ci_63                -6.339644e-04 3 1  ON 62
ci_64                -3.464142e-04 3 1  ON 63
ci_65                 8.417033e-06 3 1  ON 64
ci_66                -6.621287e-04 3 1  ON 65
ci_67                -8.560874e-04 3 1  ON 66
ci_68                -1.184132e-03 3 1  ON 67
ci_69                 9.188810e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3177e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2803e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.7984
    reference variance = 0.370353
====================================================
  Execution time = 2.9810e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4811e-01
  Total weights = 1.964426798e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435147166565
                                         uncertainty =       0.003636466203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435147166565
                                         uncertainty =       0.003636466203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466396250
  error estimate for blocks of size 2^( 2) =       0.000492059336
  error estimate for blocks of size 2^( 3) =       0.000516509311
  error estimate for blocks of size 2^( 4) =       0.000533893462
  error estimate for blocks of size 2^( 5) =       0.000545318200
  error estimate for blocks of size 2^( 6) =       0.000552819831
  error estimate for blocks of size 2^( 7) =       0.000558335933

      target function =      -0.746902537443
              le_mean =     -22.813872632364
             les_mean =     520.920898277933
             stat err =       0.000547591857
             autocorr =       1.378490766609
   target nu stat err =       0.000547591857
   target dn stat err =       0.004414840778
      target stat err =       0.003719338865
              std dev =       0.659583902735
             le_variance =       0.435050924747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281387263236e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746920167137       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746920389269       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746920409181       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746920416060       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746920420356       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746920421398       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746920421694       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746920421599       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746920421574       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746920421580       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 3.035936e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746920167137       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746920222692       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746920227671       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746920229391       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746920230465       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746920230725       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746920230798       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746920230776       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746920230768       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746920230770       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 7.591356e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746920167137       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746920181027       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746920182272       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746920182702       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746920182969       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746920183036       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746920183053       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746920183045       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746920183045       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746920183048       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+03 is 1.897934e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110914 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4322e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.264965e-01 3 1  ON 0
ci_02                -2.871703e-02 3 1  ON 1
ci_03                -2.856560e-02 3 1  ON 2
ci_04                 2.661072e-02 3 1  ON 3
ci_05                -2.187400e-02 3 1  ON 4
ci_06                -2.154235e-02 3 1  ON 5
ci_07                 2.710012e-02 3 1  ON 6
ci_08                -5.456656e-03 3 1  ON 7
ci_09                -8.841042e-03 3 1  ON 8
ci_10                -8.365357e-03 3 1  ON 9
ci_11                 1.311131e-02 3 1  ON 10
ci_12                 6.948075e-03 3 1  ON 11
ci_13                 1.303815e-02 3 1  ON 12
ci_14                 1.252684e-02 3 1  ON 13
ci_15                 6.372884e-03 3 1  ON 14
ci_16                 6.262929e-03 3 1  ON 15
ci_17                -7.197413e-03 3 1  ON 16
ci_18                -6.025292e-03 3 1  ON 17
ci_19                 9.258906e-03 3 1  ON 18
ci_20                 6.517978e-03 3 1  ON 19
ci_21                 8.966363e-03 3 1  ON 20
ci_22                 8.290065e-03 3 1  ON 21
ci_23                 4.851995e-03 3 1  ON 22
ci_24                 4.085944e-03 3 1  ON 23
ci_25                 2.863614e-03 3 1  ON 24
ci_26                 3.084627e-03 3 1  ON 25
ci_27                 3.185029e-03 3 1  ON 26
ci_28                 1.755167e-03 3 1  ON 27
ci_29                 1.455486e-03 3 1  ON 28
ci_30                -1.777698e-03 3 1  ON 29
ci_31                -4.942940e-04 3 1  ON 30
ci_32                -9.474804e-04 3 1  ON 31
ci_33                -1.370616e-03 3 1  ON 32
ci_34                 1.097488e-03 3 1  ON 33
ci_35                 1.541901e-03 3 1  ON 34
ci_36                -1.076787e-03 3 1  ON 35
ci_37                -1.049919e-03 3 1  ON 36
ci_38                -6.336559e-04 3 1  ON 37
ci_39                -6.036326e-04 3 1  ON 38
ci_40                -1.528277e-03 3 1  ON 39
ci_41                -1.187847e-03 3 1  ON 40
ci_42                -1.175426e-03 3 1  ON 41
ci_43                -2.260011e-03 3 1  ON 42
ci_44                -2.994085e-03 3 1  ON 43
ci_45                -5.580892e-04 3 1  ON 44
ci_46                -7.371112e-04 3 1  ON 45
ci_47                 1.562145e-03 3 1  ON 46
ci_48                 1.419345e-03 3 1  ON 47
ci_49                -9.594279e-04 3 1  ON 48
ci_50                -7.632236e-04 3 1  ON 49
ci_51                 1.269845e-04 3 1  ON 50
ci_52                 1.810473e-04 3 1  ON 51
ci_53                -7.052173e-04 3 1  ON 52
ci_54                -1.079691e-03 3 1  ON 53
ci_55                -6.624179e-04 3 1  ON 54
ci_56                 2.500956e-03 3 1  ON 55
ci_57                 1.713631e-03 3 1  ON 56
ci_58                -1.157813e-03 3 1  ON 57
ci_59                -1.430456e-03 3 1  ON 58
ci_60                 1.747243e-04 3 1  ON 59
ci_61                -2.375305e-04 3 1  ON 60
ci_62                -5.526828e-04 3 1  ON 61
ci_63                -6.339348e-04 3 1  ON 62
ci_64                -3.464610e-04 3 1  ON 63
ci_65                 8.284057e-06 3 1  ON 64
ci_66                -6.621606e-04 3 1  ON 65
ci_67                -8.559956e-04 3 1  ON 66
ci_68                -1.184161e-03 3 1  ON 67
ci_69                 9.191338e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8801
    reference variance = 0.425975
====================================================
  Execution time = 2.5337e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4874e-01
  Total weights = 1.9644e+06
  Execution time = 3.4919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436526655630
                                         uncertainty =       0.002077655699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436526655630
                                         uncertainty =       0.002077655699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467205615
  error estimate for blocks of size 2^( 2) =       0.000492798860
  error estimate for blocks of size 2^( 3) =       0.000516598612
  error estimate for blocks of size 2^( 4) =       0.000534253676
  error estimate for blocks of size 2^( 5) =       0.000546111520
  error estimate for blocks of size 2^( 6) =       0.000553252990
  error estimate for blocks of size 2^( 7) =       0.000557072402

      target function =      -0.746392343656
              le_mean =     -22.813958107693
             les_mean =     520.925427399255
             stat err =       0.000547672647
             autocorr =       1.374124223633
   target nu stat err =       0.000547672647
   target dn stat err =       0.002569301529
      target stat err =       0.002217882810
              std dev =       0.660728516760
             le_variance =       0.436562172861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436526596610
                                         uncertainty =       0.002077665620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436526596610
                                         uncertainty =       0.002077665620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467205583
  error estimate for blocks of size 2^( 2) =       0.000492798865
  error estimate for blocks of size 2^( 3) =       0.000516598651
  error estimate for blocks of size 2^( 4) =       0.000534253752
  error estimate for blocks of size 2^( 5) =       0.000546111631
  error estimate for blocks of size 2^( 6) =       0.000553253093
  error estimate for blocks of size 2^( 7) =       0.000557072510

      target function =      -0.746392473154
              le_mean =     -22.813958112291
             les_mean =     520.925427453130
             stat err =       0.000547672747
             autocorr =       1.374124909275
   target nu stat err =       0.000547672747
   target dn stat err =       0.002569283802
      target stat err =       0.002217869447
              std dev =       0.660728472128
             le_variance =       0.436562113881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436526626042
                                         uncertainty =       0.002077660660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436526626042
                                         uncertainty =       0.002077660660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467205599
  error estimate for blocks of size 2^( 2) =       0.000492798863
  error estimate for blocks of size 2^( 3) =       0.000516598631
  error estimate for blocks of size 2^( 4) =       0.000534253714
  error estimate for blocks of size 2^( 5) =       0.000546111576
  error estimate for blocks of size 2^( 6) =       0.000553253042
  error estimate for blocks of size 2^( 7) =       0.000557072456

      target function =      -0.746392427481
              le_mean =     -22.813958109985
             les_mean =     520.925427402898
             stat err =       0.000547672697
             autocorr =       1.374124566665
   target nu stat err =       0.000547672697
   target dn stat err =       0.002569292522
      target stat err =       0.002217876123
              std dev =       0.660728494386
             le_variance =       0.436562143293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436526651923
                                         uncertainty =       0.002077656319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436526651923
                                         uncertainty =       0.002077656319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467205613
  error estimate for blocks of size 2^( 2) =       0.000492798860
  error estimate for blocks of size 2^( 3) =       0.000516598614
  error estimate for blocks of size 2^( 4) =       0.000534253681
  error estimate for blocks of size 2^( 5) =       0.000546111527
  error estimate for blocks of size 2^( 6) =       0.000553252997
  error estimate for blocks of size 2^( 7) =       0.000557072409

      target function =      -0.746392356089
              le_mean =     -22.813958107979
             les_mean =     520.925427397318
             stat err =       0.000547672653
             autocorr =       1.374124266540
   target nu stat err =       0.000547672653
   target dn stat err =       0.002569300387
      target stat err =       0.002217881973
              std dev =       0.660728513957
             le_variance =       0.436562169156


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746392343656        initial
     9.3132e+01     9.3132e+02             3.0359e-06        -0.746392473154  <--
     3.7253e+02     3.7253e+03             7.5914e-07        -0.746392427481
     1.4901e+03     1.4901e+04             1.8979e-07        -0.746392356089

*****************************************************************************
Applying the update for shift_i =   9.3132e+01     and shift_s =   9.3132e+02
*****************************************************************************

  Execution time = 4.2829e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.264943e-01 3 1  ON 0
ci_02                -2.871735e-02 3 1  ON 1
ci_03                -2.856557e-02 3 1  ON 2
ci_04                 2.661063e-02 3 1  ON 3
ci_05                -2.187435e-02 3 1  ON 4
ci_06                -2.154193e-02 3 1  ON 5
ci_07                 2.709910e-02 3 1  ON 6
ci_08                -5.456685e-03 3 1  ON 7
ci_09                -8.840956e-03 3 1  ON 8
ci_10                -8.363457e-03 3 1  ON 9
ci_11                 1.311152e-02 3 1  ON 10
ci_12                 6.948661e-03 3 1  ON 11
ci_13                 1.303762e-02 3 1  ON 12
ci_14                 1.252678e-02 3 1  ON 13
ci_15                 6.372901e-03 3 1  ON 14
ci_16                 6.262364e-03 3 1  ON 15
ci_17                -7.196997e-03 3 1  ON 16
ci_18                -6.026052e-03 3 1  ON 17
ci_19                 9.259087e-03 3 1  ON 18
ci_20                 6.517655e-03 3 1  ON 19
ci_21                 8.966099e-03 3 1  ON 20
ci_22                 8.289745e-03 3 1  ON 21
ci_23                 4.851348e-03 3 1  ON 22
ci_24                 4.085732e-03 3 1  ON 23
ci_25                 2.863471e-03 3 1  ON 24
ci_26                 3.084836e-03 3 1  ON 25
ci_27                 3.185413e-03 3 1  ON 26
ci_28                 1.754997e-03 3 1  ON 27
ci_29                 1.455310e-03 3 1  ON 28
ci_30                -1.777040e-03 3 1  ON 29
ci_31                -4.943701e-04 3 1  ON 30
ci_32                -9.474354e-04 3 1  ON 31
ci_33                -1.371144e-03 3 1  ON 32
ci_34                 1.096917e-03 3 1  ON 33
ci_35                 1.542178e-03 3 1  ON 34
ci_36                -1.076483e-03 3 1  ON 35
ci_37                -1.049569e-03 3 1  ON 36
ci_38                -6.333834e-04 3 1  ON 37
ci_39                -6.032029e-04 3 1  ON 38
ci_40                -1.528358e-03 3 1  ON 39
ci_41                -1.188293e-03 3 1  ON 40
ci_42                -1.174361e-03 3 1  ON 41
ci_43                -2.260037e-03 3 1  ON 42
ci_44                -2.993631e-03 3 1  ON 43
ci_45                -5.577080e-04 3 1  ON 44
ci_46                -7.370885e-04 3 1  ON 45
ci_47                 1.561620e-03 3 1  ON 46
ci_48                 1.419313e-03 3 1  ON 47
ci_49                -9.596120e-04 3 1  ON 48
ci_50                -7.632700e-04 3 1  ON 49
ci_51                 1.267236e-04 3 1  ON 50
ci_52                 1.809690e-04 3 1  ON 51
ci_53                -7.055008e-04 3 1  ON 52
ci_54                -1.079905e-03 3 1  ON 53
ci_55                -6.625625e-04 3 1  ON 54
ci_56                 2.500865e-03 3 1  ON 55
ci_57                 1.713889e-03 3 1  ON 56
ci_58                -1.157883e-03 3 1  ON 57
ci_59                -1.430399e-03 3 1  ON 58
ci_60                 1.739822e-04 3 1  ON 59
ci_61                -2.380130e-04 3 1  ON 60
ci_62                -5.525988e-04 3 1  ON 61
ci_63                -6.338461e-04 3 1  ON 62
ci_64                -3.466014e-04 3 1  ON 63
ci_65                 7.885350e-06 3 1  ON 64
ci_66                -6.622560e-04 3 1  ON 65
ci_67                -8.557202e-04 3 1  ON 66
ci_68                -1.184246e-03 3 1  ON 67
ci_69                 9.198919e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1208e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2804e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8191
    reference variance = 0.408917
====================================================
  Execution time = 3.0659e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4975e-01
  Total weights = 1.964243120e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5453e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436564708409
                                         uncertainty =       0.002289366356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436564708409
                                         uncertainty =       0.002289366356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467180812
  error estimate for blocks of size 2^( 2) =       0.000492354787
  error estimate for blocks of size 2^( 3) =       0.000516286641
  error estimate for blocks of size 2^( 4) =       0.000534320214
  error estimate for blocks of size 2^( 5) =       0.000544841530
  error estimate for blocks of size 2^( 6) =       0.000550831622
  error estimate for blocks of size 2^( 7) =       0.000554663918

      target function =      -0.745557933325
              le_mean =     -22.815153852672
             les_mean =     520.980992797173
             stat err =       0.000546164321
             autocorr =       1.366710898559
   target nu stat err =       0.000546164321
   target dn stat err =       0.002830683232
      target stat err =       0.002425883116
              std dev =       0.660693439837
             le_variance =       0.436515821444


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281515385267e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745564858394       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745565398060       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745565457173       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745565460786       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745565460250       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745565459312       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745565458984       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745565459446       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745565459375       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+01 is 5.266685e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745564858394       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745564993527       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745565008317       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745565009219       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745565009084       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745565008849       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745565008768       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745565008883       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745565008865       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 1.318549e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745564858394       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745564892191       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745564895889       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745564896115       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745564896081       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745564896022       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745564896002       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745564896031       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745564896027       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 3.297548e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113996 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5213e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.264934e-01 3 1  ON 0
ci_02                -2.871603e-02 3 1  ON 1
ci_03                -2.856463e-02 3 1  ON 2
ci_04                 2.660956e-02 3 1  ON 3
ci_05                -2.187514e-02 3 1  ON 4
ci_06                -2.154216e-02 3 1  ON 5
ci_07                 2.709786e-02 3 1  ON 6
ci_08                -5.456392e-03 3 1  ON 7
ci_09                -8.841178e-03 3 1  ON 8
ci_10                -8.363435e-03 3 1  ON 9
ci_11                 1.311046e-02 3 1  ON 10
ci_12                 6.949082e-03 3 1  ON 11
ci_13                 1.303747e-02 3 1  ON 12
ci_14                 1.252655e-02 3 1  ON 13
ci_15                 6.373050e-03 3 1  ON 14
ci_16                 6.262525e-03 3 1  ON 15
ci_17                -7.197503e-03 3 1  ON 16
ci_18                -6.025627e-03 3 1  ON 17
ci_19                 9.258780e-03 3 1  ON 18
ci_20                 6.517444e-03 3 1  ON 19
ci_21                 8.966134e-03 3 1  ON 20
ci_22                 8.289637e-03 3 1  ON 21
ci_23                 4.850935e-03 3 1  ON 22
ci_24                 4.085019e-03 3 1  ON 23
ci_25                 2.863749e-03 3 1  ON 24
ci_26                 3.084891e-03 3 1  ON 25
ci_27                 3.184927e-03 3 1  ON 26
ci_28                 1.754775e-03 3 1  ON 27
ci_29                 1.455683e-03 3 1  ON 28
ci_30                -1.776943e-03 3 1  ON 29
ci_31                -4.945578e-04 3 1  ON 30
ci_32                -9.485106e-04 3 1  ON 31
ci_33                -1.371184e-03 3 1  ON 32
ci_34                 1.097593e-03 3 1  ON 33
ci_35                 1.541315e-03 3 1  ON 34
ci_36                -1.076529e-03 3 1  ON 35
ci_37                -1.049762e-03 3 1  ON 36
ci_38                -6.331168e-04 3 1  ON 37
ci_39                -6.029669e-04 3 1  ON 38
ci_40                -1.528603e-03 3 1  ON 39
ci_41                -1.188073e-03 3 1  ON 40
ci_42                -1.174107e-03 3 1  ON 41
ci_43                -2.260194e-03 3 1  ON 42
ci_44                -2.993913e-03 3 1  ON 43
ci_45                -5.578095e-04 3 1  ON 44
ci_46                -7.368494e-04 3 1  ON 45
ci_47                 1.561223e-03 3 1  ON 46
ci_48                 1.419332e-03 3 1  ON 47
ci_49                -9.600465e-04 3 1  ON 48
ci_50                -7.632693e-04 3 1  ON 49
ci_51                 1.267404e-04 3 1  ON 50
ci_52                 1.809760e-04 3 1  ON 51
ci_53                -7.056961e-04 3 1  ON 52
ci_54                -1.080598e-03 3 1  ON 53
ci_55                -6.624852e-04 3 1  ON 54
ci_56                 2.500639e-03 3 1  ON 55
ci_57                 1.713861e-03 3 1  ON 56
ci_58                -1.158245e-03 3 1  ON 57
ci_59                -1.430177e-03 3 1  ON 58
ci_60                 1.736550e-04 3 1  ON 59
ci_61                -2.377883e-04 3 1  ON 60
ci_62                -5.526811e-04 3 1  ON 61
ci_63                -6.332394e-04 3 1  ON 62
ci_64                -3.472382e-04 3 1  ON 63
ci_65                 7.696042e-06 3 1  ON 64
ci_66                -6.620859e-04 3 1  ON 65
ci_67                -8.554638e-04 3 1  ON 66
ci_68                -1.183694e-03 3 1  ON 67
ci_69                 9.153135e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8938
    reference variance = 0.409917
====================================================
  Execution time = 2.5435e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4503e-01
  Total weights = 1.9643e+06
  Execution time = 3.4869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433230052893
                                         uncertainty =       0.001748054386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433230052893
                                         uncertainty =       0.001748054386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465386131
  error estimate for blocks of size 2^( 2) =       0.000490930977
  error estimate for blocks of size 2^( 3) =       0.000515268719
  error estimate for blocks of size 2^( 4) =       0.000532224944
  error estimate for blocks of size 2^( 5) =       0.000542089041
  error estimate for blocks of size 2^( 6) =       0.000547670874
  error estimate for blocks of size 2^( 7) =       0.000550590866

      target function =      -0.749493452200
              le_mean =     -22.815164418585
             les_mean =     520.976758946053
             stat err =       0.000543143931
             autocorr =       1.362081168590
   target nu stat err =       0.000543143931
   target dn stat err =       0.002368528101
      target stat err =       0.002076781282
              std dev =       0.658155378745
             le_variance =       0.433168502571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433229789022
                                         uncertainty =       0.001748097685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433229789022
                                         uncertainty =       0.001748097685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465385992
  error estimate for blocks of size 2^( 2) =       0.000490931079
  error estimate for blocks of size 2^( 3) =       0.000515269040
  error estimate for blocks of size 2^( 4) =       0.000532225489
  error estimate for blocks of size 2^( 5) =       0.000542089677
  error estimate for blocks of size 2^( 6) =       0.000547671555
  error estimate for blocks of size 2^( 7) =       0.000550591549

      target function =      -0.749495912570
              le_mean =     -22.815164437588
             les_mean =     520.976756879502
             stat err =       0.000543144568
             autocorr =       1.362085177059
   target nu stat err =       0.000543144568
   target dn stat err =       0.002368407201
      target stat err =       0.002076697665
              std dev =       0.658155181358
             le_variance =       0.433168242749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433229919992
                                         uncertainty =       0.001748076045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433229919992
                                         uncertainty =       0.001748076045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465386061
  error estimate for blocks of size 2^( 2) =       0.000490931028
  error estimate for blocks of size 2^( 3) =       0.000515268880
  error estimate for blocks of size 2^( 4) =       0.000532225217
  error estimate for blocks of size 2^( 5) =       0.000542089359
  error estimate for blocks of size 2^( 6) =       0.000547671215
  error estimate for blocks of size 2^( 7) =       0.000550591207

      target function =      -0.749494969692
              le_mean =     -22.815164427964
             les_mean =     520.976757564542
             stat err =       0.000543144250
             autocorr =       1.362083176158
   target nu stat err =       0.000543144250
   target dn stat err =       0.002368467195
      target stat err =       0.002076740632
              std dev =       0.658155279322
             le_variance =       0.433168371699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433230036190
                                         uncertainty =       0.001748057092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433230036190
                                         uncertainty =       0.001748057092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465386123
  error estimate for blocks of size 2^( 2) =       0.000490930984
  error estimate for blocks of size 2^( 3) =       0.000515268739
  error estimate for blocks of size 2^( 4) =       0.000532224978
  error estimate for blocks of size 2^( 5) =       0.000542089080
  error estimate for blocks of size 2^( 6) =       0.000547670917
  error estimate for blocks of size 2^( 7) =       0.000550590908

      target function =      -0.749493924867
              le_mean =     -22.815164419725
             les_mean =     520.976758434374
             stat err =       0.000543143971
             autocorr =       1.362081419637
   target nu stat err =       0.000543143971
   target dn stat err =       0.002368520426
      target stat err =       0.002076777653
              std dev =       0.658155366249
             le_variance =       0.433168486122


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749493452200        initial
     2.3283e+01     2.3283e+02             5.2667e-06        -0.749495912570  <--
     9.3132e+01     9.3132e+02             1.3185e-06        -0.749494969692
     3.7253e+02     3.7253e+03             3.2975e-07        -0.749493924867

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 4.2911e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.264909e-01 3 1  ON 0
ci_02                -2.871208e-02 3 1  ON 1
ci_03                -2.856184e-02 3 1  ON 2
ci_04                 2.660633e-02 3 1  ON 3
ci_05                -2.187749e-02 3 1  ON 4
ci_06                -2.154284e-02 3 1  ON 5
ci_07                 2.709414e-02 3 1  ON 6
ci_08                -5.455515e-03 3 1  ON 7
ci_09                -8.841842e-03 3 1  ON 8
ci_10                -8.363368e-03 3 1  ON 9
ci_11                 1.310727e-02 3 1  ON 10
ci_12                 6.950341e-03 3 1  ON 11
ci_13                 1.303701e-02 3 1  ON 12
ci_14                 1.252587e-02 3 1  ON 13
ci_15                 6.373498e-03 3 1  ON 14
ci_16                 6.263005e-03 3 1  ON 15
ci_17                -7.199018e-03 3 1  ON 16
ci_18                -6.024354e-03 3 1  ON 17
ci_19                 9.257859e-03 3 1  ON 18
ci_20                 6.516815e-03 3 1  ON 19
ci_21                 8.966236e-03 3 1  ON 20
ci_22                 8.289315e-03 3 1  ON 21
ci_23                 4.849698e-03 3 1  ON 22
ci_24                 4.082884e-03 3 1  ON 23
ci_25                 2.864582e-03 3 1  ON 24
ci_26                 3.085054e-03 3 1  ON 25
ci_27                 3.183474e-03 3 1  ON 26
ci_28                 1.754112e-03 3 1  ON 27
ci_29                 1.456797e-03 3 1  ON 28
ci_30                -1.776653e-03 3 1  ON 29
ci_31                -4.951206e-04 3 1  ON 30
ci_32                -9.517294e-04 3 1  ON 31
ci_33                -1.371302e-03 3 1  ON 32
ci_34                 1.099615e-03 3 1  ON 33
ci_35                 1.538731e-03 3 1  ON 34
ci_36                -1.076668e-03 3 1  ON 35
ci_37                -1.050342e-03 3 1  ON 36
ci_38                -6.323186e-04 3 1  ON 37
ci_39                -6.022602e-04 3 1  ON 38
ci_40                -1.529339e-03 3 1  ON 39
ci_41                -1.187412e-03 3 1  ON 40
ci_42                -1.173346e-03 3 1  ON 41
ci_43                -2.260664e-03 3 1  ON 42
ci_44                -2.994760e-03 3 1  ON 43
ci_45                -5.581133e-04 3 1  ON 44
ci_46                -7.361335e-04 3 1  ON 45
ci_47                 1.560034e-03 3 1  ON 46
ci_48                 1.419391e-03 3 1  ON 47
ci_49                -9.613470e-04 3 1  ON 48
ci_50                -7.632674e-04 3 1  ON 49
ci_51                 1.267907e-04 3 1  ON 50
ci_52                 1.809969e-04 3 1  ON 51
ci_53                -7.062808e-04 3 1  ON 52
ci_54                -1.082673e-03 3 1  ON 53
ci_55                -6.622533e-04 3 1  ON 54
ci_56                 2.499963e-03 3 1  ON 55
ci_57                 1.713776e-03 3 1  ON 56
ci_58                -1.159329e-03 3 1  ON 57
ci_59                -1.429514e-03 3 1  ON 58
ci_60                 1.726742e-04 3 1  ON 59
ci_61                -2.371152e-04 3 1  ON 60
ci_62                -5.529276e-04 3 1  ON 61
ci_63                -6.314234e-04 3 1  ON 62
ci_64                -3.491443e-04 3 1  ON 63
ci_65                 7.129356e-06 3 1  ON 64
ci_66                -6.615768e-04 3 1  ON 65
ci_67                -8.546963e-04 3 1  ON 66
ci_68                -1.182041e-03 3 1  ON 67
ci_69                 9.016058e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8131e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2805e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8743
    reference variance = 0.806049
====================================================
  Execution time = 4.8865e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4639e-01
  Total weights = 1.964388847e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432255870959
                                         uncertainty =       0.001732936779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432255870959
                                         uncertainty =       0.001732936779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464946753
  error estimate for blocks of size 2^( 2) =       0.000490664902
  error estimate for blocks of size 2^( 3) =       0.000515236613
  error estimate for blocks of size 2^( 4) =       0.000532599648
  error estimate for blocks of size 2^( 5) =       0.000544307622
  error estimate for blocks of size 2^( 6) =       0.000550517065
  error estimate for blocks of size 2^( 7) =       0.000553579215

      target function =      -0.748340395319
              le_mean =     -22.813826553532
             les_mean =     520.917076455632
             stat err =       0.000545250888
             autocorr =       1.375264792722
   target nu stat err =       0.000545250888
   target dn stat err =       0.003533317163
      target stat err =       0.003009580169
              std dev =       0.657534003636
             le_variance =       0.432350965938


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281382655353e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748351618158       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748354118315       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748354350037       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748354375879       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748354378225       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748354377067       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748354377284       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748354376404       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748354375131       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+00 is 1.762931e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748351618158       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748352247177       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748352305283       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748352311730       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748352312305       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748352312014       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748352312066       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748352311846       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748352311529       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+01 is 4.432284e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748351618158       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748351775663       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748351790201       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748351791812       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748351791954       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748351791882       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748351791895       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748351791840       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748351791760       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 1.109642e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117052 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3392e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.264880e-01 3 1  ON 0
ci_02                -2.870765e-02 3 1  ON 1
ci_03                -2.855968e-02 3 1  ON 2
ci_04                 2.660528e-02 3 1  ON 3
ci_05                -2.187876e-02 3 1  ON 4
ci_06                -2.153992e-02 3 1  ON 5
ci_07                 2.709074e-02 3 1  ON 6
ci_08                -5.455059e-03 3 1  ON 7
ci_09                -8.837996e-03 3 1  ON 8
ci_10                -8.359352e-03 3 1  ON 9
ci_11                 1.310636e-02 3 1  ON 10
ci_12                 6.950043e-03 3 1  ON 11
ci_13                 1.303873e-02 3 1  ON 12
ci_14                 1.252820e-02 3 1  ON 13
ci_15                 6.377256e-03 3 1  ON 14
ci_16                 6.261119e-03 3 1  ON 15
ci_17                -7.197506e-03 3 1  ON 16
ci_18                -6.023243e-03 3 1  ON 17
ci_19                 9.258625e-03 3 1  ON 18
ci_20                 6.515201e-03 3 1  ON 19
ci_21                 8.966061e-03 3 1  ON 20
ci_22                 8.288685e-03 3 1  ON 21
ci_23                 4.847808e-03 3 1  ON 22
ci_24                 4.082526e-03 3 1  ON 23
ci_25                 2.861581e-03 3 1  ON 24
ci_26                 3.083979e-03 3 1  ON 25
ci_27                 3.181263e-03 3 1  ON 26
ci_28                 1.757965e-03 3 1  ON 27
ci_29                 1.456091e-03 3 1  ON 28
ci_30                -1.777176e-03 3 1  ON 29
ci_31                -4.954888e-04 3 1  ON 30
ci_32                -9.543012e-04 3 1  ON 31
ci_33                -1.372729e-03 3 1  ON 32
ci_34                 1.095536e-03 3 1  ON 33
ci_35                 1.538965e-03 3 1  ON 34
ci_36                -1.076393e-03 3 1  ON 35
ci_37                -1.049995e-03 3 1  ON 36
ci_38                -6.312115e-04 3 1  ON 37
ci_39                -6.010197e-04 3 1  ON 38
ci_40                -1.527885e-03 3 1  ON 39
ci_41                -1.188578e-03 3 1  ON 40
ci_42                -1.172867e-03 3 1  ON 41
ci_43                -2.259866e-03 3 1  ON 42
ci_44                -2.990794e-03 3 1  ON 43
ci_45                -5.588121e-04 3 1  ON 44
ci_46                -7.339918e-04 3 1  ON 45
ci_47                 1.564422e-03 3 1  ON 46
ci_48                 1.417733e-03 3 1  ON 47
ci_49                -9.612725e-04 3 1  ON 48
ci_50                -7.627582e-04 3 1  ON 49
ci_51                 1.262022e-04 3 1  ON 50
ci_52                 1.800078e-04 3 1  ON 51
ci_53                -7.048242e-04 3 1  ON 52
ci_54                -1.080819e-03 3 1  ON 53
ci_55                -6.616843e-04 3 1  ON 54
ci_56                 2.496882e-03 3 1  ON 55
ci_57                 1.715509e-03 3 1  ON 56
ci_58                -1.162140e-03 3 1  ON 57
ci_59                -1.428711e-03 3 1  ON 58
ci_60                 1.709108e-04 3 1  ON 59
ci_61                -2.389489e-04 3 1  ON 60
ci_62                -5.519937e-04 3 1  ON 61
ci_63                -6.309785e-04 3 1  ON 62
ci_64                -3.491296e-04 3 1  ON 63
ci_65                 4.903517e-06 3 1  ON 64
ci_66                -6.595107e-04 3 1  ON 65
ci_67                -8.547241e-04 3 1  ON 66
ci_68                -1.180022e-03 3 1  ON 67
ci_69                 8.944128e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8659
    reference variance = 0.361006
====================================================
  Execution time = 2.5736e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4710e-01
  Total weights = 1.9646e+06
  Execution time = 3.5040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433730282750
                                         uncertainty =       0.002121793530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433730282750
                                         uncertainty =       0.002121793530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465730017
  error estimate for blocks of size 2^( 2) =       0.000491086853
  error estimate for blocks of size 2^( 3) =       0.000514847982
  error estimate for blocks of size 2^( 4) =       0.000532689144
  error estimate for blocks of size 2^( 5) =       0.000543422283
  error estimate for blocks of size 2^( 6) =       0.000549106367
  error estimate for blocks of size 2^( 7) =       0.000551290933

      target function =      -0.747762824453
              le_mean =     -22.815517549913
             les_mean =     520.994938585586
             stat err =       0.000544127182
             autocorr =       1.364999158913
   target nu stat err =       0.000544127182
   target dn stat err =       0.003002401459
      target stat err =       0.002579684451
              std dev =       0.658641706556
             le_variance =       0.433808897616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433728833551
                                         uncertainty =       0.002121866031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433728833551
                                         uncertainty =       0.002121866031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465729226
  error estimate for blocks of size 2^( 2) =       0.000491086777
  error estimate for blocks of size 2^( 3) =       0.000514848697
  error estimate for blocks of size 2^( 4) =       0.000532690570
  error estimate for blocks of size 2^( 5) =       0.000543424135
  error estimate for blocks of size 2^( 6) =       0.000549108004
  error estimate for blocks of size 2^( 7) =       0.000551293604

      target function =      -0.747765626499
              le_mean =     -22.815517518375
             les_mean =     520.994933792291
             stat err =       0.000544129078
             autocorr =       1.365013311080
   target nu stat err =       0.000544129078
   target dn stat err =       0.003002154627
      target stat err =       0.002579503307
              std dev =       0.658640587248
             le_variance =       0.433807423170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433729542069
                                         uncertainty =       0.002121829728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433729542069
                                         uncertainty =       0.002121829728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465729613
  error estimate for blocks of size 2^( 2) =       0.000491086808
  error estimate for blocks of size 2^( 3) =       0.000514848335
  error estimate for blocks of size 2^( 4) =       0.000532689857
  error estimate for blocks of size 2^( 5) =       0.000543423209
  error estimate for blocks of size 2^( 6) =       0.000549107184
  error estimate for blocks of size 2^( 7) =       0.000551292275

      target function =      -0.747754963726
              le_mean =     -22.815517533057
             les_mean =     520.994947231047
             stat err =       0.000544128131
             autocorr =       1.365006291402
   target nu stat err =       0.000544128131
   target dn stat err =       0.003002309911
      target stat err =       0.002579557609
              std dev =       0.658641134638
             le_variance =       0.433808144238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433730188704
                                         uncertainty =       0.002121798036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433730188704
                                         uncertainty =       0.002121798036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465729966
  error estimate for blocks of size 2^( 2) =       0.000491086847
  error estimate for blocks of size 2^( 3) =       0.000514848026
  error estimate for blocks of size 2^( 4) =       0.000532689232
  error estimate for blocks of size 2^( 5) =       0.000543422398
  error estimate for blocks of size 2^( 6) =       0.000549106469
  error estimate for blocks of size 2^( 7) =       0.000551291101

      target function =      -0.747763127895
              le_mean =     -22.815517547545
             les_mean =     520.994938114209
             stat err =       0.000544127300
             autocorr =       1.365000052261
   target nu stat err =       0.000544127300
   target dn stat err =       0.003002384239
      target stat err =       0.002579672534
              std dev =       0.658641633956
             le_variance =       0.433808801980


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747762824453        initial
     5.8208e+00     5.8208e+01             1.7629e-05        -0.747765626499  <--
     2.3283e+01     2.3283e+02             4.4323e-06        -0.747754963726
     9.3132e+01     9.3132e+02             1.1096e-06        -0.747763127895

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 4.3262e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.264792e-01 3 1  ON 0
ci_02                -2.869445e-02 3 1  ON 1
ci_03                -2.855325e-02 3 1  ON 2
ci_04                 2.660217e-02 3 1  ON 3
ci_05                -2.188253e-02 3 1  ON 4
ci_06                -2.153121e-02 3 1  ON 5
ci_07                 2.708061e-02 3 1  ON 6
ci_08                -5.453700e-03 3 1  ON 7
ci_09                -8.826538e-03 3 1  ON 8
ci_10                -8.347390e-03 3 1  ON 9
ci_11                 1.310364e-02 3 1  ON 10
ci_12                 6.949154e-03 3 1  ON 11
ci_13                 1.304385e-02 3 1  ON 12
ci_14                 1.253518e-02 3 1  ON 13
ci_15                 6.388452e-03 3 1  ON 14
ci_16                 6.255505e-03 3 1  ON 15
ci_17                -7.193005e-03 3 1  ON 16
ci_18                -6.019934e-03 3 1  ON 17
ci_19                 9.260900e-03 3 1  ON 18
ci_20                 6.510401e-03 3 1  ON 19
ci_21                 8.965548e-03 3 1  ON 20
ci_22                 8.286804e-03 3 1  ON 21
ci_23                 4.842190e-03 3 1  ON 22
ci_24                 4.081462e-03 3 1  ON 23
ci_25                 2.852659e-03 3 1  ON 24
ci_26                 3.080781e-03 3 1  ON 25
ci_27                 3.174685e-03 3 1  ON 26
ci_28                 1.769434e-03 3 1  ON 27
ci_29                 1.453985e-03 3 1  ON 28
ci_30                -1.778734e-03 3 1  ON 29
ci_31                -4.965762e-04 3 1  ON 30
ci_32                -9.619475e-04 3 1  ON 31
ci_33                -1.376970e-03 3 1  ON 32
ci_34                 1.083390e-03 3 1  ON 33
ci_35                 1.539662e-03 3 1  ON 34
ci_36                -1.075576e-03 3 1  ON 35
ci_37                -1.048958e-03 3 1  ON 36
ci_38                -6.279173e-04 3 1  ON 37
ci_39                -5.973304e-04 3 1  ON 38
ci_40                -1.523562e-03 3 1  ON 39
ci_41                -1.192048e-03 3 1  ON 40
ci_42                -1.171441e-03 3 1  ON 41
ci_43                -2.257492e-03 3 1  ON 42
ci_44                -2.978985e-03 3 1  ON 43
ci_45                -5.608902e-04 3 1  ON 44
ci_46                -7.276219e-04 3 1  ON 45
ci_47                 1.577510e-03 3 1  ON 46
ci_48                 1.412795e-03 3 1  ON 47
ci_49                -9.610497e-04 3 1  ON 48
ci_50                -7.612457e-04 3 1  ON 49
ci_51                 1.244525e-04 3 1  ON 50
ci_52                 1.770662e-04 3 1  ON 51
ci_53                -7.004963e-04 3 1  ON 52
ci_54                -1.075300e-03 3 1  ON 53
ci_55                -6.599938e-04 3 1  ON 54
ci_56                 2.487720e-03 3 1  ON 55
ci_57                 1.720659e-03 3 1  ON 56
ci_58                -1.170504e-03 3 1  ON 57
ci_59                -1.426323e-03 3 1  ON 58
ci_60                 1.656448e-04 3 1  ON 59
ci_61                -2.444292e-04 3 1  ON 60
ci_62                -5.492180e-04 3 1  ON 61
ci_63                -6.296559e-04 3 1  ON 62
ci_64                -3.490870e-04 3 1  ON 63
ci_65                -1.716338e-06 3 1  ON 64
ci_66                -6.533665e-04 3 1  ON 65
ci_67                -8.548072e-04 3 1  ON 66
ci_68                -1.174018e-03 3 1  ON 67
ci_69                 8.730273e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.6661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.834
    reference variance = 0.31717
====================================================
  Execution time = 2.5907e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4584e-01
  Total weights = 1.964365923e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5134e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434568453563
                                         uncertainty =       0.001490326360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434568453563
                                         uncertainty =       0.001490326360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466142760
  error estimate for blocks of size 2^( 2) =       0.000491505683
  error estimate for blocks of size 2^( 3) =       0.000515638664
  error estimate for blocks of size 2^( 4) =       0.000533316263
  error estimate for blocks of size 2^( 5) =       0.000544678588
  error estimate for blocks of size 2^( 6) =       0.000549853848
  error estimate for blocks of size 2^( 7) =       0.000553900176

      target function =      -0.748812099860
              le_mean =     -22.814956265352
             les_mean =     520.968070515947
             stat err =       0.000545437219
             autocorr =       1.369151959090
   target nu stat err =       0.000545437219
   target dn stat err =       0.002847904146
      target stat err =       0.002459472874
              std dev =       0.659225413100
             le_variance =       0.434578145277


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281495626535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748819214004       residual = 9.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748824790682       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748825991635       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748826192471       residual = 9.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748826204729       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748826182771       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748826193604       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748826186100       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748826187712       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+00 is 1.007851e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748819214004       residual = 9.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748820643436       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748820948315       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748820998377       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748821001073       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748820995468       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748820998153       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748820996307       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748820996703       residual = 7.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+00 is 2.575149e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748819214004       residual = 9.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748819573636       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748819650150       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748819662654       residual = 9.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748819663304       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748819661896       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748819662565       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748819662106       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748819662204       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+01 is 6.473529e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120126 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0429e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.264545e-01 3 1  ON 0
ci_02                -2.868520e-02 3 1  ON 1
ci_03                -2.855303e-02 3 1  ON 2
ci_04                 2.659440e-02 3 1  ON 3
ci_05                -2.185677e-02 3 1  ON 4
ci_06                -2.151807e-02 3 1  ON 5
ci_07                 2.708399e-02 3 1  ON 6
ci_08                -5.451609e-03 3 1  ON 7
ci_09                -8.810718e-03 3 1  ON 8
ci_10                -8.335805e-03 3 1  ON 9
ci_11                 1.310018e-02 3 1  ON 10
ci_12                 6.939914e-03 3 1  ON 11
ci_13                 1.304943e-02 3 1  ON 12
ci_14                 1.254682e-02 3 1  ON 13
ci_15                 6.397820e-03 3 1  ON 14
ci_16                 6.257377e-03 3 1  ON 15
ci_17                -7.189868e-03 3 1  ON 16
ci_18                -6.018399e-03 3 1  ON 17
ci_19                 9.264038e-03 3 1  ON 18
ci_20                 6.512387e-03 3 1  ON 19
ci_21                 8.964103e-03 3 1  ON 20
ci_22                 8.286252e-03 3 1  ON 21
ci_23                 4.842336e-03 3 1  ON 22
ci_24                 4.085212e-03 3 1  ON 23
ci_25                 2.847111e-03 3 1  ON 24
ci_26                 3.080980e-03 3 1  ON 25
ci_27                 3.184479e-03 3 1  ON 26
ci_28                 1.770219e-03 3 1  ON 27
ci_29                 1.464841e-03 3 1  ON 28
ci_30                -1.772472e-03 3 1  ON 29
ci_31                -4.923678e-04 3 1  ON 30
ci_32                -9.715236e-04 3 1  ON 31
ci_33                -1.386825e-03 3 1  ON 32
ci_34                 1.073237e-03 3 1  ON 33
ci_35                 1.542316e-03 3 1  ON 34
ci_36                -1.082159e-03 3 1  ON 35
ci_37                -1.049096e-03 3 1  ON 36
ci_38                -6.220535e-04 3 1  ON 37
ci_39                -5.947576e-04 3 1  ON 38
ci_40                -1.524879e-03 3 1  ON 39
ci_41                -1.195844e-03 3 1  ON 40
ci_42                -1.172413e-03 3 1  ON 41
ci_43                -2.243325e-03 3 1  ON 42
ci_44                -2.967745e-03 3 1  ON 43
ci_45                -5.600085e-04 3 1  ON 44
ci_46                -7.234537e-04 3 1  ON 45
ci_47                 1.581816e-03 3 1  ON 46
ci_48                 1.417941e-03 3 1  ON 47
ci_49                -9.632931e-04 3 1  ON 48
ci_50                -7.567692e-04 3 1  ON 49
ci_51                 1.203584e-04 3 1  ON 50
ci_52                 1.737050e-04 3 1  ON 51
ci_53                -6.941235e-04 3 1  ON 52
ci_54                -1.071871e-03 3 1  ON 53
ci_55                -6.631536e-04 3 1  ON 54
ci_56                 2.481126e-03 3 1  ON 55
ci_57                 1.726206e-03 3 1  ON 56
ci_58                -1.172360e-03 3 1  ON 57
ci_59                -1.421746e-03 3 1  ON 58
ci_60                 1.607928e-04 3 1  ON 59
ci_61                -2.410598e-04 3 1  ON 60
ci_62                -5.521347e-04 3 1  ON 61
ci_63                -6.291966e-04 3 1  ON 62
ci_64                -3.482837e-04 3 1  ON 63
ci_65                -3.419184e-06 3 1  ON 64
ci_66                -6.607437e-04 3 1  ON 65
ci_67                -8.472118e-04 3 1  ON 66
ci_68                -1.167553e-03 3 1  ON 67
ci_69                 8.245526e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.9231
    reference variance = 0.376952
====================================================
  Execution time = 2.5302e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5289e-01
  Total weights = 1.9644e+06
  Execution time = 3.4896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434554637736
                                         uncertainty =       0.003113140143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434554637736
                                         uncertainty =       0.003113140143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466157129
  error estimate for blocks of size 2^( 2) =       0.000491721764
  error estimate for blocks of size 2^( 3) =       0.000515459887
  error estimate for blocks of size 2^( 4) =       0.000533899800
  error estimate for blocks of size 2^( 5) =       0.000545391071
  error estimate for blocks of size 2^( 6) =       0.000552541285
  error estimate for blocks of size 2^( 7) =       0.000560217869

      target function =      -0.742776923762
              le_mean =     -22.814806100647
             les_mean =     520.968440356654
             stat err =       0.000548012506
             autocorr =       1.382026206919
   target nu stat err =       0.000548012506
   target dn stat err =       0.007340153851
      target stat err =       0.006072158128
              std dev =       0.659245733824
             le_variance =       0.434604937565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434530505079
                                         uncertainty =       0.003106164793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434530505079
                                         uncertainty =       0.003106164793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466144210
  error estimate for blocks of size 2^( 2) =       0.000491712743
  error estimate for blocks of size 2^( 3) =       0.000515453437
  error estimate for blocks of size 2^( 4) =       0.000533896508
  error estimate for blocks of size 2^( 5) =       0.000545386740
  error estimate for blocks of size 2^( 6) =       0.000552537051
  error estimate for blocks of size 2^( 7) =       0.000560217717

      target function =      -0.742898391096
              le_mean =     -22.814805137304
             les_mean =     520.968249198674
             stat err =       0.000548009504
             autocorr =       1.382087671366
   target nu stat err =       0.000548009504
   target dn stat err =       0.007318062550
      target stat err =       0.006056025042
              std dev =       0.659227463416
             le_variance =       0.434580848522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434541571568
                                         uncertainty =       0.003109089928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434541571568
                                         uncertainty =       0.003109089928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466150135
  error estimate for blocks of size 2^( 2) =       0.000491716798
  error estimate for blocks of size 2^( 3) =       0.000515456213
  error estimate for blocks of size 2^( 4) =       0.000533897780
  error estimate for blocks of size 2^( 5) =       0.000545388394
  error estimate for blocks of size 2^( 6) =       0.000552538663
  error estimate for blocks of size 2^( 7) =       0.000560217442

      target function =      -0.742969451350
              le_mean =     -22.814805556621
             les_mean =     520.968181886585
             stat err =       0.000548010570
             autocorr =       1.382057911503
   target nu stat err =       0.000548010570
   target dn stat err =       0.007326384795
      target stat err =       0.006064001831
              std dev =       0.659235843072
             le_variance =       0.434591896790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434552925421
                                         uncertainty =       0.003112561414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434552925421
                                         uncertainty =       0.003112561414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466156212
  error estimate for blocks of size 2^( 2) =       0.000491721134
  error estimate for blocks of size 2^( 3) =       0.000515459687
  error estimate for blocks of size 2^( 4) =       0.000533899586
  error estimate for blocks of size 2^( 5) =       0.000545390541
  error estimate for blocks of size 2^( 6) =       0.000552540187
  error estimate for blocks of size 2^( 7) =       0.000560216615

      target function =      -0.680827269941
              le_mean =     -22.814806145138
             les_mean =     521.044612801354
             stat err =       0.000548011732
             autocorr =       1.382027737741
   target nu stat err =       0.000548011732
   target dn stat err =       0.076701990443
      target stat err =       0.053366839614
              std dev =       0.659244437772
             le_variance =       0.434603228733


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742776923762        initial
     1.4552e+00     1.4552e+01             1.0079e-04        -0.742898391096
     5.8208e+00     5.8208e+01             2.5751e-05        -0.742969451350  <--
     2.3283e+01     2.3283e+02             6.4735e-06        -0.680827269941

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 4.5263e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.264545e-01 3 1  ON 0
ci_02                -2.868520e-02 3 1  ON 1
ci_03                -2.855303e-02 3 1  ON 2
ci_04                 2.659440e-02 3 1  ON 3
ci_05                -2.185677e-02 3 1  ON 4
ci_06                -2.151807e-02 3 1  ON 5
ci_07                 2.708399e-02 3 1  ON 6
ci_08                -5.451609e-03 3 1  ON 7
ci_09                -8.810718e-03 3 1  ON 8
ci_10                -8.335805e-03 3 1  ON 9
ci_11                 1.310018e-02 3 1  ON 10
ci_12                 6.939914e-03 3 1  ON 11
ci_13                 1.304943e-02 3 1  ON 12
ci_14                 1.254682e-02 3 1  ON 13
ci_15                 6.397820e-03 3 1  ON 14
ci_16                 6.257377e-03 3 1  ON 15
ci_17                -7.189868e-03 3 1  ON 16
ci_18                -6.018399e-03 3 1  ON 17
ci_19                 9.264038e-03 3 1  ON 18
ci_20                 6.512387e-03 3 1  ON 19
ci_21                 8.964103e-03 3 1  ON 20
ci_22                 8.286252e-03 3 1  ON 21
ci_23                 4.842336e-03 3 1  ON 22
ci_24                 4.085212e-03 3 1  ON 23
ci_25                 2.847111e-03 3 1  ON 24
ci_26                 3.080980e-03 3 1  ON 25
ci_27                 3.184479e-03 3 1  ON 26
ci_28                 1.770219e-03 3 1  ON 27
ci_29                 1.464841e-03 3 1  ON 28
ci_30                -1.772472e-03 3 1  ON 29
ci_31                -4.923678e-04 3 1  ON 30
ci_32                -9.715236e-04 3 1  ON 31
ci_33                -1.386825e-03 3 1  ON 32
ci_34                 1.073237e-03 3 1  ON 33
ci_35                 1.542316e-03 3 1  ON 34
ci_36                -1.082159e-03 3 1  ON 35
ci_37                -1.049096e-03 3 1  ON 36
ci_38                -6.220535e-04 3 1  ON 37
ci_39                -5.947576e-04 3 1  ON 38
ci_40                -1.524879e-03 3 1  ON 39
ci_41                -1.195844e-03 3 1  ON 40
ci_42                -1.172413e-03 3 1  ON 41
ci_43                -2.243325e-03 3 1  ON 42
ci_44                -2.967745e-03 3 1  ON 43
ci_45                -5.600085e-04 3 1  ON 44
ci_46                -7.234537e-04 3 1  ON 45
ci_47                 1.581816e-03 3 1  ON 46
ci_48                 1.417941e-03 3 1  ON 47
ci_49                -9.632931e-04 3 1  ON 48
ci_50                -7.567692e-04 3 1  ON 49
ci_51                 1.203584e-04 3 1  ON 50
ci_52                 1.737050e-04 3 1  ON 51
ci_53                -6.941235e-04 3 1  ON 52
ci_54                -1.071871e-03 3 1  ON 53
ci_55                -6.631536e-04 3 1  ON 54
ci_56                 2.481126e-03 3 1  ON 55
ci_57                 1.726206e-03 3 1  ON 56
ci_58                -1.172360e-03 3 1  ON 57
ci_59                -1.421746e-03 3 1  ON 58
ci_60                 1.607928e-04 3 1  ON 59
ci_61                -2.410598e-04 3 1  ON 60
ci_62                -5.521347e-04 3 1  ON 61
ci_63                -6.291966e-04 3 1  ON 62
ci_64                -3.482837e-04 3 1  ON 63
ci_65                -3.419184e-06 3 1  ON 64
ci_66                -6.607437e-04 3 1  ON 65
ci_67                -8.472118e-04 3 1  ON 66
ci_68                -1.167553e-03 3 1  ON 67
ci_69                 8.245526e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5699e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8109
    reference variance = 0.620255
====================================================
  Execution time = 2.5859e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4692e-01
  Total weights = 1.964393094e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4947e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434563673237
                                         uncertainty =       0.002130557025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434563673237
                                         uncertainty =       0.002130557025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466145448
  error estimate for blocks of size 2^( 2) =       0.000492112064
  error estimate for blocks of size 2^( 3) =       0.000515349272
  error estimate for blocks of size 2^( 4) =       0.000533398674
  error estimate for blocks of size 2^( 5) =       0.000544226204
  error estimate for blocks of size 2^( 6) =       0.000549025507
  error estimate for blocks of size 2^( 7) =       0.000551741513

      target function =      -0.747912075031
              le_mean =     -22.814185409251
             les_mean =     520.933973073444
             stat err =       0.000544597975
             autocorr =       1.364926134075
   target nu stat err =       0.000544597975
   target dn stat err =       0.002492381966
      target stat err =       0.002164771624
              std dev =       0.659229213980
             le_variance =       0.434583156565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281418540925e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747917342614       residual = 9.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747922953193       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747923555400       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747923677534       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747923711625       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747923727787       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747923740629       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747923737305       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747923737948       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+00 is 6.450698e-05

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747917342614       residual = 9.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747918781863       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747918934655       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747918965339       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747918973759       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747918977759       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747918980920       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747918980087       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747918980248       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+00 is 1.652501e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747917342614       residual = 9.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747917704789       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747917743129       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747917750808       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747917752906       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747917753904       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747917754691       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747917754482       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747917754523       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+01 is 4.156919e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123207 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0362e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.264401e-01 3 1  ON 0
ci_02                -2.867907e-02 3 1  ON 1
ci_03                -2.855855e-02 3 1  ON 2
ci_04                 2.658239e-02 3 1  ON 3
ci_05                -2.185718e-02 3 1  ON 4
ci_06                -2.151666e-02 3 1  ON 5
ci_07                 2.707391e-02 3 1  ON 6
ci_08                -5.449280e-03 3 1  ON 7
ci_09                -8.818117e-03 3 1  ON 8
ci_10                -8.323772e-03 3 1  ON 9
ci_11                 1.309052e-02 3 1  ON 10
ci_12                 6.934168e-03 3 1  ON 11
ci_13                 1.304891e-02 3 1  ON 12
ci_14                 1.254921e-02 3 1  ON 13
ci_15                 6.401452e-03 3 1  ON 14
ci_16                 6.259251e-03 3 1  ON 15
ci_17                -7.187603e-03 3 1  ON 16
ci_18                -6.019700e-03 3 1  ON 17
ci_19                 9.267858e-03 3 1  ON 18
ci_20                 6.510184e-03 3 1  ON 19
ci_21                 8.961445e-03 3 1  ON 20
ci_22                 8.288683e-03 3 1  ON 21
ci_23                 4.835869e-03 3 1  ON 22
ci_24                 4.089121e-03 3 1  ON 23
ci_25                 2.841267e-03 3 1  ON 24
ci_26                 3.085732e-03 3 1  ON 25
ci_27                 3.185393e-03 3 1  ON 26
ci_28                 1.757445e-03 3 1  ON 27
ci_29                 1.465650e-03 3 1  ON 28
ci_30                -1.767982e-03 3 1  ON 29
ci_31                -4.856212e-04 3 1  ON 30
ci_32                -9.633019e-04 3 1  ON 31
ci_33                -1.384328e-03 3 1  ON 32
ci_34                 1.080955e-03 3 1  ON 33
ci_35                 1.542771e-03 3 1  ON 34
ci_36                -1.082953e-03 3 1  ON 35
ci_37                -1.044787e-03 3 1  ON 36
ci_38                -6.187774e-04 3 1  ON 37
ci_39                -5.857831e-04 3 1  ON 38
ci_40                -1.519355e-03 3 1  ON 39
ci_41                -1.198727e-03 3 1  ON 40
ci_42                -1.174232e-03 3 1  ON 41
ci_43                -2.237800e-03 3 1  ON 42
ci_44                -2.965243e-03 3 1  ON 43
ci_45                -5.592412e-04 3 1  ON 44
ci_46                -7.144682e-04 3 1  ON 45
ci_47                 1.585016e-03 3 1  ON 46
ci_48                 1.421036e-03 3 1  ON 47
ci_49                -9.657624e-04 3 1  ON 48
ci_50                -7.600922e-04 3 1  ON 49
ci_51                 1.194875e-04 3 1  ON 50
ci_52                 1.755839e-04 3 1  ON 51
ci_53                -6.989445e-04 3 1  ON 52
ci_54                -1.065889e-03 3 1  ON 53
ci_55                -6.557089e-04 3 1  ON 54
ci_56                 2.485938e-03 3 1  ON 55
ci_57                 1.723307e-03 3 1  ON 56
ci_58                -1.166346e-03 3 1  ON 57
ci_59                -1.405221e-03 3 1  ON 58
ci_60                 1.648438e-04 3 1  ON 59
ci_61                -2.451236e-04 3 1  ON 60
ci_62                -5.495969e-04 3 1  ON 61
ci_63                -6.273923e-04 3 1  ON 62
ci_64                -3.375362e-04 3 1  ON 63
ci_65                -4.956411e-06 3 1  ON 64
ci_66                -6.577290e-04 3 1  ON 65
ci_67                -8.404529e-04 3 1  ON 66
ci_68                -1.173833e-03 3 1  ON 67
ci_69                 7.428438e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7906
    reference variance = 0.416959
====================================================
  Execution time = 2.5491e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5625e-01
  Total weights = 1.9642e+06
  Execution time = 3.5052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440329011050
                                         uncertainty =       0.002507736325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440329011050
                                         uncertainty =       0.002507736325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469176390
  error estimate for blocks of size 2^( 2) =       0.000494822586
  error estimate for blocks of size 2^( 3) =       0.000518429172
  error estimate for blocks of size 2^( 4) =       0.000536272166
  error estimate for blocks of size 2^( 5) =       0.000547532067
  error estimate for blocks of size 2^( 6) =       0.000552520870
  error estimate for blocks of size 2^( 7) =       0.000555730678

      target function =      -0.740185505661
              le_mean =     -22.815568063639
             les_mean =     521.006408468267
             stat err =       0.000548013945
             autocorr =       1.364303275844
   target nu stat err =       0.000548013945
   target dn stat err =       0.003261211181
      target stat err =       0.002736414679
              std dev =       0.663515613571
             le_variance =       0.440252969452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440319506818
                                         uncertainty =       0.002506656115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440319506818
                                         uncertainty =       0.002506656115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469171331
  error estimate for blocks of size 2^( 2) =       0.000494819556
  error estimate for blocks of size 2^( 3) =       0.000518428423
  error estimate for blocks of size 2^( 4) =       0.000536274289
  error estimate for blocks of size 2^( 5) =       0.000547533768
  error estimate for blocks of size 2^( 6) =       0.000552523969
  error estimate for blocks of size 2^( 7) =       0.000555732952

      target function =      -0.740123115546
              le_mean =     -22.815568883140
             les_mean =     521.006522128812
             stat err =       0.000548016244
             autocorr =       1.364344145893
   target nu stat err =       0.000548016244
   target dn stat err =       0.003258567256
      target stat err =       0.002733859222
              std dev =       0.663508459161
             le_variance =       0.440243475378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440324015562
                                         uncertainty =       0.002507178495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440324015562
                                         uncertainty =       0.002507178495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469173731
  error estimate for blocks of size 2^( 2) =       0.000494820963
  error estimate for blocks of size 2^( 3) =       0.000518428727
  error estimate for blocks of size 2^( 4) =       0.000536273189
  error estimate for blocks of size 2^( 5) =       0.000547532891
  error estimate for blocks of size 2^( 6) =       0.000552522436
  error estimate for blocks of size 2^( 7) =       0.000555731845

      target function =      -0.740191757005
              le_mean =     -22.815568454105
             les_mean =     521.006418656482
             stat err =       0.000548015090
             autocorr =       1.364324441325
   target nu stat err =       0.000548015090
   target dn stat err =       0.003259074612
      target stat err =       0.002734756714
              std dev =       0.663511853050
             le_variance =       0.440247979137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440328367403
                                         uncertainty =       0.002507665569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440328367403
                                         uncertainty =       0.002507665569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469176047
  error estimate for blocks of size 2^( 2) =       0.000494822374
  error estimate for blocks of size 2^( 3) =       0.000518429109
  error estimate for blocks of size 2^( 4) =       0.000536272287
  error estimate for blocks of size 2^( 5) =       0.000547532163
  error estimate for blocks of size 2^( 6) =       0.000552521060
  error estimate for blocks of size 2^( 7) =       0.000555730819

      target function =      -0.740188895021
              le_mean =     -22.815568110978
             les_mean =     521.006406487886
             stat err =       0.000548014083
             autocorr =       1.364305951731
   target nu stat err =       0.000548014083
   target dn stat err =       0.003260893526
      target stat err =       0.002736185870
              std dev =       0.663515129035
             le_variance =       0.440252326459


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740185505661        initial
     1.4552e+00     1.4552e+01             6.4507e-05        -0.740123115546
     5.8208e+00     5.8208e+01             1.6525e-05        -0.740191757005  <--
     2.3283e+01     2.3283e+02             4.1569e-06        -0.740188895021

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 4.3060e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.264401e-01 3 1  ON 0
ci_02                -2.867907e-02 3 1  ON 1
ci_03                -2.855855e-02 3 1  ON 2
ci_04                 2.658239e-02 3 1  ON 3
ci_05                -2.185718e-02 3 1  ON 4
ci_06                -2.151666e-02 3 1  ON 5
ci_07                 2.707391e-02 3 1  ON 6
ci_08                -5.449280e-03 3 1  ON 7
ci_09                -8.818117e-03 3 1  ON 8
ci_10                -8.323772e-03 3 1  ON 9
ci_11                 1.309052e-02 3 1  ON 10
ci_12                 6.934168e-03 3 1  ON 11
ci_13                 1.304891e-02 3 1  ON 12
ci_14                 1.254921e-02 3 1  ON 13
ci_15                 6.401452e-03 3 1  ON 14
ci_16                 6.259251e-03 3 1  ON 15
ci_17                -7.187603e-03 3 1  ON 16
ci_18                -6.019700e-03 3 1  ON 17
ci_19                 9.267858e-03 3 1  ON 18
ci_20                 6.510184e-03 3 1  ON 19
ci_21                 8.961445e-03 3 1  ON 20
ci_22                 8.288683e-03 3 1  ON 21
ci_23                 4.835869e-03 3 1  ON 22
ci_24                 4.089121e-03 3 1  ON 23
ci_25                 2.841267e-03 3 1  ON 24
ci_26                 3.085732e-03 3 1  ON 25
ci_27                 3.185393e-03 3 1  ON 26
ci_28                 1.757445e-03 3 1  ON 27
ci_29                 1.465650e-03 3 1  ON 28
ci_30                -1.767982e-03 3 1  ON 29
ci_31                -4.856212e-04 3 1  ON 30
ci_32                -9.633019e-04 3 1  ON 31
ci_33                -1.384328e-03 3 1  ON 32
ci_34                 1.080955e-03 3 1  ON 33
ci_35                 1.542771e-03 3 1  ON 34
ci_36                -1.082953e-03 3 1  ON 35
ci_37                -1.044787e-03 3 1  ON 36
ci_38                -6.187774e-04 3 1  ON 37
ci_39                -5.857831e-04 3 1  ON 38
ci_40                -1.519355e-03 3 1  ON 39
ci_41                -1.198727e-03 3 1  ON 40
ci_42                -1.174232e-03 3 1  ON 41
ci_43                -2.237800e-03 3 1  ON 42
ci_44                -2.965243e-03 3 1  ON 43
ci_45                -5.592412e-04 3 1  ON 44
ci_46                -7.144682e-04 3 1  ON 45
ci_47                 1.585016e-03 3 1  ON 46
ci_48                 1.421036e-03 3 1  ON 47
ci_49                -9.657624e-04 3 1  ON 48
ci_50                -7.600922e-04 3 1  ON 49
ci_51                 1.194875e-04 3 1  ON 50
ci_52                 1.755839e-04 3 1  ON 51
ci_53                -6.989445e-04 3 1  ON 52
ci_54                -1.065889e-03 3 1  ON 53
ci_55                -6.557089e-04 3 1  ON 54
ci_56                 2.485938e-03 3 1  ON 55
ci_57                 1.723307e-03 3 1  ON 56
ci_58                -1.166346e-03 3 1  ON 57
ci_59                -1.405221e-03 3 1  ON 58
ci_60                 1.648438e-04 3 1  ON 59
ci_61                -2.451236e-04 3 1  ON 60
ci_62                -5.495969e-04 3 1  ON 61
ci_63                -6.273923e-04 3 1  ON 62
ci_64                -3.375362e-04 3 1  ON 63
ci_65                -4.956411e-06 3 1  ON 64
ci_66                -6.577290e-04 3 1  ON 65
ci_67                -8.404529e-04 3 1  ON 66
ci_68                -1.173833e-03 3 1  ON 67
ci_69                 7.428438e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7953
    reference variance = 0.266936
====================================================
  Execution time = 2.5793e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4661e-01
  Total weights = 1.964623035e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433367039089
                                         uncertainty =       0.002447285680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433367039089
                                         uncertainty =       0.002447285680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465494355
  error estimate for blocks of size 2^( 2) =       0.000490720650
  error estimate for blocks of size 2^( 3) =       0.000514035232
  error estimate for blocks of size 2^( 4) =       0.000530237221
  error estimate for blocks of size 2^( 5) =       0.000541031358
  error estimate for blocks of size 2^( 6) =       0.000546986213
  error estimate for blocks of size 2^( 7) =       0.000550681593

      target function =      -0.748164981564
              le_mean =     -22.815054236758
             les_mean =     520.973312117753
             stat err =       0.000542234096
             autocorr =       1.356890522533
   target nu stat err =       0.000542234096
   target dn stat err =       0.003318122468
      target stat err =       0.002837158002
              std dev =       0.658308429654
             le_variance =       0.433369988553


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281505423676e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748174848419       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748180511546       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748181353361       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748181804504       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748181890979       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748181945611       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748181962713       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748181952372       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748181954801       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+00 is 1.091437e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748174848419       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748176300703       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748176514667       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748176628080       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748176649249       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748176662695       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748176666801       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748176664221       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748176664804       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+00 is 2.764148e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748174848419       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748175213845       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748175267559       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748175295950       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748175301213       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748175304560       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748175305576       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748175304931       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748175305076       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+01 is 6.932977e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126263 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0274e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.264125e-01 3 1  ON 0
ci_02                -2.867220e-02 3 1  ON 1
ci_03                -2.855089e-02 3 1  ON 2
ci_04                 2.656100e-02 3 1  ON 3
ci_05                -2.184460e-02 3 1  ON 4
ci_06                -2.151913e-02 3 1  ON 5
ci_07                 2.706644e-02 3 1  ON 6
ci_08                -5.441758e-03 3 1  ON 7
ci_09                -8.815591e-03 3 1  ON 8
ci_10                -8.329910e-03 3 1  ON 9
ci_11                 1.309127e-02 3 1  ON 10
ci_12                 6.938611e-03 3 1  ON 11
ci_13                 1.304435e-02 3 1  ON 12
ci_14                 1.255262e-02 3 1  ON 13
ci_15                 6.399635e-03 3 1  ON 14
ci_16                 6.266062e-03 3 1  ON 15
ci_17                -7.193440e-03 3 1  ON 16
ci_18                -6.024140e-03 3 1  ON 17
ci_19                 9.270767e-03 3 1  ON 18
ci_20                 6.500331e-03 3 1  ON 19
ci_21                 8.954537e-03 3 1  ON 20
ci_22                 8.286380e-03 3 1  ON 21
ci_23                 4.839988e-03 3 1  ON 22
ci_24                 4.089816e-03 3 1  ON 23
ci_25                 2.841955e-03 3 1  ON 24
ci_26                 3.087401e-03 3 1  ON 25
ci_27                 3.186402e-03 3 1  ON 26
ci_28                 1.750101e-03 3 1  ON 27
ci_29                 1.475204e-03 3 1  ON 28
ci_30                -1.756699e-03 3 1  ON 29
ci_31                -4.825732e-04 3 1  ON 30
ci_32                -9.615611e-04 3 1  ON 31
ci_33                -1.382236e-03 3 1  ON 32
ci_34                 1.078227e-03 3 1  ON 33
ci_35                 1.545444e-03 3 1  ON 34
ci_36                -1.078740e-03 3 1  ON 35
ci_37                -1.044289e-03 3 1  ON 36
ci_38                -6.200725e-04 3 1  ON 37
ci_39                -5.829952e-04 3 1  ON 38
ci_40                -1.513444e-03 3 1  ON 39
ci_41                -1.195992e-03 3 1  ON 40
ci_42                -1.182102e-03 3 1  ON 41
ci_43                -2.230680e-03 3 1  ON 42
ci_44                -2.956053e-03 3 1  ON 43
ci_45                -5.553555e-04 3 1  ON 44
ci_46                -7.088175e-04 3 1  ON 45
ci_47                 1.594339e-03 3 1  ON 46
ci_48                 1.424268e-03 3 1  ON 47
ci_49                -9.584001e-04 3 1  ON 48
ci_50                -7.578045e-04 3 1  ON 49
ci_51                 1.265111e-04 3 1  ON 50
ci_52                 1.734709e-04 3 1  ON 51
ci_53                -7.033425e-04 3 1  ON 52
ci_54                -1.067579e-03 3 1  ON 53
ci_55                -6.711173e-04 3 1  ON 54
ci_56                 2.476775e-03 3 1  ON 55
ci_57                 1.727106e-03 3 1  ON 56
ci_58                -1.166437e-03 3 1  ON 57
ci_59                -1.404267e-03 3 1  ON 58
ci_60                 1.743686e-04 3 1  ON 59
ci_61                -2.625459e-04 3 1  ON 60
ci_62                -5.503778e-04 3 1  ON 61
ci_63                -6.255140e-04 3 1  ON 62
ci_64                -3.358102e-04 3 1  ON 63
ci_65                -1.274138e-05 3 1  ON 64
ci_66                -6.540147e-04 3 1  ON 65
ci_67                -8.364671e-04 3 1  ON 66
ci_68                -1.169955e-03 3 1  ON 67
ci_69                 5.880724e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7867
    reference variance = 0.345054
====================================================
  Execution time = 2.7662e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4056e-01
  Total weights = 1.9642e+06
  Execution time = 3.4842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430091904423
                                         uncertainty =       0.002058175968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430091904423
                                         uncertainty =       0.002058175968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463682129
  error estimate for blocks of size 2^( 2) =       0.000489675565
  error estimate for blocks of size 2^( 3) =       0.000513982912
  error estimate for blocks of size 2^( 4) =       0.000531178835
  error estimate for blocks of size 2^( 5) =       0.000541618412
  error estimate for blocks of size 2^( 6) =       0.000545625520
  error estimate for blocks of size 2^( 7) =       0.000549925392

      target function =      -0.753232042168
              le_mean =     -22.815414119073
             les_mean =     520.983719202748
             stat err =       0.000542087040
             autocorr =       1.366775961365
   target nu stat err =       0.000542087040
   target dn stat err =       0.002372039509
      target stat err =       0.002099944619
              std dev =       0.655745556023
             le_variance =       0.430002234244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430089183729
                                         uncertainty =       0.002058746992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430089183729
                                         uncertainty =       0.002058746992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463680697
  error estimate for blocks of size 2^( 2) =       0.000489678029
  error estimate for blocks of size 2^( 3) =       0.000513989731
  error estimate for blocks of size 2^( 4) =       0.000531188558
  error estimate for blocks of size 2^( 5) =       0.000541630189
  error estimate for blocks of size 2^( 6) =       0.000545641034
  error estimate for blocks of size 2^( 7) =       0.000549945740

      target function =      -0.713858362953
              le_mean =     -22.815414187381
             les_mean =     521.030427832481
             stat err =       0.000542101380
             autocorr =       1.366856723176
   target nu stat err =       0.000542101380
   target dn stat err =       0.046834377156
      target stat err =       0.035730155821
              std dev =       0.655743530108
             le_variance =       0.429999577279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430090243746
                                         uncertainty =       0.002058462176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430090243746
                                         uncertainty =       0.002058462176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463681252
  error estimate for blocks of size 2^( 2) =       0.000489676592
  error estimate for blocks of size 2^( 3) =       0.000513986007
  error estimate for blocks of size 2^( 4) =       0.000531183563
  error estimate for blocks of size 2^( 5) =       0.000541624350
  error estimate for blocks of size 2^( 6) =       0.000545633177
  error estimate for blocks of size 2^( 7) =       0.000549934705

      target function =      -0.753277434776
              le_mean =     -22.815414308385
             les_mean =     520.983674261997
             stat err =       0.000542093949
             autocorr =       1.366815977064
   target nu stat err =       0.000542093949
   target dn stat err =       0.002372442135
      target stat err =       0.002100516355
              std dev =       0.655744314797
             le_variance =       0.430000606388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430091678202
                                         uncertainty =       0.002058211682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430091678202
                                         uncertainty =       0.002058211682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463682010
  error estimate for blocks of size 2^( 2) =       0.000489675684
  error estimate for blocks of size 2^( 3) =       0.000513983291
  error estimate for blocks of size 2^( 4) =       0.000531179420
  error estimate for blocks of size 2^( 5) =       0.000541619148
  error estimate for blocks of size 2^( 6) =       0.000545626471
  error estimate for blocks of size 2^( 7) =       0.000549926553

      target function =      -0.753246804951
              le_mean =     -22.815414139595
             les_mean =     520.983702713601
             stat err =       0.000542087898
             autocorr =       1.366780995272
   target nu stat err =       0.000542087898
   target dn stat err =       0.002371993841
      target stat err =       0.002099986787
              std dev =       0.655745386687
             le_variance =       0.430002012161


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.753232042168        initial
     1.4552e+00     1.4552e+01             1.0914e-04        -0.713858362953
     5.8208e+00     5.8208e+01             2.7641e-05        -0.753277434776  <--
     2.3283e+01     2.3283e+02             6.9330e-06        -0.753246804951

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 4.9315e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.264125e-01 3 1  ON 0
ci_02                -2.867220e-02 3 1  ON 1
ci_03                -2.855089e-02 3 1  ON 2
ci_04                 2.656100e-02 3 1  ON 3
ci_05                -2.184460e-02 3 1  ON 4
ci_06                -2.151913e-02 3 1  ON 5
ci_07                 2.706644e-02 3 1  ON 6
ci_08                -5.441758e-03 3 1  ON 7
ci_09                -8.815591e-03 3 1  ON 8
ci_10                -8.329910e-03 3 1  ON 9
ci_11                 1.309127e-02 3 1  ON 10
ci_12                 6.938611e-03 3 1  ON 11
ci_13                 1.304435e-02 3 1  ON 12
ci_14                 1.255262e-02 3 1  ON 13
ci_15                 6.399635e-03 3 1  ON 14
ci_16                 6.266062e-03 3 1  ON 15
ci_17                -7.193440e-03 3 1  ON 16
ci_18                -6.024140e-03 3 1  ON 17
ci_19                 9.270767e-03 3 1  ON 18
ci_20                 6.500331e-03 3 1  ON 19
ci_21                 8.954537e-03 3 1  ON 20
ci_22                 8.286380e-03 3 1  ON 21
ci_23                 4.839988e-03 3 1  ON 22
ci_24                 4.089816e-03 3 1  ON 23
ci_25                 2.841955e-03 3 1  ON 24
ci_26                 3.087401e-03 3 1  ON 25
ci_27                 3.186402e-03 3 1  ON 26
ci_28                 1.750101e-03 3 1  ON 27
ci_29                 1.475204e-03 3 1  ON 28
ci_30                -1.756699e-03 3 1  ON 29
ci_31                -4.825732e-04 3 1  ON 30
ci_32                -9.615611e-04 3 1  ON 31
ci_33                -1.382236e-03 3 1  ON 32
ci_34                 1.078227e-03 3 1  ON 33
ci_35                 1.545444e-03 3 1  ON 34
ci_36                -1.078740e-03 3 1  ON 35
ci_37                -1.044289e-03 3 1  ON 36
ci_38                -6.200725e-04 3 1  ON 37
ci_39                -5.829952e-04 3 1  ON 38
ci_40                -1.513444e-03 3 1  ON 39
ci_41                -1.195992e-03 3 1  ON 40
ci_42                -1.182102e-03 3 1  ON 41
ci_43                -2.230680e-03 3 1  ON 42
ci_44                -2.956053e-03 3 1  ON 43
ci_45                -5.553555e-04 3 1  ON 44
ci_46                -7.088175e-04 3 1  ON 45
ci_47                 1.594339e-03 3 1  ON 46
ci_48                 1.424268e-03 3 1  ON 47
ci_49                -9.584001e-04 3 1  ON 48
ci_50                -7.578045e-04 3 1  ON 49
ci_51                 1.265111e-04 3 1  ON 50
ci_52                 1.734709e-04 3 1  ON 51
ci_53                -7.033425e-04 3 1  ON 52
ci_54                -1.067579e-03 3 1  ON 53
ci_55                -6.711173e-04 3 1  ON 54
ci_56                 2.476775e-03 3 1  ON 55
ci_57                 1.727106e-03 3 1  ON 56
ci_58                -1.166437e-03 3 1  ON 57
ci_59                -1.404267e-03 3 1  ON 58
ci_60                 1.743686e-04 3 1  ON 59
ci_61                -2.625459e-04 3 1  ON 60
ci_62                -5.503778e-04 3 1  ON 61
ci_63                -6.255140e-04 3 1  ON 62
ci_64                -3.358102e-04 3 1  ON 63
ci_65                -1.274138e-05 3 1  ON 64
ci_66                -6.540147e-04 3 1  ON 65
ci_67                -8.364671e-04 3 1  ON 66
ci_68                -1.169955e-03 3 1  ON 67
ci_69                 5.880724e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2219e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7337
    reference variance = 0.484606
====================================================
  Execution time = 3.1695e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4641e-01
  Total weights = 1.964421501e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432820839370
                                         uncertainty =       0.001944456334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432820839370
                                         uncertainty =       0.001944456334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465177850
  error estimate for blocks of size 2^( 2) =       0.000490511937
  error estimate for blocks of size 2^( 3) =       0.000514634266
  error estimate for blocks of size 2^( 4) =       0.000531987466
  error estimate for blocks of size 2^( 5) =       0.000543601102
  error estimate for blocks of size 2^( 6) =       0.000550475522
  error estimate for blocks of size 2^( 7) =       0.000555389805

      target function =      -0.748337353866
              le_mean =     -22.815780965025
             les_mean =     521.006273615970
             stat err =       0.000545363474
             autocorr =       1.374466124355
   target nu stat err =       0.000545363474
   target dn stat err =       0.002699215497
      target stat err =       0.002339141670
              std dev =       0.657860824071
             le_variance =       0.432780863847


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281578096502e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748343641832       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748350465273       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748351133130       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748351331680       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748351323608       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748351291520       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748351290220       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748351285622       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748351284077       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748351283432       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+00 is 9.485209e-05

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748343641832       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748345390971       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748345559938       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748345609531       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748345607091       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748345598966       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748345598658       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748345597523       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748345597151       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748345596998       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+00 is 2.400957e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748343641832       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748344081908       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748344124275       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748344136669       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748344136032       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748344133994       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748344133918       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748344133636       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748344133543       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748344133506       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+01 is 6.021232e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134782 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6202e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.263885e-01 3 1  ON 0
ci_02                -2.866385e-02 3 1  ON 1
ci_03                -2.854760e-02 3 1  ON 2
ci_04                 2.655556e-02 3 1  ON 3
ci_05                -2.184294e-02 3 1  ON 4
ci_06                -2.151766e-02 3 1  ON 5
ci_07                 2.706515e-02 3 1  ON 6
ci_08                -5.439112e-03 3 1  ON 7
ci_09                -8.802971e-03 3 1  ON 8
ci_10                -8.326195e-03 3 1  ON 9
ci_11                 1.309168e-02 3 1  ON 10
ci_12                 6.927684e-03 3 1  ON 11
ci_13                 1.303634e-02 3 1  ON 12
ci_14                 1.255647e-02 3 1  ON 13
ci_15                 6.405815e-03 3 1  ON 14
ci_16                 6.260167e-03 3 1  ON 15
ci_17                -7.198045e-03 3 1  ON 16
ci_18                -6.023081e-03 3 1  ON 17
ci_19                 9.275111e-03 3 1  ON 18
ci_20                 6.504454e-03 3 1  ON 19
ci_21                 8.947581e-03 3 1  ON 20
ci_22                 8.284376e-03 3 1  ON 21
ci_23                 4.834786e-03 3 1  ON 22
ci_24                 4.094292e-03 3 1  ON 23
ci_25                 2.843568e-03 3 1  ON 24
ci_26                 3.090877e-03 3 1  ON 25
ci_27                 3.182036e-03 3 1  ON 26
ci_28                 1.743393e-03 3 1  ON 27
ci_29                 1.479737e-03 3 1  ON 28
ci_30                -1.743927e-03 3 1  ON 29
ci_31                -4.827465e-04 3 1  ON 30
ci_32                -9.524281e-04 3 1  ON 31
ci_33                -1.379663e-03 3 1  ON 32
ci_34                 1.085274e-03 3 1  ON 33
ci_35                 1.548036e-03 3 1  ON 34
ci_36                -1.077147e-03 3 1  ON 35
ci_37                -1.038843e-03 3 1  ON 36
ci_38                -6.173753e-04 3 1  ON 37
ci_39                -5.894939e-04 3 1  ON 38
ci_40                -1.517156e-03 3 1  ON 39
ci_41                -1.206330e-03 3 1  ON 40
ci_42                -1.182173e-03 3 1  ON 41
ci_43                -2.222230e-03 3 1  ON 42
ci_44                -2.949423e-03 3 1  ON 43
ci_45                -5.540896e-04 3 1  ON 44
ci_46                -7.085114e-04 3 1  ON 45
ci_47                 1.605285e-03 3 1  ON 46
ci_48                 1.432454e-03 3 1  ON 47
ci_49                -9.385647e-04 3 1  ON 48
ci_50                -7.563234e-04 3 1  ON 49
ci_51                 1.258919e-04 3 1  ON 50
ci_52                 1.664364e-04 3 1  ON 51
ci_53                -7.051540e-04 3 1  ON 52
ci_54                -1.062139e-03 3 1  ON 53
ci_55                -6.740029e-04 3 1  ON 54
ci_56                 2.467893e-03 3 1  ON 55
ci_57                 1.727044e-03 3 1  ON 56
ci_58                -1.152510e-03 3 1  ON 57
ci_59                -1.398901e-03 3 1  ON 58
ci_60                 1.945127e-04 3 1  ON 59
ci_61                -2.653396e-04 3 1  ON 60
ci_62                -5.487724e-04 3 1  ON 61
ci_63                -6.233347e-04 3 1  ON 62
ci_64                -3.367942e-04 3 1  ON 63
ci_65                -2.278887e-05 3 1  ON 64
ci_66                -6.541158e-04 3 1  ON 65
ci_67                -8.273703e-04 3 1  ON 66
ci_68                -1.172553e-03 3 1  ON 67
ci_69                 4.335853e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7588
    reference variance = 0.299134
====================================================
  Execution time = 2.6833e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4831e-01
  Total weights = 1.9645e+06
  Execution time = 3.4857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436419439546
                                         uncertainty =       0.002140606430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436419439546
                                         uncertainty =       0.002140606430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467126041
  error estimate for blocks of size 2^( 2) =       0.000493054386
  error estimate for blocks of size 2^( 3) =       0.000517179190
  error estimate for blocks of size 2^( 4) =       0.000535000165
  error estimate for blocks of size 2^( 5) =       0.000545395994
  error estimate for blocks of size 2^( 6) =       0.000551395454
  error estimate for blocks of size 2^( 7) =       0.000555131477

      target function =      -0.746746772720
              le_mean =     -22.813643867533
             les_mean =     520.910660110777
             stat err =       0.000546730772
             autocorr =       1.369868499336
   target nu stat err =       0.000546730772
   target dn stat err =       0.002796799163
      target stat err =       0.002400835815
              std dev =       0.660615983187
             le_variance =       0.436413477242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436416134165
                                         uncertainty =       0.002140766419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436416134165
                                         uncertainty =       0.002140766419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467124267
  error estimate for blocks of size 2^( 2) =       0.000493055087
  error estimate for blocks of size 2^( 3) =       0.000517181817
  error estimate for blocks of size 2^( 4) =       0.000535003950
  error estimate for blocks of size 2^( 5) =       0.000545402353
  error estimate for blocks of size 2^( 6) =       0.000551401875
  error estimate for blocks of size 2^( 7) =       0.000555139605

      target function =      -0.746718497180
              le_mean =     -22.813643248966
             les_mean =     520.910665925661
             stat err =       0.000546736945
             autocorr =       1.369909839603
   target nu stat err =       0.000546736945
   target dn stat err =       0.002798411983
      target stat err =       0.002401954995
              std dev =       0.660613474039
             le_variance =       0.436410162081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436417613336
                                         uncertainty =       0.002140690000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436417613336
                                         uncertainty =       0.002140690000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467125061
  error estimate for blocks of size 2^( 2) =       0.000493054728
  error estimate for blocks of size 2^( 3) =       0.000517180515
  error estimate for blocks of size 2^( 4) =       0.000535002138
  error estimate for blocks of size 2^( 5) =       0.000545399217
  error estimate for blocks of size 2^( 6) =       0.000551398646
  error estimate for blocks of size 2^( 7) =       0.000555135268

      target function =      -0.745967642315
              le_mean =     -22.813643496896
             les_mean =     520.911581433513
             stat err =       0.000546733817
             autocorr =       1.369889504245
   target nu stat err =       0.000546733817
   target dn stat err =       0.002949832139
      target stat err =       0.002518873536
              std dev =       0.660614597134
             le_variance =       0.436411645946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436419192252
                                         uncertainty =       0.002140616923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436419192252
                                         uncertainty =       0.002140616923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467125909
  error estimate for blocks of size 2^( 2) =       0.000493054412
  error estimate for blocks of size 2^( 3) =       0.000517179342
  error estimate for blocks of size 2^( 4) =       0.000535000391
  error estimate for blocks of size 2^( 5) =       0.000545396388
  error estimate for blocks of size 2^( 6) =       0.000551395850
  error estimate for blocks of size 2^( 7) =       0.000555131981

      target function =      -0.746747573406
              le_mean =     -22.813643823458
             les_mean =     520.910657134925
             stat err =       0.000546731153
             autocorr =       1.369871182650
   target nu stat err =       0.000546731153
   target dn stat err =       0.002796881383
      target stat err =       0.002400906803
              std dev =       0.660615795530
             le_variance =       0.436413229304


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746746772720        initial
     1.4552e+00     1.4552e+01             9.4852e-05        -0.746718497180
     5.8208e+00     5.8208e+01             2.4010e-05        -0.745967642315
     2.3283e+01     2.3283e+02             6.0212e-06        -0.746747573406  <--

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 4.4327e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.264065e-01 3 1  ON 0
ci_02                -2.867010e-02 3 1  ON 1
ci_03                -2.855006e-02 3 1  ON 2
ci_04                 2.655963e-02 3 1  ON 3
ci_05                -2.184418e-02 3 1  ON 4
ci_06                -2.151876e-02 3 1  ON 5
ci_07                 2.706611e-02 3 1  ON 6
ci_08                -5.441092e-03 3 1  ON 7
ci_09                -8.812420e-03 3 1  ON 8
ci_10                -8.328977e-03 3 1  ON 9
ci_11                 1.309137e-02 3 1  ON 10
ci_12                 6.935862e-03 3 1  ON 11
ci_13                 1.304234e-02 3 1  ON 12
ci_14                 1.255359e-02 3 1  ON 13
ci_15                 6.401188e-03 3 1  ON 14
ci_16                 6.264580e-03 3 1  ON 15
ci_17                -7.194597e-03 3 1  ON 16
ci_18                -6.023874e-03 3 1  ON 17
ci_19                 9.271860e-03 3 1  ON 18
ci_20                 6.501367e-03 3 1  ON 19
ci_21                 8.952792e-03 3 1  ON 20
ci_22                 8.285878e-03 3 1  ON 21
ci_23                 4.838679e-03 3 1  ON 22
ci_24                 4.090939e-03 3 1  ON 23
ci_25                 2.842361e-03 3 1  ON 24
ci_26                 3.088275e-03 3 1  ON 25
ci_27                 3.185304e-03 3 1  ON 26
ci_28                 1.748415e-03 3 1  ON 27
ci_29                 1.476344e-03 3 1  ON 28
ci_30                -1.753493e-03 3 1  ON 29
ci_31                -4.826167e-04 3 1  ON 30
ci_32                -9.592634e-04 3 1  ON 31
ci_33                -1.381588e-03 3 1  ON 32
ci_34                 1.079999e-03 3 1  ON 33
ci_35                 1.546096e-03 3 1  ON 34
ci_36                -1.078339e-03 3 1  ON 35
ci_37                -1.042918e-03 3 1  ON 36
ci_38                -6.193940e-04 3 1  ON 37
ci_39                -5.846301e-04 3 1  ON 38
ci_40                -1.514379e-03 3 1  ON 39
ci_41                -1.198593e-03 3 1  ON 40
ci_42                -1.182119e-03 3 1  ON 41
ci_43                -2.228557e-03 3 1  ON 42
ci_44                -2.954386e-03 3 1  ON 43
ci_45                -5.550367e-04 3 1  ON 44
ci_46                -7.087404e-04 3 1  ON 45
ci_47                 1.597088e-03 3 1  ON 46
ci_48                 1.426323e-03 3 1  ON 47
ci_49                -9.534084e-04 3 1  ON 48
ci_50                -7.574316e-04 3 1  ON 49
ci_51                 1.263554e-04 3 1  ON 50
ci_52                 1.717013e-04 3 1  ON 51
ci_53                -7.037986e-04 3 1  ON 52
ci_54                -1.066211e-03 3 1  ON 53
ci_55                -6.718425e-04 3 1  ON 54
ci_56                 2.474540e-03 3 1  ON 55
ci_57                 1.727090e-03 3 1  ON 56
ci_58                -1.162933e-03 3 1  ON 57
ci_59                -1.402918e-03 3 1  ON 58
ci_60                 1.794186e-04 3 1  ON 59
ci_61                -2.632459e-04 3 1  ON 60
ci_62                -5.499734e-04 3 1  ON 61
ci_63                -6.249656e-04 3 1  ON 62
ci_64                -3.360572e-04 3 1  ON 63
ci_65                -1.526923e-05 3 1  ON 64
ci_66                -6.540402e-04 3 1  ON 65
ci_67                -8.341787e-04 3 1  ON 66
ci_68                -1.170609e-03 3 1  ON 67
ci_69                 5.492212e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8488e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.8318
    reference variance = 0.237459
====================================================
  Execution time = 5.0100e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5366e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4784e-01
  Total weights = 1.964461329e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436135334053
                                         uncertainty =       0.002288162145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436135334053
                                         uncertainty =       0.002288162145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466971684
  error estimate for blocks of size 2^( 2) =       0.000492128889
  error estimate for blocks of size 2^( 3) =       0.000515540996
  error estimate for blocks of size 2^( 4) =       0.000533398615
  error estimate for blocks of size 2^( 5) =       0.000543849413
  error estimate for blocks of size 2^( 6) =       0.000549932959
  error estimate for blocks of size 2^( 7) =       0.000555298346

      target function =      -0.747141846330
              le_mean =     -22.815674047040
             les_mean =     521.002825309501
             stat err =       0.000545619833
             autocorr =       1.365209191873
   target nu stat err =       0.000545619833
   target dn stat err =       0.002792999057
      target stat err =       0.002407204609
              std dev =       0.660397688763
             le_variance =       0.436125107324


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281567404704e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747148675458       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747150253536       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747150505755       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747150557535       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747150568342       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747150569616       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747150570718       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747150571773       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747150572765       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+00 is 1.812081e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747148675458       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747149072546       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747149135802       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747149148749       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747149151437       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747149151749       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747149152024       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747149152287       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747149152533       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+01 is 4.556930e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747148675458       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747148774892       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747148790718       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747148793955       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747148794626       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747148794704       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747148794773       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747148794838       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747148794900       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 1.140915e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137852 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.4627e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.264051e-01 3 1  ON 0
ci_02                -2.867283e-02 3 1  ON 1
ci_03                -2.854921e-02 3 1  ON 2
ci_04                 2.655877e-02 3 1  ON 3
ci_05                -2.184176e-02 3 1  ON 4
ci_06                -2.151683e-02 3 1  ON 5
ci_07                 2.706294e-02 3 1  ON 6
ci_08                -5.442390e-03 3 1  ON 7
ci_09                -8.813513e-03 3 1  ON 8
ci_10                -8.324725e-03 3 1  ON 9
ci_11                 1.309000e-02 3 1  ON 10
ci_12                 6.933512e-03 3 1  ON 11
ci_13                 1.304153e-02 3 1  ON 12
ci_14                 1.255427e-02 3 1  ON 13
ci_15                 6.401938e-03 3 1  ON 14
ci_16                 6.269124e-03 3 1  ON 15
ci_17                -7.194254e-03 3 1  ON 16
ci_18                -6.023003e-03 3 1  ON 17
ci_19                 9.268956e-03 3 1  ON 18
ci_20                 6.502547e-03 3 1  ON 19
ci_21                 8.951883e-03 3 1  ON 20
ci_22                 8.286086e-03 3 1  ON 21
ci_23                 4.840014e-03 3 1  ON 22
ci_24                 4.091750e-03 3 1  ON 23
ci_25                 2.840508e-03 3 1  ON 24
ci_26                 3.088923e-03 3 1  ON 25
ci_27                 3.186249e-03 3 1  ON 26
ci_28                 1.747529e-03 3 1  ON 27
ci_29                 1.476738e-03 3 1  ON 28
ci_30                -1.751056e-03 3 1  ON 29
ci_31                -4.846799e-04 3 1  ON 30
ci_32                -9.573290e-04 3 1  ON 31
ci_33                -1.380783e-03 3 1  ON 32
ci_34                 1.080479e-03 3 1  ON 33
ci_35                 1.542345e-03 3 1  ON 34
ci_36                -1.078938e-03 3 1  ON 35
ci_37                -1.041401e-03 3 1  ON 36
ci_38                -6.194598e-04 3 1  ON 37
ci_39                -5.842351e-04 3 1  ON 38
ci_40                -1.513399e-03 3 1  ON 39
ci_41                -1.198375e-03 3 1  ON 40
ci_42                -1.183087e-03 3 1  ON 41
ci_43                -2.225003e-03 3 1  ON 42
ci_44                -2.953227e-03 3 1  ON 43
ci_45                -5.548826e-04 3 1  ON 44
ci_46                -7.095988e-04 3 1  ON 45
ci_47                 1.596366e-03 3 1  ON 46
ci_48                 1.427452e-03 3 1  ON 47
ci_49                -9.534674e-04 3 1  ON 48
ci_50                -7.587615e-04 3 1  ON 49
ci_51                 1.254033e-04 3 1  ON 50
ci_52                 1.732896e-04 3 1  ON 51
ci_53                -7.022852e-04 3 1  ON 52
ci_54                -1.065064e-03 3 1  ON 53
ci_55                -6.682678e-04 3 1  ON 54
ci_56                 2.473033e-03 3 1  ON 55
ci_57                 1.728110e-03 3 1  ON 56
ci_58                -1.162057e-03 3 1  ON 57
ci_59                -1.402276e-03 3 1  ON 58
ci_60                 1.763708e-04 3 1  ON 59
ci_61                -2.613086e-04 3 1  ON 60
ci_62                -5.502017e-04 3 1  ON 61
ci_63                -6.236530e-04 3 1  ON 62
ci_64                -3.373508e-04 3 1  ON 63
ci_65                -1.494440e-05 3 1  ON 64
ci_66                -6.533383e-04 3 1  ON 65
ci_67                -8.358608e-04 3 1  ON 66
ci_68                -1.169862e-03 3 1  ON 67
ci_69                 5.036519e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7771
    reference variance = 0.388878
====================================================
  Execution time = 2.5575e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4677e-01
  Total weights = 1.9647e+06
  Execution time = 3.4677e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435390890471
                                         uncertainty =       0.002235139100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435390890471
                                         uncertainty =       0.002235139100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466611514
  error estimate for blocks of size 2^( 2) =       0.000492344511
  error estimate for blocks of size 2^( 3) =       0.000515890091
  error estimate for blocks of size 2^( 4) =       0.000532782298
  error estimate for blocks of size 2^( 5) =       0.000543945743
  error estimate for blocks of size 2^( 6) =       0.000549944173
  error estimate for blocks of size 2^( 7) =       0.000554054800

      target function =      -0.748031147713
              le_mean =     -22.814424919961
             les_mean =     520.944757284488
             stat err =       0.000545181753
             autocorr =       1.365122804752
   target nu stat err =       0.000545181753
   target dn stat err =       0.002919831979
      target stat err =       0.002510666874
              std dev =       0.659888331589
             le_variance =       0.435452610167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435389574626
                                         uncertainty =       0.002234798756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435389574626
                                         uncertainty =       0.002234798756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466610793
  error estimate for blocks of size 2^( 2) =       0.000492344083
  error estimate for blocks of size 2^( 3) =       0.000515890188
  error estimate for blocks of size 2^( 4) =       0.000532782703
  error estimate for blocks of size 2^( 5) =       0.000543946505
  error estimate for blocks of size 2^( 6) =       0.000549944600
  error estimate for blocks of size 2^( 7) =       0.000554055756

      target function =      -0.748038335499
              le_mean =     -22.814424956886
             les_mean =     520.944750365059
             stat err =       0.000545182391
             autocorr =       1.365130218881
   target nu stat err =       0.000545182391
   target dn stat err =       0.002918119262
      target stat err =       0.002509327653
              std dev =       0.659887311417
             le_variance =       0.435451263769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435390218846
                                         uncertainty =       0.002234967982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435390218846
                                         uncertainty =       0.002234967982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466611146
  error estimate for blocks of size 2^( 2) =       0.000492344291
  error estimate for blocks of size 2^( 3) =       0.000515890135
  error estimate for blocks of size 2^( 4) =       0.000532782497
  error estimate for blocks of size 2^( 5) =       0.000543946122
  error estimate for blocks of size 2^( 6) =       0.000549944383
  error estimate for blocks of size 2^( 7) =       0.000554055275

      target function =      -0.748035657767
              le_mean =     -22.814424937320
             les_mean =     520.944752676535
             stat err =       0.000545182069
             autocorr =       1.365126540463
   target nu stat err =       0.000545182069
   target dn stat err =       0.002918931958
      target stat err =       0.002509967885
              std dev =       0.659887811061
             le_variance =       0.435451923187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435390805272
                                         uncertainty =       0.002235117668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435390805272
                                         uncertainty =       0.002235117668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466611467
  error estimate for blocks of size 2^( 2) =       0.000492344483
  error estimate for blocks of size 2^( 3) =       0.000515890096
  error estimate for blocks of size 2^( 4) =       0.000532782322
  error estimate for blocks of size 2^( 5) =       0.000543945790
  error estimate for blocks of size 2^( 6) =       0.000549944199
  error estimate for blocks of size 2^( 7) =       0.000554054859

      target function =      -0.748031818890
              le_mean =     -22.814424921994
             les_mean =     520.944756573522
             stat err =       0.000545181792
             autocorr =       1.365123273104
   target nu stat err =       0.000545181792
   target dn stat err =       0.002919714914
      target stat err =       0.002510576507
              std dev =       0.659888265578
             le_variance =       0.435452523047


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748031147713        initial
     5.8208e+00     5.8208e+01             1.8121e-05        -0.748038335499  <--
     2.3283e+01     2.3283e+02             4.5569e-06        -0.748035657767
     9.3132e+01     9.3132e+02             1.1409e-06        -0.748031818890

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 4.3014e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.264011e-01 3 1  ON 0
ci_02                -2.868098e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655623e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446245e-03 3 1  ON 7
ci_09                -8.816770e-03 3 1  ON 8
ci_10                -8.312049e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926519e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255630e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282659e-03 3 1  ON 15
ci_17                -7.193231e-03 3 1  ON 16
ci_18                -6.020409e-03 3 1  ON 17
ci_19                 9.260323e-03 3 1  ON 18
ci_20                 6.506061e-03 3 1  ON 19
ci_21                 8.949159e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843984e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189060e-03 3 1  ON 26
ci_28                 1.744887e-03 3 1  ON 27
ci_29                 1.477911e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908393e-04 3 1  ON 30
ci_32                -9.515757e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081910e-03 3 1  ON 33
ci_35                 1.531173e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036888e-03 3 1  ON 36
ci_38                -6.196545e-04 3 1  ON 37
ci_39                -5.830597e-04 3 1  ON 38
ci_40                -1.510484e-03 3 1  ON 39
ci_41                -1.197728e-03 3 1  ON 40
ci_42                -1.185966e-03 3 1  ON 41
ci_43                -2.214416e-03 3 1  ON 42
ci_44                -2.949773e-03 3 1  ON 43
ci_45                -5.544252e-04 3 1  ON 44
ci_46                -7.121504e-04 3 1  ON 45
ci_47                 1.594211e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536433e-04 3 1  ON 48
ci_50                -7.627124e-04 3 1  ON 49
ci_51                 1.225704e-04 3 1  ON 50
ci_52                 1.780127e-04 3 1  ON 51
ci_53                -6.977880e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576265e-04 3 1  ON 54
ci_56                 2.468554e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159447e-03 3 1  ON 57
ci_59                -1.400367e-03 3 1  ON 58
ci_60                 1.672616e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508807e-04 3 1  ON 61
ci_63                -6.197512e-04 3 1  ON 62
ci_64                -3.411994e-04 3 1  ON 63
ci_65                -1.397848e-05 3 1  ON 64
ci_66                -6.512488e-04 3 1  ON 65
ci_67                -8.408637e-04 3 1  ON 66
ci_68                -1.167639e-03 3 1  ON 67
ci_69                 3.680131e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.7648e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8919
    reference variance = 0.367436
====================================================
  Execution time = 5.7072e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5058e-01
  Total weights = 1.964433942e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5505e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436726171219
                                         uncertainty =       0.002552378641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436726171219
                                         uncertainty =       0.002552378641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467255564
  error estimate for blocks of size 2^( 2) =       0.000492586877
  error estimate for blocks of size 2^( 3) =       0.000516122870
  error estimate for blocks of size 2^( 4) =       0.000533424153
  error estimate for blocks of size 2^( 5) =       0.000543337055
  error estimate for blocks of size 2^( 6) =       0.000550114904
  error estimate for blocks of size 2^( 7) =       0.000555273920

      target function =      -0.744858243117
              le_mean =     -22.814446717585
             les_mean =     520.949562856700
             stat err =       0.000545537508
             autocorr =       1.363139391935
   target nu stat err =       0.000545537508
   target dn stat err =       0.004036580233
      target stat err =       0.003393748906
              std dev =       0.660799155464
             le_variance =       0.436655523862


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281444671759e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744872681459       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744897450433       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744898854995       residual = 5.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744899274516       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744899442339       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744899434567       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744899450728       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744899441623       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744899443272       residual = 7.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+00 is 1.879763e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744872681459       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744879039413       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744879396688       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744879502036       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744879543814       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744879541566       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744879545445       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744879543195       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744879543596       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+00 is 4.826888e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744872681459       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744874281653       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744874371362       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744874397727       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744874408159       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744874407577       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744874408537       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744874407976       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744874408075       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+01 is 1.214961e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1631e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.263827e-01 3 1  ON 0
ci_02                -2.868224e-02 3 1  ON 1
ci_03                -2.854268e-02 3 1  ON 2
ci_04                 2.654216e-02 3 1  ON 3
ci_05                -2.181904e-02 3 1  ON 4
ci_06                -2.151472e-02 3 1  ON 5
ci_07                 2.704890e-02 3 1  ON 6
ci_08                -5.443650e-03 3 1  ON 7
ci_09                -8.806226e-03 3 1  ON 8
ci_10                -8.302033e-03 3 1  ON 9
ci_11                 1.308167e-02 3 1  ON 10
ci_12                 6.941767e-03 3 1  ON 11
ci_13                 1.303806e-02 3 1  ON 12
ci_14                 1.256514e-02 3 1  ON 13
ci_15                 6.404914e-03 3 1  ON 14
ci_16                 6.265373e-03 3 1  ON 15
ci_17                -7.192351e-03 3 1  ON 16
ci_18                -6.025506e-03 3 1  ON 17
ci_19                 9.254264e-03 3 1  ON 18
ci_20                 6.481620e-03 3 1  ON 19
ci_21                 8.945999e-03 3 1  ON 20
ci_22                 8.294062e-03 3 1  ON 21
ci_23                 4.804952e-03 3 1  ON 22
ci_24                 4.082258e-03 3 1  ON 23
ci_25                 2.786727e-03 3 1  ON 24
ci_26                 3.104043e-03 3 1  ON 25
ci_27                 3.187652e-03 3 1  ON 26
ci_28                 1.755151e-03 3 1  ON 27
ci_29                 1.464459e-03 3 1  ON 28
ci_30                -1.728364e-03 3 1  ON 29
ci_31                -5.041230e-04 3 1  ON 30
ci_32                -9.517284e-04 3 1  ON 31
ci_33                -1.386022e-03 3 1  ON 32
ci_34                 1.078023e-03 3 1  ON 33
ci_35                 1.517628e-03 3 1  ON 34
ci_36                -1.087138e-03 3 1  ON 35
ci_37                -1.033468e-03 3 1  ON 36
ci_38                -6.150097e-04 3 1  ON 37
ci_39                -5.868108e-04 3 1  ON 38
ci_40                -1.504121e-03 3 1  ON 39
ci_41                -1.221042e-03 3 1  ON 40
ci_42                -1.172717e-03 3 1  ON 41
ci_43                -2.203598e-03 3 1  ON 42
ci_44                -2.936358e-03 3 1  ON 43
ci_45                -5.535018e-04 3 1  ON 44
ci_46                -7.086893e-04 3 1  ON 45
ci_47                 1.595630e-03 3 1  ON 46
ci_48                 1.439798e-03 3 1  ON 47
ci_49                -9.426127e-04 3 1  ON 48
ci_50                -7.678378e-04 3 1  ON 49
ci_51                 1.257530e-04 3 1  ON 50
ci_52                 1.881102e-04 3 1  ON 51
ci_53                -7.031613e-04 3 1  ON 52
ci_54                -1.056522e-03 3 1  ON 53
ci_55                -6.639378e-04 3 1  ON 54
ci_56                 2.474310e-03 3 1  ON 55
ci_57                 1.751700e-03 3 1  ON 56
ci_58                -1.173642e-03 3 1  ON 57
ci_59                -1.394020e-03 3 1  ON 58
ci_60                 1.676370e-04 3 1  ON 59
ci_61                -2.662219e-04 3 1  ON 60
ci_62                -5.457799e-04 3 1  ON 61
ci_63                -6.113840e-04 3 1  ON 62
ci_64                -3.482466e-04 3 1  ON 63
ci_65                -1.689462e-05 3 1  ON 64
ci_66                -6.509475e-04 3 1  ON 65
ci_67                -8.350197e-04 3 1  ON 66
ci_68                -1.175144e-03 3 1  ON 67
ci_69                 2.777434e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.811
    reference variance = 0.386689
====================================================
  Execution time = 3.3500e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5191e-01
  Total weights = 1.9641e+06
  Execution time = 3.9771e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435715740323
                                         uncertainty =       0.002125441623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435715740323
                                         uncertainty =       0.002125441623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466751458
  error estimate for blocks of size 2^( 2) =       0.000492292810
  error estimate for blocks of size 2^( 3) =       0.000515989322
  error estimate for blocks of size 2^( 4) =       0.000533421196
  error estimate for blocks of size 2^( 5) =       0.000544861050
  error estimate for blocks of size 2^( 6) =       0.000550799904
  error estimate for blocks of size 2^( 7) =       0.000553303007

      target function =      -0.743760526915
              le_mean =     -22.814600781317
             les_mean =     520.957920916914
             stat err =       0.000545596289
             autocorr =       1.366379850076
   target nu stat err =       0.000545596289
   target dn stat err =       0.004038165546
      target stat err =       0.003385989101
              std dev =       0.660086242525
             le_variance =       0.435713847571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435702124518
                                         uncertainty =       0.002121102555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435702124518
                                         uncertainty =       0.002121102555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466744243
  error estimate for blocks of size 2^( 2) =       0.000492289281
  error estimate for blocks of size 2^( 3) =       0.000515988508
  error estimate for blocks of size 2^( 4) =       0.000533423974
  error estimate for blocks of size 2^( 5) =       0.000544867258
  error estimate for blocks of size 2^( 6) =       0.000550804347
  error estimate for blocks of size 2^( 7) =       0.000553302696

      target function =      -0.743295078898
              le_mean =     -22.814601073831
             les_mean =     520.958499129723
             stat err =       0.000545599569
             autocorr =       1.366438520521
   target nu stat err =       0.000545599569
   target dn stat err =       0.004003249061
      target stat err =       0.003353518947
              std dev =       0.660076038865
             le_variance =       0.435700377083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435708293620
                                         uncertainty =       0.002123199744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435708293620
                                         uncertainty =       0.002123199744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466747510
  error estimate for blocks of size 2^( 2) =       0.000492290795
  error estimate for blocks of size 2^( 3) =       0.000515988712
  error estimate for blocks of size 2^( 4) =       0.000533422366
  error estimate for blocks of size 2^( 5) =       0.000544863856
  error estimate for blocks of size 2^( 6) =       0.000550801703
  error estimate for blocks of size 2^( 7) =       0.000553302072

      target function =      -0.743756544171
              le_mean =     -22.814600787697
             les_mean =     520.957926308719
             stat err =       0.000545597499
             autocorr =       1.366409028199
   target nu stat err =       0.000545597499
   target dn stat err =       0.004007711826
      target stat err =       0.003361236331
              std dev =       0.660080658639
             le_variance =       0.435706475910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435714746627
                                         uncertainty =       0.002125156710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435714746627
                                         uncertainty =       0.002125156710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466750931
  error estimate for blocks of size 2^( 2) =       0.000492292528
  error estimate for blocks of size 2^( 3) =       0.000515989219
  error estimate for blocks of size 2^( 4) =       0.000533421321
  error estimate for blocks of size 2^( 5) =       0.000544861379
  error estimate for blocks of size 2^( 6) =       0.000550800104
  error estimate for blocks of size 2^( 7) =       0.000553302860

      target function =      -0.743760021692
              le_mean =     -22.814600773473
             les_mean =     520.957921206677
             stat err =       0.000545596416
             autocorr =       1.366383571057
   target nu stat err =       0.000545596416
   target dn stat err =       0.004034250857
      target stat err =       0.003382806886
              std dev =       0.660085497019
             le_variance =       0.435712863374


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743760526915        initial  <--
     1.4552e+00     1.4552e+01             1.8798e-04        -0.743295078898
     5.8208e+00     5.8208e+01             4.8269e-05        -0.743756544171
     2.3283e+01     2.3283e+02             1.2150e-05        -0.743760021692

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 51.4147
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.264011e-01 3 1  ON 0
ci_02                -2.868098e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655623e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446245e-03 3 1  ON 7
ci_09                -8.816770e-03 3 1  ON 8
ci_10                -8.312049e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926519e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255630e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282659e-03 3 1  ON 15
ci_17                -7.193231e-03 3 1  ON 16
ci_18                -6.020409e-03 3 1  ON 17
ci_19                 9.260323e-03 3 1  ON 18
ci_20                 6.506061e-03 3 1  ON 19
ci_21                 8.949159e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843984e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189060e-03 3 1  ON 26
ci_28                 1.744887e-03 3 1  ON 27
ci_29                 1.477911e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908393e-04 3 1  ON 30
ci_32                -9.515757e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081910e-03 3 1  ON 33
ci_35                 1.531173e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036888e-03 3 1  ON 36
ci_38                -6.196545e-04 3 1  ON 37
ci_39                -5.830597e-04 3 1  ON 38
ci_40                -1.510484e-03 3 1  ON 39
ci_41                -1.197728e-03 3 1  ON 40
ci_42                -1.185966e-03 3 1  ON 41
ci_43                -2.214416e-03 3 1  ON 42
ci_44                -2.949773e-03 3 1  ON 43
ci_45                -5.544252e-04 3 1  ON 44
ci_46                -7.121504e-04 3 1  ON 45
ci_47                 1.594211e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536433e-04 3 1  ON 48
ci_50                -7.627124e-04 3 1  ON 49
ci_51                 1.225704e-04 3 1  ON 50
ci_52                 1.780127e-04 3 1  ON 51
ci_53                -6.977880e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576265e-04 3 1  ON 54
ci_56                 2.468554e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159447e-03 3 1  ON 57
ci_59                -1.400367e-03 3 1  ON 58
ci_60                 1.672616e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508807e-04 3 1  ON 61
ci_63                -6.197512e-04 3 1  ON 62
ci_64                -3.411994e-04 3 1  ON 63
ci_65                -1.397848e-05 3 1  ON 64
ci_66                -6.512488e-04 3 1  ON 65
ci_67                -8.408637e-04 3 1  ON 66
ci_68                -1.167639e-03 3 1  ON 67
ci_69                 3.680131e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1458e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.7609
    reference variance = 0.321974
====================================================
  Execution time = 2.5868e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5005e-01
  Total weights = 1.964212129e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435945145545
                                         uncertainty =       0.001983971067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435945145545
                                         uncertainty =       0.001983971067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466879779
  error estimate for blocks of size 2^( 2) =       0.000492603676
  error estimate for blocks of size 2^( 3) =       0.000516689068
  error estimate for blocks of size 2^( 4) =       0.000534555556
  error estimate for blocks of size 2^( 5) =       0.000544138825
  error estimate for blocks of size 2^( 6) =       0.000551772354
  error estimate for blocks of size 2^( 7) =       0.000555394175

      target function =      -0.745305209726
              le_mean =     -22.815338532369
             les_mean =     520.989723406948
             stat err =       0.000546465227
             autocorr =       1.369982236376
   target nu stat err =       0.000546465227
   target dn stat err =       0.002950691796
      target stat err =       0.002521515424
              std dev =       0.660267714847
             le_variance =       0.435953455270


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281533853237e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745312771723       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745314175210       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745314408966       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745314450252       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745314459894       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745314468669       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745314466859       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745314465651       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745314465733       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+01 is 1.783120e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745312771723       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745313123514       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745313182034       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745313192359       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745313194763       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745313196952       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745313196499       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745313196197       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745313196218       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+01 is 4.463790e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745312771723       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745312859728       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745312874363       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745312876945       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745312877546       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745312878093       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745312877979       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745312877904       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745312877909       residual = 6.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+02 is 1.116322e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144032 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0372e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_01                 1.263966e-01 3 1  ON 0
ci_02                -2.868163e-02 3 1  ON 1
ci_03                -2.854282e-02 3 1  ON 2
ci_04                 2.655555e-02 3 1  ON 3
ci_05                -2.183547e-02 3 1  ON 4
ci_06                -2.151121e-02 3 1  ON 5
ci_07                 2.705317e-02 3 1  ON 6
ci_08                -5.446765e-03 3 1  ON 7
ci_09                -8.817055e-03 3 1  ON 8
ci_10                -8.311089e-03 3 1  ON 9
ci_11                 1.308488e-02 3 1  ON 10
ci_12                 6.926659e-03 3 1  ON 11
ci_13                 1.303903e-02 3 1  ON 12
ci_14                 1.255700e-02 3 1  ON 13
ci_15                 6.403842e-03 3 1  ON 14
ci_16                 6.281707e-03 3 1  ON 15
ci_17                -7.193582e-03 3 1  ON 16
ci_18                -6.020578e-03 3 1  ON 17
ci_19                 9.259776e-03 3 1  ON 18
ci_20                 6.506557e-03 3 1  ON 19
ci_21                 8.948568e-03 3 1  ON 20
ci_22                 8.287379e-03 3 1  ON 21
ci_23                 4.844261e-03 3 1  ON 22
ci_24                 4.095022e-03 3 1  ON 23
ci_25                 2.835297e-03 3 1  ON 24
ci_26                 3.090291e-03 3 1  ON 25
ci_27                 3.190211e-03 3 1  ON 26
ci_28                 1.746615e-03 3 1  ON 27
ci_29                 1.477850e-03 3 1  ON 28
ci_30                -1.743254e-03 3 1  ON 29
ci_31                -4.907611e-04 3 1  ON 30
ci_32                -9.508506e-04 3 1  ON 31
ci_33                -1.380135e-03 3 1  ON 32
ci_34                 1.082226e-03 3 1  ON 33
ci_35                 1.530394e-03 3 1  ON 34
ci_36                -1.080496e-03 3 1  ON 35
ci_37                -1.037135e-03 3 1  ON 36
ci_38                -6.196695e-04 3 1  ON 37
ci_39                -5.825919e-04 3 1  ON 38
ci_40                -1.509259e-03 3 1  ON 39
ci_41                -1.197410e-03 3 1  ON 40
ci_42                -1.184724e-03 3 1  ON 41
ci_43                -2.217835e-03 3 1  ON 42
ci_44                -2.949483e-03 3 1  ON 43
ci_45                -5.545600e-04 3 1  ON 44
ci_46                -7.118839e-04 3 1  ON 45
ci_47                 1.593771e-03 3 1  ON 46
ci_48                 1.429219e-03 3 1  ON 47
ci_49                -9.542454e-04 3 1  ON 48
ci_50                -7.630789e-04 3 1  ON 49
ci_51                 1.223434e-04 3 1  ON 50
ci_52                 1.773488e-04 3 1  ON 51
ci_53                -6.973701e-04 3 1  ON 52
ci_54                -1.061731e-03 3 1  ON 53
ci_55                -6.565923e-04 3 1  ON 54
ci_56                 2.468579e-03 3 1  ON 55
ci_57                 1.731286e-03 3 1  ON 56
ci_58                -1.159560e-03 3 1  ON 57
ci_59                -1.399424e-03 3 1  ON 58
ci_60                 1.656948e-04 3 1  ON 59
ci_61                -2.561091e-04 3 1  ON 60
ci_62                -5.513239e-04 3 1  ON 61
ci_63                -6.195314e-04 3 1  ON 62
ci_64                -3.401224e-04 3 1  ON 63
ci_65                -1.514662e-05 3 1  ON 64
ci_66                -6.507155e-04 3 1  ON 65
ci_67                -8.405303e-04 3 1  ON 66
ci_68                -1.168570e-03 3 1  ON 67
ci_69                 3.874416e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.7889
    reference variance = 0.309759
====================================================
  Execution time = 2.5228e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4475e-01
  Total weights = 1.9644e+06
  Execution time = 3.4904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430386982540
                                         uncertainty =       0.001510746219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430386982540
                                         uncertainty =       0.001510746219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463859398
  error estimate for blocks of size 2^( 2) =       0.000488991388
  error estimate for blocks of size 2^( 3) =       0.000512597344
  error estimate for blocks of size 2^( 4) =       0.000530568552
  error estimate for blocks of size 2^( 5) =       0.000541969002
  error estimate for blocks of size 2^( 6) =       0.000548727142
  error estimate for blocks of size 2^( 7) =       0.000552341555

      target function =      -0.749738895617
              le_mean =     -22.815096292183
             les_mean =     520.973355822456
             stat err =       0.000543401563
             autocorr =       1.372363142022
   target nu stat err =       0.000543401563
   target dn stat err =       0.002644133822
      target stat err =       0.002300046675
              std dev =       0.655996252145
             le_variance =       0.430331082828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430387905923
                                         uncertainty =       0.001510897264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430387905923
                                         uncertainty =       0.001510897264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463859900
  error estimate for blocks of size 2^( 2) =       0.000488992245
  error estimate for blocks of size 2^( 3) =       0.000512598567
  error estimate for blocks of size 2^( 4) =       0.000530570051
  error estimate for blocks of size 2^( 5) =       0.000541970538
  error estimate for blocks of size 2^( 6) =       0.000548728760
  error estimate for blocks of size 2^( 7) =       0.000552343204

      target function =      -0.749704284644
              le_mean =     -22.815096365623
             les_mean =     520.973400382391
             stat err =       0.000543403138
             autocorr =       1.372368131348
   target nu stat err =       0.000543403138
   target dn stat err =       0.002652742836
      target stat err =       0.002306808058
              std dev =       0.655996961633
             le_variance =       0.430332013672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430387441523
                                         uncertainty =       0.001510821777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430387441523
                                         uncertainty =       0.001510821777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463859648
  error estimate for blocks of size 2^( 2) =       0.000488991816
  error estimate for blocks of size 2^( 3) =       0.000512597955
  error estimate for blocks of size 2^( 4) =       0.000530569301
  error estimate for blocks of size 2^( 5) =       0.000541969771
  error estimate for blocks of size 2^( 6) =       0.000548727952
  error estimate for blocks of size 2^( 7) =       0.000552342380

      target function =      -0.749680878419
              le_mean =     -22.815096328723
             les_mean =     520.973426625621
             stat err =       0.000543402351
             autocorr =       1.372365647192
   target nu stat err =       0.000543402351
   target dn stat err =       0.002648765932
      target stat err =       0.002303450941
              std dev =       0.655996604834
             le_variance =       0.430331545553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430387039528
                                         uncertainty =       0.001510755655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430387039528
                                         uncertainty =       0.001510755655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463859429
  error estimate for blocks of size 2^( 2) =       0.000488991441
  error estimate for blocks of size 2^( 3) =       0.000512597420
  error estimate for blocks of size 2^( 4) =       0.000530568645
  error estimate for blocks of size 2^( 5) =       0.000541969098
  error estimate for blocks of size 2^( 6) =       0.000548727243
  error estimate for blocks of size 2^( 7) =       0.000552341658

      target function =      -0.749736744939
              le_mean =     -22.815096296679
             les_mean =     520.973358588253
             stat err =       0.000543401661
             autocorr =       1.372363455014
   target nu stat err =       0.000543401661
   target dn stat err =       0.002644657400
      target stat err =       0.002300457608
              std dev =       0.655996295938
             le_variance =       0.430331140284


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749738895617        initial  <--
     1.4552e+01     1.4552e+02             1.7831e-05        -0.749704284644
     5.8208e+01     5.8208e+02             4.4638e-06        -0.749680878419
     2.3283e+02     2.3283e+03             1.1163e-06        -0.749736744939

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7387
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_01                 1.264011e-01 3 1  ON 0
ci_02                -2.868098e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655623e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446245e-03 3 1  ON 7
ci_09                -8.816770e-03 3 1  ON 8
ci_10                -8.312049e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926519e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255630e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282659e-03 3 1  ON 15
ci_17                -7.193231e-03 3 1  ON 16
ci_18                -6.020409e-03 3 1  ON 17
ci_19                 9.260323e-03 3 1  ON 18
ci_20                 6.506061e-03 3 1  ON 19
ci_21                 8.949159e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843984e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189060e-03 3 1  ON 26
ci_28                 1.744887e-03 3 1  ON 27
ci_29                 1.477911e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908393e-04 3 1  ON 30
ci_32                -9.515757e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081910e-03 3 1  ON 33
ci_35                 1.531173e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036888e-03 3 1  ON 36
ci_38                -6.196545e-04 3 1  ON 37
ci_39                -5.830597e-04 3 1  ON 38
ci_40                -1.510484e-03 3 1  ON 39
ci_41                -1.197728e-03 3 1  ON 40
ci_42                -1.185966e-03 3 1  ON 41
ci_43                -2.214416e-03 3 1  ON 42
ci_44                -2.949773e-03 3 1  ON 43
ci_45                -5.544252e-04 3 1  ON 44
ci_46                -7.121504e-04 3 1  ON 45
ci_47                 1.594211e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536433e-04 3 1  ON 48
ci_50                -7.627124e-04 3 1  ON 49
ci_51                 1.225704e-04 3 1  ON 50
ci_52                 1.780127e-04 3 1  ON 51
ci_53                -6.977880e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576265e-04 3 1  ON 54
ci_56                 2.468554e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159447e-03 3 1  ON 57
ci_59                -1.400367e-03 3 1  ON 58
ci_60                 1.672616e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508807e-04 3 1  ON 61
ci_63                -6.197512e-04 3 1  ON 62
ci_64                -3.411994e-04 3 1  ON 63
ci_65                -1.397848e-05 3 1  ON 64
ci_66                -6.512488e-04 3 1  ON 65
ci_67                -8.408637e-04 3 1  ON 66
ci_68                -1.167639e-03 3 1  ON 67
ci_69                 3.680131e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3117e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.8053
    reference variance = 0.762905
====================================================
  Execution time = 2.6104e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6709e-01
  Total weights = 1.964316017e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432958167129
                                         uncertainty =       0.002083584841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432958167129
                                         uncertainty =       0.002083584841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465307253
  error estimate for blocks of size 2^( 2) =       0.000491059431
  error estimate for blocks of size 2^( 3) =       0.000514891241
  error estimate for blocks of size 2^( 4) =       0.000533034295
  error estimate for blocks of size 2^( 5) =       0.000543957524
  error estimate for blocks of size 2^( 6) =       0.000549230717
  error estimate for blocks of size 2^( 7) =       0.000551816931

      target function =      -0.731129239031
              le_mean =     -22.814535656468
             les_mean =     520.970128023427
             stat err =       0.000544509867
             autocorr =       1.369404857319
   target nu stat err =       0.000544509867
   target dn stat err =       0.019558536174
      target stat err =       0.015608847068
              std dev =       0.658043827180
             le_variance =       0.433021678490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281453565647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.731461141075       residual = 9.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.731461761417       residual = 8.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.731461812988       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.731461820989       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.731461821074       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.731461821312       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.731461821318       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.731461821329       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.731461821373       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.731461821415       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+02 is 2.960643e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.731461141075       residual = 9.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.731461296198       residual = 8.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.731461309093       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.731461311093       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.731461311114       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.731461311174       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.731461311174       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.731461311179       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.731461311188       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.731461311201       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+02 is 7.403464e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.731461141075       residual = 9.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.731461179858       residual = 8.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.731461183082       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.731461183582       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.731461183588       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.731461183605       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.731461183603       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.731461183603       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.731461183606       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.731461183603       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+03 is 1.850982e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147560 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0598e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_01                 1.264011e-01 3 1  ON 0
ci_02                -2.868100e-02 3 1  ON 1
ci_03                -2.854621e-02 3 1  ON 2
ci_04                 2.655629e-02 3 1  ON 3
ci_05                -2.183417e-02 3 1  ON 4
ci_06                -2.151147e-02 3 1  ON 5
ci_07                 2.705358e-02 3 1  ON 6
ci_08                -5.446283e-03 3 1  ON 7
ci_09                -8.817013e-03 3 1  ON 8
ci_10                -8.311605e-03 3 1  ON 9
ci_11                 1.308587e-02 3 1  ON 10
ci_12                 6.927259e-03 3 1  ON 11
ci_13                 1.303902e-02 3 1  ON 12
ci_14                 1.255621e-02 3 1  ON 13
ci_15                 6.403638e-03 3 1  ON 14
ci_16                 6.282980e-03 3 1  ON 15
ci_17                -7.192919e-03 3 1  ON 16
ci_18                -6.020615e-03 3 1  ON 17
ci_19                 9.260105e-03 3 1  ON 18
ci_20                 6.506421e-03 3 1  ON 19
ci_21                 8.949085e-03 3 1  ON 20
ci_22                 8.286773e-03 3 1  ON 21
ci_23                 4.844030e-03 3 1  ON 22
ci_24                 4.094133e-03 3 1  ON 23
ci_25                 2.834966e-03 3 1  ON 24
ci_26                 3.090787e-03 3 1  ON 25
ci_27                 3.188748e-03 3 1  ON 26
ci_28                 1.744721e-03 3 1  ON 27
ci_29                 1.478034e-03 3 1  ON 28
ci_30                -1.743997e-03 3 1  ON 29
ci_31                -4.909507e-04 3 1  ON 30
ci_32                -9.515948e-04 3 1  ON 31
ci_33                -1.378585e-03 3 1  ON 32
ci_34                 1.082491e-03 3 1  ON 33
ci_35                 1.531013e-03 3 1  ON 34
ci_36                -1.080719e-03 3 1  ON 35
ci_37                -1.036916e-03 3 1  ON 36
ci_38                -6.197237e-04 3 1  ON 37
ci_39                -5.830300e-04 3 1  ON 38
ci_40                -1.510383e-03 3 1  ON 39
ci_41                -1.197766e-03 3 1  ON 40
ci_42                -1.185895e-03 3 1  ON 41
ci_43                -2.214568e-03 3 1  ON 42
ci_44                -2.949801e-03 3 1  ON 43
ci_45                -5.543362e-04 3 1  ON 44
ci_46                -7.121092e-04 3 1  ON 45
ci_47                 1.594272e-03 3 1  ON 46
ci_48                 1.430931e-03 3 1  ON 47
ci_49                -9.534291e-04 3 1  ON 48
ci_50                -7.627541e-04 3 1  ON 49
ci_51                 1.225745e-04 3 1  ON 50
ci_52                 1.780223e-04 3 1  ON 51
ci_53                -6.978682e-04 3 1  ON 52
ci_54                -1.061532e-03 3 1  ON 53
ci_55                -6.575466e-04 3 1  ON 54
ci_56                 2.468381e-03 3 1  ON 55
ci_57                 1.731264e-03 3 1  ON 56
ci_58                -1.159408e-03 3 1  ON 57
ci_59                -1.400776e-03 3 1  ON 58
ci_60                 1.672445e-04 3 1  ON 59
ci_61                -2.555409e-04 3 1  ON 60
ci_62                -5.507131e-04 3 1  ON 61
ci_63                -6.197199e-04 3 1  ON 62
ci_64                -3.413863e-04 3 1  ON 63
ci_65                -1.428549e-05 3 1  ON 64
ci_66                -6.511751e-04 3 1  ON 65
ci_67                -8.408373e-04 3 1  ON 66
ci_68                -1.167600e-03 3 1  ON 67
ci_69                 3.655309e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.8594
    reference variance = 0.292689
====================================================
  Execution time = 2.5241e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4944e-01
  Total weights = 1.9644e+06
  Execution time = 3.7657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434057541772
                                         uncertainty =       0.002423856558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434057541772
                                         uncertainty =       0.002423856558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465836737
  error estimate for blocks of size 2^( 2) =       0.000491096992
  error estimate for blocks of size 2^( 3) =       0.000515355043
  error estimate for blocks of size 2^( 4) =       0.000533710994
  error estimate for blocks of size 2^( 5) =       0.000544686814
  error estimate for blocks of size 2^( 6) =       0.000550940054
  error estimate for blocks of size 2^( 7) =       0.000555977167

      target function =      -0.745802342145
              le_mean =     -22.815034781315
             les_mean =     520.975255718248
             stat err =       0.000546328757
             autocorr =       1.375436838910
   target nu stat err =       0.000546328757
   target dn stat err =       0.004043371611
      target stat err =       0.003410911247
              std dev =       0.658792631754
             le_variance =       0.434007731653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434057463500
                                         uncertainty =       0.002423821918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434057463500
                                         uncertainty =       0.002423821918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465836696
  error estimate for blocks of size 2^( 2) =       0.000491096960
  error estimate for blocks of size 2^( 3) =       0.000515355021
  error estimate for blocks of size 2^( 4) =       0.000533710961
  error estimate for blocks of size 2^( 5) =       0.000544686768
  error estimate for blocks of size 2^( 6) =       0.000550940059
  error estimate for blocks of size 2^( 7) =       0.000555977208

      target function =      -0.745801427346
              le_mean =     -22.815034796501
             les_mean =     520.975257511017
             stat err =       0.000546328749
             autocorr =       1.375437037687
   target nu stat err =       0.000546328749
   target dn stat err =       0.004043637914
      target stat err =       0.003411120605
              std dev =       0.658792573746
             le_variance =       0.434007655222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434057502466
                                         uncertainty =       0.002423839231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434057502466
                                         uncertainty =       0.002423839231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465836717
  error estimate for blocks of size 2^( 2) =       0.000491096976
  error estimate for blocks of size 2^( 3) =       0.000515355032
  error estimate for blocks of size 2^( 4) =       0.000533710978
  error estimate for blocks of size 2^( 5) =       0.000544686791
  error estimate for blocks of size 2^( 6) =       0.000550940056
  error estimate for blocks of size 2^( 7) =       0.000555977188

      target function =      -0.745801910309
              le_mean =     -22.815034788883
             les_mean =     520.975256582704
             stat err =       0.000546328753
             autocorr =       1.375436938386
   target nu stat err =       0.000546328753
   target dn stat err =       0.004043504571
      target stat err =       0.003411016000
              std dev =       0.658792602621
             le_variance =       0.434007693268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434057536841
                                         uncertainty =       0.002423854392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434057536841
                                         uncertainty =       0.002423854392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465836735
  error estimate for blocks of size 2^( 2) =       0.000491096990
  error estimate for blocks of size 2^( 3) =       0.000515355042
  error estimate for blocks of size 2^( 4) =       0.000533710992
  error estimate for blocks of size 2^( 5) =       0.000544686811
  error estimate for blocks of size 2^( 6) =       0.000550940054
  error estimate for blocks of size 2^( 7) =       0.000555977170

      target function =      -0.745802290994
              le_mean =     -22.815034782258
             les_mean =     520.975255822768
             stat err =       0.000546328757
             autocorr =       1.375436851363
   target nu stat err =       0.000546328757
   target dn stat err =       0.004043388205
      target stat err =       0.003410924345
              std dev =       0.658792628098
             le_variance =       0.434007726837


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745802342145        initial  <--
     1.4552e+02     1.4552e+03             2.9606e-06        -0.745801427346
     5.8208e+02     5.8208e+03             7.4035e-07        -0.745801910309
     2.3283e+03     2.3283e+04             1.8510e-07        -0.745802290994

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4491
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_01                 1.264011e-01 3 1  ON 0
ci_02                -2.868098e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655623e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446245e-03 3 1  ON 7
ci_09                -8.816770e-03 3 1  ON 8
ci_10                -8.312049e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926519e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255630e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282659e-03 3 1  ON 15
ci_17                -7.193231e-03 3 1  ON 16
ci_18                -6.020409e-03 3 1  ON 17
ci_19                 9.260323e-03 3 1  ON 18
ci_20                 6.506061e-03 3 1  ON 19
ci_21                 8.949159e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843984e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189060e-03 3 1  ON 26
ci_28                 1.744887e-03 3 1  ON 27
ci_29                 1.477911e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908393e-04 3 1  ON 30
ci_32                -9.515757e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081910e-03 3 1  ON 33
ci_35                 1.531173e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036888e-03 3 1  ON 36
ci_38                -6.196545e-04 3 1  ON 37
ci_39                -5.830597e-04 3 1  ON 38
ci_40                -1.510484e-03 3 1  ON 39
ci_41                -1.197728e-03 3 1  ON 40
ci_42                -1.185966e-03 3 1  ON 41
ci_43                -2.214416e-03 3 1  ON 42
ci_44                -2.949773e-03 3 1  ON 43
ci_45                -5.544252e-04 3 1  ON 44
ci_46                -7.121504e-04 3 1  ON 45
ci_47                 1.594211e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536433e-04 3 1  ON 48
ci_50                -7.627124e-04 3 1  ON 49
ci_51                 1.225704e-04 3 1  ON 50
ci_52                 1.780127e-04 3 1  ON 51
ci_53                -6.977880e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576265e-04 3 1  ON 54
ci_56                 2.468554e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159447e-03 3 1  ON 57
ci_59                -1.400367e-03 3 1  ON 58
ci_60                 1.672616e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508807e-04 3 1  ON 61
ci_63                -6.197512e-04 3 1  ON 62
ci_64                -3.411994e-04 3 1  ON 63
ci_65                -1.397848e-05 3 1  ON 64
ci_66                -6.512488e-04 3 1  ON 65
ci_67                -8.408637e-04 3 1  ON 66
ci_68                -1.167639e-03 3 1  ON 67
ci_69                 3.680131e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4055e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.7688
    reference variance = 0.523292
====================================================
  Execution time = 2.5791e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4678e-01
  Total weights = 1.964273741e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435444478688
                                         uncertainty =       0.002534676061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435444478688
                                         uncertainty =       0.002534676061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466735440
  error estimate for blocks of size 2^( 2) =       0.000492302076
  error estimate for blocks of size 2^( 3) =       0.000516624082
  error estimate for blocks of size 2^( 4) =       0.000534488946
  error estimate for blocks of size 2^( 5) =       0.000545283265
  error estimate for blocks of size 2^( 6) =       0.000551183096
  error estimate for blocks of size 2^( 7) =       0.000554934660

      target function =      -0.748027025373
              le_mean =     -22.814728076631
             les_mean =     520.958597806465
             stat err =       0.000546472492
             autocorr =       1.370866148221
   target nu stat err =       0.000546472492
   target dn stat err =       0.002704405037
      target stat err =       0.002338101332
              std dev =       0.660063589903
             le_variance =       0.435683942715


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281472807663e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748033284387       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748033292441       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748033293953       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748033294597       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748033294776       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748033294847       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748033294866       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748033294855       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748033294844       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748033294844       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+03 is 2.007287e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748033284387       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748033286401       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748033286779       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748033286939       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748033286984       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748033287002       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748033286993       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748033287004       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748033287002       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748033287001       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+03 is 5.018275e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748033284387       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748033284890       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748033284985       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748033285026       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748033285036       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748033285061       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748033285034       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748033285043       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748033285041       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748033285010       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+04 is 1.254572e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0289e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868098e-02 3 1  ON 1
ci_03                -2.854670e-02 3 1  ON 2
ci_04                 2.655621e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705348e-02 3 1  ON 6
ci_08                -5.446235e-03 3 1  ON 7
ci_09                -8.816766e-03 3 1  ON 8
ci_10                -8.312046e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926527e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404169e-03 3 1  ON 14
ci_16                 6.282651e-03 3 1  ON 15
ci_17                -7.193216e-03 3 1  ON 16
ci_18                -6.020402e-03 3 1  ON 17
ci_19                 9.260330e-03 3 1  ON 18
ci_20                 6.506054e-03 3 1  ON 19
ci_21                 8.949154e-03 3 1  ON 20
ci_22                 8.286698e-03 3 1  ON 21
ci_23                 4.843994e-03 3 1  ON 22
ci_24                 4.094173e-03 3 1  ON 23
ci_25                 2.834996e-03 3 1  ON 24
ci_26                 3.090854e-03 3 1  ON 25
ci_27                 3.189054e-03 3 1  ON 26
ci_28                 1.744896e-03 3 1  ON 27
ci_29                 1.477922e-03 3 1  ON 28
ci_30                -1.743773e-03 3 1  ON 29
ci_31                -4.908505e-04 3 1  ON 30
ci_32                -9.515795e-04 3 1  ON 31
ci_33                -1.378390e-03 3 1  ON 32
ci_34                 1.081893e-03 3 1  ON 33
ci_35                 1.531182e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036891e-03 3 1  ON 36
ci_38                -6.196518e-04 3 1  ON 37
ci_39                -5.830601e-04 3 1  ON 38
ci_40                -1.510484e-03 3 1  ON 39
ci_41                -1.197724e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214413e-03 3 1  ON 42
ci_44                -2.949761e-03 3 1  ON 43
ci_45                -5.544239e-04 3 1  ON 44
ci_46                -7.121447e-04 3 1  ON 45
ci_47                 1.594221e-03 3 1  ON 46
ci_48                 1.430838e-03 3 1  ON 47
ci_49                -9.536360e-04 3 1  ON 48
ci_50                -7.627142e-04 3 1  ON 49
ci_51                 1.225747e-04 3 1  ON 50
ci_52                 1.780047e-04 3 1  ON 51
ci_53                -6.977931e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576334e-04 3 1  ON 54
ci_56                 2.468557e-03 3 1  ON 55
ci_57                 1.731143e-03 3 1  ON 56
ci_58                -1.159439e-03 3 1  ON 57
ci_59                -1.400371e-03 3 1  ON 58
ci_60                 1.672485e-04 3 1  ON 59
ci_61                -2.555379e-04 3 1  ON 60
ci_62                -5.508859e-04 3 1  ON 61
ci_63                -6.197488e-04 3 1  ON 62
ci_64                -3.411904e-04 3 1  ON 63
ci_65                -1.398333e-05 3 1  ON 64
ci_66                -6.512451e-04 3 1  ON 65
ci_67                -8.408629e-04 3 1  ON 66
ci_68                -1.167641e-03 3 1  ON 67
ci_69                 3.679534e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.8309
    reference variance = 0.334646
====================================================
  Execution time = 2.5331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4651e-01
  Total weights = 1.9644e+06
  Execution time = 3.4973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430717926675
                                         uncertainty =       0.001696160525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430717926675
                                         uncertainty =       0.001696160525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464021176
  error estimate for blocks of size 2^( 2) =       0.000489702304
  error estimate for blocks of size 2^( 3) =       0.000513627321
  error estimate for blocks of size 2^( 4) =       0.000530541730
  error estimate for blocks of size 2^( 5) =       0.000541298212
  error estimate for blocks of size 2^( 6) =       0.000547252336
  error estimate for blocks of size 2^( 7) =       0.000551908363

      target function =      -0.748245820367
              le_mean =     -22.815982668555
             les_mean =     521.015579199373
             stat err =       0.000542750160
             autocorr =       1.368120402186
   target nu stat err =       0.000542750160
   target dn stat err =       0.003829389085
      target stat err =       0.003261017256
              std dev =       0.656225040438
             le_variance =       0.430631303697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430717920942
                                         uncertainty =       0.001696157429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430717920942
                                         uncertainty =       0.001696157429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464021173
  error estimate for blocks of size 2^( 2) =       0.000489702304
  error estimate for blocks of size 2^( 3) =       0.000513627325
  error estimate for blocks of size 2^( 4) =       0.000530541735
  error estimate for blocks of size 2^( 5) =       0.000541298218
  error estimate for blocks of size 2^( 6) =       0.000547252344
  error estimate for blocks of size 2^( 7) =       0.000551908374

      target function =      -0.748245632215
              le_mean =     -22.815982668768
             les_mean =     521.015579433553
             stat err =       0.000542750168
             autocorr =       1.368120459820
   target nu stat err =       0.000542750168
   target dn stat err =       0.003829441696
      target stat err =       0.003261058899
              std dev =       0.656225036051
             le_variance =       0.430631297940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430717923808
                                         uncertainty =       0.001696158977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430717923808
                                         uncertainty =       0.001696158977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464021175
  error estimate for blocks of size 2^( 2) =       0.000489702304
  error estimate for blocks of size 2^( 3) =       0.000513627323
  error estimate for blocks of size 2^( 4) =       0.000530541732
  error estimate for blocks of size 2^( 5) =       0.000541298215
  error estimate for blocks of size 2^( 6) =       0.000547252340
  error estimate for blocks of size 2^( 7) =       0.000551908369

      target function =      -0.748245726344
              le_mean =     -22.815982668661
             les_mean =     521.015579316399
             stat err =       0.000542750164
             autocorr =       1.368120431013
   target nu stat err =       0.000542750164
   target dn stat err =       0.003829415388
      target stat err =       0.003261038076
              std dev =       0.656225038244
             le_variance =       0.430631300818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430717926316
                                         uncertainty =       0.001696160332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430717926316
                                         uncertainty =       0.001696160332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464021176
  error estimate for blocks of size 2^( 2) =       0.000489702304
  error estimate for blocks of size 2^( 3) =       0.000513627322
  error estimate for blocks of size 2^( 4) =       0.000530541730
  error estimate for blocks of size 2^( 5) =       0.000541298212
  error estimate for blocks of size 2^( 6) =       0.000547252336
  error estimate for blocks of size 2^( 7) =       0.000551908364

      target function =      -0.748245808620
              le_mean =     -22.815982668568
             les_mean =     521.015579213994
             stat err =       0.000542750161
             autocorr =       1.368120405796
   target nu stat err =       0.000542750161
   target dn stat err =       0.003829392373
      target stat err =       0.003261019858
              std dev =       0.656225040163
             le_variance =       0.430631303338


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748245820367        initial  <--
     1.4552e+03     1.4552e+04             2.0073e-07        -0.748245632215
     5.8208e+03     5.8208e+04             5.0183e-08        -0.748245726344
     2.3283e+04     2.3283e+05             1.2546e-08        -0.748245808620

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0003
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_01                 1.264011e-01 3 1  ON 0
ci_02                -2.868098e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655623e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446245e-03 3 1  ON 7
ci_09                -8.816770e-03 3 1  ON 8
ci_10                -8.312049e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926519e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255630e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282659e-03 3 1  ON 15
ci_17                -7.193231e-03 3 1  ON 16
ci_18                -6.020409e-03 3 1  ON 17
ci_19                 9.260323e-03 3 1  ON 18
ci_20                 6.506061e-03 3 1  ON 19
ci_21                 8.949159e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843984e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189060e-03 3 1  ON 26
ci_28                 1.744887e-03 3 1  ON 27
ci_29                 1.477911e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908393e-04 3 1  ON 30
ci_32                -9.515757e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081910e-03 3 1  ON 33
ci_35                 1.531173e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036888e-03 3 1  ON 36
ci_38                -6.196545e-04 3 1  ON 37
ci_39                -5.830597e-04 3 1  ON 38
ci_40                -1.510484e-03 3 1  ON 39
ci_41                -1.197728e-03 3 1  ON 40
ci_42                -1.185966e-03 3 1  ON 41
ci_43                -2.214416e-03 3 1  ON 42
ci_44                -2.949773e-03 3 1  ON 43
ci_45                -5.544252e-04 3 1  ON 44
ci_46                -7.121504e-04 3 1  ON 45
ci_47                 1.594211e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536433e-04 3 1  ON 48
ci_50                -7.627124e-04 3 1  ON 49
ci_51                 1.225704e-04 3 1  ON 50
ci_52                 1.780127e-04 3 1  ON 51
ci_53                -6.977880e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576265e-04 3 1  ON 54
ci_56                 2.468554e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159447e-03 3 1  ON 57
ci_59                -1.400367e-03 3 1  ON 58
ci_60                 1.672616e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508807e-04 3 1  ON 61
ci_63                -6.197512e-04 3 1  ON 62
ci_64                -3.411994e-04 3 1  ON 63
ci_65                -1.397848e-05 3 1  ON 64
ci_66                -6.512488e-04 3 1  ON 65
ci_67                -8.408637e-04 3 1  ON 66
ci_68                -1.167639e-03 3 1  ON 67
ci_69                 3.680131e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3296e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.9196
    reference variance = 0.414811
====================================================
  Execution time = 2.5815e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5168e-01
  Total weights = 1.964654585e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438015316879
                                         uncertainty =       0.002917501478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438015316879
                                         uncertainty =       0.002917501478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467993292
  error estimate for blocks of size 2^( 2) =       0.000493375769
  error estimate for blocks of size 2^( 3) =       0.000516877114
  error estimate for blocks of size 2^( 4) =       0.000534599653
  error estimate for blocks of size 2^( 5) =       0.000546314639
  error estimate for blocks of size 2^( 6) =       0.000554432640
  error estimate for blocks of size 2^( 7) =       0.000557202534

      target function =      -0.743953936926
              le_mean =     -22.814430118149
             les_mean =     520.949905118837
             stat err =       0.000548137367
             autocorr =       1.371827677822
   target nu stat err =       0.000548137367
   target dn stat err =       0.003419038084
      target stat err =       0.002886190268
              std dev =       0.661842461178
             le_variance =       0.438035443418


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281443011815e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743964112890       residual = 8.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743964113395       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743964113455       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743964113488       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743964113497       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743964113500       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743964113531       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743964113517       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743964113492       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 1.896875e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743964112890       residual = 8.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743964113016       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743964113031       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743964113040       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743964113043       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743964112913       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743964113177       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743964113154       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743964113107       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 4.742194e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743964112890       residual = 8.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743964112922       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743964112926       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743964112929       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743964112941       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743964113199       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743964112662       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743964112916       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743964113114       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+05 is 1.185549e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154157 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0324e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_01                 1.264011e-01 3 1  ON 0
ci_02                -2.868098e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446244e-03 3 1  ON 7
ci_09                -8.816769e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926520e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255630e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282659e-03 3 1  ON 15
ci_17                -7.193230e-03 3 1  ON 16
ci_18                -6.020409e-03 3 1  ON 17
ci_19                 9.260323e-03 3 1  ON 18
ci_20                 6.506060e-03 3 1  ON 19
ci_21                 8.949159e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843984e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189061e-03 3 1  ON 26
ci_28                 1.744888e-03 3 1  ON 27
ci_29                 1.477911e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908397e-04 3 1  ON 30
ci_32                -9.515766e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081910e-03 3 1  ON 33
ci_35                 1.531175e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036887e-03 3 1  ON 36
ci_38                -6.196546e-04 3 1  ON 37
ci_39                -5.830597e-04 3 1  ON 38
ci_40                -1.510483e-03 3 1  ON 39
ci_41                -1.197728e-03 3 1  ON 40
ci_42                -1.185966e-03 3 1  ON 41
ci_43                -2.214415e-03 3 1  ON 42
ci_44                -2.949772e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121497e-04 3 1  ON 45
ci_47                 1.594211e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536434e-04 3 1  ON 48
ci_50                -7.627121e-04 3 1  ON 49
ci_51                 1.225700e-04 3 1  ON 50
ci_52                 1.780131e-04 3 1  ON 51
ci_53                -6.977878e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576266e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159447e-03 3 1  ON 57
ci_59                -1.400366e-03 3 1  ON 58
ci_60                 1.672609e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508811e-04 3 1  ON 61
ci_63                -6.197514e-04 3 1  ON 62
ci_64                -3.411993e-04 3 1  ON 63
ci_65                -1.397950e-05 3 1  ON 64
ci_66                -6.512487e-04 3 1  ON 65
ci_67                -8.408632e-04 3 1  ON 66
ci_68                -1.167638e-03 3 1  ON 67
ci_69                 3.680044e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.8624
    reference variance = 0.380924
====================================================
  Execution time = 2.5242e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4514e-01
  Total weights = 1.9645e+06
  Execution time = 3.4673e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429819666768
                                         uncertainty =       0.001553482970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429819666768
                                         uncertainty =       0.001553482970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463567186
  error estimate for blocks of size 2^( 2) =       0.000489111251
  error estimate for blocks of size 2^( 3) =       0.000513506965
  error estimate for blocks of size 2^( 4) =       0.000531643628
  error estimate for blocks of size 2^( 5) =       0.000543076536
  error estimate for blocks of size 2^( 6) =       0.000549076978
  error estimate for blocks of size 2^( 7) =       0.000555926518

      target function =      -0.749394562189
              le_mean =     -22.814350196115
             les_mean =     520.939715378297
             stat err =       0.000544930915
             autocorr =       1.381839240554
   target nu stat err =       0.000544930915
   target dn stat err =       0.003012049433
      target stat err =       0.002594197032
              std dev =       0.655583001129
             le_variance =       0.429789071369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429819665642
                                         uncertainty =       0.001553482916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429819665642
                                         uncertainty =       0.001553482916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463567185
  error estimate for blocks of size 2^( 2) =       0.000489111251
  error estimate for blocks of size 2^( 3) =       0.000513506965
  error estimate for blocks of size 2^( 4) =       0.000531643628
  error estimate for blocks of size 2^( 5) =       0.000543076536
  error estimate for blocks of size 2^( 6) =       0.000549076978
  error estimate for blocks of size 2^( 7) =       0.000555926518

      target function =      -0.749394565636
              le_mean =     -22.814350196184
             les_mean =     520.939715377348
             stat err =       0.000544930915
             autocorr =       1.381839245427
   target nu stat err =       0.000544930915
   target dn stat err =       0.003012048653
      target stat err =       0.002594196421
              std dev =       0.655583000279
             le_variance =       0.429789070255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429819666205
                                         uncertainty =       0.001553482943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429819666205
                                         uncertainty =       0.001553482943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463567185
  error estimate for blocks of size 2^( 2) =       0.000489111251
  error estimate for blocks of size 2^( 3) =       0.000513506965
  error estimate for blocks of size 2^( 4) =       0.000531643628
  error estimate for blocks of size 2^( 5) =       0.000543076536
  error estimate for blocks of size 2^( 6) =       0.000549076978
  error estimate for blocks of size 2^( 7) =       0.000555926518

      target function =      -0.749394563913
              le_mean =     -22.814350196149
             les_mean =     520.939715377823
             stat err =       0.000544930915
             autocorr =       1.381839242978
   target nu stat err =       0.000544930915
   target dn stat err =       0.003012049043
      target stat err =       0.002594196727
              std dev =       0.655583000704
             le_variance =       0.429789070812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429819666697
                                         uncertainty =       0.001553482966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429819666697
                                         uncertainty =       0.001553482966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463567186
  error estimate for blocks of size 2^( 2) =       0.000489111251
  error estimate for blocks of size 2^( 3) =       0.000513506965
  error estimate for blocks of size 2^( 4) =       0.000531643628
  error estimate for blocks of size 2^( 5) =       0.000543076536
  error estimate for blocks of size 2^( 6) =       0.000549076978
  error estimate for blocks of size 2^( 7) =       0.000555926518

      target function =      -0.749394562404
              le_mean =     -22.814350196119
             les_mean =     520.939715378238
             stat err =       0.000544930915
             autocorr =       1.381839240847
   target nu stat err =       0.000544930915
   target dn stat err =       0.003012049384
      target stat err =       0.002594196994
              std dev =       0.655583001076
             le_variance =       0.429789071299


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749394562189        initial
     1.4552e+04     1.4552e+05             1.8969e-08        -0.749394565636  <--
     5.8208e+04     5.8208e+05             4.7422e-09        -0.749394563913
     2.3283e+05     2.3283e+06             1.1855e-09        -0.749394562404

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 4.5982e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6314e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.8612
    reference variance = 0.318987
====================================================
  Execution time = 2.5881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5129e-01
  Total weights = 1.964315183e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5005e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435356017941
                                         uncertainty =       0.001849728183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435356017941
                                         uncertainty =       0.001849728183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466517593
  error estimate for blocks of size 2^( 2) =       0.000492328961
  error estimate for blocks of size 2^( 3) =       0.000516138750
  error estimate for blocks of size 2^( 4) =       0.000533422380
  error estimate for blocks of size 2^( 5) =       0.000544364960
  error estimate for blocks of size 2^( 6) =       0.000551135942
  error estimate for blocks of size 2^( 7) =       0.000553845735

      target function =      -0.744273264532
              le_mean =     -22.814996960834
             les_mean =     520.975379892305
             stat err =       0.000545692254
             autocorr =       1.368231314912
   target nu stat err =       0.000545692254
   target dn stat err =       0.003609990764
      target stat err =       0.003045007354
              std dev =       0.659755507419
             le_variance =       0.435277329570


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281499696083e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744284758017       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744284763315       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744284764010       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744284764040       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744284764029       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744284764030       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744284764022       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744284764009       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744284764022       residual = 9.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 8.335652e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744284758017       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744284759342       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744284759515       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744284759523       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744284759522       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744284759501       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744284759529       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744284759521       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744284759534       residual = 9.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 2.083932e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744284758017       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744284758348       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744284758392       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744284758386       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744284758425       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744284758369       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744284758433       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744284758488       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744284758393       residual = 9.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 5.209843e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0390e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854668e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183451e-02 3 1  ON 4
ci_06                -2.151107e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446247e-03 3 1  ON 7
ci_09                -8.816762e-03 3 1  ON 8
ci_10                -8.312053e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926518e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404169e-03 3 1  ON 14
ci_16                 6.282656e-03 3 1  ON 15
ci_17                -7.193226e-03 3 1  ON 16
ci_18                -6.020412e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506058e-03 3 1  ON 19
ci_21                 8.949155e-03 3 1  ON 20
ci_22                 8.286713e-03 3 1  ON 21
ci_23                 4.843982e-03 3 1  ON 22
ci_24                 4.094174e-03 3 1  ON 23
ci_25                 2.834993e-03 3 1  ON 24
ci_26                 3.090853e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744899e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743782e-03 3 1  ON 29
ci_31                -4.908404e-04 3 1  ON 30
ci_32                -9.515803e-04 3 1  ON 31
ci_33                -1.378393e-03 3 1  ON 32
ci_34                 1.081914e-03 3 1  ON 33
ci_35                 1.531180e-03 3 1  ON 34
ci_36                -1.080719e-03 3 1  ON 35
ci_37                -1.036890e-03 3 1  ON 36
ci_38                -6.196524e-04 3 1  ON 37
ci_39                -5.830583e-04 3 1  ON 38
ci_40                -1.510481e-03 3 1  ON 39
ci_41                -1.197732e-03 3 1  ON 40
ci_42                -1.185962e-03 3 1  ON 41
ci_43                -2.214410e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544266e-04 3 1  ON 44
ci_46                -7.121478e-04 3 1  ON 45
ci_47                 1.594211e-03 3 1  ON 46
ci_48                 1.430824e-03 3 1  ON 47
ci_49                -9.536434e-04 3 1  ON 48
ci_50                -7.627119e-04 3 1  ON 49
ci_51                 1.225681e-04 3 1  ON 50
ci_52                 1.780141e-04 3 1  ON 51
ci_53                -6.977860e-04 3 1  ON 52
ci_54                -1.061652e-03 3 1  ON 53
ci_55                -6.576323e-04 3 1  ON 54
ci_56                 2.468549e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159443e-03 3 1  ON 57
ci_59                -1.400359e-03 3 1  ON 58
ci_60                 1.672540e-04 3 1  ON 59
ci_61                -2.555141e-04 3 1  ON 60
ci_62                -5.508823e-04 3 1  ON 61
ci_63                -6.197531e-04 3 1  ON 62
ci_64                -3.411964e-04 3 1  ON 63
ci_65                -1.398140e-05 3 1  ON 64
ci_66                -6.512481e-04 3 1  ON 65
ci_67                -8.408583e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679761e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.9099
    reference variance = 0.378168
====================================================
  Execution time = 2.5370e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4721e-01
  Total weights = 1.9644e+06
  Execution time = 3.4812e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434110290459
                                         uncertainty =       0.001857481919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434110290459
                                         uncertainty =       0.001857481919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465939700
  error estimate for blocks of size 2^( 2) =       0.000491953888
  error estimate for blocks of size 2^( 3) =       0.000516648537
  error estimate for blocks of size 2^( 4) =       0.000535507355
  error estimate for blocks of size 2^( 5) =       0.000546369885
  error estimate for blocks of size 2^( 6) =       0.000550221541
  error estimate for blocks of size 2^( 7) =       0.000555332980

      target function =      -0.747670818777
              le_mean =     -22.815228788656
             les_mean =     520.981875424066
             stat err =       0.000546857940
             autocorr =       1.377493673561
   target nu stat err =       0.000546857940
   target dn stat err =       0.002396618070
      target stat err =       0.002090950410
              std dev =       0.658938243448
             le_variance =       0.434199608678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434110285820
                                         uncertainty =       0.001857481947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434110285820
                                         uncertainty =       0.001857481947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465939698
  error estimate for blocks of size 2^( 2) =       0.000491953888
  error estimate for blocks of size 2^( 3) =       0.000516648540
  error estimate for blocks of size 2^( 4) =       0.000535507359
  error estimate for blocks of size 2^( 5) =       0.000546369891
  error estimate for blocks of size 2^( 6) =       0.000550221547
  error estimate for blocks of size 2^( 7) =       0.000555332985

      target function =      -0.747669832479
              le_mean =     -22.815228787996
             les_mean =     520.981876575799
             stat err =       0.000546857945
             autocorr =       1.377493713198
   target nu stat err =       0.000546857945
   target dn stat err =       0.002396635723
      target stat err =       0.002090959217
              std dev =       0.658938239941
             le_variance =       0.434199604057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434110288139
                                         uncertainty =       0.001857481933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434110288139
                                         uncertainty =       0.001857481933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465939699
  error estimate for blocks of size 2^( 2) =       0.000491953888
  error estimate for blocks of size 2^( 3) =       0.000516648538
  error estimate for blocks of size 2^( 4) =       0.000535507357
  error estimate for blocks of size 2^( 5) =       0.000546369888
  error estimate for blocks of size 2^( 6) =       0.000550221544
  error estimate for blocks of size 2^( 7) =       0.000555332983

      target function =      -0.747670332051
              le_mean =     -22.815228788326
             les_mean =     520.981875992235
             stat err =       0.000546857943
             autocorr =       1.377493693372
   target nu stat err =       0.000546857943
   target dn stat err =       0.002396626717
      target stat err =       0.002090954705
              std dev =       0.658938241694
             le_variance =       0.434199606367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434110290169
                                         uncertainty =       0.001857481920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434110290169
                                         uncertainty =       0.001857481920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465939700
  error estimate for blocks of size 2^( 2) =       0.000491953888
  error estimate for blocks of size 2^( 3) =       0.000516648537
  error estimate for blocks of size 2^( 4) =       0.000535507355
  error estimate for blocks of size 2^( 5) =       0.000546369886
  error estimate for blocks of size 2^( 6) =       0.000550221542
  error estimate for blocks of size 2^( 7) =       0.000555332981

      target function =      -0.747670758620
              le_mean =     -22.815228788615
             les_mean =     520.981875494268
             stat err =       0.000546857941
             autocorr =       1.377493676033
   target nu stat err =       0.000546857941
   target dn stat err =       0.002396619132
      target stat err =       0.002090950935
              std dev =       0.658938243229
             le_variance =       0.434199608389


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747670818777        initial  <--
     3.6380e+03     3.6380e+04             8.3357e-08        -0.747669832479
     1.4552e+04     1.4552e+05             2.0839e-08        -0.747670332051
     5.8208e+04     5.8208e+05             5.2098e-09        -0.747670758620

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8491
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5834e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.9157
    reference variance = 0.7754
====================================================
  Execution time = 2.5936e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4512e-01
  Total weights = 1.964270265e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5049e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433282371073
                                         uncertainty =       0.002128021236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433282371073
                                         uncertainty =       0.002128021236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465432495
  error estimate for blocks of size 2^( 2) =       0.000491434195
  error estimate for blocks of size 2^( 3) =       0.000516043775
  error estimate for blocks of size 2^( 4) =       0.000533605438
  error estimate for blocks of size 2^( 5) =       0.000545921753
  error estimate for blocks of size 2^( 6) =       0.000552775207
  error estimate for blocks of size 2^( 7) =       0.000556110729

      target function =      -0.749420502006
              le_mean =     -22.815225341654
             les_mean =     520.979622672289
             stat err =       0.000547103282
             autocorr =       1.381736525400
   target nu stat err =       0.000547103282
   target dn stat err =       0.002976147450
      target stat err =       0.002569089122
              std dev =       0.658220946684
             le_variance =       0.433254814653


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281522534165e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749428303870       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749428304162       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749428304198       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749428304215       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749428304256       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749428304258       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749428304252       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749428304166       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749428304272       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+04 is 5.612033e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749428303870       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749428303943       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749428303952       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749428303956       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749428303958       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749428304053       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749428303963       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749428303394       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749428303742       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+05 is 1.403009e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749428303870       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749428303888       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749428303890       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749428303995       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749428303956       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749428303490       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749428304028       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749428303253       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749428302370       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+05 is 3.507523e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160303 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0449e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834994e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908408e-04 3 1  ON 30
ci_32                -9.515796e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196552e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197730e-03 3 1  ON 40
ci_42                -1.185968e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544252e-04 3 1  ON 44
ci_46                -7.121473e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536442e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225691e-04 3 1  ON 50
ci_52                 1.780148e-04 3 1  ON 51
ci_53                -6.977870e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576267e-04 3 1  ON 54
ci_56                 2.468552e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400360e-03 3 1  ON 58
ci_60                 1.672579e-04 3 1  ON 59
ci_61                -2.555172e-04 3 1  ON 60
ci_62                -5.508824e-04 3 1  ON 61
ci_63                -6.197520e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398217e-05 3 1  ON 64
ci_66                -6.512487e-04 3 1  ON 65
ci_67                -8.408614e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679826e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.8543
    reference variance = 0.509836
====================================================
  Execution time = 2.5262e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4922e-01
  Total weights = 1.9644e+06
  Execution time = 3.7601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966229142
                                         uncertainty =       0.001776943453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966229142
                                         uncertainty =       0.001776943453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466940081
  error estimate for blocks of size 2^( 2) =       0.000492522230
  error estimate for blocks of size 2^( 3) =       0.000516354667
  error estimate for blocks of size 2^( 4) =       0.000534003171
  error estimate for blocks of size 2^( 5) =       0.000544826437
  error estimate for blocks of size 2^( 6) =       0.000550525787
  error estimate for blocks of size 2^( 7) =       0.000554622202

      target function =      -0.745998499972
              le_mean =     -22.814917291211
             les_mean =     520.969668737698
             stat err =       0.000545994399
             autocorr =       1.367269312462
   target nu stat err =       0.000545994399
   target dn stat err =       0.002702198743
      target stat err =       0.002324617084
              std dev =       0.660352995565
             le_variance =       0.436066078751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966229068
                                         uncertainty =       0.001776943501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966229068
                                         uncertainty =       0.001776943501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466940081
  error estimate for blocks of size 2^( 2) =       0.000492522230
  error estimate for blocks of size 2^( 3) =       0.000516354667
  error estimate for blocks of size 2^( 4) =       0.000534003171
  error estimate for blocks of size 2^( 5) =       0.000544826438
  error estimate for blocks of size 2^( 6) =       0.000550525787
  error estimate for blocks of size 2^( 7) =       0.000554622202

      target function =      -0.745998495356
              le_mean =     -22.814917291196
             les_mean =     520.969668742555
             stat err =       0.000545994399
             autocorr =       1.367269314691
   target nu stat err =       0.000545994399
   target dn stat err =       0.002702199314
      target stat err =       0.002324617514
              std dev =       0.660352995500
             le_variance =       0.436066078665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966229105
                                         uncertainty =       0.001776943477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966229105
                                         uncertainty =       0.001776943477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466940081
  error estimate for blocks of size 2^( 2) =       0.000492522230
  error estimate for blocks of size 2^( 3) =       0.000516354667
  error estimate for blocks of size 2^( 4) =       0.000534003171
  error estimate for blocks of size 2^( 5) =       0.000544826438
  error estimate for blocks of size 2^( 6) =       0.000550525787
  error estimate for blocks of size 2^( 7) =       0.000554622202

      target function =      -0.745998497664
              le_mean =     -22.814917291203
             les_mean =     520.969668740126
             stat err =       0.000545994399
             autocorr =       1.367269313575
   target nu stat err =       0.000545994399
   target dn stat err =       0.002702199029
      target stat err =       0.002324617299
              std dev =       0.660352995532
             le_variance =       0.436066078708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966229137
                                         uncertainty =       0.001776943456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966229137
                                         uncertainty =       0.001776943456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466940081
  error estimate for blocks of size 2^( 2) =       0.000492522230
  error estimate for blocks of size 2^( 3) =       0.000516354667
  error estimate for blocks of size 2^( 4) =       0.000534003171
  error estimate for blocks of size 2^( 5) =       0.000544826437
  error estimate for blocks of size 2^( 6) =       0.000550525787
  error estimate for blocks of size 2^( 7) =       0.000554622202

      target function =      -0.745998499684
              le_mean =     -22.814917291210
             les_mean =     520.969668738001
             stat err =       0.000545994399
             autocorr =       1.367269312594
   target nu stat err =       0.000545994399
   target dn stat err =       0.002702198779
      target stat err =       0.002324617111
              std dev =       0.660352995561
             le_variance =       0.436066078746


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745998499972        initial  <--
     3.6380e+04     3.6380e+05             5.6120e-09        -0.745998495356
     1.4552e+05     1.4552e+06             1.4030e-09        -0.745998497664
     5.8208e+05     5.8208e+06             3.5075e-10        -0.745998499684

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5707
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4026e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.7537
    reference variance = 0.543445
====================================================
  Execution time = 2.5909e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5359e-01
  Total weights = 1.964452771e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437117143499
                                         uncertainty =       0.002398953115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437117143499
                                         uncertainty =       0.002398953115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467513626
  error estimate for blocks of size 2^( 2) =       0.000493028321
  error estimate for blocks of size 2^( 3) =       0.000516342450
  error estimate for blocks of size 2^( 4) =       0.000533513067
  error estimate for blocks of size 2^( 5) =       0.000544793609
  error estimate for blocks of size 2^( 6) =       0.000549933438
  error estimate for blocks of size 2^( 7) =       0.000554299250

      target function =      -0.742382859375
              le_mean =     -22.815130949205
             les_mean =     520.983786160030
             stat err =       0.000545634841
             autocorr =       1.362120849782
   target nu stat err =       0.000545634841
   target dn stat err =       0.003542921481
      target stat err =       0.002976415174
              std dev =       0.661164111020
             le_variance =       0.437137981700


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281513094921e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742393878327       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742393878374       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742393878379       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742393878380       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742393878317       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742393878103       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742393878798       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742393878548       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742393878482       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742393878048       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+05 is 3.729608e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742393878327       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742393878339       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742393878340       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742393878096       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742393878347       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742393876511       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742393875793       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742393878632       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742393878228       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742393877745       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+06 is 9.324020e-11

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742393878327       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742393878330       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742393878331       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742393878331       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742393883271       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742393874432       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742393883464       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742393875115       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742393876775       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742393875354       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+06 is 2.330994e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163810 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0386e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744891e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544254e-04 3 1  ON 44
ci_46                -7.121473e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672587e-04 3 1  ON 59
ci_61                -2.555169e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398255e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679782e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.7798
    reference variance = 0.357523
====================================================
  Execution time = 2.5360e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4927e-01
  Total weights = 1.9646e+06
  Execution time = 3.4801e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435300664680
                                         uncertainty =       0.002325029918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435300664680
                                         uncertainty =       0.002325029918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466505178
  error estimate for blocks of size 2^( 2) =       0.000491539219
  error estimate for blocks of size 2^( 3) =       0.000514879679
  error estimate for blocks of size 2^( 4) =       0.000532940152
  error estimate for blocks of size 2^( 5) =       0.000544629313
  error estimate for blocks of size 2^( 6) =       0.000551011892
  error estimate for blocks of size 2^( 7) =       0.000556504498

      target function =      -0.745943912815
              le_mean =     -22.814384988899
             les_mean =     520.945433851659
             stat err =       0.000546271464
             autocorr =       1.371210377430
   target nu stat err =       0.000546271464
   target dn stat err =       0.004230641160
      target stat err =       0.003561850249
              std dev =       0.659737949900
             le_variance =       0.435254162538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435300664671
                                         uncertainty =       0.002325029912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435300664671
                                         uncertainty =       0.002325029912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466505178
  error estimate for blocks of size 2^( 2) =       0.000491539219
  error estimate for blocks of size 2^( 3) =       0.000514879679
  error estimate for blocks of size 2^( 4) =       0.000532940152
  error estimate for blocks of size 2^( 5) =       0.000544629313
  error estimate for blocks of size 2^( 6) =       0.000551011892
  error estimate for blocks of size 2^( 7) =       0.000556504499

      target function =      -0.745943912513
              le_mean =     -22.814384988898
             les_mean =     520.945433852016
             stat err =       0.000546271464
             autocorr =       1.371210377584
   target nu stat err =       0.000546271464
   target dn stat err =       0.004230641088
      target stat err =       0.003561850187
              std dev =       0.659737949894
             le_variance =       0.435254162531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435300664676
                                         uncertainty =       0.002325029915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435300664676
                                         uncertainty =       0.002325029915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466505178
  error estimate for blocks of size 2^( 2) =       0.000491539219
  error estimate for blocks of size 2^( 3) =       0.000514879679
  error estimate for blocks of size 2^( 4) =       0.000532940152
  error estimate for blocks of size 2^( 5) =       0.000544629313
  error estimate for blocks of size 2^( 6) =       0.000551011892
  error estimate for blocks of size 2^( 7) =       0.000556504499

      target function =      -0.745943912664
              le_mean =     -22.814384988898
             les_mean =     520.945433851837
             stat err =       0.000546271464
             autocorr =       1.371210377506
   target nu stat err =       0.000546271464
   target dn stat err =       0.004230641124
      target stat err =       0.003561850218
              std dev =       0.659737949897
             le_variance =       0.435254162535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435300664679
                                         uncertainty =       0.002325029918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435300664679
                                         uncertainty =       0.002325029918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466505178
  error estimate for blocks of size 2^( 2) =       0.000491539219
  error estimate for blocks of size 2^( 3) =       0.000514879679
  error estimate for blocks of size 2^( 4) =       0.000532940152
  error estimate for blocks of size 2^( 5) =       0.000544629313
  error estimate for blocks of size 2^( 6) =       0.000551011892
  error estimate for blocks of size 2^( 7) =       0.000556504498

      target function =      -0.745943912796
              le_mean =     -22.814384988899
             les_mean =     520.945433851682
             stat err =       0.000546271464
             autocorr =       1.371210377435
   target nu stat err =       0.000546271464
   target dn stat err =       0.004230641156
      target stat err =       0.003561850245
              std dev =       0.659737949900
             le_variance =       0.435254162538


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745943912815        initial  <--
     3.6380e+05     3.6380e+06             3.7296e-10        -0.745943912513
     1.4552e+06     1.4552e+07             9.3240e-11        -0.745943912664
     5.8208e+06     5.8208e+07             2.3310e-11        -0.745943912796

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8662
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3258e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.8339
    reference variance = 0.35248
====================================================
  Execution time = 2.5835e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5017e-01
  Total weights = 1.964386893e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5209e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435092100930
                                         uncertainty =       0.002474865660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435092100930
                                         uncertainty =       0.002474865660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466437190
  error estimate for blocks of size 2^( 2) =       0.000491904855
  error estimate for blocks of size 2^( 3) =       0.000515694061
  error estimate for blocks of size 2^( 4) =       0.000533271185
  error estimate for blocks of size 2^( 5) =       0.000544670299
  error estimate for blocks of size 2^( 6) =       0.000550372486
  error estimate for blocks of size 2^( 7) =       0.000555186589

      target function =      -0.745204483598
              le_mean =     -22.815284920474
             les_mean =     520.987395879157
             stat err =       0.000545875140
             autocorr =       1.369620638299
   target nu stat err =       0.000545875140
   target dn stat err =       0.003338655000
      target stat err =       0.002833723788
              std dev =       0.659641799821
             le_variance =       0.435127304071


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281528492047e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745214344985       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745214344988       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745214344988       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745214344457       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745214345255       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745214346954       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745214340039       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745214351845       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745214346053       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745214342346       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+06 is 4.824057e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745214344985       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745214344985       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745214344986       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745214344986       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745214344990       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745214345040       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745214341903       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745214359284       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745214339429       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745214334795       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+07 is 1.206006e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745214344985       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745214344985       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745214344985       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745214350147       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745214344985       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745214345800       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745214359736       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745214428877       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745214306146       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745214480224       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+07 is 3.015007e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167333 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0364e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679783e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.7656
    reference variance = 0.43369
====================================================
  Execution time = 2.5321e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4979e-01
  Total weights = 1.9644e+06
  Execution time = 3.4774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436801228859
                                         uncertainty =       0.002112819159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436801228859
                                         uncertainty =       0.002112819159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467556441
  error estimate for blocks of size 2^( 2) =       0.000492602437
  error estimate for blocks of size 2^( 3) =       0.000517060108
  error estimate for blocks of size 2^( 4) =       0.000534635008
  error estimate for blocks of size 2^( 5) =       0.000546078915
  error estimate for blocks of size 2^( 6) =       0.000552242841
  error estimate for blocks of size 2^( 7) =       0.000554524005

      target function =      -0.745523475467
              le_mean =     -22.815231494957
             les_mean =     520.984576241254
             stat err =       0.000546870192
             autocorr =       1.368045100977
   target nu stat err =       0.000546870192
   target dn stat err =       0.002955387378
      target stat err =       0.002526436230
              std dev =       0.661224660716
             le_variance =       0.437218051939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436801228860
                                         uncertainty =       0.002112819160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436801228860
                                         uncertainty =       0.002112819160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467556441
  error estimate for blocks of size 2^( 2) =       0.000492602437
  error estimate for blocks of size 2^( 3) =       0.000517060108
  error estimate for blocks of size 2^( 4) =       0.000534635008
  error estimate for blocks of size 2^( 5) =       0.000546078915
  error estimate for blocks of size 2^( 6) =       0.000552242841
  error estimate for blocks of size 2^( 7) =       0.000554524005

      target function =      -0.745523475323
              le_mean =     -22.815231494957
             les_mean =     520.984576241428
             stat err =       0.000546870192
             autocorr =       1.368045100993
   target nu stat err =       0.000546870192
   target dn stat err =       0.002955387447
      target stat err =       0.002526436285
              std dev =       0.661224660716
             le_variance =       0.437218051939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436801228859
                                         uncertainty =       0.002112819159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436801228859
                                         uncertainty =       0.002112819159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467556441
  error estimate for blocks of size 2^( 2) =       0.000492602437
  error estimate for blocks of size 2^( 3) =       0.000517060108
  error estimate for blocks of size 2^( 4) =       0.000534635008
  error estimate for blocks of size 2^( 5) =       0.000546078915
  error estimate for blocks of size 2^( 6) =       0.000552242841
  error estimate for blocks of size 2^( 7) =       0.000554524005

      target function =      -0.745523475395
              le_mean =     -22.815231494957
             les_mean =     520.984576241341
             stat err =       0.000546870192
             autocorr =       1.368045100985
   target nu stat err =       0.000546870192
   target dn stat err =       0.002955387413
      target stat err =       0.002526436258
              std dev =       0.661224660716
             le_variance =       0.437218051939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436801228859
                                         uncertainty =       0.002112819159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436801228859
                                         uncertainty =       0.002112819159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467556441
  error estimate for blocks of size 2^( 2) =       0.000492602437
  error estimate for blocks of size 2^( 3) =       0.000517060108
  error estimate for blocks of size 2^( 4) =       0.000534635008
  error estimate for blocks of size 2^( 5) =       0.000546078915
  error estimate for blocks of size 2^( 6) =       0.000552242841
  error estimate for blocks of size 2^( 7) =       0.000554524005

      target function =      -0.745523475458
              le_mean =     -22.815231494957
             les_mean =     520.984576241265
             stat err =       0.000546870192
             autocorr =       1.368045100980
   target nu stat err =       0.000546870192
   target dn stat err =       0.002955387383
      target stat err =       0.002526436234
              std dev =       0.661224660716
             le_variance =       0.437218051939


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745523475467        initial  <--
     3.6380e+06     3.6380e+07             4.8241e-11        -0.745523475323
     1.4552e+07     1.4552e+08             1.2060e-11        -0.745523475395
     5.8208e+07     5.8208e+08             3.0150e-12        -0.745523475458

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.9942
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6364e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.7556
    reference variance = 0.262233
====================================================
  Execution time = 2.5907e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4548e-01
  Total weights = 1.964606141e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4961e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432556576773
                                         uncertainty =       0.002010697176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432556576773
                                         uncertainty =       0.002010697176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465038026
  error estimate for blocks of size 2^( 2) =       0.000490314899
  error estimate for blocks of size 2^( 3) =       0.000514263692
  error estimate for blocks of size 2^( 4) =       0.000531672608
  error estimate for blocks of size 2^( 5) =       0.000542358313
  error estimate for blocks of size 2^( 6) =       0.000547771115
  error estimate for blocks of size 2^( 7) =       0.000551278055

      target function =      -0.749113238518
              le_mean =     -22.814016490134
             les_mean =     520.924823910644
             stat err =       0.000543270023
             autocorr =       1.364754545948
   target nu stat err =       0.000543270023
   target dn stat err =       0.002823929858
      target stat err =       0.002437923775
              std dev =       0.657663084043
             le_variance =       0.432520732114


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281401649013e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749120212772       residual = 9.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749120212772       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749120212772       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749120212772       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749120213009       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749120212772       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749120212772       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749120212772       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749120212772       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749120212772       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+07 is 6.067693e-12

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749120212772       residual = 9.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749120212772       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749120212772       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749120212772       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749120224569       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749120212772       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749120212772       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749120212772       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749120212772       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749120212772       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+08 is 1.516969e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749120212772       residual = 9.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749120212772       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749120212772       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749120212772       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749120646180       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749120285024       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749120212772       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749120212772       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749120212772       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749120577112       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+08 is 3.793439e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170863 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0412e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.7652
    reference variance = 0.364849
====================================================
  Execution time = 2.5761e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4617e-01
  Total weights = 1.9644e+06
  Execution time = 3.4643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432921265873
                                         uncertainty =       0.001801289155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432921265873
                                         uncertainty =       0.001801289155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465290813
  error estimate for blocks of size 2^( 2) =       0.000490509425
  error estimate for blocks of size 2^( 3) =       0.000514663029
  error estimate for blocks of size 2^( 4) =       0.000531966784
  error estimate for blocks of size 2^( 5) =       0.000543014046
  error estimate for blocks of size 2^( 6) =       0.000549942672
  error estimate for blocks of size 2^( 7) =       0.000555035111

      target function =      -0.748541978995
              le_mean =     -22.815654967318
             les_mean =     521.000277139502
             stat err =       0.000544989653
             autocorr =       1.371916122316
   target nu stat err =       0.000544989653
   target dn stat err =       0.003019113100
      target stat err =       0.002599267343
              std dev =       0.658020577571
             le_variance =       0.432991080507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432921265873
                                         uncertainty =       0.001801289155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432921265873
                                         uncertainty =       0.001801289155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465290813
  error estimate for blocks of size 2^( 2) =       0.000490509425
  error estimate for blocks of size 2^( 3) =       0.000514663029
  error estimate for blocks of size 2^( 4) =       0.000531966784
  error estimate for blocks of size 2^( 5) =       0.000543014046
  error estimate for blocks of size 2^( 6) =       0.000549942672
  error estimate for blocks of size 2^( 7) =       0.000555035111

      target function =      -0.748541978992
              le_mean =     -22.815654967318
             les_mean =     521.000277139506
             stat err =       0.000544989653
             autocorr =       1.371916122322
   target nu stat err =       0.000544989653
   target dn stat err =       0.003019113102
      target stat err =       0.002599267344
              std dev =       0.658020577571
             le_variance =       0.432991080507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432921265873
                                         uncertainty =       0.001801289155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432921265873
                                         uncertainty =       0.001801289155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465290813
  error estimate for blocks of size 2^( 2) =       0.000490509425
  error estimate for blocks of size 2^( 3) =       0.000514663029
  error estimate for blocks of size 2^( 4) =       0.000531966784
  error estimate for blocks of size 2^( 5) =       0.000543014046
  error estimate for blocks of size 2^( 6) =       0.000549942672
  error estimate for blocks of size 2^( 7) =       0.000555035111

      target function =      -0.748541978993
              le_mean =     -22.815654967318
             les_mean =     521.000277139504
             stat err =       0.000544989653
             autocorr =       1.371916122308
   target nu stat err =       0.000544989653
   target dn stat err =       0.003019113101
      target stat err =       0.002599267343
              std dev =       0.658020577571
             le_variance =       0.432991080507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432921265873
                                         uncertainty =       0.001801289155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432921265873
                                         uncertainty =       0.001801289155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465290813
  error estimate for blocks of size 2^( 2) =       0.000490509425
  error estimate for blocks of size 2^( 3) =       0.000514663029
  error estimate for blocks of size 2^( 4) =       0.000531966784
  error estimate for blocks of size 2^( 5) =       0.000543014046
  error estimate for blocks of size 2^( 6) =       0.000549942672
  error estimate for blocks of size 2^( 7) =       0.000555035111

      target function =      -0.748541978995
              le_mean =     -22.815654967318
             les_mean =     521.000277139502
             stat err =       0.000544989653
             autocorr =       1.371916122316
   target nu stat err =       0.000544989653
   target dn stat err =       0.003019113100
      target stat err =       0.002599267343
              std dev =       0.658020577571
             le_variance =       0.432991080507


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748541978995        initial  <--
     3.6380e+07     3.6380e+08             6.0677e-12        -0.748541978992
     1.4552e+08     1.4552e+09             1.5170e-12        -0.748541978993
     5.8208e+08     5.8208e+09             3.7934e-13        -0.748541978995

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.1087
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3526e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.7764
    reference variance = 0.497124
====================================================
  Execution time = 2.5764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5360e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5099e-01
  Total weights = 1.964012232e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5172e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434542551420
                                         uncertainty =       0.001926449438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434542551420
                                         uncertainty =       0.001926449438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466127712
  error estimate for blocks of size 2^( 2) =       0.000491659034
  error estimate for blocks of size 2^( 3) =       0.000515426828
  error estimate for blocks of size 2^( 4) =       0.000533076945
  error estimate for blocks of size 2^( 5) =       0.000543809460
  error estimate for blocks of size 2^( 6) =       0.000548119907
  error estimate for blocks of size 2^( 7) =       0.000552378414

      target function =      -0.744526294846
              le_mean =     -22.815433012392
             les_mean =     520.994969072104
             stat err =       0.000544346182
             autocorr =       1.363768062805
   target nu stat err =       0.000544346182
   target dn stat err =       0.003679398298
      target stat err =       0.003105053442
              std dev =       0.659204131704
             le_variance =       0.434550087256


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281543301239e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+08, overlap shift 3.6380e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744538302051       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744538302051       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744538302051       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744538302051       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744538298301       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744538443154       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744538795795       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744539092228       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744538819480       residual = 7.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+08 is 4.924103e-13

solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744538302051       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744538302051       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744538302051       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744538302051       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744537868207       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744538162439       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744537967441       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744536506783       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744535160195       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+09 is 1.230176e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744538302051       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744538302051       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744538302051       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744538054709       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744537843232       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744538302051       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744540146407       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744543745331       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744538302051       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+09 is 3.075108e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0290e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.7495
    reference variance = 0.352533
====================================================
  Execution time = 2.5476e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5084e-01
  Total weights = 1.9644e+06
  Execution time = 3.4720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437740378047
                                         uncertainty =       0.002277477756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437740378047
                                         uncertainty =       0.002277477756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467845844
  error estimate for blocks of size 2^( 2) =       0.000493411301
  error estimate for blocks of size 2^( 3) =       0.000517175749
  error estimate for blocks of size 2^( 4) =       0.000534324318
  error estimate for blocks of size 2^( 5) =       0.000545563998
  error estimate for blocks of size 2^( 6) =       0.000551361846
  error estimate for blocks of size 2^( 7) =       0.000555177401

      target function =      -0.744649339027
              le_mean =     -22.814320467613
             les_mean =     520.944061994914
             stat err =       0.000546606891
             autocorr =       1.365037719276
   target nu stat err =       0.000546606891
   target dn stat err =       0.003171481140
      target stat err =       0.002690900511
              std dev =       0.661633938127
             le_variance =       0.437759468081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437740378047
                                         uncertainty =       0.002277477756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437740378047
                                         uncertainty =       0.002277477756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467845844
  error estimate for blocks of size 2^( 2) =       0.000493411301
  error estimate for blocks of size 2^( 3) =       0.000517175749
  error estimate for blocks of size 2^( 4) =       0.000534324318
  error estimate for blocks of size 2^( 5) =       0.000545563998
  error estimate for blocks of size 2^( 6) =       0.000551361846
  error estimate for blocks of size 2^( 7) =       0.000555177401

      target function =      -0.744649339027
              le_mean =     -22.814320467613
             les_mean =     520.944061994915
             stat err =       0.000546606891
             autocorr =       1.365037719275
   target nu stat err =       0.000546606891
   target dn stat err =       0.003171481140
      target stat err =       0.002690900511
              std dev =       0.661633938127
             le_variance =       0.437759468081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437740378047
                                         uncertainty =       0.002277477756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437740378047
                                         uncertainty =       0.002277477756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467845844
  error estimate for blocks of size 2^( 2) =       0.000493411301
  error estimate for blocks of size 2^( 3) =       0.000517175749
  error estimate for blocks of size 2^( 4) =       0.000534324318
  error estimate for blocks of size 2^( 5) =       0.000545563998
  error estimate for blocks of size 2^( 6) =       0.000551361846
  error estimate for blocks of size 2^( 7) =       0.000555177401

      target function =      -0.744649339027
              le_mean =     -22.814320467613
             les_mean =     520.944061994914
             stat err =       0.000546606891
             autocorr =       1.365037719285
   target nu stat err =       0.000546606891
   target dn stat err =       0.003171481140
      target stat err =       0.002690900511
              std dev =       0.661633938127
             le_variance =       0.437759468081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437740378047
                                         uncertainty =       0.002277477756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437740378047
                                         uncertainty =       0.002277477756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467845844
  error estimate for blocks of size 2^( 2) =       0.000493411301
  error estimate for blocks of size 2^( 3) =       0.000517175749
  error estimate for blocks of size 2^( 4) =       0.000534324318
  error estimate for blocks of size 2^( 5) =       0.000545563998
  error estimate for blocks of size 2^( 6) =       0.000551361846
  error estimate for blocks of size 2^( 7) =       0.000555177401

      target function =      -0.744649339027
              le_mean =     -22.814320467613
             les_mean =     520.944061994914
             stat err =       0.000546606891
             autocorr =       1.365037719277
   target nu stat err =       0.000546606891
   target dn stat err =       0.003171481140
      target stat err =       0.002690900511
              std dev =       0.661633938127
             le_variance =       0.437759468081


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744649339027        initial  <--
     3.6380e+08     3.6380e+09             4.9241e-13        -0.744649339027
     1.4552e+09     1.4552e+10             1.2302e-13        -0.744649339027
     5.8208e+09     5.8208e+10             3.0751e-14        -0.744649339027

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.3428
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6680e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8664
    reference variance = 0.48867
====================================================
  Execution time = 2.5879e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4805e-01
  Total weights = 1.964454145e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435049618609
                                         uncertainty =       0.001820035944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435049618609
                                         uncertainty =       0.001820035944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466458272
  error estimate for blocks of size 2^( 2) =       0.000492187763
  error estimate for blocks of size 2^( 3) =       0.000516175170
  error estimate for blocks of size 2^( 4) =       0.000533942412
  error estimate for blocks of size 2^( 5) =       0.000544837251
  error estimate for blocks of size 2^( 6) =       0.000553596162
  error estimate for blocks of size 2^( 7) =       0.000555626082

      target function =      -0.746974501145
              le_mean =     -22.815458638867
             les_mean =     520.993198700847
             stat err =       0.000547000477
             autocorr =       1.375149173587
   target nu stat err =       0.000547000477
   target dn stat err =       0.002448382671
      target stat err =       0.002129271918
              std dev =       0.659671614294
             le_variance =       0.435166638705


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281545863887e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+09, overlap shift 3.6380e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746979608445       residual = 8.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746979608445       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746979608445       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746980768345       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746976520302       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746979964735       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746979079760       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746979608445       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746980335683       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746980053838       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+09 is 4.509116e-14

solving harmonic davidson linear method for identity shift 1.4552e+10, overlap shift 1.4552e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746979608445       residual = 8.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746979608445       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746979608445       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746979608444       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746979640529       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746981221771       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746977687476       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746932683404       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747003799713       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747001954222       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747000032453       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746955436672       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746979263951       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746964158116       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747006483316       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746997230153       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746983725545       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747009527616       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746992714808       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746998136020       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746965619508       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746977007108       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746981869707       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746982732710       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746989648179       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747002718410       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747012272208       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746982299363       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746969957574       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746976357238       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746986781944       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746945021929       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746960451350       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746955801477       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746960743069       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746996012028       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746936116878       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746996464443       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746977182612       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747007762809       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746967973531       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747002877041       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746965274663       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746975075927       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746983599407       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746988055678       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747003680976       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746989907304       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746956117411       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747007996995       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746985450858       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.746989298383       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.746973886526       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.746975450584       residual = 1.36e-07           smallest_sin_value = 9.97e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+10 is 1.125128e-14

solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746979608445       residual = 8.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746979608445       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746979608445       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746970624161       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746979608445       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746979608445       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747012201816       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746979608445       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747013627959       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746915635118       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746973547728       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747014109132       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746981663952       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746954082055       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747051569111       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746980916649       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747191738487       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746923975792       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746940495838       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746998607422       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746988759552       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746992636048       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746949625728       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746847322568       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746979317804       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747029520873       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746986835831       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747007394826       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747065852662       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746999267179       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746978736740       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746976692623       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747028731794       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746964037596       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746983663304       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746969476091       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747015736495       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746952678892       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746978788363       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746974635552       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746978872250       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746933056141       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746921457485       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746934283792       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746967388315       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747058054941       residual = 1.37e-06           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747047606884       residual = 4.45e-07           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746952962100       residual = 4.72e-07           smallest_sin_value = 9.98e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746820865646       residual = 6.97e-07           smallest_sin_value = 9.98e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746962564914       residual = 1.11e-06           smallest_sin_value = 9.96e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746978883021       residual = 8.27e-07           smallest_sin_value = 9.96e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.746937985554       residual = 4.33e-07           smallest_sin_value = 9.95e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+10 is 2.787586e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301338 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0481e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8403
    reference variance = 0.311855
====================================================
  Execution time = 2.5357e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4905e-01
  Total weights = 1.9640e+06
  Execution time = 3.4675e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434803936759
                                         uncertainty =       0.001891937615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434803936759
                                         uncertainty =       0.001891937615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466229865
  error estimate for blocks of size 2^( 2) =       0.000491506680
  error estimate for blocks of size 2^( 3) =       0.000515194429
  error estimate for blocks of size 2^( 4) =       0.000533447082
  error estimate for blocks of size 2^( 5) =       0.000545224775
  error estimate for blocks of size 2^( 6) =       0.000552632863
  error estimate for blocks of size 2^( 7) =       0.000556250925

      target function =      -0.746138734507
              le_mean =     -22.814761307493
             les_mean =     520.962380390135
             stat err =       0.000546888911
             autocorr =       1.375935436303
   target nu stat err =       0.000546888911
   target dn stat err =       0.003008105737
      target stat err =       0.002571233035
              std dev =       0.659348598929
             le_variance =       0.434740574910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434803936759
                                         uncertainty =       0.001891937615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434803936759
                                         uncertainty =       0.001891937615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466229865
  error estimate for blocks of size 2^( 2) =       0.000491506680
  error estimate for blocks of size 2^( 3) =       0.000515194429
  error estimate for blocks of size 2^( 4) =       0.000533447082
  error estimate for blocks of size 2^( 5) =       0.000545224775
  error estimate for blocks of size 2^( 6) =       0.000552632863
  error estimate for blocks of size 2^( 7) =       0.000556250925

      target function =      -0.746138734507
              le_mean =     -22.814761307493
             les_mean =     520.962380390135
             stat err =       0.000546888911
             autocorr =       1.375935436309
   target nu stat err =       0.000546888911
   target dn stat err =       0.003008105737
      target stat err =       0.002571233035
              std dev =       0.659348598929
             le_variance =       0.434740574910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434803936759
                                         uncertainty =       0.001891937615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434803936759
                                         uncertainty =       0.001891937615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466229865
  error estimate for blocks of size 2^( 2) =       0.000491506680
  error estimate for blocks of size 2^( 3) =       0.000515194429
  error estimate for blocks of size 2^( 4) =       0.000533447082
  error estimate for blocks of size 2^( 5) =       0.000545224775
  error estimate for blocks of size 2^( 6) =       0.000552632863
  error estimate for blocks of size 2^( 7) =       0.000556250925

      target function =      -0.746138734507
              le_mean =     -22.814761307493
             les_mean =     520.962380390135
             stat err =       0.000546888911
             autocorr =       1.375935436310
   target nu stat err =       0.000546888911
   target dn stat err =       0.003008105737
      target stat err =       0.002571233035
              std dev =       0.659348598929
             le_variance =       0.434740574910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434803936759
                                         uncertainty =       0.001891937615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434803936759
                                         uncertainty =       0.001891937615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466229865
  error estimate for blocks of size 2^( 2) =       0.000491506680
  error estimate for blocks of size 2^( 3) =       0.000515194429
  error estimate for blocks of size 2^( 4) =       0.000533447082
  error estimate for blocks of size 2^( 5) =       0.000545224775
  error estimate for blocks of size 2^( 6) =       0.000552632863
  error estimate for blocks of size 2^( 7) =       0.000556250925

      target function =      -0.746138734507
              le_mean =     -22.814761307493
             les_mean =     520.962380390135
             stat err =       0.000546888911
             autocorr =       1.375935436306
   target nu stat err =       0.000546888911
   target dn stat err =       0.003008105737
      target stat err =       0.002571233035
              std dev =       0.659348598929
             le_variance =       0.434740574910


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746138734507        initial
     3.6380e+09     3.6380e+10             4.5091e-14        -0.746138734507  <--
     1.4552e+10     1.4552e+11             1.1251e-14        -0.746138734507
     5.8208e+10     5.8208e+11             2.7876e-15        -0.746138734507

*****************************************************************************
Applying the update for shift_i =   3.6380e+09     and shift_s =   3.6380e+10
*****************************************************************************

  Execution time = 4.2716e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3203e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8988
    reference variance = 0.483298
====================================================
  Execution time = 2.5791e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4648e-01
  Total weights = 1.964466844e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5310e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434642912927
                                         uncertainty =       0.002747203864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434642912927
                                         uncertainty =       0.002747203864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466170224
  error estimate for blocks of size 2^( 2) =       0.000491207864
  error estimate for blocks of size 2^( 3) =       0.000515358082
  error estimate for blocks of size 2^( 4) =       0.000532893778
  error estimate for blocks of size 2^( 5) =       0.000542659019
  error estimate for blocks of size 2^( 6) =       0.000549097399
  error estimate for blocks of size 2^( 7) =       0.000555347302

      target function =      -0.748273802602
              le_mean =     -22.814575462421
             les_mean =     520.951333731279
             stat err =       0.000544999375
             autocorr =       1.366793635038
   target nu stat err =       0.000544999375
   target dn stat err =       0.003294634007
      target stat err =       0.002817444014
              std dev =       0.659264253071
             le_variance =       0.434629355378


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281457546242e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+08, overlap shift 9.0949e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748283507101       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748283507101       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748283507101       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748283507101       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748283198871       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748283507101       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748284391920       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748283507101       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748283347222       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748284668525       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+08 is 1.893159e-13

solving harmonic davidson linear method for identity shift 3.6380e+09, overlap shift 3.6380e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748283507101       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748283507101       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748283507101       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748282423307       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748283507101       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748283507101       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748283507101       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748283507101       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748279750697       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748283507101       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+09 is 4.731366e-14

solving harmonic davidson linear method for identity shift 1.4552e+10, overlap shift 1.4552e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748283507101       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748283507101       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748283507101       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748283507101       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748283507101       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748283507101       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748281800621       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748266489034       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748263630395       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748300887437       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748242327650       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748295014525       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748284344321       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748290780988       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748271057540       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748325959243       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748292345194       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748289253463       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748248012502       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748274970727       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748313363795       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748287958139       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748276872646       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748270516172       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748283350255       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748282592973       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748278074667       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748281670485       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748284333651       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748290765184       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748279374517       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748281326210       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748283055398       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748286462356       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748287527134       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748288925347       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748282035429       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748278730030       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748289993230       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748286916176       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748284054933       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748282651587       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748276770300       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748281182729       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748278054640       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.748290549569       residual = 1.74e-08           smallest_sin_value = 9.98e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748275045377       residual = 4.17e-08           smallest_sin_value = 9.98e-01
davidson iteration   47 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         47 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+10 is 1.182465e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.346258 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0372e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.7737
    reference variance = 0.328447
====================================================
  Execution time = 2.5517e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6151e-01
  Total weights = 1.9641e+06
  Execution time = 3.4805e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439680923784
                                         uncertainty =       0.005236003735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439680923784
                                         uncertainty =       0.005236003735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468959129
  error estimate for blocks of size 2^( 2) =       0.000494383877
  error estimate for blocks of size 2^( 3) =       0.000518181015
  error estimate for blocks of size 2^( 4) =       0.000536657209
  error estimate for blocks of size 2^( 5) =       0.000547759700
  error estimate for blocks of size 2^( 6) =       0.000555444851
  error estimate for blocks of size 2^( 7) =       0.000558614086

      target function =      -0.735826889113
              le_mean =     -22.815260891251
             les_mean =     520.997638399871
             stat err =       0.000549618962
             autocorr =       1.373578314596
   target nu stat err =       0.000549618962
   target dn stat err =       0.010841225497
      target stat err =       0.008784639775
              std dev =       0.663208360375
             le_variance =       0.439845329271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439680923784
                                         uncertainty =       0.005236003735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439680923784
                                         uncertainty =       0.005236003735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468959129
  error estimate for blocks of size 2^( 2) =       0.000494383877
  error estimate for blocks of size 2^( 3) =       0.000518181015
  error estimate for blocks of size 2^( 4) =       0.000536657209
  error estimate for blocks of size 2^( 5) =       0.000547759700
  error estimate for blocks of size 2^( 6) =       0.000555444851
  error estimate for blocks of size 2^( 7) =       0.000558614086

      target function =      -0.735826889113
              le_mean =     -22.815260891251
             les_mean =     520.997638399871
             stat err =       0.000549618962
             autocorr =       1.373578314598
   target nu stat err =       0.000549618962
   target dn stat err =       0.010841225497
      target stat err =       0.008784639775
              std dev =       0.663208360375
             le_variance =       0.439845329271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439680923784
                                         uncertainty =       0.005236003735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439680923784
                                         uncertainty =       0.005236003735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468959129
  error estimate for blocks of size 2^( 2) =       0.000494383877
  error estimate for blocks of size 2^( 3) =       0.000518181015
  error estimate for blocks of size 2^( 4) =       0.000536657209
  error estimate for blocks of size 2^( 5) =       0.000547759700
  error estimate for blocks of size 2^( 6) =       0.000555444851
  error estimate for blocks of size 2^( 7) =       0.000558614086

      target function =      -0.735826889113
              le_mean =     -22.815260891251
             les_mean =     520.997638399871
             stat err =       0.000549618962
             autocorr =       1.373578314599
   target nu stat err =       0.000549618962
   target dn stat err =       0.010841225497
      target stat err =       0.008784639775
              std dev =       0.663208360375
             le_variance =       0.439845329271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439680923784
                                         uncertainty =       0.005236003735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439680923784
                                         uncertainty =       0.005236003735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468959129
  error estimate for blocks of size 2^( 2) =       0.000494383877
  error estimate for blocks of size 2^( 3) =       0.000518181015
  error estimate for blocks of size 2^( 4) =       0.000536657209
  error estimate for blocks of size 2^( 5) =       0.000547759700
  error estimate for blocks of size 2^( 6) =       0.000555444851
  error estimate for blocks of size 2^( 7) =       0.000558614086

      target function =      -0.735826889113
              le_mean =     -22.815260891251
             les_mean =     520.997638399871
             stat err =       0.000549618962
             autocorr =       1.373578314596
   target nu stat err =       0.000549618962
   target dn stat err =       0.010841225497
      target stat err =       0.008784639775
              std dev =       0.663208360375
             le_variance =       0.439845329271


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.735826889113        initial
     9.0949e+08     9.0949e+09             1.8932e-13        -0.735826889113  <--
     3.6380e+09     3.6380e+10             4.7314e-14        -0.735826889113
     1.4552e+10     1.4552e+11             1.1825e-14        -0.735826889113

*****************************************************************************
Applying the update for shift_i =   9.0949e+08     and shift_s =   9.0949e+09
*****************************************************************************

  Execution time = 4.5818e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6195e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.9235
    reference variance = 0.452377
====================================================
  Execution time = 2.5812e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4905e-01
  Total weights = 1.964476485e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435047427809
                                         uncertainty =       0.002142931420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435047427809
                                         uncertainty =       0.002142931420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466360290
  error estimate for blocks of size 2^( 2) =       0.000491250918
  error estimate for blocks of size 2^( 3) =       0.000514707619
  error estimate for blocks of size 2^( 4) =       0.000532489712
  error estimate for blocks of size 2^( 5) =       0.000544788185
  error estimate for blocks of size 2^( 6) =       0.000551168154
  error estimate for blocks of size 2^( 7) =       0.000552738539

      target function =      -0.746133167390
              le_mean =     -22.814857382892
             les_mean =     520.966771684860
             stat err =       0.000545296148
             autocorr =       1.367167521253
   target nu stat err =       0.000545296148
   target dn stat err =       0.002913034972
      target stat err =       0.002494481457
              std dev =       0.659533046397
             le_variance =       0.434983839290


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281485738289e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+08, overlap shift 2.2737e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746140415760       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746140415760       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746140415760       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746140415760       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746140415757       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746140569615       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746140766515       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746140668081       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746140078364       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+08 is 6.377360e-13

solving harmonic davidson linear method for identity shift 9.0949e+08, overlap shift 9.0949e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746140415760       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746140415760       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746140415760       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746140415760       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746140415760       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746140336554       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746140415760       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746140415760       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746140415760       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+08 is 1.594237e-13

solving harmonic davidson linear method for identity shift 3.6380e+09, overlap shift 3.6380e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746140415760       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746140415760       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746140415760       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746140415760       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746140415760       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746140713616       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746142461713       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746140422747       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746144827696       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746130316683       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+09 is 3.989804e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.349540 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0284e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.8652
    reference variance = 0.402483
====================================================
  Execution time = 2.5207e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6592e-01
  Total weights = 1.9644e+06
  Execution time = 3.4856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440864617194
                                         uncertainty =       0.003721221483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440864617194
                                         uncertainty =       0.003721221483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469457266
  error estimate for blocks of size 2^( 2) =       0.000495055626
  error estimate for blocks of size 2^( 3) =       0.000519439831
  error estimate for blocks of size 2^( 4) =       0.000537702750
  error estimate for blocks of size 2^( 5) =       0.000548831130
  error estimate for blocks of size 2^( 6) =       0.000554167655
  error estimate for blocks of size 2^( 7) =       0.000559933024

      target function =      -0.732240233360
              le_mean =     -22.814787931922
             les_mean =     520.980464046329
             stat err =       0.000550158640
             autocorr =       1.373357944350
   target nu stat err =       0.000550158640
   target dn stat err =       0.013309090890
      target stat err =       0.010664392483
              std dev =       0.663912833205
             le_variance =       0.440780250094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440864617194
                                         uncertainty =       0.003721221483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440864617194
                                         uncertainty =       0.003721221483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469457266
  error estimate for blocks of size 2^( 2) =       0.000495055626
  error estimate for blocks of size 2^( 3) =       0.000519439831
  error estimate for blocks of size 2^( 4) =       0.000537702750
  error estimate for blocks of size 2^( 5) =       0.000548831130
  error estimate for blocks of size 2^( 6) =       0.000554167656
  error estimate for blocks of size 2^( 7) =       0.000559933024

      target function =      -0.732240233359
              le_mean =     -22.814787931922
             les_mean =     520.980464046331
             stat err =       0.000550158640
             autocorr =       1.373357944357
   target nu stat err =       0.000550158640
   target dn stat err =       0.013309090891
      target stat err =       0.010664392484
              std dev =       0.663912833204
             le_variance =       0.440780250094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440864617194
                                         uncertainty =       0.003721221483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440864617194
                                         uncertainty =       0.003721221483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469457266
  error estimate for blocks of size 2^( 2) =       0.000495055626
  error estimate for blocks of size 2^( 3) =       0.000519439831
  error estimate for blocks of size 2^( 4) =       0.000537702750
  error estimate for blocks of size 2^( 5) =       0.000548831130
  error estimate for blocks of size 2^( 6) =       0.000554167656
  error estimate for blocks of size 2^( 7) =       0.000559933024

      target function =      -0.732240233360
              le_mean =     -22.814787931922
             les_mean =     520.980464046330
             stat err =       0.000550158640
             autocorr =       1.373357944354
   target nu stat err =       0.000550158640
   target dn stat err =       0.013309090890
      target stat err =       0.010664392484
              std dev =       0.663912833205
             le_variance =       0.440780250094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440864617194
                                         uncertainty =       0.003721221483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440864617194
                                         uncertainty =       0.003721221483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469457266
  error estimate for blocks of size 2^( 2) =       0.000495055626
  error estimate for blocks of size 2^( 3) =       0.000519439831
  error estimate for blocks of size 2^( 4) =       0.000537702750
  error estimate for blocks of size 2^( 5) =       0.000548831130
  error estimate for blocks of size 2^( 6) =       0.000554167656
  error estimate for blocks of size 2^( 7) =       0.000559933024

      target function =      -0.732240233360
              le_mean =     -22.814787931922
             les_mean =     520.980464046329
             stat err =       0.000550158640
             autocorr =       1.373357944351
   target nu stat err =       0.000550158640
   target dn stat err =       0.013309090890
      target stat err =       0.010664392484
              std dev =       0.663912833205
             le_variance =       0.440780250094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.732240233360        initial  <--
     2.2737e+08     2.2737e+09             6.3774e-13        -0.732240233359
     9.0949e+08     9.0949e+09             1.5942e-13        -0.732240233360
     3.6380e+09     3.6380e+10             3.9898e-14        -0.732240233360

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.6576
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2948e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7787
    reference variance = 0.339394
====================================================
  Execution time = 2.5749e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5416e-01
  Total weights = 1.964452292e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440303834416
                                         uncertainty =       0.002833612349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440303834416
                                         uncertainty =       0.002833612349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469228039
  error estimate for blocks of size 2^( 2) =       0.000494118562
  error estimate for blocks of size 2^( 3) =       0.000517473963
  error estimate for blocks of size 2^( 4) =       0.000534398002
  error estimate for blocks of size 2^( 5) =       0.000545203006
  error estimate for blocks of size 2^( 6) =       0.000550251693
  error estimate for blocks of size 2^( 7) =       0.000554866091

      target function =      -0.741910105238
              le_mean =     -22.815092923018
             les_mean =     520.982627346950
             stat err =       0.000546179698
             autocorr =       1.354887366117
   target nu stat err =       0.000546179698
   target dn stat err =       0.003437279862
      target stat err =       0.002887739642
              std dev =       0.663588657180
             le_variance =       0.440349905937


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281509292302e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+09, overlap shift 2.2737e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741920335801       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741920335801       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741920335801       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741920718497       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741920664433       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741920285164       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741920918660       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741919312392       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741920351166       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741917603919       residual = 4.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+09 is 7.688109e-14

solving harmonic davidson linear method for identity shift 9.0949e+09, overlap shift 9.0949e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741920335801       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741920335801       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741920335801       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741920335801       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741920886598       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741920576627       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741913997421       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741910234251       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741920595320       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741918160108       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741925833541       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741915562873       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+09 is 1.921400e-14

solving harmonic davidson linear method for identity shift 3.6380e+10, overlap shift 3.6380e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741920335801       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741920335801       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741920335801       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741920391619       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741918600470       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741920321574       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741920163557       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741885192257       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741922941802       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741966835160       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741927521353       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741863848777       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741847642567       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741929793230       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742005240361       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741998705477       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741886222579       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741817773791       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741958789821       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741960254233       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741854986543       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741935705163       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741925705474       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741910752393       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741939097920       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741871124049       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741885891663       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741868798154       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741892442557       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741864961014       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741904796593       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741924854923       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741916631967       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.741917076074       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.741879636433       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.741986352045       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.741917646912       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.741929390971       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.741877475839       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.741931749648       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.741874975278       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.741937567266       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.741904285766       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.741930847979       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.741934357215       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.741881401386       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.741888845388       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.741901486989       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.741925897059       residual = 9.65e-08           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.741918330927       residual = 2.71e-07           smallest_sin_value = 9.96e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.741957549889       residual = 2.06e-07           smallest_sin_value = 9.96e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+10 is 4.810810e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.404935 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0271e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7776
    reference variance = 1.02558
====================================================
  Execution time = 2.5199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4402e-01
  Total weights = 1.9643e+06
  Execution time = 3.4720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433605229619
                                         uncertainty =       0.001625762673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433605229619
                                         uncertainty =       0.001625762673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465664318
  error estimate for blocks of size 2^( 2) =       0.000491333450
  error estimate for blocks of size 2^( 3) =       0.000515453867
  error estimate for blocks of size 2^( 4) =       0.000532074787
  error estimate for blocks of size 2^( 5) =       0.000542759686
  error estimate for blocks of size 2^( 6) =       0.000547520263
  error estimate for blocks of size 2^( 7) =       0.000551283782

      target function =      -0.750344177833
              le_mean =     -22.814789912109
             les_mean =     520.958655040680
             stat err =       0.000543409629
             autocorr =       1.361785598575
   target nu stat err =       0.000543409629
   target dn stat err =       0.002149778853
      target stat err =       0.001905280022
              std dev =       0.658548794655
             le_variance =       0.433686514942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433605229619
                                         uncertainty =       0.001625762673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433605229619
                                         uncertainty =       0.001625762673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465664318
  error estimate for blocks of size 2^( 2) =       0.000491333450
  error estimate for blocks of size 2^( 3) =       0.000515453867
  error estimate for blocks of size 2^( 4) =       0.000532074787
  error estimate for blocks of size 2^( 5) =       0.000542759686
  error estimate for blocks of size 2^( 6) =       0.000547520263
  error estimate for blocks of size 2^( 7) =       0.000551283782

      target function =      -0.750344177833
              le_mean =     -22.814789912109
             les_mean =     520.958655040681
             stat err =       0.000543409629
             autocorr =       1.361785598576
   target nu stat err =       0.000543409629
   target dn stat err =       0.002149778853
      target stat err =       0.001905280022
              std dev =       0.658548794655
             le_variance =       0.433686514942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433605229619
                                         uncertainty =       0.001625762673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433605229619
                                         uncertainty =       0.001625762673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465664318
  error estimate for blocks of size 2^( 2) =       0.000491333450
  error estimate for blocks of size 2^( 3) =       0.000515453867
  error estimate for blocks of size 2^( 4) =       0.000532074787
  error estimate for blocks of size 2^( 5) =       0.000542759686
  error estimate for blocks of size 2^( 6) =       0.000547520263
  error estimate for blocks of size 2^( 7) =       0.000551283782

      target function =      -0.750344177833
              le_mean =     -22.814789912109
             les_mean =     520.958655040680
             stat err =       0.000543409629
             autocorr =       1.361785598575
   target nu stat err =       0.000543409629
   target dn stat err =       0.002149778853
      target stat err =       0.001905280022
              std dev =       0.658548794655
             le_variance =       0.433686514942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433605229619
                                         uncertainty =       0.001625762673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433605229619
                                         uncertainty =       0.001625762673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465664318
  error estimate for blocks of size 2^( 2) =       0.000491333450
  error estimate for blocks of size 2^( 3) =       0.000515453867
  error estimate for blocks of size 2^( 4) =       0.000532074787
  error estimate for blocks of size 2^( 5) =       0.000542759686
  error estimate for blocks of size 2^( 6) =       0.000547520263
  error estimate for blocks of size 2^( 7) =       0.000551283782

      target function =      -0.750344177833
              le_mean =     -22.814789912109
             les_mean =     520.958655040680
             stat err =       0.000543409629
             autocorr =       1.361785598573
   target nu stat err =       0.000543409629
   target dn stat err =       0.002149778853
      target stat err =       0.001905280022
              std dev =       0.658548794655
             le_variance =       0.433686514942


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750344177833        initial  <--
     2.2737e+09     2.2737e+10             7.6881e-14        -0.750344177833
     9.0949e+09     9.0949e+10             1.9214e-14        -0.750344177833
     3.6380e+10     3.6380e+11             4.8108e-15        -0.750344177833

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8796
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4156e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.8011
    reference variance = 0.394176
====================================================
  Execution time = 2.6383e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5366e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4393e-01
  Total weights = 1.964372332e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433170685893
                                         uncertainty =       0.001860601647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433170685893
                                         uncertainty =       0.001860601647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465359579
  error estimate for blocks of size 2^( 2) =       0.000491373232
  error estimate for blocks of size 2^( 3) =       0.000515743962
  error estimate for blocks of size 2^( 4) =       0.000533470009
  error estimate for blocks of size 2^( 5) =       0.000544744611
  error estimate for blocks of size 2^( 6) =       0.000552565950
  error estimate for blocks of size 2^( 7) =       0.000557322505

      target function =      -0.750405740866
              le_mean =     -22.813790620569
             les_mean =     520.912976334717
             stat err =       0.000547025769
             autocorr =       1.381777936166
   target nu stat err =       0.000547025769
   target dn stat err =       0.002171097145
      target stat err =       0.001920977428
              std dev =       0.658117828663
             le_variance =       0.433119076404


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281379062057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+10, overlap shift 2.2737e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750409662962       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750409662962       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750409662962       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750414006714       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750409662962       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750409662962       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750409662962       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750373445016       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750413705954       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750344969118       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750417342890       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750352471218       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750401483668       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750376851028       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750414864518       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750417552917       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750401371052       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750405081737       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750432643107       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750432078547       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+10 is 4.203868e-15

solving harmonic davidson linear method for identity shift 9.0949e+10, overlap shift 9.0949e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750409662962       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750409662962       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750409662962       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750409662962       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750409662962       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750427803008       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750440364475       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750571862625       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750410134199       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750291194224       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750421607854       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750583163474       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750481831924       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750513535546       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750377269145       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750383683783       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750259129802       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750329821774       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750506364305       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750378218342       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750481917555       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750414641646       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750399342062       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750355250167       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750494601980       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750291210623       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750521872996       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750573770567       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750451250345       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750354223979       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750249587791       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750169612440       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750099934006       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750382229320       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750424729759       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.750432312230       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750446823677       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.750513751308       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.750449470398       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750519251887       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.750518720214       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.750294612158       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.750361004108       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.750591385074       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.750623354092       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750373328113       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.750531103429       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.750520348464       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750211567001       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.750371726013       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.750570332195       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.750465989091       residual = 1.47e-06           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.750548275161       residual = 1.96e-06           smallest_sin_value = 9.96e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+10 is 1.094735e-15

solving harmonic davidson linear method for identity shift 3.6380e+11, overlap shift 3.6380e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750409662962       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750409662962       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750409662962       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750409662962       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750523027260       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750409660177       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750456410021       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750336637007       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749760571862       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751343617727       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750382719596       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750325043869       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750449968158       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750680278447       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750203475630       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749947131879       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749850360403       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750238836844       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749788874622       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750355275667       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750053073266       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750725487104       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750540727831       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749641704195       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749978710306       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750023895091       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750081532000       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.751061071471       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751087829116       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749877424958       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749874507959       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749713193967       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750439389120       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750291694787       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.751020675075       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.749969468409       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750715956904       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.750535148750       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.750457338654       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750084692829       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.750268349229       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.750822090882       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.750786038974       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.750838924291       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.750440586228       residual = 8.08e-06           smallest_sin_value = 9.99e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750348807984       residual = 3.29e-05           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.750798845014       residual = 5.00e-06           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.751377670158       residual = 5.74e-05           smallest_sin_value = 9.96e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750161182771       residual = 3.59e-05           smallest_sin_value = 9.95e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.750135073941       residual = 2.27e-05           smallest_sin_value = 9.93e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.71e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+11 is 2.632493e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.519329 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1071e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7698
    reference variance = 0.365185
====================================================
  Execution time = 4.0060e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4751e-01
  Total weights = 1.9644e+06
  Execution time = 3.4785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433841983760
                                         uncertainty =       0.001913158663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433841983760
                                         uncertainty =       0.001913158663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465731767
  error estimate for blocks of size 2^( 2) =       0.000491024172
  error estimate for blocks of size 2^( 3) =       0.000514114173
  error estimate for blocks of size 2^( 4) =       0.000531210082
  error estimate for blocks of size 2^( 5) =       0.000541591631
  error estimate for blocks of size 2^( 6) =       0.000549440975
  error estimate for blocks of size 2^( 7) =       0.000554727527

      target function =      -0.747421052042
              le_mean =     -22.815429324147
             les_mean =     520.991323823356
             stat err =       0.000544242554
             autocorr =       1.365567800987
   target nu stat err =       0.000544242554
   target dn stat err =       0.002718112143
      target stat err =       0.002347282579
              std dev =       0.658644181578
             le_variance =       0.433812157926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433841983760
                                         uncertainty =       0.001913158663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433841983760
                                         uncertainty =       0.001913158663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465731767
  error estimate for blocks of size 2^( 2) =       0.000491024172
  error estimate for blocks of size 2^( 3) =       0.000514114173
  error estimate for blocks of size 2^( 4) =       0.000531210082
  error estimate for blocks of size 2^( 5) =       0.000541591631
  error estimate for blocks of size 2^( 6) =       0.000549440975
  error estimate for blocks of size 2^( 7) =       0.000554727527

      target function =      -0.747421052042
              le_mean =     -22.815429324147
             les_mean =     520.991323823356
             stat err =       0.000544242554
             autocorr =       1.365567800986
   target nu stat err =       0.000544242554
   target dn stat err =       0.002718112143
      target stat err =       0.002347282579
              std dev =       0.658644181578
             le_variance =       0.433812157926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433841983760
                                         uncertainty =       0.001913158663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433841983760
                                         uncertainty =       0.001913158663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465731767
  error estimate for blocks of size 2^( 2) =       0.000491024172
  error estimate for blocks of size 2^( 3) =       0.000514114173
  error estimate for blocks of size 2^( 4) =       0.000531210082
  error estimate for blocks of size 2^( 5) =       0.000541591631
  error estimate for blocks of size 2^( 6) =       0.000549440975
  error estimate for blocks of size 2^( 7) =       0.000554727527

      target function =      -0.747421052042
              le_mean =     -22.815429324147
             les_mean =     520.991323823356
             stat err =       0.000544242554
             autocorr =       1.365567800987
   target nu stat err =       0.000544242554
   target dn stat err =       0.002718112143
      target stat err =       0.002347282579
              std dev =       0.658644181578
             le_variance =       0.433812157926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433841983760
                                         uncertainty =       0.001913158663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433841983760
                                         uncertainty =       0.001913158663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465731767
  error estimate for blocks of size 2^( 2) =       0.000491024172
  error estimate for blocks of size 2^( 3) =       0.000514114173
  error estimate for blocks of size 2^( 4) =       0.000531210082
  error estimate for blocks of size 2^( 5) =       0.000541591631
  error estimate for blocks of size 2^( 6) =       0.000549440975
  error estimate for blocks of size 2^( 7) =       0.000554727527

      target function =      -0.747421052042
              le_mean =     -22.815429324147
             les_mean =     520.991323823356
             stat err =       0.000544242554
             autocorr =       1.365567800987
   target nu stat err =       0.000544242554
   target dn stat err =       0.002718112143
      target stat err =       0.002347282579
              std dev =       0.658644181578
             le_variance =       0.433812157926


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747421052042        initial
     2.2737e+10     2.2737e+11             4.2039e-15        -0.747421052042
     9.0949e+10     9.0949e+11             1.0947e-15        -0.747421052042
     3.6380e+11     3.6380e+12             2.6325e-16        -0.747421052042  <--

*****************************************************************************
Applying the update for shift_i =   3.6380e+11     and shift_s =   3.6380e+12
*****************************************************************************

  Execution time = 5.7475e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8553e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.8401
    reference variance = 0.3349
====================================================
  Execution time = 3.0848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4671e-01
  Total weights = 1.964461633e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5518e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436369911067
                                         uncertainty =       0.002417512851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436369911067
                                         uncertainty =       0.002417512851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467106009
  error estimate for blocks of size 2^( 2) =       0.000492620181
  error estimate for blocks of size 2^( 3) =       0.000517076471
  error estimate for blocks of size 2^( 4) =       0.000534710902
  error estimate for blocks of size 2^( 5) =       0.000545615167
  error estimate for blocks of size 2^( 6) =       0.000552943782
  error estimate for blocks of size 2^( 7) =       0.000557445682

      target function =      -0.748087633850
              le_mean =     -22.814619594927
             les_mean =     520.953574151456
             stat err =       0.000547678884
             autocorr =       1.374741633668
   target nu stat err =       0.000547678884
   target dn stat err =       0.002786872705
      target stat err =       0.002404948426
              std dev =       0.660587652294
             le_variance =       0.436376046364


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281461959493e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+10, overlap shift 9.0949e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748094427444       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748094427444       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748094427444       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748094427444       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748094427478       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748134491120       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748093407354       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748317733659       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748079141243       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748011442828       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748134458820       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748133318593       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748168946283       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748106381302       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748081978780       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748088125017       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748083512241       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748108585393       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748090801196       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748067238559       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748072328591       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748141430227       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748084848107       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748069511217       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748089018106       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748076024107       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748075587494       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748060298447       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748108486260       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748112874605       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748094979732       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748126156151       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748114413215       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748071169584       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748083584356       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748083546632       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748064652970       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748077207935       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748045648339       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748102805497       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748096577779       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748119173864       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748111395046       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748105143528       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748088862149       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.748099828622       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748112293973       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.748102108922       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748077109657       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.748146551130       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.748058823815       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.748089118503       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.748131375113       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.748087286365       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.748083152029       residual = 2.83e-06           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.748102327563       residual = 5.47e-06           smallest_sin_value = 9.99e-01
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.748128622992       residual = 5.74e-06           smallest_sin_value = 9.95e-01
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.748089684014       residual = 5.67e-06           smallest_sin_value = 9.95e-01
davidson iteration   58 stopping due to small subspace S singular value of 9.69e-01
davidson solver did not converge after         58 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+10 is 2.863910e-15

solving harmonic davidson linear method for identity shift 3.6380e+11, overlap shift 3.6380e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748094427444       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748094427444       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748094427444       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748094427444       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748094427456       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748094427443       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748093464048       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747695691738       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748314587414       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747803772093       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746901641890       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747891684820       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747744964045       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747411428207       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748388957953       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748125613195       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748172929082       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748103754000       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748112091462       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748109498588       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747969928690       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747948435610       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748137006513       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748157317456       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747961711330       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747985740867       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748007365755       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748192735736       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748171392854       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748281425857       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748138767892       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747912049964       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748180549628       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748161416605       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748064776063       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748071246806       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747917858538       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748173155816       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.747662359369       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748330489181       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748125723496       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748059557086       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748179237789       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748080376685       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.747962470752       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747905703916       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748330291007       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747999555648       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748334445606       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747893383502       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.748031453050       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.748114068248       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.748221010683       residual = 1.29e-05           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.748242313463       residual = 3.47e-05           smallest_sin_value = 9.97e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.748130610270       residual = 1.76e-05           smallest_sin_value = 9.96e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+11 is 7.039870e-16

solving harmonic davidson linear method for identity shift 1.4552e+12, overlap shift 1.4552e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748094427444       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748094427444       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748094427444       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748094427444       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748094427447       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748094427444       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748101738653       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746946357911       residual = 5.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743392502007       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750966775437       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750161733509       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746038340182       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750468034743       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744936371757       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750626296297       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.752766945341       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746523925149       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748131830033       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746895130015       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747301525705       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747642331788       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747604406907       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747734144581       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747092528101       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747781503607       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745523898586       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746025411292       residual = 6.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746884485908       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748526786104       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744078866290       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746666779062       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746941942120       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.749200728697       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748678929880       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747162113322       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.749781572355       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748277993391       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.747776961760       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746069069469       residual = 6.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747590012173       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748952848555       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747577863162       residual = 9.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748607708489       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748238317290       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748550895900       residual = 6.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.748689025785       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747993543297       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.748033298804       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748492665416       residual = 8.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747722057191       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747943064651       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.747252788270       residual = 1.24e-03           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.747478135076       residual = 1.14e-03           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.747298956620       residual = 6.66e-04           smallest_sin_value = 9.98e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.748022955619       residual = 8.40e-05           smallest_sin_value = 9.98e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.748393911878       residual = 4.81e-04           smallest_sin_value = 9.96e-01
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.748412077822       residual = 1.24e-03           smallest_sin_value = 9.92e-01
davidson iteration   57 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         57 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+12 is 1.715378e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.733327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5619e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.8542
    reference variance = 0.52235
====================================================
  Execution time = 3.8605e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4862e-01
  Total weights = 1.9643e+06
  Execution time = 3.4837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433855467381
                                         uncertainty =       0.002073583114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433855467381
                                         uncertainty =       0.002073583114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465855919
  error estimate for blocks of size 2^( 2) =       0.000491362155
  error estimate for blocks of size 2^( 3) =       0.000515399300
  error estimate for blocks of size 2^( 4) =       0.000532668965
  error estimate for blocks of size 2^( 5) =       0.000542720732
  error estimate for blocks of size 2^( 6) =       0.000545883376
  error estimate for blocks of size 2^( 7) =       0.000547974232

      target function =      -0.746479940709
              le_mean =     -22.814523327023
             les_mean =     520.951094472800
             stat err =       0.000542311826
             autocorr =       1.355173543933
   target nu stat err =       0.000542311826
   target dn stat err =       0.004838003812
      target stat err =       0.004065213329
              std dev =       0.658819758689
             le_variance =       0.434043474439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433855467381
                                         uncertainty =       0.002073583114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433855467381
                                         uncertainty =       0.002073583114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465855919
  error estimate for blocks of size 2^( 2) =       0.000491362155
  error estimate for blocks of size 2^( 3) =       0.000515399300
  error estimate for blocks of size 2^( 4) =       0.000532668965
  error estimate for blocks of size 2^( 5) =       0.000542720732
  error estimate for blocks of size 2^( 6) =       0.000545883376
  error estimate for blocks of size 2^( 7) =       0.000547974232

      target function =      -0.746479940709
              le_mean =     -22.814523327023
             les_mean =     520.951094472800
             stat err =       0.000542311826
             autocorr =       1.355173543934
   target nu stat err =       0.000542311826
   target dn stat err =       0.004838003812
      target stat err =       0.004065213329
              std dev =       0.658819758689
             le_variance =       0.434043474439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433855467381
                                         uncertainty =       0.002073583114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433855467381
                                         uncertainty =       0.002073583114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465855919
  error estimate for blocks of size 2^( 2) =       0.000491362155
  error estimate for blocks of size 2^( 3) =       0.000515399300
  error estimate for blocks of size 2^( 4) =       0.000532668965
  error estimate for blocks of size 2^( 5) =       0.000542720732
  error estimate for blocks of size 2^( 6) =       0.000545883376
  error estimate for blocks of size 2^( 7) =       0.000547974232

      target function =      -0.746479940709
              le_mean =     -22.814523327023
             les_mean =     520.951094472800
             stat err =       0.000542311826
             autocorr =       1.355173543940
   target nu stat err =       0.000542311826
   target dn stat err =       0.004838003812
      target stat err =       0.004065213329
              std dev =       0.658819758689
             le_variance =       0.434043474439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433855467381
                                         uncertainty =       0.002073583114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433855467381
                                         uncertainty =       0.002073583114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465855919
  error estimate for blocks of size 2^( 2) =       0.000491362155
  error estimate for blocks of size 2^( 3) =       0.000515399300
  error estimate for blocks of size 2^( 4) =       0.000532668965
  error estimate for blocks of size 2^( 5) =       0.000542720732
  error estimate for blocks of size 2^( 6) =       0.000545883376
  error estimate for blocks of size 2^( 7) =       0.000547974232

      target function =      -0.746479940709
              le_mean =     -22.814523327023
             les_mean =     520.951094472800
             stat err =       0.000542311826
             autocorr =       1.355173543932
   target nu stat err =       0.000542311826
   target dn stat err =       0.004838003812
      target stat err =       0.004065213329
              std dev =       0.658819758689
             le_variance =       0.434043474439


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746479940709        initial
     9.0949e+10     9.0949e+11             2.8639e-15        -0.746479940709
     3.6380e+11     3.6380e+12             7.0399e-16        -0.746479940709  <--
     1.4552e+12     1.4552e+13             1.7154e-16        -0.746479940709

*****************************************************************************
Applying the update for shift_i =   3.6380e+11     and shift_s =   3.6380e+12
*****************************************************************************

  Execution time = 5.6047e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1671e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.7395
    reference variance = 0.536322
====================================================
  Execution time = 2.5877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4991e-01
  Total weights = 1.964552504e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5337e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437946891709
                                         uncertainty =       0.002810871697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437946891709
                                         uncertainty =       0.002810871697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467987406
  error estimate for blocks of size 2^( 2) =       0.000494233416
  error estimate for blocks of size 2^( 3) =       0.000518426730
  error estimate for blocks of size 2^( 4) =       0.000535966272
  error estimate for blocks of size 2^( 5) =       0.000546828952
  error estimate for blocks of size 2^( 6) =       0.000552547196
  error estimate for blocks of size 2^( 7) =       0.000557461900

      target function =      -0.745422364247
              le_mean =     -22.814433708881
             les_mean =     520.948291125756
             stat err =       0.000548201080
             autocorr =       1.372181128624
   target nu stat err =       0.000548201080
   target dn stat err =       0.003621767906
      target stat err =       0.003061783474
              std dev =       0.661834136360
             le_variance =       0.438024424051


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281443370888e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+10, overlap shift 9.0949e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745434118510       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745434118510       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745434118510       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745434118510       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745434118519       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745433431350       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745439155433       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745615480410       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745117006535       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745538030792       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745416189481       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745415523004       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745346099621       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745399557588       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745299146386       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745477279288       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745403993363       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745388810881       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745402221416       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745396390498       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745508956991       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745480991376       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745327289895       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745511358865       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745446194321       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745307812733       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745350560720       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745416776798       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745632136699       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745598162546       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745240822445       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745639872706       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745420909739       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745431082517       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745426634517       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.745325770365       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.745415569727       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.745515891889       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.745573759606       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.745504356407       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.745332868426       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.745469086448       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.745497870521       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.745492159163       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745500900234       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745474432001       residual = 3.79e-05           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.745487279164       residual = 8.60e-06           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.745423064817       residual = 3.63e-06           smallest_sin_value = 9.97e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.745493073001       residual = 1.00e-06           smallest_sin_value = 9.94e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+10 is 1.980765e-15

solving harmonic davidson linear method for identity shift 3.6380e+11, overlap shift 3.6380e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745434118510       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745434118510       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745434118510       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745434118510       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745196085190       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745434118512       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745434208537       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745213609441       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745938164428       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745343552149       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744413881272       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745286220484       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745132516193       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745306067474       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745611648736       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745505360419       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745318701645       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745280272680       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745177640374       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745232265583       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745545794430       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745455116463       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745438724051       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745672568067       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745470009699       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745465066891       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745504814317       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745532853646       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745705186930       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745422139043       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745491674040       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745157601219       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745062470009       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745549441550       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745389440122       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.745470580387       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.745444148964       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.745418770977       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.745428706442       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.745400001389       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.745509870292       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.745325639773       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.745410752349       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.745540570243       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745503237388       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745470408253       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.745448833335       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.745430169402       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.745389521734       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.745520025438       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.745421501615       residual = 2.53e-05           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.745443019883       residual = 5.58e-06           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.745360025172       residual = 9.51e-06           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.745346524017       residual = 1.09e-05           smallest_sin_value = 9.97e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.745514924169       residual = 2.26e-05           smallest_sin_value = 9.97e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.745623558773       residual = 1.87e-05           smallest_sin_value = 9.94e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+11 is 4.968691e-16

solving harmonic davidson linear method for identity shift 1.4552e+12, overlap shift 1.4552e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745434118510       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745434118510       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745434118510       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745434118510       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745434118510       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745673316143       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745937569893       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745660248781       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744112013220       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743683397006       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748348998360       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742996569999       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747216511307       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745613299115       residual = 8.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745946370382       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746171352964       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743615805652       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745594949724       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743859416815       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745741311628       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746919323701       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746250526871       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744704176402       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746885231947       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745417191953       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746340334990       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745831955221       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745215734624       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744189357730       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745702494105       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749134010251       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746441940139       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744658633801       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.744776143200       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745039431894       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.745637944897       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.744888320912       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.744414123797       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746606285956       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.745918309836       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.743749954859       residual = 9.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.745697646207       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.745534022619       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746927052315       residual = 2.56e-04           smallest_sin_value = 9.99e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.747523465843       residual = 3.58e-04           smallest_sin_value = 9.99e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747757974827       residual = 5.42e-04           smallest_sin_value = 9.94e-01
davidson iteration   46 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+12 is 1.257548e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.888147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0571e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8807
    reference variance = 0.269744
====================================================
  Execution time = 2.5833e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4953e-01
  Total weights = 1.9643e+06
  Execution time = 3.4684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438918371813
                                         uncertainty =       0.003278480596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438918371813
                                         uncertainty =       0.003278480596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468421903
  error estimate for blocks of size 2^( 2) =       0.000493655771
  error estimate for blocks of size 2^( 3) =       0.000517224723
  error estimate for blocks of size 2^( 4) =       0.000534462447
  error estimate for blocks of size 2^( 5) =       0.000545654560
  error estimate for blocks of size 2^( 6) =       0.000551376168
  error estimate for blocks of size 2^( 7) =       0.000556221391

      target function =      -0.745730569957
              le_mean =     -22.815523274229
             les_mean =     520.997633934056
             stat err =       0.000546928641
             autocorr =       1.363285906176
   target nu stat err =       0.000546928641
   target dn stat err =       0.003798649033
      target stat err =       0.003213086998
              std dev =       0.662448608704
             le_variance =       0.438838159174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438918371813
                                         uncertainty =       0.003278480596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438918371813
                                         uncertainty =       0.003278480596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468421903
  error estimate for blocks of size 2^( 2) =       0.000493655771
  error estimate for blocks of size 2^( 3) =       0.000517224723
  error estimate for blocks of size 2^( 4) =       0.000534462447
  error estimate for blocks of size 2^( 5) =       0.000545654560
  error estimate for blocks of size 2^( 6) =       0.000551376168
  error estimate for blocks of size 2^( 7) =       0.000556221391

      target function =      -0.745730569957
              le_mean =     -22.815523274229
             les_mean =     520.997633934056
             stat err =       0.000546928641
             autocorr =       1.363285906175
   target nu stat err =       0.000546928641
   target dn stat err =       0.003798649033
      target stat err =       0.003213086998
              std dev =       0.662448608704
             le_variance =       0.438838159174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438918371813
                                         uncertainty =       0.003278480596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438918371813
                                         uncertainty =       0.003278480596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468421903
  error estimate for blocks of size 2^( 2) =       0.000493655771
  error estimate for blocks of size 2^( 3) =       0.000517224723
  error estimate for blocks of size 2^( 4) =       0.000534462447
  error estimate for blocks of size 2^( 5) =       0.000545654560
  error estimate for blocks of size 2^( 6) =       0.000551376168
  error estimate for blocks of size 2^( 7) =       0.000556221391

      target function =      -0.745730569957
              le_mean =     -22.815523274229
             les_mean =     520.997633934056
             stat err =       0.000546928641
             autocorr =       1.363285906174
   target nu stat err =       0.000546928641
   target dn stat err =       0.003798649033
      target stat err =       0.003213086998
              std dev =       0.662448608704
             le_variance =       0.438838159174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438918371813
                                         uncertainty =       0.003278480596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438918371813
                                         uncertainty =       0.003278480596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468421903
  error estimate for blocks of size 2^( 2) =       0.000493655771
  error estimate for blocks of size 2^( 3) =       0.000517224723
  error estimate for blocks of size 2^( 4) =       0.000534462447
  error estimate for blocks of size 2^( 5) =       0.000545654560
  error estimate for blocks of size 2^( 6) =       0.000551376168
  error estimate for blocks of size 2^( 7) =       0.000556221391

      target function =      -0.745730569957
              le_mean =     -22.815523274229
             les_mean =     520.997633934056
             stat err =       0.000546928641
             autocorr =       1.363285906176
   target nu stat err =       0.000546928641
   target dn stat err =       0.003798649033
      target stat err =       0.003213086998
              std dev =       0.662448608704
             le_variance =       0.438838159174


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745730569957        initial  <--
     9.0949e+10     9.0949e+11             1.9808e-15        -0.745730569957
     3.6380e+11     3.6380e+12             4.9687e-16        -0.745730569957
     1.4552e+12     1.4552e+13             1.2575e-16        -0.745730569957

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.2282
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3867e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7592
    reference variance = 0.349557
====================================================
  Execution time = 2.5831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4793e-01
  Total weights = 1.964331062e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436583645408
                                         uncertainty =       0.004649535543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436583645408
                                         uncertainty =       0.004649535543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467195986
  error estimate for blocks of size 2^( 2) =       0.000492843237
  error estimate for blocks of size 2^( 3) =       0.000516859044
  error estimate for blocks of size 2^( 4) =       0.000534926080
  error estimate for blocks of size 2^( 5) =       0.000546673566
  error estimate for blocks of size 2^( 6) =       0.000551124907
  error estimate for blocks of size 2^( 7) =       0.000551922299

      target function =      -0.747048590737
              le_mean =     -22.813659310302
             les_mean =     520.910978906110
             stat err =       0.000546161713
             autocorr =       1.366609066770
   target nu stat err =       0.000546161713
   target dn stat err =       0.005325313206
      target stat err =       0.004467654090
              std dev =       0.660714900149
             le_variance =       0.436544179279


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281365931030e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+11, overlap shift 9.0949e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747074052112       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747074052112       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747074052112       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747074052112       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747074052112       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747074052112       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746910881960       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747074052112       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745319846729       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745294068699       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745809490578       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748648712093       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746381562949       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747089652611       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744677372478       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745784223057       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747018876387       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745242402450       residual = 5.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746763803615       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746011739600       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746615585688       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747409737637       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747373830679       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746016692269       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746794974793       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747545037498       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747017737828       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747512101525       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746480264296       residual = 9.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747760379433       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746957840261       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747882521295       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747594175933       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747138424027       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747101208532       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747229093672       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746553340130       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.747407035727       residual = 9.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746465685162       residual = 9.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.745950791729       residual = 7.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.747404890741       residual = 7.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747913855230       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746915768743       residual = 9.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747215797658       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746186946184       residual = 6.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.748031666969       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747626527246       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746852325531       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.747253986962       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747938257358       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747057046217       residual = 5.91e-04           smallest_sin_value = 9.98e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.747417511983       residual = 1.95e-03           smallest_sin_value = 9.90e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+11 is 1.262877e-16

solving harmonic davidson linear method for identity shift 3.6380e+12, overlap shift 3.6380e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747074052112       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747074052112       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747074052112       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747074052112       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747074052112       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748518610197       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746217195888       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750032165010       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747646802620       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.754064044726       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743843233580       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.752537875713       residual = 9.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748923547057       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746877711448       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751469277088       residual = 8.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742201212313       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749414023783       residual = 6.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749945975684       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.752113086217       residual = 4.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.755295447485       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.739831070220       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745644851962       residual = 8.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744222280163       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749501097969       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743936580090       residual = 6.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745889416716       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744093759072       residual = 8.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748412401958       residual = 8.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751597592554       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745824580196       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.739583075251       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.760186039301       residual = 5.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747511087348       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747868083936       residual = 7.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.749477707305       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747278487706       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742066314227       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748817769158       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.747351787884       residual = 8.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.740441801936       residual = 9.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.747246096700       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.743419372877       residual = 7.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.744507545271       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.749490343088       residual = 5.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.747499348524       residual = 7.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746759619479       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747825181802       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747063847660       residual = 8.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748108952364       residual = 8.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747993249846       residual = 4.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747335168422       residual = 9.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.747468724933       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.754177686855       residual = 9.48e-03           smallest_sin_value = 9.98e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.744358726932       residual = 1.52e-02           smallest_sin_value = 9.98e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.744865930889       residual = 1.27e-02           smallest_sin_value = 9.95e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+12 is 2.705331e-17

solving harmonic davidson linear method for identity shift 1.4552e+13, overlap shift 1.4552e+14 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747074052112       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747074052112       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.58e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.010522 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0451e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7576
    reference variance = 0.347443
====================================================
  Execution time = 2.7667e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4720e-01
  Total weights = 1.9645e+06
  Execution time = 3.4694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433301111987
                                         uncertainty =       0.001534185705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433301111987
                                         uncertainty =       0.001534185705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465466807
  error estimate for blocks of size 2^( 2) =       0.000491090226
  error estimate for blocks of size 2^( 3) =       0.000514715387
  error estimate for blocks of size 2^( 4) =       0.000532294987
  error estimate for blocks of size 2^( 5) =       0.000542905906
  error estimate for blocks of size 2^( 6) =       0.000548460102
  error estimate for blocks of size 2^( 7) =       0.000549584566

      target function =      -0.747678277502
              le_mean =     -22.814900631276
             les_mean =     520.966889055453
             stat err =       0.000543311390
             autocorr =       1.362448785972
   target nu stat err =       0.000543311390
   target dn stat err =       0.002849549777
      target stat err =       0.002452797779
              std dev =       0.658269471738
             le_variance =       0.433318697422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433301111987
                                         uncertainty =       0.001534185705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433301111987
                                         uncertainty =       0.001534185705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465466807
  error estimate for blocks of size 2^( 2) =       0.000491090226
  error estimate for blocks of size 2^( 3) =       0.000514715387
  error estimate for blocks of size 2^( 4) =       0.000532294987
  error estimate for blocks of size 2^( 5) =       0.000542905906
  error estimate for blocks of size 2^( 6) =       0.000548460102
  error estimate for blocks of size 2^( 7) =       0.000549584566

      target function =      -0.747678277502
              le_mean =     -22.814900631276
             les_mean =     520.966889055453
             stat err =       0.000543311390
             autocorr =       1.362448785972
   target nu stat err =       0.000543311390
   target dn stat err =       0.002849549777
      target stat err =       0.002452797779
              std dev =       0.658269471738
             le_variance =       0.433318697422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433301111987
                                         uncertainty =       0.001534185705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433301111987
                                         uncertainty =       0.001534185705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465466807
  error estimate for blocks of size 2^( 2) =       0.000491090226
  error estimate for blocks of size 2^( 3) =       0.000514715387
  error estimate for blocks of size 2^( 4) =       0.000532294987
  error estimate for blocks of size 2^( 5) =       0.000542905906
  error estimate for blocks of size 2^( 6) =       0.000548460102
  error estimate for blocks of size 2^( 7) =       0.000549584566

      target function =      -0.747678277502
              le_mean =     -22.814900631276
             les_mean =     520.966889055453
             stat err =       0.000543311390
             autocorr =       1.362448785969
   target nu stat err =       0.000543311390
   target dn stat err =       0.002849549777
      target stat err =       0.002452797779
              std dev =       0.658269471738
             le_variance =       0.433318697422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433301111987
                                         uncertainty =       0.001534185705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433301111987
                                         uncertainty =       0.001534185705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465466807
  error estimate for blocks of size 2^( 2) =       0.000491090226
  error estimate for blocks of size 2^( 3) =       0.000514715387
  error estimate for blocks of size 2^( 4) =       0.000532294987
  error estimate for blocks of size 2^( 5) =       0.000542905906
  error estimate for blocks of size 2^( 6) =       0.000548460102
  error estimate for blocks of size 2^( 7) =       0.000549584566

      target function =      -0.747678277502
              le_mean =     -22.814900631276
             les_mean =     520.966889055453
             stat err =       0.000543311390
             autocorr =       1.362448785970
   target nu stat err =       0.000543311390
   target dn stat err =       0.002849549777
      target stat err =       0.002452797779
              std dev =       0.658269471738
             le_variance =       0.433318697422


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747678277502        initial
     9.0949e+11     9.0949e+12             1.2629e-16        -0.747678277502
     3.6380e+12     3.6380e+13             2.7053e-17        -0.747678277502  <--
     1.4552e+13     1.4552e+14             0.0000e+00        -0.747678277502

*****************************************************************************
Applying the update for shift_i =   3.6380e+12     and shift_s =   3.6380e+13
*****************************************************************************

  Execution time = 4.5051e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5508e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.7702
    reference variance = 0.392724
====================================================
  Execution time = 2.5836e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5374e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4984e-01
  Total weights = 1.964680301e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436006501608
                                         uncertainty =       0.002022730155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436006501608
                                         uncertainty =       0.002022730155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466880826
  error estimate for blocks of size 2^( 2) =       0.000491975070
  error estimate for blocks of size 2^( 3) =       0.000515420894
  error estimate for blocks of size 2^( 4) =       0.000532477289
  error estimate for blocks of size 2^( 5) =       0.000543346566
  error estimate for blocks of size 2^( 6) =       0.000548225510
  error estimate for blocks of size 2^( 7) =       0.000551727602

      target function =      -0.745477803938
              le_mean =     -22.815098841647
             les_mean =     520.978574403426
             stat err =       0.000543944242
             autocorr =       1.357365137883
   target nu stat err =       0.000543944242
   target dn stat err =       0.003525679798
      target stat err =       0.002986241420
              std dev =       0.660269195738
             le_variance =       0.435955410840


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281509884165e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+11, overlap shift 9.0949e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745488787186       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745488787186       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745488787186       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745488787186       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745488787186       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745488787186       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745488787186       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744590621991       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745488787186       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745391545391       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744235278915       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745072530926       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746239025074       residual = 8.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742991450438       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743226065349       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745342069340       residual = 8.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745507109393       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746132960231       residual = 9.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745324370692       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744778595304       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745501678839       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745368776700       residual = 8.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745660438394       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745653206723       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745198104436       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745380189533       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745448325495       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745567349392       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745346214126       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745477576997       residual = 9.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745395992665       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745446542934       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745404329847       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745851175384       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745527830774       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.745846208498       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.745237770269       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.745552853771       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.745216493782       residual = 9.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.745863263567       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.745510334063       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.745403741244       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.745533042736       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.745806679995       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745415725386       residual = 6.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745326771108       residual = 6.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.745267010712       residual = 7.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.745546414986       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.745824860902       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.745541477091       residual = 5.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.745394293839       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.745392924061       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.744489142754       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.745868571244       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.745159370555       residual = 3.30e-05           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.745942480698       residual = 3.84e-04           smallest_sin_value = 9.99e-01
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.745429459784       residual = 8.96e-05           smallest_sin_value = 9.98e-01
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.745694208459       residual = 3.96e-04           smallest_sin_value = 9.94e-01
davidson iteration   58 stopping due to small subspace S singular value of 9.72e-01
davidson solver did not converge after         58 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+11 is 1.921222e-16

solving harmonic davidson linear method for identity shift 3.6380e+12, overlap shift 3.6380e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745488787186       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745488787186       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745488787186       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745488787186       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745750189483       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745842455982       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743833865288       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748039068720       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.734735949488       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751218153760       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.733955828914       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748901299150       residual = 4.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745655337382       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743578864981       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745168067365       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747859437938       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743183368549       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.738137535045       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741428827865       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744626735497       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748557276551       residual = 2.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750661772505       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749278943784       residual = 6.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749028457302       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744984541875       residual = 8.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742830313033       residual = 6.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740755474031       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750136215418       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744349126503       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746988618175       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743517495230       residual = 9.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745414382050       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.740893510112       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750791125664       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.738802770301       residual = 7.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746057419884       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.744943259723       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.744638684271       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.744640918908       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747667498850       residual = 9.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.751009395831       residual = 7.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.743373839926       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.751019737478       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.750733192649       residual = 7.28e-03           smallest_sin_value = 9.98e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745357289783       residual = 1.44e-03           smallest_sin_value = 9.97e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745571305825       residual = 1.15e-03           smallest_sin_value = 9.92e-01
davidson iteration   46: stopping due to imaginary component in cost function
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+12 is 3.097093e-17

solving harmonic davidson linear method for identity shift 1.4552e+13, overlap shift 1.4552e+14 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745488787186       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745488787186       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.59e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.127707 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0437e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.8037
    reference variance = 0.451624
====================================================
  Execution time = 2.5353e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5018e-01
  Total weights = 1.9641e+06
  Execution time = 3.4775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434417366494
                                         uncertainty =       0.002295940578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434417366494
                                         uncertainty =       0.002295940578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466078291
  error estimate for blocks of size 2^( 2) =       0.000491910881
  error estimate for blocks of size 2^( 3) =       0.000515282663
  error estimate for blocks of size 2^( 4) =       0.000532500213
  error estimate for blocks of size 2^( 5) =       0.000543858749
  error estimate for blocks of size 2^( 6) =       0.000551217296
  error estimate for blocks of size 2^( 7) =       0.000554577207

      target function =      -0.745196292896
              le_mean =     -22.814448527086
             les_mean =     520.949240644374
             stat err =       0.000545538366
             autocorr =       1.370038739185
   target nu stat err =       0.000545538366
   target dn stat err =       0.003597113805
      target stat err =       0.003039435982
              std dev =       0.659134240564
             le_variance =       0.434457947085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434417366494
                                         uncertainty =       0.002295940578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434417366494
                                         uncertainty =       0.002295940578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466078291
  error estimate for blocks of size 2^( 2) =       0.000491910881
  error estimate for blocks of size 2^( 3) =       0.000515282663
  error estimate for blocks of size 2^( 4) =       0.000532500213
  error estimate for blocks of size 2^( 5) =       0.000543858749
  error estimate for blocks of size 2^( 6) =       0.000551217296
  error estimate for blocks of size 2^( 7) =       0.000554577207

      target function =      -0.745196292896
              le_mean =     -22.814448527086
             les_mean =     520.949240644374
             stat err =       0.000545538366
             autocorr =       1.370038739184
   target nu stat err =       0.000545538366
   target dn stat err =       0.003597113805
      target stat err =       0.003039435982
              std dev =       0.659134240564
             le_variance =       0.434457947084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434417366494
                                         uncertainty =       0.002295940578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434417366494
                                         uncertainty =       0.002295940578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466078291
  error estimate for blocks of size 2^( 2) =       0.000491910881
  error estimate for blocks of size 2^( 3) =       0.000515282663
  error estimate for blocks of size 2^( 4) =       0.000532500213
  error estimate for blocks of size 2^( 5) =       0.000543858749
  error estimate for blocks of size 2^( 6) =       0.000551217296
  error estimate for blocks of size 2^( 7) =       0.000554577207

      target function =      -0.745196292896
              le_mean =     -22.814448527086
             les_mean =     520.949240644374
             stat err =       0.000545538366
             autocorr =       1.370038739184
   target nu stat err =       0.000545538366
   target dn stat err =       0.003597113805
      target stat err =       0.003039435982
              std dev =       0.659134240564
             le_variance =       0.434457947084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434417366494
                                         uncertainty =       0.002295940578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434417366494
                                         uncertainty =       0.002295940578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466078291
  error estimate for blocks of size 2^( 2) =       0.000491910881
  error estimate for blocks of size 2^( 3) =       0.000515282663
  error estimate for blocks of size 2^( 4) =       0.000532500213
  error estimate for blocks of size 2^( 5) =       0.000543858749
  error estimate for blocks of size 2^( 6) =       0.000551217296
  error estimate for blocks of size 2^( 7) =       0.000554577207

      target function =      -0.745196292896
              le_mean =     -22.814448527086
             les_mean =     520.949240644374
             stat err =       0.000545538366
             autocorr =       1.370038739185
   target nu stat err =       0.000545538366
   target dn stat err =       0.003597113805
      target stat err =       0.003039435982
              std dev =       0.659134240564
             le_variance =       0.434457947085


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745196292896        initial
     9.0949e+11     9.0949e+12             1.9212e-16        -0.745196292896
     3.6380e+12     3.6380e+13             3.0971e-17        -0.745196292896  <--
     1.4552e+13     1.4552e+14             0.0000e+00        -0.745196292896

*****************************************************************************
Applying the update for shift_i =   3.6380e+12     and shift_s =   3.6380e+13
*****************************************************************************

  Execution time = 4.2773e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3216e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.8812
    reference variance = 0.271881
====================================================
  Execution time = 2.5780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5458e-01
  Total weights = 1.964312857e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442592539462
                                         uncertainty =       0.003425465009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442592539462
                                         uncertainty =       0.003425465009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470383891
  error estimate for blocks of size 2^( 2) =       0.000495659884
  error estimate for blocks of size 2^( 3) =       0.000519364508
  error estimate for blocks of size 2^( 4) =       0.000536638953
  error estimate for blocks of size 2^( 5) =       0.000548565229
  error estimate for blocks of size 2^( 6) =       0.000556635465
  error estimate for blocks of size 2^( 7) =       0.000558826510

      target function =      -0.741563832122
              le_mean =     -22.814955721725
             les_mean =     520.976783210746
             stat err =       0.000550166539
             autocorr =       1.367991711080
   target nu stat err =       0.000550166539
   target dn stat err =       0.004201997125
      target stat err =       0.003501340069
              std dev =       0.665223278225
             le_variance =       0.442522009893


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281495572172e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+11, overlap shift 9.0949e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741579376214       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741579376214       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741579376214       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741579376214       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741579376180       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740956952733       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741709134830       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742358989744       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741196729580       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741823352469       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744571084308       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741571554287       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739503499845       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744611079561       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740729380125       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743444809363       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742666387986       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740748713235       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740350440086       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.739007868731       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740686009835       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741538374697       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741405303686       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741757590170       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742346247309       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740536824166       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741699545290       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741041525085       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741823138057       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742485719629       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.740754569102       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741437468153       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741423215837       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.741676938575       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.740991885751       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.741541466048       residual = 5.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.741353529770       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.741260260930       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.741505883710       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.741347565930       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.740662419335       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.741310016618       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.741628739334       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.740502856158       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.740900901781       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.741799511600       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.742442755151       residual = 8.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.742757468366       residual = 3.87e-04           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.741028497256       residual = 4.71e-05           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.742128842946       residual = 2.60e-04           smallest_sin_value = 9.98e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.743771619000       residual = 9.56e-05           smallest_sin_value = 9.98e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.741702754949       residual = 1.15e-04           smallest_sin_value = 9.97e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+11 is 1.513986e-16

solving harmonic davidson linear method for identity shift 3.6380e+12, overlap shift 3.6380e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741579376214       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741579376214       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741579376214       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741579376214       residual = 9.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741579376204       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741579376214       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742723470974       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741493435186       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741445753991       residual = 4.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.759157251776       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.734775064347       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.734650967264       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743259399070       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.739488962285       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.735709197711       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739126050180       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.739676342206       residual = 5.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742784460462       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742062752575       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741233490805       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741925463645       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740547293586       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743061178474       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740465268275       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741672581431       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740759306329       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742055941461       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740586491563       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.739968685200       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.739366206318       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.739696928945       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.738505807237       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.740784030502       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742659574219       residual = 4.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.741366797126       residual = 6.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.740383661831       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.741935097641       residual = 9.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.739608966852       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.741036408890       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.742130768993       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.744248041360       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.743993137956       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.741961400527       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.738454022917       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.740535897235       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.741292130570       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.741396176652       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.740906981074       residual = 1.72e-02           smallest_sin_value = 9.98e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.743031175062       residual = 4.36e-03           smallest_sin_value = 9.97e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+12 is 4.133611e-17

solving harmonic davidson linear method for identity shift 1.4552e+13, overlap shift 1.4552e+14 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741579376214       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741579376214       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741579376214       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741579376214       residual = 9.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741579376263       residual = 7.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741579240896       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740893829434       residual = 6.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.757380394940       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.716406757491       residual = 4.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.701122379340       residual = 4.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709860274422       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749646710566       residual = 3.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.772076769892       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.729919081372       residual = 9.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.728146424903       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741708167271       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.759621638830       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.731652559916       residual = 6.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.734771843704       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.693891257463       residual = 3.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748245429540       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745636915322       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.758474333045       residual = 3.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744701221729       residual = 4.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746971212682       residual = 3.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.760270626597       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.779332705368       residual = 6.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.762796034769       residual = 5.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747257197097       residual = 9.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740198511743       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.739535746352       residual = 7.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748053136635       residual = 9.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745631873737       residual = 6.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.757408811932       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748850678804       residual = 1.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.741967964208       residual = 5.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.729016730556       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.735010766880       residual = 8.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.744780593049       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.730992329024       residual = 8.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.745020781889       residual = 6.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.734744947921       residual = 2.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.743415930987       residual = 3.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747862546045       residual = 5.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745986706571       residual = 5.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.751094292183       residual = 9.16e-02           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.740509125751       residual = 6.67e-02           smallest_sin_value = 9.98e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.749868166657       residual = 6.73e-02           smallest_sin_value = 9.98e-01
davidson iteration   48: stopping due to imaginary component in cost function
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+13 is 8.277971e-18

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.274213 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0415e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7007
    reference variance = 0.331018
====================================================
  Execution time = 2.7376e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4701e-01
  Total weights = 1.9641e+06
  Execution time = 3.7633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435140484053
                                         uncertainty =       0.002028976809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435140484053
                                         uncertainty =       0.002028976809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466501628
  error estimate for blocks of size 2^( 2) =       0.000491969377
  error estimate for blocks of size 2^( 3) =       0.000516060622
  error estimate for blocks of size 2^( 4) =       0.000534353349
  error estimate for blocks of size 2^( 5) =       0.000545034984
  error estimate for blocks of size 2^( 6) =       0.000551721261
  error estimate for blocks of size 2^( 7) =       0.000554675976

      target function =      -0.747832309291
              le_mean =     -22.814692858736
             les_mean =     520.957219379108
             stat err =       0.000546446393
             autocorr =       1.372109590627
   target nu stat err =       0.000546446393
   target dn stat err =       0.003388609038
      target stat err =       0.002891621912
              std dev =       0.659732928585
             le_variance =       0.435247537060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435140484054
                                         uncertainty =       0.002028976809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435140484054
                                         uncertainty =       0.002028976809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466501628
  error estimate for blocks of size 2^( 2) =       0.000491969377
  error estimate for blocks of size 2^( 3) =       0.000516060622
  error estimate for blocks of size 2^( 4) =       0.000534353349
  error estimate for blocks of size 2^( 5) =       0.000545034984
  error estimate for blocks of size 2^( 6) =       0.000551721261
  error estimate for blocks of size 2^( 7) =       0.000554675976

      target function =      -0.747832309291
              le_mean =     -22.814692858736
             les_mean =     520.957219379108
             stat err =       0.000546446393
             autocorr =       1.372109590625
   target nu stat err =       0.000546446393
   target dn stat err =       0.003388609038
      target stat err =       0.002891621912
              std dev =       0.659732928585
             le_variance =       0.435247537060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435140484054
                                         uncertainty =       0.002028976809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435140484054
                                         uncertainty =       0.002028976809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466501628
  error estimate for blocks of size 2^( 2) =       0.000491969377
  error estimate for blocks of size 2^( 3) =       0.000516060622
  error estimate for blocks of size 2^( 4) =       0.000534353349
  error estimate for blocks of size 2^( 5) =       0.000545034984
  error estimate for blocks of size 2^( 6) =       0.000551721261
  error estimate for blocks of size 2^( 7) =       0.000554675976

      target function =      -0.747832309291
              le_mean =     -22.814692858736
             les_mean =     520.957219379108
             stat err =       0.000546446393
             autocorr =       1.372109590626
   target nu stat err =       0.000546446393
   target dn stat err =       0.003388609038
      target stat err =       0.002891621912
              std dev =       0.659732928585
             le_variance =       0.435247537060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435140484053
                                         uncertainty =       0.002028976809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435140484053
                                         uncertainty =       0.002028976809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466501628
  error estimate for blocks of size 2^( 2) =       0.000491969377
  error estimate for blocks of size 2^( 3) =       0.000516060622
  error estimate for blocks of size 2^( 4) =       0.000534353349
  error estimate for blocks of size 2^( 5) =       0.000545034984
  error estimate for blocks of size 2^( 6) =       0.000551721261
  error estimate for blocks of size 2^( 7) =       0.000554675976

      target function =      -0.747832309291
              le_mean =     -22.814692858736
             les_mean =     520.957219379108
             stat err =       0.000546446393
             autocorr =       1.372109590626
   target nu stat err =       0.000546446393
   target dn stat err =       0.003388609038
      target stat err =       0.002891621912
              std dev =       0.659732928585
             le_variance =       0.435247537060


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747832309291        initial
     9.0949e+11     9.0949e+12             1.5140e-16        -0.747832309291  <--
     3.6380e+12     3.6380e+13             4.1336e-17        -0.747832309291
     1.4552e+13     1.4552e+14             8.2780e-18        -0.747832309291

*****************************************************************************
Applying the update for shift_i =   9.0949e+11     and shift_s =   9.0949e+12
*****************************************************************************

  Execution time = 4.5118e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5539e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.8244
    reference variance = 0.565852
====================================================
  Execution time = 2.5860e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4590e-01
  Total weights = 1.964449177e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5241e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433047697609
                                         uncertainty =       0.001918238697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433047697609
                                         uncertainty =       0.001918238697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465311614
  error estimate for blocks of size 2^( 2) =       0.000491127391
  error estimate for blocks of size 2^( 3) =       0.000515316739
  error estimate for blocks of size 2^( 4) =       0.000533188659
  error estimate for blocks of size 2^( 5) =       0.000544297713
  error estimate for blocks of size 2^( 6) =       0.000549926547
  error estimate for blocks of size 2^( 7) =       0.000552787643

      target function =      -0.748764264256
              le_mean =     -22.814525166422
             les_mean =     520.948455653273
             stat err =       0.000545050140
             autocorr =       1.372097983476
   target nu stat err =       0.000545050140
   target dn stat err =       0.002700971323
      target stat err =       0.002338661491
              std dev =       0.658049995831
             le_variance =       0.433029797013


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281452516642e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+11, overlap shift 2.2737e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748770495671       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748770495671       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748770495671       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748770875100       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748770495671       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748775674157       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748716489827       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749109829544       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748849364842       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748136165058       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748767410668       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749526414240       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748781431208       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748950456366       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748374610866       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748337565628       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748874824283       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748823320768       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748400279304       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748356294264       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748985523900       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748851515094       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749036971644       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749424081449       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748546032761       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748843195000       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748956806747       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748887621476       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748597824909       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749031000748       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749362736738       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748754792225       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748882042759       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748677066705       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748612872005       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748928745541       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748739418882       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748561615220       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748869347931       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748664283365       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.749011730041       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748547414347       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748796204144       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748873739410       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748851377052       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.748743907960       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748800877466       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.748756626825       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748615872463       residual = 3.58e-05           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.748960213634       residual = 4.56e-05           smallest_sin_value = 9.97e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.748797120512       residual = 4.21e-05           smallest_sin_value = 9.97e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+11 is 4.374055e-16

solving harmonic davidson linear method for identity shift 9.0949e+11, overlap shift 9.0949e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748770495671       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748770495671       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748770495671       residual = 8.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748770495671       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748770495671       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748770495671       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748770495671       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748770495671       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748770495671       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748770495671       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748709677466       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747818692376       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750275180763       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750086702493       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748947832749       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749938188473       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748777466986       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750765202586       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748613171808       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748228392554       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748619496315       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748940679943       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749380096440       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748054928138       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747870920937       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749268944258       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747523148419       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748283883013       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750203668499       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747640594831       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748076389238       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746599358128       residual = 8.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750280003625       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750120904709       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750221544480       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748884214111       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747495985836       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748290496544       residual = 6.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.749188550465       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750332439695       residual = 6.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748405737906       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748070966975       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.749199862331       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748895292407       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748789727775       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.749574835315       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.749635558078       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.748799120296       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748552184505       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747483747846       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.751513196801       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.749118584865       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.748516655194       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.750195890187       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.748918736253       residual = 5.57e-05           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.747696786460       residual = 1.32e-04           smallest_sin_value = 9.95e-01
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.749329670037       residual = 1.18e-04           smallest_sin_value = 9.94e-01
davidson iteration   57 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         57 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+11 is 1.104311e-16

solving harmonic davidson linear method for identity shift 3.6380e+12, overlap shift 3.6380e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748770495671       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748770495671       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748770495671       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748770495671       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748823761375       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745821353231       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748213243520       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749473574819       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746387437351       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.752025542155       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741002808442       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.752969216325       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750861120170       residual = 5.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748015699893       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744014755226       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747987058389       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748286101317       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745509964530       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744002546927       residual = 4.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747377829859       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745775422932       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749108800421       residual = 9.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750389426416       residual = 7.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748753864636       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750956782291       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747317876298       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748715068052       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746129804380       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.753542436892       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.752595384792       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.752301413012       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.753096739722       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744303196248       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.749242470725       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748119892824       residual = 9.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.753702585974       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746776636619       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748062286593       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.749445757595       residual = 3.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748528243866       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.747571427502       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747605133914       residual = 3.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.753075719850       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.744694131546       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748806322348       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.754998714370       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746848571521       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.754243825353       residual = 8.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.754134839307       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746627969188       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747960609939       residual = 1.37e-02           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.745502490825       residual = 1.31e-02           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.751613060693       residual = 5.04e-03           smallest_sin_value = 9.92e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.752015817479       residual = 6.64e-03           smallest_sin_value = 9.90e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.65e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+12 is 2.772425e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.462862 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0578e+01
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.8389
    reference variance = 0.347936
====================================================
  Execution time = 2.5331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4951e-01
  Total weights = 1.9644e+06
  Execution time = 3.5023e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436487293153
                                         uncertainty =       0.002783326665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436487293153
                                         uncertainty =       0.002783326665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467201220
  error estimate for blocks of size 2^( 2) =       0.000492628006
  error estimate for blocks of size 2^( 3) =       0.000516365567
  error estimate for blocks of size 2^( 4) =       0.000534186582
  error estimate for blocks of size 2^( 5) =       0.000544830678
  error estimate for blocks of size 2^( 6) =       0.000552743226
  error estimate for blocks of size 2^( 7) =       0.000557030417

      target function =      -0.745751548490
              le_mean =     -22.814592545057
             les_mean =     520.955139665671
             stat err =       0.000547197726
             autocorr =       1.371767882737
   target nu stat err =       0.000547197726
   target dn stat err =       0.003882468579
      target stat err =       0.003277147986
              std dev =       0.660722302112
             le_variance =       0.436553960508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436487293153
                                         uncertainty =       0.002783326665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436487293153
                                         uncertainty =       0.002783326665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467201220
  error estimate for blocks of size 2^( 2) =       0.000492628006
  error estimate for blocks of size 2^( 3) =       0.000516365567
  error estimate for blocks of size 2^( 4) =       0.000534186582
  error estimate for blocks of size 2^( 5) =       0.000544830678
  error estimate for blocks of size 2^( 6) =       0.000552743226
  error estimate for blocks of size 2^( 7) =       0.000557030417

      target function =      -0.745751548490
              le_mean =     -22.814592545057
             les_mean =     520.955139665671
             stat err =       0.000547197726
             autocorr =       1.371767882737
   target nu stat err =       0.000547197726
   target dn stat err =       0.003882468579
      target stat err =       0.003277147986
              std dev =       0.660722302112
             le_variance =       0.436553960508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436487293153
                                         uncertainty =       0.002783326665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436487293153
                                         uncertainty =       0.002783326665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467201220
  error estimate for blocks of size 2^( 2) =       0.000492628006
  error estimate for blocks of size 2^( 3) =       0.000516365567
  error estimate for blocks of size 2^( 4) =       0.000534186582
  error estimate for blocks of size 2^( 5) =       0.000544830678
  error estimate for blocks of size 2^( 6) =       0.000552743226
  error estimate for blocks of size 2^( 7) =       0.000557030417

      target function =      -0.745751548490
              le_mean =     -22.814592545057
             les_mean =     520.955139665671
             stat err =       0.000547197726
             autocorr =       1.371767882740
   target nu stat err =       0.000547197726
   target dn stat err =       0.003882468579
      target stat err =       0.003277147986
              std dev =       0.660722302112
             le_variance =       0.436553960508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436487293153
                                         uncertainty =       0.002783326665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436487293153
                                         uncertainty =       0.002783326665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467201220
  error estimate for blocks of size 2^( 2) =       0.000492628006
  error estimate for blocks of size 2^( 3) =       0.000516365567
  error estimate for blocks of size 2^( 4) =       0.000534186582
  error estimate for blocks of size 2^( 5) =       0.000544830678
  error estimate for blocks of size 2^( 6) =       0.000552743226
  error estimate for blocks of size 2^( 7) =       0.000557030417

      target function =      -0.745751548490
              le_mean =     -22.814592545057
             les_mean =     520.955139665671
             stat err =       0.000547197726
             autocorr =       1.371767882737
   target nu stat err =       0.000547197726
   target dn stat err =       0.003882468579
      target stat err =       0.003277147986
              std dev =       0.660722302112
             le_variance =       0.436553960508


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745751548490        initial  <--
     2.2737e+11     2.2737e+12             4.3741e-16        -0.745751548490
     9.0949e+11     9.0949e+12             1.1043e-16        -0.745751548490
     3.6380e+12     3.6380e+13             2.7724e-17        -0.745751548490

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8257
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3410e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.7899
    reference variance = 0.28083
====================================================
  Execution time = 2.5753e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4707e-01
  Total weights = 1.964257084e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4821e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432761484729
                                         uncertainty =       0.001857063038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432761484729
                                         uncertainty =       0.001857063038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465160822
  error estimate for blocks of size 2^( 2) =       0.000490969789
  error estimate for blocks of size 2^( 3) =       0.000515272472
  error estimate for blocks of size 2^( 4) =       0.000533621090
  error estimate for blocks of size 2^( 5) =       0.000544767049
  error estimate for blocks of size 2^( 6) =       0.000552090382
  error estimate for blocks of size 2^( 7) =       0.000553241443

      target function =      -0.747786760635
              le_mean =     -22.814591915573
             les_mean =     520.952669402260
             stat err =       0.000545929991
             autocorr =       1.377424007112
   target nu stat err =       0.000545929991
   target dn stat err =       0.003145720724
      target stat err =       0.002693043806
              std dev =       0.657836742705
             le_variance =       0.432749180053


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281459191557e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+12, overlap shift 2.2737e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747795455903       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747795455903       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747795455903       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747795455903       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747795455915       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747795481641       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747008256179       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745692694438       residual = 7.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742607177341       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743105281265       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748723214591       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748945564826       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746649554659       residual = 9.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747858897383       residual = 8.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744521540057       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746045641324       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747432259491       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746595340833       residual = 6.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748697341325       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744969225673       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748965907413       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748070263607       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750205112575       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.751796370497       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744526290835       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744945387003       residual = 7.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748114631438       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748924368561       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748762706395       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746943825934       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747238879202       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748087530506       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750472659546       residual = 8.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747059416174       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.754035364292       residual = 8.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746539937692       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748820503422       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.749607957620       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.745732604041       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748290407560       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.749902334522       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.749313309469       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748982849190       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748747020020       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.747688496097       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.749227128981       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747900919228       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.748386960212       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748032972431       residual = 9.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747416755263       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747746803081       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.748084688017       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.747662184992       residual = 1.52e-03           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.748079661288       residual = 2.40e-03           smallest_sin_value = 9.96e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+12 is 7.596133e-17

solving harmonic davidson linear method for identity shift 9.0949e+12, overlap shift 9.0949e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747795455903       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747795455903       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747795455903       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747795455903       residual = 9.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747795455886       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747795459642       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745586261320       residual = 4.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745311211975       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751624749245       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747552403462       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746675707458       residual = 3.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.714754853007       residual = 3.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.752183821820       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.754078789217       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.732436776671       residual = 2.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.738747253480       residual = 4.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.705834198292       residual = 2.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.768755540901       residual = 4.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746517176950       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745787287748       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.757417176922       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742704987262       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747368587435       residual = 5.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750258339191       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743038618176       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744810754897       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.755661417891       residual = 6.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.753577411719       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.758317881008       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741765224868       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746118722757       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749022637557       residual = 3.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746047446265       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745875784076       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745909168141       residual = 8.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748544340445       residual = 8.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.751246631239       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748552428064       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.759683484763       residual = 2.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.741881482754       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.749070658328       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.743492842754       residual = 4.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.750518650481       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747888132872       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748406844464       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750224022069       residual = 4.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.754266115379       residual = 5.21e-03           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.740408040081       residual = 4.61e-03           smallest_sin_value = 9.96e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+12 is 2.270431e-17

solving harmonic davidson linear method for identity shift 3.6380e+13, overlap shift 3.6380e+14 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747795455903       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747795455903       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747795455903       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747795455903       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747795455903       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747795455903       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747780342991       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749348053164       residual = 7.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.734265152849       residual = 3.68e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.833045015797       residual = 1.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.587066707924       residual = 3.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.863094783822       residual = 9.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.781648915214       residual = 1.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.734035492169       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.702125004848       residual = 3.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.757855038501       residual = 6.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.752789182968       residual = 3.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.720021810900       residual = 3.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.787397036563       residual = 1.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.787178603571       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.708234270323       residual = 2.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.766429283287       residual = 3.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.775625478507       residual = 1.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.695405448461       residual = 2.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.738160353877       residual = 3.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.779628464967       residual = 2.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.765515332212       residual = 3.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.732350139881       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.823487461264       residual = 6.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.764266818722       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.582910215483       residual = 6.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.815574796733       residual = 3.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.723855495319       residual = 4.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747291434085       residual = 5.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.769048649710       residual = 8.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.804459312665       residual = 4.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.774037963785       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.756091640004       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.776879726030       residual = 1.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.669416426158       residual = 9.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.770988285877       residual = 2.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.657009985177       residual = 8.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.653687538459       residual = 6.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.711278448534       residual = 2.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.753615948088       residual = 3.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.724533958824       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.773067557150       residual = 3.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.800297446496       residual = 2.50e-01           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.715728327170       residual = 5.77e-01           smallest_sin_value = 9.97e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.721535319466       residual = 5.20e-01           smallest_sin_value = 9.97e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.800909715504       residual = 1.95e-01           smallest_sin_value = 9.94e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+13 is 6.050170e-18

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.622092 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0399e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.748
    reference variance = 0.294511
====================================================
  Execution time = 2.7616e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4803e-01
  Total weights = 1.9642e+06
  Execution time = 3.4903e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436539473163
                                         uncertainty =       0.001899296838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436539473163
                                         uncertainty =       0.001899296838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467165745
  error estimate for blocks of size 2^( 2) =       0.000493069232
  error estimate for blocks of size 2^( 3) =       0.000516559830
  error estimate for blocks of size 2^( 4) =       0.000534383176
  error estimate for blocks of size 2^( 5) =       0.000546658743
  error estimate for blocks of size 2^( 6) =       0.000553063900
  error estimate for blocks of size 2^( 7) =       0.000557980377

      target function =      -0.746985016627
              le_mean =     -22.813713945828
             les_mean =     520.913572566278
             stat err =       0.000548021549
             autocorr =       1.376110442139
   target nu stat err =       0.000548021549
   target dn stat err =       0.002535706819
      target stat err =       0.002193739397
              std dev =       0.660672132451
             le_variance =       0.436487666597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436539473163
                                         uncertainty =       0.001899296838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436539473163
                                         uncertainty =       0.001899296838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467165745
  error estimate for blocks of size 2^( 2) =       0.000493069232
  error estimate for blocks of size 2^( 3) =       0.000516559830
  error estimate for blocks of size 2^( 4) =       0.000534383176
  error estimate for blocks of size 2^( 5) =       0.000546658743
  error estimate for blocks of size 2^( 6) =       0.000553063900
  error estimate for blocks of size 2^( 7) =       0.000557980377

      target function =      -0.746985016627
              le_mean =     -22.813713945828
             les_mean =     520.913572566278
             stat err =       0.000548021549
             autocorr =       1.376110442137
   target nu stat err =       0.000548021549
   target dn stat err =       0.002535706819
      target stat err =       0.002193739397
              std dev =       0.660672132451
             le_variance =       0.436487666597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436539473163
                                         uncertainty =       0.001899296838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436539473163
                                         uncertainty =       0.001899296838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467165745
  error estimate for blocks of size 2^( 2) =       0.000493069232
  error estimate for blocks of size 2^( 3) =       0.000516559830
  error estimate for blocks of size 2^( 4) =       0.000534383176
  error estimate for blocks of size 2^( 5) =       0.000546658743
  error estimate for blocks of size 2^( 6) =       0.000553063900
  error estimate for blocks of size 2^( 7) =       0.000557980377

      target function =      -0.746985016627
              le_mean =     -22.813713945828
             les_mean =     520.913572566278
             stat err =       0.000548021549
             autocorr =       1.376110442138
   target nu stat err =       0.000548021549
   target dn stat err =       0.002535706819
      target stat err =       0.002193739397
              std dev =       0.660672132451
             le_variance =       0.436487666597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436539473163
                                         uncertainty =       0.001899296838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436539473163
                                         uncertainty =       0.001899296838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467165745
  error estimate for blocks of size 2^( 2) =       0.000493069232
  error estimate for blocks of size 2^( 3) =       0.000516559830
  error estimate for blocks of size 2^( 4) =       0.000534383176
  error estimate for blocks of size 2^( 5) =       0.000546658743
  error estimate for blocks of size 2^( 6) =       0.000553063900
  error estimate for blocks of size 2^( 7) =       0.000557980377

      target function =      -0.746985016627
              le_mean =     -22.813713945828
             les_mean =     520.913572566278
             stat err =       0.000548021549
             autocorr =       1.376110442138
   target nu stat err =       0.000548021549
   target dn stat err =       0.002535706819
      target stat err =       0.002193739397
              std dev =       0.660672132451
             le_variance =       0.436487666597


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746985016627        initial
     2.2737e+12     2.2737e+13             7.5961e-17        -0.746985016627  <--
     9.0949e+12     9.0949e+13             2.2704e-17        -0.746985016627
     3.6380e+13     3.6380e+14             6.0502e-18        -0.746985016627

*****************************************************************************
Applying the update for shift_i =   2.2737e+12     and shift_s =   2.2737e+13
*****************************************************************************

  Execution time = 4.5093e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5498e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.7259
    reference variance = 0.411735
====================================================
  Execution time = 2.5766e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4897e-01
  Total weights = 1.964264284e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434212746810
                                         uncertainty =       0.001896771017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434212746810
                                         uncertainty =       0.001896771017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465943493
  error estimate for blocks of size 2^( 2) =       0.000491519777
  error estimate for blocks of size 2^( 3) =       0.000515727066
  error estimate for blocks of size 2^( 4) =       0.000533684153
  error estimate for blocks of size 2^( 5) =       0.000544544573
  error estimate for blocks of size 2^( 6) =       0.000548462817
  error estimate for blocks of size 2^( 7) =       0.000550720129

      target function =      -0.746188560029
              le_mean =     -22.814385229814
             les_mean =     520.945146597275
             stat err =       0.000544352918
             autocorr =       1.364880434292
   target nu stat err =       0.000544352918
   target dn stat err =       0.004581083249
      target stat err =       0.003850802949
              std dev =       0.658943607083
             le_variance =       0.434206677315


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281438522981e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+11, overlap shift 5.6843e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746207419733       residual = 7.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746207419733       residual = 5.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746207419733       residual = 9.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746207419733       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746186605899       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746185800475       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746112844139       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746028054375       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747422761169       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747370663914       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745575570620       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744497402367       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745372277773       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746727173289       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744667093998       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746670544616       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746630074154       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746750610930       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745905753685       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746306634804       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747284919859       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745259411205       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745124319923       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746568025423       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746545084367       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745143834305       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746692676590       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746656482063       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747165564666       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746757568653       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746433819282       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744495751077       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746321891719       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746519831100       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745419462167       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746124259106       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746493937898       residual = 7.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746662621857       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746215887613       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.745950276237       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.745579981272       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746551785074       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.745871228855       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.745960979165       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745513439348       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746152596138       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746395616245       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.745703660102       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746339862025       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746369621010       residual = 2.68e-05           smallest_sin_value = 9.97e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746433708461       residual = 5.39e-05           smallest_sin_value = 9.97e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.747135244190       residual = 9.99e-05           smallest_sin_value = 9.96e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.746915982156       residual = 6.00e-05           smallest_sin_value = 9.94e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+11 is 6.403994e-16

solving harmonic davidson linear method for identity shift 2.2737e+12, overlap shift 2.2737e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746207419733       residual = 7.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746207419733       residual = 5.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746207419733       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745816400066       residual = 6.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746278578026       residual = 5.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747069597527       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746461045052       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746285509049       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743311424835       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747211263607       residual = 6.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747429540812       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745742319734       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747767887353       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748180591195       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750201728392       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748027669418       residual = 6.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742498519043       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744500973148       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747038486259       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745952194712       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746234617435       residual = 7.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746290296344       residual = 8.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745859313594       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744201411167       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745076727553       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745303504242       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746399204477       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746355847975       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746441593690       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745863194692       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748187504575       residual = 8.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745137135257       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747195405449       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746213586983       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.744700254032       residual = 8.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747109873817       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.745442808097       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748050669100       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.744604439865       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746357674437       residual = 5.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746523545762       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746095117029       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746506593641       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.745563331968       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746878014814       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746624485764       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746628877774       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.745142692713       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746953405506       residual = 2.03e-03           smallest_sin_value = 9.98e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746062900042       residual = 5.38e-03           smallest_sin_value = 9.93e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746966350967       residual = 5.37e-03           smallest_sin_value = 9.93e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+12 is 1.684140e-16

solving harmonic davidson linear method for identity shift 9.0949e+12, overlap shift 9.0949e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746207419733       residual = 7.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746207419733       residual = 5.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746207419733       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746557515817       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751638787427       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747372784183       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743251259164       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743466991458       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742300650903       residual = 7.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.779486145995       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740804315590       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.783422776163       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750972586225       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.736124486570       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743982995205       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.715976847098       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740787036561       residual = 6.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.761616071269       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746927229087       residual = 8.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750865001648       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749651866719       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746202842244       residual = 6.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.758935260068       residual = 9.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745180811859       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749039464184       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.752258889383       residual = 7.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.733949364687       residual = 6.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740735278683       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.753336840631       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.736946663306       residual = 9.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.770537115613       residual = 2.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.753180697361       residual = 5.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.731462328526       residual = 5.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.757738433661       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.762785666533       residual = 8.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.745156516975       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742308496163       residual = 4.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.738046511772       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.752028719947       residual = 6.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743485298162       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.742809730670       residual = 3.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.756022907923       residual = 6.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.755340598200       residual = 4.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.744795437823       residual = 4.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.743363361124       residual = 3.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.739536560117       residual = 5.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.753685843024       residual = 4.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746038331906       residual = 3.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.730450901944       residual = 4.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.740119304789       residual = 3.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747189404409       residual = 4.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.751817297697       residual = 6.24e-02           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.749258445758       residual = 5.51e-02           smallest_sin_value = 9.98e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.754794976556       residual = 2.08e-02           smallest_sin_value = 9.93e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+12 is 3.798819e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.790870 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0477e+01
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.7919
    reference variance = 0.33791
====================================================
  Execution time = 2.5297e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4965e-01
  Total weights = 1.9642e+06
  Execution time = 3.5142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435438412664
                                         uncertainty =       0.002097556367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435438412664
                                         uncertainty =       0.002097556367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466622636
  error estimate for blocks of size 2^( 2) =       0.000491923698
  error estimate for blocks of size 2^( 3) =       0.000516468979
  error estimate for blocks of size 2^( 4) =       0.000535026391
  error estimate for blocks of size 2^( 5) =       0.000545652169
  error estimate for blocks of size 2^( 6) =       0.000551811626
  error estimate for blocks of size 2^( 7) =       0.000553381685

      target function =      -0.745640339004
              le_mean =     -22.814806540285
             les_mean =     520.965042471552
             stat err =       0.000546467968
             autocorr =       1.371506325790
   target nu stat err =       0.000546467968
   target dn stat err =       0.003346520251
      target stat err =       0.002841452029
              std dev =       0.659904060371
             le_variance =       0.435473368894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435438412664
                                         uncertainty =       0.002097556367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435438412664
                                         uncertainty =       0.002097556367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466622636
  error estimate for blocks of size 2^( 2) =       0.000491923698
  error estimate for blocks of size 2^( 3) =       0.000516468979
  error estimate for blocks of size 2^( 4) =       0.000535026391
  error estimate for blocks of size 2^( 5) =       0.000545652169
  error estimate for blocks of size 2^( 6) =       0.000551811626
  error estimate for blocks of size 2^( 7) =       0.000553381685

      target function =      -0.745640339004
              le_mean =     -22.814806540285
             les_mean =     520.965042471552
             stat err =       0.000546467968
             autocorr =       1.371506325791
   target nu stat err =       0.000546467968
   target dn stat err =       0.003346520251
      target stat err =       0.002841452029
              std dev =       0.659904060371
             le_variance =       0.435473368894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435438412664
                                         uncertainty =       0.002097556367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435438412664
                                         uncertainty =       0.002097556367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466622636
  error estimate for blocks of size 2^( 2) =       0.000491923698
  error estimate for blocks of size 2^( 3) =       0.000516468979
  error estimate for blocks of size 2^( 4) =       0.000535026391
  error estimate for blocks of size 2^( 5) =       0.000545652169
  error estimate for blocks of size 2^( 6) =       0.000551811626
  error estimate for blocks of size 2^( 7) =       0.000553381685

      target function =      -0.745640339004
              le_mean =     -22.814806540285
             les_mean =     520.965042471552
             stat err =       0.000546467968
             autocorr =       1.371506325798
   target nu stat err =       0.000546467968
   target dn stat err =       0.003346520251
      target stat err =       0.002841452029
              std dev =       0.659904060371
             le_variance =       0.435473368894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435438412664
                                         uncertainty =       0.002097556367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435438412664
                                         uncertainty =       0.002097556367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466622636
  error estimate for blocks of size 2^( 2) =       0.000491923698
  error estimate for blocks of size 2^( 3) =       0.000516468979
  error estimate for blocks of size 2^( 4) =       0.000535026391
  error estimate for blocks of size 2^( 5) =       0.000545652169
  error estimate for blocks of size 2^( 6) =       0.000551811626
  error estimate for blocks of size 2^( 7) =       0.000553381685

      target function =      -0.745640339004
              le_mean =     -22.814806540285
             les_mean =     520.965042471552
             stat err =       0.000546467968
             autocorr =       1.371506325791
   target nu stat err =       0.000546467968
   target dn stat err =       0.003346520251
      target stat err =       0.002841452029
              std dev =       0.659904060371
             le_variance =       0.435473368894


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745640339004        initial
     5.6843e+11     5.6843e+12             6.4040e-16        -0.745640339004  <--
     2.2737e+12     2.2737e+13             1.6841e-16        -0.745640339004
     9.0949e+12     9.0949e+13             3.7988e-17        -0.745640339004

*****************************************************************************
Applying the update for shift_i =   5.6843e+11     and shift_s =   5.6843e+12
*****************************************************************************

  Execution time = 4.2878e+01
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3361e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.7919
    reference variance = 0.26956
====================================================
  Execution time = 2.5878e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5354e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4396e-01
  Total weights = 1.964431148e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432932537911
                                         uncertainty =       0.001577601572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432932537911
                                         uncertainty =       0.001577601572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465278845
  error estimate for blocks of size 2^( 2) =       0.000490661597
  error estimate for blocks of size 2^( 3) =       0.000514905198
  error estimate for blocks of size 2^( 4) =       0.000533489634
  error estimate for blocks of size 2^( 5) =       0.000545720874
  error estimate for blocks of size 2^( 6) =       0.000551405535
  error estimate for blocks of size 2^( 7) =       0.000554705730

      target function =      -0.750392410583
              le_mean =     -22.814676456159
             les_mean =     520.953419244714
             stat err =       0.000546330443
             autocorr =       1.378745759583
   target nu stat err =       0.000546330443
   target dn stat err =       0.002252458986
      target stat err =       0.001988109196
              std dev =       0.658003652776
             le_variance =       0.432968807067


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281467645616e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+11, overlap shift 1.4211e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750396698064       residual = 8.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750396698064       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750396698064       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750396698064       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750370827240       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750396698141       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750512708783       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750396698064       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750571310580       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750467193277       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750560051386       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750693762402       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750409052865       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750172872867       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750575293566       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750379213974       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750401000574       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750312648324       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750407120530       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750471805651       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750383085817       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750294405769       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750335332028       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749999439136       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750723115736       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750307485783       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750711411246       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750334674969       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750509743136       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750395841284       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750530153865       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750242244613       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750620270795       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750346820008       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750375075738       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.750289360395       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750350527160       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.750404065879       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.750403605601       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750360037057       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.750437276093       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.750197529909       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.750406727599       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.750414839570       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.750446950362       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750395443335       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.750407524016       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.750434909210       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750335662397       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.750490605247       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.750424589197       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.750341994037       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.750352594165       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.750351516355       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.750456577626       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.750405044489       residual = 6.50e-06           smallest_sin_value = 9.99e-01
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.750443856866       residual = 1.39e-06           smallest_sin_value = 9.98e-01
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.750372616775       residual = 1.82e-06           smallest_sin_value = 9.92e-01
davidson iteration   58 stopping due to small subspace S singular value of 9.49e-01
davidson solver did not converge after         58 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+11 is 1.177595e-15

solving harmonic davidson linear method for identity shift 5.6843e+11, overlap shift 5.6843e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750396698064       residual = 8.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750396698064       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750396698064       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750396698064       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750396698064       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750644154871       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750380429775       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749733424230       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751077101454       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750292578192       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750919517413       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750178613337       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750236934811       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750779164817       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749331845339       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749021473464       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749994722520       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750104408957       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749740067902       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750223894575       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750935901437       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749357095585       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750081043741       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.751194981421       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750349597144       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.752087729989       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749664792693       residual = 7.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.751172912624       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750643606712       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750669565328       residual = 9.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750717214901       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750149690426       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750471443925       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.749846295922       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750761279647       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.750527966289       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750387625137       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.750823064272       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.751038162725       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.751700654190       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.749329755241       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.749719817274       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.750297104509       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.750232658947       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.751461524985       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750213129460       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.749845364821       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.749886405067       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750231146718       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.749495621827       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.750209358440       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.749669229084       residual = 5.72e-05           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.750786632012       residual = 3.07e-04           smallest_sin_value = 9.98e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.749889617570       residual = 7.88e-05           smallest_sin_value = 9.93e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.69e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+11 is 2.843684e-16

solving harmonic davidson linear method for identity shift 2.2737e+12, overlap shift 2.2737e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750396698064       residual = 8.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750396698064       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750396698064       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750393877825       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750396698035       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750381455355       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750450785660       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747896085184       residual = 8.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751675939240       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748727104899       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750523564933       residual = 9.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748976185261       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.753407230372       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750409423187       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748761621167       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748951470019       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.751185464481       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751340551991       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.752713901990       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748323171179       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.751571170946       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749145912114       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747948904154       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.755672303721       residual = 4.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.754954822795       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.754177358849       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748014379541       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.752930120321       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750955461688       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748508521418       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750345579700       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748398800944       residual = 9.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.749590564001       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747856988202       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.751924336372       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.753471457270       residual = 7.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.749882946418       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.749099854125       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.750106374264       residual = 3.01e-03           smallest_sin_value = 9.99e-01
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.753077235200       residual = 8.11e-04           smallest_sin_value = 9.99e-01
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.749660681848       residual = 4.75e-04           smallest_sin_value = 9.99e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.749261731043       residual = 1.91e-03           smallest_sin_value = 9.98e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.750041055782       residual = 1.72e-03           smallest_sin_value = 9.95e-01
davidson iteration   43 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         43 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+12 is 6.220762e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.957997 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0593e+01
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.8889
    reference variance = 0.355448
====================================================
  Execution time = 2.7549e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4366e-01
  Total weights = 1.9641e+06
  Execution time = 3.4881e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432235411575
                                         uncertainty =       0.001946457013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432235411575
                                         uncertainty =       0.001946457013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464892105
  error estimate for blocks of size 2^( 2) =       0.000490120042
  error estimate for blocks of size 2^( 3) =       0.000514392072
  error estimate for blocks of size 2^( 4) =       0.000531255267
  error estimate for blocks of size 2^( 5) =       0.000540954053
  error estimate for blocks of size 2^( 6) =       0.000546161392
  error estimate for blocks of size 2^( 7) =       0.000550569407

      target function =      -0.750646046433
              le_mean =     -22.815425396895
             les_mean =     520.987296064406
             stat err =       0.000542235030
             autocorr =       1.360413082573
   target nu stat err =       0.000542235030
   target dn stat err =       0.002537597432
      target stat err =       0.002219866215
              std dev =       0.657456719770
             le_variance =       0.432249338371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432235411575
                                         uncertainty =       0.001946457013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432235411575
                                         uncertainty =       0.001946457013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464892105
  error estimate for blocks of size 2^( 2) =       0.000490120042
  error estimate for blocks of size 2^( 3) =       0.000514392072
  error estimate for blocks of size 2^( 4) =       0.000531255267
  error estimate for blocks of size 2^( 5) =       0.000540954053
  error estimate for blocks of size 2^( 6) =       0.000546161392
  error estimate for blocks of size 2^( 7) =       0.000550569407

      target function =      -0.750646046433
              le_mean =     -22.815425396895
             les_mean =     520.987296064406
             stat err =       0.000542235030
             autocorr =       1.360413082580
   target nu stat err =       0.000542235030
   target dn stat err =       0.002537597432
      target stat err =       0.002219866215
              std dev =       0.657456719770
             le_variance =       0.432249338371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432235411575
                                         uncertainty =       0.001946457013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432235411575
                                         uncertainty =       0.001946457013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464892105
  error estimate for blocks of size 2^( 2) =       0.000490120042
  error estimate for blocks of size 2^( 3) =       0.000514392072
  error estimate for blocks of size 2^( 4) =       0.000531255267
  error estimate for blocks of size 2^( 5) =       0.000540954053
  error estimate for blocks of size 2^( 6) =       0.000546161392
  error estimate for blocks of size 2^( 7) =       0.000550569407

      target function =      -0.750646046433
              le_mean =     -22.815425396895
             les_mean =     520.987296064406
             stat err =       0.000542235030
             autocorr =       1.360413082575
   target nu stat err =       0.000542235030
   target dn stat err =       0.002537597432
      target stat err =       0.002219866215
              std dev =       0.657456719771
             le_variance =       0.432249338371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432235411575
                                         uncertainty =       0.001946457013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432235411575
                                         uncertainty =       0.001946457013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464892105
  error estimate for blocks of size 2^( 2) =       0.000490120042
  error estimate for blocks of size 2^( 3) =       0.000514392072
  error estimate for blocks of size 2^( 4) =       0.000531255267
  error estimate for blocks of size 2^( 5) =       0.000540954053
  error estimate for blocks of size 2^( 6) =       0.000546161392
  error estimate for blocks of size 2^( 7) =       0.000550569407

      target function =      -0.750646046433
              le_mean =     -22.815425396895
             les_mean =     520.987296064406
             stat err =       0.000542235030
             autocorr =       1.360413082573
   target nu stat err =       0.000542235030
   target dn stat err =       0.002537597432
      target stat err =       0.002219866215
              std dev =       0.657456719770
             le_variance =       0.432249338371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750646046433        initial
     1.4211e+11     1.4211e+12             1.1776e-15        -0.750646046433  <--
     5.6843e+11     5.6843e+12             2.8437e-16        -0.750646046433
     2.2737e+12     2.2737e+13             6.2208e-17        -0.750646046433

*****************************************************************************
Applying the update for shift_i =   1.4211e+11     and shift_s =   1.4211e+12
*****************************************************************************

  Execution time = 4.5028e+01
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5639e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.7981
    reference variance = 0.340916
====================================================
  Execution time = 2.5869e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4778e-01
  Total weights = 1.964263645e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435057641471
                                         uncertainty =       0.001919610755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435057641471
                                         uncertainty =       0.001919610755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466467142
  error estimate for blocks of size 2^( 2) =       0.000492203311
  error estimate for blocks of size 2^( 3) =       0.000516353779
  error estimate for blocks of size 2^( 4) =       0.000533990874
  error estimate for blocks of size 2^( 5) =       0.000544466609
  error estimate for blocks of size 2^( 6) =       0.000552291625
  error estimate for blocks of size 2^( 7) =       0.000553231537

      target function =      -0.747198427240
              le_mean =     -22.815151610969
             les_mean =     520.978918831152
             stat err =       0.000545995161
             autocorr =       1.370047021563
   target nu stat err =       0.000545995161
   target dn stat err =       0.002613415858
      target stat err =       0.002261323913
              std dev =       0.659684158579
             le_variance =       0.435183189080


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281515161097e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+10, overlap shift 3.5527e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747204296231       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747204296231       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747204296231       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747204296231       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747187447033       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747201872605       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747181446275       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747223388149       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747171903990       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747156987725       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747233297541       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747194324590       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747259632418       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747217952369       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747173392751       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747192347310       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747190872198       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747181717337       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747176500599       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747216308815       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747165129697       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747185742920       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747174140084       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747254573217       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747176710429       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747209063836       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747165062525       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747244838601       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747158455001       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747180645029       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747184375426       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747199316037       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747175478016       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747191066336       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747120410886       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747178019666       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747173054533       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.747190647503       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.747264524734       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747189722343       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.747248464615       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747189171392       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.747110474083       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747255779740       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.747072533138       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747157955103       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747138561263       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747279833891       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.747287706757       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747234255454       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747233324129       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.747228050120       residual = 3.63e-07           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.747174652295       residual = 4.90e-07           smallest_sin_value = 9.96e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.747199002413       residual = 2.46e-07           smallest_sin_value = 9.93e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+10 is 3.546606e-15

solving harmonic davidson linear method for identity shift 1.4211e+11, overlap shift 1.4211e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747204296231       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747204296231       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747204296231       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747204296231       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747204296231       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747354424092       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747387693635       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747116582286       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747106591622       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747397491213       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747306185391       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746915584640       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747374505772       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747009077711       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747367912797       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747223103213       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747289385215       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747122437208       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747201197706       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747178434798       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747231813519       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747465874787       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747536818909       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747539269094       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747036195899       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747021680315       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747168684293       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747256641818       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747216242223       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747286609663       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747086120363       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747133663736       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747769798745       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747091231505       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747078966452       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747019600274       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747367565875       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.747110367460       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.747244173876       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747593582414       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.747271459570       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747246214985       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.747255717556       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747084969633       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.747651291071       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747008199912       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747230015856       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747234637164       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.747219427376       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747208852956       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747109384044       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.747302079013       residual = 1.71e-06           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.747078847283       residual = 3.95e-06           smallest_sin_value = 9.95e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+11 is 8.758919e-16

solving harmonic davidson linear method for identity shift 5.6843e+11, overlap shift 5.6843e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747204296231       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747204296231       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747204296231       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747186511992       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747444743559       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747073726305       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747343460871       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747586476438       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747221665922       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746979961540       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747268364397       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745915988649       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748264309663       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746919938526       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745428118780       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746267156817       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746998792708       residual = 9.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746754728709       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746691649517       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746576987404       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746724702834       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747458675948       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747628272226       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748254154711       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748336642381       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747576544005       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746444461412       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746333883596       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747399612278       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746170759756       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746377133735       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747383740507       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746610304469       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746925503624       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747649636689       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747356610583       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746572717841       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746971248567       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746796840676       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746848956010       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746804381246       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747569645153       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.747571108068       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746511523526       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746711230791       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747746126809       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747017087683       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747965384414       residual = 3.05e-05           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.747112920678       residual = 7.86e-05           smallest_sin_value = 9.95e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746428330986       residual = 5.43e-05           smallest_sin_value = 9.94e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.68e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+11 is 2.237323e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.124727 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0516e+01
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.8507
    reference variance = 0.334615
====================================================
  Execution time = 2.5502e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6105e-01
  Total weights = 1.9645e+06
  Execution time = 3.4926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443946456074
                                         uncertainty =       0.008399194639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443946456074
                                         uncertainty =       0.008399194639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471145732
  error estimate for blocks of size 2^( 2) =       0.000496643806
  error estimate for blocks of size 2^( 3) =       0.000520426531
  error estimate for blocks of size 2^( 4) =       0.000538967473
  error estimate for blocks of size 2^( 5) =       0.000550893657
  error estimate for blocks of size 2^( 6) =       0.000557299075
  error estimate for blocks of size 2^( 7) =       0.000560564964

      target function =      -0.736200618164
              le_mean =     -22.814536885182
             les_mean =     520.964138727906
             stat err =       0.000551931292
             autocorr =       1.372333016726
   target nu stat err =       0.000551931292
   target dn stat err =       0.011404289386
      target stat err =       0.009238479460
              std dev =       0.666300684284
             le_variance =       0.443956601877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443946456074
                                         uncertainty =       0.008399194639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443946456074
                                         uncertainty =       0.008399194639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471145732
  error estimate for blocks of size 2^( 2) =       0.000496643806
  error estimate for blocks of size 2^( 3) =       0.000520426531
  error estimate for blocks of size 2^( 4) =       0.000538967473
  error estimate for blocks of size 2^( 5) =       0.000550893657
  error estimate for blocks of size 2^( 6) =       0.000557299075
  error estimate for blocks of size 2^( 7) =       0.000560564964

      target function =      -0.736200618164
              le_mean =     -22.814536885182
             les_mean =     520.964138727906
             stat err =       0.000551931292
             autocorr =       1.372333016726
   target nu stat err =       0.000551931292
   target dn stat err =       0.011404289386
      target stat err =       0.009238479460
              std dev =       0.666300684284
             le_variance =       0.443956601877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443946456074
                                         uncertainty =       0.008399194639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443946456074
                                         uncertainty =       0.008399194639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471145732
  error estimate for blocks of size 2^( 2) =       0.000496643806
  error estimate for blocks of size 2^( 3) =       0.000520426531
  error estimate for blocks of size 2^( 4) =       0.000538967473
  error estimate for blocks of size 2^( 5) =       0.000550893657
  error estimate for blocks of size 2^( 6) =       0.000557299075
  error estimate for blocks of size 2^( 7) =       0.000560564964

      target function =      -0.736200618164
              le_mean =     -22.814536885182
             les_mean =     520.964138727906
             stat err =       0.000551931292
             autocorr =       1.372333016724
   target nu stat err =       0.000551931292
   target dn stat err =       0.011404289386
      target stat err =       0.009238479460
              std dev =       0.666300684284
             le_variance =       0.443956601877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443946456074
                                         uncertainty =       0.008399194639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443946456074
                                         uncertainty =       0.008399194639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471145732
  error estimate for blocks of size 2^( 2) =       0.000496643806
  error estimate for blocks of size 2^( 3) =       0.000520426531
  error estimate for blocks of size 2^( 4) =       0.000538967473
  error estimate for blocks of size 2^( 5) =       0.000550893657
  error estimate for blocks of size 2^( 6) =       0.000557299075
  error estimate for blocks of size 2^( 7) =       0.000560564964

      target function =      -0.736200618164
              le_mean =     -22.814536885182
             les_mean =     520.964138727906
             stat err =       0.000551931292
             autocorr =       1.372333016726
   target nu stat err =       0.000551931292
   target dn stat err =       0.011404289386
      target stat err =       0.009238479460
              std dev =       0.666300684284
             le_variance =       0.443956601877


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.736200618164        initial  <--
     3.5527e+10     3.5527e+11             3.5466e-15        -0.736200618164
     1.4211e+11     1.4211e+12             8.7589e-16        -0.736200618164
     5.6843e+11     5.6843e+12             2.2373e-16        -0.736200618164

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0189
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3540e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.8179
    reference variance = 0.423883
====================================================
  Execution time = 2.5772e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4618e-01
  Total weights = 1.964375333e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434074956415
                                         uncertainty =       0.001770622189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434074956415
                                         uncertainty =       0.001770622189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465874945
  error estimate for blocks of size 2^( 2) =       0.000490898682
  error estimate for blocks of size 2^( 3) =       0.000514909887
  error estimate for blocks of size 2^( 4) =       0.000533510486
  error estimate for blocks of size 2^( 5) =       0.000545104174
  error estimate for blocks of size 2^( 6) =       0.000552286754
  error estimate for blocks of size 2^( 7) =       0.000557491267

      target function =      -0.748530191823
              le_mean =     -22.814707424831
             les_mean =     520.957054620510
             stat err =       0.000547098170
             autocorr =       1.379087476841
   target nu stat err =       0.000547098170
   target dn stat err =       0.002385552885
      target stat err =       0.002085160050
              std dev =       0.658846666291
             le_variance =       0.434078929682


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281470742483e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+11, overlap shift 3.5527e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748535036622       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748535036622       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748535036622       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748566730007       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748535036718       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748722711914       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748530496472       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748575480245       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749171696343       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748064583170       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748070010106       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749960685414       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749186597253       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748288497072       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749312556455       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748604936043       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748768519531       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748295353918       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748891461767       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748659058164       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749411299507       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749006580253       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748476959157       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748584536123       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748534031961       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748498996214       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748387019993       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749039841289       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748996578009       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748218886017       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748484555921       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747887197024       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748134269454       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748692087305       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748876539964       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748569473716       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748575853486       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748698013243       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748244321449       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748289730462       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748546488029       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748774553538       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748286496624       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748910285469       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748522159176       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.748288237460       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748734516975       residual = 6.15e-06           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.748339570767       residual = 2.61e-05           smallest_sin_value = 9.98e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748634925651       residual = 1.46e-05           smallest_sin_value = 9.93e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.58e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+11 is 2.936173e-16

solving harmonic davidson linear method for identity shift 1.4211e+12, overlap shift 1.4211e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748535036622       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748535036622       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748535036622       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747491464423       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748535036675       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748535027858       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748695072566       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748430741853       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747612594945       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749088280168       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749660739096       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749198521879       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747955770068       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749629703673       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749713077344       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748898639001       residual = 6.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746748825922       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746462049095       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748243746401       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747798750751       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746591359812       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750172016798       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.752555269012       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750182336253       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748383773868       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749528022604       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747957600710       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750167846713       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.749308230658       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745415125129       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745052693132       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750588786720       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744271067405       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750060146879       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745306010752       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.749485460034       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.749103933114       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748945853347       residual = 6.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.749140575389       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748716824166       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.747913480884       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.749711307175       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.749916844963       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.749570788362       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746977353825       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.749377620700       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748085575347       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747769387500       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748474093606       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.749241506757       residual = 1.29e-04           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.749686102554       residual = 7.73e-05           smallest_sin_value = 9.95e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+12 is 6.978968e-17

solving harmonic davidson linear method for identity shift 5.6843e+12, overlap shift 5.6843e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748535036622       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748535036622       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748535036622       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748535036622       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.754443891002       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750557510604       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746861360715       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748393851441       residual = 8.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747429774857       residual = 9.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.757100970807       residual = 7.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.758309176572       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.751359833206       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.757335680859       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741172916541       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.735407981901       residual = 6.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.756610859561       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744450409314       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747579096752       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.759068647091       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.754950428959       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742242612722       residual = 6.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.766981865485       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750492373264       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748789520955       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748104323370       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740964582643       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744089262589       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746647517439       residual = 4.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.752351801723       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.757980841756       residual = 7.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741149662622       residual = 4.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.753679584989       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.749078827173       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746166215845       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750016353955       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.736255889411       residual = 5.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748448626017       residual = 4.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.753942343646       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.744715953943       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.754247731640       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.745254140270       residual = 8.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747951206311       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.745921974831       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.750233567222       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.749714659166       residual = 8.00e-03           smallest_sin_value = 9.99e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.749262845086       residual = 1.51e-02           smallest_sin_value = 9.98e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.750246586380       residual = 1.10e-02           smallest_sin_value = 9.97e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.744817089926       residual = 2.73e-02           smallest_sin_value = 9.96e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.740954004430       residual = 1.29e-02           smallest_sin_value = 9.96e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+12 is 1.984473e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.267777 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0432e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.8825
    reference variance = 0.390213
====================================================
  Execution time = 2.7147e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4121e-01
  Total weights = 1.9644e+06
  Execution time = 3.4799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428878281662
                                         uncertainty =       0.001564609589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428878281662
                                         uncertainty =       0.001564609589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463070241
  error estimate for blocks of size 2^( 2) =       0.000488620124
  error estimate for blocks of size 2^( 3) =       0.000512359829
  error estimate for blocks of size 2^( 4) =       0.000530363643
  error estimate for blocks of size 2^( 5) =       0.000541024362
  error estimate for blocks of size 2^( 6) =       0.000547438144
  error estimate for blocks of size 2^( 7) =       0.000549657178

      target function =      -0.752707512169
              le_mean =     -22.814901373708
             les_mean =     520.960937245127
             stat err =       0.000542120832
             autocorr =       1.370561246456
   target nu stat err =       0.000542120832
   target dn stat err =       0.002166780336
      target stat err =       0.001930179680
              std dev =       0.654880215012
             le_variance =       0.428868096015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428878281662
                                         uncertainty =       0.001564609589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428878281662
                                         uncertainty =       0.001564609589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463070241
  error estimate for blocks of size 2^( 2) =       0.000488620124
  error estimate for blocks of size 2^( 3) =       0.000512359829
  error estimate for blocks of size 2^( 4) =       0.000530363643
  error estimate for blocks of size 2^( 5) =       0.000541024362
  error estimate for blocks of size 2^( 6) =       0.000547438144
  error estimate for blocks of size 2^( 7) =       0.000549657178

      target function =      -0.752707512170
              le_mean =     -22.814901373708
             les_mean =     520.960937245127
             stat err =       0.000542120832
             autocorr =       1.370561246454
   target nu stat err =       0.000542120832
   target dn stat err =       0.002166780336
      target stat err =       0.001930179680
              std dev =       0.654880215012
             le_variance =       0.428868096015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428878281662
                                         uncertainty =       0.001564609589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428878281662
                                         uncertainty =       0.001564609589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463070241
  error estimate for blocks of size 2^( 2) =       0.000488620124
  error estimate for blocks of size 2^( 3) =       0.000512359829
  error estimate for blocks of size 2^( 4) =       0.000530363643
  error estimate for blocks of size 2^( 5) =       0.000541024362
  error estimate for blocks of size 2^( 6) =       0.000547438144
  error estimate for blocks of size 2^( 7) =       0.000549657178

      target function =      -0.752707512169
              le_mean =     -22.814901373708
             les_mean =     520.960937245127
             stat err =       0.000542120832
             autocorr =       1.370561246452
   target nu stat err =       0.000542120832
   target dn stat err =       0.002166780336
      target stat err =       0.001930179680
              std dev =       0.654880215012
             le_variance =       0.428868096015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428878281662
                                         uncertainty =       0.001564609589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428878281662
                                         uncertainty =       0.001564609589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463070241
  error estimate for blocks of size 2^( 2) =       0.000488620124
  error estimate for blocks of size 2^( 3) =       0.000512359829
  error estimate for blocks of size 2^( 4) =       0.000530363643
  error estimate for blocks of size 2^( 5) =       0.000541024362
  error estimate for blocks of size 2^( 6) =       0.000547438144
  error estimate for blocks of size 2^( 7) =       0.000549657178

      target function =      -0.752707512169
              le_mean =     -22.814901373708
             les_mean =     520.960937245127
             stat err =       0.000542120832
             autocorr =       1.370561246454
   target nu stat err =       0.000542120832
   target dn stat err =       0.002166780336
      target stat err =       0.001930179680
              std dev =       0.654880215012
             le_variance =       0.428868096014


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.752707512169        initial
     3.5527e+11     3.5527e+12             2.9362e-16        -0.752707512170  <--
     1.4211e+12     1.4211e+13             6.9790e-17        -0.752707512169
     5.6843e+12     5.6843e+13             1.9845e-17        -0.752707512169

*****************************************************************************
Applying the update for shift_i =   3.5527e+11     and shift_s =   3.5527e+12
*****************************************************************************

  Execution time = 4.4742e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5180e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.7911
    reference variance = 0.415212
====================================================
  Execution time = 2.5908e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5363e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4765e-01
  Total weights = 1.964178873e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434748184187
                                         uncertainty =       0.002363504355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434748184187
                                         uncertainty =       0.002363504355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466255242
  error estimate for blocks of size 2^( 2) =       0.000491746675
  error estimate for blocks of size 2^( 3) =       0.000514928082
  error estimate for blocks of size 2^( 4) =       0.000533303714
  error estimate for blocks of size 2^( 5) =       0.000542380425
  error estimate for blocks of size 2^( 6) =       0.000548897156
  error estimate for blocks of size 2^( 7) =       0.000552113204

      target function =      -0.747302417367
              le_mean =     -22.814882275037
             les_mean =     520.966501952698
             stat err =       0.000544173625
             autocorr =       1.362158114380
   target nu stat err =       0.000544173625
   target dn stat err =       0.002887380809
      target stat err =       0.002481131394
              std dev =       0.659384486607
             le_variance =       0.434787901178


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281488227504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+10, overlap shift 8.8818e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747309728278       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747309728278       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747309728278       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747309728278       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747309728278       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747304662144       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747310788895       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747349150551       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747289073999       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747203855219       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747379965288       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747259260326       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747054636284       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747340533322       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747300719313       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747347129887       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747322688499       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747403442600       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747243730289       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747271522346       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747292384285       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747348923167       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747385089626       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747337666849       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747254715992       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747265592194       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747281092415       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747282128361       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747305803519       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747381070370       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747233511338       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747192458844       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747258841497       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747290986978       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747351215969       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747373022934       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747423511772       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.747372172163       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.747208547861       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747224689824       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.747336128804       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747129020061       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.747328493198       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747209953351       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.747348165523       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747299246900       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747246791208       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747244733846       residual = 3.24e-06           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.747192079506       residual = 2.57e-06           smallest_sin_value = 9.98e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747387851503       residual = 3.95e-06           smallest_sin_value = 9.91e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.43e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+10 is 1.455696e-15

solving harmonic davidson linear method for identity shift 3.5527e+11, overlap shift 3.5527e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747309728278       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747309728278       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747309728278       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747309728278       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747309728278       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747309579457       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747309728278       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747091447560       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746633098049       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747665647104       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748913611292       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747771125219       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747320420290       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745943883685       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748953690495       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747019308756       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746725348549       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746839369759       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747524727667       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747521279748       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747795678878       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747440969472       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747388467317       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747443827577       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747501281052       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747462243080       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747066980129       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747359051634       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747329070873       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747118939086       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747388045470       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747233041238       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747425346984       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747111131462       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747688636980       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747360219327       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747065489756       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.747307942218       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.747204390029       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747481456733       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746999610019       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747062613590       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.747244844268       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747195805492       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.747361673492       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747277744357       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747380866431       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747298315242       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.747145857667       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747302845253       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747128514144       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.747305178466       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.747285778814       residual = 5.99e-05           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.747385485737       residual = 1.67e-05           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.747356151583       residual = 2.03e-05           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.747366187346       residual = 1.39e-05           smallest_sin_value = 9.96e-01
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.747287711254       residual = 1.75e-05           smallest_sin_value = 9.95e-01
davidson iteration   57 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         57 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+11 is 3.584365e-16

solving harmonic davidson linear method for identity shift 1.4211e+12, overlap shift 1.4211e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747309728278       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747309728278       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747309728278       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747309728278       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747309728278       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747309361944       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747309721363       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747266873990       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745294887429       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750362643490       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748505610434       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744134714782       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748058774333       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748377719214       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746186587507       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745379871419       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744535032627       residual = 6.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751941597294       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747425645805       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747228909893       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745894846810       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745460978151       residual = 5.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745814691001       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746825792311       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748040190346       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749124659996       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746669734748       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747894437810       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745025063797       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746442952173       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747950612884       residual = 7.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750553536790       residual = 6.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745976893489       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748373010901       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748839608791       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748701676299       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746928673348       residual = 7.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746751159106       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.747500556130       residual = 9.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.749395910577       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748644235975       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.749117771951       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.749525412189       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747546551302       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745777897253       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750546039179       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746809645878       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746571837739       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748526995769       residual = 8.50e-05           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746851440543       residual = 1.46e-04           smallest_sin_value = 9.97e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747626426663       residual = 5.53e-04           smallest_sin_value = 9.93e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.65e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+12 is 8.962576e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.439878 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0650e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.8314
    reference variance = 0.385329
====================================================
  Execution time = 2.5274e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4915e-01
  Total weights = 1.9643e+06
  Execution time = 3.4931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435294406038
                                         uncertainty =       0.002302256340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435294406038
                                         uncertainty =       0.002302256340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466515619
  error estimate for blocks of size 2^( 2) =       0.000491950937
  error estimate for blocks of size 2^( 3) =       0.000516058349
  error estimate for blocks of size 2^( 4) =       0.000533321656
  error estimate for blocks of size 2^( 5) =       0.000543552153
  error estimate for blocks of size 2^( 6) =       0.000550428694
  error estimate for blocks of size 2^( 7) =       0.000554916482

      target function =      -0.746046841218
              le_mean =     -22.814591412851
             les_mean =     520.954736224272
             stat err =       0.000545554746
             autocorr =       1.367553416931
   target nu stat err =       0.000545554746
   target dn stat err =       0.003345686922
      target stat err =       0.002842675214
              std dev =       0.659752715728
             le_variance =       0.435273645910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435294406038
                                         uncertainty =       0.002302256340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435294406038
                                         uncertainty =       0.002302256340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466515619
  error estimate for blocks of size 2^( 2) =       0.000491950937
  error estimate for blocks of size 2^( 3) =       0.000516058349
  error estimate for blocks of size 2^( 4) =       0.000533321656
  error estimate for blocks of size 2^( 5) =       0.000543552153
  error estimate for blocks of size 2^( 6) =       0.000550428694
  error estimate for blocks of size 2^( 7) =       0.000554916482

      target function =      -0.746046841218
              le_mean =     -22.814591412851
             les_mean =     520.954736224272
             stat err =       0.000545554746
             autocorr =       1.367553416933
   target nu stat err =       0.000545554746
   target dn stat err =       0.003345686922
      target stat err =       0.002842675214
              std dev =       0.659752715727
             le_variance =       0.435273645910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435294406038
                                         uncertainty =       0.002302256340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435294406038
                                         uncertainty =       0.002302256340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466515619
  error estimate for blocks of size 2^( 2) =       0.000491950937
  error estimate for blocks of size 2^( 3) =       0.000516058349
  error estimate for blocks of size 2^( 4) =       0.000533321656
  error estimate for blocks of size 2^( 5) =       0.000543552153
  error estimate for blocks of size 2^( 6) =       0.000550428694
  error estimate for blocks of size 2^( 7) =       0.000554916482

      target function =      -0.746046841218
              le_mean =     -22.814591412851
             les_mean =     520.954736224272
             stat err =       0.000545554746
             autocorr =       1.367553416929
   target nu stat err =       0.000545554746
   target dn stat err =       0.003345686922
      target stat err =       0.002842675214
              std dev =       0.659752715727
             le_variance =       0.435273645910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435294406038
                                         uncertainty =       0.002302256340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435294406038
                                         uncertainty =       0.002302256340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466515619
  error estimate for blocks of size 2^( 2) =       0.000491950937
  error estimate for blocks of size 2^( 3) =       0.000516058349
  error estimate for blocks of size 2^( 4) =       0.000533321656
  error estimate for blocks of size 2^( 5) =       0.000543552153
  error estimate for blocks of size 2^( 6) =       0.000550428694
  error estimate for blocks of size 2^( 7) =       0.000554916482

      target function =      -0.746046841218
              le_mean =     -22.814591412851
             les_mean =     520.954736224272
             stat err =       0.000545554746
             autocorr =       1.367553416932
   target nu stat err =       0.000545554746
   target dn stat err =       0.003345686922
      target stat err =       0.002842675214
              std dev =       0.659752715727
             le_variance =       0.435273645910


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746046841218        initial
     8.8818e+10     8.8818e+11             1.4557e-15        -0.746046841218  <--
     3.5527e+11     3.5527e+12             3.5844e-16        -0.746046841218
     1.4211e+12     1.4211e+13             8.9626e-17        -0.746046841218

*****************************************************************************
Applying the update for shift_i =   8.8818e+10     and shift_s =   8.8818e+11
*****************************************************************************

  Execution time = 4.2775e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3516e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.8355
    reference variance = 0.646679
====================================================
  Execution time = 2.5962e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5386e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4406e-01
  Total weights = 1.964555365e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5379e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431697439790
                                         uncertainty =       0.001632441499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431697439790
                                         uncertainty =       0.001632441499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464655165
  error estimate for blocks of size 2^( 2) =       0.000490040726
  error estimate for blocks of size 2^( 3) =       0.000514159275
  error estimate for blocks of size 2^( 4) =       0.000531884643
  error estimate for blocks of size 2^( 5) =       0.000543410944
  error estimate for blocks of size 2^( 6) =       0.000549921350
  error estimate for blocks of size 2^( 7) =       0.000555572880

      target function =      -0.750297231512
              le_mean =     -22.814082654099
             les_mean =     520.926431775095
             stat err =       0.000545197454
             autocorr =       1.376721517175
   target nu stat err =       0.000545197454
   target dn stat err =       0.002476432413
      target stat err =       0.002165068974
              std dev =       0.657121636158
             le_variance =       0.431808844706


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281408265410e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+10, overlap shift 2.2204e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750302510003       residual = 9.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750302510003       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750302510003       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750302510003       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750302510003       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750302510003       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750320633080       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750240783294       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750302510003       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750216875451       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750290672347       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750369049518       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750303608021       residual = 9.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750264020067       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750305198934       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750350504546       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750273473490       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750290502207       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750308038192       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750352953447       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750354067522       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750359358131       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750356248820       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750336602994       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750326683288       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750269693222       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750313811107       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750283741489       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750294226924       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750278419735       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750284322543       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750335519292       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750311898693       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750337619774       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750259883137       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.750304247470       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750335856291       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.750266016848       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.750287636341       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750292689192       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.750326420330       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.750288588063       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.750336386420       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.750290746784       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.750301605846       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750279821085       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.750324998693       residual = 1.66e-07           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.750339724287       residual = 3.22e-08           smallest_sin_value = 9.98e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750337278363       residual = 6.54e-08           smallest_sin_value = 9.93e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+10 is 5.036306e-15

solving harmonic davidson linear method for identity shift 8.8818e+10, overlap shift 8.8818e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750302510003       residual = 9.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750302510003       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750302510003       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750240793519       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750302510003       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750302510003       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750267419028       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750302510003       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750302510003       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750583740419       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750302510003       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750426644191       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750217637524       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750153044298       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750317921178       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750464961217       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750212645251       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750331562060       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750229730624       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750282838776       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750220349450       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750358848441       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750426855600       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750312211657       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750220654709       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750375981799       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750301360536       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750307545264       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750269802803       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750358828535       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750365305366       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750270658990       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750235174282       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750258030965       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750377541967       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.750224051714       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750288683219       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.750271104885       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.750296026657       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750302289769       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.750296111781       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.750322339021       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.750296104069       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.750258443059       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.750273209505       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750306178766       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.750300240627       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.750298587130       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750319293881       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.750334761463       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.750287998756       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.750281318266       residual = 7.98e-06           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.750253952787       residual = 1.19e-05           smallest_sin_value = 9.98e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.750281670919       residual = 1.10e-05           smallest_sin_value = 9.97e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.750319547666       residual = 6.57e-06           smallest_sin_value = 9.97e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.750244153107       residual = 1.06e-06           smallest_sin_value = 9.96e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+10 is 1.268081e-15

solving harmonic davidson linear method for identity shift 3.5527e+11, overlap shift 3.5527e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750302510003       residual = 9.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750302510003       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750302510003       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750302510003       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750302510003       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750302510003       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750302510003       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750302510003       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750302510003       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750302510003       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750302510003       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750486418768       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750183385493       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.751133223892       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751072567070       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749659043470       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750327016287       residual = 8.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750770450437       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750134326847       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749700310232       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750283334358       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749983376485       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749809000819       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750309295111       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750432062471       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750291747805       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750278435353       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750716952681       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.749950785772       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750142879473       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750462430779       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.751223660016       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750556857665       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.749910911010       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750080793992       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.750341655927       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750632417552       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.749936978456       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.750384332537       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750930262970       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.750518558246       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.750185820750       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.750521818333       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.749834003132       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.750019271847       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750212650221       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.749729001044       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.749901955254       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750603613802       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.750097639643       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.750360606587       residual = 9.73e-06           smallest_sin_value = 9.98e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+11 is 3.169244e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.604081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0669e+01
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.7552
    reference variance = 0.363671
====================================================
  Execution time = 2.7311e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.5844e-01
  Total weights = 1.9643e+06
  Execution time = 3.4843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440611588967
                                         uncertainty =       0.005531140991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440611588967
                                         uncertainty =       0.005531140991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469324690
  error estimate for blocks of size 2^( 2) =       0.000494777389
  error estimate for blocks of size 2^( 3) =       0.000518799230
  error estimate for blocks of size 2^( 4) =       0.000536482454
  error estimate for blocks of size 2^( 5) =       0.000545749360
  error estimate for blocks of size 2^( 6) =       0.000552237725
  error estimate for blocks of size 2^( 7) =       0.000555639235

      target function =      -0.738348721894
              le_mean =     -22.813397856365
             les_mean =     520.909562317594
             stat err =       0.000547527194
             autocorr =       1.361020237311
   target nu stat err =       0.000547527194
   target dn stat err =       0.010137190949
      target stat err =       0.008249946287
              std dev =       0.663725342418
             le_variance =       0.440531330168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440611588967
                                         uncertainty =       0.005531140991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440611588967
                                         uncertainty =       0.005531140991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469324690
  error estimate for blocks of size 2^( 2) =       0.000494777389
  error estimate for blocks of size 2^( 3) =       0.000518799230
  error estimate for blocks of size 2^( 4) =       0.000536482454
  error estimate for blocks of size 2^( 5) =       0.000545749360
  error estimate for blocks of size 2^( 6) =       0.000552237725
  error estimate for blocks of size 2^( 7) =       0.000555639235

      target function =      -0.738348721894
              le_mean =     -22.813397856365
             les_mean =     520.909562317594
             stat err =       0.000547527194
             autocorr =       1.361020237308
   target nu stat err =       0.000547527194
   target dn stat err =       0.010137190949
      target stat err =       0.008249946287
              std dev =       0.663725342418
             le_variance =       0.440531330168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440611588967
                                         uncertainty =       0.005531140991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440611588967
                                         uncertainty =       0.005531140991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469324690
  error estimate for blocks of size 2^( 2) =       0.000494777389
  error estimate for blocks of size 2^( 3) =       0.000518799230
  error estimate for blocks of size 2^( 4) =       0.000536482454
  error estimate for blocks of size 2^( 5) =       0.000545749360
  error estimate for blocks of size 2^( 6) =       0.000552237725
  error estimate for blocks of size 2^( 7) =       0.000555639235

      target function =      -0.738348721894
              le_mean =     -22.813397856365
             les_mean =     520.909562317594
             stat err =       0.000547527194
             autocorr =       1.361020237308
   target nu stat err =       0.000547527194
   target dn stat err =       0.010137190949
      target stat err =       0.008249946287
              std dev =       0.663725342418
             le_variance =       0.440531330168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440611588967
                                         uncertainty =       0.005531140991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440611588967
                                         uncertainty =       0.005531140991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469324690
  error estimate for blocks of size 2^( 2) =       0.000494777389
  error estimate for blocks of size 2^( 3) =       0.000518799230
  error estimate for blocks of size 2^( 4) =       0.000536482454
  error estimate for blocks of size 2^( 5) =       0.000545749360
  error estimate for blocks of size 2^( 6) =       0.000552237725
  error estimate for blocks of size 2^( 7) =       0.000555639235

      target function =      -0.738348721894
              le_mean =     -22.813397856365
             les_mean =     520.909562317594
             stat err =       0.000547527194
             autocorr =       1.361020237310
   target nu stat err =       0.000547527194
   target dn stat err =       0.010137190949
      target stat err =       0.008249946287
              std dev =       0.663725342418
             le_variance =       0.440531330168


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738348721894        initial  <--
     2.2204e+10     2.2204e+11             5.0363e-15        -0.738348721894
     8.8818e+10     8.8818e+11             1.2681e-15        -0.738348721894
     3.5527e+11     3.5527e+12             3.1692e-16        -0.738348721894

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7670
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5447e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.8009
    reference variance = 0.417057
====================================================
  Execution time = 2.5947e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5366e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4718e-01
  Total weights = 1.964128509e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435988385818
                                         uncertainty =       0.002078125470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435988385818
                                         uncertainty =       0.002078125470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466879152
  error estimate for blocks of size 2^( 2) =       0.000492046811
  error estimate for blocks of size 2^( 3) =       0.000515929748
  error estimate for blocks of size 2^( 4) =       0.000533391064
  error estimate for blocks of size 2^( 5) =       0.000544054571
  error estimate for blocks of size 2^( 6) =       0.000550494161
  error estimate for blocks of size 2^( 7) =       0.000552657831

      target function =      -0.747690206214
              le_mean =     -22.814449224761
             les_mean =     520.946277575041
             stat err =       0.000545149406
             autocorr =       1.363396344098
   target nu stat err =       0.000545149406
   target dn stat err =       0.002564813330
      target stat err =       0.002222572705
              std dev =       0.660266828068
             le_variance =       0.435952284247


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281444922476e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+11, overlap shift 2.2204e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747695765012       residual = 8.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747695765012       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747695765012       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747695765012       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747671482806       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747695765012       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747695765012       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747302647287       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747878911280       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748127568115       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747394841156       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747842150081       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747846934290       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747673169999       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747845981185       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747739992905       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747672415870       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747631647744       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747660209342       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747623739842       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747541567496       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747693161048       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747660260322       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747750550645       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747604348753       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747817708105       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747609709049       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747718985713       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747695120624       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747769014889       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747715250048       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747767140540       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747671883085       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747614648596       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747595191104       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747679591313       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747111807419       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.747730518489       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.747659005370       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747832071420       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.747780902666       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747693667657       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.747707587175       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747610255495       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.747802456214       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747696773969       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747699651039       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747666659467       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.747644507597       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747706599189       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747791466256       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.747663554729       residual = 7.72e-05           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.747629823992       residual = 4.91e-05           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.747588252796       residual = 5.96e-05           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.747743553532       residual = 7.02e-05           smallest_sin_value = 9.97e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.747789134416       residual = 1.60e-05           smallest_sin_value = 9.94e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+11 is 6.482016e-16

solving harmonic davidson linear method for identity shift 8.8818e+11, overlap shift 8.8818e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747695765012       residual = 8.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747695765012       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747695765012       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747897097154       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747748692778       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747667289572       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747895924292       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747910866578       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746560320062       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749123613654       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747254107123       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746995271608       residual = 9.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747327003504       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747588712316       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746881669534       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748559424518       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747641139059       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747296538494       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748847866598       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747682694761       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748331270988       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747619637612       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746608161321       residual = 7.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747866858238       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747305355636       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748248022972       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749137559639       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749075888027       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746361426513       residual = 5.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749597350966       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749564605952       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747775349848       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748211281686       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748651329835       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747716328147       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.749231744038       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746786795716       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746606965993       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.747285210718       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748053408429       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.745986775101       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.749375790296       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748354378497       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748867228512       residual = 8.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.747035188881       residual = 1.72e-04           smallest_sin_value = 9.99e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747077368809       residual = 9.01e-05           smallest_sin_value = 9.95e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746284661765       residual = 1.78e-04           smallest_sin_value = 9.94e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747616744106       residual = 2.91e-04           smallest_sin_value = 9.94e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.72e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+11 is 1.511007e-16

solving harmonic davidson linear method for identity shift 3.5527e+12, overlap shift 3.5527e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747695765012       residual = 8.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747695765012       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747695765012       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747695765012       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747001090325       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748452703135       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751401030827       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748504485303       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.759710038774       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.753317977986       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746293688536       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741870029837       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742661066946       residual = 6.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749434398025       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750122754567       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.759244645057       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744826526513       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747017769268       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739687253340       residual = 5.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750618762178       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741652712904       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744472454901       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745715794151       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748862669325       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747084532531       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746621935302       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745245762380       residual = 5.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750767706062       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746675204351       residual = 7.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747957827051       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.751826049519       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.752703771448       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750071957389       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747023679330       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.742579116661       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.752608429948       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.751335943687       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.739474043166       residual = 4.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.753363881346       residual = 7.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750340452917       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746984133926       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.752995445766       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748799181685       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746039908845       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.747770715909       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.751650734333       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748140687191       residual = 5.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.754800481773       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.752464041218       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.751011396377       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.748937550145       residual = 2.45e-03           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.747515902766       residual = 8.87e-03           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.747525422266       residual = 1.54e-03           smallest_sin_value = 9.98e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+12 is 3.454244e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.791286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0646e+01
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.8017
    reference variance = 0.526758
====================================================
  Execution time = 2.5459e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4968e-01
  Total weights = 1.9642e+06
  Execution time = 3.4950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435932846073
                                         uncertainty =       0.002212217477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435932846073
                                         uncertainty =       0.002212217477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466858521
  error estimate for blocks of size 2^( 2) =       0.000492760859
  error estimate for blocks of size 2^( 3) =       0.000516584954
  error estimate for blocks of size 2^( 4) =       0.000533886602
  error estimate for blocks of size 2^( 5) =       0.000544528969
  error estimate for blocks of size 2^( 6) =       0.000549675941
  error estimate for blocks of size 2^( 7) =       0.000554359365

      target function =      -0.745608662182
              le_mean =     -22.814710676949
             les_mean =     520.960705422930
             stat err =       0.000545612719
             autocorr =       1.365835486448
   target nu stat err =       0.000545612719
   target dn stat err =       0.003488318890
      target stat err =       0.002955586459
              std dev =       0.660237652143
             le_variance =       0.435913757307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435932846073
                                         uncertainty =       0.002212217477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435932846073
                                         uncertainty =       0.002212217477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466858521
  error estimate for blocks of size 2^( 2) =       0.000492760859
  error estimate for blocks of size 2^( 3) =       0.000516584954
  error estimate for blocks of size 2^( 4) =       0.000533886602
  error estimate for blocks of size 2^( 5) =       0.000544528969
  error estimate for blocks of size 2^( 6) =       0.000549675941
  error estimate for blocks of size 2^( 7) =       0.000554359365

      target function =      -0.745608662182
              le_mean =     -22.814710676949
             les_mean =     520.960705422930
             stat err =       0.000545612719
             autocorr =       1.365835486447
   target nu stat err =       0.000545612719
   target dn stat err =       0.003488318890
      target stat err =       0.002955586459
              std dev =       0.660237652143
             le_variance =       0.435913757307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435932846073
                                         uncertainty =       0.002212217477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435932846073
                                         uncertainty =       0.002212217477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466858521
  error estimate for blocks of size 2^( 2) =       0.000492760859
  error estimate for blocks of size 2^( 3) =       0.000516584954
  error estimate for blocks of size 2^( 4) =       0.000533886602
  error estimate for blocks of size 2^( 5) =       0.000544528969
  error estimate for blocks of size 2^( 6) =       0.000549675941
  error estimate for blocks of size 2^( 7) =       0.000554359365

      target function =      -0.745608662182
              le_mean =     -22.814710676949
             les_mean =     520.960705422930
             stat err =       0.000545612719
             autocorr =       1.365835486447
   target nu stat err =       0.000545612719
   target dn stat err =       0.003488318890
      target stat err =       0.002955586459
              std dev =       0.660237652143
             le_variance =       0.435913757307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435932846073
                                         uncertainty =       0.002212217477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435932846073
                                         uncertainty =       0.002212217477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466858521
  error estimate for blocks of size 2^( 2) =       0.000492760859
  error estimate for blocks of size 2^( 3) =       0.000516584954
  error estimate for blocks of size 2^( 4) =       0.000533886602
  error estimate for blocks of size 2^( 5) =       0.000544528969
  error estimate for blocks of size 2^( 6) =       0.000549675941
  error estimate for blocks of size 2^( 7) =       0.000554359365

      target function =      -0.745608662182
              le_mean =     -22.814710676949
             les_mean =     520.960705422930
             stat err =       0.000545612719
             autocorr =       1.365835486447
   target nu stat err =       0.000545612719
   target dn stat err =       0.003488318890
      target stat err =       0.002955586459
              std dev =       0.660237652143
             le_variance =       0.435913757307


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745608662182        initial
     2.2204e+11     2.2204e+12             6.4820e-16        -0.745608662182  <--
     8.8818e+11     8.8818e+12             1.5110e-16        -0.745608662182
     3.5527e+12     3.5527e+13             3.4542e-17        -0.745608662182

*****************************************************************************
Applying the update for shift_i =   2.2204e+11     and shift_s =   2.2204e+12
*****************************************************************************

  Execution time = 4.2966e+01
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3623e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.8728
    reference variance = 0.412317
====================================================
  Execution time = 2.5950e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4384e-01
  Total weights = 1.964110437e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5090e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432457225627
                                         uncertainty =       0.002232406824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432457225627
                                         uncertainty =       0.002232406824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465008184
  error estimate for blocks of size 2^( 2) =       0.000490569219
  error estimate for blocks of size 2^( 3) =       0.000513903273
  error estimate for blocks of size 2^( 4) =       0.000530919715
  error estimate for blocks of size 2^( 5) =       0.000540731138
  error estimate for blocks of size 2^( 6) =       0.000545394119
  error estimate for blocks of size 2^( 7) =       0.000549765754

      target function =      -0.750490976090
              le_mean =     -22.814929368028
             les_mean =     520.964843089857
             stat err =       0.000541702681
             autocorr =       1.357065399039
   target nu stat err =       0.000541702681
   target dn stat err =       0.002474806072
      target stat err =       0.002166469058
              std dev =       0.657620880788
             le_variance =       0.432465222848


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281492936803e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+10, overlap shift 5.5511e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750496236746       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750496236746       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750496236746       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750496236746       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750496236746       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750495108208       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750472166773       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750272599709       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750641316072       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750548187028       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750697438621       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750377798242       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750546045101       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750394172515       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750550017915       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750507116229       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750525732592       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750513404039       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750489011742       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750495230241       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750491163015       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750505802782       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750488709930       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750484744270       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750463990830       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750506051402       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750488336592       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750467891739       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750500345285       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750461637175       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750506455456       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750441933808       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750494134762       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750500195518       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750309836879       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.750437793753       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750474847153       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.750479685306       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.750486686612       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750450203251       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.750503917377       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.750502281674       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.750522140839       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.750475874679       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.750567933488       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750504466858       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.750484016149       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.750467932413       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750474141646       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.750489985664       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.750499970608       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.750472220276       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.750499459373       residual = 1.54e-07           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.750430474900       residual = 4.78e-07           smallest_sin_value = 9.96e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+10 is 2.406151e-15

solving harmonic davidson linear method for identity shift 2.2204e+11, overlap shift 2.2204e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750496236746       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750496236746       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750496236746       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750503165516       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750513688465       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750481387255       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750471422843       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750531988673       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750792466358       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750391278985       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749907940553       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750496459647       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750159255043       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750061026494       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750284160649       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750631453169       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750628331314       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750594364947       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750498485303       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750527828278       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750720690575       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750453360823       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750500556962       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750321293875       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750628499779       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750068628249       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750347414515       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750508909084       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750630669519       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750372407367       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750777363211       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750303411080       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750564500928       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750506418318       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750563894183       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.750455358240       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750671754050       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.750635297134       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.750342487057       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750383077872       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.750326931899       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.750324755268       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.750464912177       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.750595291107       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.750294511565       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750385554094       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.750646039287       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.750261189302       residual = 3.05e-05           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750567848913       residual = 3.56e-05           smallest_sin_value = 9.96e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+11 is 5.566893e-16

solving harmonic davidson linear method for identity shift 8.8818e+11, overlap shift 8.8818e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750496236746       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750496236746       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750496236746       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750496236746       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750071776657       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750496235306       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750379122250       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750613854444       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751778289371       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750266994641       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750499481603       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750292090848       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.751047977355       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750754622435       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751275687346       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.751914694111       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750431846311       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749916086271       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.751064973625       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750771480983       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.751109442828       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750506258084       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.751051472182       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.752032337120       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.751416333033       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.751612246493       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750491779815       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750117527584       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750918097045       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750213733268       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750302817309       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749108638677       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750257627864       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.749725528490       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750552445836       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.751853359498       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750299094579       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.750694971233       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.749761814746       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.751053732610       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.749943701517       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.751279446667       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.751559687257       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.749156379364       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.750536514641       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.749044261381       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.749987091597       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.751563991022       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750546925015       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.750800900754       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.750475376139       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.751173868432       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.750464109731       residual = 9.70e-05           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.749987141890       residual = 5.14e-05           smallest_sin_value = 9.95e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+11 is 1.267299e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.958650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0631e+01
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.7334
    reference variance = 0.256856
====================================================
  Execution time = 2.7576e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5460e-01
  Total weights = 1.9646e+06
  Execution time = 3.4725e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440859793528
                                         uncertainty =       0.002450159491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440859793528
                                         uncertainty =       0.002450159491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469494717
  error estimate for blocks of size 2^( 2) =       0.000494704328
  error estimate for blocks of size 2^( 3) =       0.000518616788
  error estimate for blocks of size 2^( 4) =       0.000536745386
  error estimate for blocks of size 2^( 5) =       0.000546986715
  error estimate for blocks of size 2^( 6) =       0.000554921201
  error estimate for blocks of size 2^( 7) =       0.000557070243

      target function =      -0.741540565968
              le_mean =     -22.816049150495
             les_mean =     521.026696684346
             stat err =       0.000548930886
             autocorr =       1.367017004036
   target nu stat err =       0.000548930886
   target dn stat err =       0.004103516710
      target stat err =       0.003426923403
              std dev =       0.663965795684
             le_variance =       0.440850577838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440859793528
                                         uncertainty =       0.002450159491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440859793528
                                         uncertainty =       0.002450159491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469494717
  error estimate for blocks of size 2^( 2) =       0.000494704328
  error estimate for blocks of size 2^( 3) =       0.000518616788
  error estimate for blocks of size 2^( 4) =       0.000536745386
  error estimate for blocks of size 2^( 5) =       0.000546986715
  error estimate for blocks of size 2^( 6) =       0.000554921201
  error estimate for blocks of size 2^( 7) =       0.000557070243

      target function =      -0.741540565968
              le_mean =     -22.816049150495
             les_mean =     521.026696684346
             stat err =       0.000548930886
             autocorr =       1.367017004036
   target nu stat err =       0.000548930886
   target dn stat err =       0.004103516710
      target stat err =       0.003426923404
              std dev =       0.663965795684
             le_variance =       0.440850577838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440859793528
                                         uncertainty =       0.002450159491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440859793528
                                         uncertainty =       0.002450159491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469494717
  error estimate for blocks of size 2^( 2) =       0.000494704328
  error estimate for blocks of size 2^( 3) =       0.000518616788
  error estimate for blocks of size 2^( 4) =       0.000536745386
  error estimate for blocks of size 2^( 5) =       0.000546986715
  error estimate for blocks of size 2^( 6) =       0.000554921201
  error estimate for blocks of size 2^( 7) =       0.000557070243

      target function =      -0.741540565968
              le_mean =     -22.816049150495
             les_mean =     521.026696684346
             stat err =       0.000548930886
             autocorr =       1.367017004039
   target nu stat err =       0.000548930886
   target dn stat err =       0.004103516710
      target stat err =       0.003426923404
              std dev =       0.663965795684
             le_variance =       0.440850577838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440859793528
                                         uncertainty =       0.002450159491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440859793528
                                         uncertainty =       0.002450159491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469494717
  error estimate for blocks of size 2^( 2) =       0.000494704328
  error estimate for blocks of size 2^( 3) =       0.000518616788
  error estimate for blocks of size 2^( 4) =       0.000536745386
  error estimate for blocks of size 2^( 5) =       0.000546986715
  error estimate for blocks of size 2^( 6) =       0.000554921201
  error estimate for blocks of size 2^( 7) =       0.000557070243

      target function =      -0.741540565968
              le_mean =     -22.816049150495
             les_mean =     521.026696684346
             stat err =       0.000548930886
             autocorr =       1.367017004036
   target nu stat err =       0.000548930886
   target dn stat err =       0.004103516710
      target stat err =       0.003426923404
              std dev =       0.663965795684
             le_variance =       0.440850577838


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741540565968        initial  <--
     5.5511e+10     5.5511e+11             2.4062e-15        -0.741540565968
     2.2204e+11     2.2204e+12             5.5669e-16        -0.741540565968
     8.8818e+11     8.8818e+12             1.2673e-16        -0.741540565968

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9762
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5613e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.8546
    reference variance = 0.405934
====================================================
  Execution time = 2.5746e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5366e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5094e-01
  Total weights = 1.964544356e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434493486327
                                         uncertainty =       0.001747535911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434493486327
                                         uncertainty =       0.001747535911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466075147
  error estimate for blocks of size 2^( 2) =       0.000491643956
  error estimate for blocks of size 2^( 3) =       0.000515458989
  error estimate for blocks of size 2^( 4) =       0.000533295906
  error estimate for blocks of size 2^( 5) =       0.000543848371
  error estimate for blocks of size 2^( 6) =       0.000550264548
  error estimate for blocks of size 2^( 7) =       0.000554930444

      target function =      -0.744557635402
              le_mean =     -22.815987719456
             les_mean =     521.020240318915
             stat err =       0.000545584817
             autocorr =       1.370290549460
   target nu stat err =       0.000545584817
   target dn stat err =       0.003756051034
      target stat err =       0.003170461278
              std dev =       0.659129793285
             le_variance =       0.434452084396


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281598771946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+11, overlap shift 5.5511e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744570166533       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744570166533       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744570166533       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744570166533       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744570166557       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744570166555       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744569619536       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744646771081       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743707494585       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745232641751       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744669562203       residual = 8.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744980948085       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746414371947       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744533198446       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745595721958       residual = 9.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744996266403       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744696087644       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745906579964       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744893271528       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744555081397       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745134107173       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744288928758       residual = 7.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744939892329       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744562084745       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745073973298       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744045930788       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743616639297       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744894987589       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745137569515       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745054914497       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744513721811       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744668307659       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745143202411       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.744134387472       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.744296360047       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.744979443736       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.744945145226       residual = 8.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.743961331906       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.744037495001       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.744018125832       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.743962454488       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.744712525892       residual = 9.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.745266976132       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.743860541652       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.744162884539       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.744370450220       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.745087033506       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.745698996031       residual = 5.43e-05           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.744592825959       residual = 7.76e-05           smallest_sin_value = 9.96e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.744373268672       residual = 9.20e-05           smallest_sin_value = 9.95e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+11 is 2.981657e-16

solving harmonic davidson linear method for identity shift 2.2204e+12, overlap shift 2.2204e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744570166533       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744570166533       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744570166533       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743248005479       residual = 8.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744570166525       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744479260077       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743389527209       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744729795753       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747114807398       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748344716259       residual = 4.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743183659378       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746763360251       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747282906607       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745475773627       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744935969767       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742534956694       residual = 7.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742590142706       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745866545370       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745365164040       residual = 6.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742534979701       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743570101454       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744973598153       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745901584697       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743733097611       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743988140726       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744976063773       residual = 5.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744493870693       residual = 9.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745249107835       residual = 6.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746575913191       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742389926205       residual = 5.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744488451091       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.742823678381       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.742908875987       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.743247763459       residual = 6.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.740250135570       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.745786961397       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742949416641       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.743161018470       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.741359820082       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.744995060054       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.744932717023       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.743001213987       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.743458663159       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.745892269436       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.741983414384       residual = 4.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750786013984       residual = 4.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.743161423091       residual = 4.05e-03           smallest_sin_value = 9.98e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.742814929895       residual = 4.33e-03           smallest_sin_value = 9.97e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.744339100559       residual = 3.89e-03           smallest_sin_value = 9.95e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+12 is 6.089863e-17

solving harmonic davidson linear method for identity shift 8.8818e+12, overlap shift 8.8818e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744570166533       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744570166533       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744570166533       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744570166532       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744570166530       residual = 5.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745542735094       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744561322096       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743329932871       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.764106878675       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745099532588       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.717968563067       residual = 6.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.720601341032       residual = 2.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.751421252505       residual = 7.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.766494471335       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.725003470466       residual = 6.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.721790828307       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.761011403001       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740379515342       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.732672007863       residual = 3.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740206246084       residual = 5.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748120862164       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.735872210143       residual = 3.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.734506818887       residual = 2.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.730645600122       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748324171953       residual = 3.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742163577289       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746506848300       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.752475789974       residual = 4.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.724178983991       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.736896197951       residual = 4.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745835398864       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.735478363206       residual = 3.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741300994471       residual = 3.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750330905567       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745000596082       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.738321999890       residual = 5.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.749795491397       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.757518942862       residual = 3.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.767497451599       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.738446434101       residual = 2.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.731894715135       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.764364890979       residual = 2.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.745800751004       residual = 2.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.735669585409       residual = 2.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.738419842952       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.739381330798       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747394888212       residual = 9.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.754054699288       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.751766852189       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.739089757559       residual = 8.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.745859799144       residual = 1.11e-01           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.746626657991       residual = 1.48e-01           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.732639467916       residual = 1.39e-01           smallest_sin_value = 9.97e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.760269175932       residual = 1.50e-01           smallest_sin_value = 9.97e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.752633621174       residual = 1.18e-01           smallest_sin_value = 9.96e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+12 is 1.627437e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.117758 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0390e+01
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.7377
    reference variance = 0.477657
====================================================
  Execution time = 2.5300e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4769e-01
  Total weights = 1.9645e+06
  Execution time = 3.4920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434022555187
                                         uncertainty =       0.001939168115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434022555187
                                         uncertainty =       0.001939168115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465831346
  error estimate for blocks of size 2^( 2) =       0.000491066407
  error estimate for blocks of size 2^( 3) =       0.000515187198
  error estimate for blocks of size 2^( 4) =       0.000532722555
  error estimate for blocks of size 2^( 5) =       0.000543226914
  error estimate for blocks of size 2^( 6) =       0.000550230714
  error estimate for blocks of size 2^( 7) =       0.000552820578

      target function =      -0.747268051432
              le_mean =     -22.815710397252
             les_mean =     521.004330662868
             stat err =       0.000544750190
             autocorr =       1.367531574426
   target nu stat err =       0.000544750190
   target dn stat err =       0.003119824480
      target stat err =       0.002672560048
              std dev =       0.658785007659
             le_variance =       0.433997686317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434022555187
                                         uncertainty =       0.001939168115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434022555187
                                         uncertainty =       0.001939168115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465831346
  error estimate for blocks of size 2^( 2) =       0.000491066407
  error estimate for blocks of size 2^( 3) =       0.000515187198
  error estimate for blocks of size 2^( 4) =       0.000532722555
  error estimate for blocks of size 2^( 5) =       0.000543226914
  error estimate for blocks of size 2^( 6) =       0.000550230714
  error estimate for blocks of size 2^( 7) =       0.000552820578

      target function =      -0.747268051432
              le_mean =     -22.815710397252
             les_mean =     521.004330662868
             stat err =       0.000544750190
             autocorr =       1.367531574426
   target nu stat err =       0.000544750190
   target dn stat err =       0.003119824480
      target stat err =       0.002672560048
              std dev =       0.658785007659
             le_variance =       0.433997686317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434022555187
                                         uncertainty =       0.001939168115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434022555187
                                         uncertainty =       0.001939168115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465831346
  error estimate for blocks of size 2^( 2) =       0.000491066407
  error estimate for blocks of size 2^( 3) =       0.000515187198
  error estimate for blocks of size 2^( 4) =       0.000532722555
  error estimate for blocks of size 2^( 5) =       0.000543226914
  error estimate for blocks of size 2^( 6) =       0.000550230714
  error estimate for blocks of size 2^( 7) =       0.000552820578

      target function =      -0.747268051432
              le_mean =     -22.815710397252
             les_mean =     521.004330662868
             stat err =       0.000544750190
             autocorr =       1.367531574423
   target nu stat err =       0.000544750190
   target dn stat err =       0.003119824480
      target stat err =       0.002672560048
              std dev =       0.658785007659
             le_variance =       0.433997686317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434022555187
                                         uncertainty =       0.001939168115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434022555187
                                         uncertainty =       0.001939168115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465831346
  error estimate for blocks of size 2^( 2) =       0.000491066407
  error estimate for blocks of size 2^( 3) =       0.000515187198
  error estimate for blocks of size 2^( 4) =       0.000532722555
  error estimate for blocks of size 2^( 5) =       0.000543226914
  error estimate for blocks of size 2^( 6) =       0.000550230714
  error estimate for blocks of size 2^( 7) =       0.000552820578

      target function =      -0.747268051432
              le_mean =     -22.815710397252
             les_mean =     521.004330662868
             stat err =       0.000544750190
             autocorr =       1.367531574425
   target nu stat err =       0.000544750190
   target dn stat err =       0.003119824480
      target stat err =       0.002672560048
              std dev =       0.658785007659
             le_variance =       0.433997686317


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747268051432        initial
     5.5511e+11     5.5511e+12             2.9817e-16        -0.747268051432
     2.2204e+12     2.2204e+13             6.0899e-17        -0.747268051432  <--
     8.8818e+12     8.8818e+13             1.6274e-17        -0.747268051432

*****************************************************************************
Applying the update for shift_i =   2.2204e+12     and shift_s =   2.2204e+13
*****************************************************************************

  Execution time = 4.2794e+01
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3189e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.8126
    reference variance = 0.309399
====================================================
  Execution time = 2.5786e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5269e-01
  Total weights = 1.964260418e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438510543114
                                         uncertainty =       0.003256995346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438510543114
                                         uncertainty =       0.003256995346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468185680
  error estimate for blocks of size 2^( 2) =       0.000493373202
  error estimate for blocks of size 2^( 3) =       0.000517860741
  error estimate for blocks of size 2^( 4) =       0.000536295743
  error estimate for blocks of size 2^( 5) =       0.000546255512
  error estimate for blocks of size 2^( 6) =       0.000552550183
  error estimate for blocks of size 2^( 7) =       0.000555155922

      target function =      -0.743105865566
              le_mean =     -22.815258786505
             les_mean =     520.988724607187
             stat err =       0.000547564340
             autocorr =       1.367836097572
   target nu stat err =       0.000547564340
   target dn stat err =       0.005193121013
      target stat err =       0.004323897758
              std dev =       0.662114538788
             le_variance =       0.438395662475


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281525878651e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+11, overlap shift 5.5511e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743130080148       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743130080148       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743130080148       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743130080148       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743130080148       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743130262017       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743130227785       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742146330108       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742399686248       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744263394546       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744740281623       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742186606973       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741956653544       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743014614867       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741750361218       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744135223460       residual = 9.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742454275687       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742708912687       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743402403444       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743091331238       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743268445310       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742722011195       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742434649390       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743172994260       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742573524259       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743421596825       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742611205360       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742803308936       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743399232004       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742941669254       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743078947629       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743321720851       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.742665168920       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.743033858673       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.743206633421       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.742682467307       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.743037343068       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.743465699970       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.743490965967       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743203202118       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.743248619957       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.743294617360       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.743537419846       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.743104346454       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.743002518859       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.743594016481       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.742893460634       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.743194110040       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.742755382021       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.743068091666       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.743134026043       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.743142800505       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.743143125708       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.742898133680       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.743207259881       residual = 2.45e-05           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.743196205405       residual = 2.68e-04           smallest_sin_value = 9.98e-01
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.742879942736       residual = 3.73e-05           smallest_sin_value = 9.95e-01
davidson iteration   57 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         57 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+11 is 3.873292e-16

solving harmonic davidson linear method for identity shift 2.2204e+12, overlap shift 2.2204e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743130080148       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743130080148       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743130080148       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743130080148       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743130080142       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743252006472       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743172955946       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744064172831       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745153322334       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745863885076       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741391122297       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742368734717       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.751244196648       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742276159154       residual = 5.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744180250326       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743725972683       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743131683531       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742645161284       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744381656507       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742947650396       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743884917678       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743252484069       residual = 4.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743503634637       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743570322523       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743398577478       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743283729021       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742217769899       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741742473896       residual = 7.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743571124253       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743787548634       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743554900486       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745778384926       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743780280605       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742357839281       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.743030901303       residual = 4.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.743810485543       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.740721220533       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.742831055657       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.740713943436       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743194837934       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.741241940241       residual = 6.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.745834780923       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.744692845545       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.741477996954       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745490240615       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745429972009       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.741562369884       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746101259832       residual = 7.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746216422243       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.740067881651       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.745303529331       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.739780174634       residual = 1.64e-03           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.745115814843       residual = 3.98e-03           smallest_sin_value = 9.97e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+12 is 7.851497e-17

solving harmonic davidson linear method for identity shift 8.8818e+12, overlap shift 8.8818e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743130080148       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743130080148       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.247056 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0417e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.8492
    reference variance = 0.263492
====================================================
  Execution time = 2.7252e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4924e-01
  Total weights = 1.9648e+06
  Execution time = 3.4898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433961552900
                                         uncertainty =       0.001603589177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433961552900
                                         uncertainty =       0.001603589177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465827954
  error estimate for blocks of size 2^( 2) =       0.000490890889
  error estimate for blocks of size 2^( 3) =       0.000514503858
  error estimate for blocks of size 2^( 4) =       0.000532421117
  error estimate for blocks of size 2^( 5) =       0.000543196150
  error estimate for blocks of size 2^( 6) =       0.000549510813
  error estimate for blocks of size 2^( 7) =       0.000551832303

      target function =      -0.745981140094
              le_mean =     -22.814726521212
             les_mean =     520.960984434377
             stat err =       0.000544240096
             autocorr =       1.364991589484
   target nu stat err =       0.000544240096
   target dn stat err =       0.002744341116
      target stat err =       0.002357132359
              std dev =       0.658780210143
             le_variance =       0.433991365276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433961552900
                                         uncertainty =       0.001603589177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433961552900
                                         uncertainty =       0.001603589177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465827954
  error estimate for blocks of size 2^( 2) =       0.000490890889
  error estimate for blocks of size 2^( 3) =       0.000514503858
  error estimate for blocks of size 2^( 4) =       0.000532421117
  error estimate for blocks of size 2^( 5) =       0.000543196150
  error estimate for blocks of size 2^( 6) =       0.000549510813
  error estimate for blocks of size 2^( 7) =       0.000551832303

      target function =      -0.745981140094
              le_mean =     -22.814726521212
             les_mean =     520.960984434377
             stat err =       0.000544240096
             autocorr =       1.364991589483
   target nu stat err =       0.000544240096
   target dn stat err =       0.002744341116
      target stat err =       0.002357132359
              std dev =       0.658780210143
             le_variance =       0.433991365276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433961552900
                                         uncertainty =       0.001603589177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433961552900
                                         uncertainty =       0.001603589177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465827954
  error estimate for blocks of size 2^( 2) =       0.000490890889
  error estimate for blocks of size 2^( 3) =       0.000514503858
  error estimate for blocks of size 2^( 4) =       0.000532421117
  error estimate for blocks of size 2^( 5) =       0.000543196150
  error estimate for blocks of size 2^( 6) =       0.000549510813
  error estimate for blocks of size 2^( 7) =       0.000551832303

      target function =      -0.745981140094
              le_mean =     -22.814726521212
             les_mean =     520.960984434377
             stat err =       0.000544240096
             autocorr =       1.364991589484
   target nu stat err =       0.000544240096
   target dn stat err =       0.002744341116
      target stat err =       0.002357132359
              std dev =       0.658780210143
             le_variance =       0.433991365276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433961552900
                                         uncertainty =       0.001603589177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433961552900
                                         uncertainty =       0.001603589177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465827954
  error estimate for blocks of size 2^( 2) =       0.000490890889
  error estimate for blocks of size 2^( 3) =       0.000514503858
  error estimate for blocks of size 2^( 4) =       0.000532421117
  error estimate for blocks of size 2^( 5) =       0.000543196150
  error estimate for blocks of size 2^( 6) =       0.000549510813
  error estimate for blocks of size 2^( 7) =       0.000551832303

      target function =      -0.745981140094
              le_mean =     -22.814726521212
             les_mean =     520.960984434377
             stat err =       0.000544240096
             autocorr =       1.364991589484
   target nu stat err =       0.000544240096
   target dn stat err =       0.002744341116
      target stat err =       0.002357132359
              std dev =       0.658780210143
             le_variance =       0.433991365276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745981140094        initial
     5.5511e+11     5.5511e+12             3.8733e-16        -0.745981140094
     2.2204e+12     2.2204e+13             7.8515e-17        -0.745981140094  <--
     8.8818e+12     8.8818e+13             0.0000e+00        -0.745981140094

*****************************************************************************
Applying the update for shift_i =   2.2204e+12     and shift_s =   2.2204e+13
*****************************************************************************

  Execution time = 4.4746e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5169e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.7023
    reference variance = 0.314576
====================================================
  Execution time = 2.6221e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5360e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4846e-01
  Total weights = 1.964077991e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4757e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434533746523
                                         uncertainty =       0.002029529077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434533746523
                                         uncertainty =       0.002029529077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466109729
  error estimate for blocks of size 2^( 2) =       0.000492041551
  error estimate for blocks of size 2^( 3) =       0.000516627034
  error estimate for blocks of size 2^( 4) =       0.000533732108
  error estimate for blocks of size 2^( 5) =       0.000544555963
  error estimate for blocks of size 2^( 6) =       0.000550332499
  error estimate for blocks of size 2^( 7) =       0.000553941452

      target function =      -0.746622301356
              le_mean =     -22.815291465484
             les_mean =     520.985984994265
             stat err =       0.000545640506
             autocorr =       1.370366927954
   target nu stat err =       0.000545640506
   target dn stat err =       0.003670435131
      target stat err =       0.003114533346
              std dev =       0.659178700750
             le_variance =       0.434516559523


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281529146548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+11, overlap shift 5.5511e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746634346298       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746634346298       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746634346298       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746634346298       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746634346298       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746634346298       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746634346298       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746634346298       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746634346298       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746634346298       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746634346298       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746157466255       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744671982276       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746739795161       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747254566814       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746050942096       residual = 9.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745270337136       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747008409579       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746482967912       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747057874607       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746263832359       residual = 7.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747143830784       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746644566118       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746790702073       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746899801122       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746588263330       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746783107466       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746132294084       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747205844517       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746269182148       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747126860762       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746675621052       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746961574779       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745649047588       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746833360316       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746768994509       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746365710141       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746713703348       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746764161024       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746684144566       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746465100757       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746988911015       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746898877695       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746531552914       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746331589484       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746695370807       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746801340045       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747131436751       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746780929648       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746915905915       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746163126159       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.746780830406       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.746949358372       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.745101730533       residual = 5.09e-05           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.746962643751       residual = 3.89e-05           smallest_sin_value = 9.96e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+11 is 3.546251e-16

solving harmonic davidson linear method for identity shift 2.2204e+12, overlap shift 2.2204e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746634346298       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746634346298       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746634346298       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746634346298       residual = 9.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746634346298       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744655677167       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744308537153       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746480898565       residual = 8.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751431404825       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751431887420       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750240943449       residual = 7.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.751348590060       residual = 7.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747228715192       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745001694484       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743376888194       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741241960598       residual = 6.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743850079665       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750018713036       residual = 1.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747131793376       residual = 8.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748762396886       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745896521580       residual = 6.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741376184256       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744984967161       residual = 6.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748679034894       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745630786541       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745375283497       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748912179465       residual = 6.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749325580326       residual = 7.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744577655510       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742941103982       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741755467620       residual = 7.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748136694286       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746792083578       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748812973611       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.751742424755       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.749976822833       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742055261770       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746690274570       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.741811093654       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743758960909       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746999521698       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.745702798390       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.744141851912       residual = 9.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747338536486       residual = 6.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746818303292       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745540923781       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.751664778238       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.744043939110       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.744519218840       residual = 6.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746385373334       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746408159213       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.746996993669       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.745964341871       residual = 8.89e-04           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.746017034332       residual = 2.72e-03           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.747178341016       residual = 8.62e-03           smallest_sin_value = 9.98e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.747013203878       residual = 3.10e-03           smallest_sin_value = 9.94e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+12 is 9.428028e-17

solving harmonic davidson linear method for identity shift 8.8818e+12, overlap shift 8.8818e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746634346298       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746634346298       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.79e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.380255 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0835e+01
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.8025
    reference variance = 0.27945
====================================================
  Execution time = 2.5404e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4972e-01
  Total weights = 1.9646e+06
  Execution time = 3.4896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437227591552
                                         uncertainty =       0.002794625515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437227591552
                                         uncertainty =       0.002794625515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467579495
  error estimate for blocks of size 2^( 2) =       0.000492948115
  error estimate for blocks of size 2^( 3) =       0.000517032391
  error estimate for blocks of size 2^( 4) =       0.000535399149
  error estimate for blocks of size 2^( 5) =       0.000547735698
  error estimate for blocks of size 2^( 6) =       0.000554909201
  error estimate for blocks of size 2^( 7) =       0.000559275779

      target function =      -0.745569606783
              le_mean =     -22.815620456770
             les_mean =     521.002261780340
             stat err =       0.000549329957
             autocorr =       1.380243315505
   target nu stat err =       0.000549329957
   target dn stat err =       0.003854904689
      target stat err =       0.003258565783
              std dev =       0.661257262664
             le_variance =       0.437261167425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437227591552
                                         uncertainty =       0.002794625515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437227591552
                                         uncertainty =       0.002794625515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467579495
  error estimate for blocks of size 2^( 2) =       0.000492948115
  error estimate for blocks of size 2^( 3) =       0.000517032391
  error estimate for blocks of size 2^( 4) =       0.000535399149
  error estimate for blocks of size 2^( 5) =       0.000547735698
  error estimate for blocks of size 2^( 6) =       0.000554909201
  error estimate for blocks of size 2^( 7) =       0.000559275779

      target function =      -0.745569606783
              le_mean =     -22.815620456770
             les_mean =     521.002261780340
             stat err =       0.000549329957
             autocorr =       1.380243315504
   target nu stat err =       0.000549329957
   target dn stat err =       0.003854904689
      target stat err =       0.003258565783
              std dev =       0.661257262664
             le_variance =       0.437261167425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437227591552
                                         uncertainty =       0.002794625515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437227591552
                                         uncertainty =       0.002794625515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467579495
  error estimate for blocks of size 2^( 2) =       0.000492948115
  error estimate for blocks of size 2^( 3) =       0.000517032391
  error estimate for blocks of size 2^( 4) =       0.000535399149
  error estimate for blocks of size 2^( 5) =       0.000547735698
  error estimate for blocks of size 2^( 6) =       0.000554909201
  error estimate for blocks of size 2^( 7) =       0.000559275779

      target function =      -0.745569606783
              le_mean =     -22.815620456770
             les_mean =     521.002261780340
             stat err =       0.000549329957
             autocorr =       1.380243315505
   target nu stat err =       0.000549329957
   target dn stat err =       0.003854904689
      target stat err =       0.003258565783
              std dev =       0.661257262664
             le_variance =       0.437261167425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437227591552
                                         uncertainty =       0.002794625515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437227591552
                                         uncertainty =       0.002794625515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467579495
  error estimate for blocks of size 2^( 2) =       0.000492948115
  error estimate for blocks of size 2^( 3) =       0.000517032391
  error estimate for blocks of size 2^( 4) =       0.000535399149
  error estimate for blocks of size 2^( 5) =       0.000547735698
  error estimate for blocks of size 2^( 6) =       0.000554909201
  error estimate for blocks of size 2^( 7) =       0.000559275779

      target function =      -0.745569606783
              le_mean =     -22.815620456770
             les_mean =     521.002261780340
             stat err =       0.000549329957
             autocorr =       1.380243315505
   target nu stat err =       0.000549329957
   target dn stat err =       0.003854904689
      target stat err =       0.003258565783
              std dev =       0.661257262664
             le_variance =       0.437261167425


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745569606783        initial  <--
     5.5511e+11     5.5511e+12             3.5463e-16        -0.745569606783
     2.2204e+12     2.2204e+13             9.4280e-17        -0.745569606783
     8.8818e+12     8.8818e+13             0.0000e+00        -0.745569606783

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8915
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3747e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.8142
    reference variance = 0.414765
====================================================
  Execution time = 2.5712e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4915e-01
  Total weights = 1.964213644e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435652022789
                                         uncertainty =       0.001853380633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435652022789
                                         uncertainty =       0.001853380633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466715410
  error estimate for blocks of size 2^( 2) =       0.000492339064
  error estimate for blocks of size 2^( 3) =       0.000515564883
  error estimate for blocks of size 2^( 4) =       0.000533005899
  error estimate for blocks of size 2^( 5) =       0.000543370850
  error estimate for blocks of size 2^( 6) =       0.000549329034
  error estimate for blocks of size 2^( 7) =       0.000555990959

      target function =      -0.746047714021
              le_mean =     -22.815089481666
             les_mean =     520.977458966071
             stat err =       0.000545424186
             autocorr =       1.365728908745
   target nu stat err =       0.000545424186
   target dn stat err =       0.003736178397
      target stat err =       0.003162427466
              std dev =       0.660035262679
             le_variance =       0.435646547979


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281508948167e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+12, overlap shift 5.5511e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746060159440       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746060159440       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.2204e+13, overlap shift 2.2204e+14 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746060159440       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746060159440       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 8.8818e+13, overlap shift 8.8818e+14 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746060159440       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746060159440       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.381295 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0245e+01
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.8181
    reference variance = 0.529379
====================================================
  Execution time = 2.7234e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5212e-01
  Total weights = 1.9643e+06
  Execution time = 3.4958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437183010702
                                         uncertainty =       0.002087663129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437183010702
                                         uncertainty =       0.002087663129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467517642
  error estimate for blocks of size 2^( 2) =       0.000493027188
  error estimate for blocks of size 2^( 3) =       0.000517469997
  error estimate for blocks of size 2^( 4) =       0.000535863315
  error estimate for blocks of size 2^( 5) =       0.000548422219
  error estimate for blocks of size 2^( 6) =       0.000555615529
  error estimate for blocks of size 2^( 7) =       0.000559657129

      target function =      -0.743588957575
              le_mean =     -22.815249456411
             les_mean =     520.987728415661
             stat err =       0.000549889548
             autocorr =       1.383422775338
   target nu stat err =       0.000549889548
   target dn stat err =       0.003650052067
      target stat err =       0.003074001146
              std dev =       0.661169790636
             le_variance =       0.437145492050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437183010702
                                         uncertainty =       0.002087663129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437183010702
                                         uncertainty =       0.002087663129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467517642
  error estimate for blocks of size 2^( 2) =       0.000493027188
  error estimate for blocks of size 2^( 3) =       0.000517469997
  error estimate for blocks of size 2^( 4) =       0.000535863315
  error estimate for blocks of size 2^( 5) =       0.000548422219
  error estimate for blocks of size 2^( 6) =       0.000555615529
  error estimate for blocks of size 2^( 7) =       0.000559657129

      target function =      -0.743588957575
              le_mean =     -22.815249456411
             les_mean =     520.987728415661
             stat err =       0.000549889548
             autocorr =       1.383422775338
   target nu stat err =       0.000549889548
   target dn stat err =       0.003650052067
      target stat err =       0.003074001146
              std dev =       0.661169790636
             le_variance =       0.437145492050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437183010702
                                         uncertainty =       0.002087663129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437183010702
                                         uncertainty =       0.002087663129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467517642
  error estimate for blocks of size 2^( 2) =       0.000493027188
  error estimate for blocks of size 2^( 3) =       0.000517469997
  error estimate for blocks of size 2^( 4) =       0.000535863315
  error estimate for blocks of size 2^( 5) =       0.000548422219
  error estimate for blocks of size 2^( 6) =       0.000555615529
  error estimate for blocks of size 2^( 7) =       0.000559657129

      target function =      -0.743588957575
              le_mean =     -22.815249456411
             les_mean =     520.987728415661
             stat err =       0.000549889548
             autocorr =       1.383422775338
   target nu stat err =       0.000549889548
   target dn stat err =       0.003650052067
      target stat err =       0.003074001146
              std dev =       0.661169790636
             le_variance =       0.437145492050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437183010702
                                         uncertainty =       0.002087663129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437183010702
                                         uncertainty =       0.002087663129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467517642
  error estimate for blocks of size 2^( 2) =       0.000493027188
  error estimate for blocks of size 2^( 3) =       0.000517469997
  error estimate for blocks of size 2^( 4) =       0.000535863315
  error estimate for blocks of size 2^( 5) =       0.000548422219
  error estimate for blocks of size 2^( 6) =       0.000555615529
  error estimate for blocks of size 2^( 7) =       0.000559657129

      target function =      -0.743588957575
              le_mean =     -22.815249456411
             les_mean =     520.987728415661
             stat err =       0.000549889548
             autocorr =       1.383422775338
   target nu stat err =       0.000549889548
   target dn stat err =       0.003650052067
      target stat err =       0.003074001146
              std dev =       0.661169790636
             le_variance =       0.437145492050


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743588957575        initial  <--
     5.5511e+12     5.5511e+13             0.0000e+00        -0.743588957575
     2.2204e+13     2.2204e+14             0.0000e+00        -0.743588957575
     8.8818e+13     8.8818e+14             0.0000e+00        -0.743588957575

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7607
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5012e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.8945
    reference variance = 0.420404
====================================================
  Execution time = 2.5975e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5323e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4714e-01
  Total weights = 1.964180057e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434843327112
                                         uncertainty =       0.002271434125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434843327112
                                         uncertainty =       0.002271434125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466248680
  error estimate for blocks of size 2^( 2) =       0.000491939631
  error estimate for blocks of size 2^( 3) =       0.000515888262
  error estimate for blocks of size 2^( 4) =       0.000533770398
  error estimate for blocks of size 2^( 5) =       0.000546783922
  error estimate for blocks of size 2^( 6) =       0.000552771832
  error estimate for blocks of size 2^( 7) =       0.000554747856

      target function =      -0.747726367305
              le_mean =     -22.815015590365
             les_mean =     520.972071572757
             stat err =       0.000547018502
             autocorr =       1.376476500803
   target nu stat err =       0.000547018502
   target dn stat err =       0.003643889769
      target stat err =       0.003100871644
              std dev =       0.659375206554
             le_variance =       0.434775663018


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281501559037e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+13, overlap shift 5.5511e+14 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747738205246       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747738205246       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747738205246       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747738205246       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747738205246       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747738205246       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747738205242       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747571684509       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.585237338617       residual = 6.20e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.798723412047       residual = 1.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.843268345955       residual = 4.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.820259351897       residual = 4.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.737275198051       residual = 6.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.790477312215       residual = 5.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750514451502       residual = 6.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.777849052690       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.728996465667       residual = 2.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.758999326795       residual = 3.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742293207386       residual = 1.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.698678845654       residual = 4.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.758749591771       residual = 8.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.825998578397       residual = 6.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.809349882928       residual = 3.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.764933597889       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.790639959658       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.775823989029       residual = 7.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707454061010       residual = 1.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.767765457572       residual = 3.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741348147428       residual = 7.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749027001260       residual = 2.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.753758920191       residual = 2.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.753442592922       residual = 3.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.762294810489       residual = 1.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.728866633219       residual = 5.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.740850421815       residual = 3.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.743476631545       residual = 4.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.759971909672       residual = 1.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.795493993967       residual = 1.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.735295322456       residual = 3.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.741432530785       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.751120549175       residual = 2.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.764503727731       residual = 1.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.760069134410       residual = 2.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.783087177170       residual = 1.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.758909937567       residual = 1.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.703081262426       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.778224635495       residual = 1.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.742146254435       residual = 1.30e+00           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.724047208580       residual = 1.75e+00           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.742466984091       residual = 1.37e+00           smallest_sin_value = 9.98e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+13 is 2.356211e-18

solving harmonic davidson linear method for identity shift 2.2204e+14, overlap shift 2.2204e+15 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747738205246       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747738205246       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747738205246       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747738205246       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747738205246       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747738205246       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747738205246       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747738202604       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.661789217522       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923086196939       residual = 4.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.326685918708       residual = 1.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.311185382687       residual = 7.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931615248525       residual = 8.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.541419716440       residual = 2.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.713628902004       residual = 2.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.985685567383       residual = 6.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -1.092764971577       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -1.275172696278       residual = 1.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.952382238720       residual = 9.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.538608502813       residual = 2.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.772468048239       residual = 1.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.804252467080       residual = 2.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.497692772929       residual = 7.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.715655813611       residual = 6.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.671209461402       residual = 7.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.889219765320       residual = 4.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.703036882233       residual = 1.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.685179871242       residual = 4.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.959896659442       residual = 2.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.495458252204       residual = 4.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.027222123419       residual = 1.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.820848615495       residual = 1.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.350551504003       residual = 3.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.663828112382       residual = 9.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.652861763223       residual = 2.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.503503578591       residual = 4.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.741302247805       residual = 4.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.694757129536       residual = 2.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.756955216598       residual = 9.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.644926529070       residual = 4.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.779112017513       residual = 4.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.733663119858       residual = 6.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947040669205       residual = 4.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.784240146524       residual = 4.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.796307053914       residual = 5.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.848948423365       residual = 7.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.740818452305       residual = 5.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.854710540009       residual = 5.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.785910599997       residual = 4.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.761692256110       residual = 2.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.829934136514       residual = 2.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.909674998821       residual = 7.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.964674413101       residual = 1.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.567834311080       residual = 2.64e+01           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.839520283246       residual = 3.63e+01           smallest_sin_value = 9.95e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.611146849911       residual = 6.07e+01           smallest_sin_value = 9.95e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+14 is 5.890180e-19

solving harmonic davidson linear method for identity shift 8.8818e+14, overlap shift 8.8818e+15 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747738205246       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747738205246       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747738205246       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747738205246       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747738205246       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747738203663       residual = 5.09e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.682560512588       residual = 2.81e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =       0.514331587339       residual = 1.72e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -2.115406489323       residual = 4.44e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.366797143266       residual = 2.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -1.776976090066       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.206321338337       residual = 2.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.868274486737       residual = 1.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.055651655098       residual = 4.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.191385176856       residual = 5.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.294231944953       residual = 8.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.819628040704       residual = 2.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.892261737888       residual = 3.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912969523498       residual = 2.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.412996450214       residual = 1.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.246847650722       residual = 6.87e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.520970753110       residual = 6.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.807227240246       residual = 4.48e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904100204135       residual = 4.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.038875806125       residual = 9.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       0.586085503935       residual = 7.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.164880422008       residual = 1.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =       1.098006372634       residual = 1.38e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =       3.002167448664       residual = 2.07e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -2.011874417414       residual = 3.83e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       0.824885761511       residual = 9.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.759392403399       residual = 1.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       0.293371011483       residual = 1.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.937100511925       residual = 1.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.236512069825       residual = 9.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       1.690623454438       residual = 3.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.489918671060       residual = 7.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.999225708709       residual = 9.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       0.577189063184       residual = 2.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       0.243936410496       residual = 3.75e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -2.740289425671       residual = 1.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =       0.115204600132       residual = 1.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -2.620904117816       residual = 3.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.178998852137       residual = 1.73e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -1.693682520101       residual = 4.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =       1.545492492502       residual = 9.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.115489010019       residual = 1.72e+02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =       0.755256497304       residual = 2.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.387415578007       residual = 1.37e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.753528774240       residual = 2.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -2.177070805911       residual = 2.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.730667555728       residual = 1.37e+02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.554722978514       residual = 4.40e+02           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =       1.091206671428       residual = 1.28e+02           smallest_sin_value = 9.95e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+14 is 1.453788e-19

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.557391 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0668e+01
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.8524
    reference variance = 0.304127
====================================================
  Execution time = 2.5577e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4698e-01
  Total weights = 1.9644e+06
  Execution time = 3.4931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435269144702
                                         uncertainty =       0.002092359641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435269144702
                                         uncertainty =       0.002092359641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466514118
  error estimate for blocks of size 2^( 2) =       0.000492171513
  error estimate for blocks of size 2^( 3) =       0.000516408133
  error estimate for blocks of size 2^( 4) =       0.000534227763
  error estimate for blocks of size 2^( 5) =       0.000545594987
  error estimate for blocks of size 2^( 6) =       0.000550170266
  error estimate for blocks of size 2^( 7) =       0.000553722271

      target function =      -0.747857603812
              le_mean =     -22.814417786307
             les_mean =     520.944642091494
             stat err =       0.000545928821
             autocorr =       1.369438278082
   target nu stat err =       0.000545928821
   target dn stat err =       0.002565409765
      target stat err =       0.002224142840
              std dev =       0.659750592892
             le_variance =       0.435270844821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435269144702
                                         uncertainty =       0.002092359641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435269144702
                                         uncertainty =       0.002092359641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466514118
  error estimate for blocks of size 2^( 2) =       0.000492171513
  error estimate for blocks of size 2^( 3) =       0.000516408133
  error estimate for blocks of size 2^( 4) =       0.000534227763
  error estimate for blocks of size 2^( 5) =       0.000545594987
  error estimate for blocks of size 2^( 6) =       0.000550170266
  error estimate for blocks of size 2^( 7) =       0.000553722271

      target function =      -0.747857603812
              le_mean =     -22.814417786307
             les_mean =     520.944642091494
             stat err =       0.000545928821
             autocorr =       1.369438278075
   target nu stat err =       0.000545928821
   target dn stat err =       0.002565409765
      target stat err =       0.002224142840
              std dev =       0.659750592892
             le_variance =       0.435270844821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435269144702
                                         uncertainty =       0.002092359641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435269144702
                                         uncertainty =       0.002092359641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466514118
  error estimate for blocks of size 2^( 2) =       0.000492171513
  error estimate for blocks of size 2^( 3) =       0.000516408133
  error estimate for blocks of size 2^( 4) =       0.000534227763
  error estimate for blocks of size 2^( 5) =       0.000545594987
  error estimate for blocks of size 2^( 6) =       0.000550170266
  error estimate for blocks of size 2^( 7) =       0.000553722271

      target function =      -0.747857603812
              le_mean =     -22.814417786307
             les_mean =     520.944642091494
             stat err =       0.000545928821
             autocorr =       1.369438278072
   target nu stat err =       0.000545928821
   target dn stat err =       0.002565409765
      target stat err =       0.002224142840
              std dev =       0.659750592892
             le_variance =       0.435270844821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435269144702
                                         uncertainty =       0.002092359641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435269144702
                                         uncertainty =       0.002092359641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466514118
  error estimate for blocks of size 2^( 2) =       0.000492171513
  error estimate for blocks of size 2^( 3) =       0.000516408133
  error estimate for blocks of size 2^( 4) =       0.000534227763
  error estimate for blocks of size 2^( 5) =       0.000545594987
  error estimate for blocks of size 2^( 6) =       0.000550170266
  error estimate for blocks of size 2^( 7) =       0.000553722271

      target function =      -0.747857603812
              le_mean =     -22.814417786307
             les_mean =     520.944642091494
             stat err =       0.000545928821
             autocorr =       1.369438278075
   target nu stat err =       0.000545928821
   target dn stat err =       0.002565409765
      target stat err =       0.002224142840
              std dev =       0.659750592892
             le_variance =       0.435270844821


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747857603812        initial
     5.5511e+13     5.5511e+14             2.3562e-18        -0.747857603812
     2.2204e+14     2.2204e+15             5.8902e-19        -0.747857603812  <--
     8.8818e+14     8.8818e+15             1.4538e-19        -0.747857603812

*****************************************************************************
Applying the update for shift_i =   2.2204e+14     and shift_s =   2.2204e+15
*****************************************************************************

  Execution time = 4.3072e+01
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3746e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.811
    reference variance = 0.408608
====================================================
  Execution time = 2.5806e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5380e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4821e-01
  Total weights = 1.964274667e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435461344204
                                         uncertainty =       0.001780407919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435461344204
                                         uncertainty =       0.001780407919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466586725
  error estimate for blocks of size 2^( 2) =       0.000491442329
  error estimate for blocks of size 2^( 3) =       0.000515425071
  error estimate for blocks of size 2^( 4) =       0.000533000594
  error estimate for blocks of size 2^( 5) =       0.000544001729
  error estimate for blocks of size 2^( 6) =       0.000550048672
  error estimate for blocks of size 2^( 7) =       0.000553337275

      target function =      -0.746837886228
              le_mean =     -22.814949080991
             les_mean =     520.970110427076
             stat err =       0.000545097068
             autocorr =       1.364843745967
   target nu stat err =       0.000545097068
   target dn stat err =       0.002553330775
      target stat err =       0.002210145691
              std dev =       0.659853275009
             le_variance =       0.435406344540


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281494908099e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+13, overlap shift 5.5511e+14 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746843389310       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746843389310       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746843389310       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746843389310       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745901013914       residual = 4.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746843386841       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749584163116       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.869727773322       residual = 6.85e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.656376387685       residual = 9.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.681133655009       residual = 5.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.858535359890       residual = 6.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.901380905498       residual = 4.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.891249623758       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.769712154397       residual = 3.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.754383934281       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.712824247920       residual = 9.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748224025977       residual = 7.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.703097780152       residual = 5.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.751979304605       residual = 8.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.632646603984       residual = 5.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.654456358420       residual = 7.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.769186649738       residual = 8.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.722053279157       residual = 5.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.755046501927       residual = 3.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.821178365774       residual = 6.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.626615427516       residual = 6.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.824769889979       residual = 1.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.765362078832       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.769113755562       residual = 8.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.774002350158       residual = 4.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.822388115890       residual = 8.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.707117465624       residual = 4.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.724215181175       residual = 8.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.718208587806       residual = 3.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.768297825445       residual = 1.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.808778279397       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.758660858437       residual = 6.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.743038152112       residual = 4.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.813621376192       residual = 8.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.798936085503       residual = 7.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.747189029101       residual = 5.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.812583752389       residual = 1.42e+00           smallest_sin_value = 9.99e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.705549283818       residual = 1.00e+00           smallest_sin_value = 9.99e-01
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.711855131014       residual = 4.41e-01           smallest_sin_value = 9.99e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.729939851095       residual = 7.34e-01           smallest_sin_value = 9.96e-01
davidson iteration   45 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         45 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+13 is 2.493269e-18

solving harmonic davidson linear method for identity shift 2.2204e+14, overlap shift 2.2204e+15 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746843389310       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746843389310       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746843389310       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746843389310       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746843389310       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746843389310       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746843535591       residual = 8.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.767707858248       residual = 3.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.806691191728       residual = 5.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.385671149223       residual = 1.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -1.450317016296       residual = 4.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.610141339943       residual = 5.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.165099702003       residual = 1.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.635514309135       residual = 3.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.423149105981       residual = 2.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.078771817792       residual = 3.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.857747398220       residual = 4.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.703122206889       residual = 4.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.579743650879       residual = 4.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.840052372305       residual = 5.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.670884536445       residual = 3.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.993203749690       residual = 1.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.555557590659       residual = 1.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.711570302242       residual = 3.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.036077819259       residual = 3.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.922417691862       residual = 9.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.622044847002       residual = 1.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.846656259154       residual = 3.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.022953451185       residual = 8.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.586237174372       residual = 1.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.723907496917       residual = 2.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.761837391240       residual = 1.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.726375895022       residual = 4.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.804643234321       residual = 3.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.521570377409       residual = 7.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.668577654718       residual = 7.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.555534180379       residual = 1.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.557291625809       residual = 1.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.724993514563       residual = 1.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.396962351050       residual = 1.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.548427179521       residual = 6.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.892753341393       residual = 5.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.880292433289       residual = 8.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.720497718089       residual = 3.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.645340878361       residual = 3.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.848620855181       residual = 4.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.814580056018       residual = 3.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.742546690901       residual = 1.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.681828600910       residual = 9.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.806512410406       residual = 2.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.649722418331       residual = 1.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.594413074827       residual = 7.91e+00           smallest_sin_value = 9.97e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.659557112353       residual = 4.65e+00           smallest_sin_value = 9.94e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+14 is 6.747176e-19

solving harmonic davidson linear method for identity shift 8.8818e+14, overlap shift 8.8818e+15 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746843389310       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746843389310       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746843389310       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743475660360       residual = 4.44e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.540691542702       residual = 5.14e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.865673922153       residual = 4.73e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -1.013584398983       residual = 7.64e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.663504878404       residual = 8.17e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -3.140455151907       residual = 5.74e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -1.675285052319       residual = 9.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       3.821223246286       residual = 2.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =       0.007793160971       residual = 5.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.701596225398       residual = 6.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -1.673010385533       residual = 8.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.378721070739       residual = 1.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =       0.272262386044       residual = 2.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -1.055045359648       residual = 4.66e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.755720029319       residual = 6.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -1.023945845112       residual = 4.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.973769264971       residual = 5.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.057695200756       residual = 8.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.623178762333       residual = 4.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.952590672270       residual = 8.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.420411679615       residual = 1.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.481200157263       residual = 2.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.353647474120       residual = 5.66e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.564269550985       residual = 8.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.716701883235       residual = 4.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904454187850       residual = 4.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941296646991       residual = 1.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.066096809108       residual = 5.37e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       1.070350384015       residual = 4.73e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.230390341236       residual = 1.59e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.722569237405       residual = 1.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.664271318930       residual = 1.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.042694450976       residual = 2.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -2.080705980819       residual = 4.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.002749989188       residual = 2.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.042740507515       residual = 5.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.634296114218       residual = 7.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -3.876073450569       residual = 4.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =       0.201684358774       residual = 6.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.705732149525       residual = 3.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.030986565957       residual = 9.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.565944217925       residual = 1.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =       0.860568538166       residual = 6.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =       1.482310772109       residual = 4.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.478033517703       residual = 9.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.694482101831       residual = 7.38e+02           smallest_sin_value = 9.98e-01
davidson iteration   49:   krylov dim =  50   tar_fn =       0.014643697758       residual = 1.31e+02           smallest_sin_value = 9.91e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.71e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+14 is 1.435790e-19

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.700057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0439e+01
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.7205
    reference variance = 0.329039
====================================================
  Execution time = 2.7411e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5348e-01
  Total weights = 1.9645e+06
  Execution time = 3.4912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440173962789
                                         uncertainty =       0.002024246621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440173962789
                                         uncertainty =       0.002024246621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469118921
  error estimate for blocks of size 2^( 2) =       0.000494858108
  error estimate for blocks of size 2^( 3) =       0.000518481681
  error estimate for blocks of size 2^( 4) =       0.000536402418
  error estimate for blocks of size 2^( 5) =       0.000548142762
  error estimate for blocks of size 2^( 6) =       0.000555522993
  error estimate for blocks of size 2^( 7) =       0.000559320637

      target function =      -0.742475817547
              le_mean =     -22.815027210028
             les_mean =     520.978944683403
             stat err =       0.000549847203
             autocorr =       1.373783006930
   target nu stat err =       0.000549847203
   target dn stat err =       0.002939711733
      target stat err =       0.002493948445
              std dev =       0.663434340816
             le_variance =       0.440145124575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440173962789
                                         uncertainty =       0.002024246621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440173962789
                                         uncertainty =       0.002024246621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469118921
  error estimate for blocks of size 2^( 2) =       0.000494858108
  error estimate for blocks of size 2^( 3) =       0.000518481681
  error estimate for blocks of size 2^( 4) =       0.000536402418
  error estimate for blocks of size 2^( 5) =       0.000548142762
  error estimate for blocks of size 2^( 6) =       0.000555522993
  error estimate for blocks of size 2^( 7) =       0.000559320637

      target function =      -0.742475817547
              le_mean =     -22.815027210028
             les_mean =     520.978944683403
             stat err =       0.000549847203
             autocorr =       1.373783006934
   target nu stat err =       0.000549847203
   target dn stat err =       0.002939711733
      target stat err =       0.002493948445
              std dev =       0.663434340816
             le_variance =       0.440145124575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440173962789
                                         uncertainty =       0.002024246621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440173962789
                                         uncertainty =       0.002024246621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469118921
  error estimate for blocks of size 2^( 2) =       0.000494858108
  error estimate for blocks of size 2^( 3) =       0.000518481681
  error estimate for blocks of size 2^( 4) =       0.000536402418
  error estimate for blocks of size 2^( 5) =       0.000548142762
  error estimate for blocks of size 2^( 6) =       0.000555522993
  error estimate for blocks of size 2^( 7) =       0.000559320637

      target function =      -0.742475817547
              le_mean =     -22.815027210028
             les_mean =     520.978944683403
             stat err =       0.000549847203
             autocorr =       1.373783006932
   target nu stat err =       0.000549847203
   target dn stat err =       0.002939711733
      target stat err =       0.002493948445
              std dev =       0.663434340816
             le_variance =       0.440145124575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440173962789
                                         uncertainty =       0.002024246621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440173962789
                                         uncertainty =       0.002024246621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469118921
  error estimate for blocks of size 2^( 2) =       0.000494858108
  error estimate for blocks of size 2^( 3) =       0.000518481681
  error estimate for blocks of size 2^( 4) =       0.000536402418
  error estimate for blocks of size 2^( 5) =       0.000548142762
  error estimate for blocks of size 2^( 6) =       0.000555522993
  error estimate for blocks of size 2^( 7) =       0.000559320637

      target function =      -0.742475817547
              le_mean =     -22.815027210028
             les_mean =     520.978944683403
             stat err =       0.000549847203
             autocorr =       1.373783006932
   target nu stat err =       0.000549847203
   target dn stat err =       0.002939711733
      target stat err =       0.002493948445
              std dev =       0.663434340816
             le_variance =       0.440145124575


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742475817547        initial
     5.5511e+13     5.5511e+14             2.4933e-18        -0.742475817547  <--
     2.2204e+14     2.2204e+15             6.7472e-19        -0.742475817547
     8.8818e+14     8.8818e+15             1.4358e-19        -0.742475817547

*****************************************************************************
Applying the update for shift_i =   5.5511e+13     and shift_s =   5.5511e+14
*****************************************************************************

  Execution time = 4.4906e+01
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5351e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.7474
    reference variance = 0.329778
====================================================
  Execution time = 2.5956e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4914e-01
  Total weights = 1.964381327e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5063e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436743156336
                                         uncertainty =       0.002310641381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436743156336
                                         uncertainty =       0.002310641381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467298921
  error estimate for blocks of size 2^( 2) =       0.000492696847
  error estimate for blocks of size 2^( 3) =       0.000516701644
  error estimate for blocks of size 2^( 4) =       0.000534475075
  error estimate for blocks of size 2^( 5) =       0.000545889332
  error estimate for blocks of size 2^( 6) =       0.000551336386
  error estimate for blocks of size 2^( 7) =       0.000556101936

      target function =      -0.746058283858
              le_mean =     -22.813972455220
             les_mean =     520.926483430778
             stat err =       0.000546950682
             autocorr =       1.369956511553
   target nu stat err =       0.000546950682
   target dn stat err =       0.002784453886
      target stat err =       0.002387885666
              std dev =       0.660860471278
             le_variance =       0.436736562498


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281397245522e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+13, overlap shift 1.3878e+14 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746064910082       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746064910082       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746064910082       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746064910082       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to small subspace S singular value of 6.40e-01
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+13 is 8.954442e-18

solving harmonic davidson linear method for identity shift 5.5511e+13, overlap shift 5.5511e+14 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746064910082       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746064910082       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746064910082       residual = 4.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746064910082       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to small subspace S singular value of 6.40e-01
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+13 is 2.377540e-18

solving harmonic davidson linear method for identity shift 2.2204e+14, overlap shift 2.2204e+15 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746064910082       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746064910082       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746064910082       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746064910082       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to small subspace S singular value of 6.40e-01
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+14 is 5.404617e-19

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.701708 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0469e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.835
    reference variance = 0.52381
====================================================
  Execution time = 2.5532e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4309e-01
  Total weights = 1.9645e+06
  Execution time = 3.5012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432292127531
                                         uncertainty =       0.001871441379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432292127531
                                         uncertainty =       0.001871441379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464923898
  error estimate for blocks of size 2^( 2) =       0.000489809015
  error estimate for blocks of size 2^( 3) =       0.000513459335
  error estimate for blocks of size 2^( 4) =       0.000531456223
  error estimate for blocks of size 2^( 5) =       0.000543263523
  error estimate for blocks of size 2^( 6) =       0.000549744708
  error estimate for blocks of size 2^( 7) =       0.000556155241

      target function =      -0.751132026331
              le_mean =     -22.815738499349
             les_mean =     521.001010344009
             stat err =       0.000545154924
             autocorr =       1.374915910125
   target nu stat err =       0.000545154924
   target dn stat err =       0.002178101765
      target stat err =       0.001935043110
              std dev =       0.657501681865
             le_variance =       0.432308461655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432292127531
                                         uncertainty =       0.001871441379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432292127531
                                         uncertainty =       0.001871441379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464923898
  error estimate for blocks of size 2^( 2) =       0.000489809015
  error estimate for blocks of size 2^( 3) =       0.000513459335
  error estimate for blocks of size 2^( 4) =       0.000531456223
  error estimate for blocks of size 2^( 5) =       0.000543263523
  error estimate for blocks of size 2^( 6) =       0.000549744708
  error estimate for blocks of size 2^( 7) =       0.000556155241

      target function =      -0.751132026331
              le_mean =     -22.815738499349
             les_mean =     521.001010344009
             stat err =       0.000545154924
             autocorr =       1.374915910126
   target nu stat err =       0.000545154924
   target dn stat err =       0.002178101765
      target stat err =       0.001935043110
              std dev =       0.657501681865
             le_variance =       0.432308461655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432292127531
                                         uncertainty =       0.001871441379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432292127531
                                         uncertainty =       0.001871441379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464923898
  error estimate for blocks of size 2^( 2) =       0.000489809015
  error estimate for blocks of size 2^( 3) =       0.000513459335
  error estimate for blocks of size 2^( 4) =       0.000531456223
  error estimate for blocks of size 2^( 5) =       0.000543263523
  error estimate for blocks of size 2^( 6) =       0.000549744708
  error estimate for blocks of size 2^( 7) =       0.000556155241

      target function =      -0.751132026331
              le_mean =     -22.815738499349
             les_mean =     521.001010344009
             stat err =       0.000545154924
             autocorr =       1.374915910118
   target nu stat err =       0.000545154924
   target dn stat err =       0.002178101765
      target stat err =       0.001935043110
              std dev =       0.657501681865
             le_variance =       0.432308461655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432292127531
                                         uncertainty =       0.001871441379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432292127531
                                         uncertainty =       0.001871441379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464923898
  error estimate for blocks of size 2^( 2) =       0.000489809015
  error estimate for blocks of size 2^( 3) =       0.000513459335
  error estimate for blocks of size 2^( 4) =       0.000531456223
  error estimate for blocks of size 2^( 5) =       0.000543263523
  error estimate for blocks of size 2^( 6) =       0.000549744708
  error estimate for blocks of size 2^( 7) =       0.000556155241

      target function =      -0.751132026331
              le_mean =     -22.815738499349
             les_mean =     521.001010344009
             stat err =       0.000545154924
             autocorr =       1.374915910125
   target nu stat err =       0.000545154924
   target dn stat err =       0.002178101765
      target stat err =       0.001935043110
              std dev =       0.657501681865
             le_variance =       0.432308461655


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.751132026331        initial
     1.3878e+13     1.3878e+14             8.9544e-18        -0.751132026331
     5.5511e+13     5.5511e+14             2.3775e-18        -0.751132026331
     2.2204e+14     2.2204e+15             5.4046e-19        -0.751132026331  <--

*****************************************************************************
Applying the update for shift_i =   2.2204e+14     and shift_s =   2.2204e+15
*****************************************************************************

  Execution time = 4.3081e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3556e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.8206
    reference variance = 0.626551
====================================================
  Execution time = 2.5928e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4680e-01
  Total weights = 1.964607291e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435137347788
                                         uncertainty =       0.002006515071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435137347788
                                         uncertainty =       0.002006515071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466464660
  error estimate for blocks of size 2^( 2) =       0.000492188442
  error estimate for blocks of size 2^( 3) =       0.000516395575
  error estimate for blocks of size 2^( 4) =       0.000535545915
  error estimate for blocks of size 2^( 5) =       0.000547971084
  error estimate for blocks of size 2^( 6) =       0.000553199837
  error estimate for blocks of size 2^( 7) =       0.000556546577

      target function =      -0.748010772618
              le_mean =     -22.814591147639
             les_mean =     520.952369966574
             stat err =       0.000548315853
             autocorr =       1.381732944960
   target nu stat err =       0.000548315853
   target dn stat err =       0.002480191901
      target stat err =       0.002158040679
              std dev =       0.659680647864
             le_variance =       0.435178557167


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281459114764e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+13, overlap shift 5.5511e+14 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748016010381       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748016010381       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748016010381       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748016010381       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748016010381       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747234249621       residual = 3.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748016010381       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748014213180       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745577619285       residual = 7.78e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740866860521       residual = 7.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.801394827545       residual = 8.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.731397513107       residual = 4.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.778377424707       residual = 2.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742543169230       residual = 6.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.763498006851       residual = 4.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.723788047126       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.767216416684       residual = 7.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.729415019351       residual = 2.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748509762032       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.733536299772       residual = 6.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.766637165043       residual = 3.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.704139146906       residual = 4.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.722783433774       residual = 4.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.759852337321       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.771158541145       residual = 5.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.761566510260       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748468000993       residual = 1.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.752894484780       residual = 5.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.731522213116       residual = 5.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.772066582753       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.781587565029       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.740510340683       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.716461969615       residual = 4.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.765620595876       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.713539827965       residual = 1.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.733042407900       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.745002650388       residual = 9.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.760975596158       residual = 4.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.744957974174       residual = 1.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747458150701       residual = 2.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.724568602473       residual = 7.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.730817863554       residual = 5.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.741640655998       residual = 1.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.741055060146       residual = 1.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.710239430360       residual = 2.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.776328417019       residual = 2.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.755388854699       residual = 2.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.751931094787       residual = 2.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.773547082467       residual = 2.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.790310467588       residual = 2.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.741591068004       residual = 2.63e+00           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.764926939892       residual = 6.24e-02           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.696262939355       residual = 2.90e-01           smallest_sin_value = 9.91e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+13 is 3.651511e-18

solving harmonic davidson linear method for identity shift 2.2204e+14, overlap shift 2.2204e+15 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748016010381       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748016010381       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748016010381       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748016010381       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to small subspace S singular value of 6.62e-01
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+14 is 4.305007e-19

solving harmonic davidson linear method for identity shift 8.8818e+14, overlap shift 8.8818e+15 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748016010381       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748016010381       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748016010381       residual = 1.42e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.509017105620       residual = 5.15e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748016010408       residual = 2.14e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.637216912392       residual = 8.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -1.314142359287       residual = 4.51e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.047161600178       residual = 2.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.601339430512       residual = 1.55e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880259011713       residual = 8.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -3.324505192998       residual = 6.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -2.764160479945       residual = 3.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.356278998114       residual = 5.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       0.046695736222       residual = 6.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =       0.404550106808       residual = 1.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.351244658062       residual = 2.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =       0.108471055104       residual = 1.96e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =       0.206291806081       residual = 1.46e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -1.250887433426       residual = 2.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.918753640375       residual = 3.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.036500783028       residual = 8.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.681908608280       residual = 3.85e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -2.691181392989       residual = 1.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.667892674754       residual = 5.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.122996710371       residual = 6.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.222293250219       residual = 3.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.705934824349       residual = 4.61e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.245388498950       residual = 9.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.637806713941       residual = 2.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       0.302126606013       residual = 1.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.250504235463       residual = 1.32e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.094744970873       residual = 3.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       0.258846943139       residual = 1.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.674048190080       residual = 2.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       1.021587848802       residual = 5.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.218519686243       residual = 2.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.396909975433       residual = 3.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.037730475545       residual = 1.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.440542440052       residual = 1.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.028063846568       residual = 2.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.864147121285       residual = 1.06e+02           smallest_sin_value = 9.99e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.538475161558       residual = 1.83e+02           smallest_sin_value = 9.98e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.483046928514       residual = 6.18e+01           smallest_sin_value = 9.97e-01
davidson iteration   43 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         43 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+14 is 1.033076e-19

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.792541 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0514e+01
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.7838
    reference variance = 0.727019
====================================================
  Execution time = 2.7440e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4554e-01
  Total weights = 1.9642e+06
  Execution time = 3.4632e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432474336030
                                         uncertainty =       0.001992551658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432474336030
                                         uncertainty =       0.001992551658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464977864
  error estimate for blocks of size 2^( 2) =       0.000490707996
  error estimate for blocks of size 2^( 3) =       0.000514882105
  error estimate for blocks of size 2^( 4) =       0.000532284824
  error estimate for blocks of size 2^( 5) =       0.000544076978
  error estimate for blocks of size 2^( 6) =       0.000550716149
  error estimate for blocks of size 2^( 7) =       0.000556248307

      target function =      -0.749059788338
              le_mean =     -22.813970302881
             les_mean =     520.922779278736
             stat err =       0.000545831564
             autocorr =       1.378011166909
   target nu stat err =       0.000545831564
   target dn stat err =       0.002951323045
      target stat err =       0.002541395792
              std dev =       0.657578001126
             le_variance =       0.432408827565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432474336030
                                         uncertainty =       0.001992551658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432474336030
                                         uncertainty =       0.001992551658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464977864
  error estimate for blocks of size 2^( 2) =       0.000490707996
  error estimate for blocks of size 2^( 3) =       0.000514882105
  error estimate for blocks of size 2^( 4) =       0.000532284824
  error estimate for blocks of size 2^( 5) =       0.000544076978
  error estimate for blocks of size 2^( 6) =       0.000550716149
  error estimate for blocks of size 2^( 7) =       0.000556248307

      target function =      -0.749059788338
              le_mean =     -22.813970302881
             les_mean =     520.922779278736
             stat err =       0.000545831564
             autocorr =       1.378011166910
   target nu stat err =       0.000545831564
   target dn stat err =       0.002951323045
      target stat err =       0.002541395792
              std dev =       0.657578001126
             le_variance =       0.432408827565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432474336030
                                         uncertainty =       0.001992551658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432474336030
                                         uncertainty =       0.001992551658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464977864
  error estimate for blocks of size 2^( 2) =       0.000490707996
  error estimate for blocks of size 2^( 3) =       0.000514882105
  error estimate for blocks of size 2^( 4) =       0.000532284824
  error estimate for blocks of size 2^( 5) =       0.000544076978
  error estimate for blocks of size 2^( 6) =       0.000550716149
  error estimate for blocks of size 2^( 7) =       0.000556248307

      target function =      -0.749059788338
              le_mean =     -22.813970302881
             les_mean =     520.922779278736
             stat err =       0.000545831564
             autocorr =       1.378011166910
   target nu stat err =       0.000545831564
   target dn stat err =       0.002951323045
      target stat err =       0.002541395792
              std dev =       0.657578001126
             le_variance =       0.432408827565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432474336030
                                         uncertainty =       0.001992551658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432474336030
                                         uncertainty =       0.001992551658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464977864
  error estimate for blocks of size 2^( 2) =       0.000490707996
  error estimate for blocks of size 2^( 3) =       0.000514882105
  error estimate for blocks of size 2^( 4) =       0.000532284824
  error estimate for blocks of size 2^( 5) =       0.000544076978
  error estimate for blocks of size 2^( 6) =       0.000550716149
  error estimate for blocks of size 2^( 7) =       0.000556248307

      target function =      -0.749059788338
              le_mean =     -22.813970302881
             les_mean =     520.922779278736
             stat err =       0.000545831564
             autocorr =       1.378011166909
   target nu stat err =       0.000545831564
   target dn stat err =       0.002951323045
      target stat err =       0.002541395792
              std dev =       0.657578001126
             le_variance =       0.432408827565


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749059788338        initial
     5.5511e+13     5.5511e+14             3.6515e-18        -0.749059788338
     2.2204e+14     2.2204e+15             4.3050e-19        -0.749059788338
     8.8818e+14     8.8818e+15             1.0331e-19        -0.749059788338  <--

*****************************************************************************
Applying the update for shift_i =   8.8818e+14     and shift_s =   8.8818e+15
*****************************************************************************

  Execution time = 4.4795e+01
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5315e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.7787
    reference variance = 0.3478
====================================================
  Execution time = 2.5816e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5374e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5067e-01
  Total weights = 1.964410383e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4591e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436958802231
                                         uncertainty =       0.001745446130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436958802231
                                         uncertainty =       0.001745446130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467453276
  error estimate for blocks of size 2^( 2) =       0.000492232930
  error estimate for blocks of size 2^( 3) =       0.000516346153
  error estimate for blocks of size 2^( 4) =       0.000533922829
  error estimate for blocks of size 2^( 5) =       0.000543641053
  error estimate for blocks of size 2^( 6) =       0.000550597357
  error estimate for blocks of size 2^( 7) =       0.000551500058

      target function =      -0.744791365147
              le_mean =     -22.814217417537
             les_mean =     520.939190943525
             stat err =       0.000544915324
             autocorr =       1.358881629079
   target nu stat err =       0.000544915324
   target dn stat err =       0.002750418007
      target stat err =       0.002353132298
              std dev =       0.661078762792
             le_variance =       0.437025130614


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281421741754e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+14, overlap shift 2.2204e+15 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744797818352       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744797818352       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 8.8818e+14, overlap shift 8.8818e+15 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744797818352       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744797818352       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.5527e+15, overlap shift 3.5527e+16 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744797818352       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744797818352       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.793608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0281e+01
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.8451
    reference variance = 0.274154
====================================================
  Execution time = 2.5379e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5355e-01
  Total weights = 1.9642e+06
  Execution time = 3.4663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438581412475
                                         uncertainty =       0.002294426715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438581412475
                                         uncertainty =       0.002294426715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468297825
  error estimate for blocks of size 2^( 2) =       0.000493530627
  error estimate for blocks of size 2^( 3) =       0.000517734985
  error estimate for blocks of size 2^( 4) =       0.000535556311
  error estimate for blocks of size 2^( 5) =       0.000546255588
  error estimate for blocks of size 2^( 6) =       0.000555630370
  error estimate for blocks of size 2^( 7) =       0.000557986094

      target function =      -0.742413952027
              le_mean =     -22.813736935076
             les_mean =     520.920145408705
             stat err =       0.000548857091
             autocorr =       1.373644262893
   target nu stat err =       0.000548857091
   target dn stat err =       0.003964432959
      target stat err =       0.003310715050
              std dev =       0.662273135741
             le_variance =       0.438605706324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438581412475
                                         uncertainty =       0.002294426715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438581412475
                                         uncertainty =       0.002294426715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468297825
  error estimate for blocks of size 2^( 2) =       0.000493530627
  error estimate for blocks of size 2^( 3) =       0.000517734985
  error estimate for blocks of size 2^( 4) =       0.000535556311
  error estimate for blocks of size 2^( 5) =       0.000546255588
  error estimate for blocks of size 2^( 6) =       0.000555630370
  error estimate for blocks of size 2^( 7) =       0.000557986094

      target function =      -0.742413952027
              le_mean =     -22.813736935076
             les_mean =     520.920145408705
             stat err =       0.000548857091
             autocorr =       1.373644262899
   target nu stat err =       0.000548857091
   target dn stat err =       0.003964432959
      target stat err =       0.003310715050
              std dev =       0.662273135741
             le_variance =       0.438605706324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438581412475
                                         uncertainty =       0.002294426715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438581412475
                                         uncertainty =       0.002294426715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468297825
  error estimate for blocks of size 2^( 2) =       0.000493530627
  error estimate for blocks of size 2^( 3) =       0.000517734985
  error estimate for blocks of size 2^( 4) =       0.000535556311
  error estimate for blocks of size 2^( 5) =       0.000546255588
  error estimate for blocks of size 2^( 6) =       0.000555630370
  error estimate for blocks of size 2^( 7) =       0.000557986094

      target function =      -0.742413952027
              le_mean =     -22.813736935076
             les_mean =     520.920145408705
             stat err =       0.000548857091
             autocorr =       1.373644262899
   target nu stat err =       0.000548857091
   target dn stat err =       0.003964432959
      target stat err =       0.003310715050
              std dev =       0.662273135741
             le_variance =       0.438605706324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438581412475
                                         uncertainty =       0.002294426715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438581412475
                                         uncertainty =       0.002294426715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468297825
  error estimate for blocks of size 2^( 2) =       0.000493530627
  error estimate for blocks of size 2^( 3) =       0.000517734985
  error estimate for blocks of size 2^( 4) =       0.000535556311
  error estimate for blocks of size 2^( 5) =       0.000546255588
  error estimate for blocks of size 2^( 6) =       0.000555630370
  error estimate for blocks of size 2^( 7) =       0.000557986094

      target function =      -0.742413952027
              le_mean =     -22.813736935076
             les_mean =     520.920145408705
             stat err =       0.000548857091
             autocorr =       1.373644262899
   target nu stat err =       0.000548857091
   target dn stat err =       0.003964432959
      target stat err =       0.003310715050
              std dev =       0.662273135741
             le_variance =       0.438605706324


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742413952027        initial  <--
     2.2204e+14     2.2204e+15             0.0000e+00        -0.742413952027
     8.8818e+14     8.8818e+15             0.0000e+00        -0.742413952027
     3.5527e+15     3.5527e+16             0.0000e+00        -0.742413952027

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7534
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3072e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.7813
    reference variance = 0.348511
====================================================
  Execution time = 2.6090e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4439e-01
  Total weights = 1.964388946e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4529e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432232596021
                                         uncertainty =       0.001791725496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432232596021
                                         uncertainty =       0.001791725496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464855581
  error estimate for blocks of size 2^( 2) =       0.000489811336
  error estimate for blocks of size 2^( 3) =       0.000512979300
  error estimate for blocks of size 2^( 4) =       0.000530680085
  error estimate for blocks of size 2^( 5) =       0.000542728106
  error estimate for blocks of size 2^( 6) =       0.000549520658
  error estimate for blocks of size 2^( 7) =       0.000553650735

      target function =      -0.750035419254
              le_mean =     -22.815405664325
             les_mean =     520.987122323579
             stat err =       0.000544144896
             autocorr =       1.370228581766
   target nu stat err =       0.000544144896
   target dn stat err =       0.002470859487
      target stat err =       0.002163068371
              std dev =       0.657405066533
             le_variance =       0.432181421503


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281540566433e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+15, overlap shift 2.2204e+16 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750040601943       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750040601943       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 8.8818e+15, overlap shift 8.8818e+16 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750040601943       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750040601943       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.5527e+16, overlap shift 3.5527e+17 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750040601943       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750040601943       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.794663 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0549e+01
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.8169
    reference variance = 0.281767
====================================================
  Execution time = 2.7162e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4961e-01
  Total weights = 1.9644e+06
  Execution time = 3.4699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434311710203
                                         uncertainty =       0.002076144626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434311710203
                                         uncertainty =       0.002076144626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465967138
  error estimate for blocks of size 2^( 2) =       0.000491631949
  error estimate for blocks of size 2^( 3) =       0.000515616566
  error estimate for blocks of size 2^( 4) =       0.000533299981
  error estimate for blocks of size 2^( 5) =       0.000543550411
  error estimate for blocks of size 2^( 6) =       0.000548161818
  error estimate for blocks of size 2^( 7) =       0.000552233554

      target function =      -0.745662518850
              le_mean =     -22.815147412171
             les_mean =     520.980558116634
             stat err =       0.000544311441
             autocorr =       1.364533955640
   target nu stat err =       0.000544311441
   target dn stat err =       0.004606910262
      target stat err =       0.003870979900
              std dev =       0.658977046130
             le_variance =       0.434250747326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434311710203
                                         uncertainty =       0.002076144626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434311710203
                                         uncertainty =       0.002076144626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465967138
  error estimate for blocks of size 2^( 2) =       0.000491631949
  error estimate for blocks of size 2^( 3) =       0.000515616566
  error estimate for blocks of size 2^( 4) =       0.000533299981
  error estimate for blocks of size 2^( 5) =       0.000543550411
  error estimate for blocks of size 2^( 6) =       0.000548161818
  error estimate for blocks of size 2^( 7) =       0.000552233554

      target function =      -0.745662518850
              le_mean =     -22.815147412171
             les_mean =     520.980558116634
             stat err =       0.000544311441
             autocorr =       1.364533955640
   target nu stat err =       0.000544311441
   target dn stat err =       0.004606910262
      target stat err =       0.003870979900
              std dev =       0.658977046130
             le_variance =       0.434250747326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434311710203
                                         uncertainty =       0.002076144626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434311710203
                                         uncertainty =       0.002076144626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465967138
  error estimate for blocks of size 2^( 2) =       0.000491631949
  error estimate for blocks of size 2^( 3) =       0.000515616566
  error estimate for blocks of size 2^( 4) =       0.000533299981
  error estimate for blocks of size 2^( 5) =       0.000543550411
  error estimate for blocks of size 2^( 6) =       0.000548161818
  error estimate for blocks of size 2^( 7) =       0.000552233554

      target function =      -0.745662518850
              le_mean =     -22.815147412171
             les_mean =     520.980558116634
             stat err =       0.000544311441
             autocorr =       1.364533955640
   target nu stat err =       0.000544311441
   target dn stat err =       0.004606910262
      target stat err =       0.003870979900
              std dev =       0.658977046130
             le_variance =       0.434250747326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434311710203
                                         uncertainty =       0.002076144626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434311710203
                                         uncertainty =       0.002076144626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465967138
  error estimate for blocks of size 2^( 2) =       0.000491631949
  error estimate for blocks of size 2^( 3) =       0.000515616566
  error estimate for blocks of size 2^( 4) =       0.000533299981
  error estimate for blocks of size 2^( 5) =       0.000543550411
  error estimate for blocks of size 2^( 6) =       0.000548161818
  error estimate for blocks of size 2^( 7) =       0.000552233554

      target function =      -0.745662518850
              le_mean =     -22.815147412171
             les_mean =     520.980558116634
             stat err =       0.000544311441
             autocorr =       1.364533955640
   target nu stat err =       0.000544311441
   target dn stat err =       0.004606910262
      target stat err =       0.003870979900
              std dev =       0.658977046130
             le_variance =       0.434250747326


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745662518850        initial  <--
     2.2204e+15     2.2204e+16             0.0000e+00        -0.745662518850
     8.8818e+15     8.8818e+16             0.0000e+00        -0.745662518850
     3.5527e+16     3.5527e+17             0.0000e+00        -0.745662518850

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5838
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5139e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.8098
    reference variance = 0.417459
====================================================
  Execution time = 2.6144e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5326e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4912e-01
  Total weights = 1.964090648e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437679248591
                                         uncertainty =       0.002094613232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437679248591
                                         uncertainty =       0.002094613232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467806736
  error estimate for blocks of size 2^( 2) =       0.000493167264
  error estimate for blocks of size 2^( 3) =       0.000517124040
  error estimate for blocks of size 2^( 4) =       0.000534537987
  error estimate for blocks of size 2^( 5) =       0.000544628796
  error estimate for blocks of size 2^( 6) =       0.000550188855
  error estimate for blocks of size 2^( 7) =       0.000553503327

      target function =      -0.746081039447
              le_mean =     -22.815009128133
             les_mean =     520.973760083659
             stat err =       0.000545714741
             autocorr =       1.360812933436
   target nu stat err =       0.000545714741
   target dn stat err =       0.002654113360
      target stat err =       0.002286819916
              std dev =       0.661578631132
             le_variance =       0.437686285170


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281500912813e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+16, overlap shift 2.2204e+17 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746087038108       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746087038108       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.30e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 8.8818e+16, overlap shift 8.8818e+17 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746087038108       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746087038108       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.29e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.5527e+17, overlap shift 3.5527e+18 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746087038108       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746087038108       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.795741 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0675e+01
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.7297
    reference variance = 0.975235
====================================================
  Execution time = 2.5494e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4798e-01
  Total weights = 1.9642e+06
  Execution time = 3.4715e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436086431442
                                         uncertainty =       0.002372552994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436086431442
                                         uncertainty =       0.002372552994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466901985
  error estimate for blocks of size 2^( 2) =       0.000492377057
  error estimate for blocks of size 2^( 3) =       0.000516110359
  error estimate for blocks of size 2^( 4) =       0.000533536183
  error estimate for blocks of size 2^( 5) =       0.000544140468
  error estimate for blocks of size 2^( 6) =       0.000551739785
  error estimate for blocks of size 2^( 7) =       0.000554014520

      target function =      -0.747027879282
              le_mean =     -22.814566445849
             les_mean =     520.952418965173
             stat err =       0.000545857739
             autocorr =       1.366807971713
   target nu stat err =       0.000545857739
   target dn stat err =       0.003014640165
      target stat err =       0.002581457817
              std dev =       0.660299119320
             le_variance =       0.435994926974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436086431442
                                         uncertainty =       0.002372552994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436086431442
                                         uncertainty =       0.002372552994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466901985
  error estimate for blocks of size 2^( 2) =       0.000492377057
  error estimate for blocks of size 2^( 3) =       0.000516110359
  error estimate for blocks of size 2^( 4) =       0.000533536183
  error estimate for blocks of size 2^( 5) =       0.000544140468
  error estimate for blocks of size 2^( 6) =       0.000551739785
  error estimate for blocks of size 2^( 7) =       0.000554014520

      target function =      -0.747027879282
              le_mean =     -22.814566445849
             les_mean =     520.952418965173
             stat err =       0.000545857739
             autocorr =       1.366807971707
   target nu stat err =       0.000545857739
   target dn stat err =       0.003014640165
      target stat err =       0.002581457817
              std dev =       0.660299119320
             le_variance =       0.435994926974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436086431442
                                         uncertainty =       0.002372552994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436086431442
                                         uncertainty =       0.002372552994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466901985
  error estimate for blocks of size 2^( 2) =       0.000492377057
  error estimate for blocks of size 2^( 3) =       0.000516110359
  error estimate for blocks of size 2^( 4) =       0.000533536183
  error estimate for blocks of size 2^( 5) =       0.000544140468
  error estimate for blocks of size 2^( 6) =       0.000551739785
  error estimate for blocks of size 2^( 7) =       0.000554014520

      target function =      -0.747027879282
              le_mean =     -22.814566445849
             les_mean =     520.952418965173
             stat err =       0.000545857739
             autocorr =       1.366807971707
   target nu stat err =       0.000545857739
   target dn stat err =       0.003014640165
      target stat err =       0.002581457817
              std dev =       0.660299119320
             le_variance =       0.435994926974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436086431442
                                         uncertainty =       0.002372552994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436086431442
                                         uncertainty =       0.002372552994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466901985
  error estimate for blocks of size 2^( 2) =       0.000492377057
  error estimate for blocks of size 2^( 3) =       0.000516110359
  error estimate for blocks of size 2^( 4) =       0.000533536183
  error estimate for blocks of size 2^( 5) =       0.000544140468
  error estimate for blocks of size 2^( 6) =       0.000551739785
  error estimate for blocks of size 2^( 7) =       0.000554014520

      target function =      -0.747027879282
              le_mean =     -22.814566445849
             les_mean =     520.952418965173
             stat err =       0.000545857739
             autocorr =       1.366807971707
   target nu stat err =       0.000545857739
   target dn stat err =       0.003014640165
      target stat err =       0.002581457817
              std dev =       0.660299119320
             le_variance =       0.435994926974


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747027879282        initial  <--
     2.2204e+16     2.2204e+17             0.0000e+00        -0.747027879282
     8.8818e+16     8.8818e+17             0.0000e+00        -0.747027879282
     3.5527e+17     3.5527e+18             0.0000e+00        -0.747027879282

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8959
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3576e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.8036
    reference variance = 0.547334
====================================================
  Execution time = 2.5927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4965e-01
  Total weights = 1.964252825e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437761364054
                                         uncertainty =       0.002715657943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437761364054
                                         uncertainty =       0.002715657943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467821392
  error estimate for blocks of size 2^( 2) =       0.000493355247
  error estimate for blocks of size 2^( 3) =       0.000516953157
  error estimate for blocks of size 2^( 4) =       0.000534758562
  error estimate for blocks of size 2^( 5) =       0.000544856364
  error estimate for blocks of size 2^( 6) =       0.000552033851
  error estimate for blocks of size 2^( 7) =       0.000553010843

      target function =      -0.745636709905
              le_mean =     -22.814931109865
             les_mean =     520.970732152306
             stat err =       0.000546164905
             autocorr =       1.362973543487
   target nu stat err =       0.000546164905
   target dn stat err =       0.003166912576
      target stat err =       0.002696514650
              std dev =       0.661599357959
             le_variance =       0.437713710452


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281493110987e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+17, overlap shift 2.2204e+18 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745645410843       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745645410843       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.08e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 8.8818e+17, overlap shift 8.8818e+18 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745645410843       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745645410843       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.08e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.5527e+18, overlap shift 3.5527e+19 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745645410843       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745645410843       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.796798 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0458e+01
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.703
    reference variance = 0.543529
====================================================
  Execution time = 2.7494e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4750e-01
  Total weights = 1.9645e+06
  Execution time = 3.4775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435365721522
                                         uncertainty =       0.001769368853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435365721522
                                         uncertainty =       0.001769368853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466575198
  error estimate for blocks of size 2^( 2) =       0.000492280893
  error estimate for blocks of size 2^( 3) =       0.000516330091
  error estimate for blocks of size 2^( 4) =       0.000534846607
  error estimate for blocks of size 2^( 5) =       0.000547731720
  error estimate for blocks of size 2^( 6) =       0.000555520949
  error estimate for blocks of size 2^( 7) =       0.000559031289

      target function =      -0.747431172376
              le_mean =     -22.814549752151
             les_mean =     520.951175722228
             stat err =       0.000549282642
             autocorr =       1.385952837859
   target nu stat err =       0.000549282642
   target dn stat err =       0.002551578815
      target stat err =       0.002212091174
              std dev =       0.659836972402
             le_variance =       0.435384830149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435365721522
                                         uncertainty =       0.001769368853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435365721522
                                         uncertainty =       0.001769368853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466575198
  error estimate for blocks of size 2^( 2) =       0.000492280893
  error estimate for blocks of size 2^( 3) =       0.000516330091
  error estimate for blocks of size 2^( 4) =       0.000534846607
  error estimate for blocks of size 2^( 5) =       0.000547731720
  error estimate for blocks of size 2^( 6) =       0.000555520949
  error estimate for blocks of size 2^( 7) =       0.000559031289

      target function =      -0.747431172376
              le_mean =     -22.814549752151
             les_mean =     520.951175722228
             stat err =       0.000549282642
             autocorr =       1.385952837859
   target nu stat err =       0.000549282642
   target dn stat err =       0.002551578815
      target stat err =       0.002212091174
              std dev =       0.659836972402
             le_variance =       0.435384830149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435365721522
                                         uncertainty =       0.001769368853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435365721522
                                         uncertainty =       0.001769368853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466575198
  error estimate for blocks of size 2^( 2) =       0.000492280893
  error estimate for blocks of size 2^( 3) =       0.000516330091
  error estimate for blocks of size 2^( 4) =       0.000534846607
  error estimate for blocks of size 2^( 5) =       0.000547731720
  error estimate for blocks of size 2^( 6) =       0.000555520949
  error estimate for blocks of size 2^( 7) =       0.000559031289

      target function =      -0.747431172376
              le_mean =     -22.814549752151
             les_mean =     520.951175722228
             stat err =       0.000549282642
             autocorr =       1.385952837859
   target nu stat err =       0.000549282642
   target dn stat err =       0.002551578815
      target stat err =       0.002212091174
              std dev =       0.659836972402
             le_variance =       0.435384830149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435365721522
                                         uncertainty =       0.001769368853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435365721522
                                         uncertainty =       0.001769368853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466575198
  error estimate for blocks of size 2^( 2) =       0.000492280893
  error estimate for blocks of size 2^( 3) =       0.000516330091
  error estimate for blocks of size 2^( 4) =       0.000534846607
  error estimate for blocks of size 2^( 5) =       0.000547731720
  error estimate for blocks of size 2^( 6) =       0.000555520949
  error estimate for blocks of size 2^( 7) =       0.000559031289

      target function =      -0.747431172376
              le_mean =     -22.814549752151
             les_mean =     520.951175722228
             stat err =       0.000549282642
             autocorr =       1.385952837859
   target nu stat err =       0.000549282642
   target dn stat err =       0.002551578815
      target stat err =       0.002212091174
              std dev =       0.659836972402
             le_variance =       0.435384830149


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747431172376        initial  <--
     2.2204e+17     2.2204e+18             0.0000e+00        -0.747431172376
     8.8818e+17     8.8818e+18             0.0000e+00        -0.747431172376
     3.5527e+18     3.5527e+19             0.0000e+00        -0.747431172376

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8888
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5352e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.8415
    reference variance = 0.391222
====================================================
  Execution time = 2.5902e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5320e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5183e-01
  Total weights = 1.964297539e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436665299896
                                         uncertainty =       0.002573582855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436665299896
                                         uncertainty =       0.002573582855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467250491
  error estimate for blocks of size 2^( 2) =       0.000492602693
  error estimate for blocks of size 2^( 3) =       0.000516635253
  error estimate for blocks of size 2^( 4) =       0.000534650828
  error estimate for blocks of size 2^( 5) =       0.000546490379
  error estimate for blocks of size 2^( 6) =       0.000553367253
  error estimate for blocks of size 2^( 7) =       0.000558978741

      target function =      -0.743824111196
              le_mean =     -22.815068921913
             les_mean =     520.979199574148
             stat err =       0.000548371800
             autocorr =       1.377370238077
   target nu stat err =       0.000548371800
   target dn stat err =       0.004436104604
      target stat err =       0.003713201225
              std dev =       0.660791980978
             le_variance =       0.436646042125


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281506892191e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+18, overlap shift 2.2204e+19 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743841623490       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743841623490       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+18, overlap shift 8.8818e+19 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743841623490       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743841623490       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+19, overlap shift 3.5527e+20 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743841623490       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743841623490       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.797903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0427e+01
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.7672
    reference variance = 0.341913
====================================================
  Execution time = 2.5416e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4637e-01
  Total weights = 1.9644e+06
  Execution time = 3.4738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434322903233
                                         uncertainty =       0.002179409917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434322903233
                                         uncertainty =       0.002179409917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465973632
  error estimate for blocks of size 2^( 2) =       0.000491794625
  error estimate for blocks of size 2^( 3) =       0.000515884695
  error estimate for blocks of size 2^( 4) =       0.000534118802
  error estimate for blocks of size 2^( 5) =       0.000545356013
  error estimate for blocks of size 2^( 6) =       0.000551600031
  error estimate for blocks of size 2^( 7) =       0.000555919924

      target function =      -0.748368195025
              le_mean =     -22.815290473035
             les_mean =     520.983851617563
             stat err =       0.000546748693
             autocorr =       1.376742824991
   target nu stat err =       0.000546748693
   target dn stat err =       0.003006936555
      target stat err =       0.002587246999
              std dev =       0.658986230588
             le_variance =       0.434262852105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434322903233
                                         uncertainty =       0.002179409917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434322903233
                                         uncertainty =       0.002179409917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465973632
  error estimate for blocks of size 2^( 2) =       0.000491794625
  error estimate for blocks of size 2^( 3) =       0.000515884695
  error estimate for blocks of size 2^( 4) =       0.000534118802
  error estimate for blocks of size 2^( 5) =       0.000545356013
  error estimate for blocks of size 2^( 6) =       0.000551600031
  error estimate for blocks of size 2^( 7) =       0.000555919924

      target function =      -0.748368195025
              le_mean =     -22.815290473035
             les_mean =     520.983851617563
             stat err =       0.000546748693
             autocorr =       1.376742824991
   target nu stat err =       0.000546748693
   target dn stat err =       0.003006936555
      target stat err =       0.002587246999
              std dev =       0.658986230588
             le_variance =       0.434262852105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434322903233
                                         uncertainty =       0.002179409917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434322903233
                                         uncertainty =       0.002179409917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465973632
  error estimate for blocks of size 2^( 2) =       0.000491794625
  error estimate for blocks of size 2^( 3) =       0.000515884695
  error estimate for blocks of size 2^( 4) =       0.000534118802
  error estimate for blocks of size 2^( 5) =       0.000545356013
  error estimate for blocks of size 2^( 6) =       0.000551600031
  error estimate for blocks of size 2^( 7) =       0.000555919924

      target function =      -0.748368195025
              le_mean =     -22.815290473035
             les_mean =     520.983851617563
             stat err =       0.000546748693
             autocorr =       1.376742824991
   target nu stat err =       0.000546748693
   target dn stat err =       0.003006936555
      target stat err =       0.002587246999
              std dev =       0.658986230588
             le_variance =       0.434262852105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434322903233
                                         uncertainty =       0.002179409917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434322903233
                                         uncertainty =       0.002179409917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465973632
  error estimate for blocks of size 2^( 2) =       0.000491794625
  error estimate for blocks of size 2^( 3) =       0.000515884695
  error estimate for blocks of size 2^( 4) =       0.000534118802
  error estimate for blocks of size 2^( 5) =       0.000545356013
  error estimate for blocks of size 2^( 6) =       0.000551600031
  error estimate for blocks of size 2^( 7) =       0.000555919924

      target function =      -0.748368195025
              le_mean =     -22.815290473035
             les_mean =     520.983851617563
             stat err =       0.000546748693
             autocorr =       1.376742824991
   target nu stat err =       0.000546748693
   target dn stat err =       0.003006936555
      target stat err =       0.002587246999
              std dev =       0.658986230588
             le_variance =       0.434262852105


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748368195025        initial  <--
     2.2204e+18     2.2204e+19             0.0000e+00        -0.748368195025
     8.8818e+18     8.8818e+19             0.0000e+00        -0.748368195025
     3.5527e+19     3.5527e+20             0.0000e+00        -0.748368195025

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8531
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3296e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.7799
    reference variance = 0.291234
====================================================
  Execution time = 2.5778e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4812e-01
  Total weights = 1.964512636e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436152640989
                                         uncertainty =       0.002339666593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436152640989
                                         uncertainty =       0.002339666593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466957383
  error estimate for blocks of size 2^( 2) =       0.000492701156
  error estimate for blocks of size 2^( 3) =       0.000516858351
  error estimate for blocks of size 2^( 4) =       0.000533925170
  error estimate for blocks of size 2^( 5) =       0.000545027741
  error estimate for blocks of size 2^( 6) =       0.000551517974
  error estimate for blocks of size 2^( 7) =       0.000554449047

      target function =      -0.746906304895
              le_mean =     -22.814453989608
             les_mean =     520.947432741970
             stat err =       0.000546229983
             autocorr =       1.368348053203
   target nu stat err =       0.000546229983
   target dn stat err =       0.003113442987
      target stat err =       0.002660246418
              std dev =       0.660377463418
             le_variance =       0.436098394191


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281445398961e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+19, overlap shift 2.2204e+20 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746914933245       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746914933245       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+19, overlap shift 8.8818e+20 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746914933245       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746914933245       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+20, overlap shift 3.5527e+21 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746914933245       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746914933245       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.799010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0297e+01
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.8216
    reference variance = 0.610529
====================================================
  Execution time = 2.7262e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4699e-01
  Total weights = 1.9642e+06
  Execution time = 3.4698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432307093967
                                         uncertainty =       0.001706822126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432307093967
                                         uncertainty =       0.001706822126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465074358
  error estimate for blocks of size 2^( 2) =       0.000490359773
  error estimate for blocks of size 2^( 3) =       0.000513938357
  error estimate for blocks of size 2^( 4) =       0.000531189342
  error estimate for blocks of size 2^( 5) =       0.000542091201
  error estimate for blocks of size 2^( 6) =       0.000547133877
  error estimate for blocks of size 2^( 7) =       0.000550603331

      target function =      -0.747848965866
              le_mean =     -22.813819416939
             les_mean =     520.917343422133
             stat err =       0.000542754438
             autocorr =       1.361952548012
   target nu stat err =       0.000542754438
   target dn stat err =       0.003117581114
      target stat err =       0.002666744935
              std dev =       0.657714464187
             le_variance =       0.432588316401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432307093967
                                         uncertainty =       0.001706822126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432307093967
                                         uncertainty =       0.001706822126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465074358
  error estimate for blocks of size 2^( 2) =       0.000490359773
  error estimate for blocks of size 2^( 3) =       0.000513938357
  error estimate for blocks of size 2^( 4) =       0.000531189342
  error estimate for blocks of size 2^( 5) =       0.000542091201
  error estimate for blocks of size 2^( 6) =       0.000547133877
  error estimate for blocks of size 2^( 7) =       0.000550603331

      target function =      -0.747848965866
              le_mean =     -22.813819416939
             les_mean =     520.917343422133
             stat err =       0.000542754438
             autocorr =       1.361952548011
   target nu stat err =       0.000542754438
   target dn stat err =       0.003117581114
      target stat err =       0.002666744935
              std dev =       0.657714464187
             le_variance =       0.432588316401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432307093967
                                         uncertainty =       0.001706822126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432307093967
                                         uncertainty =       0.001706822126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465074358
  error estimate for blocks of size 2^( 2) =       0.000490359773
  error estimate for blocks of size 2^( 3) =       0.000513938357
  error estimate for blocks of size 2^( 4) =       0.000531189342
  error estimate for blocks of size 2^( 5) =       0.000542091201
  error estimate for blocks of size 2^( 6) =       0.000547133877
  error estimate for blocks of size 2^( 7) =       0.000550603331

      target function =      -0.747848965866
              le_mean =     -22.813819416939
             les_mean =     520.917343422133
             stat err =       0.000542754438
             autocorr =       1.361952548011
   target nu stat err =       0.000542754438
   target dn stat err =       0.003117581114
      target stat err =       0.002666744935
              std dev =       0.657714464187
             le_variance =       0.432588316401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432307093967
                                         uncertainty =       0.001706822126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432307093967
                                         uncertainty =       0.001706822126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465074358
  error estimate for blocks of size 2^( 2) =       0.000490359773
  error estimate for blocks of size 2^( 3) =       0.000513938357
  error estimate for blocks of size 2^( 4) =       0.000531189342
  error estimate for blocks of size 2^( 5) =       0.000542091201
  error estimate for blocks of size 2^( 6) =       0.000547133877
  error estimate for blocks of size 2^( 7) =       0.000550603331

      target function =      -0.747848965866
              le_mean =     -22.813819416939
             les_mean =     520.917343422133
             stat err =       0.000542754438
             autocorr =       1.361952548011
   target nu stat err =       0.000542754438
   target dn stat err =       0.003117581114
      target stat err =       0.002666744935
              std dev =       0.657714464187
             le_variance =       0.432588316401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747848965866        initial  <--
     2.2204e+19     2.2204e+20             0.0000e+00        -0.747848965866
     8.8818e+19     8.8818e+20             0.0000e+00        -0.747848965866
     3.5527e+20     3.5527e+21             0.0000e+00        -0.747848965866

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6861
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4989e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.7964
    reference variance = 1.92546
====================================================
  Execution time = 2.5867e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4302e-01
  Total weights = 1.964215313e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4619e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430851075017
                                         uncertainty =       0.001791135596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430851075017
                                         uncertainty =       0.001791135596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464209982
  error estimate for blocks of size 2^( 2) =       0.000489603149
  error estimate for blocks of size 2^( 3) =       0.000513686237
  error estimate for blocks of size 2^( 4) =       0.000531131463
  error estimate for blocks of size 2^( 5) =       0.000543392127
  error estimate for blocks of size 2^( 6) =       0.000548422067
  error estimate for blocks of size 2^( 7) =       0.000553842823

      target function =      -0.751184617954
              le_mean =     -22.814965360446
             les_mean =     520.965662479270
             stat err =       0.000544197120
             autocorr =       1.374306271191
   target nu stat err =       0.000544197120
   target dn stat err =       0.002212579706
      target stat err =       0.001960296989
              std dev =       0.656492052040
             le_variance =       0.430981814392


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281496536045e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+20, overlap shift 2.2204e+21 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751188752634       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751188752634       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+20, overlap shift 8.8818e+21 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751188752634       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751188752634       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+21, overlap shift 3.5527e+22 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751188752634       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751188752634       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.800096 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0335e+01
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.8984
    reference variance = 0.44442
====================================================
  Execution time = 2.5439e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4884e-01
  Total weights = 1.9643e+06
  Execution time = 3.4768e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436971253578
                                         uncertainty =       0.005731060828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436971253578
                                         uncertainty =       0.005731060828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467396986
  error estimate for blocks of size 2^( 2) =       0.000492542098
  error estimate for blocks of size 2^( 3) =       0.000516625603
  error estimate for blocks of size 2^( 4) =       0.000535676876
  error estimate for blocks of size 2^( 5) =       0.000545774053
  error estimate for blocks of size 2^( 6) =       0.000554508717
  error estimate for blocks of size 2^( 7) =       0.000557617253

      target function =      -0.746290237423
              le_mean =     -22.815200785964
             les_mean =     520.982227709888
             stat err =       0.000548394225
             autocorr =       1.376619539727
   target nu stat err =       0.000548394225
   target dn stat err =       0.005480146121
      target stat err =       0.004596832989
              std dev =       0.660999157135
             le_variance =       0.436919885733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436971253578
                                         uncertainty =       0.005731060828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436971253578
                                         uncertainty =       0.005731060828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467396986
  error estimate for blocks of size 2^( 2) =       0.000492542098
  error estimate for blocks of size 2^( 3) =       0.000516625603
  error estimate for blocks of size 2^( 4) =       0.000535676876
  error estimate for blocks of size 2^( 5) =       0.000545774053
  error estimate for blocks of size 2^( 6) =       0.000554508717
  error estimate for blocks of size 2^( 7) =       0.000557617253

      target function =      -0.746290237423
              le_mean =     -22.815200785964
             les_mean =     520.982227709888
             stat err =       0.000548394225
             autocorr =       1.376619539727
   target nu stat err =       0.000548394225
   target dn stat err =       0.005480146121
      target stat err =       0.004596832989
              std dev =       0.660999157135
             le_variance =       0.436919885733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436971253578
                                         uncertainty =       0.005731060828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436971253578
                                         uncertainty =       0.005731060828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467396986
  error estimate for blocks of size 2^( 2) =       0.000492542098
  error estimate for blocks of size 2^( 3) =       0.000516625603
  error estimate for blocks of size 2^( 4) =       0.000535676876
  error estimate for blocks of size 2^( 5) =       0.000545774053
  error estimate for blocks of size 2^( 6) =       0.000554508717
  error estimate for blocks of size 2^( 7) =       0.000557617253

      target function =      -0.746290237423
              le_mean =     -22.815200785964
             les_mean =     520.982227709888
             stat err =       0.000548394225
             autocorr =       1.376619539727
   target nu stat err =       0.000548394225
   target dn stat err =       0.005480146121
      target stat err =       0.004596832989
              std dev =       0.660999157135
             le_variance =       0.436919885733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436971253578
                                         uncertainty =       0.005731060828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436971253578
                                         uncertainty =       0.005731060828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467396986
  error estimate for blocks of size 2^( 2) =       0.000492542098
  error estimate for blocks of size 2^( 3) =       0.000516625603
  error estimate for blocks of size 2^( 4) =       0.000535676876
  error estimate for blocks of size 2^( 5) =       0.000545774053
  error estimate for blocks of size 2^( 6) =       0.000554508717
  error estimate for blocks of size 2^( 7) =       0.000557617253

      target function =      -0.746290237423
              le_mean =     -22.815200785964
             les_mean =     520.982227709888
             stat err =       0.000548394225
             autocorr =       1.376619539727
   target nu stat err =       0.000548394225
   target dn stat err =       0.005480146121
      target stat err =       0.004596832989
              std dev =       0.660999157135
             le_variance =       0.436919885733


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746290237423        initial  <--
     2.2204e+20     2.2204e+21             0.0000e+00        -0.746290237423
     8.8818e+20     8.8818e+21             0.0000e+00        -0.746290237423
     3.5527e+21     3.5527e+22             0.0000e+00        -0.746290237423

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8339
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3175e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.8942
    reference variance = 0.862479
====================================================
  Execution time = 2.5977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5373e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5049e-01
  Total weights = 1.964585781e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438557867747
                                         uncertainty =       0.002388092296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438557867747
                                         uncertainty =       0.002388092296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468251736
  error estimate for blocks of size 2^( 2) =       0.000493617340
  error estimate for blocks of size 2^( 3) =       0.000517629108
  error estimate for blocks of size 2^( 4) =       0.000535508995
  error estimate for blocks of size 2^( 5) =       0.000547113711
  error estimate for blocks of size 2^( 6) =       0.000551973464
  error estimate for blocks of size 2^( 7) =       0.000553564641

      target function =      -0.744942844021
              le_mean =     -22.813883089269
             les_mean =     520.923752170130
             stat err =       0.000547040203
             autocorr =       1.364833572427
   target nu stat err =       0.000547040203
   target dn stat err =       0.002892389090
      target stat err =       0.002467079894
              std dev =       0.662207955573
             le_variance =       0.438519376425


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281388308927e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+21, overlap shift 2.2204e+22 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744950045126       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744950045126       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744950045126       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744950045126       residual = 9.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744950044798       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+21 is 6.450410e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+21, overlap shift 8.8818e+22 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744950045126       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744950045126       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744950045126       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+21 is 9.509387e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+22, overlap shift 3.5527e+23 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744950045126       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744950045126       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744950045126       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+22 is 2.377347e-27

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.801631 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0453e+01
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.8617
    reference variance = 0.397442
====================================================
  Execution time = 2.7367e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4628e-01
  Total weights = 1.9641e+06
  Execution time = 3.4717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434659088534
                                         uncertainty =       0.002070329987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434659088534
                                         uncertainty =       0.002070329987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466206428
  error estimate for blocks of size 2^( 2) =       0.000491601969
  error estimate for blocks of size 2^( 3) =       0.000515593934
  error estimate for blocks of size 2^( 4) =       0.000533873195
  error estimate for blocks of size 2^( 5) =       0.000543429257
  error estimate for blocks of size 2^( 6) =       0.000548833842
  error estimate for blocks of size 2^( 7) =       0.000552145472

      target function =      -0.748442230878
              le_mean =     -22.814560154913
             les_mean =     520.950437881763
             stat err =       0.000544570441
             autocorr =       1.364431116315
   target nu stat err =       0.000544570441
   target dn stat err =       0.002646454892
      target stat err =       0.002292758125
              std dev =       0.659315453186
             le_variance =       0.434696866810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434659088534
                                         uncertainty =       0.002070329987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434659088534
                                         uncertainty =       0.002070329987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466206428
  error estimate for blocks of size 2^( 2) =       0.000491601969
  error estimate for blocks of size 2^( 3) =       0.000515593934
  error estimate for blocks of size 2^( 4) =       0.000533873195
  error estimate for blocks of size 2^( 5) =       0.000543429257
  error estimate for blocks of size 2^( 6) =       0.000548833842
  error estimate for blocks of size 2^( 7) =       0.000552145472

      target function =      -0.748442230878
              le_mean =     -22.814560154913
             les_mean =     520.950437881763
             stat err =       0.000544570441
             autocorr =       1.364431116321
   target nu stat err =       0.000544570441
   target dn stat err =       0.002646454892
      target stat err =       0.002292758125
              std dev =       0.659315453186
             le_variance =       0.434696866810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434659088534
                                         uncertainty =       0.002070329987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434659088534
                                         uncertainty =       0.002070329987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466206428
  error estimate for blocks of size 2^( 2) =       0.000491601969
  error estimate for blocks of size 2^( 3) =       0.000515593934
  error estimate for blocks of size 2^( 4) =       0.000533873195
  error estimate for blocks of size 2^( 5) =       0.000543429257
  error estimate for blocks of size 2^( 6) =       0.000548833842
  error estimate for blocks of size 2^( 7) =       0.000552145472

      target function =      -0.748442230878
              le_mean =     -22.814560154913
             les_mean =     520.950437881763
             stat err =       0.000544570441
             autocorr =       1.364431116321
   target nu stat err =       0.000544570441
   target dn stat err =       0.002646454892
      target stat err =       0.002292758125
              std dev =       0.659315453186
             le_variance =       0.434696866810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434659088534
                                         uncertainty =       0.002070329987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434659088534
                                         uncertainty =       0.002070329987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466206428
  error estimate for blocks of size 2^( 2) =       0.000491601969
  error estimate for blocks of size 2^( 3) =       0.000515593934
  error estimate for blocks of size 2^( 4) =       0.000533873195
  error estimate for blocks of size 2^( 5) =       0.000543429257
  error estimate for blocks of size 2^( 6) =       0.000548833842
  error estimate for blocks of size 2^( 7) =       0.000552145472

      target function =      -0.748442230878
              le_mean =     -22.814560154913
             les_mean =     520.950437881763
             stat err =       0.000544570441
             autocorr =       1.364431116321
   target nu stat err =       0.000544570441
   target dn stat err =       0.002646454892
      target stat err =       0.002292758125
              std dev =       0.659315453186
             le_variance =       0.434696866810


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748442230878        initial  <--
     2.2204e+21     2.2204e+22             6.4504e-26        -0.748442230878
     8.8818e+21     8.8818e+22             9.5094e-27        -0.748442230878
     3.5527e+22     3.5527e+23             2.3773e-27        -0.748442230878

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7941
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5253e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.7707
    reference variance = 0.62678
====================================================
  Execution time = 2.5903e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5090e-01
  Total weights = 1.964275497e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436321056539
                                         uncertainty =       0.002179118021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436321056539
                                         uncertainty =       0.002179118021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467190853
  error estimate for blocks of size 2^( 2) =       0.000492701547
  error estimate for blocks of size 2^( 3) =       0.000516341261
  error estimate for blocks of size 2^( 4) =       0.000534722260
  error estimate for blocks of size 2^( 5) =       0.000545881065
  error estimate for blocks of size 2^( 6) =       0.000552312258
  error estimate for blocks of size 2^( 7) =       0.000556307253

      target function =      -0.744602051202
              le_mean =     -22.814812189133
             les_mean =     520.966555905729
             stat err =       0.000547305709
             autocorr =       1.372370249076
   target nu stat err =       0.000547305709
   target dn stat err =       0.003047115576
      target stat err =       0.002592609263
              std dev =       0.660707640332
             le_variance =       0.436534585993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281481218913e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+22, overlap shift 2.2204e+23 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744610059722       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744610059722       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744610059722       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744610059722       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744610059182       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+22 is 7.699805e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+22, overlap shift 8.8818e+23 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744610059722       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744610059722       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744610059722       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744610059722       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744610059722       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744610059643       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744503310252       residual = 2.53e+07           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+22 is 2.088618e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+23, overlap shift 3.5527e+24 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744610059722       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744610059722       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744610059722       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744610059722       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744610059722       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+23 is 4.812378e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.803824 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0411e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.8925
    reference variance = 0.517676
====================================================
  Execution time = 2.5327e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5492e-01
  Total weights = 1.9643e+06
  Execution time = 3.4720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441272035244
                                         uncertainty =       0.004424627977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441272035244
                                         uncertainty =       0.004424627977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469700513
  error estimate for blocks of size 2^( 2) =       0.000494835243
  error estimate for blocks of size 2^( 3) =       0.000518404824
  error estimate for blocks of size 2^( 4) =       0.000537260393
  error estimate for blocks of size 2^( 5) =       0.000548997650
  error estimate for blocks of size 2^( 6) =       0.000556003662
  error estimate for blocks of size 2^( 7) =       0.000558151329

      target function =      -0.741274699478
              le_mean =     -22.815375451930
             les_mean =     520.996275398954
             stat err =       0.000550103258
             autocorr =       1.371659658257
   target nu stat err =       0.000550103258
   target dn stat err =       0.005065182483
      target stat err =       0.004200077835
              std dev =       0.664256835782
             le_variance =       0.441237143882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441272035244
                                         uncertainty =       0.004424627977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441272035244
                                         uncertainty =       0.004424627977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469700513
  error estimate for blocks of size 2^( 2) =       0.000494835243
  error estimate for blocks of size 2^( 3) =       0.000518404824
  error estimate for blocks of size 2^( 4) =       0.000537260393
  error estimate for blocks of size 2^( 5) =       0.000548997650
  error estimate for blocks of size 2^( 6) =       0.000556003662
  error estimate for blocks of size 2^( 7) =       0.000558151329

      target function =      -0.741274699478
              le_mean =     -22.815375451930
             les_mean =     520.996275398954
             stat err =       0.000550103258
             autocorr =       1.371659658258
   target nu stat err =       0.000550103258
   target dn stat err =       0.005065182483
      target stat err =       0.004200077835
              std dev =       0.664256835782
             le_variance =       0.441237143882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441272035244
                                         uncertainty =       0.004424627977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441272035244
                                         uncertainty =       0.004424627977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469700513
  error estimate for blocks of size 2^( 2) =       0.000494835243
  error estimate for blocks of size 2^( 3) =       0.000518404824
  error estimate for blocks of size 2^( 4) =       0.000537260393
  error estimate for blocks of size 2^( 5) =       0.000548997650
  error estimate for blocks of size 2^( 6) =       0.000556003662
  error estimate for blocks of size 2^( 7) =       0.000558151329

      target function =      -0.741274699478
              le_mean =     -22.815375451930
             les_mean =     520.996275398954
             stat err =       0.000550103258
             autocorr =       1.371659658258
   target nu stat err =       0.000550103258
   target dn stat err =       0.005065182483
      target stat err =       0.004200077835
              std dev =       0.664256835782
             le_variance =       0.441237143882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441272035244
                                         uncertainty =       0.004424627977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441272035244
                                         uncertainty =       0.004424627977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469700513
  error estimate for blocks of size 2^( 2) =       0.000494835243
  error estimate for blocks of size 2^( 3) =       0.000518404824
  error estimate for blocks of size 2^( 4) =       0.000537260393
  error estimate for blocks of size 2^( 5) =       0.000548997650
  error estimate for blocks of size 2^( 6) =       0.000556003662
  error estimate for blocks of size 2^( 7) =       0.000558151329

      target function =      -0.741274699478
              le_mean =     -22.815375451930
             les_mean =     520.996275398954
             stat err =       0.000550103258
             autocorr =       1.371659658258
   target nu stat err =       0.000550103258
   target dn stat err =       0.005065182483
      target stat err =       0.004200077835
              std dev =       0.664256835782
             le_variance =       0.441237143882


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741274699478        initial  <--
     2.2204e+22     2.2204e+23             7.6998e-27        -0.741274699478
     8.8818e+22     8.8818e+23             2.0886e-27        -0.741274699478
     3.5527e+23     3.5527e+24             4.8124e-28        -0.741274699478

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7330
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3159e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.8028
    reference variance = 1.30593
====================================================
  Execution time = 2.5826e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5372e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6215e-01
  Total weights = 1.964539927e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5015e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439647260842
                                         uncertainty =       0.004512086495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439647260842
                                         uncertainty =       0.004512086495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468854443
  error estimate for blocks of size 2^( 2) =       0.000493732647
  error estimate for blocks of size 2^( 3) =       0.000518055432
  error estimate for blocks of size 2^( 4) =       0.000536583542
  error estimate for blocks of size 2^( 5) =       0.000547902955
  error estimate for blocks of size 2^( 6) =       0.000554713385
  error estimate for blocks of size 2^( 7) =       0.000557276801

      target function =      -0.735296537014
              le_mean =     -22.814141540172
             les_mean =     520.947206122359
             stat err =       0.000549119171
             autocorr =       1.371693687243
   target nu stat err =       0.000549119171
   target dn stat err =       0.012246772806
      target stat err =       0.009888035151
              std dev =       0.663060312276
             le_variance =       0.439648977715


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281414154017e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+23, overlap shift 2.2204e+24 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735428719780       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735428719780       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735428719780       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+23 is 1.692703e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+23, overlap shift 8.8818e+24 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735428719780       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735428719780       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735428719780       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+23 is 4.231758e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+24, overlap shift 3.5527e+25 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735428719780       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735428719780       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735428719780       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735428847826       residual = 6.62e+07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735428719779       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+24 is 1.775470e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.805388 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0335e+01
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.7528
    reference variance = 0.311951
====================================================
  Execution time = 2.7226e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5131e-01
  Total weights = 1.9645e+06
  Execution time = 3.4704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437648829380
                                         uncertainty =       0.002090493710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437648829380
                                         uncertainty =       0.002090493710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467764032
  error estimate for blocks of size 2^( 2) =       0.000493226937
  error estimate for blocks of size 2^( 3) =       0.000517542054
  error estimate for blocks of size 2^( 4) =       0.000535336455
  error estimate for blocks of size 2^( 5) =       0.000547362449
  error estimate for blocks of size 2^( 6) =       0.000553764581
  error estimate for blocks of size 2^( 7) =       0.000555590143

      target function =      -0.744267744420
              le_mean =     -22.814644330752
             les_mean =     520.959301020649
             stat err =       0.000548013407
             autocorr =       1.372551722983
   target nu stat err =       0.000548013407
   target dn stat err =       0.003112270828
      target stat err =       0.002642236354
              std dev =       0.661518237373
             le_variance =       0.437606378377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437648829380
                                         uncertainty =       0.002090493710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437648829380
                                         uncertainty =       0.002090493710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467764032
  error estimate for blocks of size 2^( 2) =       0.000493226937
  error estimate for blocks of size 2^( 3) =       0.000517542054
  error estimate for blocks of size 2^( 4) =       0.000535336455
  error estimate for blocks of size 2^( 5) =       0.000547362449
  error estimate for blocks of size 2^( 6) =       0.000553764581
  error estimate for blocks of size 2^( 7) =       0.000555590143

      target function =      -0.744267744420
              le_mean =     -22.814644330752
             les_mean =     520.959301020649
             stat err =       0.000548013407
             autocorr =       1.372551722985
   target nu stat err =       0.000548013407
   target dn stat err =       0.003112270828
      target stat err =       0.002642236354
              std dev =       0.661518237373
             le_variance =       0.437606378377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437648829380
                                         uncertainty =       0.002090493710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437648829380
                                         uncertainty =       0.002090493710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467764032
  error estimate for blocks of size 2^( 2) =       0.000493226937
  error estimate for blocks of size 2^( 3) =       0.000517542054
  error estimate for blocks of size 2^( 4) =       0.000535336455
  error estimate for blocks of size 2^( 5) =       0.000547362449
  error estimate for blocks of size 2^( 6) =       0.000553764581
  error estimate for blocks of size 2^( 7) =       0.000555590143

      target function =      -0.744267744420
              le_mean =     -22.814644330752
             les_mean =     520.959301020649
             stat err =       0.000548013407
             autocorr =       1.372551722985
   target nu stat err =       0.000548013407
   target dn stat err =       0.003112270828
      target stat err =       0.002642236354
              std dev =       0.661518237373
             le_variance =       0.437606378377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437648829380
                                         uncertainty =       0.002090493710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437648829380
                                         uncertainty =       0.002090493710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467764032
  error estimate for blocks of size 2^( 2) =       0.000493226937
  error estimate for blocks of size 2^( 3) =       0.000517542054
  error estimate for blocks of size 2^( 4) =       0.000535336455
  error estimate for blocks of size 2^( 5) =       0.000547362449
  error estimate for blocks of size 2^( 6) =       0.000553764581
  error estimate for blocks of size 2^( 7) =       0.000555590143

      target function =      -0.744267744420
              le_mean =     -22.814644330752
             les_mean =     520.959301020649
             stat err =       0.000548013407
             autocorr =       1.372551722985
   target nu stat err =       0.000548013407
   target dn stat err =       0.003112270828
      target stat err =       0.002642236354
              std dev =       0.661518237373
             le_variance =       0.437606378377


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744267744420        initial  <--
     2.2204e+23     2.2204e+24             1.6927e-27        -0.744267744420
     8.8818e+23     8.8818e+24             4.2318e-28        -0.744267744420
     3.5527e+24     3.5527e+25             1.7755e-28        -0.744267744420

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6077
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4948e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.8168
    reference variance = 0.635289
====================================================
  Execution time = 2.5891e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5254e-01
  Total weights = 1.964488433e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437415966125
                                         uncertainty =       0.002559493720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437415966125
                                         uncertainty =       0.002559493720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467682644
  error estimate for blocks of size 2^( 2) =       0.000493137773
  error estimate for blocks of size 2^( 3) =       0.000517417750
  error estimate for blocks of size 2^( 4) =       0.000534731993
  error estimate for blocks of size 2^( 5) =       0.000545845136
  error estimate for blocks of size 2^( 6) =       0.000553619545
  error estimate for blocks of size 2^( 7) =       0.000556987083

      target function =      -0.743241399266
              le_mean =     -22.814867683357
             les_mean =     520.970732230658
             stat err =       0.000547795939
             autocorr =       1.371939974345
   target nu stat err =       0.000547795939
   target dn stat err =       0.003555296586
      target stat err =       0.002992462739
              std dev =       0.661403138064
             le_variance =       0.437454111040


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281486768336e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+24, overlap shift 2.2204e+25 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743252405264       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743252405264       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+24, overlap shift 8.8818e+25 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743252405264       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743252405264       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+25, overlap shift 3.5527e+26 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743252405264       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743252405264       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.806454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0356e+01
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.8538
    reference variance = 0.370281
====================================================
  Execution time = 2.5308e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4524e-01
  Total weights = 1.9647e+06
  Execution time = 3.4705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433213376744
                                         uncertainty =       0.001855423919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433213376744
                                         uncertainty =       0.001855423919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465400723
  error estimate for blocks of size 2^( 2) =       0.000490906953
  error estimate for blocks of size 2^( 3) =       0.000515131235
  error estimate for blocks of size 2^( 4) =       0.000534109051
  error estimate for blocks of size 2^( 5) =       0.000545641716
  error estimate for blocks of size 2^( 6) =       0.000551647343
  error estimate for blocks of size 2^( 7) =       0.000555967377

      target function =      -0.749317503413
              le_mean =     -22.814494627577
             les_mean =     520.946402817410
             stat err =       0.000546841372
             autocorr =       1.380602389169
   target nu stat err =       0.000546841372
   target dn stat err =       0.002313417901
      target stat err =       0.002030938096
              std dev =       0.658176014743
             le_variance =       0.433195666383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433213376744
                                         uncertainty =       0.001855423919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433213376744
                                         uncertainty =       0.001855423919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465400723
  error estimate for blocks of size 2^( 2) =       0.000490906953
  error estimate for blocks of size 2^( 3) =       0.000515131235
  error estimate for blocks of size 2^( 4) =       0.000534109051
  error estimate for blocks of size 2^( 5) =       0.000545641716
  error estimate for blocks of size 2^( 6) =       0.000551647343
  error estimate for blocks of size 2^( 7) =       0.000555967377

      target function =      -0.749317503413
              le_mean =     -22.814494627577
             les_mean =     520.946402817410
             stat err =       0.000546841372
             autocorr =       1.380602389169
   target nu stat err =       0.000546841372
   target dn stat err =       0.002313417901
      target stat err =       0.002030938096
              std dev =       0.658176014743
             le_variance =       0.433195666383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433213376744
                                         uncertainty =       0.001855423919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433213376744
                                         uncertainty =       0.001855423919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465400723
  error estimate for blocks of size 2^( 2) =       0.000490906953
  error estimate for blocks of size 2^( 3) =       0.000515131235
  error estimate for blocks of size 2^( 4) =       0.000534109051
  error estimate for blocks of size 2^( 5) =       0.000545641716
  error estimate for blocks of size 2^( 6) =       0.000551647343
  error estimate for blocks of size 2^( 7) =       0.000555967377

      target function =      -0.749317503413
              le_mean =     -22.814494627577
             les_mean =     520.946402817410
             stat err =       0.000546841372
             autocorr =       1.380602389169
   target nu stat err =       0.000546841372
   target dn stat err =       0.002313417901
      target stat err =       0.002030938096
              std dev =       0.658176014743
             le_variance =       0.433195666383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433213376744
                                         uncertainty =       0.001855423919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433213376744
                                         uncertainty =       0.001855423919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465400723
  error estimate for blocks of size 2^( 2) =       0.000490906953
  error estimate for blocks of size 2^( 3) =       0.000515131235
  error estimate for blocks of size 2^( 4) =       0.000534109051
  error estimate for blocks of size 2^( 5) =       0.000545641716
  error estimate for blocks of size 2^( 6) =       0.000551647343
  error estimate for blocks of size 2^( 7) =       0.000555967377

      target function =      -0.749317503413
              le_mean =     -22.814494627577
             les_mean =     520.946402817410
             stat err =       0.000546841372
             autocorr =       1.380602389169
   target nu stat err =       0.000546841372
   target dn stat err =       0.002313417901
      target stat err =       0.002030938096
              std dev =       0.658176014743
             le_variance =       0.433195666383


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749317503413        initial  <--
     2.2204e+24     2.2204e+25             0.0000e+00        -0.749317503413
     8.8818e+24     8.8818e+25             0.0000e+00        -0.749317503413
     3.5527e+25     3.5527e+26             0.0000e+00        -0.749317503413

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7096
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3071e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.8246
    reference variance = 0.451097
====================================================
  Execution time = 2.5982e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5358e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5092e-01
  Total weights = 1.964372365e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437720114918
                                         uncertainty =       0.002118764158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437720114918
                                         uncertainty =       0.002118764158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467785003
  error estimate for blocks of size 2^( 2) =       0.000492935873
  error estimate for blocks of size 2^( 3) =       0.000516566519
  error estimate for blocks of size 2^( 4) =       0.000534610886
  error estimate for blocks of size 2^( 5) =       0.000546495241
  error estimate for blocks of size 2^( 6) =       0.000551206378
  error estimate for blocks of size 2^( 7) =       0.000557591328

      target function =      -0.744587451570
              le_mean =     -22.814189359706
             les_mean =     520.938155990758
             stat err =       0.000547475958
             autocorr =       1.369738036882
   target nu stat err =       0.000547475958
   target dn stat err =       0.002979245359
      target stat err =       0.002535663481
              std dev =       0.661547895455
             le_variance =       0.437645617981


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281418935971e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+25, overlap shift 2.2204e+26 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744595099216       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744595099216       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744595099216       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+25 is 5.586466e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+25, overlap shift 8.8818e+26 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744595099216       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744595099216       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744595099215       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+25 is 1.396617e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+26, overlap shift 3.5527e+27 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744595099216       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744595099216       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744595099215       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+26 is 3.491541e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.807804 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0580e+01
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.7627
    reference variance = 0.322085
====================================================
  Execution time = 2.6205e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4552e-01
  Total weights = 1.9647e+06
  Execution time = 3.7978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434823059039
                                         uncertainty =       0.002299974891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434823059039
                                         uncertainty =       0.002299974891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466242091
  error estimate for blocks of size 2^( 2) =       0.000492034446
  error estimate for blocks of size 2^( 3) =       0.000515719272
  error estimate for blocks of size 2^( 4) =       0.000533372616
  error estimate for blocks of size 2^( 5) =       0.000544587198
  error estimate for blocks of size 2^( 6) =       0.000550546708
  error estimate for blocks of size 2^( 7) =       0.000554136305

      target function =      -0.749077092941
              le_mean =     -22.814383357028
             les_mean =     520.941611502925
             stat err =       0.000545660707
             autocorr =       1.369690382899
   target nu stat err =       0.000545660707
   target dn stat err =       0.002422782269
      target stat err =       0.002116405769
              std dev =       0.659365888494
             le_variance =       0.434763374910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434823059039
                                         uncertainty =       0.002299974891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434823059039
                                         uncertainty =       0.002299974891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466242091
  error estimate for blocks of size 2^( 2) =       0.000492034446
  error estimate for blocks of size 2^( 3) =       0.000515719272
  error estimate for blocks of size 2^( 4) =       0.000533372616
  error estimate for blocks of size 2^( 5) =       0.000544587198
  error estimate for blocks of size 2^( 6) =       0.000550546708
  error estimate for blocks of size 2^( 7) =       0.000554136305

      target function =      -0.749077092941
              le_mean =     -22.814383357028
             les_mean =     520.941611502925
             stat err =       0.000545660707
             autocorr =       1.369690382899
   target nu stat err =       0.000545660707
   target dn stat err =       0.002422782269
      target stat err =       0.002116405769
              std dev =       0.659365888494
             le_variance =       0.434763374910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434823059039
                                         uncertainty =       0.002299974891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434823059039
                                         uncertainty =       0.002299974891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466242091
  error estimate for blocks of size 2^( 2) =       0.000492034446
  error estimate for blocks of size 2^( 3) =       0.000515719272
  error estimate for blocks of size 2^( 4) =       0.000533372616
  error estimate for blocks of size 2^( 5) =       0.000544587198
  error estimate for blocks of size 2^( 6) =       0.000550546708
  error estimate for blocks of size 2^( 7) =       0.000554136305

      target function =      -0.749077092941
              le_mean =     -22.814383357028
             les_mean =     520.941611502925
             stat err =       0.000545660707
             autocorr =       1.369690382899
   target nu stat err =       0.000545660707
   target dn stat err =       0.002422782269
      target stat err =       0.002116405769
              std dev =       0.659365888494
             le_variance =       0.434763374910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434823059039
                                         uncertainty =       0.002299974891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434823059039
                                         uncertainty =       0.002299974891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466242091
  error estimate for blocks of size 2^( 2) =       0.000492034446
  error estimate for blocks of size 2^( 3) =       0.000515719272
  error estimate for blocks of size 2^( 4) =       0.000533372616
  error estimate for blocks of size 2^( 5) =       0.000544587198
  error estimate for blocks of size 2^( 6) =       0.000550546708
  error estimate for blocks of size 2^( 7) =       0.000554136305

      target function =      -0.749077092941
              le_mean =     -22.814383357028
             les_mean =     520.941611502925
             stat err =       0.000545660707
             autocorr =       1.369690382899
   target nu stat err =       0.000545660707
   target dn stat err =       0.002422782269
      target stat err =       0.002116405769
              std dev =       0.659365888494
             le_variance =       0.434763374910


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749077092941        initial  <--
     2.2204e+25     2.2204e+26             5.5865e-30        -0.749077092941
     8.8818e+25     8.8818e+26             1.3966e-30        -0.749077092941
     3.5527e+26     3.5527e+27             3.4915e-31        -0.749077092941

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9572
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4543e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.8324
    reference variance = 0.856369
====================================================
  Execution time = 2.5953e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5335e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4701e-01
  Total weights = 1.964221577e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434190029801
                                         uncertainty =       0.002823012811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434190029801
                                         uncertainty =       0.002823012811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465968417
  error estimate for blocks of size 2^( 2) =       0.000491738631
  error estimate for blocks of size 2^( 3) =       0.000516041510
  error estimate for blocks of size 2^( 4) =       0.000533166055
  error estimate for blocks of size 2^( 5) =       0.000544538799
  error estimate for blocks of size 2^( 6) =       0.000551224119
  error estimate for blocks of size 2^( 7) =       0.000554280630

      target function =      -0.747834118903
              le_mean =     -22.814657748099
             les_mean =     520.955616047632
             stat err =       0.000545802401
             autocorr =       1.372012034184
   target nu stat err =       0.000545802401
   target dn stat err =       0.003235416863
      target stat err =       0.002766543918
              std dev =       0.658978854715
             le_variance =       0.434253130961


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281465774810e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+26, overlap shift 2.2204e+27 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747843408696       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747843408696       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+26, overlap shift 8.8818e+27 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747843408696       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747843408696       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+27, overlap shift 3.5527e+28 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747843408696       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747843408696       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.808928 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0466e+01
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.8596
    reference variance = 0.306536
====================================================
  Execution time = 2.5555e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4824e-01
  Total weights = 1.9643e+06
  Execution time = 3.4752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434185281113
                                         uncertainty =       0.002015168205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434185281113
                                         uncertainty =       0.002015168205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465919785
  error estimate for blocks of size 2^( 2) =       0.000491216231
  error estimate for blocks of size 2^( 3) =       0.000515599536
  error estimate for blocks of size 2^( 4) =       0.000533529504
  error estimate for blocks of size 2^( 5) =       0.000545166815
  error estimate for blocks of size 2^( 6) =       0.000551219702
  error estimate for blocks of size 2^( 7) =       0.000554826151

      target function =      -0.746803210954
              le_mean =     -22.814860969326
             les_mean =     520.966122412051
             stat err =       0.000546185543
             autocorr =       1.374225794735
   target nu stat err =       0.000546185543
   target dn stat err =       0.003797822372
      target stat err =       0.003218154879
              std dev =       0.658910078567
             le_variance =       0.434162491637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434185281113
                                         uncertainty =       0.002015168205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434185281113
                                         uncertainty =       0.002015168205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465919785
  error estimate for blocks of size 2^( 2) =       0.000491216231
  error estimate for blocks of size 2^( 3) =       0.000515599536
  error estimate for blocks of size 2^( 4) =       0.000533529504
  error estimate for blocks of size 2^( 5) =       0.000545166815
  error estimate for blocks of size 2^( 6) =       0.000551219702
  error estimate for blocks of size 2^( 7) =       0.000554826151

      target function =      -0.746803210954
              le_mean =     -22.814860969326
             les_mean =     520.966122412051
             stat err =       0.000546185543
             autocorr =       1.374225794735
   target nu stat err =       0.000546185543
   target dn stat err =       0.003797822372
      target stat err =       0.003218154879
              std dev =       0.658910078567
             le_variance =       0.434162491637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434185281113
                                         uncertainty =       0.002015168205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434185281113
                                         uncertainty =       0.002015168205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465919785
  error estimate for blocks of size 2^( 2) =       0.000491216231
  error estimate for blocks of size 2^( 3) =       0.000515599536
  error estimate for blocks of size 2^( 4) =       0.000533529504
  error estimate for blocks of size 2^( 5) =       0.000545166815
  error estimate for blocks of size 2^( 6) =       0.000551219702
  error estimate for blocks of size 2^( 7) =       0.000554826151

      target function =      -0.746803210954
              le_mean =     -22.814860969326
             les_mean =     520.966122412051
             stat err =       0.000546185543
             autocorr =       1.374225794735
   target nu stat err =       0.000546185543
   target dn stat err =       0.003797822372
      target stat err =       0.003218154879
              std dev =       0.658910078567
             le_variance =       0.434162491637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434185281113
                                         uncertainty =       0.002015168205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434185281113
                                         uncertainty =       0.002015168205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465919785
  error estimate for blocks of size 2^( 2) =       0.000491216231
  error estimate for blocks of size 2^( 3) =       0.000515599536
  error estimate for blocks of size 2^( 4) =       0.000533529504
  error estimate for blocks of size 2^( 5) =       0.000545166815
  error estimate for blocks of size 2^( 6) =       0.000551219702
  error estimate for blocks of size 2^( 7) =       0.000554826151

      target function =      -0.746803210954
              le_mean =     -22.814860969326
             les_mean =     520.966122412051
             stat err =       0.000546185543
             autocorr =       1.374225794735
   target nu stat err =       0.000546185543
   target dn stat err =       0.003797822372
      target stat err =       0.003218154879
              std dev =       0.658910078567
             le_variance =       0.434162491637


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746803210954        initial  <--
     2.2204e+26     2.2204e+27             0.0000e+00        -0.746803210954
     8.8818e+26     8.8818e+27             0.0000e+00        -0.746803210954
     3.5527e+27     3.5527e+28             0.0000e+00        -0.746803210954

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9981
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3477e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.8094
    reference variance = 0.817302
====================================================
  Execution time = 2.5854e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4720e-01
  Total weights = 1.964288157e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4485e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434071272472
                                         uncertainty =       0.001990384318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434071272472
                                         uncertainty =       0.001990384318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465859297
  error estimate for blocks of size 2^( 2) =       0.000491584290
  error estimate for blocks of size 2^( 3) =       0.000515499549
  error estimate for blocks of size 2^( 4) =       0.000532520221
  error estimate for blocks of size 2^( 5) =       0.000543058716
  error estimate for blocks of size 2^( 6) =       0.000548722647
  error estimate for blocks of size 2^( 7) =       0.000551678021

      target function =      -0.747678097272
              le_mean =     -22.815133047574
             les_mean =     520.977493217085
             stat err =       0.000543994901
             autocorr =       1.363578432594
   target nu stat err =       0.000543994901
   target dn stat err =       0.003124767304
      target stat err =       0.002676937620
              std dev =       0.658824536645
             le_variance =       0.434049770085


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281513304757e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+27, overlap shift 2.2204e+28 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747686695361       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747686695361       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747686695361       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+27 is 5.285549e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+27, overlap shift 8.8818e+28 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747686695361       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747686695361       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747686695361       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+27 is 1.321387e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+28, overlap shift 3.5527e+29 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747686695361       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747686695361       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747686695361       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+28 is 3.303468e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.810290 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0309e+01
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.8301
    reference variance = 0.254853
====================================================
  Execution time = 2.5509e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4850e-01
  Total weights = 1.9642e+06
  Execution time = 4.0021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434817890761
                                         uncertainty =       0.001966539565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434817890761
                                         uncertainty =       0.001966539565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466307840
  error estimate for blocks of size 2^( 2) =       0.000491428281
  error estimate for blocks of size 2^( 3) =       0.000515955462
  error estimate for blocks of size 2^( 4) =       0.000534062410
  error estimate for blocks of size 2^( 5) =       0.000546012343
  error estimate for blocks of size 2^( 6) =       0.000551667844
  error estimate for blocks of size 2^( 7) =       0.000556808203

      target function =      -0.746591363454
              le_mean =     -22.813910108009
             les_mean =     520.922991889788
             stat err =       0.000547137700
             autocorr =       1.376727054019
   target nu stat err =       0.000547137700
   target dn stat err =       0.003390704183
      target stat err =       0.002880748167
              std dev =       0.659458871149
             le_variance =       0.434886002738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434817890761
                                         uncertainty =       0.001966539565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434817890761
                                         uncertainty =       0.001966539565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466307840
  error estimate for blocks of size 2^( 2) =       0.000491428281
  error estimate for blocks of size 2^( 3) =       0.000515955462
  error estimate for blocks of size 2^( 4) =       0.000534062410
  error estimate for blocks of size 2^( 5) =       0.000546012343
  error estimate for blocks of size 2^( 6) =       0.000551667844
  error estimate for blocks of size 2^( 7) =       0.000556808203

      target function =      -0.746591363454
              le_mean =     -22.813910108009
             les_mean =     520.922991889788
             stat err =       0.000547137700
             autocorr =       1.376727054018
   target nu stat err =       0.000547137700
   target dn stat err =       0.003390704183
      target stat err =       0.002880748167
              std dev =       0.659458871149
             le_variance =       0.434886002738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434817890761
                                         uncertainty =       0.001966539565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434817890761
                                         uncertainty =       0.001966539565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466307840
  error estimate for blocks of size 2^( 2) =       0.000491428281
  error estimate for blocks of size 2^( 3) =       0.000515955462
  error estimate for blocks of size 2^( 4) =       0.000534062410
  error estimate for blocks of size 2^( 5) =       0.000546012343
  error estimate for blocks of size 2^( 6) =       0.000551667844
  error estimate for blocks of size 2^( 7) =       0.000556808203

      target function =      -0.746591363454
              le_mean =     -22.813910108009
             les_mean =     520.922991889788
             stat err =       0.000547137700
             autocorr =       1.376727054018
   target nu stat err =       0.000547137700
   target dn stat err =       0.003390704183
      target stat err =       0.002880748167
              std dev =       0.659458871149
             le_variance =       0.434886002738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434817890761
                                         uncertainty =       0.001966539565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434817890761
                                         uncertainty =       0.001966539565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466307840
  error estimate for blocks of size 2^( 2) =       0.000491428281
  error estimate for blocks of size 2^( 3) =       0.000515955462
  error estimate for blocks of size 2^( 4) =       0.000534062410
  error estimate for blocks of size 2^( 5) =       0.000546012343
  error estimate for blocks of size 2^( 6) =       0.000551667844
  error estimate for blocks of size 2^( 7) =       0.000556808203

      target function =      -0.746591363454
              le_mean =     -22.813910108009
             les_mean =     520.922991889788
             stat err =       0.000547137700
             autocorr =       1.376727054018
   target nu stat err =       0.000547137700
   target dn stat err =       0.003390704183
      target stat err =       0.002880748167
              std dev =       0.659458871149
             le_variance =       0.434886002738


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746591363454        initial  <--
     2.2204e+27     2.2204e+28             5.2855e-32        -0.746591363454
     8.8818e+27     8.8818e+28             1.3214e-32        -0.746591363454
     3.5527e+28     3.5527e+29             3.3035e-33        -0.746591363454

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5540
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3868e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.8424
    reference variance = 0.291803
====================================================
  Execution time = 2.6013e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5325e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4774e-01
  Total weights = 1.964466750e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4716e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435098461105
                                         uncertainty =       0.002834510759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435098461105
                                         uncertainty =       0.002834510759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466398803
  error estimate for blocks of size 2^( 2) =       0.000491720403
  error estimate for blocks of size 2^( 3) =       0.000515484229
  error estimate for blocks of size 2^( 4) =       0.000533659581
  error estimate for blocks of size 2^( 5) =       0.000543794098
  error estimate for blocks of size 2^( 6) =       0.000549689565
  error estimate for blocks of size 2^( 7) =       0.000553666891

      target function =      -0.747228085578
              le_mean =     -22.815564352840
             les_mean =     520.997711985242
             stat err =       0.000545202534
             autocorr =       1.366472439706
   target nu stat err =       0.000545202534
   target dn stat err =       0.003412326129
      target stat err =       0.002909858733
              std dev =       0.659587512613
             le_variance =       0.435055686795


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281556435284e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+28, overlap shift 2.2204e+29 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747238538574       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747238538574       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+28, overlap shift 8.8818e+29 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747238538574       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747238538574       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+29, overlap shift 3.5527e+30 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747238538574       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747238538574       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.811377 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0491e+01
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.8028
    reference variance = 0.564321
====================================================
  Execution time = 2.5506e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4954e-01
  Total weights = 1.9646e+06
  Execution time = 3.4713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436565375679
                                         uncertainty =       0.002186203863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436565375679
                                         uncertainty =       0.002186203863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467193717
  error estimate for blocks of size 2^( 2) =       0.000492797783
  error estimate for blocks of size 2^( 3) =       0.000516639867
  error estimate for blocks of size 2^( 4) =       0.000534224272
  error estimate for blocks of size 2^( 5) =       0.000543325607
  error estimate for blocks of size 2^( 6) =       0.000547740122
  error estimate for blocks of size 2^( 7) =       0.000551754726

      target function =      -0.745727409117
              le_mean =     -22.814368138258
             les_mean =     520.944936561165
             stat err =       0.000544261182
             autocorr =       1.357127757358
   target nu stat err =       0.000544261182
   target dn stat err =       0.002901771251
      target stat err =       0.002480694695
              std dev =       0.660711691126
             le_variance =       0.436539938791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436565375679
                                         uncertainty =       0.002186203863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436565375679
                                         uncertainty =       0.002186203863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467193717
  error estimate for blocks of size 2^( 2) =       0.000492797783
  error estimate for blocks of size 2^( 3) =       0.000516639867
  error estimate for blocks of size 2^( 4) =       0.000534224272
  error estimate for blocks of size 2^( 5) =       0.000543325607
  error estimate for blocks of size 2^( 6) =       0.000547740122
  error estimate for blocks of size 2^( 7) =       0.000551754726

      target function =      -0.745727409117
              le_mean =     -22.814368138258
             les_mean =     520.944936561165
             stat err =       0.000544261182
             autocorr =       1.357127757357
   target nu stat err =       0.000544261182
   target dn stat err =       0.002901771251
      target stat err =       0.002480694695
              std dev =       0.660711691126
             le_variance =       0.436539938791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436565375679
                                         uncertainty =       0.002186203863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436565375679
                                         uncertainty =       0.002186203863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467193717
  error estimate for blocks of size 2^( 2) =       0.000492797783
  error estimate for blocks of size 2^( 3) =       0.000516639867
  error estimate for blocks of size 2^( 4) =       0.000534224272
  error estimate for blocks of size 2^( 5) =       0.000543325607
  error estimate for blocks of size 2^( 6) =       0.000547740122
  error estimate for blocks of size 2^( 7) =       0.000551754726

      target function =      -0.745727409117
              le_mean =     -22.814368138258
             les_mean =     520.944936561165
             stat err =       0.000544261182
             autocorr =       1.357127757357
   target nu stat err =       0.000544261182
   target dn stat err =       0.002901771251
      target stat err =       0.002480694695
              std dev =       0.660711691126
             le_variance =       0.436539938791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436565375679
                                         uncertainty =       0.002186203863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436565375679
                                         uncertainty =       0.002186203863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467193717
  error estimate for blocks of size 2^( 2) =       0.000492797783
  error estimate for blocks of size 2^( 3) =       0.000516639867
  error estimate for blocks of size 2^( 4) =       0.000534224272
  error estimate for blocks of size 2^( 5) =       0.000543325607
  error estimate for blocks of size 2^( 6) =       0.000547740122
  error estimate for blocks of size 2^( 7) =       0.000551754726

      target function =      -0.745727409117
              le_mean =     -22.814368138258
             les_mean =     520.944936561165
             stat err =       0.000544261182
             autocorr =       1.357127757357
   target nu stat err =       0.000544261182
   target dn stat err =       0.002901771251
      target stat err =       0.002480694695
              std dev =       0.660711691126
             le_variance =       0.436539938791


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745727409117        initial  <--
     2.2204e+28     2.2204e+29             0.0000e+00        -0.745727409117
     8.8818e+28     8.8818e+29             0.0000e+00        -0.745727409117
     3.5527e+29     3.5527e+30             0.0000e+00        -0.745727409117

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9378
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3443e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.8671
    reference variance = 0.312174
====================================================
  Execution time = 2.6063e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5363e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4327e-01
  Total weights = 1.964157320e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433288298032
                                         uncertainty =       0.001789744468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433288298032
                                         uncertainty =       0.001789744468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465477353
  error estimate for blocks of size 2^( 2) =       0.000491210956
  error estimate for blocks of size 2^( 3) =       0.000515432951
  error estimate for blocks of size 2^( 4) =       0.000533488457
  error estimate for blocks of size 2^( 5) =       0.000544512260
  error estimate for blocks of size 2^( 6) =       0.000551305688
  error estimate for blocks of size 2^( 7) =       0.000554564283

      target function =      -0.750965341769
              le_mean =     -22.813851293824
             les_mean =     520.915076941652
             stat err =       0.000545967672
             autocorr =       1.375741199951
   target nu stat err =       0.000545967672
   target dn stat err =       0.002512734423
      target stat err =       0.002197548461
              std dev =       0.658284385784
             le_variance =       0.433338332567


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281385129382e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+29, overlap shift 2.2204e+30 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750970757885       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750970757885       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750970757885       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+29 is 5.715393e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+29, overlap shift 8.8818e+30 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750970757885       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750970757885       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750970757885       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+29 is 1.428848e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+30, overlap shift 3.5527e+31 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750970757885       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750970757885       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750970757885       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+30 is 3.572121e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.812740 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0538e+01
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.9172
    reference variance = 0.298077
====================================================
  Execution time = 2.5430e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5115e-01
  Total weights = 1.9643e+06
  Execution time = 3.7244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436621645911
                                         uncertainty =       0.002383300675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436621645911
                                         uncertainty =       0.002383300675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467227117
  error estimate for blocks of size 2^( 2) =       0.000492545981
  error estimate for blocks of size 2^( 3) =       0.000516701030
  error estimate for blocks of size 2^( 4) =       0.000533693397
  error estimate for blocks of size 2^( 5) =       0.000543803704
  error estimate for blocks of size 2^( 6) =       0.000548829521
  error estimate for blocks of size 2^( 7) =       0.000550721673

      target function =      -0.744390086564
              le_mean =     -22.814889058321
             les_mean =     520.970313875398
             stat err =       0.000544262074
             autocorr =       1.356938182837
   target nu stat err =       0.000544262074
   target dn stat err =       0.003787070074
      target stat err =       0.003188761857
              std dev =       0.660758925631
             le_variance =       0.436602357801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436621645911
                                         uncertainty =       0.002383300675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436621645911
                                         uncertainty =       0.002383300675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467227117
  error estimate for blocks of size 2^( 2) =       0.000492545981
  error estimate for blocks of size 2^( 3) =       0.000516701030
  error estimate for blocks of size 2^( 4) =       0.000533693397
  error estimate for blocks of size 2^( 5) =       0.000543803704
  error estimate for blocks of size 2^( 6) =       0.000548829521
  error estimate for blocks of size 2^( 7) =       0.000550721673

      target function =      -0.744390086564
              le_mean =     -22.814889058321
             les_mean =     520.970313875398
             stat err =       0.000544262074
             autocorr =       1.356938182837
   target nu stat err =       0.000544262074
   target dn stat err =       0.003787070074
      target stat err =       0.003188761857
              std dev =       0.660758925631
             le_variance =       0.436602357801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436621645911
                                         uncertainty =       0.002383300675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436621645911
                                         uncertainty =       0.002383300675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467227117
  error estimate for blocks of size 2^( 2) =       0.000492545981
  error estimate for blocks of size 2^( 3) =       0.000516701030
  error estimate for blocks of size 2^( 4) =       0.000533693397
  error estimate for blocks of size 2^( 5) =       0.000543803704
  error estimate for blocks of size 2^( 6) =       0.000548829521
  error estimate for blocks of size 2^( 7) =       0.000550721673

      target function =      -0.744390086564
              le_mean =     -22.814889058321
             les_mean =     520.970313875398
             stat err =       0.000544262074
             autocorr =       1.356938182837
   target nu stat err =       0.000544262074
   target dn stat err =       0.003787070074
      target stat err =       0.003188761857
              std dev =       0.660758925631
             le_variance =       0.436602357801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436621645911
                                         uncertainty =       0.002383300675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436621645911
                                         uncertainty =       0.002383300675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467227117
  error estimate for blocks of size 2^( 2) =       0.000492545981
  error estimate for blocks of size 2^( 3) =       0.000516701030
  error estimate for blocks of size 2^( 4) =       0.000533693397
  error estimate for blocks of size 2^( 5) =       0.000543803704
  error estimate for blocks of size 2^( 6) =       0.000548829521
  error estimate for blocks of size 2^( 7) =       0.000550721673

      target function =      -0.744390086564
              le_mean =     -22.814889058321
             les_mean =     520.970313875398
             stat err =       0.000544262074
             autocorr =       1.356938182837
   target nu stat err =       0.000544262074
   target dn stat err =       0.003787070074
      target stat err =       0.003188761857
              std dev =       0.660758925631
             le_variance =       0.436602357801


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744390086564        initial  <--
     2.2204e+29     2.2204e+30             5.7154e-34        -0.744390086564
     8.8818e+29     8.8818e+30             1.4288e-34        -0.744390086564
     3.5527e+30     3.5527e+31             3.5721e-35        -0.744390086564

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6208
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4164e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.7421
    reference variance = 0.390673
====================================================
  Execution time = 2.5784e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5368e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4662e-01
  Total weights = 1.964471519e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5248e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434583663437
                                         uncertainty =       0.001848675312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434583663437
                                         uncertainty =       0.001848675312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466098200
  error estimate for blocks of size 2^( 2) =       0.000491392701
  error estimate for blocks of size 2^( 3) =       0.000515379818
  error estimate for blocks of size 2^( 4) =       0.000533284818
  error estimate for blocks of size 2^( 5) =       0.000545080748
  error estimate for blocks of size 2^( 6) =       0.000553332856
  error estimate for blocks of size 2^( 7) =       0.000558428990

      target function =      -0.748161414118
              le_mean =     -22.814900109568
             les_mean =     520.966289015042
             stat err =       0.000547531853
             autocorr =       1.379951835677
   target nu stat err =       0.000547531853
   target dn stat err =       0.002404211811
      target stat err =       0.002098837622
              std dev =       0.659162395304
             le_variance =       0.434495063382


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281490010957e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+30, overlap shift 2.2204e+31 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748166255213       residual = 7.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748166255213       residual = 8.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748166255187       residual = 7.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+30 is 4.134592e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+30, overlap shift 8.8818e+31 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748166255213       residual = 7.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748166255213       residual = 8.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748166255213       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+30 is 1.330699e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+31, overlap shift 3.5527e+32 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748166255213       residual = 7.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748166255213       residual = 8.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748166255213       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+31 is 3.326747e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.814099 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0315e+01
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.8486
    reference variance = 1.1605
====================================================
  Execution time = 2.5313e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5203e-01
  Total weights = 1.9643e+06
  Execution time = 3.4708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437413645070
                                         uncertainty =       0.002703882305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437413645070
                                         uncertainty =       0.002703882305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467686092
  error estimate for blocks of size 2^( 2) =       0.000493129350
  error estimate for blocks of size 2^( 3) =       0.000517019922
  error estimate for blocks of size 2^( 4) =       0.000534351124
  error estimate for blocks of size 2^( 5) =       0.000545379858
  error estimate for blocks of size 2^( 6) =       0.000550712623
  error estimate for blocks of size 2^( 7) =       0.000553728983

      target function =      -0.743664646040
              le_mean =     -22.815020888814
             les_mean =     520.977207142915
             stat err =       0.000546043147
             autocorr =       1.363154278229
   target nu stat err =       0.000546043147
   target dn stat err =       0.003791902167
      target stat err =       0.003187577819
              std dev =       0.661408014854
             le_variance =       0.437460562114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437413645070
                                         uncertainty =       0.002703882305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437413645070
                                         uncertainty =       0.002703882305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467686092
  error estimate for blocks of size 2^( 2) =       0.000493129350
  error estimate for blocks of size 2^( 3) =       0.000517019922
  error estimate for blocks of size 2^( 4) =       0.000534351124
  error estimate for blocks of size 2^( 5) =       0.000545379858
  error estimate for blocks of size 2^( 6) =       0.000550712623
  error estimate for blocks of size 2^( 7) =       0.000553728983

      target function =      -0.743664646040
              le_mean =     -22.815020888814
             les_mean =     520.977207142915
             stat err =       0.000546043147
             autocorr =       1.363154278229
   target nu stat err =       0.000546043147
   target dn stat err =       0.003791902167
      target stat err =       0.003187577819
              std dev =       0.661408014854
             le_variance =       0.437460562114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437413645070
                                         uncertainty =       0.002703882305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437413645070
                                         uncertainty =       0.002703882305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467686092
  error estimate for blocks of size 2^( 2) =       0.000493129350
  error estimate for blocks of size 2^( 3) =       0.000517019922
  error estimate for blocks of size 2^( 4) =       0.000534351124
  error estimate for blocks of size 2^( 5) =       0.000545379858
  error estimate for blocks of size 2^( 6) =       0.000550712623
  error estimate for blocks of size 2^( 7) =       0.000553728983

      target function =      -0.743664646040
              le_mean =     -22.815020888814
             les_mean =     520.977207142915
             stat err =       0.000546043147
             autocorr =       1.363154278229
   target nu stat err =       0.000546043147
   target dn stat err =       0.003791902167
      target stat err =       0.003187577819
              std dev =       0.661408014854
             le_variance =       0.437460562114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437413645070
                                         uncertainty =       0.002703882305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437413645070
                                         uncertainty =       0.002703882305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467686092
  error estimate for blocks of size 2^( 2) =       0.000493129350
  error estimate for blocks of size 2^( 3) =       0.000517019922
  error estimate for blocks of size 2^( 4) =       0.000534351124
  error estimate for blocks of size 2^( 5) =       0.000545379858
  error estimate for blocks of size 2^( 6) =       0.000550712623
  error estimate for blocks of size 2^( 7) =       0.000553728983

      target function =      -0.743664646040
              le_mean =     -22.815020888814
             les_mean =     520.977207142915
             stat err =       0.000546043147
             autocorr =       1.363154278229
   target nu stat err =       0.000546043147
   target dn stat err =       0.003791902167
      target stat err =       0.003187577819
              std dev =       0.661408014854
             le_variance =       0.437460562114


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743664646040        initial  <--
     2.2204e+30     2.2204e+31             4.1346e-35        -0.743664646040
     8.8818e+30     8.8818e+31             1.3307e-35        -0.743664646040
     3.5527e+31     3.5527e+32             3.3267e-36        -0.743664646040

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7231
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3059e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.9256
    reference variance = 0.577548
====================================================
  Execution time = 2.5893e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4795e-01
  Total weights = 1.964049058e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432734471718
                                         uncertainty =       0.001787853200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432734471718
                                         uncertainty =       0.001787853200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465211693
  error estimate for blocks of size 2^( 2) =       0.000490305301
  error estimate for blocks of size 2^( 3) =       0.000513790875
  error estimate for blocks of size 2^( 4) =       0.000530824413
  error estimate for blocks of size 2^( 5) =       0.000542029151
  error estimate for blocks of size 2^( 6) =       0.000547841369
  error estimate for blocks of size 2^( 7) =       0.000551278848

      target function =      -0.747047380746
              le_mean =     -22.814729949155
             les_mean =     520.959852940198
             stat err =       0.000542993445
             autocorr =       1.362347596153
   target nu stat err =       0.000542993445
   target dn stat err =       0.003493191929
      target stat err =       0.002970223727
              std dev =       0.657908685909
             le_variance =       0.432843838995


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281472994915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+31, overlap shift 2.2204e+32 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747058282860       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747058282860       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+31, overlap shift 8.8818e+32 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747058282860       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747058282860       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+32, overlap shift 3.5527e+33 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747058282860       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747058282860       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.815217 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0410e+01
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.7825
    reference variance = 0.461196
====================================================
  Execution time = 2.5305e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5031e-01
  Total weights = 1.9645e+06
  Execution time = 3.4569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435045459477
                                         uncertainty =       0.001984965034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435045459477
                                         uncertainty =       0.001984965034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466374103
  error estimate for blocks of size 2^( 2) =       0.000491798150
  error estimate for blocks of size 2^( 3) =       0.000515265936
  error estimate for blocks of size 2^( 4) =       0.000532235888
  error estimate for blocks of size 2^( 5) =       0.000544034531
  error estimate for blocks of size 2^( 6) =       0.000550636472
  error estimate for blocks of size 2^( 7) =       0.000555043093

      target function =      -0.745090295549
              le_mean =     -22.814380097749
             les_mean =     520.946252043556
             stat err =       0.000545487496
             autocorr =       1.368046145663
   target nu stat err =       0.000545487496
   target dn stat err =       0.002793255238
      target stat err =       0.002389973831
              std dev =       0.659552581048
             le_variance =       0.435009607166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435045459477
                                         uncertainty =       0.001984965034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435045459477
                                         uncertainty =       0.001984965034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466374103
  error estimate for blocks of size 2^( 2) =       0.000491798150
  error estimate for blocks of size 2^( 3) =       0.000515265936
  error estimate for blocks of size 2^( 4) =       0.000532235888
  error estimate for blocks of size 2^( 5) =       0.000544034531
  error estimate for blocks of size 2^( 6) =       0.000550636472
  error estimate for blocks of size 2^( 7) =       0.000555043093

      target function =      -0.745090295549
              le_mean =     -22.814380097749
             les_mean =     520.946252043556
             stat err =       0.000545487496
             autocorr =       1.368046145663
   target nu stat err =       0.000545487496
   target dn stat err =       0.002793255238
      target stat err =       0.002389973831
              std dev =       0.659552581048
             le_variance =       0.435009607166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435045459477
                                         uncertainty =       0.001984965034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435045459477
                                         uncertainty =       0.001984965034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466374103
  error estimate for blocks of size 2^( 2) =       0.000491798150
  error estimate for blocks of size 2^( 3) =       0.000515265936
  error estimate for blocks of size 2^( 4) =       0.000532235888
  error estimate for blocks of size 2^( 5) =       0.000544034531
  error estimate for blocks of size 2^( 6) =       0.000550636472
  error estimate for blocks of size 2^( 7) =       0.000555043093

      target function =      -0.745090295549
              le_mean =     -22.814380097749
             les_mean =     520.946252043556
             stat err =       0.000545487496
             autocorr =       1.368046145663
   target nu stat err =       0.000545487496
   target dn stat err =       0.002793255238
      target stat err =       0.002389973831
              std dev =       0.659552581048
             le_variance =       0.435009607166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435045459477
                                         uncertainty =       0.001984965034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435045459477
                                         uncertainty =       0.001984965034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466374103
  error estimate for blocks of size 2^( 2) =       0.000491798150
  error estimate for blocks of size 2^( 3) =       0.000515265936
  error estimate for blocks of size 2^( 4) =       0.000532235888
  error estimate for blocks of size 2^( 5) =       0.000544034531
  error estimate for blocks of size 2^( 6) =       0.000550636472
  error estimate for blocks of size 2^( 7) =       0.000555043093

      target function =      -0.745090295549
              le_mean =     -22.814380097749
             les_mean =     520.946252043556
             stat err =       0.000545487496
             autocorr =       1.368046145663
   target nu stat err =       0.000545487496
   target dn stat err =       0.002793255238
      target stat err =       0.002389973831
              std dev =       0.659552581048
             le_variance =       0.435009607166


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745090295549        initial  <--
     2.2204e+31     2.2204e+32             0.0000e+00        -0.745090295549
     8.8818e+31     8.8818e+32             0.0000e+00        -0.745090295549
     3.5527e+32     3.5527e+33             0.0000e+00        -0.745090295549

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.5702
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6986e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.8656
    reference variance = 0.363795
====================================================
  Execution time = 2.5995e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5324e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4785e-01
  Total weights = 1.964182781e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4969e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436722104279
                                         uncertainty =       0.002718158558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436722104279
                                         uncertainty =       0.002718158558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467261119
  error estimate for blocks of size 2^( 2) =       0.000492544530
  error estimate for blocks of size 2^( 3) =       0.000516681469
  error estimate for blocks of size 2^( 4) =       0.000534232742
  error estimate for blocks of size 2^( 5) =       0.000545472164
  error estimate for blocks of size 2^( 6) =       0.000551503398
  error estimate for blocks of size 2^( 7) =       0.000553691858

      target function =      -0.747133294367
              le_mean =     -22.814735743812
             les_mean =     520.960017034400
             stat err =       0.000546225040
             autocorr =       1.366544951174
   target nu stat err =       0.000546225040
   target dn stat err =       0.003095495686
      target stat err =       0.002648392359
              std dev =       0.660807011437
             le_variance =       0.436665906365


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281473574381e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+32, overlap shift 2.2204e+33 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747141812980       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747141812980       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+32, overlap shift 8.8818e+33 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747141812980       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747141812980       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+33, overlap shift 3.5527e+34 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747141812980       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747141812980       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.816305 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0617e+01
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.7629
    reference variance = 0.341464
====================================================
  Execution time = 2.5291e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4705e-01
  Total weights = 1.9645e+06
  Execution time = 3.4685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433237562711
                                         uncertainty =       0.002202389544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433237562711
                                         uncertainty =       0.002202389544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465488624
  error estimate for blocks of size 2^( 2) =       0.000491145307
  error estimate for blocks of size 2^( 3) =       0.000515109114
  error estimate for blocks of size 2^( 4) =       0.000533136758
  error estimate for blocks of size 2^( 5) =       0.000542770708
  error estimate for blocks of size 2^( 6) =       0.000548768258
  error estimate for blocks of size 2^( 7) =       0.000551938477

      target function =      -0.747800288148
              le_mean =     -22.814891966774
             les_mean =     520.966347289017
             stat err =       0.000544153550
             autocorr =       1.366547683926
   target nu stat err =       0.000544153550
   target dn stat err =       0.002855772411
      target stat err =       0.002458805507
              std dev =       0.658300325233
             le_variance =       0.433359318202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433237562711
                                         uncertainty =       0.002202389544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433237562711
                                         uncertainty =       0.002202389544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465488624
  error estimate for blocks of size 2^( 2) =       0.000491145307
  error estimate for blocks of size 2^( 3) =       0.000515109114
  error estimate for blocks of size 2^( 4) =       0.000533136758
  error estimate for blocks of size 2^( 5) =       0.000542770708
  error estimate for blocks of size 2^( 6) =       0.000548768258
  error estimate for blocks of size 2^( 7) =       0.000551938477

      target function =      -0.747800288148
              le_mean =     -22.814891966774
             les_mean =     520.966347289017
             stat err =       0.000544153550
             autocorr =       1.366547683926
   target nu stat err =       0.000544153550
   target dn stat err =       0.002855772411
      target stat err =       0.002458805507
              std dev =       0.658300325233
             le_variance =       0.433359318202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433237562711
                                         uncertainty =       0.002202389544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433237562711
                                         uncertainty =       0.002202389544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465488624
  error estimate for blocks of size 2^( 2) =       0.000491145307
  error estimate for blocks of size 2^( 3) =       0.000515109114
  error estimate for blocks of size 2^( 4) =       0.000533136758
  error estimate for blocks of size 2^( 5) =       0.000542770708
  error estimate for blocks of size 2^( 6) =       0.000548768258
  error estimate for blocks of size 2^( 7) =       0.000551938477

      target function =      -0.747800288148
              le_mean =     -22.814891966774
             les_mean =     520.966347289017
             stat err =       0.000544153550
             autocorr =       1.366547683926
   target nu stat err =       0.000544153550
   target dn stat err =       0.002855772411
      target stat err =       0.002458805507
              std dev =       0.658300325233
             le_variance =       0.433359318202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433237562711
                                         uncertainty =       0.002202389544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433237562711
                                         uncertainty =       0.002202389544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465488624
  error estimate for blocks of size 2^( 2) =       0.000491145307
  error estimate for blocks of size 2^( 3) =       0.000515109114
  error estimate for blocks of size 2^( 4) =       0.000533136758
  error estimate for blocks of size 2^( 5) =       0.000542770708
  error estimate for blocks of size 2^( 6) =       0.000548768258
  error estimate for blocks of size 2^( 7) =       0.000551938477

      target function =      -0.747800288148
              le_mean =     -22.814891966774
             les_mean =     520.966347289017
             stat err =       0.000544153550
             autocorr =       1.366547683926
   target nu stat err =       0.000544153550
   target dn stat err =       0.002855772411
      target stat err =       0.002458805507
              std dev =       0.658300325233
             le_variance =       0.433359318202


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747800288148        initial  <--
     2.2204e+32     2.2204e+33             0.0000e+00        -0.747800288148
     8.8818e+32     8.8818e+33             0.0000e+00        -0.747800288148
     3.5527e+33     3.5527e+34             0.0000e+00        -0.747800288148

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8000
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3423e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.824
    reference variance = 0.484159
====================================================
  Execution time = 2.5878e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4738e-01
  Total weights = 1.964394330e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434120234332
                                         uncertainty =       0.002086702425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434120234332
                                         uncertainty =       0.002086702425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465868162
  error estimate for blocks of size 2^( 2) =       0.000491331183
  error estimate for blocks of size 2^( 3) =       0.000515460799
  error estimate for blocks of size 2^( 4) =       0.000532430759
  error estimate for blocks of size 2^( 5) =       0.000544048675
  error estimate for blocks of size 2^( 6) =       0.000549158442
  error estimate for blocks of size 2^( 7) =       0.000550451452

      target function =      -0.747527081125
              le_mean =     -22.815108816051
             les_mean =     520.976571812704
             stat err =       0.000544022332
             autocorr =       1.363664054893
   target nu stat err =       0.000544022332
   target dn stat err =       0.002605767150
      target stat err =       0.002256360880
              std dev =       0.658837073125
             le_variance =       0.434066288924


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281510881605e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+33, overlap shift 2.2204e+34 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747532916953       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747532916953       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747532916953       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747533798218       residual = 2.01e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747532963753       residual = 9.40e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747532831370       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 4.91e+15           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+33 is 4.382561e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+33, overlap shift 8.8818e+34 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747532916953       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747532916953       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747532916953       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747531890869       residual = 1.94e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+33 is 9.048010e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+34, overlap shift 3.5527e+35 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747532916953       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747532916953       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747532916953       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747535705566       residual = 1.94e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747532916953       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+34 is 2.813954e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.818398 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0404e+01
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.825
    reference variance = 0.314816
====================================================
  Execution time = 2.5189e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4434e-01
  Total weights = 1.9644e+06
  Execution time = 3.4571e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433280376680
                                         uncertainty =       0.001585708871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433280376680
                                         uncertainty =       0.001585708871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465480377
  error estimate for blocks of size 2^( 2) =       0.000491212898
  error estimate for blocks of size 2^( 3) =       0.000515292826
  error estimate for blocks of size 2^( 4) =       0.000533180144
  error estimate for blocks of size 2^( 5) =       0.000544213753
  error estimate for blocks of size 2^( 6) =       0.000550569724
  error estimate for blocks of size 2^( 7) =       0.000553650056

      target function =      -0.750065448390
              le_mean =     -22.814137951770
             les_mean =     520.929232769912
             stat err =       0.000545403419
             autocorr =       1.372881200902
   target nu stat err =       0.000545403419
   target dn stat err =       0.002303471083
      target stat err =       0.002025292047
              std dev =       0.658288661696
             le_variance =       0.433343962117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433280376680
                                         uncertainty =       0.001585708871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433280376680
                                         uncertainty =       0.001585708871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465480377
  error estimate for blocks of size 2^( 2) =       0.000491212898
  error estimate for blocks of size 2^( 3) =       0.000515292826
  error estimate for blocks of size 2^( 4) =       0.000533180144
  error estimate for blocks of size 2^( 5) =       0.000544213753
  error estimate for blocks of size 2^( 6) =       0.000550569724
  error estimate for blocks of size 2^( 7) =       0.000553650056

      target function =      -0.750065448390
              le_mean =     -22.814137951770
             les_mean =     520.929232769912
             stat err =       0.000545403419
             autocorr =       1.372881200902
   target nu stat err =       0.000545403419
   target dn stat err =       0.002303471083
      target stat err =       0.002025292047
              std dev =       0.658288661696
             le_variance =       0.433343962117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433280376680
                                         uncertainty =       0.001585708871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433280376680
                                         uncertainty =       0.001585708871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465480377
  error estimate for blocks of size 2^( 2) =       0.000491212898
  error estimate for blocks of size 2^( 3) =       0.000515292826
  error estimate for blocks of size 2^( 4) =       0.000533180144
  error estimate for blocks of size 2^( 5) =       0.000544213753
  error estimate for blocks of size 2^( 6) =       0.000550569724
  error estimate for blocks of size 2^( 7) =       0.000553650056

      target function =      -0.750065448390
              le_mean =     -22.814137951770
             les_mean =     520.929232769912
             stat err =       0.000545403419
             autocorr =       1.372881200902
   target nu stat err =       0.000545403419
   target dn stat err =       0.002303471083
      target stat err =       0.002025292047
              std dev =       0.658288661696
             le_variance =       0.433343962117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433280376680
                                         uncertainty =       0.001585708871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433280376680
                                         uncertainty =       0.001585708871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465480377
  error estimate for blocks of size 2^( 2) =       0.000491212898
  error estimate for blocks of size 2^( 3) =       0.000515292826
  error estimate for blocks of size 2^( 4) =       0.000533180144
  error estimate for blocks of size 2^( 5) =       0.000544213753
  error estimate for blocks of size 2^( 6) =       0.000550569724
  error estimate for blocks of size 2^( 7) =       0.000553650056

      target function =      -0.750065448390
              le_mean =     -22.814137951770
             les_mean =     520.929232769912
             stat err =       0.000545403419
             autocorr =       1.372881200902
   target nu stat err =       0.000545403419
   target dn stat err =       0.002303471083
      target stat err =       0.002025292047
              std dev =       0.658288661696
             le_variance =       0.433343962117


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750065448390        initial  <--
     2.2204e+33     2.2204e+34             4.3826e-38        -0.750065448390
     8.8818e+33     8.8818e+34             9.0480e-39        -0.750065448390
     3.5527e+34     3.5527e+35             2.8140e-39        -0.750065448390

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.8511
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6260e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.7772
    reference variance = 0.357291
====================================================
  Execution time = 2.5947e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5371e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4345e-01
  Total weights = 1.964436902e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5255e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432000792543
                                         uncertainty =       0.001618816859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432000792543
                                         uncertainty =       0.001618816859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464762684
  error estimate for blocks of size 2^( 2) =       0.000490074809
  error estimate for blocks of size 2^( 3) =       0.000514658373
  error estimate for blocks of size 2^( 4) =       0.000533068847
  error estimate for blocks of size 2^( 5) =       0.000544834372
  error estimate for blocks of size 2^( 6) =       0.000551221683
  error estimate for blocks of size 2^( 7) =       0.000555045761

      target function =      -0.750818732118
              le_mean =     -22.814910793103
             les_mean =     520.963605887890
             stat err =       0.000546042666
             autocorr =       1.380354556863
   target nu stat err =       0.000546042666
   target dn stat err =       0.002405063217
      target stat err =       0.002113375806
              std dev =       0.657273691413
             le_variance =       0.432008705424


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281491079310e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+34, overlap shift 2.2204e+35 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750823692402       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750823692402       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+34, overlap shift 8.8818e+35 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750823692402       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750823692402       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+35, overlap shift 3.5527e+36 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750823692402       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750823692402       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.822715 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0485e+01
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.858
    reference variance = 0.400238
====================================================
  Execution time = 2.5446e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4772e-01
  Total weights = 1.9647e+06
  Execution time = 3.4713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434654995981
                                         uncertainty =       0.001795367128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434654995981
                                         uncertainty =       0.001795367128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466235096
  error estimate for blocks of size 2^( 2) =       0.000491483219
  error estimate for blocks of size 2^( 3) =       0.000514677976
  error estimate for blocks of size 2^( 4) =       0.000533270580
  error estimate for blocks of size 2^( 5) =       0.000543503466
  error estimate for blocks of size 2^( 6) =       0.000549339820
  error estimate for blocks of size 2^( 7) =       0.000553557124

      target function =      -0.747244055181
              le_mean =     -22.815824856781
             les_mean =     521.009584160180
             stat err =       0.000544917748
             autocorr =       1.366004029789
   target nu stat err =       0.000544917748
   target dn stat err =       0.002864152456
      target stat err =       0.002465667872
              std dev =       0.659355996627
             le_variance =       0.434750330287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434654995981
                                         uncertainty =       0.001795367128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434654995981
                                         uncertainty =       0.001795367128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466235096
  error estimate for blocks of size 2^( 2) =       0.000491483219
  error estimate for blocks of size 2^( 3) =       0.000514677976
  error estimate for blocks of size 2^( 4) =       0.000533270580
  error estimate for blocks of size 2^( 5) =       0.000543503466
  error estimate for blocks of size 2^( 6) =       0.000549339820
  error estimate for blocks of size 2^( 7) =       0.000553557124

      target function =      -0.747244055181
              le_mean =     -22.815824856781
             les_mean =     521.009584160180
             stat err =       0.000544917748
             autocorr =       1.366004029789
   target nu stat err =       0.000544917748
   target dn stat err =       0.002864152456
      target stat err =       0.002465667872
              std dev =       0.659355996627
             le_variance =       0.434750330287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434654995981
                                         uncertainty =       0.001795367128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434654995981
                                         uncertainty =       0.001795367128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466235096
  error estimate for blocks of size 2^( 2) =       0.000491483219
  error estimate for blocks of size 2^( 3) =       0.000514677976
  error estimate for blocks of size 2^( 4) =       0.000533270580
  error estimate for blocks of size 2^( 5) =       0.000543503466
  error estimate for blocks of size 2^( 6) =       0.000549339820
  error estimate for blocks of size 2^( 7) =       0.000553557124

      target function =      -0.747244055181
              le_mean =     -22.815824856781
             les_mean =     521.009584160180
             stat err =       0.000544917748
             autocorr =       1.366004029789
   target nu stat err =       0.000544917748
   target dn stat err =       0.002864152456
      target stat err =       0.002465667872
              std dev =       0.659355996627
             le_variance =       0.434750330287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434654995981
                                         uncertainty =       0.001795367128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434654995981
                                         uncertainty =       0.001795367128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466235096
  error estimate for blocks of size 2^( 2) =       0.000491483219
  error estimate for blocks of size 2^( 3) =       0.000514677976
  error estimate for blocks of size 2^( 4) =       0.000533270580
  error estimate for blocks of size 2^( 5) =       0.000543503466
  error estimate for blocks of size 2^( 6) =       0.000549339820
  error estimate for blocks of size 2^( 7) =       0.000553557124

      target function =      -0.747244055181
              le_mean =     -22.815824856781
             les_mean =     521.009584160180
             stat err =       0.000544917748
             autocorr =       1.366004029789
   target nu stat err =       0.000544917748
   target dn stat err =       0.002864152456
      target stat err =       0.002465667872
              std dev =       0.659355996627
             le_variance =       0.434750330287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747244055181        initial  <--
     2.2204e+34     2.2204e+35             0.0000e+00        -0.747244055181
     8.8818e+34     8.8818e+35             0.0000e+00        -0.747244055181
     3.5527e+35     3.5527e+36             0.0000e+00        -0.747244055181

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8755
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3376e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.7847
    reference variance = 0.465287
====================================================
  Execution time = 2.5864e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4124e-01
  Total weights = 1.964159170e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431746204929
                                         uncertainty =       0.001779157384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431746204929
                                         uncertainty =       0.001779157384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464657048
  error estimate for blocks of size 2^( 2) =       0.000490786470
  error estimate for blocks of size 2^( 3) =       0.000515292561
  error estimate for blocks of size 2^( 4) =       0.000532355765
  error estimate for blocks of size 2^( 5) =       0.000542762392
  error estimate for blocks of size 2^( 6) =       0.000550138387
  error estimate for blocks of size 2^( 7) =       0.000553774689

      target function =      -0.752674073891
              le_mean =     -22.814009084153
             les_mean =     520.920251996390
             stat err =       0.000544757808
             autocorr =       1.374490905436
   target nu stat err =       0.000544757808
   target dn stat err =       0.001987736320
      target stat err =       0.001785675266
              std dev =       0.657124298581
             le_variance =       0.431812343785


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281400908415e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+35, overlap shift 2.2204e+36 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752677336896       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752677336896       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752677336917       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+35 is 4.092546e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.8818e+35, overlap shift 8.8818e+36 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752677336896       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752677336896       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752677336917       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+35 is 1.023137e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+36, overlap shift 3.5527e+37 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752677336896       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752677336896       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752677440643       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+36 is 2.557841e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.827570 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0392e+01
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.8226
    reference variance = 0.262054
====================================================
  Execution time = 2.5345e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4813e-01
  Total weights = 1.9646e+06
  Execution time = 3.4655e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435917549212
                                         uncertainty =       0.002229285094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435917549212
                                         uncertainty =       0.002229285094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466857895
  error estimate for blocks of size 2^( 2) =       0.000492789201
  error estimate for blocks of size 2^( 3) =       0.000517084396
  error estimate for blocks of size 2^( 4) =       0.000534741300
  error estimate for blocks of size 2^( 5) =       0.000545805026
  error estimate for blocks of size 2^( 6) =       0.000552103948
  error estimate for blocks of size 2^( 7) =       0.000555637769

      target function =      -0.746903011856
              le_mean =     -22.814940617962
             les_mean =     520.969644307323
             stat err =       0.000547072011
             autocorr =       1.373155044681
   target nu stat err =       0.000547072011
   target dn stat err =       0.002842941915
      target stat err =       0.002443727878
              std dev =       0.660236766818
             le_variance =       0.435912588259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435917549212
                                         uncertainty =       0.002229285094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435917549212
                                         uncertainty =       0.002229285094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466857895
  error estimate for blocks of size 2^( 2) =       0.000492789201
  error estimate for blocks of size 2^( 3) =       0.000517084396
  error estimate for blocks of size 2^( 4) =       0.000534741300
  error estimate for blocks of size 2^( 5) =       0.000545805026
  error estimate for blocks of size 2^( 6) =       0.000552103948
  error estimate for blocks of size 2^( 7) =       0.000555637769

      target function =      -0.746903011856
              le_mean =     -22.814940617962
             les_mean =     520.969644307323
             stat err =       0.000547072011
             autocorr =       1.373155044681
   target nu stat err =       0.000547072011
   target dn stat err =       0.002842941915
      target stat err =       0.002443727878
              std dev =       0.660236766818
             le_variance =       0.435912588259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435917549212
                                         uncertainty =       0.002229285094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435917549212
                                         uncertainty =       0.002229285094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466857895
  error estimate for blocks of size 2^( 2) =       0.000492789201
  error estimate for blocks of size 2^( 3) =       0.000517084396
  error estimate for blocks of size 2^( 4) =       0.000534741300
  error estimate for blocks of size 2^( 5) =       0.000545805026
  error estimate for blocks of size 2^( 6) =       0.000552103948
  error estimate for blocks of size 2^( 7) =       0.000555637769

      target function =      -0.746903011856
              le_mean =     -22.814940617962
             les_mean =     520.969644307323
             stat err =       0.000547072011
             autocorr =       1.373155044681
   target nu stat err =       0.000547072011
   target dn stat err =       0.002842941915
      target stat err =       0.002443727878
              std dev =       0.660236766818
             le_variance =       0.435912588259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435917549212
                                         uncertainty =       0.002229285094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435917549212
                                         uncertainty =       0.002229285094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466857895
  error estimate for blocks of size 2^( 2) =       0.000492789201
  error estimate for blocks of size 2^( 3) =       0.000517084396
  error estimate for blocks of size 2^( 4) =       0.000534741300
  error estimate for blocks of size 2^( 5) =       0.000545805026
  error estimate for blocks of size 2^( 6) =       0.000552103948
  error estimate for blocks of size 2^( 7) =       0.000555637769

      target function =      -0.746903011856
              le_mean =     -22.814940617962
             les_mean =     520.969644307323
             stat err =       0.000547072011
             autocorr =       1.373155044681
   target nu stat err =       0.000547072011
   target dn stat err =       0.002842941915
      target stat err =       0.002443727878
              std dev =       0.660236766818
             le_variance =       0.435912588259


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746903011856        initial  <--
     2.2204e+35     2.2204e+36             4.0925e-40        -0.746903011856
     8.8818e+35     8.8818e+36             1.0231e-40        -0.746903011856
     3.5527e+36     3.5527e+37             2.5578e-41        -0.746903011856

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.8004
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_01                 1.264010e-01 3 1  ON 0
ci_02                -2.868097e-02 3 1  ON 1
ci_03                -2.854669e-02 3 1  ON 2
ci_04                 2.655622e-02 3 1  ON 3
ci_05                -2.183453e-02 3 1  ON 4
ci_06                -2.151106e-02 3 1  ON 5
ci_07                 2.705349e-02 3 1  ON 6
ci_08                -5.446243e-03 3 1  ON 7
ci_09                -8.816767e-03 3 1  ON 8
ci_10                -8.312050e-03 3 1  ON 9
ci_11                 1.308590e-02 3 1  ON 10
ci_12                 6.926523e-03 3 1  ON 11
ci_13                 1.303910e-02 3 1  ON 12
ci_14                 1.255629e-02 3 1  ON 13
ci_15                 6.404172e-03 3 1  ON 14
ci_16                 6.282661e-03 3 1  ON 15
ci_17                -7.193229e-03 3 1  ON 16
ci_18                -6.020410e-03 3 1  ON 17
ci_19                 9.260324e-03 3 1  ON 18
ci_20                 6.506057e-03 3 1  ON 19
ci_21                 8.949158e-03 3 1  ON 20
ci_22                 8.286712e-03 3 1  ON 21
ci_23                 4.843983e-03 3 1  ON 22
ci_24                 4.094176e-03 3 1  ON 23
ci_25                 2.834995e-03 3 1  ON 24
ci_26                 3.090856e-03 3 1  ON 25
ci_27                 3.189063e-03 3 1  ON 26
ci_28                 1.744890e-03 3 1  ON 27
ci_29                 1.477912e-03 3 1  ON 28
ci_30                -1.743784e-03 3 1  ON 29
ci_31                -4.908409e-04 3 1  ON 30
ci_32                -9.515792e-04 3 1  ON 31
ci_33                -1.378391e-03 3 1  ON 32
ci_34                 1.081913e-03 3 1  ON 33
ci_35                 1.531178e-03 3 1  ON 34
ci_36                -1.080717e-03 3 1  ON 35
ci_37                -1.036886e-03 3 1  ON 36
ci_38                -6.196550e-04 3 1  ON 37
ci_39                -5.830594e-04 3 1  ON 38
ci_40                -1.510482e-03 3 1  ON 39
ci_41                -1.197729e-03 3 1  ON 40
ci_42                -1.185967e-03 3 1  ON 41
ci_43                -2.214414e-03 3 1  ON 42
ci_44                -2.949771e-03 3 1  ON 43
ci_45                -5.544253e-04 3 1  ON 44
ci_46                -7.121474e-04 3 1  ON 45
ci_47                 1.594212e-03 3 1  ON 46
ci_48                 1.430828e-03 3 1  ON 47
ci_49                -9.536439e-04 3 1  ON 48
ci_50                -7.627115e-04 3 1  ON 49
ci_51                 1.225689e-04 3 1  ON 50
ci_52                 1.780146e-04 3 1  ON 51
ci_53                -6.977871e-04 3 1  ON 52
ci_54                -1.061653e-03 3 1  ON 53
ci_55                -6.576268e-04 3 1  ON 54
ci_56                 2.468553e-03 3 1  ON 55
ci_57                 1.731144e-03 3 1  ON 56
ci_58                -1.159444e-03 3 1  ON 57
ci_59                -1.400361e-03 3 1  ON 58
ci_60                 1.672586e-04 3 1  ON 59
ci_61                -2.555170e-04 3 1  ON 60
ci_62                -5.508825e-04 3 1  ON 61
ci_63                -6.197522e-04 3 1  ON 62
ci_64                -3.411991e-04 3 1  ON 63
ci_65                -1.398257e-05 3 1  ON 64
ci_66                -6.512486e-04 3 1  ON 65
ci_67                -8.408616e-04 3 1  ON 66
ci_68                -1.167637e-03 3 1  ON 67
ci_69                 3.679784e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6228e+01 secs
  Total Execution time = 7.6758e+03 secs

=========================================================
  A new xml input file : FORM.s099.cont.xml
