Rank =    0  Free Memory = 78822 MB
Rank =    1  Free Memory = 78822 MB
Rank =    2  Free Memory = 78822 MB
Rank =    3  Free Memory = 78822 MB
Rank =    4  Free Memory = 78821 MB
Rank =    5  Free Memory = 78821 MB
Rank =    6  Free Memory = 78821 MB
Rank =    7  Free Memory = 78821 MB
Rank =    8  Free Memory = 78821 MB
Rank =    9  Free Memory = 78821 MB
Rank =   10  Free Memory = 78821 MB
Rank =   11  Free Memory = 78821 MB
Rank =   12  Free Memory = 78820 MB
Rank =   13  Free Memory = 78820 MB
Rank =   14  Free Memory = 78820 MB
Rank =   15  Free Memory = 78806 MB
Rank =   16  Free Memory = 78806 MB
Rank =   17  Free Memory = 78806 MB
Rank =   18  Free Memory = 78805 MB
Rank =   19  Free Memory = 78805 MB
Rank =   20  Free Memory = 78805 MB
Rank =   21  Free Memory = 78805 MB
Rank =   22  Free Memory = 78805 MB
Rank =   23  Free Memory = 78805 MB
Rank =   24  Free Memory = 78805 MB
Rank =   25  Free Memory = 78805 MB
Rank =   26  Free Memory = 78805 MB
Rank =   27  Free Memory = 78805 MB
Rank =   28  Free Memory = 78805 MB
Rank =   29  Free Memory = 78805 MB
Rank =   30  Free Memory = 78805 MB
Rank =   31  Free Memory = 78805 MB
Rank =   32  Free Memory = 88620 MB
Rank =   33  Free Memory = 88620 MB
Rank =   34  Free Memory = 88620 MB
Rank =   35  Free Memory = 88620 MB
Rank =   36  Free Memory = 88620 MB
Rank =   37  Free Memory = 88620 MB
Rank =   38  Free Memory = 88620 MB
Rank =   39  Free Memory = 88620 MB
Rank =   40  Free Memory = 88620 MB
Rank =   41  Free Memory = 88620 MB
Rank =   42  Free Memory = 88620 MB
Rank =   43  Free Memory = 88620 MB
Rank =   44  Free Memory = 88620 MB
Rank =   45  Free Memory = 88620 MB
Rank =   46  Free Memory = 88620 MB
Rank =   47  Free Memory = 88620 MB
Rank =   48  Free Memory = 88620 MB
Rank =   49  Free Memory = 88620 MB
Rank =   50  Free Memory = 88620 MB
Rank =   51  Free Memory = 88620 MB
Rank =   52  Free Memory = 88620 MB
Rank =   53  Free Memory = 88620 MB
Rank =   54  Free Memory = 88620 MB
Rank =   55  Free Memory = 88620 MB
Rank =   56  Free Memory = 88620 MB
Rank =   57  Free Memory = 88620 MB
Rank =   58  Free Memory = 88620 MB
Rank =   59  Free Memory = 88620 MB
Rank =   60  Free Memory = 88620 MB
Rank =   61  Free Memory = 88620 MB
Rank =   62  Free Memory = 88620 MB
Rank =   63  Free Memory = 88620 MB
Rank =   64  Free Memory = 90270 MB
Rank =   65  Free Memory = 90270 MB
Rank =   66  Free Memory = 90270 MB
Rank =   67  Free Memory = 90270 MB
Rank =   68  Free Memory = 90270 MB
Rank =   69  Free Memory = 90270 MB
Rank =   70  Free Memory = 90270 MB
Rank =   71  Free Memory = 90270 MB
Rank =   72  Free Memory = 90270 MB
Rank =   73  Free Memory = 90270 MB
Rank =   74  Free Memory = 90269 MB
Rank =   75  Free Memory = 90269 MB
Rank =   76  Free Memory = 90269 MB
Rank =   77  Free Memory = 90269 MB
Rank =   78  Free Memory = 90269 MB
Rank =   79  Free Memory = 90268 MB
Rank =   80  Free Memory = 90268 MB
Rank =   81  Free Memory = 90268 MB
Rank =   82  Free Memory = 90268 MB
Rank =   83  Free Memory = 90268 MB
Rank =   84  Free Memory = 90268 MB
Rank =   85  Free Memory = 90268 MB
Rank =   86  Free Memory = 90268 MB
Rank =   87  Free Memory = 90268 MB
Rank =   88  Free Memory = 90268 MB
Rank =   89  Free Memory = 90268 MB
Rank =   90  Free Memory = 90267 MB
Rank =   91  Free Memory = 90267 MB
Rank =   92  Free Memory = 90267 MB
Rank =   93  Free Memory = 90267 MB
Rank =   94  Free Memory = 90267 MB
Rank =   95  Free Memory = 90267 MB
Rank =   96  Free Memory = 90267 MB
Rank =   97  Free Memory = 90267 MB
Rank =   98  Free Memory = 90267 MB
Rank =   99  Free Memory = 90267 MB
Rank =  100  Free Memory = 90267 MB
Rank =  101  Free Memory = 90267 MB
Rank =  102  Free Memory = 90267 MB
Rank =  103  Free Memory = 90267 MB
Rank =  104  Free Memory = 87306 MB
Rank =  105  Free Memory = 87306 MB
Rank =  106  Free Memory = 87306 MB
Rank =  107  Free Memory = 87306 MB
Rank =  108  Free Memory = 87306 MB
Rank =  109  Free Memory = 87306 MB
Rank =  110  Free Memory = 87306 MB
Rank =  111  Free Memory = 87306 MB
Rank =  112  Free Memory = 87306 MB
Rank =  113  Free Memory = 87306 MB
Rank =  114  Free Memory = 87306 MB
Rank =  115  Free Memory = 87306 MB
Rank =  116  Free Memory = 87306 MB
Rank =  117  Free Memory = 87306 MB
Rank =  118  Free Memory = 87306 MB
Rank =  119  Free Memory = 87306 MB
Rank =  120  Free Memory = 87306 MB
Rank =  121  Free Memory = 87306 MB
Rank =  122  Free Memory = 87306 MB
Rank =  123  Free Memory = 87306 MB
Rank =  124  Free Memory = 87306 MB
Rank =  125  Free Memory = 87306 MB
Rank =  126  Free Memory = 87306 MB
Rank =  127  Free Memory = 87306 MB
  Input file(s): opt_form_gs_tett_run001c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_tett_run001c.xml

  Project = FORM
  date    = 2023-02-22 21:43:54 PST
  host    = n0059.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 282

  Range of prime numbers to use as seeds over processors and threads = 1861-2837


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.624554e-01    1         1 OFF
     uu_1                 1.011863e-01    1         1 OFF
     uu_2                 3.659226e-03    1         1 OFF
     uu_3                -5.375161e-02    1         1 OFF
     uu_4                -8.591702e-02    1         1 OFF
     uu_5                -1.029990e-01    1         1 OFF
     uu_6                -1.108447e-01    1         1 OFF
     uu_7                -1.087609e-01    1         1 OFF
     uu_8                -9.325173e-02    1         1 OFF
     uu_9                -5.957390e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.378549e-01    1         1 OFF
     ud_1                 9.967815e-02    1         1 OFF
     ud_2                -1.443990e-02    1         1 OFF
     ud_3                -7.376538e-02    1         1 OFF
     ud_4                -1.061181e-01    1         1 OFF
     ud_5                -1.224040e-01    1         1 OFF
     ud_6                -1.277130e-01    1         1 OFF
     ud_7                -1.191873e-01    1         1 OFF
     ud_8                -9.272569e-02    1         1 OFF
     ud_9                -4.447679e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -4.563379e-01    1         1 OFF
     eC_1                -3.182912e-01    1         1 OFF
     eC_2                -6.732177e-02    1         1 OFF
     eC_3                 9.506706e-02    1         1 OFF
     eC_4                 1.375986e-01    1         1 OFF
     eC_5                 1.931335e-01    1         1 OFF
     eC_6                 2.098757e-01    1         1 OFF
     eC_7                 1.661996e-01    1         1 OFF
     eC_8                 3.840237e-02    1         1 OFF
     eC_9                 1.377137e-03    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -8.227972e-01    1         1 OFF
     eO_1                -5.297360e-01    1         1 OFF
     eO_2                -1.492259e-01    1         1 OFF
     eO_3                 1.025706e-01    1         1 OFF
     eO_4                 2.270539e-01    1         1 OFF
     eO_5                 3.212686e-01    1         1 OFF
     eO_6                 3.347758e-01    1         1 OFF
     eO_7                 3.060194e-01    1         1 OFF
     eO_8                 1.433530e-01    1         1 OFF
     eO_9                 3.830540e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.277008e-01    1         1 OFF
     eH1_1                -3.779999e-02    1         1 OFF
     eH1_2                -1.874707e-02    1         1 OFF
     eH1_3                -3.712827e-02    1         1 OFF
     eH1_4                -1.241675e-02    1         1 OFF
     eH1_5                 8.974315e-03    1         1 OFF
     eH1_6                 5.391205e-02    1         1 OFF
     eH1_7                 6.334551e-02    1         1 OFF
     eH1_8                 6.498479e-02    1         1 OFF
     eH1_9                 4.352531e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.183001e-01    1         1 OFF
     eH2_1                -2.576170e-02    1         1 OFF
     eH2_2                -1.319036e-02    1         1 OFF
     eH2_3                -3.560919e-02    1         1 OFF
     eH2_4                -1.653925e-02    1         1 OFF
     eH2_5                 7.920534e-03    1         1 OFF
     eH2_6                 4.215155e-02    1         1 OFF
     eH2_7                 4.045401e-02    1         1 OFF
     eH2_8                 5.493390e-02    1         1 OFF
     eH2_9                 5.404523e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.812290e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.7940e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8321
    reference variance = 0.331901
====================================================
  Execution time = 2.5813e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5361e-01
  Total weights = 1.963900229e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5511e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436453649469
                                         uncertainty =       0.001944071499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436453649469
                                         uncertainty =       0.001944071499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467144029
  error estimate for blocks of size 2^( 2) =       0.000492209354
  error estimate for blocks of size 2^( 3) =       0.000515070418
  error estimate for blocks of size 2^( 4) =       0.000532332868
  error estimate for blocks of size 2^( 5) =       0.000544236836
  error estimate for blocks of size 2^( 6) =       0.000551357761
  error estimate for blocks of size 2^( 7) =       0.000553515238

      target function =      -0.742363613740
              le_mean =     -22.814569330783
             les_mean =     520.958186196583
             stat err =       0.000545360676
             autocorr =       1.362906411544
   target nu stat err =       0.000545360676
   target dn stat err =       0.004350624812
      target stat err =       0.003618272425
              std dev =       0.660641421168
             le_variance =       0.436447087363


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.281456933078e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742380387815       residual = 7.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742614119596       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742647653735       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742652241327       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742654095261       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742654354007       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742654431427       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742654595424       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742654621061       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742654629628       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.416833e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742380387815       residual = 7.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742446996461       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742456132053       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742457320557       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742457779104       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742457836610       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742457849552       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742457887319       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742457893118       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742457894962       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 4.000157e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742380387815       residual = 7.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742397643303       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742399978322       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742400277600       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742400391521       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742400405360       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742400408169       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742400417363       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742400418769       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742400419207       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.033402e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006671 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0380e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01 1.371416e-01                 3 1 ON  0
ci_02 -3.532220e-02                3 1 ON  1
ci_03 -3.517361e-02                3 1 ON  2
ci_04 3.139783e-02                 3 1 ON  3
ci_05 -2.553547e-02                3 1 ON  4
ci_06 -2.526327e-02                3 1 ON  5
ci_07 2.772437e-02                 3 1 ON  6
ci_08 -8.169621e-03                3 1 ON  7
ci_09 -1.067972e-02                3 1 ON  8
ci_10 -1.062938e-02                3 1 ON  9
ci_11 1.352580e-02                 3 1 ON  10
ci_12 8.743707e-03                 3 1 ON  11
ci_13 1.244624e-02                 3 1 ON  12
ci_14 1.257954e-02                 3 1 ON  13
ci_15 7.915619e-03                 3 1 ON  14
ci_16 7.996937e-03                 3 1 ON  15
ci_17 -8.359662e-03                3 1 ON  16
ci_18 -8.014659e-03                3 1 ON  17
ci_19 9.664130e-03                 3 1 ON  18
ci_20 7.318564e-03                 3 1 ON  19
ci_21 9.156309e-03                 3 1 ON  20
ci_22 9.183732e-03                 3 1 ON  21
ci_23 5.171561e-03                 3 1 ON  22
ci_24 4.764772e-03                 3 1 ON  23
ci_25 3.361694e-03                 3 1 ON  24
ci_26 3.377005e-03                 3 1 ON  25
ci_27 3.401126e-03                 3 1 ON  26
ci_28 2.450733e-03                 3 1 ON  27
ci_29 2.304807e-03                 3 1 ON  28
ci_30 -2.016993e-03                3 1 ON  29
ci_31 -2.026036e-03                3 1 ON  30
ci_32 -1.426599e-03                3 1 ON  31
ci_33 -1.415422e-03                3 1 ON  32
ci_34 1.371270e-03                 3 1 ON  33
ci_35 1.386335e-03                 3 1 ON  34
ci_36 -1.209248e-03                3 1 ON  35
ci_37 -1.316837e-03                3 1 ON  36
ci_38 -9.248351e-04                3 1 ON  37
ci_39 -9.146455e-04                3 1 ON  38
ci_40 -1.639967e-03                3 1 ON  39
ci_41 -1.154458e-03                3 1 ON  40
ci_42 -9.311913e-04                3 1 ON  41
ci_43 -2.359344e-03                3 1 ON  42
ci_44 -1.666864e-03                3 1 ON  43
ci_45 -8.162761e-04                3 1 ON  44
ci_46 -7.462761e-04                3 1 ON  45
ci_47 2.263477e-04                 3 1 ON  46
ci_48 8.291527e-05                 3 1 ON  47
ci_49 -1.038630e-03                3 1 ON  48
ci_50 -8.843598e-04                3 1 ON  49
ci_51 6.501340e-04                 3 1 ON  50
ci_52 5.494719e-04                 3 1 ON  51
ci_53 -1.004748e-03                3 1 ON  52
ci_54 -9.313374e-04                3 1 ON  53
ci_55 -6.096668e-04                3 1 ON  54
ci_56 1.796568e-03                 3 1 ON  55
ci_57 1.748724e-03                 3 1 ON  56
ci_58 -9.264038e-04                3 1 ON  57
ci_59 -9.005181e-04                3 1 ON  58
ci_60 6.667835e-04                 3 1 ON  59
ci_61 6.795412e-04                 3 1 ON  60
ci_62 -5.045422e-04                3 1 ON  61
ci_63 -6.330923e-04                3 1 ON  62
ci_64 -4.162888e-04                3 1 ON  63
ci_65 -3.629852e-04                3 1 ON  64
ci_66 -7.658032e-04                3 1 ON  65
ci_67 -6.617109e-04                3 1 ON  66
ci_68 -5.285555e-04                3 1 ON  67
ci_69 -3.616119e-04                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8336
    reference variance = 0.58169
====================================================
  Execution time = 2.4659e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4586e-01
  Total weights = 1.9639e+06
  Execution time = 3.5035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432619358758
                                         uncertainty =       0.001931974678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432619358758
                                         uncertainty =       0.001931974678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465129815
  error estimate for blocks of size 2^( 2) =       0.000490246234
  error estimate for blocks of size 2^( 3) =       0.000513182789
  error estimate for blocks of size 2^( 4) =       0.000529223979
  error estimate for blocks of size 2^( 5) =       0.000539529732
  error estimate for blocks of size 2^( 6) =       0.000546506694
  error estimate for blocks of size 2^( 7) =       0.000551044616

      target function =      -0.747220974576
              le_mean =     -22.814558865800
             les_mean =     520.951833440011
             stat err =       0.000541576255
             autocorr =       1.355722714915
   target nu stat err =       0.000541576255
   target dn stat err =       0.003191098799
      target stat err =       0.002718699383
              std dev =       0.657792892192
             le_variance =       0.432691489018

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0212426
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432141405832
                                         uncertainty =       0.001921856633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432141405832
                                         uncertainty =       0.001921856633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464873626
  error estimate for blocks of size 2^( 2) =       0.000490050649
  error estimate for blocks of size 2^( 3) =       0.000513059049
  error estimate for blocks of size 2^( 4) =       0.000529147757
  error estimate for blocks of size 2^( 5) =       0.000539487231
  error estimate for blocks of size 2^( 6) =       0.000546482689
  error estimate for blocks of size 2^( 7) =       0.000551019875

      target function =      -0.744039552955
              le_mean =     -22.814576051956
             les_mean =     520.956449909374
             stat err =       0.000541534388
             autocorr =       1.357007550988
   target nu stat err =       0.000541534388
   target dn stat err =       0.004732144608
      target stat err =       0.003944072304
              std dev =       0.657430586832
             le_variance =       0.432214976502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432319060842
                                         uncertainty =       0.001925533987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432319060842
                                         uncertainty =       0.001925533987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464968812
  error estimate for blocks of size 2^( 2) =       0.000490119194
  error estimate for blocks of size 2^( 3) =       0.000513095625
  error estimate for blocks of size 2^( 4) =       0.000529164193
  error estimate for blocks of size 2^( 5) =       0.000539488306
  error estimate for blocks of size 2^( 6) =       0.000546475916
  error estimate for blocks of size 2^( 7) =       0.000551014713

      target function =      -0.748545205065
              le_mean =     -22.814563731310
             les_mean =     520.950466839840
             stat err =       0.000541535782
             autocorr =       1.356458991563
   target nu stat err =       0.000541535782
   target dn stat err =       0.002821515049
      target stat err =       0.002428549663
              std dev =       0.657565200470
             le_variance =       0.432391992870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432576380355
                                         uncertainty =       0.001931020262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432576380355
                                         uncertainty =       0.001931020262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465106770
  error estimate for blocks of size 2^( 2) =       0.000490227485
  error estimate for blocks of size 2^( 3) =       0.000513169139
  error estimate for blocks of size 2^( 4) =       0.000529213999
  error estimate for blocks of size 2^( 5) =       0.000539522043
  error estimate for blocks of size 2^( 6) =       0.000546500090
  error estimate for blocks of size 2^( 7) =       0.000551038851

      target function =      -0.748694124455
              le_mean =     -22.814558699487
             les_mean =     520.950059203247
             stat err =       0.000541568746
             autocorr =       1.355819462904
   target nu stat err =       0.000541568746
   target dn stat err =       0.002727090280
      target stat err =       0.002353266342
              std dev =       0.657760301972
             le_variance =       0.432648614850


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747220974576        initial
     2.5000e-01     2.5000e+00             1.4168e-03        -0.744039552955
     1.0000e+00     1.0000e+01             4.0002e-04        -0.748545205065
     4.0000e+00     4.0000e+01             1.0334e-04        -0.748694124455  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.2260e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01                 1.374108e-01 3 1  ON 0
ci_02                -3.553309e-02 3 1  ON 1
ci_03                -3.540075e-02 3 1  ON 2
ci_04                 3.156363e-02 3 1  ON 3
ci_05                -2.583214e-02 3 1  ON 4
ci_06                -2.543723e-02 3 1  ON 5
ci_07                 2.777133e-02 3 1  ON 6
ci_08                -8.306190e-03 3 1  ON 7
ci_09                -1.079718e-02 3 1  ON 8
ci_10                -1.079864e-02 3 1  ON 9
ci_11                 1.353445e-02 3 1  ON 10
ci_12                 8.720966e-03 3 1  ON 11
ci_13                 1.252617e-02 3 1  ON 12
ci_14                 1.255828e-02 3 1  ON 13
ci_15                 8.012077e-03 3 1  ON 14
ci_16                 8.100230e-03 3 1  ON 15
ci_17                -8.373566e-03 3 1  ON 16
ci_18                -8.041418e-03 3 1  ON 17
ci_19                 9.689856e-03 3 1  ON 18
ci_20                 7.414347e-03 3 1  ON 19
ci_21                 9.076649e-03 3 1  ON 20
ci_22                 9.150911e-03 3 1  ON 21
ci_23                 5.177528e-03 3 1  ON 22
ci_24                 4.730095e-03 3 1  ON 23
ci_25                 3.384666e-03 3 1  ON 24
ci_26                 3.423879e-03 3 1  ON 25
ci_27                 3.445598e-03 3 1  ON 26
ci_28                 2.465594e-03 3 1  ON 27
ci_29                 2.329396e-03 3 1  ON 28
ci_30                -1.986287e-03 3 1  ON 29
ci_31                -2.068833e-03 3 1  ON 30
ci_32                -1.431585e-03 3 1  ON 31
ci_33                -1.455310e-03 3 1  ON 32
ci_34                 1.395103e-03 3 1  ON 33
ci_35                 1.432028e-03 3 1  ON 34
ci_36                -1.285006e-03 3 1  ON 35
ci_37                -1.375507e-03 3 1  ON 36
ci_38                -9.484148e-04 3 1  ON 37
ci_39                -9.439102e-04 3 1  ON 38
ci_40                -1.618695e-03 3 1  ON 39
ci_41                -1.115338e-03 3 1  ON 40
ci_42                -9.499338e-04 3 1  ON 41
ci_43                -2.348542e-03 3 1  ON 42
ci_44                -1.666221e-03 3 1  ON 43
ci_45                -8.245134e-04 3 1  ON 44
ci_46                -7.631723e-04 3 1  ON 45
ci_47                 1.970756e-04 3 1  ON 46
ci_48                 2.506295e-05 3 1  ON 47
ci_49                -1.041293e-03 3 1  ON 48
ci_50                -8.873946e-04 3 1  ON 49
ci_51                 6.545521e-04 3 1  ON 50
ci_52                 5.685575e-04 3 1  ON 51
ci_53                -1.005850e-03 3 1  ON 52
ci_54                -9.471425e-04 3 1  ON 53
ci_55                -6.157903e-04 3 1  ON 54
ci_56                 1.774171e-03 3 1  ON 55
ci_57                 1.711002e-03 3 1  ON 56
ci_58                -9.200627e-04 3 1  ON 57
ci_59                -9.108670e-04 3 1  ON 58
ci_60                 6.125786e-04 3 1  ON 59
ci_61                 6.939599e-04 3 1  ON 60
ci_62                -5.131360e-04 3 1  ON 61
ci_63                -6.524933e-04 3 1  ON 62
ci_64                -4.919241e-04 3 1  ON 63
ci_65                -4.046567e-04 3 1  ON 64
ci_66                -7.584639e-04 3 1  ON 65
ci_67                -6.698957e-04 3 1  ON 66
ci_68                -5.298062e-04 3 1  ON 67
ci_69                -3.643495e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2646e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7938
    reference variance = 0.484313
====================================================
  Execution time = 2.7692e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4759e-01
  Total weights = 1.964376018e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434330197097
                                         uncertainty =       0.001892619401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434330197097
                                         uncertainty =       0.001892619401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466088647
  error estimate for blocks of size 2^( 2) =       0.000491215231
  error estimate for blocks of size 2^( 3) =       0.000514619241
  error estimate for blocks of size 2^( 4) =       0.000532599811
  error estimate for blocks of size 2^( 5) =       0.000542373222
  error estimate for blocks of size 2^( 6) =       0.000547759999
  error estimate for blocks of size 2^( 7) =       0.000550380565

      target function =      -0.747342000906
              le_mean =     -22.814254226379
             les_mean =     520.937788983579
             stat err =       0.000543278399
             autocorr =       1.358650729108
   target nu stat err =       0.000543278399
   target dn stat err =       0.002661963651
      target stat err =       0.002292246409
              std dev =       0.659148886428
             le_variance =       0.434477254479


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281425422638e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747348123288       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747406544808       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747415116646       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747416107521       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747416402354       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747416630267       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747416687010       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747416693916       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747416686369       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747416681927       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 4.183333e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747348123288       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747363264278       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747365457718       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747365706938       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747365779846       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747365835534       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747365849008       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747365850601       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747365848736       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747365847654       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.068786e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747348123288       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747351943556       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747352495143       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747352557531       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747352575702       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747352589538       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747352592860       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747352593250       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747352592785       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747352592517       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 2.686746e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010275 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2266e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.373039e-01 3 1  ON 0
ci_02                -3.543352e-02 3 1  ON 1
ci_03                -3.530806e-02 3 1  ON 2
ci_04                 3.148825e-02 3 1  ON 3
ci_05                -2.576342e-02 3 1  ON 4
ci_06                -2.537154e-02 3 1  ON 5
ci_07                 2.777012e-02 3 1  ON 6
ci_08                -8.265341e-03 3 1  ON 7
ci_09                -1.075118e-02 3 1  ON 8
ci_10                -1.077431e-02 3 1  ON 9
ci_11                 1.352253e-02 3 1  ON 10
ci_12                 8.701759e-03 3 1  ON 11
ci_13                 1.253084e-02 3 1  ON 12
ci_14                 1.255138e-02 3 1  ON 13
ci_15                 7.994675e-03 3 1  ON 14
ci_16                 8.089916e-03 3 1  ON 15
ci_17                -8.336691e-03 3 1  ON 16
ci_18                -8.021446e-03 3 1  ON 17
ci_19                 9.684491e-03 3 1  ON 18
ci_20                 7.389573e-03 3 1  ON 19
ci_21                 9.073366e-03 3 1  ON 20
ci_22                 9.145340e-03 3 1  ON 21
ci_23                 5.171074e-03 3 1  ON 22
ci_24                 4.728769e-03 3 1  ON 23
ci_25                 3.387443e-03 3 1  ON 24
ci_26                 3.438229e-03 3 1  ON 25
ci_27                 3.443081e-03 3 1  ON 26
ci_28                 2.470635e-03 3 1  ON 27
ci_29                 2.334898e-03 3 1  ON 28
ci_30                -1.978222e-03 3 1  ON 29
ci_31                -2.074950e-03 3 1  ON 30
ci_32                -1.424059e-03 3 1  ON 31
ci_33                -1.459344e-03 3 1  ON 32
ci_34                 1.410280e-03 3 1  ON 33
ci_35                 1.428125e-03 3 1  ON 34
ci_36                -1.284596e-03 3 1  ON 35
ci_37                -1.381251e-03 3 1  ON 36
ci_38                -9.499565e-04 3 1  ON 37
ci_39                -9.345215e-04 3 1  ON 38
ci_40                -1.614679e-03 3 1  ON 39
ci_41                -1.111333e-03 3 1  ON 40
ci_42                -9.582905e-04 3 1  ON 41
ci_43                -2.365125e-03 3 1  ON 42
ci_44                -1.683753e-03 3 1  ON 43
ci_45                -8.204169e-04 3 1  ON 44
ci_46                -7.653167e-04 3 1  ON 45
ci_47                 2.058606e-04 3 1  ON 46
ci_48                 3.594262e-05 3 1  ON 47
ci_49                -1.035562e-03 3 1  ON 48
ci_50                -8.826502e-04 3 1  ON 49
ci_51                 6.478573e-04 3 1  ON 50
ci_52                 5.640219e-04 3 1  ON 51
ci_53                -9.911533e-04 3 1  ON 52
ci_54                -9.451312e-04 3 1  ON 53
ci_55                -6.101815e-04 3 1  ON 54
ci_56                 1.773965e-03 3 1  ON 55
ci_57                 1.718301e-03 3 1  ON 56
ci_58                -9.150636e-04 3 1  ON 57
ci_59                -9.223286e-04 3 1  ON 58
ci_60                 6.223097e-04 3 1  ON 59
ci_61                 7.056199e-04 3 1  ON 60
ci_62                -5.095135e-04 3 1  ON 61
ci_63                -6.484780e-04 3 1  ON 62
ci_64                -4.869977e-04 3 1  ON 63
ci_65                -4.028115e-04 3 1  ON 64
ci_66                -7.435960e-04 3 1  ON 65
ci_67                -6.524394e-04 3 1  ON 66
ci_68                -5.254676e-04 3 1  ON 67
ci_69                -3.671307e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8159
    reference variance = 0.338098
====================================================
  Execution time = 2.5127e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5057e-01
  Total weights = 1.9642e+06
  Execution time = 3.4962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437707962399
                                         uncertainty =       0.002069873321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437707962399
                                         uncertainty =       0.002069873321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467818170
  error estimate for blocks of size 2^( 2) =       0.000491986739
  error estimate for blocks of size 2^( 3) =       0.000515395522
  error estimate for blocks of size 2^( 4) =       0.000532551828
  error estimate for blocks of size 2^( 5) =       0.000543683475
  error estimate for blocks of size 2^( 6) =       0.000548330797
  error estimate for blocks of size 2^( 7) =       0.000548964359

      target function =      -0.744560574387
              le_mean =     -22.814332838618
             les_mean =     520.944736918213
             stat err =       0.000543382615
             autocorr =       1.349140894428
   target nu stat err =       0.000543382615
   target dn stat err =       0.002683709275
      target stat err =       0.002293401850
              std dev =       0.661594801071
             le_variance =       0.437707680804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437539521249
                                         uncertainty =       0.002065946460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437539521249
                                         uncertainty =       0.002065946460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467727983
  error estimate for blocks of size 2^( 2) =       0.000491914910
  error estimate for blocks of size 2^( 3) =       0.000515342438
  error estimate for blocks of size 2^( 4) =       0.000532513780
  error estimate for blocks of size 2^( 5) =       0.000543660074
  error estimate for blocks of size 2^( 6) =       0.000548309000
  error estimate for blocks of size 2^( 7) =       0.000548952073

      target function =      -0.739072260588
              le_mean =     -22.814334007242
             les_mean =     520.951464711259
             stat err =       0.000543358732
             autocorr =       1.349542587452
   target nu stat err =       0.000543358732
   target dn stat err =       0.005920449613
      target stat err =       0.004847515463
              std dev =       0.661467257423
             le_variance =       0.437538932643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437617978040
                                         uncertainty =       0.002067978408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437617978040
                                         uncertainty =       0.002067978408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467769994
  error estimate for blocks of size 2^( 2) =       0.000491948500
  error estimate for blocks of size 2^( 3) =       0.000515367005
  error estimate for blocks of size 2^( 4) =       0.000532532312
  error estimate for blocks of size 2^( 5) =       0.000543670712
  error estimate for blocks of size 2^( 6) =       0.000548318648
  error estimate for blocks of size 2^( 7) =       0.000548955885

      target function =      -0.744938026009
              le_mean =     -22.814333298245
             les_mean =     520.944300494569
             stat err =       0.000543369389
             autocorr =       1.349353121044
   target nu stat err =       0.000543369389
   target dn stat err =       0.002665462331
      target stat err =       0.002281113785
              std dev =       0.661526669688
             le_variance =       0.437617534708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437696401328
                                         uncertainty =       0.002069629616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437696401328
                                         uncertainty =       0.002069629616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467811981
  error estimate for blocks of size 2^( 2) =       0.000491981801
  error estimate for blocks of size 2^( 3) =       0.000515391807
  error estimate for blocks of size 2^( 4) =       0.000532549227
  error estimate for blocks of size 2^( 5) =       0.000543681729
  error estimate for blocks of size 2^( 6) =       0.000548329111
  error estimate for blocks of size 2^( 7) =       0.000548963165

      target function =      -0.744744652462
              le_mean =     -22.814332859235
             les_mean =     520.944514725466
             stat err =       0.000543380808
             autocorr =       1.349167621260
   target nu stat err =       0.000543380808
   target dn stat err =       0.002676252548
      target stat err =       0.002288560449
              std dev =       0.661586047966
             le_variance =       0.437696098863


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744560574387        initial
     1.0000e+00     1.0000e+01             4.1833e-04        -0.739072260588
     4.0000e+00     4.0000e+01             1.0688e-04        -0.744938026009  <--
     1.6000e+01     1.6000e+02             2.6867e-05        -0.744744652462

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.2676e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.373039e-01 3 1  ON 0
ci_02                -3.543352e-02 3 1  ON 1
ci_03                -3.530806e-02 3 1  ON 2
ci_04                 3.148825e-02 3 1  ON 3
ci_05                -2.576342e-02 3 1  ON 4
ci_06                -2.537154e-02 3 1  ON 5
ci_07                 2.777012e-02 3 1  ON 6
ci_08                -8.265341e-03 3 1  ON 7
ci_09                -1.075118e-02 3 1  ON 8
ci_10                -1.077431e-02 3 1  ON 9
ci_11                 1.352253e-02 3 1  ON 10
ci_12                 8.701759e-03 3 1  ON 11
ci_13                 1.253084e-02 3 1  ON 12
ci_14                 1.255138e-02 3 1  ON 13
ci_15                 7.994675e-03 3 1  ON 14
ci_16                 8.089916e-03 3 1  ON 15
ci_17                -8.336691e-03 3 1  ON 16
ci_18                -8.021446e-03 3 1  ON 17
ci_19                 9.684491e-03 3 1  ON 18
ci_20                 7.389573e-03 3 1  ON 19
ci_21                 9.073366e-03 3 1  ON 20
ci_22                 9.145340e-03 3 1  ON 21
ci_23                 5.171074e-03 3 1  ON 22
ci_24                 4.728769e-03 3 1  ON 23
ci_25                 3.387443e-03 3 1  ON 24
ci_26                 3.438229e-03 3 1  ON 25
ci_27                 3.443081e-03 3 1  ON 26
ci_28                 2.470635e-03 3 1  ON 27
ci_29                 2.334898e-03 3 1  ON 28
ci_30                -1.978222e-03 3 1  ON 29
ci_31                -2.074950e-03 3 1  ON 30
ci_32                -1.424059e-03 3 1  ON 31
ci_33                -1.459344e-03 3 1  ON 32
ci_34                 1.410280e-03 3 1  ON 33
ci_35                 1.428125e-03 3 1  ON 34
ci_36                -1.284596e-03 3 1  ON 35
ci_37                -1.381251e-03 3 1  ON 36
ci_38                -9.499565e-04 3 1  ON 37
ci_39                -9.345215e-04 3 1  ON 38
ci_40                -1.614679e-03 3 1  ON 39
ci_41                -1.111333e-03 3 1  ON 40
ci_42                -9.582905e-04 3 1  ON 41
ci_43                -2.365125e-03 3 1  ON 42
ci_44                -1.683753e-03 3 1  ON 43
ci_45                -8.204169e-04 3 1  ON 44
ci_46                -7.653167e-04 3 1  ON 45
ci_47                 2.058606e-04 3 1  ON 46
ci_48                 3.594262e-05 3 1  ON 47
ci_49                -1.035562e-03 3 1  ON 48
ci_50                -8.826502e-04 3 1  ON 49
ci_51                 6.478573e-04 3 1  ON 50
ci_52                 5.640219e-04 3 1  ON 51
ci_53                -9.911533e-04 3 1  ON 52
ci_54                -9.451312e-04 3 1  ON 53
ci_55                -6.101815e-04 3 1  ON 54
ci_56                 1.773965e-03 3 1  ON 55
ci_57                 1.718301e-03 3 1  ON 56
ci_58                -9.150636e-04 3 1  ON 57
ci_59                -9.223286e-04 3 1  ON 58
ci_60                 6.223097e-04 3 1  ON 59
ci_61                 7.056199e-04 3 1  ON 60
ci_62                -5.095135e-04 3 1  ON 61
ci_63                -6.484780e-04 3 1  ON 62
ci_64                -4.869977e-04 3 1  ON 63
ci_65                -4.028115e-04 3 1  ON 64
ci_66                -7.435960e-04 3 1  ON 65
ci_67                -6.524394e-04 3 1  ON 66
ci_68                -5.254676e-04 3 1  ON 67
ci_69                -3.671307e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4949e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8087
    reference variance = 0.836573
====================================================
  Execution time = 2.5876e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4401e-01
  Total weights = 1.964159197e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5970e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432751448566
                                         uncertainty =       0.001832124025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432751448566
                                         uncertainty =       0.001832124025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465180025
  error estimate for blocks of size 2^( 2) =       0.000490305937
  error estimate for blocks of size 2^( 3) =       0.000514011394
  error estimate for blocks of size 2^( 4) =       0.000531074657
  error estimate for blocks of size 2^( 5) =       0.000541422223
  error estimate for blocks of size 2^( 6) =       0.000546256391
  error estimate for blocks of size 2^( 7) =       0.000547215199

      target function =      -0.750329436196
              le_mean =     -22.813656184181
             les_mean =     520.906914594713
             stat err =       0.000541492118
             autocorr =       1.355008947655
   target nu stat err =       0.000541492118
   target dn stat err =       0.002195886019
      target stat err =       0.001933747865
              std dev =       0.657863900044
             le_variance =       0.432784910981


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281365618418e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750333453096       residual = 6.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750389002009       residual = 9.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750397148497       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750398394805       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750398948973       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750399147078       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750399168834       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750399140837       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750399131908       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750399136755       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 4.109668e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750333453096       residual = 6.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750347854297       residual = 9.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750349941694       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750350255233       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750350393042       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750350440959       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750350445770       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750350438880       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750350436756       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750350437922       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.049828e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750333453096       residual = 6.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750337087016       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750337612122       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750337690616       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750337725013       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750337736886       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750337738049       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750337736334       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750337735810       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750337736099       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 2.638998e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018551 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0489e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.371989e-01 3 1  ON 0
ci_02                -3.535026e-02 3 1  ON 1
ci_03                -3.521965e-02 3 1  ON 2
ci_04                 3.140951e-02 3 1  ON 3
ci_05                -2.570433e-02 3 1  ON 4
ci_06                -2.530271e-02 3 1  ON 5
ci_07                 2.774973e-02 3 1  ON 6
ci_08                -8.224308e-03 3 1  ON 7
ci_09                -1.072542e-02 3 1  ON 8
ci_10                -1.075936e-02 3 1  ON 9
ci_11                 1.350866e-02 3 1  ON 10
ci_12                 8.687222e-03 3 1  ON 11
ci_13                 1.252587e-02 3 1  ON 12
ci_14                 1.254026e-02 3 1  ON 13
ci_15                 7.968001e-03 3 1  ON 14
ci_16                 8.069944e-03 3 1  ON 15
ci_17                -8.321741e-03 3 1  ON 16
ci_18                -8.015880e-03 3 1  ON 17
ci_19                 9.686194e-03 3 1  ON 18
ci_20                 7.387212e-03 3 1  ON 19
ci_21                 9.067538e-03 3 1  ON 20
ci_22                 9.138350e-03 3 1  ON 21
ci_23                 5.165595e-03 3 1  ON 22
ci_24                 4.729878e-03 3 1  ON 23
ci_25                 3.375485e-03 3 1  ON 24
ci_26                 3.439410e-03 3 1  ON 25
ci_27                 3.440165e-03 3 1  ON 26
ci_28                 2.472018e-03 3 1  ON 27
ci_29                 2.335440e-03 3 1  ON 28
ci_30                -1.970993e-03 3 1  ON 29
ci_31                -2.049766e-03 3 1  ON 30
ci_32                -1.428580e-03 3 1  ON 31
ci_33                -1.466355e-03 3 1  ON 32
ci_34                 1.416063e-03 3 1  ON 33
ci_35                 1.419872e-03 3 1  ON 34
ci_36                -1.282018e-03 3 1  ON 35
ci_37                -1.385312e-03 3 1  ON 36
ci_38                -9.479366e-04 3 1  ON 37
ci_39                -9.282324e-04 3 1  ON 38
ci_40                -1.613701e-03 3 1  ON 39
ci_41                -1.113738e-03 3 1  ON 40
ci_42                -9.580748e-04 3 1  ON 41
ci_43                -2.381172e-03 3 1  ON 42
ci_44                -1.682569e-03 3 1  ON 43
ci_45                -8.205505e-04 3 1  ON 44
ci_46                -7.537965e-04 3 1  ON 45
ci_47                 2.202350e-04 3 1  ON 46
ci_48                 5.290717e-05 3 1  ON 47
ci_49                -1.027927e-03 3 1  ON 48
ci_50                -8.840711e-04 3 1  ON 49
ci_51                 6.416329e-04 3 1  ON 50
ci_52                 5.687372e-04 3 1  ON 51
ci_53                -9.937811e-04 3 1  ON 52
ci_54                -9.435656e-04 3 1  ON 53
ci_55                -6.042882e-04 3 1  ON 54
ci_56                 1.774062e-03 3 1  ON 55
ci_57                 1.725932e-03 3 1  ON 56
ci_58                -9.231172e-04 3 1  ON 57
ci_59                -9.321250e-04 3 1  ON 58
ci_60                 6.281493e-04 3 1  ON 59
ci_61                 7.049248e-04 3 1  ON 60
ci_62                -5.215051e-04 3 1  ON 61
ci_63                -6.455339e-04 3 1  ON 62
ci_64                -5.007699e-04 3 1  ON 63
ci_65                -4.014473e-04 3 1  ON 64
ci_66                -7.355632e-04 3 1  ON 65
ci_67                -6.545576e-04 3 1  ON 66
ci_68                -5.321078e-04 3 1  ON 67
ci_69                -3.788804e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.824
    reference variance = 0.382918
====================================================
  Execution time = 2.5130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4412e-01
  Total weights = 1.9639e+06
  Execution time = 3.5079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433318390139
                                         uncertainty =       0.002482977274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433318390139
                                         uncertainty =       0.002482977274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465453224
  error estimate for blocks of size 2^( 2) =       0.000490041483
  error estimate for blocks of size 2^( 3) =       0.000513069577
  error estimate for blocks of size 2^( 4) =       0.000530047265
  error estimate for blocks of size 2^( 5) =       0.000540834935
  error estimate for blocks of size 2^( 6) =       0.000546785563
  error estimate for blocks of size 2^( 7) =       0.000549790567

      target function =      -0.750183250319
              le_mean =     -22.814667390558
             les_mean =     520.953235524920
             stat err =       0.000541864583
             autocorr =       1.355281297265
   target nu stat err =       0.000541864583
   target dn stat err =       0.003112430832
      target stat err =       0.002676058117
              std dev =       0.658250262133
             le_variance =       0.433293407598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433166223624
                                         uncertainty =       0.002485218621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433166223624
                                         uncertainty =       0.002485218621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465371441
  error estimate for blocks of size 2^( 2) =       0.000489977127
  error estimate for blocks of size 2^( 3) =       0.000513023625
  error estimate for blocks of size 2^( 4) =       0.000530012854
  error estimate for blocks of size 2^( 5) =       0.000540811555
  error estimate for blocks of size 2^( 6) =       0.000546765690
  error estimate for blocks of size 2^( 7) =       0.000549775625

      target function =      -0.750314464041
              le_mean =     -22.814667875610
             les_mean =     520.953101034245
             stat err =       0.000541841431
             autocorr =       1.355641836075
   target nu stat err =       0.000541841431
   target dn stat err =       0.003110533641
      target stat err =       0.002675418097
              std dev =       0.658134603985
             le_variance =       0.433141156963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433238259314
                                         uncertainty =       0.002484127034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433238259314
                                         uncertainty =       0.002484127034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465410160
  error estimate for blocks of size 2^( 2) =       0.000490007397
  error estimate for blocks of size 2^( 3) =       0.000513044979
  error estimate for blocks of size 2^( 4) =       0.000530028598
  error estimate for blocks of size 2^( 5) =       0.000540821995
  error estimate for blocks of size 2^( 6) =       0.000546774469
  error estimate for blocks of size 2^( 7) =       0.000549782014

      target function =      -0.750284625240
              le_mean =     -22.814667361672
             les_mean =     520.953113192006
             stat err =       0.000541851769
             autocorr =       1.355468008646
   target nu stat err =       0.000541851769
   target dn stat err =       0.003110858234
      target stat err =       0.002675476205
              std dev =       0.658189360014
             le_variance =       0.433213233635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433308114274
                                         uncertainty =       0.002483118561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433308114274
                                         uncertainty =       0.002483118561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465447702
  error estimate for blocks of size 2^( 2) =       0.000490037086
  error estimate for blocks of size 2^( 3) =       0.000513066374
  error estimate for blocks of size 2^( 4) =       0.000530044802
  error estimate for blocks of size 2^( 5) =       0.000540833198
  error estimate for blocks of size 2^( 6) =       0.000546784060
  error estimate for blocks of size 2^( 7) =       0.000549789401

      target function =      -0.750188296671
              le_mean =     -22.814667350987
             les_mean =     520.953227695433
             stat err =       0.000541862865
             autocorr =       1.355304867082
   target nu stat err =       0.000541862865
   target dn stat err =       0.003112147846
      target stat err =       0.002675861725
              std dev =       0.658242452571
             le_variance =       0.433283126367


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750183250319        initial
     1.0000e+00     1.0000e+01             4.1097e-04        -0.750314464041  <--
     4.0000e+00     4.0000e+01             1.0498e-04        -0.750284625240
     1.6000e+01     1.6000e+02             2.6390e-05        -0.750188296671

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.2749e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.368930e-01 3 1  ON 0
ci_02                -3.511161e-02 3 1  ON 1
ci_03                -3.496611e-02 3 1  ON 2
ci_04                 3.118503e-02 3 1  ON 3
ci_05                -2.553535e-02 3 1  ON 4
ci_06                -2.510571e-02 3 1  ON 5
ci_07                 2.769079e-02 3 1  ON 6
ci_08                -8.106984e-03 3 1  ON 7
ci_09                -1.065113e-02 3 1  ON 8
ci_10                -1.071622e-02 3 1  ON 9
ci_11                 1.346894e-02 3 1  ON 10
ci_12                 8.645613e-03 3 1  ON 11
ci_13                 1.251167e-02 3 1  ON 12
ci_14                 1.250772e-02 3 1  ON 13
ci_15                 7.891429e-03 3 1  ON 14
ci_16                 8.012545e-03 3 1  ON 15
ci_17                -8.278472e-03 3 1  ON 16
ci_18                -7.999697e-03 3 1  ON 17
ci_19                 9.691171e-03 3 1  ON 18
ci_20                 7.380478e-03 3 1  ON 19
ci_21                 9.050589e-03 3 1  ON 20
ci_22                 9.117879e-03 3 1  ON 21
ci_23                 5.149998e-03 3 1  ON 22
ci_24                 4.733330e-03 3 1  ON 23
ci_25                 3.341441e-03 3 1  ON 24
ci_26                 3.442869e-03 3 1  ON 25
ci_27                 3.431920e-03 3 1  ON 26
ci_28                 2.475690e-03 3 1  ON 27
ci_29                 2.336754e-03 3 1  ON 28
ci_30                -1.949849e-03 3 1  ON 29
ci_31                -1.976490e-03 3 1  ON 30
ci_32                -1.441579e-03 3 1  ON 31
ci_33                -1.486494e-03 3 1  ON 32
ci_34                 1.432992e-03 3 1  ON 33
ci_35                 1.396553e-03 3 1  ON 34
ci_36                -1.274567e-03 3 1  ON 35
ci_37                -1.396798e-03 3 1  ON 36
ci_38                -9.421168e-04 3 1  ON 37
ci_39                -9.102144e-04 3 1  ON 38
ci_40                -1.610871e-03 3 1  ON 39
ci_41                -1.120755e-03 3 1  ON 40
ci_42                -9.576347e-04 3 1  ON 41
ci_43                -2.427088e-03 3 1  ON 42
ci_44                -1.678883e-03 3 1  ON 43
ci_45                -8.208639e-04 3 1  ON 44
ci_46                -7.208752e-04 3 1  ON 45
ci_47                 2.622171e-04 3 1  ON 46
ci_48                 1.022311e-04 3 1  ON 47
ci_49                -1.006078e-03 3 1  ON 48
ci_50                -8.880932e-04 3 1  ON 49
ci_51                 6.237852e-04 3 1  ON 50
ci_52                 5.821435e-04 3 1  ON 51
ci_53                -1.001183e-03 3 1  ON 52
ci_54                -9.390384e-04 3 1  ON 53
ci_55                -5.874238e-04 3 1  ON 54
ci_56                 1.774311e-03 3 1  ON 55
ci_57                 1.747662e-03 3 1  ON 56
ci_58                -9.461480e-04 3 1  ON 57
ci_59                -9.601170e-04 3 1  ON 58
ci_60                 6.451695e-04 3 1  ON 59
ci_61                 7.028443e-04 3 1  ON 60
ci_62                -5.555269e-04 3 1  ON 61
ci_63                -6.370739e-04 3 1  ON 62
ci_64                -5.400352e-04 3 1  ON 63
ci_65                -3.975296e-04 3 1  ON 64
ci_66                -7.125762e-04 3 1  ON 65
ci_67                -6.606306e-04 3 1  ON 66
ci_68                -5.510539e-04 3 1  ON 67
ci_69                -4.125559e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3254e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8686
    reference variance = 0.380461
====================================================
  Execution time = 2.5845e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 5.1492e-01
  Total weights = 1.964383790e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445292511454
                                         uncertainty =       0.006264584503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445292511454
                                         uncertainty =       0.006264584503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471840794
  error estimate for blocks of size 2^( 2) =       0.000496372161
  error estimate for blocks of size 2^( 3) =       0.000519455511
  error estimate for blocks of size 2^( 4) =       0.000536737064
  error estimate for blocks of size 2^( 5) =       0.000548677181
  error estimate for blocks of size 2^( 6) =       0.000555716668
  error estimate for blocks of size 2^( 7) =       0.000560026471

      target function =      -0.692415882597
              le_mean =     -22.814247178475
             les_mean =     521.004792156062
             stat err =       0.000550289346
             autocorr =       1.360163876623
   target nu stat err =       0.000550289346
   target dn stat err =       0.062651052052
      target stat err =       0.044864822275
              std dev =       0.667283650338
             le_variance =       0.445267470009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281424717848e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.695315690413       residual = 2.08e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.704334871345       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.704655266143       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.704704584657       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.704718373668       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.704722817726       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.704724609904       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.704724841675       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.704725180582       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.704725240815       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.704725263485       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.704725269581       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 2.988939e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.695315690413       residual = 2.08e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.697967166087       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.698057862323       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.698070990025       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.698074397920       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.698075383133       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.698075756095       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.698075806157       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.698075897393       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.698075914701       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.698075921015       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 8.797107e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.695315690413       residual = 2.08e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696008653909       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696032077619       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696035403744       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696036247847       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696036483792       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696036571777       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696036583994       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696036607256       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696036611711       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696036613305       residual = 5.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 2.300102e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029063 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0390e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.361518e-01 3 1  ON 0
ci_02                -3.469156e-02 3 1  ON 1
ci_03                -3.434736e-02 3 1  ON 2
ci_04                 3.074225e-02 3 1  ON 3
ci_05                -2.581937e-02 3 1  ON 4
ci_06                -2.500271e-02 3 1  ON 5
ci_07                 2.753706e-02 3 1  ON 6
ci_08                -7.799399e-03 3 1  ON 7
ci_09                -1.054637e-02 3 1  ON 8
ci_10                -1.044876e-02 3 1  ON 9
ci_11                 1.353259e-02 3 1  ON 10
ci_12                 8.589686e-03 3 1  ON 11
ci_13                 1.254374e-02 3 1  ON 12
ci_14                 1.251075e-02 3 1  ON 13
ci_15                 7.831375e-03 3 1  ON 14
ci_16                 8.022084e-03 3 1  ON 15
ci_17                -8.563965e-03 3 1  ON 16
ci_18                -8.019942e-03 3 1  ON 17
ci_19                 9.921686e-03 3 1  ON 18
ci_20                 7.333075e-03 3 1  ON 19
ci_21                 8.988044e-03 3 1  ON 20
ci_22                 9.045284e-03 3 1  ON 21
ci_23                 4.937478e-03 3 1  ON 22
ci_24                 4.673889e-03 3 1  ON 23
ci_25                 3.374373e-03 3 1  ON 24
ci_26                 3.469127e-03 3 1  ON 25
ci_27                 3.423233e-03 3 1  ON 26
ci_28                 2.868751e-03 3 1  ON 27
ci_29                 2.273762e-03 3 1  ON 28
ci_30                -1.845058e-03 3 1  ON 29
ci_31                -1.856233e-03 3 1  ON 30
ci_32                -1.784955e-03 3 1  ON 31
ci_33                -1.290558e-03 3 1  ON 32
ci_34                 2.096036e-03 3 1  ON 33
ci_35                 1.400705e-03 3 1  ON 34
ci_36                -1.244214e-03 3 1  ON 35
ci_37                -1.386813e-03 3 1  ON 36
ci_38                -8.800336e-04 3 1  ON 37
ci_39                -7.590206e-04 3 1  ON 38
ci_40                -1.896399e-03 3 1  ON 39
ci_41                -1.374980e-03 3 1  ON 40
ci_42                -1.184164e-03 3 1  ON 41
ci_43                -3.306798e-03 3 1  ON 42
ci_44                -1.643178e-03 3 1  ON 43
ci_45                -7.980464e-04 3 1  ON 44
ci_46                -7.805901e-04 3 1  ON 45
ci_47                 4.667139e-04 3 1  ON 46
ci_48                 1.063167e-04 3 1  ON 47
ci_49                -1.009590e-03 3 1  ON 48
ci_50                -8.468244e-04 3 1  ON 49
ci_51                 5.740694e-04 3 1  ON 50
ci_52                 5.735837e-04 3 1  ON 51
ci_53                -7.632409e-04 3 1  ON 52
ci_54                -9.492319e-04 3 1  ON 53
ci_55                -5.623891e-04 3 1  ON 54
ci_56                 1.940692e-03 3 1  ON 55
ci_57                 1.256284e-03 3 1  ON 56
ci_58                -8.636317e-04 3 1  ON 57
ci_59                -9.596237e-04 3 1  ON 58
ci_60                 5.222974e-04 3 1  ON 59
ci_61                 6.759712e-04 3 1  ON 60
ci_62                -2.842800e-04 3 1  ON 61
ci_63                -9.097354e-04 3 1  ON 62
ci_64                -5.364284e-04 3 1  ON 63
ci_65                -3.746806e-04 3 1  ON 64
ci_66                -6.882012e-04 3 1  ON 65
ci_67                -6.631809e-04 3 1  ON 66
ci_68                -4.836341e-04 3 1  ON 67
ci_69                 4.216442e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8275
    reference variance = 0.481433
====================================================
  Execution time = 2.5122e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4785e-01
  Total weights = 1.9641e+06
  Execution time = 3.4991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434709230833
                                         uncertainty =       0.002217509867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434709230833
                                         uncertainty =       0.002217509867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466195672
  error estimate for blocks of size 2^( 2) =       0.000491089142
  error estimate for blocks of size 2^( 3) =       0.000514962074
  error estimate for blocks of size 2^( 4) =       0.000532341593
  error estimate for blocks of size 2^( 5) =       0.000543700917
  error estimate for blocks of size 2^( 6) =       0.000549870401
  error estimate for blocks of size 2^( 7) =       0.000552811697

      target function =      -0.744788878812
              le_mean =     -22.813712354546
             les_mean =     520.916133267566
             stat err =       0.000544681152
             autocorr =       1.365048930334
   target nu stat err =       0.000544681152
   target dn stat err =       0.004437409315
      target stat err =       0.003707437006
              std dev =       0.659300242580
             le_variance =       0.434676809866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436860045340
                                         uncertainty =       0.003112716825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436860045340
                                         uncertainty =       0.003112716825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467343400
  error estimate for blocks of size 2^( 2) =       0.000492225574
  error estimate for blocks of size 2^( 3) =       0.000516080279
  error estimate for blocks of size 2^( 4) =       0.000533471543
  error estimate for blocks of size 2^( 5) =       0.000544836588
  error estimate for blocks of size 2^( 6) =       0.000550824829
  error estimate for blocks of size 2^( 7) =       0.000553579135

      target function =      -0.722170090441
              le_mean =     -22.813699454379
             les_mean =     520.943352319850
             stat err =       0.000545678024
             autocorr =       1.363329086060
   target nu stat err =       0.000545678024
   target dn stat err =       0.021867569824
      target stat err =       0.016967469305
              std dev =       0.660923373912
             le_variance =       0.436819706183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434330903437
                                         uncertainty =       0.002203108172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434330903437
                                         uncertainty =       0.002203108172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465992357
  error estimate for blocks of size 2^( 2) =       0.000490926398
  error estimate for blocks of size 2^( 3) =       0.000514852275
  error estimate for blocks of size 2^( 4) =       0.000532251609
  error estimate for blocks of size 2^( 5) =       0.000543649183
  error estimate for blocks of size 2^( 6) =       0.000549789641
  error estimate for blocks of size 2^( 7) =       0.000552663125

      target function =      -0.746262995796
              le_mean =     -22.813697675971
             les_mean =     520.913687777810
             stat err =       0.000544588389
             autocorr =       1.365775029253
   target nu stat err =       0.000544588389
   target dn stat err =       0.003399376285
      target stat err =       0.002877472148
              std dev =       0.659012711584
             le_variance =       0.434297754029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434607411274
                                         uncertainty =       0.002212543302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434607411274
                                         uncertainty =       0.002212543302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466141043
  error estimate for blocks of size 2^( 2) =       0.000491041345
  error estimate for blocks of size 2^( 3) =       0.000514922105
  error estimate for blocks of size 2^( 4) =       0.000532304373
  error estimate for blocks of size 2^( 5) =       0.000543668164
  error estimate for blocks of size 2^( 6) =       0.000549834736
  error estimate for blocks of size 2^( 7) =       0.000552766878

      target function =      -0.745663978487
              le_mean =     -22.813705494895
             les_mean =     520.914763598156
             stat err =       0.000544643538
             autocorr =       1.365180333645
   target nu stat err =       0.000544643538
   target dn stat err =       0.004045576834
      target stat err =       0.003396913729
              std dev =       0.659222984778
             le_variance =       0.434574943660


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744788878812        initial
     2.5000e-01     2.5000e+00             2.9889e-03        -0.722170090441
     1.0000e+00     1.0000e+01             8.7971e-04        -0.746262995796  <--
     4.0000e+00     4.0000e+01             2.3001e-04        -0.745663978487

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.2666e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.361518e-01 3 1  ON 0
ci_02                -3.469156e-02 3 1  ON 1
ci_03                -3.434736e-02 3 1  ON 2
ci_04                 3.074225e-02 3 1  ON 3
ci_05                -2.581937e-02 3 1  ON 4
ci_06                -2.500271e-02 3 1  ON 5
ci_07                 2.753706e-02 3 1  ON 6
ci_08                -7.799399e-03 3 1  ON 7
ci_09                -1.054637e-02 3 1  ON 8
ci_10                -1.044876e-02 3 1  ON 9
ci_11                 1.353259e-02 3 1  ON 10
ci_12                 8.589686e-03 3 1  ON 11
ci_13                 1.254374e-02 3 1  ON 12
ci_14                 1.251075e-02 3 1  ON 13
ci_15                 7.831375e-03 3 1  ON 14
ci_16                 8.022084e-03 3 1  ON 15
ci_17                -8.563965e-03 3 1  ON 16
ci_18                -8.019942e-03 3 1  ON 17
ci_19                 9.921686e-03 3 1  ON 18
ci_20                 7.333075e-03 3 1  ON 19
ci_21                 8.988044e-03 3 1  ON 20
ci_22                 9.045284e-03 3 1  ON 21
ci_23                 4.937478e-03 3 1  ON 22
ci_24                 4.673889e-03 3 1  ON 23
ci_25                 3.374373e-03 3 1  ON 24
ci_26                 3.469127e-03 3 1  ON 25
ci_27                 3.423233e-03 3 1  ON 26
ci_28                 2.868751e-03 3 1  ON 27
ci_29                 2.273762e-03 3 1  ON 28
ci_30                -1.845058e-03 3 1  ON 29
ci_31                -1.856233e-03 3 1  ON 30
ci_32                -1.784955e-03 3 1  ON 31
ci_33                -1.290558e-03 3 1  ON 32
ci_34                 2.096036e-03 3 1  ON 33
ci_35                 1.400705e-03 3 1  ON 34
ci_36                -1.244214e-03 3 1  ON 35
ci_37                -1.386813e-03 3 1  ON 36
ci_38                -8.800336e-04 3 1  ON 37
ci_39                -7.590206e-04 3 1  ON 38
ci_40                -1.896399e-03 3 1  ON 39
ci_41                -1.374980e-03 3 1  ON 40
ci_42                -1.184164e-03 3 1  ON 41
ci_43                -3.306798e-03 3 1  ON 42
ci_44                -1.643178e-03 3 1  ON 43
ci_45                -7.980464e-04 3 1  ON 44
ci_46                -7.805901e-04 3 1  ON 45
ci_47                 4.667139e-04 3 1  ON 46
ci_48                 1.063167e-04 3 1  ON 47
ci_49                -1.009590e-03 3 1  ON 48
ci_50                -8.468244e-04 3 1  ON 49
ci_51                 5.740694e-04 3 1  ON 50
ci_52                 5.735837e-04 3 1  ON 51
ci_53                -7.632409e-04 3 1  ON 52
ci_54                -9.492319e-04 3 1  ON 53
ci_55                -5.623891e-04 3 1  ON 54
ci_56                 1.940692e-03 3 1  ON 55
ci_57                 1.256284e-03 3 1  ON 56
ci_58                -8.636317e-04 3 1  ON 57
ci_59                -9.596237e-04 3 1  ON 58
ci_60                 5.222974e-04 3 1  ON 59
ci_61                 6.759712e-04 3 1  ON 60
ci_62                -2.842800e-04 3 1  ON 61
ci_63                -9.097354e-04 3 1  ON 62
ci_64                -5.364284e-04 3 1  ON 63
ci_65                -3.746806e-04 3 1  ON 64
ci_66                -6.882012e-04 3 1  ON 65
ci_67                -6.631809e-04 3 1  ON 66
ci_68                -4.836341e-04 3 1  ON 67
ci_69                 4.216442e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3072e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7889
    reference variance = 0.315555
====================================================
  Execution time = 2.5896e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4959e-01
  Total weights = 1.964121410e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5186e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434919947962
                                         uncertainty =       0.002221788182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434919947962
                                         uncertainty =       0.002221788182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466329711
  error estimate for blocks of size 2^( 2) =       0.000491613358
  error estimate for blocks of size 2^( 3) =       0.000515290614
  error estimate for blocks of size 2^( 4) =       0.000531650627
  error estimate for blocks of size 2^( 5) =       0.000543046593
  error estimate for blocks of size 2^( 6) =       0.000550403044
  error estimate for blocks of size 2^( 7) =       0.000555757741

      target function =      -0.745679295708
              le_mean =     -22.813688576532
             les_mean =     520.913978469406
             stat err =       0.000545214501
             autocorr =       1.366937395142
   target nu stat err =       0.000545214501
   target dn stat err =       0.003389933323
      target stat err =       0.002865550506
              std dev =       0.659489801349
             le_variance =       0.434926798083


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281368857653e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745689311524       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745880231983       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745970317516       residual = 5.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745986337079       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745991803465       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745993659896       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745994625107       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745994835915       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745994851197       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745994836295       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745994872907       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745994875616       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.685800e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745689311524       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745745161981       residual = 4.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745770007452       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745774262480       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745775654577       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745776086263       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745776301579       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745776344982       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745776347285       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745776343973       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745776351780       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 4.575502e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745689311524       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745703894207       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745710265546       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745711344536       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745711693171       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745711798341       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745711850239       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745711860461       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745711860946       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745711860153       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745711862008       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.169067e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.038559 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0433e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.356942e-01 3 1  ON 0
ci_02                -3.440707e-02 3 1  ON 1
ci_03                -3.403898e-02 3 1  ON 2
ci_04                 3.041916e-02 3 1  ON 3
ci_05                -2.566234e-02 3 1  ON 4
ci_06                -2.473182e-02 3 1  ON 5
ci_07                 2.747040e-02 3 1  ON 6
ci_08                -7.682522e-03 3 1  ON 7
ci_09                -1.035535e-02 3 1  ON 8
ci_10                -1.029019e-02 3 1  ON 9
ci_11                 1.343917e-02 3 1  ON 10
ci_12                 8.442300e-03 3 1  ON 11
ci_13                 1.260177e-02 3 1  ON 12
ci_14                 1.255560e-02 3 1  ON 13
ci_15                 7.757332e-03 3 1  ON 14
ci_16                 7.928221e-03 3 1  ON 15
ci_17                -8.485384e-03 3 1  ON 16
ci_18                -7.852628e-03 3 1  ON 17
ci_19                 9.888554e-03 3 1  ON 18
ci_20                 7.330546e-03 3 1  ON 19
ci_21                 9.019647e-03 3 1  ON 20
ci_22                 9.024011e-03 3 1  ON 21
ci_23                 4.897287e-03 3 1  ON 22
ci_24                 4.584973e-03 3 1  ON 23
ci_25                 3.362169e-03 3 1  ON 24
ci_26                 3.445931e-03 3 1  ON 25
ci_27                 3.401753e-03 3 1  ON 26
ci_28                 2.891010e-03 3 1  ON 27
ci_29                 2.282942e-03 3 1  ON 28
ci_30                -1.861402e-03 3 1  ON 29
ci_31                -1.825998e-03 3 1  ON 30
ci_32                -1.803698e-03 3 1  ON 31
ci_33                -1.334269e-03 3 1  ON 32
ci_34                 1.937622e-03 3 1  ON 33
ci_35                 1.341017e-03 3 1  ON 34
ci_36                -1.246642e-03 3 1  ON 35
ci_37                -1.316624e-03 3 1  ON 36
ci_38                -8.561921e-04 3 1  ON 37
ci_39                -7.039409e-04 3 1  ON 38
ci_40                -1.808685e-03 3 1  ON 39
ci_41                -1.410830e-03 3 1  ON 40
ci_42                -1.240216e-03 3 1  ON 41
ci_43                -3.301435e-03 3 1  ON 42
ci_44                -1.622420e-03 3 1  ON 43
ci_45                -7.840306e-04 3 1  ON 44
ci_46                -7.226594e-04 3 1  ON 45
ci_47                 5.610673e-04 3 1  ON 46
ci_48                 1.074279e-04 3 1  ON 47
ci_49                -9.705254e-04 3 1  ON 48
ci_50                -8.094766e-04 3 1  ON 49
ci_51                 5.443442e-04 3 1  ON 50
ci_52                 5.363380e-04 3 1  ON 51
ci_53                -7.464836e-04 3 1  ON 52
ci_54                -9.721817e-04 3 1  ON 53
ci_55                -5.594768e-04 3 1  ON 54
ci_56                 1.921400e-03 3 1  ON 55
ci_57                 1.263235e-03 3 1  ON 56
ci_58                -8.566999e-04 3 1  ON 57
ci_59                -9.729532e-04 3 1  ON 58
ci_60                 5.363598e-04 3 1  ON 59
ci_61                 7.767725e-04 3 1  ON 60
ci_62                -2.930648e-04 3 1  ON 61
ci_63                -8.853767e-04 3 1  ON 62
ci_64                -5.077929e-04 3 1  ON 63
ci_65                -3.650414e-04 3 1  ON 64
ci_66                -6.849912e-04 3 1  ON 65
ci_67                -6.275330e-04 3 1  ON 66
ci_68                -4.975718e-04 3 1  ON 67
ci_69                 2.745203e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7551
    reference variance = 0.647747
====================================================
  Execution time = 2.5142e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4513e-01
  Total weights = 1.9641e+06
  Execution time = 3.4945e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434063046983
                                         uncertainty =       0.001905848506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434063046983
                                         uncertainty =       0.001905848506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465855398
  error estimate for blocks of size 2^( 2) =       0.000490806765
  error estimate for blocks of size 2^( 3) =       0.000514444186
  error estimate for blocks of size 2^( 4) =       0.000531556250
  error estimate for blocks of size 2^( 5) =       0.000541980083
  error estimate for blocks of size 2^( 6) =       0.000549743459
  error estimate for blocks of size 2^( 7) =       0.000552275945

      target function =      -0.747915912911
              le_mean =     -22.815180921942
             les_mean =     520.979389274148
             stat err =       0.000543888934
             autocorr =       1.363070069879
   target nu stat err =       0.000543888934
   target dn stat err =       0.002697724183
      target stat err =       0.002327747064
              std dev =       0.658819021703
             le_variance =       0.434042503357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433633995844
                                         uncertainty =       0.001901030872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433633995844
                                         uncertainty =       0.001901030872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465625569
  error estimate for blocks of size 2^( 2) =       0.000490652692
  error estimate for blocks of size 2^( 3) =       0.000514358994
  error estimate for blocks of size 2^( 4) =       0.000531520516
  error estimate for blocks of size 2^( 5) =       0.000541987520
  error estimate for blocks of size 2^( 6) =       0.000549741279
  error estimate for blocks of size 2^( 7) =       0.000552291458

      target function =      -0.742541762826
              le_mean =     -22.815184313080
             les_mean =     520.985986733762
             stat err =       0.000543885193
             autocorr =       1.364397231036
   target nu stat err =       0.000543885193
   target dn stat err =       0.007534674883
      target stat err =       0.006216958383
              std dev =       0.658493995138
             le_variance =       0.433614341633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433794826823
                                         uncertainty =       0.001903184985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433794826823
                                         uncertainty =       0.001903184985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465711686
  error estimate for blocks of size 2^( 2) =       0.000490705920
  error estimate for blocks of size 2^( 3) =       0.000514382120
  error estimate for blocks of size 2^( 4) =       0.000531521677
  error estimate for blocks of size 2^( 5) =       0.000541970132
  error estimate for blocks of size 2^( 6) =       0.000549727094
  error estimate for blocks of size 2^( 7) =       0.000552268948

      target function =      -0.749445657095
              le_mean =     -22.815179009762
             les_mean =     520.977471609724
             stat err =       0.000543871963
             autocorr =       1.363826332038
   target nu stat err =       0.000543871963
   target dn stat err =       0.002332569777
      target stat err =       0.002043505845
              std dev =       0.658615781996
             le_variance =       0.433774748294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434024685665
                                         uncertainty =       0.001905479178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434024685665
                                         uncertainty =       0.001905479178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465834833
  error estimate for blocks of size 2^( 2) =       0.000490791408
  error estimate for blocks of size 2^( 3) =       0.000514433746
  error estimate for blocks of size 2^( 4) =       0.000531549343
  error estimate for blocks of size 2^( 5) =       0.000541977754
  error estimate for blocks of size 2^( 6) =       0.000549739848
  error estimate for blocks of size 2^( 7) =       0.000552273269

      target function =      -0.742015256643
              le_mean =     -22.815180420898
             les_mean =     520.986462299476
             stat err =       0.000543885054
             autocorr =       1.363170968590
   target nu stat err =       0.000543885054
   target dn stat err =       0.006807470102
      target stat err =       0.005614816619
              std dev =       0.658789938721
             le_variance =       0.434004183360


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747915912911        initial
     2.5000e-01     2.5000e+00             1.6858e-03        -0.742541762826
     1.0000e+00     1.0000e+01             4.5755e-04        -0.749445657095  <--
     4.0000e+00     4.0000e+01             1.1691e-04        -0.742015256643

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.2709e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.356942e-01 3 1  ON 0
ci_02                -3.440707e-02 3 1  ON 1
ci_03                -3.403898e-02 3 1  ON 2
ci_04                 3.041916e-02 3 1  ON 3
ci_05                -2.566234e-02 3 1  ON 4
ci_06                -2.473182e-02 3 1  ON 5
ci_07                 2.747040e-02 3 1  ON 6
ci_08                -7.682522e-03 3 1  ON 7
ci_09                -1.035535e-02 3 1  ON 8
ci_10                -1.029019e-02 3 1  ON 9
ci_11                 1.343917e-02 3 1  ON 10
ci_12                 8.442300e-03 3 1  ON 11
ci_13                 1.260177e-02 3 1  ON 12
ci_14                 1.255560e-02 3 1  ON 13
ci_15                 7.757332e-03 3 1  ON 14
ci_16                 7.928221e-03 3 1  ON 15
ci_17                -8.485384e-03 3 1  ON 16
ci_18                -7.852628e-03 3 1  ON 17
ci_19                 9.888554e-03 3 1  ON 18
ci_20                 7.330546e-03 3 1  ON 19
ci_21                 9.019647e-03 3 1  ON 20
ci_22                 9.024011e-03 3 1  ON 21
ci_23                 4.897287e-03 3 1  ON 22
ci_24                 4.584973e-03 3 1  ON 23
ci_25                 3.362169e-03 3 1  ON 24
ci_26                 3.445931e-03 3 1  ON 25
ci_27                 3.401753e-03 3 1  ON 26
ci_28                 2.891010e-03 3 1  ON 27
ci_29                 2.282942e-03 3 1  ON 28
ci_30                -1.861402e-03 3 1  ON 29
ci_31                -1.825998e-03 3 1  ON 30
ci_32                -1.803698e-03 3 1  ON 31
ci_33                -1.334269e-03 3 1  ON 32
ci_34                 1.937622e-03 3 1  ON 33
ci_35                 1.341017e-03 3 1  ON 34
ci_36                -1.246642e-03 3 1  ON 35
ci_37                -1.316624e-03 3 1  ON 36
ci_38                -8.561921e-04 3 1  ON 37
ci_39                -7.039409e-04 3 1  ON 38
ci_40                -1.808685e-03 3 1  ON 39
ci_41                -1.410830e-03 3 1  ON 40
ci_42                -1.240216e-03 3 1  ON 41
ci_43                -3.301435e-03 3 1  ON 42
ci_44                -1.622420e-03 3 1  ON 43
ci_45                -7.840306e-04 3 1  ON 44
ci_46                -7.226594e-04 3 1  ON 45
ci_47                 5.610673e-04 3 1  ON 46
ci_48                 1.074279e-04 3 1  ON 47
ci_49                -9.705254e-04 3 1  ON 48
ci_50                -8.094766e-04 3 1  ON 49
ci_51                 5.443442e-04 3 1  ON 50
ci_52                 5.363380e-04 3 1  ON 51
ci_53                -7.464836e-04 3 1  ON 52
ci_54                -9.721817e-04 3 1  ON 53
ci_55                -5.594768e-04 3 1  ON 54
ci_56                 1.921400e-03 3 1  ON 55
ci_57                 1.263235e-03 3 1  ON 56
ci_58                -8.566999e-04 3 1  ON 57
ci_59                -9.729532e-04 3 1  ON 58
ci_60                 5.363598e-04 3 1  ON 59
ci_61                 7.767725e-04 3 1  ON 60
ci_62                -2.930648e-04 3 1  ON 61
ci_63                -8.853767e-04 3 1  ON 62
ci_64                -5.077929e-04 3 1  ON 63
ci_65                -3.650414e-04 3 1  ON 64
ci_66                -6.849912e-04 3 1  ON 65
ci_67                -6.275330e-04 3 1  ON 66
ci_68                -4.975718e-04 3 1  ON 67
ci_69                 2.745203e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3177e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.9001
    reference variance = 0.503224
====================================================
  Execution time = 2.8020e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4470e-01
  Total weights = 1.964074107e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432574284735
                                         uncertainty =       0.001958665153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432574284735
                                         uncertainty =       0.001958665153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465138377
  error estimate for blocks of size 2^( 2) =       0.000489945777
  error estimate for blocks of size 2^( 3) =       0.000513402308
  error estimate for blocks of size 2^( 4) =       0.000531715512
  error estimate for blocks of size 2^( 5) =       0.000541518221
  error estimate for blocks of size 2^( 6) =       0.000549138592
  error estimate for blocks of size 2^( 7) =       0.000552902232

      target function =      -0.749754225886
              le_mean =     -22.814198457135
             les_mean =     520.932350437570
             stat err =       0.000543818639
             autocorr =       1.366922305743
   target nu stat err =       0.000543818639
   target dn stat err =       0.002444768738
      target stat err =       0.002131865108
              std dev =       0.657805001567
             le_variance =       0.432707420087


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281419845714e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749759315934       residual = 5.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749918551820       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749951298626       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749958199063       residual = 7.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749961092698       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749962509736       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749962803944       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749962837641       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749962837654       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749962847926       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749962850225       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.371184e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749759315934       residual = 5.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749804904841       residual = 9.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749813931057       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749815751854       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749816471351       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749816799878       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749816861395       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749816867899       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749816867493       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749816869912       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.710490e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749759315934       residual = 5.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749771142317       residual = 9.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749773457324       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749773918241       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749774097167       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749774177231       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749774191759       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749774193260       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749774193135       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749774193728       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 9.473623e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047136 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2594e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.353232e-01 3 1  ON 0
ci_02                -3.417134e-02 3 1  ON 1
ci_03                -3.368779e-02 3 1  ON 2
ci_04                 3.018825e-02 3 1  ON 3
ci_05                -2.548218e-02 3 1  ON 4
ci_06                -2.449497e-02 3 1  ON 5
ci_07                 2.737261e-02 3 1  ON 6
ci_08                -7.538503e-03 3 1  ON 7
ci_09                -1.025929e-02 3 1  ON 8
ci_10                -1.027703e-02 3 1  ON 9
ci_11                 1.341235e-02 3 1  ON 10
ci_12                 8.382708e-03 3 1  ON 11
ci_13                 1.259667e-02 3 1  ON 12
ci_14                 1.261640e-02 3 1  ON 13
ci_15                 7.738398e-03 3 1  ON 14
ci_16                 7.864161e-03 3 1  ON 15
ci_17                -8.379677e-03 3 1  ON 16
ci_18                -7.763359e-03 3 1  ON 17
ci_19                 9.790978e-03 3 1  ON 18
ci_20                 7.258058e-03 3 1  ON 19
ci_21                 8.966385e-03 3 1  ON 20
ci_22                 8.980238e-03 3 1  ON 21
ci_23                 4.951698e-03 3 1  ON 22
ci_24                 4.671446e-03 3 1  ON 23
ci_25                 3.342147e-03 3 1  ON 24
ci_26                 3.406756e-03 3 1  ON 25
ci_27                 3.329749e-03 3 1  ON 26
ci_28                 2.870317e-03 3 1  ON 27
ci_29                 2.306048e-03 3 1  ON 28
ci_30                -1.868442e-03 3 1  ON 29
ci_31                -1.788248e-03 3 1  ON 30
ci_32                -1.804077e-03 3 1  ON 31
ci_33                -1.350938e-03 3 1  ON 32
ci_34                 1.950285e-03 3 1  ON 33
ci_35                 1.323755e-03 3 1  ON 34
ci_36                -1.264092e-03 3 1  ON 35
ci_37                -1.240729e-03 3 1  ON 36
ci_38                -8.038209e-04 3 1  ON 37
ci_39                -7.036145e-04 3 1  ON 38
ci_40                -1.770502e-03 3 1  ON 39
ci_41                -1.387874e-03 3 1  ON 40
ci_42                -1.256744e-03 3 1  ON 41
ci_43                -3.333241e-03 3 1  ON 42
ci_44                -1.702265e-03 3 1  ON 43
ci_45                -7.168950e-04 3 1  ON 44
ci_46                -7.060659e-04 3 1  ON 45
ci_47                 5.968928e-04 3 1  ON 46
ci_48                 1.320694e-04 3 1  ON 47
ci_49                -9.674288e-04 3 1  ON 48
ci_50                -8.512664e-04 3 1  ON 49
ci_51                 5.121573e-04 3 1  ON 50
ci_52                 4.995276e-04 3 1  ON 51
ci_53                -7.601037e-04 3 1  ON 52
ci_54                -9.805561e-04 3 1  ON 53
ci_55                -5.648149e-04 3 1  ON 54
ci_56                 1.866210e-03 3 1  ON 55
ci_57                 1.281249e-03 3 1  ON 56
ci_58                -8.405167e-04 3 1  ON 57
ci_59                -1.006622e-03 3 1  ON 58
ci_60                 4.441913e-04 3 1  ON 59
ci_61                 7.831451e-04 3 1  ON 60
ci_62                -2.706054e-04 3 1  ON 61
ci_63                -9.149761e-04 3 1  ON 62
ci_64                -5.024224e-04 3 1  ON 63
ci_65                -4.130574e-04 3 1  ON 64
ci_66                -7.145429e-04 3 1  ON 65
ci_67                -6.334398e-04 3 1  ON 66
ci_68                -5.253005e-04 3 1  ON 67
ci_69                 2.836052e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8323
    reference variance = 0.467572
====================================================
  Execution time = 2.5287e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4757e-01
  Total weights = 1.9640e+06
  Execution time = 3.4988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434023113364
                                         uncertainty =       0.002013386402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434023113364
                                         uncertainty =       0.002013386402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465898858
  error estimate for blocks of size 2^( 2) =       0.000490905498
  error estimate for blocks of size 2^( 3) =       0.000514353501
  error estimate for blocks of size 2^( 4) =       0.000532096650
  error estimate for blocks of size 2^( 5) =       0.000542692231
  error estimate for blocks of size 2^( 6) =       0.000548905088
  error estimate for blocks of size 2^( 7) =       0.000553316908

      target function =      -0.747152968006
              le_mean =     -22.813920918345
             les_mean =     520.922804176230
             stat err =       0.000544252719
             autocorr =       1.364639451952
   target nu stat err =       0.000544252719
   target dn stat err =       0.002984998943
      target stat err =       0.002549833016
              std dev =       0.658880483940
             le_variance =       0.434123492116

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.141937
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433637138246
                                         uncertainty =       0.002032859233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433637138246
                                         uncertainty =       0.002032859233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465690700
  error estimate for blocks of size 2^( 2) =       0.000490751740
  error estimate for blocks of size 2^( 3) =       0.000514259827
  error estimate for blocks of size 2^( 4) =       0.000532043436
  error estimate for blocks of size 2^( 5) =       0.000542673855
  error estimate for blocks of size 2^( 6) =       0.000548917137
  error estimate for blocks of size 2^( 7) =       0.000553332775

      target function =      -0.739288320377
              le_mean =     -22.813927814187
             les_mean =     520.932667268894
             stat err =       0.000544241801
             autocorr =       1.365804877074
   target nu stat err =       0.000544241801
   target dn stat err =       0.005982907370
      target stat err =       0.004897888140
              std dev =       0.658586104285
             le_variance =       0.433735656757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433780882339
                                         uncertainty =       0.002022763900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433780882339
                                         uncertainty =       0.002022763900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465768301
  error estimate for blocks of size 2^( 2) =       0.000490805219
  error estimate for blocks of size 2^( 3) =       0.000514286805
  error estimate for blocks of size 2^( 4) =       0.000532053305
  error estimate for blocks of size 2^( 5) =       0.000542670394
  error estimate for blocks of size 2^( 6) =       0.000548901381
  error estimate for blocks of size 2^( 7) =       0.000553320580

      target function =      -0.746352890767
              le_mean =     -22.813921099141
             les_mean =     520.923776682674
             stat err =       0.000544236415
             autocorr =       1.365322786930
   target nu stat err =       0.000544236415
   target dn stat err =       0.003116640047
      target stat err =       0.002650549988
              std dev =       0.658695847945
             le_variance =       0.433880220100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433988461605
                                         uncertainty =       0.002014360964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433988461605
                                         uncertainty =       0.002014360964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465880193
  error estimate for blocks of size 2^( 2) =       0.000490890747
  error estimate for blocks of size 2^( 3) =       0.000514343153
  error estimate for blocks of size 2^( 4) =       0.000532089255
  error estimate for blocks of size 2^( 5) =       0.000542687638
  error estimate for blocks of size 2^( 6) =       0.000548902949
  error estimate for blocks of size 2^( 7) =       0.000553315407

      target function =      -0.747156456242
              le_mean =     -22.813920477350
             les_mean =     520.922779811912
             stat err =       0.000544248812
             autocorr =       1.364729208369
   target nu stat err =       0.000544248812
   target dn stat err =       0.002990414236
      target stat err =       0.002554219657
              std dev =       0.658854087376
             le_variance =       0.434088708452


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747152968006        initial
     2.5000e-01     2.5000e+00             1.3712e-03        -0.739288320377
     1.0000e+00     1.0000e+01             3.7105e-04        -0.746352890767
     4.0000e+00     4.0000e+01             9.4736e-05        -0.747156456242  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.2892e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.355995e-01 3 1  ON 0
ci_02                -3.434609e-02 3 1  ON 1
ci_03                -3.394822e-02 3 1  ON 2
ci_04                 3.035919e-02 3 1  ON 3
ci_05                -2.561569e-02 3 1  ON 4
ci_06                -2.467047e-02 3 1  ON 5
ci_07                 2.744527e-02 3 1  ON 6
ci_08                -7.645193e-03 3 1  ON 7
ci_09                -1.033061e-02 3 1  ON 8
ci_10                -1.028680e-02 3 1  ON 9
ci_11                 1.343225e-02 3 1  ON 10
ci_12                 8.426859e-03 3 1  ON 11
ci_13                 1.260050e-02 3 1  ON 12
ci_14                 1.257103e-02 3 1  ON 13
ci_15                 7.752422e-03 3 1  ON 14
ci_16                 7.911675e-03 3 1  ON 15
ci_17                -8.458152e-03 3 1  ON 16
ci_18                -7.829634e-03 3 1  ON 17
ci_19                 9.863168e-03 3 1  ON 18
ci_20                 7.311749e-03 3 1  ON 19
ci_21                 9.005983e-03 3 1  ON 20
ci_22                 9.012811e-03 3 1  ON 21
ci_23                 4.911391e-03 3 1  ON 22
ci_24                 4.607057e-03 3 1  ON 23
ci_25                 3.356991e-03 3 1  ON 24
ci_26                 3.435826e-03 3 1  ON 25
ci_27                 3.383153e-03 3 1  ON 26
ci_28                 2.885727e-03 3 1  ON 27
ci_29                 2.288967e-03 3 1  ON 28
ci_30                -1.863243e-03 3 1  ON 29
ci_31                -1.816390e-03 3 1  ON 30
ci_32                -1.803762e-03 3 1  ON 31
ci_33                -1.338563e-03 3 1  ON 32
ci_34                 1.940816e-03 3 1  ON 33
ci_35                 1.336481e-03 3 1  ON 34
ci_36                -1.251185e-03 3 1  ON 35
ci_37                -1.296946e-03 3 1  ON 36
ci_38                -8.426170e-04 3 1  ON 37
ci_39                -7.038383e-04 3 1  ON 38
ci_40                -1.798770e-03 3 1  ON 39
ci_41                -1.404863e-03 3 1  ON 40
ci_42                -1.244496e-03 3 1  ON 41
ci_43                -3.309678e-03 3 1  ON 42
ci_44                -1.643092e-03 3 1  ON 43
ci_45                -7.666173e-04 3 1  ON 44
ci_46                -7.183671e-04 3 1  ON 45
ci_47                 5.702074e-04 3 1  ON 46
ci_48                 1.137280e-04 3 1  ON 47
ci_49                -9.697542e-04 3 1  ON 48
ci_50                -8.203879e-04 3 1  ON 49
ci_51                 5.360107e-04 3 1  ON 50
ci_52                 5.268147e-04 3 1  ON 51
ci_53                -7.500344e-04 3 1  ON 52
ci_54                -9.743421e-04 3 1  ON 53
ci_55                -5.608389e-04 3 1  ON 54
ci_56                 1.907057e-03 3 1  ON 55
ci_57                 1.267897e-03 3 1  ON 56
ci_58                -8.525015e-04 3 1  ON 57
ci_59                -9.816581e-04 3 1  ON 58
ci_60                 5.129447e-04 3 1  ON 59
ci_61                 7.783711e-04 3 1  ON 60
ci_62                -2.872430e-04 3 1  ON 61
ci_63                -8.930962e-04 3 1  ON 62
ci_64                -5.064284e-04 3 1  ON 63
ci_65                -3.775201e-04 3 1  ON 64
ci_66                -6.926881e-04 3 1  ON 65
ci_67                -6.290674e-04 3 1  ON 66
ci_68                -5.047809e-04 3 1  ON 67
ci_69                 2.768902e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5501e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7043
    reference variance = 0.602171
====================================================
  Execution time = 2.5838e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5321e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5045e-01
  Total weights = 1.963956030e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436293363445
                                         uncertainty =       0.002346761304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436293363445
                                         uncertainty =       0.002346761304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467104290
  error estimate for blocks of size 2^( 2) =       0.000491904239
  error estimate for blocks of size 2^( 3) =       0.000515140269
  error estimate for blocks of size 2^( 4) =       0.000533092360
  error estimate for blocks of size 2^( 5) =       0.000543768639
  error estimate for blocks of size 2^( 6) =       0.000551213705
  error estimate for blocks of size 2^( 7) =       0.000555951848

      target function =      -0.744977507232
              le_mean =     -22.814290123428
             les_mean =     520.942280464657
             stat err =       0.000546006638
             autocorr =       1.366369417545
   target nu stat err =       0.000546006638
   target dn stat err =       0.002988989531
      target stat err =       0.002540477065
              std dev =       0.660585222167
             le_variance =       0.436372835745


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281429012343e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744985242659       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745025066651       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745030348714       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745031264525       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745031629564       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745031854519       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745031931019       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745031939356       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745031940782       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.262873e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744985242659       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744995568240       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744996920455       residual = 9.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744997151702       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744997242803       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744997297810       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744997316116       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744997318082       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744997318419       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 8.323068e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744985242659       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744987848233       residual = 5.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744988188316       residual = 9.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744988246265       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744988269025       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744988282695       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744988287218       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744988287702       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744988287785       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 2.091422e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0372e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.355163e-01 3 1  ON 0
ci_02                -3.428142e-02 3 1  ON 1
ci_03                -3.389106e-02 3 1  ON 2
ci_04                 3.029289e-02 3 1  ON 3
ci_05                -2.558875e-02 3 1  ON 4
ci_06                -2.461137e-02 3 1  ON 5
ci_07                 2.745361e-02 3 1  ON 6
ci_08                -7.612659e-03 3 1  ON 7
ci_09                -1.030495e-02 3 1  ON 8
ci_10                -1.026384e-02 3 1  ON 9
ci_11                 1.342343e-02 3 1  ON 10
ci_12                 8.414425e-03 3 1  ON 11
ci_13                 1.260120e-02 3 1  ON 12
ci_14                 1.257560e-02 3 1  ON 13
ci_15                 7.748659e-03 3 1  ON 14
ci_16                 7.899736e-03 3 1  ON 15
ci_17                -8.437672e-03 3 1  ON 16
ci_18                -7.800174e-03 3 1  ON 17
ci_19                 9.859398e-03 3 1  ON 18
ci_20                 7.324946e-03 3 1  ON 19
ci_21                 8.997240e-03 3 1  ON 20
ci_22                 9.004338e-03 3 1  ON 21
ci_23                 4.908288e-03 3 1  ON 22
ci_24                 4.591561e-03 3 1  ON 23
ci_25                 3.355005e-03 3 1  ON 24
ci_26                 3.416040e-03 3 1  ON 25
ci_27                 3.375234e-03 3 1  ON 26
ci_28                 2.884930e-03 3 1  ON 27
ci_29                 2.283125e-03 3 1  ON 28
ci_30                -1.856806e-03 3 1  ON 29
ci_31                -1.821128e-03 3 1  ON 30
ci_32                -1.795231e-03 3 1  ON 31
ci_33                -1.326623e-03 3 1  ON 32
ci_34                 1.922006e-03 3 1  ON 33
ci_35                 1.333067e-03 3 1  ON 34
ci_36                -1.241880e-03 3 1  ON 35
ci_37                -1.292394e-03 3 1  ON 36
ci_38                -8.329075e-04 3 1  ON 37
ci_39                -7.091024e-04 3 1  ON 38
ci_40                -1.798107e-03 3 1  ON 39
ci_41                -1.403931e-03 3 1  ON 40
ci_42                -1.231652e-03 3 1  ON 41
ci_43                -3.317072e-03 3 1  ON 42
ci_44                -1.657742e-03 3 1  ON 43
ci_45                -7.705103e-04 3 1  ON 44
ci_46                -7.096067e-04 3 1  ON 45
ci_47                 5.859482e-04 3 1  ON 46
ci_48                 1.293922e-04 3 1  ON 47
ci_49                -9.576760e-04 3 1  ON 48
ci_50                -8.150795e-04 3 1  ON 49
ci_51                 5.286988e-04 3 1  ON 50
ci_52                 5.313551e-04 3 1  ON 51
ci_53                -7.559123e-04 3 1  ON 52
ci_54                -9.785166e-04 3 1  ON 53
ci_55                -5.615139e-04 3 1  ON 54
ci_56                 1.913003e-03 3 1  ON 55
ci_57                 1.295923e-03 3 1  ON 56
ci_58                -8.422158e-04 3 1  ON 57
ci_59                -9.810311e-04 3 1  ON 58
ci_60                 4.990527e-04 3 1  ON 59
ci_61                 7.704774e-04 3 1  ON 60
ci_62                -2.975059e-04 3 1  ON 61
ci_63                -8.897053e-04 3 1  ON 62
ci_64                -5.265384e-04 3 1  ON 63
ci_65                -3.754234e-04 3 1  ON 64
ci_66                -6.951439e-04 3 1  ON 65
ci_67                -6.318813e-04 3 1  ON 66
ci_68                -5.171054e-04 3 1  ON 67
ci_69                 2.705319e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7049
    reference variance = 0.276195
====================================================
  Execution time = 2.5152e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5205e-01
  Total weights = 1.9642e+06
  Execution time = 3.5009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436386270938
                                         uncertainty =       0.002648264837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436386270938
                                         uncertainty =       0.002648264837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467549988
  error estimate for blocks of size 2^( 2) =       0.000492383405
  error estimate for blocks of size 2^( 3) =       0.000516087565
  error estimate for blocks of size 2^( 4) =       0.000533411899
  error estimate for blocks of size 2^( 5) =       0.000542953873
  error estimate for blocks of size 2^( 6) =       0.000549623718
  error estimate for blocks of size 2^( 7) =       0.000551695257

      target function =      -0.743557902163
              le_mean =     -22.815308751445
             les_mean =     520.990476375930
             stat err =       0.000544421187
             autocorr =       1.355857147291
   target nu stat err =       0.000544421187
   target dn stat err =       0.003720359042
      target stat err =       0.003122864639
              std dev =       0.661215534521
             le_variance =       0.437205983092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436300529372
                                         uncertainty =       0.002653460555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436300529372
                                         uncertainty =       0.002653460555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467495154
  error estimate for blocks of size 2^( 2) =       0.000492344015
  error estimate for blocks of size 2^( 3) =       0.000516061416
  error estimate for blocks of size 2^( 4) =       0.000533397270
  error estimate for blocks of size 2^( 5) =       0.000542943197
  error estimate for blocks of size 2^( 6) =       0.000549615684
  error estimate for blocks of size 2^( 7) =       0.000551689907

      target function =      -0.743730325601
              le_mean =     -22.815309725147
             les_mean =     520.990311315566
             stat err =       0.000544411514
             autocorr =       1.356127045280
   target nu stat err =       0.000544411514
   target dn stat err =       0.003741435895
      target stat err =       0.003141331289
              std dev =       0.661137987040
             le_variance =       0.437103437907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436340527348
                                         uncertainty =       0.002650886173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436340527348
                                         uncertainty =       0.002650886173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467520833
  error estimate for blocks of size 2^( 2) =       0.000492362243
  error estimate for blocks of size 2^( 3) =       0.000516073222
  error estimate for blocks of size 2^( 4) =       0.000533403542
  error estimate for blocks of size 2^( 5) =       0.000542947571
  error estimate for blocks of size 2^( 6) =       0.000549618847
  error estimate for blocks of size 2^( 7) =       0.000551692001

      target function =      -0.741629196325
              le_mean =     -22.815309104649
             les_mean =     520.992833294422
             stat err =       0.000544415490
             autocorr =       1.355997879473
   target nu stat err =       0.000544415490
   target dn stat err =       0.004506445388
      target stat err =       0.003740978385
              std dev =       0.661174303346
             le_variance =       0.437151459404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436380328930
                                         uncertainty =       0.002648586350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436380328930
                                         uncertainty =       0.002648586350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467546215
  error estimate for blocks of size 2^( 2) =       0.000492380640
  error estimate for blocks of size 2^( 3) =       0.000516085659
  error estimate for blocks of size 2^( 4) =       0.000533410747
  error estimate for blocks of size 2^( 5) =       0.000542952989
  error estimate for blocks of size 2^( 6) =       0.000549622996
  error estimate for blocks of size 2^( 7) =       0.000551694718

      target function =      -0.743597048358
              le_mean =     -22.815308764844
             les_mean =     520.990429453127
             stat err =       0.000544420362
             autocorr =       1.355874929469
   target nu stat err =       0.000544420362
   target dn stat err =       0.003720903423
      target stat err =       0.003123627206
              std dev =       0.661210197584
             le_variance =       0.437198925389


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743557902163        initial
     1.0000e+00     1.0000e+01             3.2629e-04        -0.743730325601  <--
     4.0000e+00     4.0000e+01             8.3231e-05        -0.741629196325
     1.6000e+01     1.6000e+02             2.0914e-05        -0.743597048358

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.2769e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.352732e-01 3 1  ON 0
ci_02                -3.409583e-02 3 1  ON 1
ci_03                -3.372726e-02 3 1  ON 2
ci_04                 3.010373e-02 3 1  ON 3
ci_05                -2.551203e-02 3 1  ON 4
ci_06                -2.444189e-02 3 1  ON 5
ci_07                 2.747759e-02 3 1  ON 6
ci_08                -7.519621e-03 3 1  ON 7
ci_09                -1.023084e-02 3 1  ON 8
ci_10                -1.019769e-02 3 1  ON 9
ci_11                 1.339808e-02 3 1  ON 10
ci_12                 8.378789e-03 3 1  ON 11
ci_13                 1.260303e-02 3 1  ON 12
ci_14                 1.258896e-02 3 1  ON 13
ci_15                 7.737908e-03 3 1  ON 14
ci_16                 7.865502e-03 3 1  ON 15
ci_17                -8.378681e-03 3 1  ON 16
ci_18                -7.715130e-03 3 1  ON 17
ci_19                 9.848646e-03 3 1  ON 18
ci_20                 7.362775e-03 3 1  ON 19
ci_21                 8.971931e-03 3 1  ON 20
ci_22                 8.979946e-03 3 1  ON 21
ci_23                 4.899501e-03 3 1  ON 22
ci_24                 4.546535e-03 3 1  ON 23
ci_25                 3.349450e-03 3 1  ON 24
ci_26                 3.359260e-03 3 1  ON 25
ci_27                 3.352500e-03 3 1  ON 26
ci_28                 2.882519e-03 3 1  ON 27
ci_29                 2.266147e-03 3 1  ON 28
ci_30                -1.837976e-03 3 1  ON 29
ci_31                -1.834859e-03 3 1  ON 30
ci_32                -1.771010e-03 3 1  ON 31
ci_33                -1.292721e-03 3 1  ON 32
ci_34                 1.868248e-03 3 1  ON 33
ci_35                 1.323640e-03 3 1  ON 34
ci_36                -1.215358e-03 3 1  ON 35
ci_37                -1.279387e-03 3 1  ON 36
ci_38                -8.051392e-04 3 1  ON 37
ci_39                -7.241099e-04 3 1  ON 38
ci_40                -1.796146e-03 3 1  ON 39
ci_41                -1.401368e-03 3 1  ON 40
ci_42                -1.195057e-03 3 1  ON 41
ci_43                -3.338184e-03 3 1  ON 42
ci_44                -1.699595e-03 3 1  ON 43
ci_45                -7.816134e-04 3 1  ON 44
ci_46                -6.845671e-04 3 1  ON 45
ci_47                 6.312524e-04 3 1  ON 46
ci_48                 1.746673e-04 3 1  ON 47
ci_49                -9.231363e-04 3 1  ON 48
ci_50                -8.000257e-04 3 1  ON 49
ci_51                 5.077132e-04 3 1  ON 50
ci_52                 5.443200e-04 3 1  ON 51
ci_53                -7.725777e-04 3 1  ON 52
ci_54                -9.905716e-04 3 1  ON 53
ci_55                -5.634230e-04 3 1  ON 54
ci_56                 1.929953e-03 3 1  ON 55
ci_57                 1.375856e-03 3 1  ON 56
ci_58                -8.127493e-04 3 1  ON 57
ci_59                -9.792044e-04 3 1  ON 58
ci_60                 4.582988e-04 3 1  ON 59
ci_61                 7.473276e-04 3 1  ON 60
ci_62                -3.266995e-04 3 1  ON 61
ci_63                -8.800013e-04 3 1  ON 62
ci_64                -5.840030e-04 3 1  ON 63
ci_65                -3.694144e-04 3 1  ON 64
ci_66                -7.021420e-04 3 1  ON 65
ci_67                -6.398744e-04 3 1  ON 66
ci_68                -5.524204e-04 3 1  ON 67
ci_69                 2.522804e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3168e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2806e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7656
    reference variance = 0.385078
====================================================
  Execution time = 2.5784e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5326e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4947e-01
  Total weights = 1.964253001e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436120301894
                                         uncertainty =       0.002035364270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436120301894
                                         uncertainty =       0.002035364270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466927985
  error estimate for blocks of size 2^( 2) =       0.000491609935
  error estimate for blocks of size 2^( 3) =       0.000515088112
  error estimate for blocks of size 2^( 4) =       0.000533438601
  error estimate for blocks of size 2^( 5) =       0.000544708732
  error estimate for blocks of size 2^( 6) =       0.000552335237
  error estimate for blocks of size 2^( 7) =       0.000556239123

      target function =      -0.745782500106
              le_mean =     -22.814568967530
             les_mean =     520.954031998540
             stat err =       0.000546680423
             autocorr =       1.370778346317
   target nu stat err =       0.000546680423
   target dn stat err =       0.002782605231
      target stat err =       0.002381501187
              std dev =       0.660335889515
             le_variance =       0.436043486982


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281456896753e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745789140976       residual = 4.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745918954059       residual = 7.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745943394467       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745948320166       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745950174657       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745951252263       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745951446237       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745951398680       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745951419532       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745951406469       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745951427967       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.614968e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745789140976       residual = 4.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745826205902       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745832898153       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745834160845       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745834609610       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745834854309       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745834893266       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745834881352       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745834886500       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745834883964       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 4.356785e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745789140976       residual = 4.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745798748438       residual = 6.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745800461572       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745800778479       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745800889249       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745800948539       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745800957620       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745800954665       residual = 9.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745800955948       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745800955365       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.111280e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063173 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0324e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.348375e-01 3 1  ON 0
ci_02                -3.378135e-02 3 1  ON 1
ci_03                -3.345727e-02 3 1  ON 2
ci_04                 2.989961e-02 3 1  ON 3
ci_05                -2.534388e-02 3 1  ON 4
ci_06                -2.434081e-02 3 1  ON 5
ci_07                 2.741876e-02 3 1  ON 6
ci_08                -7.428748e-03 3 1  ON 7
ci_09                -1.021244e-02 3 1  ON 8
ci_10                -1.018684e-02 3 1  ON 9
ci_11                 1.335950e-02 3 1  ON 10
ci_12                 8.325043e-03 3 1  ON 11
ci_13                 1.261505e-02 3 1  ON 12
ci_14                 1.263854e-02 3 1  ON 13
ci_15                 7.719439e-03 3 1  ON 14
ci_16                 7.801336e-03 3 1  ON 15
ci_17                -8.377345e-03 3 1  ON 16
ci_18                -7.699957e-03 3 1  ON 17
ci_19                 9.748641e-03 3 1  ON 18
ci_20                 7.303771e-03 3 1  ON 19
ci_21                 8.956796e-03 3 1  ON 20
ci_22                 8.933920e-03 3 1  ON 21
ci_23                 4.872980e-03 3 1  ON 22
ci_24                 4.606268e-03 3 1  ON 23
ci_25                 3.361733e-03 3 1  ON 24
ci_26                 3.257708e-03 3 1  ON 25
ci_27                 3.281218e-03 3 1  ON 26
ci_28                 2.805725e-03 3 1  ON 27
ci_29                 2.272285e-03 3 1  ON 28
ci_30                -1.763328e-03 3 1  ON 29
ci_31                -1.808915e-03 3 1  ON 30
ci_32                -1.700942e-03 3 1  ON 31
ci_33                -1.247542e-03 3 1  ON 32
ci_34                 1.879906e-03 3 1  ON 33
ci_35                 1.296339e-03 3 1  ON 34
ci_36                -1.205427e-03 3 1  ON 35
ci_37                -1.275896e-03 3 1  ON 36
ci_38                -8.263204e-04 3 1  ON 37
ci_39                -6.961232e-04 3 1  ON 38
ci_40                -1.766136e-03 3 1  ON 39
ci_41                -1.433759e-03 3 1  ON 40
ci_42                -1.291453e-03 3 1  ON 41
ci_43                -3.329225e-03 3 1  ON 42
ci_44                -1.734575e-03 3 1  ON 43
ci_45                -7.982587e-04 3 1  ON 44
ci_46                -7.048579e-04 3 1  ON 45
ci_47                 6.772227e-04 3 1  ON 46
ci_48                 1.854701e-04 3 1  ON 47
ci_49                -9.162153e-04 3 1  ON 48
ci_50                -8.025700e-04 3 1  ON 49
ci_51                 5.441837e-04 3 1  ON 50
ci_52                 5.276610e-04 3 1  ON 51
ci_53                -7.417329e-04 3 1  ON 52
ci_54                -9.536071e-04 3 1  ON 53
ci_55                -5.634086e-04 3 1  ON 54
ci_56                 1.962967e-03 3 1  ON 55
ci_57                 1.373469e-03 3 1  ON 56
ci_58                -7.679720e-04 3 1  ON 57
ci_59                -9.236223e-04 3 1  ON 58
ci_60                 5.161981e-04 3 1  ON 59
ci_61                 7.061906e-04 3 1  ON 60
ci_62                -3.154633e-04 3 1  ON 61
ci_63                -9.024688e-04 3 1  ON 62
ci_64                -5.222408e-04 3 1  ON 63
ci_65                -3.898052e-04 3 1  ON 64
ci_66                -7.048534e-04 3 1  ON 65
ci_67                -6.578620e-04 3 1  ON 66
ci_68                -5.772688e-04 3 1  ON 67
ci_69                 1.523902e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8372
    reference variance = 0.341863
====================================================
  Execution time = 2.5108e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4869e-01
  Total weights = 1.9639e+06
  Execution time = 3.4995e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00723987
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435586803668
                                         uncertainty =       0.002076651920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435586803668
                                         uncertainty =       0.002076651920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466700513
  error estimate for blocks of size 2^( 2) =       0.000491940809
  error estimate for blocks of size 2^( 3) =       0.000515158893
  error estimate for blocks of size 2^( 4) =       0.000533038611
  error estimate for blocks of size 2^( 5) =       0.000543819082
  error estimate for blocks of size 2^( 6) =       0.000551041778
  error estimate for blocks of size 2^( 7) =       0.000555382637

      target function =      -0.746019042107
              le_mean =     -22.815197544108
             les_mean =     520.982428465422
             stat err =       0.000545820527
             autocorr =       1.367801804133
   target nu stat err =       0.000545820527
   target dn stat err =       0.003006630900
      target stat err =       0.002564984428
              std dev =       0.660014195204
             le_variance =       0.435618737871

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000324521
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435194737257
                                         uncertainty =       0.002049175929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435194737257
                                         uncertainty =       0.002049175929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466490129
  error estimate for blocks of size 2^( 2) =       0.000491788981
  error estimate for blocks of size 2^( 3) =       0.000515057996
  error estimate for blocks of size 2^( 4) =       0.000532973441
  error estimate for blocks of size 2^( 5) =       0.000543746720
  error estimate for blocks of size 2^( 6) =       0.000550984976
  error estimate for blocks of size 2^( 7) =       0.000555316349

      target function =      -0.735830651916
              le_mean =     -22.815199780580
             les_mean =     520.994857353240
             stat err =       0.000545755372
             autocorr =       1.368708994827
   target nu stat err =       0.000545755372
   target dn stat err =       0.011504344951
      target stat err =       0.009298143863
              std dev =       0.659716666812
             le_variance =       0.435226080470

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00711691
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435333905766
                                         uncertainty =       0.002060674361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435333905766
                                         uncertainty =       0.002060674361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466564853
  error estimate for blocks of size 2^( 2) =       0.000491836675
  error estimate for blocks of size 2^( 3) =       0.000515089064
  error estimate for blocks of size 2^( 4) =       0.000532993331
  error estimate for blocks of size 2^( 5) =       0.000543775617
  error estimate for blocks of size 2^( 6) =       0.000551006096
  error estimate for blocks of size 2^( 7) =       0.000555343685

      target function =      -0.746528382421
              le_mean =     -22.815195071197
             les_mean =     520.981702121725
             stat err =       0.000545779682
             autocorr =       1.368392510862
   target nu stat err =       0.000545779682
   target dn stat err =       0.002921978946
      target stat err =       0.002500147787
              std dev =       0.659822342942
             le_variance =       0.435365524245

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.021509
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435551015101
                                         uncertainty =       0.002074421507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435551015101
                                         uncertainty =       0.002074421507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466681321
  error estimate for blocks of size 2^( 2) =       0.000491925732
  error estimate for blocks of size 2^( 3) =       0.000515148248
  error estimate for blocks of size 2^( 4) =       0.000533031159
  error estimate for blocks of size 2^( 5) =       0.000543811897
  error estimate for blocks of size 2^( 6) =       0.000551035713
  error estimate for blocks of size 2^( 7) =       0.000555376069

      target function =      -0.746171095871
              le_mean =     -22.815196827017
             les_mean =     520.982212469545
             stat err =       0.000545813710
             autocorr =       1.367880136499
   target nu stat err =       0.000545813710
   target dn stat err =       0.002987221146
      target stat err =       0.002550359384
              std dev =       0.659987053427
             le_variance =       0.435582910691


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746019042107        initial
     2.5000e-01     2.5000e+00             1.6150e-03        -0.735830651916
     1.0000e+00     1.0000e+01             4.3568e-04        -0.746528382421  <--
     4.0000e+00     4.0000e+01             1.1113e-04        -0.746171095871

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.2708e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.348375e-01 3 1  ON 0
ci_02                -3.378135e-02 3 1  ON 1
ci_03                -3.345727e-02 3 1  ON 2
ci_04                 2.989961e-02 3 1  ON 3
ci_05                -2.534388e-02 3 1  ON 4
ci_06                -2.434081e-02 3 1  ON 5
ci_07                 2.741876e-02 3 1  ON 6
ci_08                -7.428748e-03 3 1  ON 7
ci_09                -1.021244e-02 3 1  ON 8
ci_10                -1.018684e-02 3 1  ON 9
ci_11                 1.335950e-02 3 1  ON 10
ci_12                 8.325043e-03 3 1  ON 11
ci_13                 1.261505e-02 3 1  ON 12
ci_14                 1.263854e-02 3 1  ON 13
ci_15                 7.719439e-03 3 1  ON 14
ci_16                 7.801336e-03 3 1  ON 15
ci_17                -8.377345e-03 3 1  ON 16
ci_18                -7.699957e-03 3 1  ON 17
ci_19                 9.748641e-03 3 1  ON 18
ci_20                 7.303771e-03 3 1  ON 19
ci_21                 8.956796e-03 3 1  ON 20
ci_22                 8.933920e-03 3 1  ON 21
ci_23                 4.872980e-03 3 1  ON 22
ci_24                 4.606268e-03 3 1  ON 23
ci_25                 3.361733e-03 3 1  ON 24
ci_26                 3.257708e-03 3 1  ON 25
ci_27                 3.281218e-03 3 1  ON 26
ci_28                 2.805725e-03 3 1  ON 27
ci_29                 2.272285e-03 3 1  ON 28
ci_30                -1.763328e-03 3 1  ON 29
ci_31                -1.808915e-03 3 1  ON 30
ci_32                -1.700942e-03 3 1  ON 31
ci_33                -1.247542e-03 3 1  ON 32
ci_34                 1.879906e-03 3 1  ON 33
ci_35                 1.296339e-03 3 1  ON 34
ci_36                -1.205427e-03 3 1  ON 35
ci_37                -1.275896e-03 3 1  ON 36
ci_38                -8.263204e-04 3 1  ON 37
ci_39                -6.961232e-04 3 1  ON 38
ci_40                -1.766136e-03 3 1  ON 39
ci_41                -1.433759e-03 3 1  ON 40
ci_42                -1.291453e-03 3 1  ON 41
ci_43                -3.329225e-03 3 1  ON 42
ci_44                -1.734575e-03 3 1  ON 43
ci_45                -7.982587e-04 3 1  ON 44
ci_46                -7.048579e-04 3 1  ON 45
ci_47                 6.772227e-04 3 1  ON 46
ci_48                 1.854701e-04 3 1  ON 47
ci_49                -9.162153e-04 3 1  ON 48
ci_50                -8.025700e-04 3 1  ON 49
ci_51                 5.441837e-04 3 1  ON 50
ci_52                 5.276610e-04 3 1  ON 51
ci_53                -7.417329e-04 3 1  ON 52
ci_54                -9.536071e-04 3 1  ON 53
ci_55                -5.634086e-04 3 1  ON 54
ci_56                 1.962967e-03 3 1  ON 55
ci_57                 1.373469e-03 3 1  ON 56
ci_58                -7.679720e-04 3 1  ON 57
ci_59                -9.236223e-04 3 1  ON 58
ci_60                 5.161981e-04 3 1  ON 59
ci_61                 7.061906e-04 3 1  ON 60
ci_62                -3.154633e-04 3 1  ON 61
ci_63                -9.024688e-04 3 1  ON 62
ci_64                -5.222408e-04 3 1  ON 63
ci_65                -3.898052e-04 3 1  ON 64
ci_66                -7.048534e-04 3 1  ON 65
ci_67                -6.578620e-04 3 1  ON 66
ci_68                -5.772688e-04 3 1  ON 67
ci_69                 1.523902e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3069e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2806e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.774
    reference variance = 0.3552
====================================================
  Execution time = 2.5884e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5368e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4933e-01
  Total weights = 1.964521530e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436070831457
                                         uncertainty =       0.001611002381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436070831457
                                         uncertainty =       0.001611002381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466909347
  error estimate for blocks of size 2^( 2) =       0.000491962881
  error estimate for blocks of size 2^( 3) =       0.000515065729
  error estimate for blocks of size 2^( 4) =       0.000532256713
  error estimate for blocks of size 2^( 5) =       0.000542931088
  error estimate for blocks of size 2^( 6) =       0.000549553667
  error estimate for blocks of size 2^( 7) =       0.000554583965

      target function =      -0.745905699536
              le_mean =     -22.814396316531
             les_mean =     520.946005752750
             stat err =       0.000544831358
             autocorr =       1.361629822717
   target nu stat err =       0.000544831358
   target dn stat err =       0.002604656580
      target stat err =       0.002238980558
              std dev =       0.660309531584
             le_variance =       0.436008677501


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281439631653e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745911429752       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746031572969       residual = 7.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746055571551       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746060370536       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746062543122       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746063738581       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746063741611       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746063667245       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746063644346       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746063631743       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746063642862       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.452241e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745911429752       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745945728400       residual = 7.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745952300632       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745953558703       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745954102103       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745954368071       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745954357530       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745954340441       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745954335102       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745954332706       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.921969e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745911429752       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745920319777       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745922002261       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745922320164       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745922455573       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745922519512       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745922516150       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745922512011       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745922510705       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745922510162       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.000651e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071681 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0412e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.344453e-01 3 1  ON 0
ci_02                -3.352456e-02 3 1  ON 1
ci_03                -3.315381e-02 3 1  ON 2
ci_04                 2.967776e-02 3 1  ON 3
ci_05                -2.508867e-02 3 1  ON 4
ci_06                -2.421663e-02 3 1  ON 5
ci_07                 2.737028e-02 3 1  ON 6
ci_08                -7.324084e-03 3 1  ON 7
ci_09                -1.012083e-02 3 1  ON 8
ci_10                -1.010519e-02 3 1  ON 9
ci_11                 1.332411e-02 3 1  ON 10
ci_12                 8.270695e-03 3 1  ON 11
ci_13                 1.264717e-02 3 1  ON 12
ci_14                 1.270443e-02 3 1  ON 13
ci_15                 7.651487e-03 3 1  ON 14
ci_16                 7.755989e-03 3 1  ON 15
ci_17                -8.259199e-03 3 1  ON 16
ci_18                -7.638128e-03 3 1  ON 17
ci_19                 9.686976e-03 3 1  ON 18
ci_20                 7.256025e-03 3 1  ON 19
ci_21                 8.949748e-03 3 1  ON 20
ci_22                 8.909645e-03 3 1  ON 21
ci_23                 4.893664e-03 3 1  ON 22
ci_24                 4.566106e-03 3 1  ON 23
ci_25                 3.342022e-03 3 1  ON 24
ci_26                 3.266503e-03 3 1  ON 25
ci_27                 3.284530e-03 3 1  ON 26
ci_28                 2.780288e-03 3 1  ON 27
ci_29                 2.242925e-03 3 1  ON 28
ci_30                -1.760690e-03 3 1  ON 29
ci_31                -1.792342e-03 3 1  ON 30
ci_32                -1.653696e-03 3 1  ON 31
ci_33                -1.206407e-03 3 1  ON 32
ci_34                 1.852100e-03 3 1  ON 33
ci_35                 1.317630e-03 3 1  ON 34
ci_36                -1.223077e-03 3 1  ON 35
ci_37                -1.264744e-03 3 1  ON 36
ci_38                -7.996429e-04 3 1  ON 37
ci_39                -6.946628e-04 3 1  ON 38
ci_40                -1.737120e-03 3 1  ON 39
ci_41                -1.494808e-03 3 1  ON 40
ci_42                -1.259827e-03 3 1  ON 41
ci_43                -3.275076e-03 3 1  ON 42
ci_44                -1.698267e-03 3 1  ON 43
ci_45                -7.866973e-04 3 1  ON 44
ci_46                -6.532435e-04 3 1  ON 45
ci_47                 7.595355e-04 3 1  ON 46
ci_48                 2.527525e-04 3 1  ON 47
ci_49                -9.145055e-04 3 1  ON 48
ci_50                -7.882186e-04 3 1  ON 49
ci_51                 5.241823e-04 3 1  ON 50
ci_52                 4.940967e-04 3 1  ON 51
ci_53                -7.354869e-04 3 1  ON 52
ci_54                -9.348388e-04 3 1  ON 53
ci_55                -6.021523e-04 3 1  ON 54
ci_56                 1.943671e-03 3 1  ON 55
ci_57                 1.421271e-03 3 1  ON 56
ci_58                -7.725817e-04 3 1  ON 57
ci_59                -9.323776e-04 3 1  ON 58
ci_60                 5.301248e-04 3 1  ON 59
ci_61                 6.872846e-04 3 1  ON 60
ci_62                -2.764088e-04 3 1  ON 61
ci_63                -8.655105e-04 3 1  ON 62
ci_64                -5.283014e-04 3 1  ON 63
ci_65                -3.708139e-04 3 1  ON 64
ci_66                -7.099924e-04 3 1  ON 65
ci_67                -6.395722e-04 3 1  ON 66
ci_68                -5.455252e-04 3 1  ON 67
ci_69                 1.667635e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8945
    reference variance = 0.379976
====================================================
  Execution time = 2.5238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5132e-01
  Total weights = 1.9641e+06
  Execution time = 3.5102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438764026511
                                         uncertainty =       0.003420844168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438764026511
                                         uncertainty =       0.003420844168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468347356
  error estimate for blocks of size 2^( 2) =       0.000493379446
  error estimate for blocks of size 2^( 3) =       0.000516546683
  error estimate for blocks of size 2^( 4) =       0.000532968071
  error estimate for blocks of size 2^( 5) =       0.000544249647
  error estimate for blocks of size 2^( 6) =       0.000549690071
  error estimate for blocks of size 2^( 7) =       0.000554035875

      target function =      -0.742257454199
              le_mean =     -22.814785355180
             les_mean =     520.968171655863
             stat err =       0.000545235916
             autocorr =       1.355291658730
   target nu stat err =       0.000545235916
   target dn stat err =       0.004396164265
      target stat err =       0.003655223999
              std dev =       0.662343183403
             le_variance =       0.438698492600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438221622798
                                         uncertainty =       0.003309138887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438221622798
                                         uncertainty =       0.003309138887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468058311
  error estimate for blocks of size 2^( 2) =       0.000493152374
  error estimate for blocks of size 2^( 3) =       0.000516385990
  error estimate for blocks of size 2^( 4) =       0.000532853316
  error estimate for blocks of size 2^( 5) =       0.000544150585
  error estimate for blocks of size 2^( 6) =       0.000549628117
  error estimate for blocks of size 2^( 7) =       0.000553971548

      target function =      -0.744188728274
              le_mean =     -22.814788522646
             les_mean =     520.965972740557
             stat err =       0.000545150891
             autocorr =       1.356542895365
   target nu stat err =       0.000545150891
   target dn stat err =       0.003792260423
      target stat err =       0.003183979234
              std dev =       0.661934411192
             le_variance =       0.438157164720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438442645735
                                         uncertainty =       0.003355948565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438442645735
                                         uncertainty =       0.003355948565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468176107
  error estimate for blocks of size 2^( 2) =       0.000493243002
  error estimate for blocks of size 2^( 3) =       0.000516447527
  error estimate for blocks of size 2^( 4) =       0.000532894785
  error estimate for blocks of size 2^( 5) =       0.000544185192
  error estimate for blocks of size 2^( 6) =       0.000549646344
  error estimate for blocks of size 2^( 7) =       0.000553989912

      target function =      -0.744103184310
              le_mean =     -22.814784184641
             les_mean =     520.965878374866
             stat err =       0.000545179058
             autocorr =       1.356000463126
   target nu stat err =       0.000545179058
   target dn stat err =       0.003816428049
      target stat err =       0.003202805250
              std dev =       0.662101000318
             le_variance =       0.438377734622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438719914955
                                         uncertainty =       0.003412167429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438719914955
                                         uncertainty =       0.003412167429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468323854
  error estimate for blocks of size 2^( 2) =       0.000493360499
  error estimate for blocks of size 2^( 3) =       0.000516532634
  error estimate for blocks of size 2^( 4) =       0.000532957058
  error estimate for blocks of size 2^( 5) =       0.000544239881
  error estimate for blocks of size 2^( 6) =       0.000549682910
  error estimate for blocks of size 2^( 7) =       0.000554028021

      target function =      -0.743804200237
              le_mean =     -22.814784687407
             les_mean =     520.966263804441
             stat err =       0.000545226968
             autocorr =       1.355383202477
   target nu stat err =       0.000545226968
   target dn stat err =       0.003867027644
      target stat err =       0.003241222146
              std dev =       0.662309945803
             le_variance =       0.438654464309


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742257454199        initial
     2.5000e-01     2.5000e+00             1.4522e-03        -0.744188728274  <--
     1.0000e+00     1.0000e+01             3.9220e-04        -0.744103184310
     4.0000e+00     4.0000e+01             1.0007e-04        -0.743804200237

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.2885e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.333853e-01 3 1  ON 0
ci_02                -3.287358e-02 3 1  ON 1
ci_03                -3.238453e-02 3 1  ON 2
ci_04                 2.912705e-02 3 1  ON 3
ci_05                -2.444432e-02 3 1  ON 4
ci_06                -2.390808e-02 3 1  ON 5
ci_07                 2.724315e-02 3 1  ON 6
ci_08                -7.059261e-03 3 1  ON 7
ci_09                -9.883578e-03 3 1  ON 8
ci_10                -9.893009e-03 3 1  ON 9
ci_11                 1.323399e-02 3 1  ON 10
ci_12                 8.134531e-03 3 1  ON 11
ci_13                 1.273367e-02 3 1  ON 12
ci_14                 1.289150e-02 3 1  ON 13
ci_15                 7.478882e-03 3 1  ON 14
ci_16                 7.641121e-03 3 1  ON 15
ci_17                -7.954376e-03 3 1  ON 16
ci_18                -7.479008e-03 3 1  ON 17
ci_19                 9.535475e-03 3 1  ON 18
ci_20                 7.135780e-03 3 1  ON 19
ci_21                 8.932686e-03 3 1  ON 20
ci_22                 8.846849e-03 3 1  ON 21
ci_23                 4.944867e-03 3 1  ON 22
ci_24                 4.460846e-03 3 1  ON 23
ci_25                 3.293464e-03 3 1  ON 24
ci_26                 3.291017e-03 3 1  ON 25
ci_27                 3.294766e-03 3 1  ON 26
ci_28                 2.712847e-03 3 1  ON 27
ci_29                 2.166052e-03 3 1  ON 28
ci_30                -1.749776e-03 3 1  ON 29
ci_31                -1.745012e-03 3 1  ON 30
ci_32                -1.537046e-03 3 1  ON 31
ci_33                -1.106564e-03 3 1  ON 32
ci_34                 1.784374e-03 3 1  ON 33
ci_35                 1.375912e-03 3 1  ON 34
ci_36                -1.266609e-03 3 1  ON 35
ci_37                -1.235331e-03 3 1  ON 36
ci_38                -7.315195e-04 3 1  ON 37
ci_39                -6.903330e-04 3 1  ON 38
ci_40                -1.663976e-03 3 1  ON 39
ci_41                -1.648485e-03 3 1  ON 40
ci_42                -1.181857e-03 3 1  ON 41
ci_43                -3.134261e-03 3 1  ON 42
ci_44                -1.604541e-03 3 1  ON 43
ci_45                -7.572655e-04 3 1  ON 44
ci_46                -5.234222e-04 3 1  ON 45
ci_47                 9.766511e-04 3 1  ON 46
ci_48                 4.303652e-04 3 1  ON 47
ci_49                -9.096246e-04 3 1  ON 48
ci_50                -7.532435e-04 3 1  ON 49
ci_51                 4.734716e-04 3 1  ON 50
ci_52                 4.093783e-04 3 1  ON 51
ci_53                -7.201840e-04 3 1  ON 52
ci_54                -8.881494e-04 3 1  ON 53
ci_55                -7.019375e-04 3 1  ON 54
ci_56                 1.895632e-03 3 1  ON 55
ci_57                 1.541418e-03 3 1  ON 56
ci_58                -7.843940e-04 3 1  ON 57
ci_59                -9.540719e-04 3 1  ON 58
ci_60                 5.707415e-04 3 1  ON 59
ci_61                 6.376301e-04 3 1  ON 60
ci_62                -1.795723e-04 3 1  ON 61
ci_63                -7.733397e-04 3 1  ON 62
ci_64                -5.429884e-04 3 1  ON 63
ci_65                -3.226988e-04 3 1  ON 64
ci_66                -7.232519e-04 3 1  ON 65
ci_67                -5.938141e-04 3 1  ON 66
ci_68                -4.660011e-04 3 1  ON 67
ci_69                 2.023196e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3312e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8339
    reference variance = 0.845735
====================================================
  Execution time = 2.5951e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5101e-01
  Total weights = 1.964406618e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9729e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436410985108
                                         uncertainty =       0.002065915033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436410985108
                                         uncertainty =       0.002065915033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467123008
  error estimate for blocks of size 2^( 2) =       0.000492484781
  error estimate for blocks of size 2^( 3) =       0.000515838216
  error estimate for blocks of size 2^( 4) =       0.000532983899
  error estimate for blocks of size 2^( 5) =       0.000543156722
  error estimate for blocks of size 2^( 6) =       0.000549383533
  error estimate for blocks of size 2^( 7) =       0.000554696027

      target function =      -0.744515166311
              le_mean =     -22.814488315394
             les_mean =     520.951883448625
             stat err =       0.000545055045
             autocorr =       1.361501772774
   target nu stat err =       0.000545055045
   target dn stat err =       0.003124728507
      target stat err =       0.002646779451
              std dev =       0.660611692530
             le_variance =       0.436407808307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281448831539e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744523688488       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744920190316       residual = 9.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744990047013       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745001406318       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745001588122       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745003242698       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745004487921       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745004823966       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745005009481       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745004924387       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745004924577       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 3.720873e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744523688488       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744673207480       residual = 8.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744696724840       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744700118888       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744699917386       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744700286299       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744700578684       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744700636582       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744700668516       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744700649940       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.204877e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744523688488       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744566507183       residual = 8.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744572911837       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744573788681       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744573708795       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744573794629       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744573864274       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744573875999       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744573882490       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744573878329       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.279614e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080232 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0941e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.321804e-01 3 1  ON 0
ci_02                -3.171125e-02 3 1  ON 1
ci_03                -3.131159e-02 3 1  ON 2
ci_04                 2.841039e-02 3 1  ON 3
ci_05                -2.396605e-02 3 1  ON 4
ci_06                -2.350883e-02 3 1  ON 5
ci_07                 2.688304e-02 3 1  ON 6
ci_08                -6.841950e-03 3 1  ON 7
ci_09                -9.591541e-03 3 1  ON 8
ci_10                -9.572800e-03 3 1  ON 9
ci_11                 1.318434e-02 3 1  ON 10
ci_12                 7.959246e-03 3 1  ON 11
ci_13                 1.281078e-02 3 1  ON 12
ci_14                 1.309823e-02 3 1  ON 13
ci_15                 7.369125e-03 3 1  ON 14
ci_16                 7.616829e-03 3 1  ON 15
ci_17                -7.856718e-03 3 1  ON 16
ci_18                -7.292195e-03 3 1  ON 17
ci_19                 9.373633e-03 3 1  ON 18
ci_20                 6.854335e-03 3 1  ON 19
ci_21                 8.810326e-03 3 1  ON 20
ci_22                 8.834782e-03 3 1  ON 21
ci_23                 4.971333e-03 3 1  ON 22
ci_24                 4.412555e-03 3 1  ON 23
ci_25                 3.169744e-03 3 1  ON 24
ci_26                 3.147880e-03 3 1  ON 25
ci_27                 3.376743e-03 3 1  ON 26
ci_28                 2.526284e-03 3 1  ON 27
ci_29                 2.132828e-03 3 1  ON 28
ci_30                -1.656094e-03 3 1  ON 29
ci_31                -1.602674e-03 3 1  ON 30
ci_32                -1.491602e-03 3 1  ON 31
ci_33                -1.210996e-03 3 1  ON 32
ci_34                 1.497197e-03 3 1  ON 33
ci_35                 1.232676e-03 3 1  ON 34
ci_36                -1.315456e-03 3 1  ON 35
ci_37                -1.137789e-03 3 1  ON 36
ci_38                -2.872235e-04 3 1  ON 37
ci_39                -6.579605e-04 3 1  ON 38
ci_40                -1.733890e-03 3 1  ON 39
ci_41                -1.162390e-03 3 1  ON 40
ci_42                -1.063324e-03 3 1  ON 41
ci_43                -3.080649e-03 3 1  ON 42
ci_44                -1.756439e-03 3 1  ON 43
ci_45                -7.439978e-04 3 1  ON 44
ci_46                -5.435261e-04 3 1  ON 45
ci_47                 1.064345e-03 3 1  ON 46
ci_48                 7.415509e-04 3 1  ON 47
ci_49                -9.247342e-04 3 1  ON 48
ci_50                -7.913288e-04 3 1  ON 49
ci_51                 5.142847e-04 3 1  ON 50
ci_52                 3.597295e-04 3 1  ON 51
ci_53                -4.133668e-04 3 1  ON 52
ci_54                -1.148100e-03 3 1  ON 53
ci_55                -7.126114e-04 3 1  ON 54
ci_56                 1.896859e-03 3 1  ON 55
ci_57                 1.580738e-03 3 1  ON 56
ci_58                -9.537079e-04 3 1  ON 57
ci_59                -8.009712e-04 3 1  ON 58
ci_60                 3.918223e-04 3 1  ON 59
ci_61                 4.785012e-04 3 1  ON 60
ci_62                -2.181886e-04 3 1  ON 61
ci_63                -6.429723e-04 3 1  ON 62
ci_64                -5.653388e-04 3 1  ON 63
ci_65                -1.485698e-04 3 1  ON 64
ci_66                -7.269517e-04 3 1  ON 65
ci_67                -6.369282e-04 3 1  ON 66
ci_68                -6.813751e-04 3 1  ON 67
ci_69                 3.285404e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7882
    reference variance = 0.302108
====================================================
  Execution time = 2.5217e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5069e-01
  Total weights = 1.9642e+06
  Execution time = 3.4751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437768279262
                                         uncertainty =       0.002500441937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437768279262
                                         uncertainty =       0.002500441937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467838186
  error estimate for blocks of size 2^( 2) =       0.000493039202
  error estimate for blocks of size 2^( 3) =       0.000516497486
  error estimate for blocks of size 2^( 4) =       0.000533342613
  error estimate for blocks of size 2^( 5) =       0.000544117191
  error estimate for blocks of size 2^( 6) =       0.000550112736
  error estimate for blocks of size 2^( 7) =       0.000553610706

      target function =      -0.742466272931
              le_mean =     -22.815017947951
             les_mean =     520.978534123012
             stat err =       0.000545295812
             autocorr =       1.358541751914
   target nu stat err =       0.000545295812
   target dn stat err =       0.003870499361
      target stat err =       0.003233710360
              std dev =       0.661623107342
             le_variance =       0.437745136169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436108750278
                                         uncertainty =       0.002155843874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436108750278
                                         uncertainty =       0.002155843874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466950152
  error estimate for blocks of size 2^( 2) =       0.000492350234
  error estimate for blocks of size 2^( 3) =       0.000516017128
  error estimate for blocks of size 2^( 4) =       0.000532975333
  error estimate for blocks of size 2^( 5) =       0.000543845598
  error estimate for blocks of size 2^( 6) =       0.000549821954
  error estimate for blocks of size 2^( 7) =       0.000553318767

      target function =      -0.738759682421
              le_mean =     -22.815031252614
             les_mean =     520.983642139808
             stat err =       0.000544990413
             autocorr =       1.362186851323
   target nu stat err =       0.000544990413
   target dn stat err =       0.007011277118
      target stat err =       0.005729545304
              std dev =       0.660367237226
             le_variance =       0.436084888002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436453303161
                                         uncertainty =       0.002199189006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436453303161
                                         uncertainty =       0.002199189006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467134693
  error estimate for blocks of size 2^( 2) =       0.000492487827
  error estimate for blocks of size 2^( 3) =       0.000516117444
  error estimate for blocks of size 2^( 4) =       0.000533053709
  error estimate for blocks of size 2^( 5) =       0.000543887962
  error estimate for blocks of size 2^( 6) =       0.000549887589
  error estimate for blocks of size 2^( 7) =       0.000553425187

      target function =      -0.707669655551
              le_mean =     -22.815002439322
             les_mean =     521.020020586704
             stat err =       0.000545063612
             autocorr =       1.361476451055
   target nu stat err =       0.000545063612
   target dn stat err =       0.046704198363
      target stat err =       0.034914975936
              std dev =       0.660628218710
             le_variance =       0.436429643356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437499566931
                                         uncertainty =       0.002426164450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437499566931
                                         uncertainty =       0.002426164450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467694542
  error estimate for blocks of size 2^( 2) =       0.000492917633
  error estimate for blocks of size 2^( 3) =       0.000516399492
  error estimate for blocks of size 2^( 4) =       0.000533257006
  error estimate for blocks of size 2^( 5) =       0.000544039832
  error estimate for blocks of size 2^( 6) =       0.000550033676
  error estimate for blocks of size 2^( 7) =       0.000553527407

      target function =      -0.744374154049
              le_mean =     -22.815010698063
             les_mean =     520.975887541388
             stat err =       0.000545214480
             autocorr =       1.358970910385
   target nu stat err =       0.000545214480
   target dn stat err =       0.003546256186
      target stat err =       0.002987565265
              std dev =       0.661419963817
             le_variance =       0.437476368536


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742466272931        initial
     6.2500e-02     6.2500e-01             3.7209e-03        -0.738759682421
     2.5000e-01     2.5000e+00             1.2049e-03        -0.707669655551
     1.0000e+00     1.0000e+01             3.2796e-04        -0.744374154049  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.2683e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.330593e-01 3 1  ON 0
ci_02                -3.254561e-02 3 1  ON 1
ci_03                -3.208135e-02 3 1  ON 2
ci_04                 2.892076e-02 3 1  ON 3
ci_05                -2.430698e-02 3 1  ON 4
ci_06                -2.379327e-02 3 1  ON 5
ci_07                 2.714415e-02 3 1  ON 6
ci_08                -6.998171e-03 3 1  ON 7
ci_09                -9.802170e-03 3 1  ON 8
ci_10                -9.803614e-03 3 1  ON 9
ci_11                 1.321902e-02 3 1  ON 10
ci_12                 8.084750e-03 3 1  ON 11
ci_13                 1.275420e-02 3 1  ON 12
ci_14                 1.294570e-02 3 1  ON 13
ci_15                 7.447930e-03 3 1  ON 14
ci_16                 7.633928e-03 3 1  ON 15
ci_17                -7.927222e-03 3 1  ON 16
ci_18                -7.426984e-03 3 1  ON 17
ci_19                 9.488500e-03 3 1  ON 18
ci_20                 7.055954e-03 3 1  ON 19
ci_21                 8.899437e-03 3 1  ON 20
ci_22                 8.843409e-03 3 1  ON 21
ci_23                 4.952248e-03 3 1  ON 22
ci_24                 4.447713e-03 3 1  ON 23
ci_25                 3.257719e-03 3 1  ON 24
ci_26                 3.250480e-03 3 1  ON 25
ci_27                 3.317416e-03 3 1  ON 26
ci_28                 2.660419e-03 3 1  ON 27
ci_29                 2.157604e-03 3 1  ON 28
ci_30                -1.725600e-03 3 1  ON 29
ci_31                -1.707197e-03 3 1  ON 30
ci_32                -1.523472e-03 3 1  ON 31
ci_33                -1.135771e-03 3 1  ON 32
ci_34                 1.702545e-03 3 1  ON 33
ci_35                 1.334219e-03 3 1  ON 34
ci_36                -1.280840e-03 3 1  ON 35
ci_37                -1.207721e-03 3 1  ON 36
ci_38                -6.039882e-04 3 1  ON 37
ci_39                -6.812436e-04 3 1  ON 38
ci_40                -1.684713e-03 3 1  ON 39
ci_41                -1.508598e-03 3 1  ON 40
ci_42                -1.147970e-03 3 1  ON 41
ci_43                -3.119951e-03 3 1  ON 42
ci_44                -1.647824e-03 3 1  ON 43
ci_45                -7.530408e-04 3 1  ON 44
ci_46                -5.294126e-04 3 1  ON 45
ci_47                 1.000336e-03 3 1  ON 46
ci_48                 5.151655e-04 3 1  ON 47
ci_49                -9.141562e-04 3 1  ON 48
ci_50                -7.645466e-04 3 1  ON 49
ci_51                 4.855187e-04 3 1  ON 50
ci_52                 3.954084e-04 3 1  ON 51
ci_53                -6.312135e-04 3 1  ON 52
ci_54                -9.612964e-04 3 1  ON 53
ci_55                -7.049809e-04 3 1  ON 54
ci_56                 1.896061e-03 3 1  ON 55
ci_57                 1.552531e-03 3 1  ON 56
ci_58                -8.322552e-04 3 1  ON 57
ci_59                -9.099493e-04 3 1  ON 58
ci_60                 5.234011e-04 3 1  ON 59
ci_61                 5.943722e-04 3 1  ON 60
ci_62                -1.908576e-04 3 1  ON 61
ci_63                -7.359234e-04 3 1  ON 62
ci_64                -5.496799e-04 3 1  ON 63
ci_65                -2.732510e-04 3 1  ON 64
ci_66                -7.243270e-04 3 1  ON 65
ci_67                -6.065142e-04 3 1  ON 66
ci_68                -5.270797e-04 3 1  ON 67
ci_69                 2.384307e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3640e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7993
    reference variance = 0.269107
====================================================
  Execution time = 2.5919e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5363e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4963e-01
  Total weights = 1.964097267e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435364117733
                                         uncertainty =       0.002164976092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435364117733
                                         uncertainty =       0.002164976092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466560943
  error estimate for blocks of size 2^( 2) =       0.000491620477
  error estimate for blocks of size 2^( 3) =       0.000514894351
  error estimate for blocks of size 2^( 4) =       0.000532364569
  error estimate for blocks of size 2^( 5) =       0.000543223696
  error estimate for blocks of size 2^( 6) =       0.000547193446
  error estimate for blocks of size 2^( 7) =       0.000550319942

      target function =      -0.745654190543
              le_mean =     -22.814515268803
             les_mean =     520.951736521875
             stat err =       0.000543275413
             autocorr =       1.355886513427
   target nu stat err =       0.000543275413
   target dn stat err =       0.002811675302
      target stat err =       0.002402831061
              std dev =       0.659816813247
             le_variance =       0.435358227043


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281451526880e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745660954452       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745762721872       residual = 5.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745778559124       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745780628720       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745781650516       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745781333994       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745781538138       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745781556573       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745781599414       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745781582463       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 9.564441e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745660954452       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745690083941       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745694406413       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745694933860       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745695186784       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745695097265       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745695146546       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745695150325       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745695159632       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745695155955       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.700541e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745660954452       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745668510579       residual = 5.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745669615888       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745669748017       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745669810843       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745669787804       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745669799977       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745669800865       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745669803090       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745669802212       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 6.976939e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088488 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0447e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.328022e-01 3 1  ON 0
ci_02                -3.227556e-02 3 1  ON 1
ci_03                -3.199706e-02 3 1  ON 2
ci_04                 2.875100e-02 3 1  ON 3
ci_05                -2.413070e-02 3 1  ON 4
ci_06                -2.370024e-02 3 1  ON 5
ci_07                 2.712346e-02 3 1  ON 6
ci_08                -6.881502e-03 3 1  ON 7
ci_09                -9.684505e-03 3 1  ON 8
ci_10                -9.713812e-03 3 1  ON 9
ci_11                 1.324149e-02 3 1  ON 10
ci_12                 8.013499e-03 3 1  ON 11
ci_13                 1.275958e-02 3 1  ON 12
ci_14                 1.297218e-02 3 1  ON 13
ci_15                 7.380815e-03 3 1  ON 14
ci_16                 7.584941e-03 3 1  ON 15
ci_17                -7.841456e-03 3 1  ON 16
ci_18                -7.387639e-03 3 1  ON 17
ci_19                 9.450161e-03 3 1  ON 18
ci_20                 6.957345e-03 3 1  ON 19
ci_21                 8.828495e-03 3 1  ON 20
ci_22                 8.829511e-03 3 1  ON 21
ci_23                 5.003158e-03 3 1  ON 22
ci_24                 4.386273e-03 3 1  ON 23
ci_25                 3.198035e-03 3 1  ON 24
ci_26                 3.267454e-03 3 1  ON 25
ci_27                 3.328446e-03 3 1  ON 26
ci_28                 2.609135e-03 3 1  ON 27
ci_29                 2.172527e-03 3 1  ON 28
ci_30                -1.675865e-03 3 1  ON 29
ci_31                -1.702995e-03 3 1  ON 30
ci_32                -1.462828e-03 3 1  ON 31
ci_33                -1.093120e-03 3 1  ON 32
ci_34                 1.656500e-03 3 1  ON 33
ci_35                 1.349342e-03 3 1  ON 34
ci_36                -1.278412e-03 3 1  ON 35
ci_37                -1.183527e-03 3 1  ON 36
ci_38                -5.921442e-04 3 1  ON 37
ci_39                -6.800306e-04 3 1  ON 38
ci_40                -1.712309e-03 3 1  ON 39
ci_41                -1.527078e-03 3 1  ON 40
ci_42                -1.164253e-03 3 1  ON 41
ci_43                -3.045369e-03 3 1  ON 42
ci_44                -1.729718e-03 3 1  ON 43
ci_45                -7.157478e-04 3 1  ON 44
ci_46                -5.603991e-04 3 1  ON 45
ci_47                 1.051223e-03 3 1  ON 46
ci_48                 5.864881e-04 3 1  ON 47
ci_49                -8.846061e-04 3 1  ON 48
ci_50                -7.294437e-04 3 1  ON 49
ci_51                 4.418172e-04 3 1  ON 50
ci_52                 3.924727e-04 3 1  ON 51
ci_53                -6.042370e-04 3 1  ON 52
ci_54                -9.753861e-04 3 1  ON 53
ci_55                -6.651810e-04 3 1  ON 54
ci_56                 1.868590e-03 3 1  ON 55
ci_57                 1.630511e-03 3 1  ON 56
ci_58                -7.653334e-04 3 1  ON 57
ci_59                -9.369959e-04 3 1  ON 58
ci_60                 5.111499e-04 3 1  ON 59
ci_61                 5.878064e-04 3 1  ON 60
ci_62                -2.257037e-04 3 1  ON 61
ci_63                -6.804896e-04 3 1  ON 62
ci_64                -5.427221e-04 3 1  ON 63
ci_65                -2.566824e-04 3 1  ON 64
ci_66                -7.078946e-04 3 1  ON 65
ci_67                -5.603829e-04 3 1  ON 66
ci_68                -5.489437e-04 3 1  ON 67
ci_69                 1.676461e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8445
    reference variance = 1.04466
====================================================
  Execution time = 2.5141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5198e-01
  Total weights = 1.9641e+06
  Execution time = 3.4900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437745488538
                                         uncertainty =       0.002613284606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437745488538
                                         uncertainty =       0.002613284606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467867786
  error estimate for blocks of size 2^( 2) =       0.000492933462
  error estimate for blocks of size 2^( 3) =       0.000516019031
  error estimate for blocks of size 2^( 4) =       0.000533067624
  error estimate for blocks of size 2^( 5) =       0.000544322164
  error estimate for blocks of size 2^( 6) =       0.000550313151
  error estimate for blocks of size 2^( 7) =       0.000550737108

      target function =      -0.740695840234
              le_mean =     -22.814989870072
             les_mean =     520.979409750679
             stat err =       0.000544610012
             autocorr =       1.354955255652
   target nu stat err =       0.000544610012
   target dn stat err =       0.004471440807
      target stat err =       0.003701730180
              std dev =       0.661664968385
             le_variance =       0.437800530388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437557222118
                                         uncertainty =       0.002635630004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437557222118
                                         uncertainty =       0.002635630004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467765507
  error estimate for blocks of size 2^( 2) =       0.000492880695
  error estimate for blocks of size 2^( 3) =       0.000516019240
  error estimate for blocks of size 2^( 4) =       0.000533099238
  error estimate for blocks of size 2^( 5) =       0.000544365988
  error estimate for blocks of size 2^( 6) =       0.000550393461
  error estimate for blocks of size 2^( 7) =       0.000550810287

      target function =      -0.742613634741
              le_mean =     -22.814995218060
             les_mean =     520.977320621750
             stat err =       0.000544667243
             autocorr =       1.355832770083
   target nu stat err =       0.000544667243
   target dn stat err =       0.003496936779
      target stat err =       0.002933899641
              std dev =       0.661520324391
             le_variance =       0.437609139582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437625689015
                                         uncertainty =       0.002625999050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437625689015
                                         uncertainty =       0.002625999050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467802818
  error estimate for blocks of size 2^( 2) =       0.000492896643
  error estimate for blocks of size 2^( 3) =       0.000516011937
  error estimate for blocks of size 2^( 4) =       0.000533079188
  error estimate for blocks of size 2^( 5) =       0.000544340700
  error estimate for blocks of size 2^( 6) =       0.000550352781
  error estimate for blocks of size 2^( 7) =       0.000550773555

      target function =      -0.743538445494
              le_mean =     -22.814991664011
             les_mean =     520.976034288209
             stat err =       0.000544636556
             autocorr =       1.355463755641
   target nu stat err =       0.000544636556
   target dn stat err =       0.003400817443
      target stat err =       0.002863637207
              std dev =       0.661573089427
             le_variance =       0.437678952654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437726457400
                                         uncertainty =       0.002614937090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437726457400
                                         uncertainty =       0.002614937090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467857494
  error estimate for blocks of size 2^( 2) =       0.000492927075
  error estimate for blocks of size 2^( 3) =       0.000516016281
  error estimate for blocks of size 2^( 4) =       0.000533067790
  error estimate for blocks of size 2^( 5) =       0.000544323271
  error estimate for blocks of size 2^( 6) =       0.000550317524
  error estimate for blocks of size 2^( 7) =       0.000550741028

      target function =      -0.743153390164
              le_mean =     -22.814990270181
             les_mean =     520.976438702476
             stat err =       0.000544612403
             autocorr =       1.355026768892
   target nu stat err =       0.000544612403
   target dn stat err =       0.003403132096
      target stat err =       0.002862586860
              std dev =       0.661650413834
             le_variance =       0.437781270127


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740695840234        initial
     2.5000e-01     2.5000e+00             9.5644e-04        -0.742613634741
     1.0000e+00     1.0000e+01             2.7005e-04        -0.743538445494  <--
     4.0000e+00     4.0000e+01             6.9769e-05        -0.743153390164

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.2629e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.328022e-01 3 1  ON 0
ci_02                -3.227556e-02 3 1  ON 1
ci_03                -3.199706e-02 3 1  ON 2
ci_04                 2.875100e-02 3 1  ON 3
ci_05                -2.413070e-02 3 1  ON 4
ci_06                -2.370024e-02 3 1  ON 5
ci_07                 2.712346e-02 3 1  ON 6
ci_08                -6.881502e-03 3 1  ON 7
ci_09                -9.684505e-03 3 1  ON 8
ci_10                -9.713812e-03 3 1  ON 9
ci_11                 1.324149e-02 3 1  ON 10
ci_12                 8.013499e-03 3 1  ON 11
ci_13                 1.275958e-02 3 1  ON 12
ci_14                 1.297218e-02 3 1  ON 13
ci_15                 7.380815e-03 3 1  ON 14
ci_16                 7.584941e-03 3 1  ON 15
ci_17                -7.841456e-03 3 1  ON 16
ci_18                -7.387639e-03 3 1  ON 17
ci_19                 9.450161e-03 3 1  ON 18
ci_20                 6.957345e-03 3 1  ON 19
ci_21                 8.828495e-03 3 1  ON 20
ci_22                 8.829511e-03 3 1  ON 21
ci_23                 5.003158e-03 3 1  ON 22
ci_24                 4.386273e-03 3 1  ON 23
ci_25                 3.198035e-03 3 1  ON 24
ci_26                 3.267454e-03 3 1  ON 25
ci_27                 3.328446e-03 3 1  ON 26
ci_28                 2.609135e-03 3 1  ON 27
ci_29                 2.172527e-03 3 1  ON 28
ci_30                -1.675865e-03 3 1  ON 29
ci_31                -1.702995e-03 3 1  ON 30
ci_32                -1.462828e-03 3 1  ON 31
ci_33                -1.093120e-03 3 1  ON 32
ci_34                 1.656500e-03 3 1  ON 33
ci_35                 1.349342e-03 3 1  ON 34
ci_36                -1.278412e-03 3 1  ON 35
ci_37                -1.183527e-03 3 1  ON 36
ci_38                -5.921442e-04 3 1  ON 37
ci_39                -6.800306e-04 3 1  ON 38
ci_40                -1.712309e-03 3 1  ON 39
ci_41                -1.527078e-03 3 1  ON 40
ci_42                -1.164253e-03 3 1  ON 41
ci_43                -3.045369e-03 3 1  ON 42
ci_44                -1.729718e-03 3 1  ON 43
ci_45                -7.157478e-04 3 1  ON 44
ci_46                -5.603991e-04 3 1  ON 45
ci_47                 1.051223e-03 3 1  ON 46
ci_48                 5.864881e-04 3 1  ON 47
ci_49                -8.846061e-04 3 1  ON 48
ci_50                -7.294437e-04 3 1  ON 49
ci_51                 4.418172e-04 3 1  ON 50
ci_52                 3.924727e-04 3 1  ON 51
ci_53                -6.042370e-04 3 1  ON 52
ci_54                -9.753861e-04 3 1  ON 53
ci_55                -6.651810e-04 3 1  ON 54
ci_56                 1.868590e-03 3 1  ON 55
ci_57                 1.630511e-03 3 1  ON 56
ci_58                -7.653334e-04 3 1  ON 57
ci_59                -9.369959e-04 3 1  ON 58
ci_60                 5.111499e-04 3 1  ON 59
ci_61                 5.878064e-04 3 1  ON 60
ci_62                -2.257037e-04 3 1  ON 61
ci_63                -6.804896e-04 3 1  ON 62
ci_64                -5.427221e-04 3 1  ON 63
ci_65                -2.566824e-04 3 1  ON 64
ci_66                -7.078946e-04 3 1  ON 65
ci_67                -5.603829e-04 3 1  ON 66
ci_68                -5.489437e-04 3 1  ON 67
ci_69                 1.676461e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3092e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8389
    reference variance = 0.266464
====================================================
  Execution time = 2.5848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5044e-01
  Total weights = 1.964419983e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436686958575
                                         uncertainty =       0.002305621033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436686958575
                                         uncertainty =       0.002305621033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467262452
  error estimate for blocks of size 2^( 2) =       0.000492458303
  error estimate for blocks of size 2^( 3) =       0.000515898495
  error estimate for blocks of size 2^( 4) =       0.000533391411
  error estimate for blocks of size 2^( 5) =       0.000544561205
  error estimate for blocks of size 2^( 6) =       0.000551467216
  error estimate for blocks of size 2^( 7) =       0.000555188138

      target function =      -0.744985651021
              le_mean =     -22.814331086808
             les_mean =     520.944139437810
             stat err =       0.000546151993
             autocorr =       1.366171678627
   target nu stat err =       0.000546151993
   target dn stat err =       0.003043389200
      target stat err =       0.002584364724
              std dev =       0.660808896515
             le_variance =       0.436668397713


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281433108681e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744993682987       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745090446311       residual = 5.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745104654863       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745106846683       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745107990843       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745108456984       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745108738922       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745108665360       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745108690802       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745108718213       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745108714107       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 9.761633e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744993682987       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745021328301       residual = 5.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745025216504       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745025783957       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745026067995       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745026176543       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745026241001       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745026222137       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745026228234       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745026234119       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745026233425       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.753186e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744993682987       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745000850142       residual = 4.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745001845258       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745001988096       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745002058719       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745002085212       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745002100875       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745002096151       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745002097659       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745002099061       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745002098910       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 7.110609e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097510 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0373e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.325656e-01 3 1  ON 0
ci_02                -3.216172e-02 3 1  ON 1
ci_03                -3.185019e-02 3 1  ON 2
ci_04                 2.859267e-02 3 1  ON 3
ci_05                -2.396149e-02 3 1  ON 4
ci_06                -2.342492e-02 3 1  ON 5
ci_07                 2.704235e-02 3 1  ON 6
ci_08                -6.792384e-03 3 1  ON 7
ci_09                -9.617247e-03 3 1  ON 8
ci_10                -9.673347e-03 3 1  ON 9
ci_11                 1.316202e-02 3 1  ON 10
ci_12                 7.963374e-03 3 1  ON 11
ci_13                 1.274808e-02 3 1  ON 12
ci_14                 1.305773e-02 3 1  ON 13
ci_15                 7.297824e-03 3 1  ON 14
ci_16                 7.533353e-03 3 1  ON 15
ci_17                -7.874143e-03 3 1  ON 16
ci_18                -7.352086e-03 3 1  ON 17
ci_19                 9.379072e-03 3 1  ON 18
ci_20                 6.911852e-03 3 1  ON 19
ci_21                 8.820430e-03 3 1  ON 20
ci_22                 8.815819e-03 3 1  ON 21
ci_23                 4.996085e-03 3 1  ON 22
ci_24                 4.385625e-03 3 1  ON 23
ci_25                 3.234035e-03 3 1  ON 24
ci_26                 3.248407e-03 3 1  ON 25
ci_27                 3.320167e-03 3 1  ON 26
ci_28                 2.560856e-03 3 1  ON 27
ci_29                 2.144351e-03 3 1  ON 28
ci_30                -1.715900e-03 3 1  ON 29
ci_31                -1.667064e-03 3 1  ON 30
ci_32                -1.425321e-03 3 1  ON 31
ci_33                -1.066848e-03 3 1  ON 32
ci_34                 1.582918e-03 3 1  ON 33
ci_35                 1.262911e-03 3 1  ON 34
ci_36                -1.254817e-03 3 1  ON 35
ci_37                -1.189758e-03 3 1  ON 36
ci_38                -5.234813e-04 3 1  ON 37
ci_39                -6.894358e-04 3 1  ON 38
ci_40                -1.696135e-03 3 1  ON 39
ci_41                -1.522850e-03 3 1  ON 40
ci_42                -1.166588e-03 3 1  ON 41
ci_43                -3.032234e-03 3 1  ON 42
ci_44                -1.739709e-03 3 1  ON 43
ci_45                -7.339169e-04 3 1  ON 44
ci_46                -5.599748e-04 3 1  ON 45
ci_47                 1.169486e-03 3 1  ON 46
ci_48                 6.214077e-04 3 1  ON 47
ci_49                -9.145851e-04 3 1  ON 48
ci_50                -7.090086e-04 3 1  ON 49
ci_51                 4.648252e-04 3 1  ON 50
ci_52                 4.537192e-04 3 1  ON 51
ci_53                -5.993962e-04 3 1  ON 52
ci_54                -9.235065e-04 3 1  ON 53
ci_55                -6.853262e-04 3 1  ON 54
ci_56                 1.880508e-03 3 1  ON 55
ci_57                 1.668073e-03 3 1  ON 56
ci_58                -6.827059e-04 3 1  ON 57
ci_59                -1.042554e-03 3 1  ON 58
ci_60                 5.736617e-04 3 1  ON 59
ci_61                 6.594474e-04 3 1  ON 60
ci_62                -2.676391e-04 3 1  ON 61
ci_63                -6.309212e-04 3 1  ON 62
ci_64                -5.326783e-04 3 1  ON 63
ci_65                -2.710991e-04 3 1  ON 64
ci_66                -7.100384e-04 3 1  ON 65
ci_67                -5.675690e-04 3 1  ON 66
ci_68                -5.773957e-04 3 1  ON 67
ci_69                 9.822201e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.9179
    reference variance = 0.304178
====================================================
  Execution time = 2.5181e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4481e-01
  Total weights = 1.9642e+06
  Execution time = 3.5059e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432208669230
                                         uncertainty =       0.001627908488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432208669230
                                         uncertainty =       0.001627908488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464851050
  error estimate for blocks of size 2^( 2) =       0.000490045037
  error estimate for blocks of size 2^( 3) =       0.000513488224
  error estimate for blocks of size 2^( 4) =       0.000531574901
  error estimate for blocks of size 2^( 5) =       0.000542625556
  error estimate for blocks of size 2^( 6) =       0.000547080589
  error estimate for blocks of size 2^( 7) =       0.000550135787

      target function =      -0.746600127995
              le_mean =     -22.813700785625
             les_mean =     520.913416777967
             stat err =       0.000542854208
             autocorr =       1.363762627716
   target nu stat err =       0.000542854208
   target dn stat err =       0.004093517762
      target stat err =       0.003444033513
              std dev =       0.657398659499
             le_variance =       0.432172997511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432038094938
                                         uncertainty =       0.001631144466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432038094938
                                         uncertainty =       0.001631144466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464759391
  error estimate for blocks of size 2^( 2) =       0.000490001047
  error estimate for blocks of size 2^( 3) =       0.000513487766
  error estimate for blocks of size 2^( 4) =       0.000531601276
  error estimate for blocks of size 2^( 5) =       0.000542663904
  error estimate for blocks of size 2^( 6) =       0.000547123819
  error estimate for blocks of size 2^( 7) =       0.000550193004

      target function =      -0.737952612329
              le_mean =     -22.813702651020
             les_mean =     520.923885386139
             stat err =       0.000542895501
             autocorr =       1.364508160113
   target nu stat err =       0.000542895501
   target dn stat err =       0.013401671960
      target stat err =       0.010864374518
              std dev =       0.657269033657
             le_variance =       0.432002582605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432101096895
                                         uncertainty =       0.001629636189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432101096895
                                         uncertainty =       0.001629636189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464793242
  error estimate for blocks of size 2^( 2) =       0.000490013976
  error estimate for blocks of size 2^( 3) =       0.000513481618
  error estimate for blocks of size 2^( 4) =       0.000531584557
  error estimate for blocks of size 2^( 5) =       0.000542641550
  error estimate for blocks of size 2^( 6) =       0.000547099163
  error estimate for blocks of size 2^( 7) =       0.000550156291

      target function =      -0.749622998643
              le_mean =     -22.813700675837
             les_mean =     520.909790169000
             stat err =       0.000542870390
             autocorr =       1.364183206891
   target nu stat err =       0.000542870390
   target dn stat err =       0.002249865118
      target stat err =       0.001973753582
              std dev =       0.657316906826
             le_variance =       0.432065515999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432193236488
                                         uncertainty =       0.001628146781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432193236488
                                         uncertainty =       0.001628146781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464842757
  error estimate for blocks of size 2^( 2) =       0.000490040236
  error estimate for blocks of size 2^( 3) =       0.000513486069
  error estimate for blocks of size 2^( 4) =       0.000531574655
  error estimate for blocks of size 2^( 5) =       0.000542626190
  error estimate for blocks of size 2^( 6) =       0.000547081010
  error estimate for blocks of size 2^( 7) =       0.000550138298

      target function =      -0.747990868445
              le_mean =     -22.813700640282
             les_mean =     520.911743525713
             stat err =       0.000542855038
             autocorr =       1.363815461399
   target nu stat err =       0.000542855038
   target dn stat err =       0.002906946754
      target stat err =       0.002491176393
              std dev =       0.657386931000
             le_variance =       0.432157577049


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746600127995        initial
     2.5000e-01     2.5000e+00             9.7616e-04        -0.737952612329
     1.0000e+00     1.0000e+01             2.7532e-04        -0.749622998643  <--
     4.0000e+00     4.0000e+01             7.1106e-05        -0.747990868445

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.2713e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.325656e-01 3 1  ON 0
ci_02                -3.216172e-02 3 1  ON 1
ci_03                -3.185019e-02 3 1  ON 2
ci_04                 2.859267e-02 3 1  ON 3
ci_05                -2.396149e-02 3 1  ON 4
ci_06                -2.342492e-02 3 1  ON 5
ci_07                 2.704235e-02 3 1  ON 6
ci_08                -6.792384e-03 3 1  ON 7
ci_09                -9.617247e-03 3 1  ON 8
ci_10                -9.673347e-03 3 1  ON 9
ci_11                 1.316202e-02 3 1  ON 10
ci_12                 7.963374e-03 3 1  ON 11
ci_13                 1.274808e-02 3 1  ON 12
ci_14                 1.305773e-02 3 1  ON 13
ci_15                 7.297824e-03 3 1  ON 14
ci_16                 7.533353e-03 3 1  ON 15
ci_17                -7.874143e-03 3 1  ON 16
ci_18                -7.352086e-03 3 1  ON 17
ci_19                 9.379072e-03 3 1  ON 18
ci_20                 6.911852e-03 3 1  ON 19
ci_21                 8.820430e-03 3 1  ON 20
ci_22                 8.815819e-03 3 1  ON 21
ci_23                 4.996085e-03 3 1  ON 22
ci_24                 4.385625e-03 3 1  ON 23
ci_25                 3.234035e-03 3 1  ON 24
ci_26                 3.248407e-03 3 1  ON 25
ci_27                 3.320167e-03 3 1  ON 26
ci_28                 2.560856e-03 3 1  ON 27
ci_29                 2.144351e-03 3 1  ON 28
ci_30                -1.715900e-03 3 1  ON 29
ci_31                -1.667064e-03 3 1  ON 30
ci_32                -1.425321e-03 3 1  ON 31
ci_33                -1.066848e-03 3 1  ON 32
ci_34                 1.582918e-03 3 1  ON 33
ci_35                 1.262911e-03 3 1  ON 34
ci_36                -1.254817e-03 3 1  ON 35
ci_37                -1.189758e-03 3 1  ON 36
ci_38                -5.234813e-04 3 1  ON 37
ci_39                -6.894358e-04 3 1  ON 38
ci_40                -1.696135e-03 3 1  ON 39
ci_41                -1.522850e-03 3 1  ON 40
ci_42                -1.166588e-03 3 1  ON 41
ci_43                -3.032234e-03 3 1  ON 42
ci_44                -1.739709e-03 3 1  ON 43
ci_45                -7.339169e-04 3 1  ON 44
ci_46                -5.599748e-04 3 1  ON 45
ci_47                 1.169486e-03 3 1  ON 46
ci_48                 6.214077e-04 3 1  ON 47
ci_49                -9.145851e-04 3 1  ON 48
ci_50                -7.090086e-04 3 1  ON 49
ci_51                 4.648252e-04 3 1  ON 50
ci_52                 4.537192e-04 3 1  ON 51
ci_53                -5.993962e-04 3 1  ON 52
ci_54                -9.235065e-04 3 1  ON 53
ci_55                -6.853262e-04 3 1  ON 54
ci_56                 1.880508e-03 3 1  ON 55
ci_57                 1.668073e-03 3 1  ON 56
ci_58                -6.827059e-04 3 1  ON 57
ci_59                -1.042554e-03 3 1  ON 58
ci_60                 5.736617e-04 3 1  ON 59
ci_61                 6.594474e-04 3 1  ON 60
ci_62                -2.676391e-04 3 1  ON 61
ci_63                -6.309212e-04 3 1  ON 62
ci_64                -5.326783e-04 3 1  ON 63
ci_65                -2.710991e-04 3 1  ON 64
ci_66                -7.100384e-04 3 1  ON 65
ci_67                -5.675690e-04 3 1  ON 66
ci_68                -5.773957e-04 3 1  ON 67
ci_69                 9.822201e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3102e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8352
    reference variance = 0.483846
====================================================
  Execution time = 2.5904e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4342e-01
  Total weights = 1.964513972e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432008902699
                                         uncertainty =       0.001638437880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432008902699
                                         uncertainty =       0.001638437880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464748345
  error estimate for blocks of size 2^( 2) =       0.000490124286
  error estimate for blocks of size 2^( 3) =       0.000514435695
  error estimate for blocks of size 2^( 4) =       0.000532299257
  error estimate for blocks of size 2^( 5) =       0.000543136463
  error estimate for blocks of size 2^( 6) =       0.000548849996
  error estimate for blocks of size 2^( 7) =       0.000552308776

      target function =      -0.750828411079
              le_mean =     -22.814637224111
             les_mean =     520.951094194165
             stat err =       0.000544148623
             autocorr =       1.370879763612
   target nu stat err =       0.000544148623
   target dn stat err =       0.002267855721
      target stat err =       0.001997376670
              std dev =       0.657253412310
             le_variance =       0.431982047993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281463722411e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750832745159       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750916819161       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750930152209       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750932208313       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750932692735       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750932849954       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750932938039       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750932977512       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750932994532       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750932995525       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 8.843494e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750832745159       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750856774805       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750860421293       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750860947602       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750861061349       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750861095846       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750861116051       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750861124637       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750861128355       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750861128632       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.397772e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750832745159       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750838975687       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750839908770       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750840040774       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750840068564       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750840076840       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750840081764       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750840083819       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750840084710       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750840084781       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 6.125100e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105617 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0466e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.323258e-01 3 1  ON 0
ci_02                -3.202792e-02 3 1  ON 1
ci_03                -3.168233e-02 3 1  ON 2
ci_04                 2.843060e-02 3 1  ON 3
ci_05                -2.373230e-02 3 1  ON 4
ci_06                -2.329240e-02 3 1  ON 5
ci_07                 2.702764e-02 3 1  ON 6
ci_08                -6.716605e-03 3 1  ON 7
ci_09                -9.511077e-03 3 1  ON 8
ci_10                -9.602061e-03 3 1  ON 9
ci_11                 1.312442e-02 3 1  ON 10
ci_12                 7.840095e-03 3 1  ON 11
ci_13                 1.268191e-02 3 1  ON 12
ci_14                 1.306169e-02 3 1  ON 13
ci_15                 7.313641e-03 3 1  ON 14
ci_16                 7.498174e-03 3 1  ON 15
ci_17                -7.820829e-03 3 1  ON 16
ci_18                -7.317107e-03 3 1  ON 17
ci_19                 9.366856e-03 3 1  ON 18
ci_20                 6.915503e-03 3 1  ON 19
ci_21                 8.748809e-03 3 1  ON 20
ci_22                 8.836076e-03 3 1  ON 21
ci_23                 4.947063e-03 3 1  ON 22
ci_24                 4.379925e-03 3 1  ON 23
ci_25                 3.208844e-03 3 1  ON 24
ci_26                 3.181023e-03 3 1  ON 25
ci_27                 3.315761e-03 3 1  ON 26
ci_28                 2.523078e-03 3 1  ON 27
ci_29                 2.123997e-03 3 1  ON 28
ci_30                -1.702213e-03 3 1  ON 29
ci_31                -1.647561e-03 3 1  ON 30
ci_32                -1.429869e-03 3 1  ON 31
ci_33                -1.108904e-03 3 1  ON 32
ci_34                 1.514405e-03 3 1  ON 33
ci_35                 1.248979e-03 3 1  ON 34
ci_36                -1.232850e-03 3 1  ON 35
ci_37                -1.194135e-03 3 1  ON 36
ci_38                -5.278700e-04 3 1  ON 37
ci_39                -6.634745e-04 3 1  ON 38
ci_40                -1.672345e-03 3 1  ON 39
ci_41                -1.452072e-03 3 1  ON 40
ci_42                -1.118025e-03 3 1  ON 41
ci_43                -2.972210e-03 3 1  ON 42
ci_44                -1.806939e-03 3 1  ON 43
ci_45                -7.072419e-04 3 1  ON 44
ci_46                -5.468654e-04 3 1  ON 45
ci_47                 1.195318e-03 3 1  ON 46
ci_48                 6.576596e-04 3 1  ON 47
ci_49                -9.522384e-04 3 1  ON 48
ci_50                -7.168962e-04 3 1  ON 49
ci_51                 4.411926e-04 3 1  ON 50
ci_52                 4.768570e-04 3 1  ON 51
ci_53                -6.127809e-04 3 1  ON 52
ci_54                -9.249873e-04 3 1  ON 53
ci_55                -6.898127e-04 3 1  ON 54
ci_56                 1.881580e-03 3 1  ON 55
ci_57                 1.729333e-03 3 1  ON 56
ci_58                -6.918913e-04 3 1  ON 57
ci_59                -1.023875e-03 3 1  ON 58
ci_60                 6.354497e-04 3 1  ON 59
ci_61                 6.760556e-04 3 1  ON 60
ci_62                -2.124092e-04 3 1  ON 61
ci_63                -6.196328e-04 3 1  ON 62
ci_64                -5.210654e-04 3 1  ON 63
ci_65                -2.478567e-04 3 1  ON 64
ci_66                -7.315422e-04 3 1  ON 65
ci_67                -5.543690e-04 3 1  ON 66
ci_68                -5.372887e-04 3 1  ON 67
ci_69                 7.217990e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.7252
    reference variance = 0.221126
====================================================
  Execution time = 2.5225e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4709e-01
  Total weights = 1.9642e+06
  Execution time = 3.4949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436348302706
                                         uncertainty =       0.002006607479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436348302706
                                         uncertainty =       0.002006607479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467073463
  error estimate for blocks of size 2^( 2) =       0.000492573597
  error estimate for blocks of size 2^( 3) =       0.000516370424
  error estimate for blocks of size 2^( 4) =       0.000533428426
  error estimate for blocks of size 2^( 5) =       0.000544336994
  error estimate for blocks of size 2^( 6) =       0.000551211584
  error estimate for blocks of size 2^( 7) =       0.000552420419

      target function =      -0.747728590029
              le_mean =     -22.814629904560
             les_mean =     520.954467632954
             stat err =       0.000545349356
             autocorr =       1.363261666614
   target nu stat err =       0.000545349356
   target dn stat err =       0.002773529444
      target stat err =       0.002386079739
              std dev =       0.660541625334
             le_variance =       0.436315238798

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0220455
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436183393183
                                         uncertainty =       0.002018319267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436183393183
                                         uncertainty =       0.002018319267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466984645
  error estimate for blocks of size 2^( 2) =       0.000492531703
  error estimate for blocks of size 2^( 3) =       0.000516375362
  error estimate for blocks of size 2^( 4) =       0.000533461441
  error estimate for blocks of size 2^( 5) =       0.000544389730
  error estimate for blocks of size 2^( 6) =       0.000551289711
  error estimate for blocks of size 2^( 7) =       0.000552504641

      target function =      -0.745683885483
              le_mean =     -22.814628751085
             les_mean =     520.956875803800
             stat err =       0.000545411381
             autocorr =       1.364090518497
   target nu stat err =       0.000545411381
   target dn stat err =       0.003294629075
      target stat err =       0.002792599768
              std dev =       0.660416018479
             le_variance =       0.436149317464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436247254477
                                         uncertainty =       0.002013071509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436247254477
                                         uncertainty =       0.002013071509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467019067
  error estimate for blocks of size 2^( 2) =       0.000492545637
  error estimate for blocks of size 2^( 3) =       0.000516368714
  error estimate for blocks of size 2^( 4) =       0.000533442725
  error estimate for blocks of size 2^( 5) =       0.000544362524
  error estimate for blocks of size 2^( 6) =       0.000551249670
  error estimate for blocks of size 2^( 7) =       0.000552459709

      target function =      -0.746420857484
              le_mean =     -22.814627900510
             les_mean =     520.955948203884
             stat err =       0.000545378657
             autocorr =       1.363725786188
   target nu stat err =       0.000545378657
   target dn stat err =       0.003155771292
      target stat err =       0.002685696495
              std dev =       0.660464698568
             le_variance =       0.436213618055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436333957960
                                         uncertainty =       0.002007409505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436333957960
                                         uncertainty =       0.002007409505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467065745
  error estimate for blocks of size 2^( 2) =       0.000492569291
  error estimate for blocks of size 2^( 3) =       0.000516369516
  error estimate for blocks of size 2^( 4) =       0.000533429545
  error estimate for blocks of size 2^( 5) =       0.000544339604
  error estimate for blocks of size 2^( 6) =       0.000551215903
  error estimate for blocks of size 2^( 7) =       0.000552425019

      target function =      -0.747731016343
              le_mean =     -22.814629404540
             les_mean =     520.954441884232
             stat err =       0.000545352518
             autocorr =       1.363322527193
   target nu stat err =       0.000545352518
   target dn stat err =       0.002775833595
      target stat err =       0.002387948002
              std dev =       0.660530711156
             le_variance =       0.436300820381


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747728590029        initial
     2.5000e-01     2.5000e+00             8.8435e-04        -0.745683885483
     1.0000e+00     1.0000e+01             2.3978e-04        -0.746420857484
     4.0000e+00     4.0000e+01             6.1251e-05        -0.747731016343  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.2715e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.325044e-01 3 1  ON 0
ci_02                -3.212708e-02 3 1  ON 1
ci_03                -3.180673e-02 3 1  ON 2
ci_04                 2.855056e-02 3 1  ON 3
ci_05                -2.390227e-02 3 1  ON 4
ci_06                -2.339061e-02 3 1  ON 5
ci_07                 2.703857e-02 3 1  ON 6
ci_08                -6.772769e-03 3 1  ON 7
ci_09                -9.589940e-03 3 1  ON 8
ci_10                -9.654990e-03 3 1  ON 9
ci_11                 1.315232e-02 3 1  ON 10
ci_12                 7.931452e-03 3 1  ON 11
ci_13                 1.273117e-02 3 1  ON 12
ci_14                 1.305870e-02 3 1  ON 13
ci_15                 7.301881e-03 3 1  ON 14
ci_16                 7.524242e-03 3 1  ON 15
ci_17                -7.860449e-03 3 1  ON 16
ci_18                -7.343096e-03 3 1  ON 17
ci_19                 9.375899e-03 3 1  ON 18
ci_20                 6.912789e-03 3 1  ON 19
ci_21                 8.802106e-03 3 1  ON 20
ci_22                 8.821029e-03 3 1  ON 21
ci_23                 4.983333e-03 3 1  ON 22
ci_24                 4.384142e-03 3 1  ON 23
ci_25                 3.227498e-03 3 1  ON 24
ci_26                 3.230989e-03 3 1  ON 25
ci_27                 3.318990e-03 3 1  ON 26
ci_28                 2.551111e-03 3 1  ON 27
ci_29                 2.139090e-03 3 1  ON 28
ci_30                -1.712369e-03 3 1  ON 29
ci_31                -1.662018e-03 3 1  ON 30
ci_32                -1.426487e-03 3 1  ON 31
ci_33                -1.077720e-03 3 1  ON 32
ci_34                 1.565188e-03 3 1  ON 33
ci_35                 1.259278e-03 3 1  ON 34
ci_36                -1.249128e-03 3 1  ON 35
ci_37                -1.190886e-03 3 1  ON 36
ci_38                -5.246140e-04 3 1  ON 37
ci_39                -6.827003e-04 3 1  ON 38
ci_40                -1.689948e-03 3 1  ON 39
ci_41                -1.504473e-03 3 1  ON 40
ci_42                -1.153966e-03 3 1  ON 41
ci_43                -3.016804e-03 3 1  ON 42
ci_44                -1.757088e-03 3 1  ON 43
ci_45                -7.269984e-04 3 1  ON 44
ci_46                -5.565740e-04 3 1  ON 45
ci_47                 1.176141e-03 3 1  ON 46
ci_48                 6.306802e-04 3 1  ON 47
ci_49                -9.243714e-04 3 1  ON 48
ci_50                -7.110677e-04 3 1  ON 49
ci_51                 4.587120e-04 3 1  ON 50
ci_52                 4.597328e-04 3 1  ON 51
ci_53                -6.028893e-04 3 1  ON 52
ci_54                -9.238871e-04 3 1  ON 53
ci_55                -6.864913e-04 3 1  ON 54
ci_56                 1.880786e-03 3 1  ON 55
ci_57                 1.683967e-03 3 1  ON 56
ci_58                -6.850884e-04 3 1  ON 57
ci_59                -1.037728e-03 3 1  ON 58
ci_60                 5.893563e-04 3 1  ON 59
ci_61                 6.636499e-04 3 1  ON 60
ci_62                -2.532690e-04 3 1  ON 61
ci_63                -6.279775e-04 3 1  ON 62
ci_64                -5.296681e-04 3 1  ON 63
ci_65                -2.650764e-04 3 1  ON 64
ci_66                -7.156398e-04 3 1  ON 65
ci_67                -5.641437e-04 3 1  ON 66
ci_68                -5.670313e-04 3 1  ON 67
ci_69                 9.150101e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3196e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7888
    reference variance = 0.312515
====================================================
  Execution time = 2.5817e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5253e-01
  Total weights = 1.964124778e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5440e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437245310218
                                         uncertainty =       0.002020405539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437245310218
                                         uncertainty =       0.002020405539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467532818
  error estimate for blocks of size 2^( 2) =       0.000492619140
  error estimate for blocks of size 2^( 3) =       0.000515881984
  error estimate for blocks of size 2^( 4) =       0.000533222167
  error estimate for blocks of size 2^( 5) =       0.000543712712
  error estimate for blocks of size 2^( 6) =       0.000550394053
  error estimate for blocks of size 2^( 7) =       0.000554714087

      target function =      -0.743256529577
              le_mean =     -22.815000171856
             les_mean =     520.976766671975
             stat err =       0.000545510755
             autocorr =       1.361389609492
   target nu stat err =       0.000545510755
   target dn stat err =       0.003208490040
      target stat err =       0.002707316275
              std dev =       0.661191252259
             le_variance =       0.437173872063


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281500017186e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743265371646       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743292342666       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743296802630       residual = 7.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743297951640       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743298450937       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743298598507       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743298614380       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743298610318       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743298604484       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.205607e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743265371646       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743272357722       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743273495895       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743273786336       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743273909801       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743273945270       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743273948816       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743273947730       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743273946291       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 8.172365e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743265371646       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743267134064       residual = 4.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743267420081       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743267492885       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743267523656       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743267532431       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743267533290       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743267533014       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743267532656       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 2.053253e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113042 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0378e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.324226e-01 3 1  ON 0
ci_02                -3.206062e-02 3 1  ON 1
ci_03                -3.176353e-02 3 1  ON 2
ci_04                 2.850904e-02 3 1  ON 3
ci_05                -2.385898e-02 3 1  ON 4
ci_06                -2.338812e-02 3 1  ON 5
ci_07                 2.704213e-02 3 1  ON 6
ci_08                -6.753157e-03 3 1  ON 7
ci_09                -9.575205e-03 3 1  ON 8
ci_10                -9.623209e-03 3 1  ON 9
ci_11                 1.314877e-02 3 1  ON 10
ci_12                 7.903406e-03 3 1  ON 11
ci_13                 1.274283e-02 3 1  ON 12
ci_14                 1.305677e-02 3 1  ON 13
ci_15                 7.285574e-03 3 1  ON 14
ci_16                 7.526174e-03 3 1  ON 15
ci_17                -7.837621e-03 3 1  ON 16
ci_18                -7.329372e-03 3 1  ON 17
ci_19                 9.378998e-03 3 1  ON 18
ci_20                 6.915170e-03 3 1  ON 19
ci_21                 8.808189e-03 3 1  ON 20
ci_22                 8.837956e-03 3 1  ON 21
ci_23                 4.971879e-03 3 1  ON 22
ci_24                 4.381871e-03 3 1  ON 23
ci_25                 3.213126e-03 3 1  ON 24
ci_26                 3.238696e-03 3 1  ON 25
ci_27                 3.321395e-03 3 1  ON 26
ci_28                 2.533941e-03 3 1  ON 27
ci_29                 2.140410e-03 3 1  ON 28
ci_30                -1.688121e-03 3 1  ON 29
ci_31                -1.663085e-03 3 1  ON 30
ci_32                -1.421524e-03 3 1  ON 31
ci_33                -1.077012e-03 3 1  ON 32
ci_34                 1.554890e-03 3 1  ON 33
ci_35                 1.262249e-03 3 1  ON 34
ci_36                -1.249814e-03 3 1  ON 35
ci_37                -1.184271e-03 3 1  ON 36
ci_38                -5.170285e-04 3 1  ON 37
ci_39                -6.812920e-04 3 1  ON 38
ci_40                -1.679090e-03 3 1  ON 39
ci_41                -1.489991e-03 3 1  ON 40
ci_42                -1.151650e-03 3 1  ON 41
ci_43                -2.973720e-03 3 1  ON 42
ci_44                -1.747189e-03 3 1  ON 43
ci_45                -7.208648e-04 3 1  ON 44
ci_46                -5.532867e-04 3 1  ON 45
ci_47                 1.169705e-03 3 1  ON 46
ci_48                 6.426964e-04 3 1  ON 47
ci_49                -9.285534e-04 3 1  ON 48
ci_50                -7.110583e-04 3 1  ON 49
ci_51                 4.525392e-04 3 1  ON 50
ci_52                 4.510735e-04 3 1  ON 51
ci_53                -6.004252e-04 3 1  ON 52
ci_54                -9.321905e-04 3 1  ON 53
ci_55                -6.915950e-04 3 1  ON 54
ci_56                 1.889413e-03 3 1  ON 55
ci_57                 1.686627e-03 3 1  ON 56
ci_58                -6.783518e-04 3 1  ON 57
ci_59                -1.016230e-03 3 1  ON 58
ci_60                 5.821047e-04 3 1  ON 59
ci_61                 6.694619e-04 3 1  ON 60
ci_62                -2.607884e-04 3 1  ON 61
ci_63                -6.188907e-04 3 1  ON 62
ci_64                -5.277044e-04 3 1  ON 63
ci_65                -2.724717e-04 3 1  ON 64
ci_66                -6.992201e-04 3 1  ON 65
ci_67                -5.594199e-04 3 1  ON 66
ci_68                -5.866820e-04 3 1  ON 67
ci_69                 6.921923e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8284
    reference variance = 0.307565
====================================================
  Execution time = 2.7018e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4879e-01
  Total weights = 1.9642e+06
  Execution time = 3.4934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436519850365
                                         uncertainty =       0.002295363549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436519850365
                                         uncertainty =       0.002295363549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467240451
  error estimate for blocks of size 2^( 2) =       0.000492639583
  error estimate for blocks of size 2^( 3) =       0.000515955891
  error estimate for blocks of size 2^( 4) =       0.000532977169
  error estimate for blocks of size 2^( 5) =       0.000545013319
  error estimate for blocks of size 2^( 6) =       0.000549595984
  error estimate for blocks of size 2^( 7) =       0.000554711460

      target function =      -0.746284013358
              le_mean =     -22.814025742452
             les_mean =     520.928637186422
             stat err =       0.000545574483
             autocorr =       1.363412374046
   target nu stat err =       0.000545574483
   target dn stat err =       0.002799127762
      target stat err =       0.002395598633
              std dev =       0.660777782139
             le_variance =       0.436627277368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436448086390
                                         uncertainty =       0.002294575103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436448086390
                                         uncertainty =       0.002294575103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467202061
  error estimate for blocks of size 2^( 2) =       0.000492613669
  error estimate for blocks of size 2^( 3) =       0.000515944288
  error estimate for blocks of size 2^( 4) =       0.000532974972
  error estimate for blocks of size 2^( 5) =       0.000545017113
  error estimate for blocks of size 2^( 6) =       0.000549597739
  error estimate for blocks of size 2^( 7) =       0.000554707359

      target function =      -0.746191469223
              le_mean =     -22.814023699014
             les_mean =     520.928655738897
             stat err =       0.000545574296
             autocorr =       1.363635510236
   target nu stat err =       0.000545574296
   target dn stat err =       0.002795299733
      target stat err =       0.002391950056
              std dev =       0.660723490342
             le_variance =       0.436555530690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436481831450
                                         uncertainty =       0.002294921697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436481831450
                                         uncertainty =       0.002294921697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467220113
  error estimate for blocks of size 2^( 2) =       0.000492625695
  error estimate for blocks of size 2^( 3) =       0.000515949414
  error estimate for blocks of size 2^( 4) =       0.000532975526
  error estimate for blocks of size 2^( 5) =       0.000545014704
  error estimate for blocks of size 2^( 6) =       0.000549596269
  error estimate for blocks of size 2^( 7) =       0.000554708685

      target function =      -0.746362840024
              le_mean =     -22.814024536764
             les_mean =     520.928487022042
             stat err =       0.000545573796
             autocorr =       1.363527640806
   target nu stat err =       0.000545573796
   target dn stat err =       0.002792637740
      target stat err =       0.002390883518
              std dev =       0.660749019782
             le_variance =       0.436589267143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436514936172
                                         uncertainty =       0.002295303911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436514936172
                                         uncertainty =       0.002295303911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467237822
  error estimate for blocks of size 2^( 2) =       0.000492637776
  error estimate for blocks of size 2^( 3) =       0.000515955024
  error estimate for blocks of size 2^( 4) =       0.000532976899
  error estimate for blocks of size 2^( 5) =       0.000545013434
  error estimate for blocks of size 2^( 6) =       0.000549595938
  error estimate for blocks of size 2^( 7) =       0.000554711060

      target function =      -0.746222521707
              le_mean =     -22.814025557178
             les_mean =     520.928702994361
             stat err =       0.000545574333
             autocorr =       1.363426965236
   target nu stat err =       0.000545574333
   target dn stat err =       0.002800013282
      target stat err =       0.002395925133
              std dev =       0.660774064472
             le_variance =       0.436622364279


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746284013358        initial
     1.0000e+00     1.0000e+01             3.2056e-04        -0.746191469223
     4.0000e+00     4.0000e+01             8.1724e-05        -0.746362840024  <--
     1.6000e+01     1.6000e+02             2.0533e-05        -0.746222521707

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.4501e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.324226e-01 3 1  ON 0
ci_02                -3.206062e-02 3 1  ON 1
ci_03                -3.176353e-02 3 1  ON 2
ci_04                 2.850904e-02 3 1  ON 3
ci_05                -2.385898e-02 3 1  ON 4
ci_06                -2.338812e-02 3 1  ON 5
ci_07                 2.704213e-02 3 1  ON 6
ci_08                -6.753157e-03 3 1  ON 7
ci_09                -9.575205e-03 3 1  ON 8
ci_10                -9.623209e-03 3 1  ON 9
ci_11                 1.314877e-02 3 1  ON 10
ci_12                 7.903406e-03 3 1  ON 11
ci_13                 1.274283e-02 3 1  ON 12
ci_14                 1.305677e-02 3 1  ON 13
ci_15                 7.285574e-03 3 1  ON 14
ci_16                 7.526174e-03 3 1  ON 15
ci_17                -7.837621e-03 3 1  ON 16
ci_18                -7.329372e-03 3 1  ON 17
ci_19                 9.378998e-03 3 1  ON 18
ci_20                 6.915170e-03 3 1  ON 19
ci_21                 8.808189e-03 3 1  ON 20
ci_22                 8.837956e-03 3 1  ON 21
ci_23                 4.971879e-03 3 1  ON 22
ci_24                 4.381871e-03 3 1  ON 23
ci_25                 3.213126e-03 3 1  ON 24
ci_26                 3.238696e-03 3 1  ON 25
ci_27                 3.321395e-03 3 1  ON 26
ci_28                 2.533941e-03 3 1  ON 27
ci_29                 2.140410e-03 3 1  ON 28
ci_30                -1.688121e-03 3 1  ON 29
ci_31                -1.663085e-03 3 1  ON 30
ci_32                -1.421524e-03 3 1  ON 31
ci_33                -1.077012e-03 3 1  ON 32
ci_34                 1.554890e-03 3 1  ON 33
ci_35                 1.262249e-03 3 1  ON 34
ci_36                -1.249814e-03 3 1  ON 35
ci_37                -1.184271e-03 3 1  ON 36
ci_38                -5.170285e-04 3 1  ON 37
ci_39                -6.812920e-04 3 1  ON 38
ci_40                -1.679090e-03 3 1  ON 39
ci_41                -1.489991e-03 3 1  ON 40
ci_42                -1.151650e-03 3 1  ON 41
ci_43                -2.973720e-03 3 1  ON 42
ci_44                -1.747189e-03 3 1  ON 43
ci_45                -7.208648e-04 3 1  ON 44
ci_46                -5.532867e-04 3 1  ON 45
ci_47                 1.169705e-03 3 1  ON 46
ci_48                 6.426964e-04 3 1  ON 47
ci_49                -9.285534e-04 3 1  ON 48
ci_50                -7.110583e-04 3 1  ON 49
ci_51                 4.525392e-04 3 1  ON 50
ci_52                 4.510735e-04 3 1  ON 51
ci_53                -6.004252e-04 3 1  ON 52
ci_54                -9.321905e-04 3 1  ON 53
ci_55                -6.915950e-04 3 1  ON 54
ci_56                 1.889413e-03 3 1  ON 55
ci_57                 1.686627e-03 3 1  ON 56
ci_58                -6.783518e-04 3 1  ON 57
ci_59                -1.016230e-03 3 1  ON 58
ci_60                 5.821047e-04 3 1  ON 59
ci_61                 6.694619e-04 3 1  ON 60
ci_62                -2.607884e-04 3 1  ON 61
ci_63                -6.188907e-04 3 1  ON 62
ci_64                -5.277044e-04 3 1  ON 63
ci_65                -2.724717e-04 3 1  ON 64
ci_66                -6.992201e-04 3 1  ON 65
ci_67                -5.594199e-04 3 1  ON 66
ci_68                -5.866820e-04 3 1  ON 67
ci_69                 6.921923e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4892e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.951
    reference variance = 0.417814
====================================================
  Execution time = 2.5787e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4782e-01
  Total weights = 1.964506350e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435565866450
                                         uncertainty =       0.002353036363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435565866450
                                         uncertainty =       0.002353036363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466644925
  error estimate for blocks of size 2^( 2) =       0.000491472606
  error estimate for blocks of size 2^( 3) =       0.000514916956
  error estimate for blocks of size 2^( 4) =       0.000532612123
  error estimate for blocks of size 2^( 5) =       0.000543490379
  error estimate for blocks of size 2^( 6) =       0.000550846207
  error estimate for blocks of size 2^( 7) =       0.000555041752

      target function =      -0.747149803849
              le_mean =     -22.814041929734
             les_mean =     520.928329790305
             stat err =       0.000545497615
             autocorr =       1.366509386249
   target nu stat err =       0.000545497615
   target dn stat err =       0.003053271496
      target stat err =       0.002605679317
              std dev =       0.659935581284
             le_variance =       0.435514971444


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281404192973e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747158002785       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747183695550       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747187199414       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747188112189       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747188419722       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747188702075       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747188688766       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747188679037       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747188674229       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747188673521       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.633999e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747158002785       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747164656980       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747165553092       residual = 9.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747165782482       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747165857737       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747165926867       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747165923161       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747165920750       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747165919593       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747165919442       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 9.269380e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747158002785       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747159681426       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747159906741       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747159964152       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747159982856       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747160000042       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747159999092       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747159998490       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747159998204       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747159998168       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 2.329190e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116577 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0305e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.323299e-01 3 1  ON 0
ci_02                -3.201662e-02 3 1  ON 1
ci_03                -3.170797e-02 3 1  ON 2
ci_04                 2.846966e-02 3 1  ON 3
ci_05                -2.383077e-02 3 1  ON 4
ci_06                -2.334339e-02 3 1  ON 5
ci_07                 2.704309e-02 3 1  ON 6
ci_08                -6.735852e-03 3 1  ON 7
ci_09                -9.555412e-03 3 1  ON 8
ci_10                -9.565008e-03 3 1  ON 9
ci_11                 1.314528e-02 3 1  ON 10
ci_12                 7.888093e-03 3 1  ON 11
ci_13                 1.274168e-02 3 1  ON 12
ci_14                 1.307386e-02 3 1  ON 13
ci_15                 7.279152e-03 3 1  ON 14
ci_16                 7.508552e-03 3 1  ON 15
ci_17                -7.834040e-03 3 1  ON 16
ci_18                -7.328610e-03 3 1  ON 17
ci_19                 9.393766e-03 3 1  ON 18
ci_20                 6.910149e-03 3 1  ON 19
ci_21                 8.813845e-03 3 1  ON 20
ci_22                 8.843132e-03 3 1  ON 21
ci_23                 4.968446e-03 3 1  ON 22
ci_24                 4.364186e-03 3 1  ON 23
ci_25                 3.195627e-03 3 1  ON 24
ci_26                 3.235822e-03 3 1  ON 25
ci_27                 3.319050e-03 3 1  ON 26
ci_28                 2.541993e-03 3 1  ON 27
ci_29                 2.132873e-03 3 1  ON 28
ci_30                -1.681364e-03 3 1  ON 29
ci_31                -1.670694e-03 3 1  ON 30
ci_32                -1.416458e-03 3 1  ON 31
ci_33                -1.070846e-03 3 1  ON 32
ci_34                 1.541682e-03 3 1  ON 33
ci_35                 1.258134e-03 3 1  ON 34
ci_36                -1.235729e-03 3 1  ON 35
ci_37                -1.194010e-03 3 1  ON 36
ci_38                -5.110135e-04 3 1  ON 37
ci_39                -6.851295e-04 3 1  ON 38
ci_40                -1.674870e-03 3 1  ON 39
ci_41                -1.500470e-03 3 1  ON 40
ci_42                -1.166249e-03 3 1  ON 41
ci_43                -2.961234e-03 3 1  ON 42
ci_44                -1.742904e-03 3 1  ON 43
ci_45                -7.168635e-04 3 1  ON 44
ci_46                -5.484607e-04 3 1  ON 45
ci_47                 1.165564e-03 3 1  ON 46
ci_48                 6.418072e-04 3 1  ON 47
ci_49                -9.357963e-04 3 1  ON 48
ci_50                -7.095382e-04 3 1  ON 49
ci_51                 4.446981e-04 3 1  ON 50
ci_52                 4.501406e-04 3 1  ON 51
ci_53                -6.040102e-04 3 1  ON 52
ci_54                -9.411409e-04 3 1  ON 53
ci_55                -6.835819e-04 3 1  ON 54
ci_56                 1.902189e-03 3 1  ON 55
ci_57                 1.694734e-03 3 1  ON 56
ci_58                -6.952873e-04 3 1  ON 57
ci_59                -1.016963e-03 3 1  ON 58
ci_60                 5.902184e-04 3 1  ON 59
ci_61                 6.617518e-04 3 1  ON 60
ci_62                -2.591758e-04 3 1  ON 61
ci_63                -6.141395e-04 3 1  ON 62
ci_64                -5.150480e-04 3 1  ON 63
ci_65                -2.678006e-04 3 1  ON 64
ci_66                -7.006493e-04 3 1  ON 65
ci_67                -5.607768e-04 3 1  ON 66
ci_68                -5.996884e-04 3 1  ON 67
ci_69                 5.849562e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7979
    reference variance = 0.275911
====================================================
  Execution time = 2.5189e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4601e-01
  Total weights = 1.9642e+06
  Execution time = 3.4953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434324881149
                                         uncertainty =       0.002125443930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434324881149
                                         uncertainty =       0.002125443930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465992433
  error estimate for blocks of size 2^( 2) =       0.000491348738
  error estimate for blocks of size 2^( 3) =       0.000515448561
  error estimate for blocks of size 2^( 4) =       0.000532900606
  error estimate for blocks of size 2^( 5) =       0.000544400490
  error estimate for blocks of size 2^( 6) =       0.000551244127
  error estimate for blocks of size 2^( 7) =       0.000555861084

      target function =      -0.748640666419
              le_mean =     -22.814403107330
             les_mean =     520.943022192508
             stat err =       0.000546101577
             autocorr =       1.373374986018
   target nu stat err =       0.000546101577
   target dn stat err =       0.002794073734
      target stat err =       0.002407691995
              std dev =       0.659012818103
             le_variance =       0.434297894424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434266041244
                                         uncertainty =       0.002127626107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434266041244
                                         uncertainty =       0.002127626107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465960848
  error estimate for blocks of size 2^( 2) =       0.000491330750
  error estimate for blocks of size 2^( 3) =       0.000515442713
  error estimate for blocks of size 2^( 4) =       0.000532905312
  error estimate for blocks of size 2^( 5) =       0.000544410006
  error estimate for blocks of size 2^( 6) =       0.000551258401
  error estimate for blocks of size 2^( 7) =       0.000555880786

      target function =      -0.748363595670
              le_mean =     -22.814403986463
             les_mean =     520.943394592968
             stat err =       0.000546113626
             autocorr =       1.373621790895
   target nu stat err =       0.000546113626
   target dn stat err =       0.002819784939
      target stat err =       0.002426706101
              std dev =       0.658968150875
             le_variance =       0.434239023868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434293734522
                                         uncertainty =       0.002126535426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434293734522
                                         uncertainty =       0.002126535426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465975715
  error estimate for blocks of size 2^( 2) =       0.000491339036
  error estimate for blocks of size 2^( 3) =       0.000515445150
  error estimate for blocks of size 2^( 4) =       0.000532902635
  error estimate for blocks of size 2^( 5) =       0.000544404988
  error estimate for blocks of size 2^( 6) =       0.000551251053
  error estimate for blocks of size 2^( 7) =       0.000555870803

      target function =      -0.748659688605
              le_mean =     -22.814403408897
             les_mean =     520.943013126339
             stat err =       0.000546107370
             autocorr =       1.373502671982
   target nu stat err =       0.000546107370
   target dn stat err =       0.002796361726
      target stat err =       0.002409659127
              std dev =       0.658989175334
             le_variance =       0.434266733207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434320860587
                                         uncertainty =       0.002125578226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434320860587
                                         uncertainty =       0.002125578226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465990275
  error estimate for blocks of size 2^( 2) =       0.000491347463
  error estimate for blocks of size 2^( 3) =       0.000515448080
  error estimate for blocks of size 2^( 4) =       0.000532900809
  error estimate for blocks of size 2^( 5) =       0.000544401008
  error estimate for blocks of size 2^( 6) =       0.000551244952
  error estimate for blocks of size 2^( 7) =       0.000555862269

      target function =      -0.748646633928
              le_mean =     -22.814403126528
             les_mean =     520.943015909751
             stat err =       0.000546102259
             autocorr =       1.373391138239
   target nu stat err =       0.000546102259
   target dn stat err =       0.002794323576
      target stat err =       0.002407930978
              std dev =       0.659009766317
             le_variance =       0.434293872101


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748640666419        initial
     1.0000e+00     1.0000e+01             3.6340e-04        -0.748363595670
     4.0000e+00     4.0000e+01             9.2694e-05        -0.748659688605  <--
     1.6000e+01     1.6000e+02             2.3292e-05        -0.748646633928

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.2648e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.323299e-01 3 1  ON 0
ci_02                -3.201662e-02 3 1  ON 1
ci_03                -3.170797e-02 3 1  ON 2
ci_04                 2.846966e-02 3 1  ON 3
ci_05                -2.383077e-02 3 1  ON 4
ci_06                -2.334339e-02 3 1  ON 5
ci_07                 2.704309e-02 3 1  ON 6
ci_08                -6.735852e-03 3 1  ON 7
ci_09                -9.555412e-03 3 1  ON 8
ci_10                -9.565008e-03 3 1  ON 9
ci_11                 1.314528e-02 3 1  ON 10
ci_12                 7.888093e-03 3 1  ON 11
ci_13                 1.274168e-02 3 1  ON 12
ci_14                 1.307386e-02 3 1  ON 13
ci_15                 7.279152e-03 3 1  ON 14
ci_16                 7.508552e-03 3 1  ON 15
ci_17                -7.834040e-03 3 1  ON 16
ci_18                -7.328610e-03 3 1  ON 17
ci_19                 9.393766e-03 3 1  ON 18
ci_20                 6.910149e-03 3 1  ON 19
ci_21                 8.813845e-03 3 1  ON 20
ci_22                 8.843132e-03 3 1  ON 21
ci_23                 4.968446e-03 3 1  ON 22
ci_24                 4.364186e-03 3 1  ON 23
ci_25                 3.195627e-03 3 1  ON 24
ci_26                 3.235822e-03 3 1  ON 25
ci_27                 3.319050e-03 3 1  ON 26
ci_28                 2.541993e-03 3 1  ON 27
ci_29                 2.132873e-03 3 1  ON 28
ci_30                -1.681364e-03 3 1  ON 29
ci_31                -1.670694e-03 3 1  ON 30
ci_32                -1.416458e-03 3 1  ON 31
ci_33                -1.070846e-03 3 1  ON 32
ci_34                 1.541682e-03 3 1  ON 33
ci_35                 1.258134e-03 3 1  ON 34
ci_36                -1.235729e-03 3 1  ON 35
ci_37                -1.194010e-03 3 1  ON 36
ci_38                -5.110135e-04 3 1  ON 37
ci_39                -6.851295e-04 3 1  ON 38
ci_40                -1.674870e-03 3 1  ON 39
ci_41                -1.500470e-03 3 1  ON 40
ci_42                -1.166249e-03 3 1  ON 41
ci_43                -2.961234e-03 3 1  ON 42
ci_44                -1.742904e-03 3 1  ON 43
ci_45                -7.168635e-04 3 1  ON 44
ci_46                -5.484607e-04 3 1  ON 45
ci_47                 1.165564e-03 3 1  ON 46
ci_48                 6.418072e-04 3 1  ON 47
ci_49                -9.357963e-04 3 1  ON 48
ci_50                -7.095382e-04 3 1  ON 49
ci_51                 4.446981e-04 3 1  ON 50
ci_52                 4.501406e-04 3 1  ON 51
ci_53                -6.040102e-04 3 1  ON 52
ci_54                -9.411409e-04 3 1  ON 53
ci_55                -6.835819e-04 3 1  ON 54
ci_56                 1.902189e-03 3 1  ON 55
ci_57                 1.694734e-03 3 1  ON 56
ci_58                -6.952873e-04 3 1  ON 57
ci_59                -1.016963e-03 3 1  ON 58
ci_60                 5.902184e-04 3 1  ON 59
ci_61                 6.617518e-04 3 1  ON 60
ci_62                -2.591758e-04 3 1  ON 61
ci_63                -6.141395e-04 3 1  ON 62
ci_64                -5.150480e-04 3 1  ON 63
ci_65                -2.678006e-04 3 1  ON 64
ci_66                -7.006493e-04 3 1  ON 65
ci_67                -5.607768e-04 3 1  ON 66
ci_68                -5.996884e-04 3 1  ON 67
ci_69                 5.849562e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2959e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8636
    reference variance = 0.509366
====================================================
  Execution time = 2.5897e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5359e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5165e-01
  Total weights = 1.964176894e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438380142833
                                         uncertainty =       0.001926506567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438380142833
                                         uncertainty =       0.001926506567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468160550
  error estimate for blocks of size 2^( 2) =       0.000493182313
  error estimate for blocks of size 2^( 3) =       0.000516574670
  error estimate for blocks of size 2^( 4) =       0.000533835381
  error estimate for blocks of size 2^( 5) =       0.000544004130
  error estimate for blocks of size 2^( 6) =       0.000548045055
  error estimate for blocks of size 2^( 7) =       0.000551502227

      target function =      -0.743984101167
              le_mean =     -22.814759005941
             les_mean =     520.964881503535
             stat err =       0.000544346698
             autocorr =       1.351952883008
   target nu stat err =       0.000544346698
   target dn stat err =       0.002788631267
      target stat err =       0.002375215397
              std dev =       0.662078999565
             le_variance =       0.438348601665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281475900594e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743990738874       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744010763756       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744014383348       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744015017667       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744015234459       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744015276718       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744015282150       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744015277224       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744015274385       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.726874e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743990738874       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743995926968       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743996851306       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743997010781       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743997064094       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743997073688       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743997074909       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743997073707       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743997073010       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 6.947976e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743990738874       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743992047785       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743992280107       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743992320025       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743992333292       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743992335628       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743992335925       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743992335626       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743992335453       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.745378e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119646 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0406e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.322605e-01 3 1  ON 0
ci_02                -3.197537e-02 3 1  ON 1
ci_03                -3.165624e-02 3 1  ON 2
ci_04                 2.844663e-02 3 1  ON 3
ci_05                -2.380711e-02 3 1  ON 4
ci_06                -2.332095e-02 3 1  ON 5
ci_07                 2.704820e-02 3 1  ON 6
ci_08                -6.705190e-03 3 1  ON 7
ci_09                -9.529496e-03 3 1  ON 8
ci_10                -9.531054e-03 3 1  ON 9
ci_11                 1.314031e-02 3 1  ON 10
ci_12                 7.875241e-03 3 1  ON 11
ci_13                 1.275401e-02 3 1  ON 12
ci_14                 1.306899e-02 3 1  ON 13
ci_15                 7.260698e-03 3 1  ON 14
ci_16                 7.495920e-03 3 1  ON 15
ci_17                -7.810533e-03 3 1  ON 16
ci_18                -7.297358e-03 3 1  ON 17
ci_19                 9.385293e-03 3 1  ON 18
ci_20                 6.898975e-03 3 1  ON 19
ci_21                 8.817509e-03 3 1  ON 20
ci_22                 8.849390e-03 3 1  ON 21
ci_23                 4.973913e-03 3 1  ON 22
ci_24                 4.355697e-03 3 1  ON 23
ci_25                 3.189786e-03 3 1  ON 24
ci_26                 3.248152e-03 3 1  ON 25
ci_27                 3.313576e-03 3 1  ON 26
ci_28                 2.522758e-03 3 1  ON 27
ci_29                 2.123150e-03 3 1  ON 28
ci_30                -1.680002e-03 3 1  ON 29
ci_31                -1.668658e-03 3 1  ON 30
ci_32                -1.428663e-03 3 1  ON 31
ci_33                -1.090183e-03 3 1  ON 32
ci_34                 1.537280e-03 3 1  ON 33
ci_35                 1.258873e-03 3 1  ON 34
ci_36                -1.233079e-03 3 1  ON 35
ci_37                -1.191913e-03 3 1  ON 36
ci_38                -5.116368e-04 3 1  ON 37
ci_39                -6.840196e-04 3 1  ON 38
ci_40                -1.680515e-03 3 1  ON 39
ci_41                -1.485464e-03 3 1  ON 40
ci_42                -1.164686e-03 3 1  ON 41
ci_43                -2.963485e-03 3 1  ON 42
ci_44                -1.750153e-03 3 1  ON 43
ci_45                -7.097997e-04 3 1  ON 44
ci_46                -5.417438e-04 3 1  ON 45
ci_47                 1.181871e-03 3 1  ON 46
ci_48                 6.571517e-04 3 1  ON 47
ci_49                -9.383124e-04 3 1  ON 48
ci_50                -7.123346e-04 3 1  ON 49
ci_51                 4.325612e-04 3 1  ON 50
ci_52                 4.527205e-04 3 1  ON 51
ci_53                -6.094837e-04 3 1  ON 52
ci_54                -9.410205e-04 3 1  ON 53
ci_55                -6.868082e-04 3 1  ON 54
ci_56                 1.907231e-03 3 1  ON 55
ci_57                 1.704635e-03 3 1  ON 56
ci_58                -6.972635e-04 3 1  ON 57
ci_59                -1.030113e-03 3 1  ON 58
ci_60                 5.759217e-04 3 1  ON 59
ci_61                 6.745305e-04 3 1  ON 60
ci_62                -2.651135e-04 3 1  ON 61
ci_63                -6.118908e-04 3 1  ON 62
ci_64                -5.017487e-04 3 1  ON 63
ci_65                -2.588963e-04 3 1  ON 64
ci_66                -7.030569e-04 3 1  ON 65
ci_67                -5.642127e-04 3 1  ON 66
ci_68                -6.117374e-04 3 1  ON 67
ci_69                 5.530480e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.7847
    reference variance = 0.466341
====================================================
  Execution time = 2.5195e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5260e-01
  Total weights = 1.9645e+06
  Execution time = 3.4969e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438213298771
                                         uncertainty =       0.002499682511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438213298771
                                         uncertainty =       0.002499682511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468043955
  error estimate for blocks of size 2^( 2) =       0.000493146380
  error estimate for blocks of size 2^( 3) =       0.000516543932
  error estimate for blocks of size 2^( 4) =       0.000534254678
  error estimate for blocks of size 2^( 5) =       0.000544424864
  error estimate for blocks of size 2^( 6) =       0.000549433043
  error estimate for blocks of size 2^( 7) =       0.000553498789

      target function =      -0.743171437853
              le_mean =     -22.814099854466
             les_mean =     520.935786592979
             stat err =       0.000545402844
             autocorr =       1.357880384041
   target nu stat err =       0.000545402844
   target dn stat err =       0.003758651113
      target stat err =       0.003145141373
              std dev =       0.661914109116
             le_variance =       0.438130287847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438163295972
                                         uncertainty =       0.002503880709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438163295972
                                         uncertainty =       0.002503880709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468017242
  error estimate for blocks of size 2^( 2) =       0.000493129028
  error estimate for blocks of size 2^( 3) =       0.000516538559
  error estimate for blocks of size 2^( 4) =       0.000534257669
  error estimate for blocks of size 2^( 5) =       0.000544434212
  error estimate for blocks of size 2^( 6) =       0.000549449220
  error estimate for blocks of size 2^( 7) =       0.000553513097

      target function =      -0.743108858779
              le_mean =     -22.814098411151
             les_mean =     520.935796799665
             stat err =       0.000545413549
             autocorr =       1.358088708441
   target nu stat err =       0.000545413549
   target dn stat err =       0.003776257483
      target stat err =       0.003158807724
              std dev =       0.661876331765
             le_variance =       0.438080278551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438186738744
                                         uncertainty =       0.002501811287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438186738744
                                         uncertainty =       0.002501811287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468029767
  error estimate for blocks of size 2^( 2) =       0.000493137083
  error estimate for blocks of size 2^( 3) =       0.000516540814
  error estimate for blocks of size 2^( 4) =       0.000534255838
  error estimate for blocks of size 2^( 5) =       0.000544429349
  error estimate for blocks of size 2^( 6) =       0.000549441012
  error estimate for blocks of size 2^( 7) =       0.000553505868

      target function =      -0.742900170333
              le_mean =     -22.814098969984
             les_mean =     520.936076460053
             stat err =       0.000545408017
             autocorr =       1.357988472702
   target nu stat err =       0.000545408017
   target dn stat err =       0.003784140307
      target stat err =       0.003163418236
              std dev =       0.661894044061
             le_variance =       0.438103725564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438209864450
                                         uncertainty =       0.002499947912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438209864450
                                         uncertainty =       0.002499947912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468042121
  error estimate for blocks of size 2^( 2) =       0.000493145161
  error estimate for blocks of size 2^( 3) =       0.000516543493
  error estimate for blocks of size 2^( 4) =       0.000534254771
  error estimate for blocks of size 2^( 5) =       0.000544425366
  error estimate for blocks of size 2^( 6) =       0.000549433988
  error estimate for blocks of size 2^( 7) =       0.000553499595

      target function =      -0.743185590052
              le_mean =     -22.814099734440
             les_mean =     520.935763878840
             stat err =       0.000545403430
             autocorr =       1.357893948649
   target nu stat err =       0.000545403430
   target dn stat err =       0.003759272756
      target stat err =       0.003145759637
              std dev =       0.661911514733
             le_variance =       0.438126853336


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743171437853        initial
     1.0000e+00     1.0000e+01             2.7269e-04        -0.743108858779
     4.0000e+00     4.0000e+01             6.9480e-05        -0.742900170333
     1.6000e+01     1.6000e+02             1.7454e-05        -0.743185590052  <--

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.2711e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.323125e-01 3 1  ON 0
ci_02                -3.200622e-02 3 1  ON 1
ci_03                -3.169493e-02 3 1  ON 2
ci_04                 2.846384e-02 3 1  ON 3
ci_05                -2.382480e-02 3 1  ON 4
ci_06                -2.333773e-02 3 1  ON 5
ci_07                 2.704438e-02 3 1  ON 6
ci_08                -6.728114e-03 3 1  ON 7
ci_09                -9.548885e-03 3 1  ON 8
ci_10                -9.556456e-03 3 1  ON 9
ci_11                 1.314403e-02 3 1  ON 10
ci_12                 7.884851e-03 3 1  ON 11
ci_13                 1.274478e-02 3 1  ON 12
ci_14                 1.307264e-02 3 1  ON 13
ci_15                 7.274499e-03 3 1  ON 14
ci_16                 7.505367e-03 3 1  ON 15
ci_17                -7.828118e-03 3 1  ON 16
ci_18                -7.320737e-03 3 1  ON 17
ci_19                 9.391627e-03 3 1  ON 18
ci_20                 6.907332e-03 3 1  ON 19
ci_21                 8.814762e-03 3 1  ON 20
ci_22                 8.844703e-03 3 1  ON 21
ci_23                 4.969825e-03 3 1  ON 22
ci_24                 4.362049e-03 3 1  ON 23
ci_25                 3.194153e-03 3 1  ON 24
ci_26                 3.238928e-03 3 1  ON 25
ci_27                 3.317669e-03 3 1  ON 26
ci_28                 2.537145e-03 3 1  ON 27
ci_29                 2.130423e-03 3 1  ON 28
ci_30                -1.681024e-03 3 1  ON 29
ci_31                -1.670185e-03 3 1  ON 30
ci_32                -1.419538e-03 3 1  ON 31
ci_33                -1.075725e-03 3 1  ON 32
ci_34                 1.540570e-03 3 1  ON 33
ci_35                 1.258318e-03 3 1  ON 34
ci_36                -1.235060e-03 3 1  ON 35
ci_37                -1.193480e-03 3 1  ON 36
ci_38                -5.111705e-04 3 1  ON 37
ci_39                -6.848494e-04 3 1  ON 38
ci_40                -1.676296e-03 3 1  ON 39
ci_41                -1.496684e-03 3 1  ON 40
ci_42                -1.165855e-03 3 1  ON 41
ci_43                -2.961802e-03 3 1  ON 42
ci_44                -1.744730e-03 3 1  ON 43
ci_45                -7.150817e-04 3 1  ON 44
ci_46                -5.467658e-04 3 1  ON 45
ci_47                 1.169668e-03 3 1  ON 46
ci_48                 6.456684e-04 3 1  ON 47
ci_49                -9.364319e-04 3 1  ON 48
ci_50                -7.102446e-04 3 1  ON 49
ci_51                 4.416367e-04 3 1  ON 50
ci_52                 4.507922e-04 3 1  ON 51
ci_53                -6.053937e-04 3 1  ON 52
ci_54                -9.411115e-04 3 1  ON 53
ci_55                -6.843955e-04 3 1  ON 54
ci_56                 1.903462e-03 3 1  ON 55
ci_57                 1.697234e-03 3 1  ON 56
ci_58                -6.957857e-04 3 1  ON 57
ci_59                -1.020281e-03 3 1  ON 58
ci_60                 5.866285e-04 3 1  ON 59
ci_61                 6.649575e-04 3 1  ON 60
ci_62                -2.606753e-04 3 1  ON 61
ci_63                -6.135727e-04 3 1  ON 62
ci_64                -5.116926e-04 3 1  ON 63
ci_65                -2.655536e-04 3 1  ON 64
ci_66                -7.012559e-04 3 1  ON 65
ci_67                -5.616423e-04 3 1  ON 66
ci_68                -6.027266e-04 3 1  ON 67
ci_69                 5.769237e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3124e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6639
    reference variance = 0.655757
====================================================
  Execution time = 2.5892e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5339e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5034e-01
  Total weights = 1.964112813e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4901e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436328634035
                                         uncertainty =       0.002560426440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436328634035
                                         uncertainty =       0.002560426440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467046820
  error estimate for blocks of size 2^( 2) =       0.000492586797
  error estimate for blocks of size 2^( 3) =       0.000515144762
  error estimate for blocks of size 2^( 4) =       0.000533220872
  error estimate for blocks of size 2^( 5) =       0.000543747699
  error estimate for blocks of size 2^( 6) =       0.000548423689
  error estimate for blocks of size 2^( 7) =       0.000552751115

      target function =      -0.745062847637
              le_mean =     -22.814746089070
             les_mean =     520.962979573864
             stat err =       0.000544535844
             autocorr =       1.359352547860
   target nu stat err =       0.000544535844
   target dn stat err =       0.003508337742
      target stat err =       0.002960972591
              std dev =       0.660503947096
             le_variance =       0.436265464130


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281474608907e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745073659851       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745079176310       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745080063887       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745080271084       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745080351474       residual = 9.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745080381673       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745080395358       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745080392434       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745080393314       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745080393028       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 5.143524e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745073659851       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745075051594       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745075274659       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745075326517       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745075346550       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745075354043       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745075357424       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745075356692       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745075356908       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745075356836       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.292862e-05

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745073659851       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745074008585       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745074064425       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745074077393       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745074082397       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745074084266       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745074085109       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745074084926       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745074084980       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745074084962       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+01 is 3.236551e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123128 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0391e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.322996e-01 3 1  ON 0
ci_02                -3.199466e-02 3 1  ON 1
ci_03                -3.168462e-02 3 1  ON 2
ci_04                 2.845385e-02 3 1  ON 3
ci_05                -2.381238e-02 3 1  ON 4
ci_06                -2.333332e-02 3 1  ON 5
ci_07                 2.704011e-02 3 1  ON 6
ci_08                -6.725362e-03 3 1  ON 7
ci_09                -9.544456e-03 3 1  ON 8
ci_10                -9.556729e-03 3 1  ON 9
ci_11                 1.313990e-02 3 1  ON 10
ci_12                 7.883939e-03 3 1  ON 11
ci_13                 1.274672e-02 3 1  ON 12
ci_14                 1.307326e-02 3 1  ON 13
ci_15                 7.269717e-03 3 1  ON 14
ci_16                 7.505898e-03 3 1  ON 15
ci_17                -7.823791e-03 3 1  ON 16
ci_18                -7.317609e-03 3 1  ON 17
ci_19                 9.391323e-03 3 1  ON 18
ci_20                 6.904921e-03 3 1  ON 19
ci_21                 8.813731e-03 3 1  ON 20
ci_22                 8.850533e-03 3 1  ON 21
ci_23                 4.968638e-03 3 1  ON 22
ci_24                 4.365912e-03 3 1  ON 23
ci_25                 3.190763e-03 3 1  ON 24
ci_26                 3.237517e-03 3 1  ON 25
ci_27                 3.316836e-03 3 1  ON 26
ci_28                 2.534056e-03 3 1  ON 27
ci_29                 2.127791e-03 3 1  ON 28
ci_30                -1.679200e-03 3 1  ON 29
ci_31                -1.661957e-03 3 1  ON 30
ci_32                -1.420473e-03 3 1  ON 31
ci_33                -1.080052e-03 3 1  ON 32
ci_34                 1.542023e-03 3 1  ON 33
ci_35                 1.259176e-03 3 1  ON 34
ci_36                -1.234073e-03 3 1  ON 35
ci_37                -1.188617e-03 3 1  ON 36
ci_38                -5.073429e-04 3 1  ON 37
ci_39                -6.820079e-04 3 1  ON 38
ci_40                -1.673299e-03 3 1  ON 39
ci_41                -1.497272e-03 3 1  ON 40
ci_42                -1.167801e-03 3 1  ON 41
ci_43                -2.958020e-03 3 1  ON 42
ci_44                -1.745379e-03 3 1  ON 43
ci_45                -7.150120e-04 3 1  ON 44
ci_46                -5.466034e-04 3 1  ON 45
ci_47                 1.170683e-03 3 1  ON 46
ci_48                 6.487934e-04 3 1  ON 47
ci_49                -9.392823e-04 3 1  ON 48
ci_50                -7.094169e-04 3 1  ON 49
ci_51                 4.385532e-04 3 1  ON 50
ci_52                 4.498601e-04 3 1  ON 51
ci_53                -6.041252e-04 3 1  ON 52
ci_54                -9.442603e-04 3 1  ON 53
ci_55                -6.811648e-04 3 1  ON 54
ci_56                 1.904713e-03 3 1  ON 55
ci_57                 1.693406e-03 3 1  ON 56
ci_58                -6.988216e-04 3 1  ON 57
ci_59                -1.023217e-03 3 1  ON 58
ci_60                 5.806445e-04 3 1  ON 59
ci_61                 6.556163e-04 3 1  ON 60
ci_62                -2.610157e-04 3 1  ON 61
ci_63                -6.116831e-04 3 1  ON 62
ci_64                -5.115761e-04 3 1  ON 63
ci_65                -2.692448e-04 3 1  ON 64
ci_66                -7.019928e-04 3 1  ON 65
ci_67                -5.635195e-04 3 1  ON 66
ci_68                -6.049499e-04 3 1  ON 67
ci_69                 5.675967e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7522
    reference variance = 0.403802
====================================================
  Execution time = 2.5140e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5866e-01
  Total weights = 1.9644e+06
  Execution time = 3.4950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441161973400
                                         uncertainty =       0.004228650876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441161973400
                                         uncertainty =       0.004228650876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469606835
  error estimate for blocks of size 2^( 2) =       0.000494843795
  error estimate for blocks of size 2^( 3) =       0.000518436365
  error estimate for blocks of size 2^( 4) =       0.000536482712
  error estimate for blocks of size 2^( 5) =       0.000548528921
  error estimate for blocks of size 2^( 6) =       0.000556423259
  error estimate for blocks of size 2^( 7) =       0.000558563991

      target function =      -0.738225181675
              le_mean =     -22.814594420939
             les_mean =     520.964392554258
             stat err =       0.000549999721
             autocorr =       1.371690463251
   target nu stat err =       0.000549999721
   target dn stat err =       0.005600685178
      target stat err =       0.004582070664
              std dev =       0.664124355022
             le_variance =       0.441061158933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441148290791
                                         uncertainty =       0.004228867077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441148290791
                                         uncertainty =       0.004228867077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469599549
  error estimate for blocks of size 2^( 2) =       0.000494839112
  error estimate for blocks of size 2^( 3) =       0.000518434442
  error estimate for blocks of size 2^( 4) =       0.000536482637
  error estimate for blocks of size 2^( 5) =       0.000548530608
  error estimate for blocks of size 2^( 6) =       0.000556426797
  error estimate for blocks of size 2^( 7) =       0.000558566908

      target function =      -0.738163121911
              le_mean =     -22.814594102157
             les_mean =     520.964454454545
             stat err =       0.000550001738
             autocorr =       1.371743089227
   target nu stat err =       0.000550001738
   target dn stat err =       0.005608432519
      target stat err =       0.004587532674
              std dev =       0.664114050890
             le_variance =       0.441047472589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441155014352
                                         uncertainty =       0.004228754648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441155014352
                                         uncertainty =       0.004228754648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469603129
  error estimate for blocks of size 2^( 2) =       0.000494841404
  error estimate for blocks of size 2^( 3) =       0.000518435367
  error estimate for blocks of size 2^( 4) =       0.000536482641
  error estimate for blocks of size 2^( 5) =       0.000548529735
  error estimate for blocks of size 2^( 6) =       0.000556425028
  error estimate for blocks of size 2^( 7) =       0.000558565474

      target function =      -0.738231718948
              le_mean =     -22.814594254846
             les_mean =     520.964376872160
             stat err =       0.000550000720
             autocorr =       1.371717094420
   target nu stat err =       0.000550000720
   target dn stat err =       0.005604311035
      target stat err =       0.004585065245
              std dev =       0.664119114414
             le_variance =       0.441054198130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441161094836
                                         uncertainty =       0.004228663487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441161094836
                                         uncertainty =       0.004228663487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469606367
  error estimate for blocks of size 2^( 2) =       0.000494843492
  error estimate for blocks of size 2^( 3) =       0.000518436237
  error estimate for blocks of size 2^( 4) =       0.000536482699
  error estimate for blocks of size 2^( 5) =       0.000548529019
  error estimate for blocks of size 2^( 6) =       0.000556423476
  error estimate for blocks of size 2^( 7) =       0.000558564177

      target function =      -0.738229339450
              le_mean =     -22.814594399993
             les_mean =     520.964386466266
             stat err =       0.000549999843
             autocorr =       1.371693805137
   target nu stat err =       0.000549999843
   target dn stat err =       0.005601125528
      target stat err =       0.004582475735
              std dev =       0.664123693417
             le_variance =       0.441060280158


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738225181675        initial
     4.0000e+00     4.0000e+01             5.1435e-05        -0.738163121911
     1.6000e+01     1.6000e+02             1.2929e-05        -0.738231718948  <--
     6.4000e+01     6.4000e+02             3.2366e-06        -0.738229339450

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.2624e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.322996e-01 3 1  ON 0
ci_02                -3.199466e-02 3 1  ON 1
ci_03                -3.168462e-02 3 1  ON 2
ci_04                 2.845385e-02 3 1  ON 3
ci_05                -2.381238e-02 3 1  ON 4
ci_06                -2.333332e-02 3 1  ON 5
ci_07                 2.704011e-02 3 1  ON 6
ci_08                -6.725362e-03 3 1  ON 7
ci_09                -9.544456e-03 3 1  ON 8
ci_10                -9.556729e-03 3 1  ON 9
ci_11                 1.313990e-02 3 1  ON 10
ci_12                 7.883939e-03 3 1  ON 11
ci_13                 1.274672e-02 3 1  ON 12
ci_14                 1.307326e-02 3 1  ON 13
ci_15                 7.269717e-03 3 1  ON 14
ci_16                 7.505898e-03 3 1  ON 15
ci_17                -7.823791e-03 3 1  ON 16
ci_18                -7.317609e-03 3 1  ON 17
ci_19                 9.391323e-03 3 1  ON 18
ci_20                 6.904921e-03 3 1  ON 19
ci_21                 8.813731e-03 3 1  ON 20
ci_22                 8.850533e-03 3 1  ON 21
ci_23                 4.968638e-03 3 1  ON 22
ci_24                 4.365912e-03 3 1  ON 23
ci_25                 3.190763e-03 3 1  ON 24
ci_26                 3.237517e-03 3 1  ON 25
ci_27                 3.316836e-03 3 1  ON 26
ci_28                 2.534056e-03 3 1  ON 27
ci_29                 2.127791e-03 3 1  ON 28
ci_30                -1.679200e-03 3 1  ON 29
ci_31                -1.661957e-03 3 1  ON 30
ci_32                -1.420473e-03 3 1  ON 31
ci_33                -1.080052e-03 3 1  ON 32
ci_34                 1.542023e-03 3 1  ON 33
ci_35                 1.259176e-03 3 1  ON 34
ci_36                -1.234073e-03 3 1  ON 35
ci_37                -1.188617e-03 3 1  ON 36
ci_38                -5.073429e-04 3 1  ON 37
ci_39                -6.820079e-04 3 1  ON 38
ci_40                -1.673299e-03 3 1  ON 39
ci_41                -1.497272e-03 3 1  ON 40
ci_42                -1.167801e-03 3 1  ON 41
ci_43                -2.958020e-03 3 1  ON 42
ci_44                -1.745379e-03 3 1  ON 43
ci_45                -7.150120e-04 3 1  ON 44
ci_46                -5.466034e-04 3 1  ON 45
ci_47                 1.170683e-03 3 1  ON 46
ci_48                 6.487934e-04 3 1  ON 47
ci_49                -9.392823e-04 3 1  ON 48
ci_50                -7.094169e-04 3 1  ON 49
ci_51                 4.385532e-04 3 1  ON 50
ci_52                 4.498601e-04 3 1  ON 51
ci_53                -6.041252e-04 3 1  ON 52
ci_54                -9.442603e-04 3 1  ON 53
ci_55                -6.811648e-04 3 1  ON 54
ci_56                 1.904713e-03 3 1  ON 55
ci_57                 1.693406e-03 3 1  ON 56
ci_58                -6.988216e-04 3 1  ON 57
ci_59                -1.023217e-03 3 1  ON 58
ci_60                 5.806445e-04 3 1  ON 59
ci_61                 6.556163e-04 3 1  ON 60
ci_62                -2.610157e-04 3 1  ON 61
ci_63                -6.116831e-04 3 1  ON 62
ci_64                -5.115761e-04 3 1  ON 63
ci_65                -2.692448e-04 3 1  ON 64
ci_66                -7.019928e-04 3 1  ON 65
ci_67                -5.635195e-04 3 1  ON 66
ci_68                -6.049499e-04 3 1  ON 67
ci_69                 5.675967e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3041e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7761
    reference variance = 0.361168
====================================================
  Execution time = 2.5781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4522e-01
  Total weights = 1.964173357e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432892524976
                                         uncertainty =       0.001897755028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432892524976
                                         uncertainty =       0.001897755028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465255655
  error estimate for blocks of size 2^( 2) =       0.000490487142
  error estimate for blocks of size 2^( 3) =       0.000514367597
  error estimate for blocks of size 2^( 4) =       0.000531243695
  error estimate for blocks of size 2^( 5) =       0.000543144466
  error estimate for blocks of size 2^( 6) =       0.000548007635
  error estimate for blocks of size 2^( 7) =       0.000554657972

      target function =      -0.749321524106
              le_mean =     -22.815052014088
             les_mean =     520.971822552762
             stat err =       0.000544263442
             autocorr =       1.368469138711
   target nu stat err =       0.000544263442
   target dn stat err =       0.002633568764
      target stat err =       0.002284114313
              std dev =       0.657970856664
             le_variance =       0.432925648219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281505201409e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749327446819       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749333038702       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749333834462       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749333998246       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749334069257       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749334089822       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749334089019       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749334088362       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749334086989       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 6.871999e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749327446819       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749328857582       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749329057598       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749329098670       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749329116394       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749329121451       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749329121234       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749329121067       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749329120727       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.727109e-05

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749327446819       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749327800318       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749327850390       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749327860666       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749327865095       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749327866354       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749327866299       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749327866257       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749327866172       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+01 is 4.323508e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126199 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0269e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.322823e-01 3 1  ON 0
ci_02                -3.198297e-02 3 1  ON 1
ci_03                -3.167020e-02 3 1  ON 2
ci_04                 2.844640e-02 3 1  ON 3
ci_05                -2.379961e-02 3 1  ON 4
ci_06                -2.332869e-02 3 1  ON 5
ci_07                 2.703874e-02 3 1  ON 6
ci_08                -6.722176e-03 3 1  ON 7
ci_09                -9.538081e-03 3 1  ON 8
ci_10                -9.548280e-03 3 1  ON 9
ci_11                 1.313551e-02 3 1  ON 10
ci_12                 7.883508e-03 3 1  ON 11
ci_13                 1.274402e-02 3 1  ON 12
ci_14                 1.307234e-02 3 1  ON 13
ci_15                 7.269819e-03 3 1  ON 14
ci_16                 7.503225e-03 3 1  ON 15
ci_17                -7.818365e-03 3 1  ON 16
ci_18                -7.317854e-03 3 1  ON 17
ci_19                 9.390217e-03 3 1  ON 18
ci_20                 6.906082e-03 3 1  ON 19
ci_21                 8.811553e-03 3 1  ON 20
ci_22                 8.851946e-03 3 1  ON 21
ci_23                 4.969047e-03 3 1  ON 22
ci_24                 4.364757e-03 3 1  ON 23
ci_25                 3.188953e-03 3 1  ON 24
ci_26                 3.235785e-03 3 1  ON 25
ci_27                 3.317554e-03 3 1  ON 26
ci_28                 2.530512e-03 3 1  ON 27
ci_29                 2.127376e-03 3 1  ON 28
ci_30                -1.681500e-03 3 1  ON 29
ci_31                -1.660891e-03 3 1  ON 30
ci_32                -1.419355e-03 3 1  ON 31
ci_33                -1.080280e-03 3 1  ON 32
ci_34                 1.538255e-03 3 1  ON 33
ci_35                 1.260630e-03 3 1  ON 34
ci_36                -1.232091e-03 3 1  ON 35
ci_37                -1.188030e-03 3 1  ON 36
ci_38                -5.091286e-04 3 1  ON 37
ci_39                -6.846949e-04 3 1  ON 38
ci_40                -1.673678e-03 3 1  ON 39
ci_41                -1.495250e-03 3 1  ON 40
ci_42                -1.168014e-03 3 1  ON 41
ci_43                -2.951701e-03 3 1  ON 42
ci_44                -1.747983e-03 3 1  ON 43
ci_45                -7.159303e-04 3 1  ON 44
ci_46                -5.494691e-04 3 1  ON 45
ci_47                 1.171828e-03 3 1  ON 46
ci_48                 6.495839e-04 3 1  ON 47
ci_49                -9.397167e-04 3 1  ON 48
ci_50                -7.102096e-04 3 1  ON 49
ci_51                 4.365218e-04 3 1  ON 50
ci_52                 4.517836e-04 3 1  ON 51
ci_53                -6.047551e-04 3 1  ON 52
ci_54                -9.466330e-04 3 1  ON 53
ci_55                -6.867315e-04 3 1  ON 54
ci_56                 1.903971e-03 3 1  ON 55
ci_57                 1.693899e-03 3 1  ON 56
ci_58                -7.019733e-04 3 1  ON 57
ci_59                -1.021944e-03 3 1  ON 58
ci_60                 5.764112e-04 3 1  ON 59
ci_61                 6.570425e-04 3 1  ON 60
ci_62                -2.619233e-04 3 1  ON 61
ci_63                -6.073565e-04 3 1  ON 62
ci_64                -5.103263e-04 3 1  ON 63
ci_65                -2.713386e-04 3 1  ON 64
ci_66                -7.027880e-04 3 1  ON 65
ci_67                -5.642604e-04 3 1  ON 66
ci_68                -6.040638e-04 3 1  ON 67
ci_69                 5.244039e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8221
    reference variance = 0.315969
====================================================
  Execution time = 2.6975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5069e-01
  Total weights = 1.9639e+06
  Execution time = 3.4958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436538169827
                                         uncertainty =       0.003192654323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436538169827
                                         uncertainty =       0.003192654323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467135353
  error estimate for blocks of size 2^( 2) =       0.000492735957
  error estimate for blocks of size 2^( 3) =       0.000516095157
  error estimate for blocks of size 2^( 4) =       0.000533619068
  error estimate for blocks of size 2^( 5) =       0.000545400287
  error estimate for blocks of size 2^( 6) =       0.000548289324
  error estimate for blocks of size 2^( 7) =       0.000551259806

      target function =      -0.744761652524
              le_mean =     -22.814844210049
             les_mean =     520.967814898636
             stat err =       0.000544642121
             autocorr =       1.359367800003
   target nu stat err =       0.000544642121
   target dn stat err =       0.004264566195
      target stat err =       0.003572660696
              std dev =       0.660629151829
             le_variance =       0.436430876247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436516539253
                                         uncertainty =       0.003185142826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436516539253
                                         uncertainty =       0.003185142826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467123794
  error estimate for blocks of size 2^( 2) =       0.000492727674
  error estimate for blocks of size 2^( 3) =       0.000516090682
  error estimate for blocks of size 2^( 4) =       0.000533616756
  error estimate for blocks of size 2^( 5) =       0.000545399171
  error estimate for blocks of size 2^( 6) =       0.000548289594
  error estimate for blocks of size 2^( 7) =       0.000551262047

      target function =      -0.744777511146
              le_mean =     -22.814844322407
             les_mean =     520.967800866150
             stat err =       0.000544641892
             autocorr =       1.359433935182
   target nu stat err =       0.000544641892
   target dn stat err =       0.004259742102
      target stat err =       0.003568884980
              std dev =       0.660612804399
             le_variance =       0.436409277335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436527213700
                                         uncertainty =       0.003188863530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436527213700
                                         uncertainty =       0.003188863530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467129498
  error estimate for blocks of size 2^( 2) =       0.000492731756
  error estimate for blocks of size 2^( 3) =       0.000516092874
  error estimate for blocks of size 2^( 4) =       0.000533617876
  error estimate for blocks of size 2^( 5) =       0.000545399696
  error estimate for blocks of size 2^( 6) =       0.000548289437
  error estimate for blocks of size 2^( 7) =       0.000551260918

      target function =      -0.744759659669
              le_mean =     -22.814844257442
             les_mean =     520.967819506588
             stat err =       0.000544641982
             autocorr =       1.359401179675
   target nu stat err =       0.000544641982
   target dn stat err =       0.004261290306
      target stat err =       0.003569975998
              std dev =       0.660620871716
             le_variance =       0.436419936147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436536791285
                                         uncertainty =       0.003192178833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436536791285
                                         uncertainty =       0.003192178833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467134616
  error estimate for blocks of size 2^( 2) =       0.000492735428
  error estimate for blocks of size 2^( 3) =       0.000516094868
  error estimate for blocks of size 2^( 4) =       0.000533618915
  error estimate for blocks of size 2^( 5) =       0.000545400210
  error estimate for blocks of size 2^( 6) =       0.000548289334
  error estimate for blocks of size 2^( 7) =       0.000551259941

      target function =      -0.744763306089
              le_mean =     -22.814844215225
             les_mean =     520.967813137003
             stat err =       0.000544642100
             autocorr =       1.359371982628
   target nu stat err =       0.000544642100
   target dn stat err =       0.004264061721
      target stat err =       0.003572265785
              std dev =       0.660628109998
             le_variance =       0.436429499719


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744761652524        initial
     4.0000e+00     4.0000e+01             6.8720e-05        -0.744777511146  <--
     1.6000e+01     1.6000e+02             1.7271e-05        -0.744759659669
     6.4000e+01     6.4000e+02             4.3235e-06        -0.744763306089

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.4457e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.322308e-01 3 1  ON 0
ci_02                -3.194829e-02 3 1  ON 1
ci_03                -3.162742e-02 3 1  ON 2
ci_04                 2.842437e-02 3 1  ON 3
ci_05                -2.376176e-02 3 1  ON 4
ci_06                -2.331499e-02 3 1  ON 5
ci_07                 2.703467e-02 3 1  ON 6
ci_08                -6.712722e-03 3 1  ON 7
ci_09                -9.519138e-03 3 1  ON 8
ci_10                -9.523187e-03 3 1  ON 9
ci_11                 1.312245e-02 3 1  ON 10
ci_12                 7.882230e-03 3 1  ON 11
ci_13                 1.273597e-02 3 1  ON 12
ci_14                 1.306962e-02 3 1  ON 13
ci_15                 7.270126e-03 3 1  ON 14
ci_16                 7.495304e-03 3 1  ON 15
ci_17                -7.802250e-03 3 1  ON 16
ci_18                -7.318575e-03 3 1  ON 17
ci_19                 9.386942e-03 3 1  ON 18
ci_20                 6.909527e-03 3 1  ON 19
ci_21                 8.805072e-03 3 1  ON 20
ci_22                 8.856149e-03 3 1  ON 21
ci_23                 4.970260e-03 3 1  ON 22
ci_24                 4.361324e-03 3 1  ON 23
ci_25                 3.183597e-03 3 1  ON 24
ci_26                 3.230658e-03 3 1  ON 25
ci_27                 3.319692e-03 3 1  ON 26
ci_28                 2.519988e-03 3 1  ON 27
ci_29                 2.126138e-03 3 1  ON 28
ci_30                -1.688354e-03 3 1  ON 29
ci_31                -1.657731e-03 3 1  ON 30
ci_32                -1.416049e-03 3 1  ON 31
ci_33                -1.080962e-03 3 1  ON 32
ci_34                 1.527088e-03 3 1  ON 33
ci_35                 1.264945e-03 3 1  ON 34
ci_36                -1.226217e-03 3 1  ON 35
ci_37                -1.186288e-03 3 1  ON 36
ci_38                -5.144168e-04 3 1  ON 37
ci_39                -6.926477e-04 3 1  ON 38
ci_40                -1.674799e-03 3 1  ON 39
ci_41                -1.489264e-03 3 1  ON 40
ci_42                -1.168650e-03 3 1  ON 41
ci_43                -2.932935e-03 3 1  ON 42
ci_44                -1.755706e-03 3 1  ON 43
ci_45                -7.186437e-04 3 1  ON 44
ci_46                -5.579523e-04 3 1  ON 45
ci_47                 1.175229e-03 3 1  ON 46
ci_48                 6.519359e-04 3 1  ON 47
ci_49                -9.410016e-04 3 1  ON 48
ci_50                -7.125538e-04 3 1  ON 49
ci_51                 4.305050e-04 3 1  ON 50
ci_52                 4.574782e-04 3 1  ON 51
ci_53                -6.066177e-04 3 1  ON 52
ci_54                -9.536616e-04 3 1  ON 53
ci_55                -7.032385e-04 3 1  ON 54
ci_56                 1.901774e-03 3 1  ON 55
ci_57                 1.695363e-03 3 1  ON 56
ci_58                -7.113109e-04 3 1  ON 57
ci_59                -1.018174e-03 3 1  ON 58
ci_60                 5.637596e-04 3 1  ON 59
ci_61                 6.612898e-04 3 1  ON 60
ci_62                -2.646051e-04 3 1  ON 61
ci_63                -5.945468e-04 3 1  ON 62
ci_64                -5.066183e-04 3 1  ON 63
ci_65                -2.775417e-04 3 1  ON 64
ci_66                -7.051374e-04 3 1  ON 65
ci_67                -5.664541e-04 3 1  ON 66
ci_68                -6.014351e-04 3 1  ON 67
ci_69                 3.962362e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4733e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.906
    reference variance = 0.309152
====================================================
  Execution time = 2.5838e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5083e-01
  Total weights = 1.963910168e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5217e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438136279921
                                         uncertainty =       0.002518968309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438136279921
                                         uncertainty =       0.002518968309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468032613
  error estimate for blocks of size 2^( 2) =       0.000492867156
  error estimate for blocks of size 2^( 3) =       0.000517155617
  error estimate for blocks of size 2^( 4) =       0.000534003690
  error estimate for blocks of size 2^( 5) =       0.000546454246
  error estimate for blocks of size 2^( 6) =       0.000552322149
  error estimate for blocks of size 2^( 7) =       0.000555252757

      target function =      -0.744661680232
              le_mean =     -22.813903434473
             les_mean =     520.925017910588
             stat err =       0.000547008210
             autocorr =       1.365952059030
   target nu stat err =       0.000547008210
   target dn stat err =       0.003082670544
      target stat err =       0.002612247814
              std dev =       0.661898069265
             le_variance =       0.438109054097


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281390343447e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744669871999       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744690070117       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744694230550       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744694969896       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744695418370       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744695539411       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744695551554       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744695553175       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744695558589       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744695562184       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.292578e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744669871999       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744675104323       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744676166032       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744676350535       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744676462082       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744676491272       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744676494028       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744676494379       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744676495686       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744676496540       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 8.396005e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744669871999       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744671192026       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744671458824       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744671504918       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744671532763       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744671539990       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744671540662       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744671540746       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744671541070       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744671541281       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 2.109566e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129734 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0369e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.321469e-01 3 1  ON 0
ci_02                -3.191069e-02 3 1  ON 1
ci_03                -3.156799e-02 3 1  ON 2
ci_04                 2.838882e-02 3 1  ON 3
ci_05                -2.372258e-02 3 1  ON 4
ci_06                -2.330782e-02 3 1  ON 5
ci_07                 2.702027e-02 3 1  ON 6
ci_08                -6.694028e-03 3 1  ON 7
ci_09                -9.519020e-03 3 1  ON 8
ci_10                -9.527864e-03 3 1  ON 9
ci_11                 1.312077e-02 3 1  ON 10
ci_12                 7.870256e-03 3 1  ON 11
ci_13                 1.270968e-02 3 1  ON 12
ci_14                 1.305004e-02 3 1  ON 13
ci_15                 7.244884e-03 3 1  ON 14
ci_16                 7.481749e-03 3 1  ON 15
ci_17                -7.781088e-03 3 1  ON 16
ci_18                -7.311059e-03 3 1  ON 17
ci_19                 9.387873e-03 3 1  ON 18
ci_20                 6.906128e-03 3 1  ON 19
ci_21                 8.800492e-03 3 1  ON 20
ci_22                 8.856895e-03 3 1  ON 21
ci_23                 4.976382e-03 3 1  ON 22
ci_24                 4.355112e-03 3 1  ON 23
ci_25                 3.162248e-03 3 1  ON 24
ci_26                 3.226832e-03 3 1  ON 25
ci_27                 3.296872e-03 3 1  ON 26
ci_28                 2.510558e-03 3 1  ON 27
ci_29                 2.137245e-03 3 1  ON 28
ci_30                -1.701157e-03 3 1  ON 29
ci_31                -1.641516e-03 3 1  ON 30
ci_32                -1.410172e-03 3 1  ON 31
ci_33                -1.089675e-03 3 1  ON 32
ci_34                 1.539815e-03 3 1  ON 33
ci_35                 1.269533e-03 3 1  ON 34
ci_36                -1.217213e-03 3 1  ON 35
ci_37                -1.183921e-03 3 1  ON 36
ci_38                -5.117265e-04 3 1  ON 37
ci_39                -6.887833e-04 3 1  ON 38
ci_40                -1.665641e-03 3 1  ON 39
ci_41                -1.490927e-03 3 1  ON 40
ci_42                -1.163902e-03 3 1  ON 41
ci_43                -2.920513e-03 3 1  ON 42
ci_44                -1.766503e-03 3 1  ON 43
ci_45                -7.130219e-04 3 1  ON 44
ci_46                -5.489651e-04 3 1  ON 45
ci_47                 1.188115e-03 3 1  ON 46
ci_48                 6.678717e-04 3 1  ON 47
ci_49                -9.405223e-04 3 1  ON 48
ci_50                -7.118590e-04 3 1  ON 49
ci_51                 4.228530e-04 3 1  ON 50
ci_52                 4.516368e-04 3 1  ON 51
ci_53                -6.084404e-04 3 1  ON 52
ci_54                -9.506797e-04 3 1  ON 53
ci_55                -7.140139e-04 3 1  ON 54
ci_56                 1.903320e-03 3 1  ON 55
ci_57                 1.693897e-03 3 1  ON 56
ci_58                -7.091932e-04 3 1  ON 57
ci_59                -1.007072e-03 3 1  ON 58
ci_60                 5.849009e-04 3 1  ON 59
ci_61                 6.421657e-04 3 1  ON 60
ci_62                -2.662089e-04 3 1  ON 61
ci_63                -5.768424e-04 3 1  ON 62
ci_64                -5.062233e-04 3 1  ON 63
ci_65                -2.811906e-04 3 1  ON 64
ci_66                -6.971983e-04 3 1  ON 65
ci_67                -5.694994e-04 3 1  ON 66
ci_68                -5.989585e-04 3 1  ON 67
ci_69                 2.503425e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8932
    reference variance = 0.409697
====================================================
  Execution time = 2.5142e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4386e-01
  Total weights = 1.9641e+06
  Execution time = 3.4844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432568908882
                                         uncertainty =       0.001893932848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432568908882
                                         uncertainty =       0.001893932848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465079859
  error estimate for blocks of size 2^( 2) =       0.000490149082
  error estimate for blocks of size 2^( 3) =       0.000513704484
  error estimate for blocks of size 2^( 4) =       0.000531518369
  error estimate for blocks of size 2^( 5) =       0.000542144591
  error estimate for blocks of size 2^( 6) =       0.000549849083
  error estimate for blocks of size 2^( 7) =       0.000552172862

      target function =      -0.750456833515
              le_mean =     -22.814897010422
             les_mean =     520.963393396443
             stat err =       0.000543921226
             autocorr =       1.367782211334
   target nu stat err =       0.000543921226
   target dn stat err =       0.002411106406
      target stat err =       0.002110909908
              std dev =       0.657722243609
             le_variance =       0.432598549738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432530768829
                                         uncertainty =       0.001899911258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432530768829
                                         uncertainty =       0.001899911258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465059460
  error estimate for blocks of size 2^( 2) =       0.000490139501
  error estimate for blocks of size 2^( 3) =       0.000513707003
  error estimate for blocks of size 2^( 4) =       0.000531528716
  error estimate for blocks of size 2^( 5) =       0.000542156329
  error estimate for blocks of size 2^( 6) =       0.000549865707
  error estimate for blocks of size 2^( 7) =       0.000552193915

      target function =      -0.749097993030
              le_mean =     -22.814896284739
             les_mean =     520.964981221239
             stat err =       0.000543936167
             autocorr =       1.367977350109
   target nu stat err =       0.000543936167
   target dn stat err =       0.002874139634
      target stat err =       0.002476497311
              std dev =       0.657693395661
             le_variance =       0.432560602696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432548214055
                                         uncertainty =       0.001896950002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432548214055
                                         uncertainty =       0.001896950002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465068787
  error estimate for blocks of size 2^( 2) =       0.000490143834
  error estimate for blocks of size 2^( 3) =       0.000513705458
  error estimate for blocks of size 2^( 4) =       0.000531523634
  error estimate for blocks of size 2^( 5) =       0.000542151754
  error estimate for blocks of size 2^( 6) =       0.000549858969
  error estimate for blocks of size 2^( 7) =       0.000552184884

      target function =      -0.750437700057
              le_mean =     -22.814896357025
             les_mean =     520.963386348485
             stat err =       0.000543929810
             autocorr =       1.367890506565
   target nu stat err =       0.000543929810
   target dn stat err =       0.002419498990
      target stat err =       0.002117546877
              std dev =       0.657706586665
             le_variance =       0.432577954143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432566200860
                                         uncertainty =       0.001894306565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432566200860
                                         uncertainty =       0.001894306565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465078410
  error estimate for blocks of size 2^( 2) =       0.000490148365
  error estimate for blocks of size 2^( 3) =       0.000513704549
  error estimate for blocks of size 2^( 4) =       0.000531518968
  error estimate for blocks of size 2^( 5) =       0.000542145421
  error estimate for blocks of size 2^( 6) =       0.000549850252
  error estimate for blocks of size 2^( 7) =       0.000552174297

      target function =      -0.750461928726
              le_mean =     -22.814896917936
             les_mean =     520.963383093098
             stat err =       0.000543922235
             autocorr =       1.367795804507
   target nu stat err =       0.000543922235
   target dn stat err =       0.002411974035
      target stat err =       0.002111634103
              std dev =       0.657720194473
             le_variance =       0.432595854217


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750456833515        initial
     1.0000e+00     1.0000e+01             3.2926e-04        -0.749097993030
     4.0000e+00     4.0000e+01             8.3960e-05        -0.750437700057
     1.6000e+01     1.6000e+02             2.1096e-05        -0.750461928726  <--

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.2585e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.322097e-01 3 1  ON 0
ci_02                -3.193881e-02 3 1  ON 1
ci_03                -3.161244e-02 3 1  ON 2
ci_04                 2.841540e-02 3 1  ON 3
ci_05                -2.375188e-02 3 1  ON 4
ci_06                -2.331318e-02 3 1  ON 5
ci_07                 2.703104e-02 3 1  ON 6
ci_08                -6.708007e-03 3 1  ON 7
ci_09                -9.519107e-03 3 1  ON 8
ci_10                -9.524365e-03 3 1  ON 9
ci_11                 1.312202e-02 3 1  ON 10
ci_12                 7.879208e-03 3 1  ON 11
ci_13                 1.272936e-02 3 1  ON 12
ci_14                 1.306470e-02 3 1  ON 13
ci_15                 7.263763e-03 3 1  ON 14
ci_16                 7.491889e-03 3 1  ON 15
ci_17                -7.796919e-03 3 1  ON 16
ci_18                -7.316681e-03 3 1  ON 17
ci_19                 9.387176e-03 3 1  ON 18
ci_20                 6.908671e-03 3 1  ON 19
ci_21                 8.803924e-03 3 1  ON 20
ci_22                 8.856341e-03 3 1  ON 21
ci_23                 4.971804e-03 3 1  ON 22
ci_24                 4.359758e-03 3 1  ON 23
ci_25                 3.178211e-03 3 1  ON 24
ci_26                 3.229694e-03 3 1  ON 25
ci_27                 3.313941e-03 3 1  ON 26
ci_28                 2.517615e-03 3 1  ON 27
ci_29                 2.128940e-03 3 1  ON 28
ci_30                -1.691572e-03 3 1  ON 29
ci_31                -1.653652e-03 3 1  ON 30
ci_32                -1.414565e-03 3 1  ON 31
ci_33                -1.083160e-03 3 1  ON 32
ci_34                 1.530293e-03 3 1  ON 33
ci_35                 1.266098e-03 3 1  ON 34
ci_36                -1.223944e-03 3 1  ON 35
ci_37                -1.185691e-03 3 1  ON 36
ci_38                -5.137371e-04 3 1  ON 37
ci_39                -6.916732e-04 3 1  ON 38
ci_40                -1.672487e-03 3 1  ON 39
ci_41                -1.489683e-03 3 1  ON 40
ci_42                -1.167451e-03 3 1  ON 41
ci_43                -2.929807e-03 3 1  ON 42
ci_44                -1.758427e-03 3 1  ON 43
ci_45                -7.172251e-04 3 1  ON 44
ci_46                -5.556838e-04 3 1  ON 45
ci_47                 1.178468e-03 3 1  ON 46
ci_48                 6.559465e-04 3 1  ON 47
ci_49                -9.408829e-04 3 1  ON 48
ci_50                -7.123788e-04 3 1  ON 49
ci_51                 4.285742e-04 3 1  ON 50
ci_52                 4.560047e-04 3 1  ON 51
ci_53                -6.070778e-04 3 1  ON 52
ci_54                -9.529114e-04 3 1  ON 53
ci_55                -7.059553e-04 3 1  ON 54
ci_56                 1.902165e-03 3 1  ON 55
ci_57                 1.694993e-03 3 1  ON 56
ci_58                -7.107751e-04 3 1  ON 57
ci_59                -1.015374e-03 3 1  ON 58
ci_60                 5.690675e-04 3 1  ON 59
ci_61                 6.564898e-04 3 1  ON 60
ci_62                -2.650112e-04 3 1  ON 61
ci_63                -5.900756e-04 3 1  ON 62
ci_64                -5.065165e-04 3 1  ON 63
ci_65                -2.784640e-04 3 1  ON 64
ci_66                -7.031356e-04 3 1  ON 65
ci_67                -5.672229e-04 3 1  ON 66
ci_68                -6.008121e-04 3 1  ON 67
ci_69                 3.594638e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2960e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8457
    reference variance = 0.394342
====================================================
  Execution time = 2.5874e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4651e-01
  Total weights = 1.964015041e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435628312506
                                         uncertainty =       0.002345051250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435628312506
                                         uncertainty =       0.002345051250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466714779
  error estimate for blocks of size 2^( 2) =       0.000492097467
  error estimate for blocks of size 2^( 3) =       0.000515783163
  error estimate for blocks of size 2^( 4) =       0.000532413806
  error estimate for blocks of size 2^( 5) =       0.000543949429
  error estimate for blocks of size 2^( 6) =       0.000550457281
  error estimate for blocks of size 2^( 7) =       0.000556191613

      target function =      -0.748243798247
              le_mean =     -22.814573505437
             les_mean =     520.951276252209
             stat err =       0.000545753032
             autocorr =       1.367379952698
   target nu stat err =       0.000545753032
   target dn stat err =       0.002549921665
      target stat err =       0.002209520370
              std dev =       0.660034369742
             le_variance =       0.435645369241


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281457350544e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748249354610       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748255059570       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748256113422       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748256303447       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748256383264       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748256416990       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748256419936       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748256419134       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748256420194       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748256419187       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 6.822706e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748249354610       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748250794217       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748251059163       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748251106796       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748251126677       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748251135007       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748251135724       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748251135521       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748251135783       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748251135533       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.714741e-05

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748249354610       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748249715357       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748249781687       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748249793603       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748249798568       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748249800644       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748249800822       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748249800772       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748249800837       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748249800775       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+01 is 4.292558e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0383e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.321926e-01 3 1  ON 0
ci_02                -3.192930e-02 3 1  ON 1
ci_03                -3.160313e-02 3 1  ON 2
ci_04                 2.840783e-02 3 1  ON 3
ci_05                -2.374150e-02 3 1  ON 4
ci_06                -2.330204e-02 3 1  ON 5
ci_07                 2.703146e-02 3 1  ON 6
ci_08                -6.701017e-03 3 1  ON 7
ci_09                -9.516514e-03 3 1  ON 8
ci_10                -9.524579e-03 3 1  ON 9
ci_11                 1.312185e-02 3 1  ON 10
ci_12                 7.876173e-03 3 1  ON 11
ci_13                 1.272559e-02 3 1  ON 12
ci_14                 1.307046e-02 3 1  ON 13
ci_15                 7.261869e-03 3 1  ON 14
ci_16                 7.483422e-03 3 1  ON 15
ci_17                -7.796192e-03 3 1  ON 16
ci_18                -7.313746e-03 3 1  ON 17
ci_19                 9.387197e-03 3 1  ON 18
ci_20                 6.911445e-03 3 1  ON 19
ci_21                 8.802794e-03 3 1  ON 20
ci_22                 8.854925e-03 3 1  ON 21
ci_23                 4.970432e-03 3 1  ON 22
ci_24                 4.353666e-03 3 1  ON 23
ci_25                 3.176556e-03 3 1  ON 24
ci_26                 3.228711e-03 3 1  ON 25
ci_27                 3.315852e-03 3 1  ON 26
ci_28                 2.516672e-03 3 1  ON 27
ci_29                 2.128125e-03 3 1  ON 28
ci_30                -1.689089e-03 3 1  ON 29
ci_31                -1.652942e-03 3 1  ON 30
ci_32                -1.412861e-03 3 1  ON 31
ci_33                -1.082204e-03 3 1  ON 32
ci_34                 1.523240e-03 3 1  ON 33
ci_35                 1.268718e-03 3 1  ON 34
ci_36                -1.222787e-03 3 1  ON 35
ci_37                -1.185972e-03 3 1  ON 36
ci_38                -5.154014e-04 3 1  ON 37
ci_39                -6.907732e-04 3 1  ON 38
ci_40                -1.673264e-03 3 1  ON 39
ci_41                -1.489843e-03 3 1  ON 40
ci_42                -1.166468e-03 3 1  ON 41
ci_43                -2.926014e-03 3 1  ON 42
ci_44                -1.755722e-03 3 1  ON 43
ci_45                -7.182888e-04 3 1  ON 44
ci_46                -5.518378e-04 3 1  ON 45
ci_47                 1.174167e-03 3 1  ON 46
ci_48                 6.592995e-04 3 1  ON 47
ci_49                -9.370461e-04 3 1  ON 48
ci_50                -7.116224e-04 3 1  ON 49
ci_51                 4.275234e-04 3 1  ON 50
ci_52                 4.559848e-04 3 1  ON 51
ci_53                -6.097915e-04 3 1  ON 52
ci_54                -9.530207e-04 3 1  ON 53
ci_55                -7.073540e-04 3 1  ON 54
ci_56                 1.903612e-03 3 1  ON 55
ci_57                 1.693990e-03 3 1  ON 56
ci_58                -7.097697e-04 3 1  ON 57
ci_59                -1.014351e-03 3 1  ON 58
ci_60                 5.695681e-04 3 1  ON 59
ci_61                 6.508378e-04 3 1  ON 60
ci_62                -2.614710e-04 3 1  ON 61
ci_63                -5.882799e-04 3 1  ON 62
ci_64                -5.076532e-04 3 1  ON 63
ci_65                -2.813159e-04 3 1  ON 64
ci_66                -7.034817e-04 3 1  ON 65
ci_67                -5.650756e-04 3 1  ON 66
ci_68                -6.068791e-04 3 1  ON 67
ci_69                 3.489508e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8716
    reference variance = 0.300873
====================================================
  Execution time = 2.5269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4664e-01
  Total weights = 1.9644e+06
  Execution time = 3.4911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433809686690
                                         uncertainty =       0.001977701544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433809686690
                                         uncertainty =       0.001977701544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465731139
  error estimate for blocks of size 2^( 2) =       0.000490617483
  error estimate for blocks of size 2^( 3) =       0.000513744077
  error estimate for blocks of size 2^( 4) =       0.000530573729
  error estimate for blocks of size 2^( 5) =       0.000540013934
  error estimate for blocks of size 2^( 6) =       0.000545396760
  error estimate for blocks of size 2^( 7) =       0.000550864689

      target function =      -0.748151512813
              le_mean =     -22.814686090014
             les_mean =     520.956523879017
             stat err =       0.000541712278
             autocorr =       1.352903452848
   target nu stat err =       0.000541712278
   target dn stat err =       0.002754497526
      target stat err =       0.002372528933
              std dev =       0.658643293639
             le_variance =       0.433810988256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433797878295
                                         uncertainty =       0.001977992633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433797878295
                                         uncertainty =       0.001977992633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465724818
  error estimate for blocks of size 2^( 2) =       0.000490614285
  error estimate for blocks of size 2^( 3) =       0.000513743591
  error estimate for blocks of size 2^( 4) =       0.000530574973
  error estimate for blocks of size 2^( 5) =       0.000540015900
  error estimate for blocks of size 2^( 6) =       0.000545398950
  error estimate for blocks of size 2^( 7) =       0.000550866847

      target function =      -0.748069142149
              le_mean =     -22.814685643102
             les_mean =     520.956602241619
             stat err =       0.000541714168
             autocorr =       1.352949618710
   target nu stat err =       0.000541714168
   target dn stat err =       0.002776570824
      target stat err =       0.002389806785
              std dev =       0.658634354082
             le_variance =       0.433799212377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433803667628
                                         uncertainty =       0.001977844342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433803667628
                                         uncertainty =       0.001977844342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465727917
  error estimate for blocks of size 2^( 2) =       0.000490615837
  error estimate for blocks of size 2^( 3) =       0.000513743797
  error estimate for blocks of size 2^( 4) =       0.000530574322
  error estimate for blocks of size 2^( 5) =       0.000540014890
  error estimate for blocks of size 2^( 6) =       0.000545397828
  error estimate for blocks of size 2^( 7) =       0.000550865734

      target function =      -0.748113728085
              le_mean =     -22.814685860060
             les_mean =     520.956558680886
             stat err =       0.000541713194
             autocorr =       1.352926747784
   target nu stat err =       0.000541713194
   target dn stat err =       0.002765138949
      target stat err =       0.002380870179
              std dev =       0.658638736835
             le_variance =       0.433804985660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433808925271
                                         uncertainty =       0.001977719012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433808925271
                                         uncertainty =       0.001977719012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465730732
  error estimate for blocks of size 2^( 2) =       0.000490617273
  error estimate for blocks of size 2^( 3) =       0.000513744038
  error estimate for blocks of size 2^( 4) =       0.000530573800
  error estimate for blocks of size 2^( 5) =       0.000540014049
  error estimate for blocks of size 2^( 6) =       0.000545396889
  error estimate for blocks of size 2^( 7) =       0.000550864815

      target function =      -0.748147245456
              le_mean =     -22.814686060663
             les_mean =     520.956527654513
             stat err =       0.000541712388
             autocorr =       1.352906372862
   target nu stat err =       0.000541712388
   target dn stat err =       0.002755778950
      target stat err =       0.002373535084
              std dev =       0.658642717189
             le_variance =       0.433810228906


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748151512813        initial  <--
     4.0000e+00     4.0000e+01             6.8227e-05        -0.748069142149
     1.6000e+01     1.6000e+02             1.7147e-05        -0.748113728085
     6.4000e+01     6.4000e+02             4.2926e-06        -0.748147245456

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7418
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.322097e-01 3 1  ON 0
ci_02                -3.193881e-02 3 1  ON 1
ci_03                -3.161244e-02 3 1  ON 2
ci_04                 2.841540e-02 3 1  ON 3
ci_05                -2.375188e-02 3 1  ON 4
ci_06                -2.331318e-02 3 1  ON 5
ci_07                 2.703104e-02 3 1  ON 6
ci_08                -6.708007e-03 3 1  ON 7
ci_09                -9.519107e-03 3 1  ON 8
ci_10                -9.524365e-03 3 1  ON 9
ci_11                 1.312202e-02 3 1  ON 10
ci_12                 7.879208e-03 3 1  ON 11
ci_13                 1.272936e-02 3 1  ON 12
ci_14                 1.306470e-02 3 1  ON 13
ci_15                 7.263763e-03 3 1  ON 14
ci_16                 7.491889e-03 3 1  ON 15
ci_17                -7.796919e-03 3 1  ON 16
ci_18                -7.316681e-03 3 1  ON 17
ci_19                 9.387176e-03 3 1  ON 18
ci_20                 6.908671e-03 3 1  ON 19
ci_21                 8.803924e-03 3 1  ON 20
ci_22                 8.856341e-03 3 1  ON 21
ci_23                 4.971804e-03 3 1  ON 22
ci_24                 4.359758e-03 3 1  ON 23
ci_25                 3.178211e-03 3 1  ON 24
ci_26                 3.229694e-03 3 1  ON 25
ci_27                 3.313941e-03 3 1  ON 26
ci_28                 2.517615e-03 3 1  ON 27
ci_29                 2.128940e-03 3 1  ON 28
ci_30                -1.691572e-03 3 1  ON 29
ci_31                -1.653652e-03 3 1  ON 30
ci_32                -1.414565e-03 3 1  ON 31
ci_33                -1.083160e-03 3 1  ON 32
ci_34                 1.530293e-03 3 1  ON 33
ci_35                 1.266098e-03 3 1  ON 34
ci_36                -1.223944e-03 3 1  ON 35
ci_37                -1.185691e-03 3 1  ON 36
ci_38                -5.137371e-04 3 1  ON 37
ci_39                -6.916732e-04 3 1  ON 38
ci_40                -1.672487e-03 3 1  ON 39
ci_41                -1.489683e-03 3 1  ON 40
ci_42                -1.167451e-03 3 1  ON 41
ci_43                -2.929807e-03 3 1  ON 42
ci_44                -1.758427e-03 3 1  ON 43
ci_45                -7.172251e-04 3 1  ON 44
ci_46                -5.556838e-04 3 1  ON 45
ci_47                 1.178468e-03 3 1  ON 46
ci_48                 6.559465e-04 3 1  ON 47
ci_49                -9.408829e-04 3 1  ON 48
ci_50                -7.123788e-04 3 1  ON 49
ci_51                 4.285742e-04 3 1  ON 50
ci_52                 4.560047e-04 3 1  ON 51
ci_53                -6.070778e-04 3 1  ON 52
ci_54                -9.529114e-04 3 1  ON 53
ci_55                -7.059553e-04 3 1  ON 54
ci_56                 1.902165e-03 3 1  ON 55
ci_57                 1.694993e-03 3 1  ON 56
ci_58                -7.107751e-04 3 1  ON 57
ci_59                -1.015374e-03 3 1  ON 58
ci_60                 5.690675e-04 3 1  ON 59
ci_61                 6.564898e-04 3 1  ON 60
ci_62                -2.650112e-04 3 1  ON 61
ci_63                -5.900756e-04 3 1  ON 62
ci_64                -5.065165e-04 3 1  ON 63
ci_65                -2.784640e-04 3 1  ON 64
ci_66                -7.031356e-04 3 1  ON 65
ci_67                -5.672229e-04 3 1  ON 66
ci_68                -6.008121e-04 3 1  ON 67
ci_69                 3.594638e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3131e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8161
    reference variance = 0.36028
====================================================
  Execution time = 2.5794e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5360e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5049e-01
  Total weights = 1.964140395e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435642812475
                                         uncertainty =       0.002325815283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435642812475
                                         uncertainty =       0.002325815283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466714266
  error estimate for blocks of size 2^( 2) =       0.000491944712
  error estimate for blocks of size 2^( 3) =       0.000515502292
  error estimate for blocks of size 2^( 4) =       0.000532736688
  error estimate for blocks of size 2^( 5) =       0.000543745967
  error estimate for blocks of size 2^( 6) =       0.000550374879
  error estimate for blocks of size 2^( 7) =       0.000551304397

      target function =      -0.744940372265
              le_mean =     -22.815015736217
             les_mean =     520.975430815345
             stat err =       0.000544540483
             autocorr =       1.361313628553
   target nu stat err =       0.000544540483
   target dn stat err =       0.003666907370
      target stat err =       0.003089600736
              std dev =       0.660033644197
             le_variance =       0.435644411471


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281501573622e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744952211114       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744952937075       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744953068383       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744953091424       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744953098777       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744953098283       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744953099377       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744953099611       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744953099656       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744953099701       residual = 2.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 7.983955e-06

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744952211114       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744952392774       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744952425618       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744952431379       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744952433216       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744952433091       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744952433365       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744952433423       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744952433435       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744952433446       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+02 is 1.997015e-06

solving harmonic davidson linear method for identity shift 6.4000e+02, overlap shift 6.4000e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744952211114       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744952256539       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744952264752       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744952266192       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744952266651       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744952266620       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744952266689       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744952266702       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744952266704       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744952266709       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+02 is 4.993179e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136737 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0316e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.322077e-01 3 1  ON 0
ci_02                -3.193759e-02 3 1  ON 1
ci_03                -3.161162e-02 3 1  ON 2
ci_04                 2.841460e-02 3 1  ON 3
ci_05                -2.375079e-02 3 1  ON 4
ci_06                -2.331232e-02 3 1  ON 5
ci_07                 2.703033e-02 3 1  ON 6
ci_08                -6.707516e-03 3 1  ON 7
ci_09                -9.518539e-03 3 1  ON 8
ci_10                -9.525226e-03 3 1  ON 9
ci_11                 1.312180e-02 3 1  ON 10
ci_12                 7.878811e-03 3 1  ON 11
ci_13                 1.272981e-02 3 1  ON 12
ci_14                 1.306474e-02 3 1  ON 13
ci_15                 7.263292e-03 3 1  ON 14
ci_16                 7.491490e-03 3 1  ON 15
ci_17                -7.796772e-03 3 1  ON 16
ci_18                -7.316237e-03 3 1  ON 17
ci_19                 9.386999e-03 3 1  ON 18
ci_20                 6.908831e-03 3 1  ON 19
ci_21                 8.803583e-03 3 1  ON 20
ci_22                 8.856469e-03 3 1  ON 21
ci_23                 4.971664e-03 3 1  ON 22
ci_24                 4.360029e-03 3 1  ON 23
ci_25                 3.177902e-03 3 1  ON 24
ci_26                 3.229835e-03 3 1  ON 25
ci_27                 3.314369e-03 3 1  ON 26
ci_28                 2.517782e-03 3 1  ON 27
ci_29                 2.128752e-03 3 1  ON 28
ci_30                -1.690954e-03 3 1  ON 29
ci_31                -1.654238e-03 3 1  ON 30
ci_32                -1.414323e-03 3 1  ON 31
ci_33                -1.083379e-03 3 1  ON 32
ci_34                 1.530003e-03 3 1  ON 33
ci_35                 1.266503e-03 3 1  ON 34
ci_36                -1.223510e-03 3 1  ON 35
ci_37                -1.185732e-03 3 1  ON 36
ci_38                -5.144773e-04 3 1  ON 37
ci_39                -6.916835e-04 3 1  ON 38
ci_40                -1.672535e-03 3 1  ON 39
ci_41                -1.489349e-03 3 1  ON 40
ci_42                -1.167512e-03 3 1  ON 41
ci_43                -2.929349e-03 3 1  ON 42
ci_44                -1.758473e-03 3 1  ON 43
ci_45                -7.173790e-04 3 1  ON 44
ci_46                -5.554666e-04 3 1  ON 45
ci_47                 1.178527e-03 3 1  ON 46
ci_48                 6.565892e-04 3 1  ON 47
ci_49                -9.408933e-04 3 1  ON 48
ci_50                -7.125099e-04 3 1  ON 49
ci_51                 4.281812e-04 3 1  ON 50
ci_52                 4.563539e-04 3 1  ON 51
ci_53                -6.068951e-04 3 1  ON 52
ci_54                -9.527266e-04 3 1  ON 53
ci_55                -7.061813e-04 3 1  ON 54
ci_56                 1.902054e-03 3 1  ON 55
ci_57                 1.694895e-03 3 1  ON 56
ci_58                -7.101216e-04 3 1  ON 57
ci_59                -1.014994e-03 3 1  ON 58
ci_60                 5.684217e-04 3 1  ON 59
ci_61                 6.562306e-04 3 1  ON 60
ci_62                -2.651250e-04 3 1  ON 61
ci_63                -5.900917e-04 3 1  ON 62
ci_64                -5.066610e-04 3 1  ON 63
ci_65                -2.784782e-04 3 1  ON 64
ci_66                -7.027227e-04 3 1  ON 65
ci_67                -5.671699e-04 3 1  ON 66
ci_68                -6.011500e-04 3 1  ON 67
ci_69                 3.580847e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8232
    reference variance = 0.62492
====================================================
  Execution time = 2.5293e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5450e-01
  Total weights = 1.9640e+06
  Execution time = 3.4904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439462633140
                                         uncertainty =       0.002813947476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439462633140
                                         uncertainty =       0.002813947476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468752713
  error estimate for blocks of size 2^( 2) =       0.000493884309
  error estimate for blocks of size 2^( 3) =       0.000517836628
  error estimate for blocks of size 2^( 4) =       0.000534736200
  error estimate for blocks of size 2^( 5) =       0.000546096848
  error estimate for blocks of size 2^( 6) =       0.000553612707
  error estimate for blocks of size 2^( 7) =       0.000556407012

      target function =      -0.741639530865
              le_mean =     -22.814427446251
             les_mean =     520.952602176553
             stat err =       0.000547713192
             autocorr =       1.365270838712
   target nu stat err =       0.000547713192
   target dn stat err =       0.003753247077
      target stat err =       0.003130104116
              std dev =       0.662916443494
             le_variance =       0.439458211054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439461119224
                                         uncertainty =       0.002813844154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439461119224
                                         uncertainty =       0.002813844154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468751906
  error estimate for blocks of size 2^( 2) =       0.000493883847
  error estimate for blocks of size 2^( 3) =       0.000517836504
  error estimate for blocks of size 2^( 4) =       0.000534736292
  error estimate for blocks of size 2^( 5) =       0.000546096986
  error estimate for blocks of size 2^( 6) =       0.000553612875
  error estimate for blocks of size 2^( 7) =       0.000556407402

      target function =      -0.741639299901
              le_mean =     -22.814427439206
             les_mean =     520.952602137888
             stat err =       0.000547713389
             autocorr =       1.365276519037
   target nu stat err =       0.000547713389
   target dn stat err =       0.003753193167
      target stat err =       0.003130058927
              std dev =       0.662915303376
             le_variance =       0.439456699451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439461874991
                                         uncertainty =       0.002813895765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439461874991
                                         uncertainty =       0.002813895765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468752309
  error estimate for blocks of size 2^( 2) =       0.000493884078
  error estimate for blocks of size 2^( 3) =       0.000517836566
  error estimate for blocks of size 2^( 4) =       0.000534736246
  error estimate for blocks of size 2^( 5) =       0.000546096917
  error estimate for blocks of size 2^( 6) =       0.000553612791
  error estimate for blocks of size 2^( 7) =       0.000556407207

      target function =      -0.741640234799
              le_mean =     -22.814427442594
             les_mean =     520.952601149700
             stat err =       0.000547713290
             autocorr =       1.365273681484
   target nu stat err =       0.000547713290
   target dn stat err =       0.003753218938
      target stat err =       0.003130087358
              std dev =       0.662915872538
             le_variance =       0.439457454062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439462538284
                                         uncertainty =       0.002813941010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439462538284
                                         uncertainty =       0.002813941010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468752662
  error estimate for blocks of size 2^( 2) =       0.000493884280
  error estimate for blocks of size 2^( 3) =       0.000517836620
  error estimate for blocks of size 2^( 4) =       0.000534736205
  error estimate for blocks of size 2^( 5) =       0.000546096856
  error estimate for blocks of size 2^( 6) =       0.000553612717
  error estimate for blocks of size 2^( 7) =       0.000556407036

      target function =      -0.741639657362
              le_mean =     -22.814427445781
             les_mean =     520.952602000568
             stat err =       0.000547713204
             autocorr =       1.365271194133
   target nu stat err =       0.000547713204
   target dn stat err =       0.003753243446
      target stat err =       0.003130102249
              std dev =       0.662916372058
             le_variance =       0.439458116343


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741639530865        initial
     4.0000e+01     4.0000e+02             7.9840e-06        -0.741639299901
     1.6000e+02     1.6000e+03             1.9970e-06        -0.741640234799  <--
     6.4000e+02     6.4000e+03             4.9932e-07        -0.741639657362

*****************************************************************************
Applying the update for shift_i =   1.6000e+02     and shift_s =   1.6000e+03
*****************************************************************************

  Execution time = 4.2744e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.322077e-01 3 1  ON 0
ci_02                -3.193759e-02 3 1  ON 1
ci_03                -3.161162e-02 3 1  ON 2
ci_04                 2.841460e-02 3 1  ON 3
ci_05                -2.375079e-02 3 1  ON 4
ci_06                -2.331232e-02 3 1  ON 5
ci_07                 2.703033e-02 3 1  ON 6
ci_08                -6.707516e-03 3 1  ON 7
ci_09                -9.518539e-03 3 1  ON 8
ci_10                -9.525226e-03 3 1  ON 9
ci_11                 1.312180e-02 3 1  ON 10
ci_12                 7.878811e-03 3 1  ON 11
ci_13                 1.272981e-02 3 1  ON 12
ci_14                 1.306474e-02 3 1  ON 13
ci_15                 7.263292e-03 3 1  ON 14
ci_16                 7.491490e-03 3 1  ON 15
ci_17                -7.796772e-03 3 1  ON 16
ci_18                -7.316237e-03 3 1  ON 17
ci_19                 9.386999e-03 3 1  ON 18
ci_20                 6.908831e-03 3 1  ON 19
ci_21                 8.803583e-03 3 1  ON 20
ci_22                 8.856469e-03 3 1  ON 21
ci_23                 4.971664e-03 3 1  ON 22
ci_24                 4.360029e-03 3 1  ON 23
ci_25                 3.177902e-03 3 1  ON 24
ci_26                 3.229835e-03 3 1  ON 25
ci_27                 3.314369e-03 3 1  ON 26
ci_28                 2.517782e-03 3 1  ON 27
ci_29                 2.128752e-03 3 1  ON 28
ci_30                -1.690954e-03 3 1  ON 29
ci_31                -1.654238e-03 3 1  ON 30
ci_32                -1.414323e-03 3 1  ON 31
ci_33                -1.083379e-03 3 1  ON 32
ci_34                 1.530003e-03 3 1  ON 33
ci_35                 1.266503e-03 3 1  ON 34
ci_36                -1.223510e-03 3 1  ON 35
ci_37                -1.185732e-03 3 1  ON 36
ci_38                -5.144773e-04 3 1  ON 37
ci_39                -6.916835e-04 3 1  ON 38
ci_40                -1.672535e-03 3 1  ON 39
ci_41                -1.489349e-03 3 1  ON 40
ci_42                -1.167512e-03 3 1  ON 41
ci_43                -2.929349e-03 3 1  ON 42
ci_44                -1.758473e-03 3 1  ON 43
ci_45                -7.173790e-04 3 1  ON 44
ci_46                -5.554666e-04 3 1  ON 45
ci_47                 1.178527e-03 3 1  ON 46
ci_48                 6.565892e-04 3 1  ON 47
ci_49                -9.408933e-04 3 1  ON 48
ci_50                -7.125099e-04 3 1  ON 49
ci_51                 4.281812e-04 3 1  ON 50
ci_52                 4.563539e-04 3 1  ON 51
ci_53                -6.068951e-04 3 1  ON 52
ci_54                -9.527266e-04 3 1  ON 53
ci_55                -7.061813e-04 3 1  ON 54
ci_56                 1.902054e-03 3 1  ON 55
ci_57                 1.694895e-03 3 1  ON 56
ci_58                -7.101216e-04 3 1  ON 57
ci_59                -1.014994e-03 3 1  ON 58
ci_60                 5.684217e-04 3 1  ON 59
ci_61                 6.562306e-04 3 1  ON 60
ci_62                -2.651250e-04 3 1  ON 61
ci_63                -5.900917e-04 3 1  ON 62
ci_64                -5.066610e-04 3 1  ON 63
ci_65                -2.784782e-04 3 1  ON 64
ci_66                -7.027227e-04 3 1  ON 65
ci_67                -5.671699e-04 3 1  ON 66
ci_68                -6.011500e-04 3 1  ON 67
ci_69                 3.580847e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3123e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -23.0225
    reference variance = 0.336628
====================================================
  Execution time = 2.6015e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4505e-01
  Total weights = 1.964459095e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431803391862
                                         uncertainty =       0.001652028941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431803391862
                                         uncertainty =       0.001652028941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464680098
  error estimate for blocks of size 2^( 2) =       0.000489974674
  error estimate for blocks of size 2^( 3) =       0.000513357661
  error estimate for blocks of size 2^( 4) =       0.000531352205
  error estimate for blocks of size 2^( 5) =       0.000542491692
  error estimate for blocks of size 2^( 6) =       0.000548958617
  error estimate for blocks of size 2^( 7) =       0.000551231541

      target function =      -0.749467058295
              le_mean =     -22.814753474176
             les_mean =     520.958023561564
             stat err =       0.000543508514
             autocorr =       1.368058151285
   target nu stat err =       0.000543508514
   target dn stat err =       0.002599683223
      target stat err =       0.002256430333
              std dev =       0.657156897302
             le_variance =       0.431855187672


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281475347418e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749472906561       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749473548934       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749473654254       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749473665896       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749473671603       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749473675850       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749473676445       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749473676188       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749473676184       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749473676221       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 7.580730e-06

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749472906561       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749473067301       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749473093646       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749473096557       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749473097983       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749473099045       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749473099193       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749473099129       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749473099128       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749473099137       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+02 is 1.896187e-06

solving harmonic davidson linear method for identity shift 6.4000e+02, overlap shift 6.4000e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749472906561       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749472946755       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749472953342       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749472954070       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749472954427       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749472954692       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749472954729       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749472954713       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749472954713       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749472954716       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+02 is 4.741096e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140227 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0518e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.322058e-01 3 1  ON 0
ci_02                -3.193615e-02 3 1  ON 1
ci_03                -3.161058e-02 3 1  ON 2
ci_04                 2.841367e-02 3 1  ON 3
ci_05                -2.374954e-02 3 1  ON 4
ci_06                -2.331135e-02 3 1  ON 5
ci_07                 2.703008e-02 3 1  ON 6
ci_08                -6.706952e-03 3 1  ON 7
ci_09                -9.518051e-03 3 1  ON 8
ci_10                -9.524634e-03 3 1  ON 9
ci_11                 1.312173e-02 3 1  ON 10
ci_12                 7.878072e-03 3 1  ON 11
ci_13                 1.272997e-02 3 1  ON 12
ci_14                 1.306488e-02 3 1  ON 13
ci_15                 7.263227e-03 3 1  ON 14
ci_16                 7.491047e-03 3 1  ON 15
ci_17                -7.796690e-03 3 1  ON 16
ci_18                -7.315824e-03 3 1  ON 17
ci_19                 9.386972e-03 3 1  ON 18
ci_20                 6.908994e-03 3 1  ON 19
ci_21                 8.803858e-03 3 1  ON 20
ci_22                 8.856721e-03 3 1  ON 21
ci_23                 4.971691e-03 3 1  ON 22
ci_24                 4.359539e-03 3 1  ON 23
ci_25                 3.177492e-03 3 1  ON 24
ci_26                 3.229677e-03 3 1  ON 25
ci_27                 3.314182e-03 3 1  ON 26
ci_28                 2.517550e-03 3 1  ON 27
ci_29                 2.128857e-03 3 1  ON 28
ci_30                -1.691092e-03 3 1  ON 29
ci_31                -1.654076e-03 3 1  ON 30
ci_32                -1.414383e-03 3 1  ON 31
ci_33                -1.083510e-03 3 1  ON 32
ci_34                 1.529831e-03 3 1  ON 33
ci_35                 1.266461e-03 3 1  ON 34
ci_36                -1.223361e-03 3 1  ON 35
ci_37                -1.185707e-03 3 1  ON 36
ci_38                -5.143092e-04 3 1  ON 37
ci_39                -6.918155e-04 3 1  ON 38
ci_40                -1.672437e-03 3 1  ON 39
ci_41                -1.489392e-03 3 1  ON 40
ci_42                -1.167467e-03 3 1  ON 41
ci_43                -2.928458e-03 3 1  ON 42
ci_44                -1.758394e-03 3 1  ON 43
ci_45                -7.174399e-04 3 1  ON 44
ci_46                -5.553436e-04 3 1  ON 45
ci_47                 1.178701e-03 3 1  ON 46
ci_48                 6.566785e-04 3 1  ON 47
ci_49                -9.408196e-04 3 1  ON 48
ci_50                -7.125607e-04 3 1  ON 49
ci_51                 4.282766e-04 3 1  ON 50
ci_52                 4.561487e-04 3 1  ON 51
ci_53                -6.071275e-04 3 1  ON 52
ci_54                -9.525264e-04 3 1  ON 53
ci_55                -7.062352e-04 3 1  ON 54
ci_56                 1.902258e-03 3 1  ON 55
ci_57                 1.695190e-03 3 1  ON 56
ci_58                -7.098622e-04 3 1  ON 57
ci_59                -1.014992e-03 3 1  ON 58
ci_60                 5.686960e-04 3 1  ON 59
ci_61                 6.563364e-04 3 1  ON 60
ci_62                -2.649495e-04 3 1  ON 61
ci_63                -5.901355e-04 3 1  ON 62
ci_64                -5.069714e-04 3 1  ON 63
ci_65                -2.782201e-04 3 1  ON 64
ci_66                -7.027655e-04 3 1  ON 65
ci_67                -5.672049e-04 3 1  ON 66
ci_68                -6.011652e-04 3 1  ON 67
ci_69                 3.516594e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7637
    reference variance = 0.382295
====================================================
  Execution time = 2.6925e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4365e-01
  Total weights = 1.9640e+06
  Execution time = 3.4804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430177629806
                                         uncertainty =       0.001675743680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430177629806
                                         uncertainty =       0.001675743680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463777365
  error estimate for blocks of size 2^( 2) =       0.000488737605
  error estimate for blocks of size 2^( 3) =       0.000512034209
  error estimate for blocks of size 2^( 4) =       0.000529633677
  error estimate for blocks of size 2^( 5) =       0.000539749269
  error estimate for blocks of size 2^( 6) =       0.000546721625
  error estimate for blocks of size 2^( 7) =       0.000547062078

      target function =      -0.750637567659
              le_mean =     -22.814807096513
             les_mean =     520.959074386267
             stat err =       0.000540791662
             autocorr =       1.359693049865
   target nu stat err =       0.000540791662
   target dn stat err =       0.002358670490
      target stat err =       0.002068497598
              std dev =       0.655880238936
             le_variance =       0.430178887826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430175789506
                                         uncertainty =       0.001675694879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430175789506
                                         uncertainty =       0.001675694879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463776375
  error estimate for blocks of size 2^( 2) =       0.000488736979
  error estimate for blocks of size 2^( 3) =       0.000512033884
  error estimate for blocks of size 2^( 4) =       0.000529633633
  error estimate for blocks of size 2^( 5) =       0.000539749355
  error estimate for blocks of size 2^( 6) =       0.000546721673
  error estimate for blocks of size 2^( 7) =       0.000547062012

      target function =      -0.750643930802
              le_mean =     -22.814807083822
             les_mean =     520.959066222577
             stat err =       0.000540791668
             autocorr =       1.359698880426
   target nu stat err =       0.000540791668
   target dn stat err =       0.002358245046
      target stat err =       0.002068189860
              std dev =       0.655878839677
             le_variance =       0.430177052336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430176708394
                                         uncertainty =       0.001675719256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430176708394
                                         uncertainty =       0.001675719256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463776869
  error estimate for blocks of size 2^( 2) =       0.000488737291
  error estimate for blocks of size 2^( 3) =       0.000512034046
  error estimate for blocks of size 2^( 4) =       0.000529633655
  error estimate for blocks of size 2^( 5) =       0.000539749312
  error estimate for blocks of size 2^( 6) =       0.000546721649
  error estimate for blocks of size 2^( 7) =       0.000547062045

      target function =      -0.750640884915
              le_mean =     -22.814807090058
             les_mean =     520.959070137641
             stat err =       0.000540791665
             autocorr =       1.359695967550
   target nu stat err =       0.000540791665
   target dn stat err =       0.002358454490
      target stat err =       0.002068341816
              std dev =       0.655879538347
             le_variance =       0.430177968822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430177514545
                                         uncertainty =       0.001675740625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430177514545
                                         uncertainty =       0.001675740625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463777303
  error estimate for blocks of size 2^( 2) =       0.000488737565
  error estimate for blocks of size 2^( 3) =       0.000512034188
  error estimate for blocks of size 2^( 4) =       0.000529633674
  error estimate for blocks of size 2^( 5) =       0.000539749274
  error estimate for blocks of size 2^( 6) =       0.000546721628
  error estimate for blocks of size 2^( 7) =       0.000547062074

      target function =      -0.750638010270
              le_mean =     -22.814807095694
             les_mean =     520.959073821270
             stat err =       0.000540791663
             autocorr =       1.359693414655
   target nu stat err =       0.000540791663
   target dn stat err =       0.002358643134
      target stat err =       0.002068477987
              std dev =       0.655880151298
             le_variance =       0.430178772866


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750637567659        initial
     4.0000e+01     4.0000e+02             7.5807e-06        -0.750643930802  <--
     1.6000e+02     1.6000e+03             1.8962e-06        -0.750640884915
     6.4000e+02     6.4000e+03             4.7411e-07        -0.750638010270

*****************************************************************************
Applying the update for shift_i =   4.0000e+01     and shift_s =   4.0000e+02
*****************************************************************************

  Execution time = 4.4337e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.322002e-01 3 1  ON 0
ci_02                -3.193186e-02 3 1  ON 1
ci_03                -3.160748e-02 3 1  ON 2
ci_04                 2.841087e-02 3 1  ON 3
ci_05                -2.374582e-02 3 1  ON 4
ci_06                -2.330845e-02 3 1  ON 5
ci_07                 2.702934e-02 3 1  ON 6
ci_08                -6.705262e-03 3 1  ON 7
ci_09                -9.516590e-03 3 1  ON 8
ci_10                -9.522860e-03 3 1  ON 9
ci_11                 1.312154e-02 3 1  ON 10
ci_12                 7.875857e-03 3 1  ON 11
ci_13                 1.273045e-02 3 1  ON 12
ci_14                 1.306529e-02 3 1  ON 13
ci_15                 7.263034e-03 3 1  ON 14
ci_16                 7.489719e-03 3 1  ON 15
ci_17                -7.796443e-03 3 1  ON 16
ci_18                -7.314586e-03 3 1  ON 17
ci_19                 9.386890e-03 3 1  ON 18
ci_20                 6.909484e-03 3 1  ON 19
ci_21                 8.804683e-03 3 1  ON 20
ci_22                 8.857475e-03 3 1  ON 21
ci_23                 4.971772e-03 3 1  ON 22
ci_24                 4.358069e-03 3 1  ON 23
ci_25                 3.176262e-03 3 1  ON 24
ci_26                 3.229204e-03 3 1  ON 25
ci_27                 3.313620e-03 3 1  ON 26
ci_28                 2.516853e-03 3 1  ON 27
ci_29                 2.129169e-03 3 1  ON 28
ci_30                -1.691505e-03 3 1  ON 29
ci_31                -1.653592e-03 3 1  ON 30
ci_32                -1.414563e-03 3 1  ON 31
ci_33                -1.083902e-03 3 1  ON 32
ci_34                 1.529315e-03 3 1  ON 33
ci_35                 1.266336e-03 3 1  ON 34
ci_36                -1.222913e-03 3 1  ON 35
ci_37                -1.185629e-03 3 1  ON 36
ci_38                -5.138055e-04 3 1  ON 37
ci_39                -6.922110e-04 3 1  ON 38
ci_40                -1.672143e-03 3 1  ON 39
ci_41                -1.489522e-03 3 1  ON 40
ci_42                -1.167333e-03 3 1  ON 41
ci_43                -2.925787e-03 3 1  ON 42
ci_44                -1.758157e-03 3 1  ON 43
ci_45                -7.176222e-04 3 1  ON 44
ci_46                -5.549749e-04 3 1  ON 45
ci_47                 1.179226e-03 3 1  ON 46
ci_48                 6.569462e-04 3 1  ON 47
ci_49                -9.405988e-04 3 1  ON 48
ci_50                -7.127129e-04 3 1  ON 49
ci_51                 4.285623e-04 3 1  ON 50
ci_52                 4.555340e-04 3 1  ON 51
ci_53                -6.078237e-04 3 1  ON 52
ci_54                -9.519266e-04 3 1  ON 53
ci_55                -7.063966e-04 3 1  ON 54
ci_56                 1.902871e-03 3 1  ON 55
ci_57                 1.696077e-03 3 1  ON 56
ci_58                -7.090850e-04 3 1  ON 57
ci_59                -1.014985e-03 3 1  ON 58
ci_60                 5.695186e-04 3 1  ON 59
ci_61                 6.566537e-04 3 1  ON 60
ci_62                -2.644235e-04 3 1  ON 61
ci_63                -5.902667e-04 3 1  ON 62
ci_64                -5.079016e-04 3 1  ON 63
ci_65                -2.774466e-04 3 1  ON 64
ci_66                -7.028937e-04 3 1  ON 65
ci_67                -5.673097e-04 3 1  ON 66
ci_68                -6.012105e-04 3 1  ON 67
ci_69                 3.324058e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4875e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.8535
    reference variance = 0.387993
====================================================
  Execution time = 2.6065e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5363e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4472e-01
  Total weights = 1.964541603e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432111693677
                                         uncertainty =       0.001732821292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432111693677
                                         uncertainty =       0.001732821292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464780426
  error estimate for blocks of size 2^( 2) =       0.000490017241
  error estimate for blocks of size 2^( 3) =       0.000513775219
  error estimate for blocks of size 2^( 4) =       0.000530571759
  error estimate for blocks of size 2^( 5) =       0.000542146540
  error estimate for blocks of size 2^( 6) =       0.000548319612
  error estimate for blocks of size 2^( 7) =       0.000551526330

      target function =      -0.749734613734
              le_mean =     -22.813968049579
             les_mean =     520.921856945043
             stat err =       0.000543141060
             autocorr =       1.365619194774
   target nu stat err =       0.000543141060
   target dn stat err =       0.002689741285
      target stat err =       0.002327821715
              std dev =       0.657298781976
             le_variance =       0.432041688787


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281396804958e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749740775555       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749742699414       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749743060904       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749743146027       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749743171405       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749743189651       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749743188013       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749743186782       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749743186011       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749743186089       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 3.529438e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749740775555       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749741258278       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749741348848       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749741370140       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749741376465       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749741381012       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749741380600       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749741380293       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749741380101       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749741380121       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 8.841794e-06

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749740775555       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749740896346       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749740919001       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749740924325       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749740925905       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749740927040       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749740926937       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749740926861       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749740926813       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749740926817       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+02 is 2.211589e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143756 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0612e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.321913e-01 3 1  ON 0
ci_02                -3.192758e-02 3 1  ON 1
ci_03                -3.160449e-02 3 1  ON 2
ci_04                 2.840752e-02 3 1  ON 3
ci_05                -2.374187e-02 3 1  ON 4
ci_06                -2.330406e-02 3 1  ON 5
ci_07                 2.702929e-02 3 1  ON 6
ci_08                -6.704061e-03 3 1  ON 7
ci_09                -9.515077e-03 3 1  ON 8
ci_10                -9.520910e-03 3 1  ON 9
ci_11                 1.312137e-02 3 1  ON 10
ci_12                 7.874836e-03 3 1  ON 11
ci_13                 1.273072e-02 3 1  ON 12
ci_14                 1.306558e-02 3 1  ON 13
ci_15                 7.263235e-03 3 1  ON 14
ci_16                 7.487390e-03 3 1  ON 15
ci_17                -7.792869e-03 3 1  ON 16
ci_18                -7.312513e-03 3 1  ON 17
ci_19                 9.386931e-03 3 1  ON 18
ci_20                 6.911189e-03 3 1  ON 19
ci_21                 8.804653e-03 3 1  ON 20
ci_22                 8.856502e-03 3 1  ON 21
ci_23                 4.973766e-03 3 1  ON 22
ci_24                 4.359457e-03 3 1  ON 23
ci_25                 3.176292e-03 3 1  ON 24
ci_26                 3.229771e-03 3 1  ON 25
ci_27                 3.314947e-03 3 1  ON 26
ci_28                 2.515123e-03 3 1  ON 27
ci_29                 2.130012e-03 3 1  ON 28
ci_30                -1.690160e-03 3 1  ON 29
ci_31                -1.652347e-03 3 1  ON 30
ci_32                -1.414069e-03 3 1  ON 31
ci_33                -1.082967e-03 3 1  ON 32
ci_34                 1.528882e-03 3 1  ON 33
ci_35                 1.266655e-03 3 1  ON 34
ci_36                -1.222084e-03 3 1  ON 35
ci_37                -1.185668e-03 3 1  ON 36
ci_38                -5.136300e-04 3 1  ON 37
ci_39                -6.917201e-04 3 1  ON 38
ci_40                -1.672201e-03 3 1  ON 39
ci_41                -1.490127e-03 3 1  ON 40
ci_42                -1.166140e-03 3 1  ON 41
ci_43                -2.925278e-03 3 1  ON 42
ci_44                -1.756313e-03 3 1  ON 43
ci_45                -7.168754e-04 3 1  ON 44
ci_46                -5.548856e-04 3 1  ON 45
ci_47                 1.178280e-03 3 1  ON 46
ci_48                 6.587762e-04 3 1  ON 47
ci_49                -9.407727e-04 3 1  ON 48
ci_50                -7.130446e-04 3 1  ON 49
ci_51                 4.293356e-04 3 1  ON 50
ci_52                 4.544098e-04 3 1  ON 51
ci_53                -6.077567e-04 3 1  ON 52
ci_54                -9.527506e-04 3 1  ON 53
ci_55                -7.069229e-04 3 1  ON 54
ci_56                 1.902464e-03 3 1  ON 55
ci_57                 1.695952e-03 3 1  ON 56
ci_58                -7.102320e-04 3 1  ON 57
ci_59                -1.014903e-03 3 1  ON 58
ci_60                 5.665587e-04 3 1  ON 59
ci_61                 6.555935e-04 3 1  ON 60
ci_62                -2.653080e-04 3 1  ON 61
ci_63                -5.899350e-04 3 1  ON 62
ci_64                -5.081583e-04 3 1  ON 63
ci_65                -2.777524e-04 3 1  ON 64
ci_66                -7.027984e-04 3 1  ON 65
ci_67                -5.677473e-04 3 1  ON 66
ci_68                -6.023203e-04 3 1  ON 67
ci_69                 3.221718e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.8172
    reference variance = 0.528187
====================================================
  Execution time = 2.5155e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4274e-01
  Total weights = 1.9643e+06
  Execution time = 3.4906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432009641165
                                         uncertainty =       0.001656416126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432009641165
                                         uncertainty =       0.001656416126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464866985
  error estimate for blocks of size 2^( 2) =       0.000490505817
  error estimate for blocks of size 2^( 3) =       0.000513959282
  error estimate for blocks of size 2^( 4) =       0.000530722058
  error estimate for blocks of size 2^( 5) =       0.000541714072
  error estimate for blocks of size 2^( 6) =       0.000547996366
  error estimate for blocks of size 2^( 7) =       0.000551905557

      target function =      -0.751391842113
              le_mean =     -22.814607447817
             les_mean =     520.949064848730
             stat err =       0.000543084513
             autocorr =       1.364826446261
   target nu stat err =       0.000543084513
   target dn stat err =       0.002091411417
      target stat err =       0.001859087920
              std dev =       0.657421195399
             le_variance =       0.432202628160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432003363295
                                         uncertainty =       0.001656340012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432003363295
                                         uncertainty =       0.001656340012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464863612
  error estimate for blocks of size 2^( 2) =       0.000490503397
  error estimate for blocks of size 2^( 3) =       0.000513958057
  error estimate for blocks of size 2^( 4) =       0.000530721717
  error estimate for blocks of size 2^( 5) =       0.000541714064
  error estimate for blocks of size 2^( 6) =       0.000547996518
  error estimate for blocks of size 2^( 7) =       0.000551905865

      target function =      -0.751367057989
              le_mean =     -22.814607394251
             les_mean =     520.949091909506
             stat err =       0.000543084541
             autocorr =       1.364846392903
   target nu stat err =       0.000543084541
   target dn stat err =       0.002090369026
      target stat err =       0.001858144015
              std dev =       0.657416425123
             le_variance =       0.432196356022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432006485717
                                         uncertainty =       0.001656377957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432006485717
                                         uncertainty =       0.001656377957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464865290
  error estimate for blocks of size 2^( 2) =       0.000490504600
  error estimate for blocks of size 2^( 3) =       0.000513958664
  error estimate for blocks of size 2^( 4) =       0.000530721885
  error estimate for blocks of size 2^( 5) =       0.000541714066
  error estimate for blocks of size 2^( 6) =       0.000547996441
  error estimate for blocks of size 2^( 7) =       0.000551905710

      target function =      -0.751400441036
              le_mean =     -22.814607418627
             les_mean =     520.949053286209
             stat err =       0.000543084525
             autocorr =       1.364836462196
   target nu stat err =       0.000543084525
   target dn stat err =       0.002090442887
      target stat err =       0.001858359029
              std dev =       0.657418797707
             le_variance =       0.432199475578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432009245652
                                         uncertainty =       0.001656411348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432009245652
                                         uncertainty =       0.001656411348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464866773
  error estimate for blocks of size 2^( 2) =       0.000490505664
  error estimate for blocks of size 2^( 3) =       0.000513959204
  error estimate for blocks of size 2^( 4) =       0.000530722036
  error estimate for blocks of size 2^( 5) =       0.000541714071
  error estimate for blocks of size 2^( 6) =       0.000547996375
  error estimate for blocks of size 2^( 7) =       0.000551905576

      target function =      -0.751393623735
              le_mean =     -22.814607443985
             les_mean =     520.949062553833
             stat err =       0.000543084514
             autocorr =       1.364827699736
   target nu stat err =       0.000543084514
   target dn stat err =       0.002091284927
      target stat err =       0.001858995812
              std dev =       0.657420894864
             le_variance =       0.432202233004


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.751391842113        initial
     1.0000e+01     1.0000e+02             3.5294e-05        -0.751367057989
     4.0000e+01     4.0000e+02             8.8418e-06        -0.751400441036  <--
     1.6000e+02     1.6000e+03             2.2116e-06        -0.751393623735

*****************************************************************************
Applying the update for shift_i =   4.0000e+01     and shift_s =   4.0000e+02
*****************************************************************************

  Execution time = 4.2724e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.321913e-01 3 1  ON 0
ci_02                -3.192758e-02 3 1  ON 1
ci_03                -3.160449e-02 3 1  ON 2
ci_04                 2.840752e-02 3 1  ON 3
ci_05                -2.374187e-02 3 1  ON 4
ci_06                -2.330406e-02 3 1  ON 5
ci_07                 2.702929e-02 3 1  ON 6
ci_08                -6.704061e-03 3 1  ON 7
ci_09                -9.515077e-03 3 1  ON 8
ci_10                -9.520910e-03 3 1  ON 9
ci_11                 1.312137e-02 3 1  ON 10
ci_12                 7.874836e-03 3 1  ON 11
ci_13                 1.273072e-02 3 1  ON 12
ci_14                 1.306558e-02 3 1  ON 13
ci_15                 7.263235e-03 3 1  ON 14
ci_16                 7.487390e-03 3 1  ON 15
ci_17                -7.792869e-03 3 1  ON 16
ci_18                -7.312513e-03 3 1  ON 17
ci_19                 9.386931e-03 3 1  ON 18
ci_20                 6.911189e-03 3 1  ON 19
ci_21                 8.804653e-03 3 1  ON 20
ci_22                 8.856502e-03 3 1  ON 21
ci_23                 4.973766e-03 3 1  ON 22
ci_24                 4.359457e-03 3 1  ON 23
ci_25                 3.176292e-03 3 1  ON 24
ci_26                 3.229771e-03 3 1  ON 25
ci_27                 3.314947e-03 3 1  ON 26
ci_28                 2.515123e-03 3 1  ON 27
ci_29                 2.130012e-03 3 1  ON 28
ci_30                -1.690160e-03 3 1  ON 29
ci_31                -1.652347e-03 3 1  ON 30
ci_32                -1.414069e-03 3 1  ON 31
ci_33                -1.082967e-03 3 1  ON 32
ci_34                 1.528882e-03 3 1  ON 33
ci_35                 1.266655e-03 3 1  ON 34
ci_36                -1.222084e-03 3 1  ON 35
ci_37                -1.185668e-03 3 1  ON 36
ci_38                -5.136300e-04 3 1  ON 37
ci_39                -6.917201e-04 3 1  ON 38
ci_40                -1.672201e-03 3 1  ON 39
ci_41                -1.490127e-03 3 1  ON 40
ci_42                -1.166140e-03 3 1  ON 41
ci_43                -2.925278e-03 3 1  ON 42
ci_44                -1.756313e-03 3 1  ON 43
ci_45                -7.168754e-04 3 1  ON 44
ci_46                -5.548856e-04 3 1  ON 45
ci_47                 1.178280e-03 3 1  ON 46
ci_48                 6.587762e-04 3 1  ON 47
ci_49                -9.407727e-04 3 1  ON 48
ci_50                -7.130446e-04 3 1  ON 49
ci_51                 4.293356e-04 3 1  ON 50
ci_52                 4.544098e-04 3 1  ON 51
ci_53                -6.077567e-04 3 1  ON 52
ci_54                -9.527506e-04 3 1  ON 53
ci_55                -7.069229e-04 3 1  ON 54
ci_56                 1.902464e-03 3 1  ON 55
ci_57                 1.695952e-03 3 1  ON 56
ci_58                -7.102320e-04 3 1  ON 57
ci_59                -1.014903e-03 3 1  ON 58
ci_60                 5.665587e-04 3 1  ON 59
ci_61                 6.555935e-04 3 1  ON 60
ci_62                -2.653080e-04 3 1  ON 61
ci_63                -5.899350e-04 3 1  ON 62
ci_64                -5.081583e-04 3 1  ON 63
ci_65                -2.777524e-04 3 1  ON 64
ci_66                -7.027984e-04 3 1  ON 65
ci_67                -5.677473e-04 3 1  ON 66
ci_68                -6.023203e-04 3 1  ON 67
ci_69                 3.221718e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3343e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8018
    reference variance = 0.398303
====================================================
  Execution time = 2.5840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5371e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4647e-01
  Total weights = 1.964176152e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433937632755
                                         uncertainty =       0.002127528464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433937632755
                                         uncertainty =       0.002127528464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465865130
  error estimate for blocks of size 2^( 2) =       0.000490905638
  error estimate for blocks of size 2^( 3) =       0.000515165291
  error estimate for blocks of size 2^( 4) =       0.000532738155
  error estimate for blocks of size 2^( 5) =       0.000544332388
  error estimate for blocks of size 2^( 6) =       0.000550729199
  error estimate for blocks of size 2^( 7) =       0.000551600728

      target function =      -0.748271981564
              le_mean =     -22.814141219436
             les_mean =     520.931514298617
             stat err =       0.000544850117
             autocorr =       1.367834924337
   target nu stat err =       0.000544850117
   target dn stat err =       0.002559601860
      target stat err =       0.002215735177
              std dev =       0.658832784836
             le_variance =       0.434060638375


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281414121944e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748277508054       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748279783295       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748280244991       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748280345667       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748280394721       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748280392631       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748280394981       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748280394149       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748280394007       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748280393796       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 3.896007e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748277508054       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748278078973       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748278194666       residual = 8.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748278219850       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748278232095       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748278231555       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748278232138       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748278231931       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748278231895       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748278231843       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 9.759350e-06

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748277508054       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748277650916       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748277679857       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748277686153       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748277689213       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748277689077       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748277689223       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748277689171       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748277689162       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748277689149       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+02 is 2.441049e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147221 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0385e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.321816e-01 3 1  ON 0
ci_02                -3.192331e-02 3 1  ON 1
ci_03                -3.160035e-02 3 1  ON 2
ci_04                 2.840241e-02 3 1  ON 3
ci_05                -2.373783e-02 3 1  ON 4
ci_06                -2.330151e-02 3 1  ON 5
ci_07                 2.702894e-02 3 1  ON 6
ci_08                -6.701898e-03 3 1  ON 7
ci_09                -9.513327e-03 3 1  ON 8
ci_10                -9.518532e-03 3 1  ON 9
ci_11                 1.312164e-02 3 1  ON 10
ci_12                 7.874772e-03 3 1  ON 11
ci_13                 1.273056e-02 3 1  ON 12
ci_14                 1.306553e-02 3 1  ON 13
ci_15                 7.261825e-03 3 1  ON 14
ci_16                 7.486504e-03 3 1  ON 15
ci_17                -7.790689e-03 3 1  ON 16
ci_18                -7.309596e-03 3 1  ON 17
ci_19                 9.386861e-03 3 1  ON 18
ci_20                 6.910295e-03 3 1  ON 19
ci_21                 8.803185e-03 3 1  ON 20
ci_22                 8.856674e-03 3 1  ON 21
ci_23                 4.973446e-03 3 1  ON 22
ci_24                 4.358214e-03 3 1  ON 23
ci_25                 3.175706e-03 3 1  ON 24
ci_26                 3.228830e-03 3 1  ON 25
ci_27                 3.315424e-03 3 1  ON 26
ci_28                 2.513051e-03 3 1  ON 27
ci_29                 2.130058e-03 3 1  ON 28
ci_30                -1.689010e-03 3 1  ON 29
ci_31                -1.653339e-03 3 1  ON 30
ci_32                -1.414242e-03 3 1  ON 31
ci_33                -1.082702e-03 3 1  ON 32
ci_34                 1.529455e-03 3 1  ON 33
ci_35                 1.266066e-03 3 1  ON 34
ci_36                -1.220650e-03 3 1  ON 35
ci_37                -1.185160e-03 3 1  ON 36
ci_38                -5.132575e-04 3 1  ON 37
ci_39                -6.922596e-04 3 1  ON 38
ci_40                -1.672256e-03 3 1  ON 39
ci_41                -1.489627e-03 3 1  ON 40
ci_42                -1.168351e-03 3 1  ON 41
ci_43                -2.924478e-03 3 1  ON 42
ci_44                -1.755631e-03 3 1  ON 43
ci_45                -7.160338e-04 3 1  ON 44
ci_46                -5.542140e-04 3 1  ON 45
ci_47                 1.179179e-03 3 1  ON 46
ci_48                 6.600198e-04 3 1  ON 47
ci_49                -9.396185e-04 3 1  ON 48
ci_50                -7.130720e-04 3 1  ON 49
ci_51                 4.293825e-04 3 1  ON 50
ci_52                 4.542970e-04 3 1  ON 51
ci_53                -6.079773e-04 3 1  ON 52
ci_54                -9.533947e-04 3 1  ON 53
ci_55                -7.068590e-04 3 1  ON 54
ci_56                 1.902610e-03 3 1  ON 55
ci_57                 1.696330e-03 3 1  ON 56
ci_58                -7.114964e-04 3 1  ON 57
ci_59                -1.014982e-03 3 1  ON 58
ci_60                 5.685087e-04 3 1  ON 59
ci_61                 6.547110e-04 3 1  ON 60
ci_62                -2.643001e-04 3 1  ON 61
ci_63                -5.897098e-04 3 1  ON 62
ci_64                -5.070846e-04 3 1  ON 63
ci_65                -2.770422e-04 3 1  ON 64
ci_66                -7.017300e-04 3 1  ON 65
ci_67                -5.681154e-04 3 1  ON 66
ci_68                -6.032160e-04 3 1  ON 67
ci_69                 3.037410e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8112
    reference variance = 0.425294
====================================================
  Execution time = 2.5183e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5274e-01
  Total weights = 1.9642e+06
  Execution time = 3.5045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436937608902
                                         uncertainty =       0.002314023339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436937608902
                                         uncertainty =       0.002314023339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467412702
  error estimate for blocks of size 2^( 2) =       0.000492280731
  error estimate for blocks of size 2^( 3) =       0.000516354886
  error estimate for blocks of size 2^( 4) =       0.000533745282
  error estimate for blocks of size 2^( 5) =       0.000544796592
  error estimate for blocks of size 2^( 6) =       0.000553239274
  error estimate for blocks of size 2^( 7) =       0.000556581582

      target function =      -0.743081562736
              le_mean =     -22.814109306652
             les_mean =     520.936328545156
             stat err =       0.000547090683
             autocorr =       1.369990691258
   target nu stat err =       0.000547090683
   target dn stat err =       0.003628024190
      target stat err =       0.003039607967
              std dev =       0.661021382646
             le_variance =       0.436949268315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436930632906
                                         uncertainty =       0.002313440993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436930632906
                                         uncertainty =       0.002313440993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467408969
  error estimate for blocks of size 2^( 2) =       0.000492278325
  error estimate for blocks of size 2^( 3) =       0.000516353840
  error estimate for blocks of size 2^( 4) =       0.000533744926
  error estimate for blocks of size 2^( 5) =       0.000544796334
  error estimate for blocks of size 2^( 6) =       0.000553238875
  error estimate for blocks of size 2^( 7) =       0.000556580751

      target function =      -0.743084851297
              le_mean =     -22.814109141221
             les_mean =     520.936317001123
             stat err =       0.000547090221
             autocorr =       1.370010265723
   target nu stat err =       0.000547090221
   target dn stat err =       0.003626867832
      target stat err =       0.003038702963
              std dev =       0.661016102896
             le_variance =       0.436942288288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436934101378
                                         uncertainty =       0.002313731222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436934101378
                                         uncertainty =       0.002313731222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467410825
  error estimate for blocks of size 2^( 2) =       0.000492279519
  error estimate for blocks of size 2^( 3) =       0.000516354356
  error estimate for blocks of size 2^( 4) =       0.000533745099
  error estimate for blocks of size 2^( 5) =       0.000544796458
  error estimate for blocks of size 2^( 6) =       0.000553239069
  error estimate for blocks of size 2^( 7) =       0.000556581161

      target function =      -0.743084041719
              le_mean =     -22.814109222346
             les_mean =     520.936321684181
             stat err =       0.000547090447
             autocorr =       1.370000512372
   target nu stat err =       0.000547090447
   target dn stat err =       0.003627419071
      target stat err =       0.003039140471
              std dev =       0.661018728004
             le_variance =       0.436945758772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436937169147
                                         uncertainty =       0.002313986770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436937169147
                                         uncertainty =       0.002313986770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467412467
  error estimate for blocks of size 2^( 2) =       0.000492280579
  error estimate for blocks of size 2^( 3) =       0.000516354819
  error estimate for blocks of size 2^( 4) =       0.000533745259
  error estimate for blocks of size 2^( 5) =       0.000544796575
  error estimate for blocks of size 2^( 6) =       0.000553239248
  error estimate for blocks of size 2^( 7) =       0.000556581529

      target function =      -0.743081956730
              le_mean =     -22.814109295956
             les_mean =     520.936327577910
             stat err =       0.000547090653
             autocorr =       1.369991920145
   target nu stat err =       0.000547090653
   target dn stat err =       0.003627945604
      target stat err =       0.003039547833
              std dev =       0.661021049823
             le_variance =       0.436948828309


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743081562736        initial
     1.0000e+01     1.0000e+02             3.8960e-05        -0.743084851297  <--
     4.0000e+01     4.0000e+02             9.7594e-06        -0.743084041719
     1.6000e+02     1.6000e+03             2.4410e-06        -0.743081956730

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 4.2799e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.321524e-01 3 1  ON 0
ci_02                -3.191055e-02 3 1  ON 1
ci_03                -3.158796e-02 3 1  ON 2
ci_04                 2.838715e-02 3 1  ON 3
ci_05                -2.372576e-02 3 1  ON 4
ci_06                -2.329388e-02 3 1  ON 5
ci_07                 2.702790e-02 3 1  ON 6
ci_08                -6.695441e-03 3 1  ON 7
ci_09                -9.508098e-03 3 1  ON 8
ci_10                -9.511427e-03 3 1  ON 9
ci_11                 1.312243e-02 3 1  ON 10
ci_12                 7.874584e-03 3 1  ON 11
ci_13                 1.273008e-02 3 1  ON 12
ci_14                 1.306538e-02 3 1  ON 13
ci_15                 7.257614e-03 3 1  ON 14
ci_16                 7.483857e-03 3 1  ON 15
ci_17                -7.784176e-03 3 1  ON 16
ci_18                -7.300882e-03 3 1  ON 17
ci_19                 9.386651e-03 3 1  ON 18
ci_20                 6.907625e-03 3 1  ON 19
ci_21                 8.798795e-03 3 1  ON 20
ci_22                 8.857190e-03 3 1  ON 21
ci_23                 4.972491e-03 3 1  ON 22
ci_24                 4.354497e-03 3 1  ON 23
ci_25                 3.173958e-03 3 1  ON 24
ci_26                 3.226022e-03 3 1  ON 25
ci_27                 3.316848e-03 3 1  ON 26
ci_28                 2.506859e-03 3 1  ON 27
ci_29                 2.130195e-03 3 1  ON 28
ci_30                -1.685571e-03 3 1  ON 29
ci_31                -1.656307e-03 3 1  ON 30
ci_32                -1.414760e-03 3 1  ON 31
ci_33                -1.081909e-03 3 1  ON 32
ci_34                 1.531167e-03 3 1  ON 33
ci_35                 1.264309e-03 3 1  ON 34
ci_36                -1.216370e-03 3 1  ON 35
ci_37                -1.183641e-03 3 1  ON 36
ci_38                -5.121464e-04 3 1  ON 37
ci_39                -6.938693e-04 3 1  ON 38
ci_40                -1.672419e-03 3 1  ON 39
ci_41                -1.488138e-03 3 1  ON 40
ci_42                -1.174954e-03 3 1  ON 41
ci_43                -2.922087e-03 3 1  ON 42
ci_44                -1.753593e-03 3 1  ON 43
ci_45                -7.135222e-04 3 1  ON 44
ci_46                -5.522095e-04 3 1  ON 45
ci_47                 1.181860e-03 3 1  ON 46
ci_48                 6.637387e-04 3 1  ON 47
ci_49                -9.361731e-04 3 1  ON 48
ci_50                -7.131547e-04 3 1  ON 49
ci_51                 4.295217e-04 3 1  ON 50
ci_52                 4.539599e-04 3 1  ON 51
ci_53                -6.086352e-04 3 1  ON 52
ci_54                -9.553203e-04 3 1  ON 53
ci_55                -7.066673e-04 3 1  ON 54
ci_56                 1.903046e-03 3 1  ON 55
ci_57                 1.697460e-03 3 1  ON 56
ci_58                -7.152720e-04 3 1  ON 57
ci_59                -1.015219e-03 3 1  ON 58
ci_60                 5.743485e-04 3 1  ON 59
ci_61                 6.520697e-04 3 1  ON 60
ci_62                -2.612929e-04 3 1  ON 61
ci_63                -5.890381e-04 3 1  ON 62
ci_64                -5.038800e-04 3 1  ON 63
ci_65                -2.749222e-04 3 1  ON 64
ci_66                -6.985403e-04 3 1  ON 65
ci_67                -5.692147e-04 3 1  ON 66
ci_68                -6.058902e-04 3 1  ON 67
ci_69                 2.486961e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3189e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7198
    reference variance = 0.499763
====================================================
  Execution time = 2.5855e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4643e-01
  Total weights = 1.964118756e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432621297303
                                         uncertainty =       0.001822416913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432621297303
                                         uncertainty =       0.001822416913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465068108
  error estimate for blocks of size 2^( 2) =       0.000490324157
  error estimate for blocks of size 2^( 3) =       0.000513790520
  error estimate for blocks of size 2^( 4) =       0.000530458712
  error estimate for blocks of size 2^( 5) =       0.000540290360
  error estimate for blocks of size 2^( 6) =       0.000545941239
  error estimate for blocks of size 2^( 7) =       0.000548926385

      target function =      -0.748308541876
              le_mean =     -22.814741702875
             les_mean =     520.958870834923
             stat err =       0.000541404174
             autocorr =       1.355220875506
   target nu stat err =       0.000541404174
   target dn stat err =       0.003197639750
      target stat err =       0.002732440131
              std dev =       0.657705625203
             le_variance =       0.432576689423


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281474170287e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748317195775       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748325828378       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748327342426       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748327547565       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748327562848       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748327609204       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748327597182       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748327600633       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748327601582       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 9.329380e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748317195775       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748319386228       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748319768005       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748319819299       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748319823081       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748319834572       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748319831525       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748319832384       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748319832614       residual = 6.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 2.351673e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748317195775       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748317745445       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748317841094       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748317853918       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748317854861       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748317857727       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748317856963       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748317857178       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748317857235       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 5.891399e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150266 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0364e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.321288e-01 3 1  ON 0
ci_02                -3.189535e-02 3 1  ON 1
ci_03                -3.158559e-02 3 1  ON 2
ci_04                 2.837265e-02 3 1  ON 3
ci_05                -2.370649e-02 3 1  ON 4
ci_06                -2.327677e-02 3 1  ON 5
ci_07                 2.702558e-02 3 1  ON 6
ci_08                -6.687385e-03 3 1  ON 7
ci_09                -9.493115e-03 3 1  ON 8
ci_10                -9.505579e-03 3 1  ON 9
ci_11                 1.312330e-02 3 1  ON 10
ci_12                 7.866152e-03 3 1  ON 11
ci_13                 1.272775e-02 3 1  ON 12
ci_14                 1.306726e-02 3 1  ON 13
ci_15                 7.261690e-03 3 1  ON 14
ci_16                 7.471763e-03 3 1  ON 15
ci_17                -7.772189e-03 3 1  ON 16
ci_18                -7.297543e-03 3 1  ON 17
ci_19                 9.380768e-03 3 1  ON 18
ci_20                 6.907521e-03 3 1  ON 19
ci_21                 8.793661e-03 3 1  ON 20
ci_22                 8.860725e-03 3 1  ON 21
ci_23                 4.971042e-03 3 1  ON 22
ci_24                 4.348689e-03 3 1  ON 23
ci_25                 3.171201e-03 3 1  ON 24
ci_26                 3.226564e-03 3 1  ON 25
ci_27                 3.318841e-03 3 1  ON 26
ci_28                 2.497699e-03 3 1  ON 27
ci_29                 2.122513e-03 3 1  ON 28
ci_30                -1.685354e-03 3 1  ON 29
ci_31                -1.654032e-03 3 1  ON 30
ci_32                -1.416212e-03 3 1  ON 31
ci_33                -1.079142e-03 3 1  ON 32
ci_34                 1.526803e-03 3 1  ON 33
ci_35                 1.258390e-03 3 1  ON 34
ci_36                -1.212796e-03 3 1  ON 35
ci_37                -1.175885e-03 3 1  ON 36
ci_38                -5.086350e-04 3 1  ON 37
ci_39                -6.932753e-04 3 1  ON 38
ci_40                -1.670926e-03 3 1  ON 39
ci_41                -1.486995e-03 3 1  ON 40
ci_42                -1.175137e-03 3 1  ON 41
ci_43                -2.926218e-03 3 1  ON 42
ci_44                -1.748086e-03 3 1  ON 43
ci_45                -7.097671e-04 3 1  ON 44
ci_46                -5.510499e-04 3 1  ON 45
ci_47                 1.185942e-03 3 1  ON 46
ci_48                 6.683804e-04 3 1  ON 47
ci_49                -9.393891e-04 3 1  ON 48
ci_50                -7.125183e-04 3 1  ON 49
ci_51                 4.309549e-04 3 1  ON 50
ci_52                 4.572546e-04 3 1  ON 51
ci_53                -6.104965e-04 3 1  ON 52
ci_54                -9.584840e-04 3 1  ON 53
ci_55                -7.093604e-04 3 1  ON 54
ci_56                 1.903495e-03 3 1  ON 55
ci_57                 1.696173e-03 3 1  ON 56
ci_58                -7.149699e-04 3 1  ON 57
ci_59                -1.021437e-03 3 1  ON 58
ci_60                 5.710183e-04 3 1  ON 59
ci_61                 6.507753e-04 3 1  ON 60
ci_62                -2.613191e-04 3 1  ON 61
ci_63                -5.844449e-04 3 1  ON 62
ci_64                -5.043536e-04 3 1  ON 63
ci_65                -2.730596e-04 3 1  ON 64
ci_66                -6.987069e-04 3 1  ON 65
ci_67                -5.699885e-04 3 1  ON 66
ci_68                -6.065518e-04 3 1  ON 67
ci_69                 2.022452e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8462
    reference variance = 0.247602
====================================================
  Execution time = 2.5095e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4688e-01
  Total weights = 1.9643e+06
  Execution time = 3.4951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432247441405
                                         uncertainty =       0.001784607534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432247441405
                                         uncertainty =       0.001784607534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464879596
  error estimate for blocks of size 2^( 2) =       0.000490303325
  error estimate for blocks of size 2^( 3) =       0.000513892202
  error estimate for blocks of size 2^( 4) =       0.000531372239
  error estimate for blocks of size 2^( 5) =       0.000540947537
  error estimate for blocks of size 2^( 6) =       0.000547145671
  error estimate for blocks of size 2^( 7) =       0.000550265613

      target function =      -0.747934586896
              le_mean =     -22.814056931006
             les_mean =     520.928069950978
             stat err =       0.000542432765
             autocorr =       1.361478724122
   target nu stat err =       0.000542432765
   target dn stat err =       0.003058511527
      target stat err =       0.002614516892
              std dev =       0.657439029725
             le_variance =       0.432226077806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432234443352
                                         uncertainty =       0.001785576709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432234443352
                                         uncertainty =       0.001785576709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464872593
  error estimate for blocks of size 2^( 2) =       0.000490300482
  error estimate for blocks of size 2^( 3) =       0.000513893665
  error estimate for blocks of size 2^( 4) =       0.000531377168
  error estimate for blocks of size 2^( 5) =       0.000540953881
  error estimate for blocks of size 2^( 6) =       0.000547151882
  error estimate for blocks of size 2^( 7) =       0.000550272657

      target function =      -0.747879480382
              le_mean =     -22.814056352617
             les_mean =     520.928109679027
             stat err =       0.000542438897
             autocorr =       1.361550526139
   target nu stat err =       0.000542438897
   target dn stat err =       0.003078236865
      target stat err =       0.002630106144
              std dev =       0.657429126305
             le_variance =       0.432213056114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432240732134
                                         uncertainty =       0.001785095066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432240732134
                                         uncertainty =       0.001785095066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464875982
  error estimate for blocks of size 2^( 2) =       0.000490301822
  error estimate for blocks of size 2^( 3) =       0.000513892876
  error estimate for blocks of size 2^( 4) =       0.000531374666
  error estimate for blocks of size 2^( 5) =       0.000540950676
  error estimate for blocks of size 2^( 6) =       0.000547148748
  error estimate for blocks of size 2^( 7) =       0.000550269108

      target function =      -0.747913615586
              le_mean =     -22.814056617438
             les_mean =     520.928080789611
             stat err =       0.000542435799
             autocorr =       1.361515128846
   target nu stat err =       0.000542435799
   target dn stat err =       0.003068093191
      target stat err =       0.002622128820
              std dev =       0.657433918027
             le_variance =       0.432219356572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432246585503
                                         uncertainty =       0.001784668202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432246585503
                                         uncertainty =       0.001784668202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464879135
  error estimate for blocks of size 2^( 2) =       0.000490303129
  error estimate for blocks of size 2^( 3) =       0.000513892279
  error estimate for blocks of size 2^( 4) =       0.000531372535
  error estimate for blocks of size 2^( 5) =       0.000540947923
  error estimate for blocks of size 2^( 6) =       0.000547146049
  error estimate for blocks of size 2^( 7) =       0.000550266043

      target function =      -0.747933726519
              le_mean =     -22.814056889711
             les_mean =     520.928069092896
             stat err =       0.000542433137
             autocorr =       1.361483294713
   target nu stat err =       0.000542433137
   target dn stat err =       0.003059677159
      target stat err =       0.002615454379
              std dev =       0.657438377651
             le_variance =       0.432225220408


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747934586896        initial  <--
     2.5000e+00     2.5000e+01             9.3294e-05        -0.747879480382
     1.0000e+01     1.0000e+02             2.3517e-05        -0.747913615586
     4.0000e+01     4.0000e+02             5.8914e-06        -0.747933726519

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.6842
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.321524e-01 3 1  ON 0
ci_02                -3.191055e-02 3 1  ON 1
ci_03                -3.158796e-02 3 1  ON 2
ci_04                 2.838715e-02 3 1  ON 3
ci_05                -2.372576e-02 3 1  ON 4
ci_06                -2.329388e-02 3 1  ON 5
ci_07                 2.702790e-02 3 1  ON 6
ci_08                -6.695441e-03 3 1  ON 7
ci_09                -9.508098e-03 3 1  ON 8
ci_10                -9.511427e-03 3 1  ON 9
ci_11                 1.312243e-02 3 1  ON 10
ci_12                 7.874584e-03 3 1  ON 11
ci_13                 1.273008e-02 3 1  ON 12
ci_14                 1.306538e-02 3 1  ON 13
ci_15                 7.257614e-03 3 1  ON 14
ci_16                 7.483857e-03 3 1  ON 15
ci_17                -7.784176e-03 3 1  ON 16
ci_18                -7.300882e-03 3 1  ON 17
ci_19                 9.386651e-03 3 1  ON 18
ci_20                 6.907625e-03 3 1  ON 19
ci_21                 8.798795e-03 3 1  ON 20
ci_22                 8.857190e-03 3 1  ON 21
ci_23                 4.972491e-03 3 1  ON 22
ci_24                 4.354497e-03 3 1  ON 23
ci_25                 3.173958e-03 3 1  ON 24
ci_26                 3.226022e-03 3 1  ON 25
ci_27                 3.316848e-03 3 1  ON 26
ci_28                 2.506859e-03 3 1  ON 27
ci_29                 2.130195e-03 3 1  ON 28
ci_30                -1.685571e-03 3 1  ON 29
ci_31                -1.656307e-03 3 1  ON 30
ci_32                -1.414760e-03 3 1  ON 31
ci_33                -1.081909e-03 3 1  ON 32
ci_34                 1.531167e-03 3 1  ON 33
ci_35                 1.264309e-03 3 1  ON 34
ci_36                -1.216370e-03 3 1  ON 35
ci_37                -1.183641e-03 3 1  ON 36
ci_38                -5.121464e-04 3 1  ON 37
ci_39                -6.938693e-04 3 1  ON 38
ci_40                -1.672419e-03 3 1  ON 39
ci_41                -1.488138e-03 3 1  ON 40
ci_42                -1.174954e-03 3 1  ON 41
ci_43                -2.922087e-03 3 1  ON 42
ci_44                -1.753593e-03 3 1  ON 43
ci_45                -7.135222e-04 3 1  ON 44
ci_46                -5.522095e-04 3 1  ON 45
ci_47                 1.181860e-03 3 1  ON 46
ci_48                 6.637387e-04 3 1  ON 47
ci_49                -9.361731e-04 3 1  ON 48
ci_50                -7.131547e-04 3 1  ON 49
ci_51                 4.295217e-04 3 1  ON 50
ci_52                 4.539599e-04 3 1  ON 51
ci_53                -6.086352e-04 3 1  ON 52
ci_54                -9.553203e-04 3 1  ON 53
ci_55                -7.066673e-04 3 1  ON 54
ci_56                 1.903046e-03 3 1  ON 55
ci_57                 1.697460e-03 3 1  ON 56
ci_58                -7.152720e-04 3 1  ON 57
ci_59                -1.015219e-03 3 1  ON 58
ci_60                 5.743485e-04 3 1  ON 59
ci_61                 6.520697e-04 3 1  ON 60
ci_62                -2.612929e-04 3 1  ON 61
ci_63                -5.890381e-04 3 1  ON 62
ci_64                -5.038800e-04 3 1  ON 63
ci_65                -2.749222e-04 3 1  ON 64
ci_66                -6.985403e-04 3 1  ON 65
ci_67                -5.692147e-04 3 1  ON 66
ci_68                -6.058902e-04 3 1  ON 67
ci_69                 2.486961e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3054e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8465
    reference variance = 0.345862
====================================================
  Execution time = 2.5881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4749e-01
  Total weights = 1.963953059e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435775134109
                                         uncertainty =       0.002075155072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435775134109
                                         uncertainty =       0.002075155072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466814138
  error estimate for blocks of size 2^( 2) =       0.000492029096
  error estimate for blocks of size 2^( 3) =       0.000515724211
  error estimate for blocks of size 2^( 4) =       0.000533881270
  error estimate for blocks of size 2^( 5) =       0.000544458778
  error estimate for blocks of size 2^( 6) =       0.000550831217
  error estimate for blocks of size 2^( 7) =       0.000554021945

      target function =      -0.747429657927
              le_mean =     -22.814542984845
             les_mean =     520.950861475543
             stat err =       0.000545798303
             autocorr =       1.367024691560
   target nu stat err =       0.000545798303
   target dn stat err =       0.002603234208
      target stat err =       0.002247447213
              std dev =       0.660174885768
             le_variance =       0.435830879798


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281454298484e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747435434723       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747436326973       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747436433415       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747436484674       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747436508654       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747436516066       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747436515850       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747436515509       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747436515601       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747436515406       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 1.513169e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747435434723       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747435658112       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747435684746       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747435697565       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747435703557       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747435705407       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747435705352       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747435705267       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747435705290       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747435705242       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 3.786016e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747435434723       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747435490591       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747435497251       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747435500456       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747435501953       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747435502416       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747435502402       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747435502381       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747435502387       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747435502374       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+02 is 9.466975e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153749 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0410e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.321486e-01 3 1  ON 0
ci_02                -3.190882e-02 3 1  ON 1
ci_03                -3.158651e-02 3 1  ON 2
ci_04                 2.838572e-02 3 1  ON 3
ci_05                -2.372396e-02 3 1  ON 4
ci_06                -2.329237e-02 3 1  ON 5
ci_07                 2.702734e-02 3 1  ON 6
ci_08                -6.695031e-03 3 1  ON 7
ci_09                -9.507602e-03 3 1  ON 8
ci_10                -9.510503e-03 3 1  ON 9
ci_11                 1.312204e-02 3 1  ON 10
ci_12                 7.873734e-03 3 1  ON 11
ci_13                 1.272969e-02 3 1  ON 12
ci_14                 1.306587e-02 3 1  ON 13
ci_15                 7.257228e-03 3 1  ON 14
ci_16                 7.482997e-03 3 1  ON 15
ci_17                -7.783459e-03 3 1  ON 16
ci_18                -7.301061e-03 3 1  ON 17
ci_19                 9.386739e-03 3 1  ON 18
ci_20                 6.907093e-03 3 1  ON 19
ci_21                 8.799165e-03 3 1  ON 20
ci_22                 8.856624e-03 3 1  ON 21
ci_23                 4.972678e-03 3 1  ON 22
ci_24                 4.353894e-03 3 1  ON 23
ci_25                 3.173921e-03 3 1  ON 24
ci_26                 3.226305e-03 3 1  ON 25
ci_27                 3.317360e-03 3 1  ON 26
ci_28                 2.507033e-03 3 1  ON 27
ci_29                 2.129808e-03 3 1  ON 28
ci_30                -1.685846e-03 3 1  ON 29
ci_31                -1.655687e-03 3 1  ON 30
ci_32                -1.414664e-03 3 1  ON 31
ci_33                -1.082257e-03 3 1  ON 32
ci_34                 1.531230e-03 3 1  ON 33
ci_35                 1.264286e-03 3 1  ON 34
ci_36                -1.216062e-03 3 1  ON 35
ci_37                -1.183676e-03 3 1  ON 36
ci_38                -5.121801e-04 3 1  ON 37
ci_39                -6.935141e-04 3 1  ON 38
ci_40                -1.672239e-03 3 1  ON 39
ci_41                -1.488023e-03 3 1  ON 40
ci_42                -1.175032e-03 3 1  ON 41
ci_43                -2.921119e-03 3 1  ON 42
ci_44                -1.753798e-03 3 1  ON 43
ci_45                -7.134485e-04 3 1  ON 44
ci_46                -5.524849e-04 3 1  ON 45
ci_47                 1.182377e-03 3 1  ON 46
ci_48                 6.642520e-04 3 1  ON 47
ci_49                -9.362328e-04 3 1  ON 48
ci_50                -7.130966e-04 3 1  ON 49
ci_51                 4.296559e-04 3 1  ON 50
ci_52                 4.532390e-04 3 1  ON 51
ci_53                -6.086308e-04 3 1  ON 52
ci_54                -9.556754e-04 3 1  ON 53
ci_55                -7.069011e-04 3 1  ON 54
ci_56                 1.903050e-03 3 1  ON 55
ci_57                 1.697339e-03 3 1  ON 56
ci_58                -7.145170e-04 3 1  ON 57
ci_59                -1.015429e-03 3 1  ON 58
ci_60                 5.742654e-04 3 1  ON 59
ci_61                 6.527096e-04 3 1  ON 60
ci_62                -2.611799e-04 3 1  ON 61
ci_63                -5.892071e-04 3 1  ON 62
ci_64                -5.044265e-04 3 1  ON 63
ci_65                -2.750492e-04 3 1  ON 64
ci_66                -6.983774e-04 3 1  ON 65
ci_67                -5.693960e-04 3 1  ON 66
ci_68                -6.061156e-04 3 1  ON 67
ci_69                 2.475089e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7673
    reference variance = 0.357408
====================================================
  Execution time = 2.7171e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5016e-01
  Total weights = 1.9643e+06
  Execution time = 3.4989e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436580652258
                                         uncertainty =       0.002788087366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436580652258
                                         uncertainty =       0.002788087366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467193090
  error estimate for blocks of size 2^( 2) =       0.000492517900
  error estimate for blocks of size 2^( 3) =       0.000515852590
  error estimate for blocks of size 2^( 4) =       0.000533486670
  error estimate for blocks of size 2^( 5) =       0.000544382341
  error estimate for blocks of size 2^( 6) =       0.000550659191
  error estimate for blocks of size 2^( 7) =       0.000555511633

      target function =      -0.745210708009
              le_mean =     -22.815248862574
             les_mean =     520.985742500051
             stat err =       0.000546009959
             autocorr =       1.365866668555
   target nu stat err =       0.000546009959
   target dn stat err =       0.003555785778
      target stat err =       0.003003107509
              std dev =       0.660710803765
             le_variance =       0.436538766211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436579492625
                                         uncertainty =       0.002788246848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436579492625
                                         uncertainty =       0.002788246848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467192475
  error estimate for blocks of size 2^( 2) =       0.000492517759
  error estimate for blocks of size 2^( 3) =       0.000515852864
  error estimate for blocks of size 2^( 4) =       0.000533487287
  error estimate for blocks of size 2^( 5) =       0.000544383085
  error estimate for blocks of size 2^( 6) =       0.000550659863
  error estimate for blocks of size 2^( 7) =       0.000555512342

      target function =      -0.745201318822
              le_mean =     -22.815248898453
             les_mean =     520.985755484572
             stat err =       0.000546010644
             autocorr =       1.365873690109
   target nu stat err =       0.000546010644
   target dn stat err =       0.003556286338
      target stat err =       0.003003439231
              std dev =       0.660709934724
             le_variance =       0.436537617842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436580070117
                                         uncertainty =       0.002788167137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436580070117
                                         uncertainty =       0.002788167137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467192781
  error estimate for blocks of size 2^( 2) =       0.000492517828
  error estimate for blocks of size 2^( 3) =       0.000515852726
  error estimate for blocks of size 2^( 4) =       0.000533486978
  error estimate for blocks of size 2^( 5) =       0.000544382712
  error estimate for blocks of size 2^( 6) =       0.000550659526
  error estimate for blocks of size 2^( 7) =       0.000555511987

      target function =      -0.745206703550
              le_mean =     -22.815248880390
             les_mean =     520.985748152384
             stat err =       0.000546010301
             autocorr =       1.365870184230
   target nu stat err =       0.000546010301
   target dn stat err =       0.003556024065
      target stat err =       0.003003269104
              std dev =       0.660710367493
             le_variance =       0.436538189712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436580579311
                                         uncertainty =       0.002788097335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436580579311
                                         uncertainty =       0.002788097335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467193051
  error estimate for blocks of size 2^( 2) =       0.000492517891
  error estimate for blocks of size 2^( 3) =       0.000515852607
  error estimate for blocks of size 2^( 4) =       0.000533486709
  error estimate for blocks of size 2^( 5) =       0.000544382387
  error estimate for blocks of size 2^( 6) =       0.000550659233
  error estimate for blocks of size 2^( 7) =       0.000555511678

      target function =      -0.745210254968
              le_mean =     -22.815248864784
             les_mean =     520.985743148384
             stat err =       0.000546010002
             autocorr =       1.365867108183
   target nu stat err =       0.000546010002
   target dn stat err =       0.003555814362
      target stat err =       0.003003127110
              std dev =       0.660710749095
             le_variance =       0.436538693970


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745210708009        initial  <--
     2.5000e+01     2.5000e+02             1.5132e-05        -0.745201318822
     1.0000e+02     1.0000e+03             3.7860e-06        -0.745206703550
     4.0000e+02     4.0000e+03             9.4670e-07        -0.745210254968

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7692
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.321524e-01 3 1  ON 0
ci_02                -3.191055e-02 3 1  ON 1
ci_03                -3.158796e-02 3 1  ON 2
ci_04                 2.838715e-02 3 1  ON 3
ci_05                -2.372576e-02 3 1  ON 4
ci_06                -2.329388e-02 3 1  ON 5
ci_07                 2.702790e-02 3 1  ON 6
ci_08                -6.695441e-03 3 1  ON 7
ci_09                -9.508098e-03 3 1  ON 8
ci_10                -9.511427e-03 3 1  ON 9
ci_11                 1.312243e-02 3 1  ON 10
ci_12                 7.874584e-03 3 1  ON 11
ci_13                 1.273008e-02 3 1  ON 12
ci_14                 1.306538e-02 3 1  ON 13
ci_15                 7.257614e-03 3 1  ON 14
ci_16                 7.483857e-03 3 1  ON 15
ci_17                -7.784176e-03 3 1  ON 16
ci_18                -7.300882e-03 3 1  ON 17
ci_19                 9.386651e-03 3 1  ON 18
ci_20                 6.907625e-03 3 1  ON 19
ci_21                 8.798795e-03 3 1  ON 20
ci_22                 8.857190e-03 3 1  ON 21
ci_23                 4.972491e-03 3 1  ON 22
ci_24                 4.354497e-03 3 1  ON 23
ci_25                 3.173958e-03 3 1  ON 24
ci_26                 3.226022e-03 3 1  ON 25
ci_27                 3.316848e-03 3 1  ON 26
ci_28                 2.506859e-03 3 1  ON 27
ci_29                 2.130195e-03 3 1  ON 28
ci_30                -1.685571e-03 3 1  ON 29
ci_31                -1.656307e-03 3 1  ON 30
ci_32                -1.414760e-03 3 1  ON 31
ci_33                -1.081909e-03 3 1  ON 32
ci_34                 1.531167e-03 3 1  ON 33
ci_35                 1.264309e-03 3 1  ON 34
ci_36                -1.216370e-03 3 1  ON 35
ci_37                -1.183641e-03 3 1  ON 36
ci_38                -5.121464e-04 3 1  ON 37
ci_39                -6.938693e-04 3 1  ON 38
ci_40                -1.672419e-03 3 1  ON 39
ci_41                -1.488138e-03 3 1  ON 40
ci_42                -1.174954e-03 3 1  ON 41
ci_43                -2.922087e-03 3 1  ON 42
ci_44                -1.753593e-03 3 1  ON 43
ci_45                -7.135222e-04 3 1  ON 44
ci_46                -5.522095e-04 3 1  ON 45
ci_47                 1.181860e-03 3 1  ON 46
ci_48                 6.637387e-04 3 1  ON 47
ci_49                -9.361731e-04 3 1  ON 48
ci_50                -7.131547e-04 3 1  ON 49
ci_51                 4.295217e-04 3 1  ON 50
ci_52                 4.539599e-04 3 1  ON 51
ci_53                -6.086352e-04 3 1  ON 52
ci_54                -9.553203e-04 3 1  ON 53
ci_55                -7.066673e-04 3 1  ON 54
ci_56                 1.903046e-03 3 1  ON 55
ci_57                 1.697460e-03 3 1  ON 56
ci_58                -7.152720e-04 3 1  ON 57
ci_59                -1.015219e-03 3 1  ON 58
ci_60                 5.743485e-04 3 1  ON 59
ci_61                 6.520697e-04 3 1  ON 60
ci_62                -2.612929e-04 3 1  ON 61
ci_63                -5.890381e-04 3 1  ON 62
ci_64                -5.038800e-04 3 1  ON 63
ci_65                -2.749222e-04 3 1  ON 64
ci_66                -6.985403e-04 3 1  ON 65
ci_67                -5.692147e-04 3 1  ON 66
ci_68                -6.058902e-04 3 1  ON 67
ci_69                 2.486961e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5195e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7855
    reference variance = 0.361591
====================================================
  Execution time = 2.5836e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5328e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4697e-01
  Total weights = 1.964210576e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432956376939
                                         uncertainty =       0.001937264308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432956376939
                                         uncertainty =       0.001937264308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465305939
  error estimate for blocks of size 2^( 2) =       0.000490695299
  error estimate for blocks of size 2^( 3) =       0.000513902436
  error estimate for blocks of size 2^( 4) =       0.000530927199
  error estimate for blocks of size 2^( 5) =       0.000542308383
  error estimate for blocks of size 2^( 6) =       0.000548234327
  error estimate for blocks of size 2^( 7) =       0.000549288556

      target function =      -0.747856492978
              le_mean =     -22.814279928864
             les_mean =     520.938342150690
             stat err =       0.000542689616
             autocorr =       1.360272233029
   target nu stat err =       0.000542689616
   target dn stat err =       0.002817434055
      target stat err =       0.002420228605
              std dev =       0.658041969165
             le_variance =       0.433019233183


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281427992886e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747863340616       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747863429303       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747863444008       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747863445828       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747863446859       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747863447189       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747863447340       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747863447328       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747863447361       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747863447371       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 1.473454e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747863340616       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747863362791       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747863366467       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747863366923       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747863367180       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747863367265       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747863367300       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747863367296       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747863367304       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747863367310       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+03 is 3.683935e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747863340616       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747863346160       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747863347079       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747863347193       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747863347254       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747863347273       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747863347284       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747863347292       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747863347287       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747863347291       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+03 is 9.210025e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157227 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0369e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.321520e-01 3 1  ON 0
ci_02                -3.191036e-02 3 1  ON 1
ci_03                -3.158777e-02 3 1  ON 2
ci_04                 2.838701e-02 3 1  ON 3
ci_05                -2.372561e-02 3 1  ON 4
ci_06                -2.329372e-02 3 1  ON 5
ci_07                 2.702785e-02 3 1  ON 6
ci_08                -6.695332e-03 3 1  ON 7
ci_09                -9.508026e-03 3 1  ON 8
ci_10                -9.511306e-03 3 1  ON 9
ci_11                 1.312245e-02 3 1  ON 10
ci_12                 7.874535e-03 3 1  ON 11
ci_13                 1.273006e-02 3 1  ON 12
ci_14                 1.306542e-02 3 1  ON 13
ci_15                 7.257568e-03 3 1  ON 14
ci_16                 7.483845e-03 3 1  ON 15
ci_17                -7.784174e-03 3 1  ON 16
ci_18                -7.300836e-03 3 1  ON 17
ci_19                 9.386647e-03 3 1  ON 18
ci_20                 6.907552e-03 3 1  ON 19
ci_21                 8.798772e-03 3 1  ON 20
ci_22                 8.857139e-03 3 1  ON 21
ci_23                 4.972509e-03 3 1  ON 22
ci_24                 4.354516e-03 3 1  ON 23
ci_25                 3.173956e-03 3 1  ON 24
ci_26                 3.226047e-03 3 1  ON 25
ci_27                 3.316840e-03 3 1  ON 26
ci_28                 2.506901e-03 3 1  ON 27
ci_29                 2.130220e-03 3 1  ON 28
ci_30                -1.685531e-03 3 1  ON 29
ci_31                -1.656284e-03 3 1  ON 30
ci_32                -1.414721e-03 3 1  ON 31
ci_33                -1.081899e-03 3 1  ON 32
ci_34                 1.531221e-03 3 1  ON 33
ci_35                 1.264304e-03 3 1  ON 34
ci_36                -1.216347e-03 3 1  ON 35
ci_37                -1.183651e-03 3 1  ON 36
ci_38                -5.121579e-04 3 1  ON 37
ci_39                -6.938550e-04 3 1  ON 38
ci_40                -1.672388e-03 3 1  ON 39
ci_41                -1.488123e-03 3 1  ON 40
ci_42                -1.174953e-03 3 1  ON 41
ci_43                -2.922059e-03 3 1  ON 42
ci_44                -1.753631e-03 3 1  ON 43
ci_45                -7.135301e-04 3 1  ON 44
ci_46                -5.521801e-04 3 1  ON 45
ci_47                 1.181906e-03 3 1  ON 46
ci_48                 6.637585e-04 3 1  ON 47
ci_49                -9.361612e-04 3 1  ON 48
ci_50                -7.131549e-04 3 1  ON 49
ci_51                 4.295011e-04 3 1  ON 50
ci_52                 4.539345e-04 3 1  ON 51
ci_53                -6.086474e-04 3 1  ON 52
ci_54                -9.553242e-04 3 1  ON 53
ci_55                -7.066261e-04 3 1  ON 54
ci_56                 1.903013e-03 3 1  ON 55
ci_57                 1.697507e-03 3 1  ON 56
ci_58                -7.152443e-04 3 1  ON 57
ci_59                -1.015209e-03 3 1  ON 58
ci_60                 5.744023e-04 3 1  ON 59
ci_61                 6.520553e-04 3 1  ON 60
ci_62                -2.612731e-04 3 1  ON 61
ci_63                -5.890557e-04 3 1  ON 62
ci_64                -5.038929e-04 3 1  ON 63
ci_65                -2.749455e-04 3 1  ON 64
ci_66                -6.985728e-04 3 1  ON 65
ci_67                -5.691927e-04 3 1  ON 66
ci_68                -6.059203e-04 3 1  ON 67
ci_69                 2.487739e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8789
    reference variance = 0.280537
====================================================
  Execution time = 2.5287e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5386e-01
  Total weights = 1.9639e+06
  Execution time = 3.5038e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440078904559
                                         uncertainty =       0.002330705882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440078904559
                                         uncertainty =       0.002330705882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469116579
  error estimate for blocks of size 2^( 2) =       0.000494506441
  error estimate for blocks of size 2^( 3) =       0.000518101053
  error estimate for blocks of size 2^( 4) =       0.000535849483
  error estimate for blocks of size 2^( 5) =       0.000547339881
  error estimate for blocks of size 2^( 6) =       0.000553915288
  error estimate for blocks of size 2^( 7) =       0.000554289793

      target function =      -0.742167168437
              le_mean =     -22.814382394280
             les_mean =     520.949903606077
             stat err =       0.000547848611
             autocorr =       1.363827889395
   target nu stat err =       0.000547848611
   target dn stat err =       0.003552621588
      target stat err =       0.002973159387
              std dev =       0.663431027926
             le_variance =       0.440140728814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440078594507
                                         uncertainty =       0.002330699140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440078594507
                                         uncertainty =       0.002330699140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469116414
  error estimate for blocks of size 2^( 2) =       0.000494506332
  error estimate for blocks of size 2^( 3) =       0.000518101002
  error estimate for blocks of size 2^( 4) =       0.000535849472
  error estimate for blocks of size 2^( 5) =       0.000547339886
  error estimate for blocks of size 2^( 6) =       0.000553915288
  error estimate for blocks of size 2^( 7) =       0.000554289806

      target function =      -0.742167723237
              le_mean =     -22.814382395307
             les_mean =     520.949902976252
             stat err =       0.000547848613
             autocorr =       1.363828854778
   target nu stat err =       0.000547848613
   target dn stat err =       0.003552568247
      target stat err =       0.002973120951
              std dev =       0.663430795628
             le_variance =       0.440140420587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440078749500
                                         uncertainty =       0.002330702510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440078749500
                                         uncertainty =       0.002330702510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469116497
  error estimate for blocks of size 2^( 2) =       0.000494506386
  error estimate for blocks of size 2^( 3) =       0.000518101027
  error estimate for blocks of size 2^( 4) =       0.000535849478
  error estimate for blocks of size 2^( 5) =       0.000547339883
  error estimate for blocks of size 2^( 6) =       0.000553915288
  error estimate for blocks of size 2^( 7) =       0.000554289799

      target function =      -0.742167446175
              le_mean =     -22.814382394791
             les_mean =     520.949903290656
             stat err =       0.000547848612
             autocorr =       1.363828372159
   target nu stat err =       0.000547848612
   target dn stat err =       0.003552594908
      target stat err =       0.002973140164
              std dev =       0.663430911752
             le_variance =       0.440140574668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440078885175
                                         uncertainty =       0.002330705460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440078885175
                                         uncertainty =       0.002330705460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469116568
  error estimate for blocks of size 2^( 2) =       0.000494506434
  error estimate for blocks of size 2^( 3) =       0.000518101050
  error estimate for blocks of size 2^( 4) =       0.000535849482
  error estimate for blocks of size 2^( 5) =       0.000547339881
  error estimate for blocks of size 2^( 6) =       0.000553915288
  error estimate for blocks of size 2^( 7) =       0.000554289794

      target function =      -0.742167203189
              le_mean =     -22.814382394343
             les_mean =     520.949903566596
             stat err =       0.000547848611
             autocorr =       1.363827949736
   target nu stat err =       0.000547848611
   target dn stat err =       0.003552618252
      target stat err =       0.002973156984
              std dev =       0.663431013402
             le_variance =       0.440140709544


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742167168437        initial
     2.5000e+02     2.5000e+03             1.4735e-06        -0.742167723237  <--
     1.0000e+03     1.0000e+04             3.6839e-07        -0.742167446175
     4.0000e+03     4.0000e+04             9.2100e-08        -0.742167203189

*****************************************************************************
Applying the update for shift_i =   2.5000e+02     and shift_s =   2.5000e+03
*****************************************************************************

  Execution time = 4.2905e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.321509e-01 3 1  ON 0
ci_02                -3.190981e-02 3 1  ON 1
ci_03                -3.158719e-02 3 1  ON 2
ci_04                 2.838658e-02 3 1  ON 3
ci_05                -2.372514e-02 3 1  ON 4
ci_06                -2.329323e-02 3 1  ON 5
ci_07                 2.702770e-02 3 1  ON 6
ci_08                -6.695006e-03 3 1  ON 7
ci_09                -9.507810e-03 3 1  ON 8
ci_10                -9.510941e-03 3 1  ON 9
ci_11                 1.312250e-02 3 1  ON 10
ci_12                 7.874388e-03 3 1  ON 11
ci_13                 1.273000e-02 3 1  ON 12
ci_14                 1.306555e-02 3 1  ON 13
ci_15                 7.257432e-03 3 1  ON 14
ci_16                 7.483809e-03 3 1  ON 15
ci_17                -7.784169e-03 3 1  ON 16
ci_18                -7.300699e-03 3 1  ON 17
ci_19                 9.386632e-03 3 1  ON 18
ci_20                 6.907334e-03 3 1  ON 19
ci_21                 8.798701e-03 3 1  ON 20
ci_22                 8.856989e-03 3 1  ON 21
ci_23                 4.972563e-03 3 1  ON 22
ci_24                 4.354572e-03 3 1  ON 23
ci_25                 3.173950e-03 3 1  ON 24
ci_26                 3.226122e-03 3 1  ON 25
ci_27                 3.316814e-03 3 1  ON 26
ci_28                 2.507027e-03 3 1  ON 27
ci_29                 2.130295e-03 3 1  ON 28
ci_30                -1.685410e-03 3 1  ON 29
ci_31                -1.656212e-03 3 1  ON 30
ci_32                -1.414607e-03 3 1  ON 31
ci_33                -1.081871e-03 3 1  ON 32
ci_34                 1.531381e-03 3 1  ON 33
ci_35                 1.264290e-03 3 1  ON 34
ci_36                -1.216277e-03 3 1  ON 35
ci_37                -1.183681e-03 3 1  ON 36
ci_38                -5.121924e-04 3 1  ON 37
ci_39                -6.938121e-04 3 1  ON 38
ci_40                -1.672296e-03 3 1  ON 39
ci_41                -1.488080e-03 3 1  ON 40
ci_42                -1.174949e-03 3 1  ON 41
ci_43                -2.921975e-03 3 1  ON 42
ci_44                -1.753743e-03 3 1  ON 43
ci_45                -7.135538e-04 3 1  ON 44
ci_46                -5.520921e-04 3 1  ON 45
ci_47                 1.182041e-03 3 1  ON 46
ci_48                 6.638181e-04 3 1  ON 47
ci_49                -9.361253e-04 3 1  ON 48
ci_50                -7.131554e-04 3 1  ON 49
ci_51                 4.294393e-04 3 1  ON 50
ci_52                 4.538585e-04 3 1  ON 51
ci_53                -6.086841e-04 3 1  ON 52
ci_54                -9.553359e-04 3 1  ON 53
ci_55                -7.065025e-04 3 1  ON 54
ci_56                 1.902913e-03 3 1  ON 55
ci_57                 1.697649e-03 3 1  ON 56
ci_58                -7.151614e-04 3 1  ON 57
ci_59                -1.015178e-03 3 1  ON 58
ci_60                 5.745638e-04 3 1  ON 59
ci_61                 6.520121e-04 3 1  ON 60
ci_62                -2.612137e-04 3 1  ON 61
ci_63                -5.891084e-04 3 1  ON 62
ci_64                -5.039316e-04 3 1  ON 63
ci_65                -2.750153e-04 3 1  ON 64
ci_66                -6.986700e-04 3 1  ON 65
ci_67                -5.691268e-04 3 1  ON 66
ci_68                -6.060108e-04 3 1  ON 67
ci_69                 2.490074e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3286e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7254
    reference variance = 0.221275
====================================================
  Execution time = 2.5953e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4926e-01
  Total weights = 1.963851898e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436018815122
                                         uncertainty =       0.001785952216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436018815122
                                         uncertainty =       0.001785952216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466861393
  error estimate for blocks of size 2^( 2) =       0.000492259876
  error estimate for blocks of size 2^( 3) =       0.000516201333
  error estimate for blocks of size 2^( 4) =       0.000533975353
  error estimate for blocks of size 2^( 5) =       0.000543880425
  error estimate for blocks of size 2^( 6) =       0.000550413169
  error estimate for blocks of size 2^( 7) =       0.000553268985

      target function =      -0.745964671880
              le_mean =     -22.815295746409
             les_mean =     520.986978753234
             stat err =       0.000545384483
             autocorr =       1.364676246824
   target nu stat err =       0.000545384483
   target dn stat err =       0.002456228801
      target stat err =       0.002124289946
              std dev =       0.660241713694
             le_variance =       0.435919120502


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281529574641e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745969707213       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745970018806       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745970084871       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745970097248       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745970103585       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745970105147       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745970105806       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745970105822       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745970105699       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 5.246684e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745969707213       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745969785158       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745969801680       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745969804774       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745969806358       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745969806748       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745969806913       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745969806917       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745969806886       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 1.312084e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745969707213       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745969726702       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745969730833       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745969731607       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745969732003       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745969732101       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745969732143       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745969732143       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745969732132       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+03 is 3.280469e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160282 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0465e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.321496e-01 3 1  ON 0
ci_02                -3.190908e-02 3 1  ON 1
ci_03                -3.158627e-02 3 1  ON 2
ci_04                 2.838596e-02 3 1  ON 3
ci_05                -2.372480e-02 3 1  ON 4
ci_06                -2.329301e-02 3 1  ON 5
ci_07                 2.702758e-02 3 1  ON 6
ci_08                -6.694547e-03 3 1  ON 7
ci_09                -9.507532e-03 3 1  ON 8
ci_10                -9.510836e-03 3 1  ON 9
ci_11                 1.312243e-02 3 1  ON 10
ci_12                 7.874344e-03 3 1  ON 11
ci_13                 1.273010e-02 3 1  ON 12
ci_14                 1.306550e-02 3 1  ON 13
ci_15                 7.257271e-03 3 1  ON 14
ci_16                 7.483707e-03 3 1  ON 15
ci_17                -7.783756e-03 3 1  ON 16
ci_18                -7.300415e-03 3 1  ON 17
ci_19                 9.386600e-03 3 1  ON 18
ci_20                 6.907213e-03 3 1  ON 19
ci_21                 8.798711e-03 3 1  ON 20
ci_22                 8.857033e-03 3 1  ON 21
ci_23                 4.972663e-03 3 1  ON 22
ci_24                 4.354570e-03 3 1  ON 23
ci_25                 3.173884e-03 3 1  ON 24
ci_26                 3.225979e-03 3 1  ON 25
ci_27                 3.316813e-03 3 1  ON 26
ci_28                 2.506854e-03 3 1  ON 27
ci_29                 2.130281e-03 3 1  ON 28
ci_30                -1.684935e-03 3 1  ON 29
ci_31                -1.655936e-03 3 1  ON 30
ci_32                -1.414467e-03 3 1  ON 31
ci_33                -1.081725e-03 3 1  ON 32
ci_34                 1.531397e-03 3 1  ON 33
ci_35                 1.264377e-03 3 1  ON 34
ci_36                -1.216252e-03 3 1  ON 35
ci_37                -1.183593e-03 3 1  ON 36
ci_38                -5.122439e-04 3 1  ON 37
ci_39                -6.938762e-04 3 1  ON 38
ci_40                -1.672225e-03 3 1  ON 39
ci_41                -1.487917e-03 3 1  ON 40
ci_42                -1.174953e-03 3 1  ON 41
ci_43                -2.922014e-03 3 1  ON 42
ci_44                -1.753849e-03 3 1  ON 43
ci_45                -7.135455e-04 3 1  ON 44
ci_46                -5.519734e-04 3 1  ON 45
ci_47                 1.182235e-03 3 1  ON 46
ci_48                 6.641535e-04 3 1  ON 47
ci_49                -9.362049e-04 3 1  ON 48
ci_50                -7.131605e-04 3 1  ON 49
ci_51                 4.295362e-04 3 1  ON 50
ci_52                 4.537564e-04 3 1  ON 51
ci_53                -6.087711e-04 3 1  ON 52
ci_54                -9.552762e-04 3 1  ON 53
ci_55                -7.064244e-04 3 1  ON 54
ci_56                 1.902836e-03 3 1  ON 55
ci_57                 1.697902e-03 3 1  ON 56
ci_58                -7.151092e-04 3 1  ON 57
ci_59                -1.015141e-03 3 1  ON 58
ci_60                 5.745708e-04 3 1  ON 59
ci_61                 6.519667e-04 3 1  ON 60
ci_62                -2.613597e-04 3 1  ON 61
ci_63                -5.891844e-04 3 1  ON 62
ci_64                -5.038864e-04 3 1  ON 63
ci_65                -2.750198e-04 3 1  ON 64
ci_66                -6.986105e-04 3 1  ON 65
ci_67                -5.691108e-04 3 1  ON 66
ci_68                -6.061635e-04 3 1  ON 67
ci_69                 2.479116e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.8303
    reference variance = 0.500982
====================================================
  Execution time = 2.5175e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4854e-01
  Total weights = 1.9642e+06
  Execution time = 3.4892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434659052689
                                         uncertainty =       0.002085939147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434659052689
                                         uncertainty =       0.002085939147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466179600
  error estimate for blocks of size 2^( 2) =       0.000491229372
  error estimate for blocks of size 2^( 3) =       0.000514657063
  error estimate for blocks of size 2^( 4) =       0.000531501334
  error estimate for blocks of size 2^( 5) =       0.000541745581
  error estimate for blocks of size 2^( 6) =       0.000548443641
  error estimate for blocks of size 2^( 7) =       0.000551274254

      target function =      -0.746556360938
              le_mean =     -22.814804994898
             les_mean =     520.963866274225
             stat err =       0.000543241202
             autocorr =       1.357934658741
   target nu stat err =       0.000543241202
   target dn stat err =       0.003163401733
      target stat err =       0.002692989416
              std dev =       0.659277513403
             le_variance =       0.434646839679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434657757818
                                         uncertainty =       0.002085881399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434657757818
                                         uncertainty =       0.002085881399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466178907
  error estimate for blocks of size 2^( 2) =       0.000491228884
  error estimate for blocks of size 2^( 3) =       0.000514656790
  error estimate for blocks of size 2^( 4) =       0.000531501235
  error estimate for blocks of size 2^( 5) =       0.000541745590
  error estimate for blocks of size 2^( 6) =       0.000548443669
  error estimate for blocks of size 2^( 7) =       0.000551274359

      target function =      -0.746556781851
              le_mean =     -22.814804986586
             les_mean =     520.963865383520
             stat err =       0.000543241213
             autocorr =       1.357938753299
   target nu stat err =       0.000543241213
   target dn stat err =       0.003164010844
      target stat err =       0.002693484836
              std dev =       0.659276532661
             le_variance =       0.434645546518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434658404714
                                         uncertainty =       0.002085910253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434658404714
                                         uncertainty =       0.002085910253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466179253
  error estimate for blocks of size 2^( 2) =       0.000491229128
  error estimate for blocks of size 2^( 3) =       0.000514656926
  error estimate for blocks of size 2^( 4) =       0.000531501284
  error estimate for blocks of size 2^( 5) =       0.000541745585
  error estimate for blocks of size 2^( 6) =       0.000548443655
  error estimate for blocks of size 2^( 7) =       0.000551274307

      target function =      -0.746556590461
              le_mean =     -22.814804990715
             les_mean =     520.963865804655
             stat err =       0.000543241208
             autocorr =       1.357936707158
   target nu stat err =       0.000543241208
   target dn stat err =       0.003163704277
      target stat err =       0.002693235633
              std dev =       0.659277022624
             le_variance =       0.434646192560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434658971660
                                         uncertainty =       0.002085935534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434658971660
                                         uncertainty =       0.002085935534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466179557
  error estimate for blocks of size 2^( 2) =       0.000491229341
  error estimate for blocks of size 2^( 3) =       0.000514657046
  error estimate for blocks of size 2^( 4) =       0.000531501327
  error estimate for blocks of size 2^( 5) =       0.000541745581
  error estimate for blocks of size 2^( 6) =       0.000548443643
  error estimate for blocks of size 2^( 7) =       0.000551274261

      target function =      -0.746556391748
              le_mean =     -22.814804994372
             les_mean =     520.963866212851
             stat err =       0.000543241203
             autocorr =       1.357934914826
   target nu stat err =       0.000543241203
   target dn stat err =       0.003163439313
      target stat err =       0.002693020016
              std dev =       0.659277452031
             le_variance =       0.434646758757


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746556360938        initial
     6.2500e+01     6.2500e+02             5.2467e-06        -0.746556781851  <--
     2.5000e+02     2.5000e+03             1.3121e-06        -0.746556590461
     1.0000e+03     1.0000e+04             3.2805e-07        -0.746556391748

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 4.2684e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.321456e-01 3 1  ON 0
ci_02                -3.190689e-02 3 1  ON 1
ci_03                -3.158352e-02 3 1  ON 2
ci_04                 2.838409e-02 3 1  ON 3
ci_05                -2.372380e-02 3 1  ON 4
ci_06                -2.329233e-02 3 1  ON 5
ci_07                 2.702721e-02 3 1  ON 6
ci_08                -6.693169e-03 3 1  ON 7
ci_09                -9.506698e-03 3 1  ON 8
ci_10                -9.510524e-03 3 1  ON 9
ci_11                 1.312220e-02 3 1  ON 10
ci_12                 7.874214e-03 3 1  ON 11
ci_13                 1.273041e-02 3 1  ON 12
ci_14                 1.306535e-02 3 1  ON 13
ci_15                 7.256787e-03 3 1  ON 14
ci_16                 7.483404e-03 3 1  ON 15
ci_17                -7.782520e-03 3 1  ON 16
ci_18                -7.299564e-03 3 1  ON 17
ci_19                 9.386505e-03 3 1  ON 18
ci_20                 6.906850e-03 3 1  ON 19
ci_21                 8.798740e-03 3 1  ON 20
ci_22                 8.857165e-03 3 1  ON 21
ci_23                 4.972964e-03 3 1  ON 22
ci_24                 4.354565e-03 3 1  ON 23
ci_25                 3.173684e-03 3 1  ON 24
ci_26                 3.225547e-03 3 1  ON 25
ci_27                 3.316808e-03 3 1  ON 26
ci_28                 2.506335e-03 3 1  ON 27
ci_29                 2.130239e-03 3 1  ON 28
ci_30                -1.683513e-03 3 1  ON 29
ci_31                -1.655107e-03 3 1  ON 30
ci_32                -1.414049e-03 3 1  ON 31
ci_33                -1.081288e-03 3 1  ON 32
ci_34                 1.531444e-03 3 1  ON 33
ci_35                 1.264637e-03 3 1  ON 34
ci_36                -1.216176e-03 3 1  ON 35
ci_37                -1.183329e-03 3 1  ON 36
ci_38                -5.123986e-04 3 1  ON 37
ci_39                -6.940684e-04 3 1  ON 38
ci_40                -1.672012e-03 3 1  ON 39
ci_41                -1.487428e-03 3 1  ON 40
ci_42                -1.174965e-03 3 1  ON 41
ci_43                -2.922132e-03 3 1  ON 42
ci_44                -1.754166e-03 3 1  ON 43
ci_45                -7.135207e-04 3 1  ON 44
ci_46                -5.516175e-04 3 1  ON 45
ci_47                 1.182817e-03 3 1  ON 46
ci_48                 6.651590e-04 3 1  ON 47
ci_49                -9.364435e-04 3 1  ON 48
ci_50                -7.131755e-04 3 1  ON 49
ci_51                 4.298263e-04 3 1  ON 50
ci_52                 4.534506e-04 3 1  ON 51
ci_53                -6.090318e-04 3 1  ON 52
ci_54                -9.550973e-04 3 1  ON 53
ci_55                -7.061903e-04 3 1  ON 54
ci_56                 1.902607e-03 3 1  ON 55
ci_57                 1.698661e-03 3 1  ON 56
ci_58                -7.149529e-04 3 1  ON 57
ci_59                -1.015030e-03 3 1  ON 58
ci_60                 5.745918e-04 3 1  ON 59
ci_61                 6.518305e-04 3 1  ON 60
ci_62                -2.617973e-04 3 1  ON 61
ci_63                -5.894121e-04 3 1  ON 62
ci_64                -5.037507e-04 3 1  ON 63
ci_65                -2.750330e-04 3 1  ON 64
ci_66                -6.984323e-04 3 1  ON 65
ci_67                -5.690630e-04 3 1  ON 66
ci_68                -6.066213e-04 3 1  ON 67
ci_69                 2.446264e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3156e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8526
    reference variance = 0.373955
====================================================
  Execution time = 2.5885e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4382e-01
  Total weights = 1.964224199e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432218074655
                                         uncertainty =       0.001607913559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432218074655
                                         uncertainty =       0.001607913559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464947962
  error estimate for blocks of size 2^( 2) =       0.000490779754
  error estimate for blocks of size 2^( 3) =       0.000514879512
  error estimate for blocks of size 2^( 4) =       0.000532418307
  error estimate for blocks of size 2^( 5) =       0.000542622469
  error estimate for blocks of size 2^( 6) =       0.000548483805
  error estimate for blocks of size 2^( 7) =       0.000552457430

      target function =      -0.750486022612
              le_mean =     -22.814219787033
             les_mean =     520.932449417225
             stat err =       0.000543995503
             autocorr =       1.368932146086
   target nu stat err =       0.000543995503
   target dn stat err =       0.002446776124
      target stat err =       0.002137596419
              std dev =       0.657535713679
             le_variance =       0.432353214763


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281421978703e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750491139349       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750492761789       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750493000089       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750493056697       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750493076033       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750493079190       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750493079498       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750493078338       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750493077930       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750493078120       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 2.406976e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750491139349       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750491545909       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750491605569       residual = 8.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750491619724       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750491624553       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750491625337       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750491625413       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750491625123       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750491625022       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750491625069       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 6.025256e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750491139349       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750491241049       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750491255969       residual = 8.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750491259508       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750491260715       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750491260911       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750491260929       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750491260857       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750491260832       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750491260843       residual = 2.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 1.506803e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163737 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0427e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.321396e-01 3 1  ON 0
ci_02                -3.190343e-02 3 1  ON 1
ci_03                -3.158015e-02 3 1  ON 2
ci_04                 2.838096e-02 3 1  ON 3
ci_05                -2.372076e-02 3 1  ON 4
ci_06                -2.329133e-02 3 1  ON 5
ci_07                 2.702576e-02 3 1  ON 6
ci_08                -6.692178e-03 3 1  ON 7
ci_09                -9.505144e-03 3 1  ON 8
ci_10                -9.511087e-03 3 1  ON 9
ci_11                 1.312235e-02 3 1  ON 10
ci_12                 7.873238e-03 3 1  ON 11
ci_13                 1.273008e-02 3 1  ON 12
ci_14                 1.306518e-02 3 1  ON 13
ci_15                 7.255072e-03 3 1  ON 14
ci_16                 7.482453e-03 3 1  ON 15
ci_17                -7.781680e-03 3 1  ON 16
ci_18                -7.298134e-03 3 1  ON 17
ci_19                 9.386312e-03 3 1  ON 18
ci_20                 6.906184e-03 3 1  ON 19
ci_21                 8.798339e-03 3 1  ON 20
ci_22                 8.855700e-03 3 1  ON 21
ci_23                 4.972509e-03 3 1  ON 22
ci_24                 4.354487e-03 3 1  ON 23
ci_25                 3.173489e-03 3 1  ON 24
ci_26                 3.225726e-03 3 1  ON 25
ci_27                 3.316247e-03 3 1  ON 26
ci_28                 2.505763e-03 3 1  ON 27
ci_29                 2.130134e-03 3 1  ON 28
ci_30                -1.683048e-03 3 1  ON 29
ci_31                -1.655146e-03 3 1  ON 30
ci_32                -1.414448e-03 3 1  ON 31
ci_33                -1.081738e-03 3 1  ON 32
ci_34                 1.531781e-03 3 1  ON 33
ci_35                 1.265998e-03 3 1  ON 34
ci_36                -1.215497e-03 3 1  ON 35
ci_37                -1.183307e-03 3 1  ON 36
ci_38                -5.120938e-04 3 1  ON 37
ci_39                -6.940155e-04 3 1  ON 38
ci_40                -1.671423e-03 3 1  ON 39
ci_41                -1.487591e-03 3 1  ON 40
ci_42                -1.175185e-03 3 1  ON 41
ci_43                -2.921570e-03 3 1  ON 42
ci_44                -1.755139e-03 3 1  ON 43
ci_45                -7.133559e-04 3 1  ON 44
ci_46                -5.517607e-04 3 1  ON 45
ci_47                 1.183481e-03 3 1  ON 46
ci_48                 6.649449e-04 3 1  ON 47
ci_49                -9.366880e-04 3 1  ON 48
ci_50                -7.131708e-04 3 1  ON 49
ci_51                 4.298024e-04 3 1  ON 50
ci_52                 4.532772e-04 3 1  ON 51
ci_53                -6.087562e-04 3 1  ON 52
ci_54                -9.550826e-04 3 1  ON 53
ci_55                -7.064038e-04 3 1  ON 54
ci_56                 1.902740e-03 3 1  ON 55
ci_57                 1.699364e-03 3 1  ON 56
ci_58                -7.155716e-04 3 1  ON 57
ci_59                -1.015561e-03 3 1  ON 58
ci_60                 5.745091e-04 3 1  ON 59
ci_61                 6.516251e-04 3 1  ON 60
ci_62                -2.619560e-04 3 1  ON 61
ci_63                -5.897274e-04 3 1  ON 62
ci_64                -5.024526e-04 3 1  ON 63
ci_65                -2.743102e-04 3 1  ON 64
ci_66                -6.987413e-04 3 1  ON 65
ci_67                -5.693593e-04 3 1  ON 66
ci_68                -6.057871e-04 3 1  ON 67
ci_69                 2.384918e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8427
    reference variance = 0.352605
====================================================
  Execution time = 2.5295e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4693e-01
  Total weights = 1.9644e+06
  Execution time = 3.5087e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434029284219
                                         uncertainty =       0.001908061411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434029284219
                                         uncertainty =       0.001908061411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465983730
  error estimate for blocks of size 2^( 2) =       0.000491235385
  error estimate for blocks of size 2^( 3) =       0.000515410430
  error estimate for blocks of size 2^( 4) =       0.000533649603
  error estimate for blocks of size 2^( 5) =       0.000544810604
  error estimate for blocks of size 2^( 6) =       0.000553316145
  error estimate for blocks of size 2^( 7) =       0.000556813502

      target function =      -0.747893070501
              le_mean =     -22.814164817648
             les_mean =     520.933046825769
             stat err =       0.000547147464
             autocorr =       1.378692058987
   target nu stat err =       0.000547147464
   target dn stat err =       0.002491237880
      target stat err =       0.002159733894
              std dev =       0.659000510514
             le_variance =       0.434281672857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434025787345
                                         uncertainty =       0.001907980858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434025787345
                                         uncertainty =       0.001907980858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465981851
  error estimate for blocks of size 2^( 2) =       0.000491234390
  error estimate for blocks of size 2^( 3) =       0.000515410281
  error estimate for blocks of size 2^( 4) =       0.000533650059
  error estimate for blocks of size 2^( 5) =       0.000544811167
  error estimate for blocks of size 2^( 6) =       0.000553316706
  error estimate for blocks of size 2^( 7) =       0.000556814450

      target function =      -0.747881302238
              le_mean =     -22.814164851812
             les_mean =     520.933062523216
             stat err =       0.000547148096
             autocorr =       1.378706362076
   target nu stat err =       0.000547148096
   target dn stat err =       0.002493016155
      target stat err =       0.002161088199
              std dev =       0.658997853458
             le_variance =       0.434278170862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434027528560
                                         uncertainty =       0.001908020922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434027528560
                                         uncertainty =       0.001908020922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465982787
  error estimate for blocks of size 2^( 2) =       0.000491234885
  error estimate for blocks of size 2^( 3) =       0.000515410354
  error estimate for blocks of size 2^( 4) =       0.000533649830
  error estimate for blocks of size 2^( 5) =       0.000544810884
  error estimate for blocks of size 2^( 6) =       0.000553316424
  error estimate for blocks of size 2^( 7) =       0.000556813975

      target function =      -0.747888165472
              le_mean =     -22.814164833934
             les_mean =     520.933053461519
             stat err =       0.000547147778
             autocorr =       1.378699226791
   target nu stat err =       0.000547147778
   target dn stat err =       0.002492036780
      target stat err =       0.002160344456
              std dev =       0.658999176503
             le_variance =       0.434279914631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434029064254
                                         uncertainty =       0.001908056335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434029064254
                                         uncertainty =       0.001908056335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465983612
  error estimate for blocks of size 2^( 2) =       0.000491235322
  error estimate for blocks of size 2^( 3) =       0.000515410420
  error estimate for blocks of size 2^( 4) =       0.000533649631
  error estimate for blocks of size 2^( 5) =       0.000544810639
  error estimate for blocks of size 2^( 6) =       0.000553316180
  error estimate for blocks of size 2^( 7) =       0.000556813561

      target function =      -0.747892565237
              le_mean =     -22.814164819595
             les_mean =     520.933047521541
             stat err =       0.000547147503
             autocorr =       1.378692955570
   target nu stat err =       0.000547147503
   target dn stat err =       0.002491328966
      target stat err =       0.002159803807
              std dev =       0.659000343377
             le_variance =       0.434281452571


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747893070501        initial  <--
     1.5625e+01     1.5625e+02             2.4070e-05        -0.747881302238
     6.2500e+01     6.2500e+02             6.0253e-06        -0.747888165472
     2.5000e+02     2.5000e+03             1.5068e-06        -0.747892565237

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9332
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.321456e-01 3 1  ON 0
ci_02                -3.190689e-02 3 1  ON 1
ci_03                -3.158352e-02 3 1  ON 2
ci_04                 2.838409e-02 3 1  ON 3
ci_05                -2.372380e-02 3 1  ON 4
ci_06                -2.329233e-02 3 1  ON 5
ci_07                 2.702721e-02 3 1  ON 6
ci_08                -6.693169e-03 3 1  ON 7
ci_09                -9.506698e-03 3 1  ON 8
ci_10                -9.510524e-03 3 1  ON 9
ci_11                 1.312220e-02 3 1  ON 10
ci_12                 7.874214e-03 3 1  ON 11
ci_13                 1.273041e-02 3 1  ON 12
ci_14                 1.306535e-02 3 1  ON 13
ci_15                 7.256787e-03 3 1  ON 14
ci_16                 7.483404e-03 3 1  ON 15
ci_17                -7.782520e-03 3 1  ON 16
ci_18                -7.299564e-03 3 1  ON 17
ci_19                 9.386505e-03 3 1  ON 18
ci_20                 6.906850e-03 3 1  ON 19
ci_21                 8.798740e-03 3 1  ON 20
ci_22                 8.857165e-03 3 1  ON 21
ci_23                 4.972964e-03 3 1  ON 22
ci_24                 4.354565e-03 3 1  ON 23
ci_25                 3.173684e-03 3 1  ON 24
ci_26                 3.225547e-03 3 1  ON 25
ci_27                 3.316808e-03 3 1  ON 26
ci_28                 2.506335e-03 3 1  ON 27
ci_29                 2.130239e-03 3 1  ON 28
ci_30                -1.683513e-03 3 1  ON 29
ci_31                -1.655107e-03 3 1  ON 30
ci_32                -1.414049e-03 3 1  ON 31
ci_33                -1.081288e-03 3 1  ON 32
ci_34                 1.531444e-03 3 1  ON 33
ci_35                 1.264637e-03 3 1  ON 34
ci_36                -1.216176e-03 3 1  ON 35
ci_37                -1.183329e-03 3 1  ON 36
ci_38                -5.123986e-04 3 1  ON 37
ci_39                -6.940684e-04 3 1  ON 38
ci_40                -1.672012e-03 3 1  ON 39
ci_41                -1.487428e-03 3 1  ON 40
ci_42                -1.174965e-03 3 1  ON 41
ci_43                -2.922132e-03 3 1  ON 42
ci_44                -1.754166e-03 3 1  ON 43
ci_45                -7.135207e-04 3 1  ON 44
ci_46                -5.516175e-04 3 1  ON 45
ci_47                 1.182817e-03 3 1  ON 46
ci_48                 6.651590e-04 3 1  ON 47
ci_49                -9.364435e-04 3 1  ON 48
ci_50                -7.131755e-04 3 1  ON 49
ci_51                 4.298263e-04 3 1  ON 50
ci_52                 4.534506e-04 3 1  ON 51
ci_53                -6.090318e-04 3 1  ON 52
ci_54                -9.550973e-04 3 1  ON 53
ci_55                -7.061903e-04 3 1  ON 54
ci_56                 1.902607e-03 3 1  ON 55
ci_57                 1.698661e-03 3 1  ON 56
ci_58                -7.149529e-04 3 1  ON 57
ci_59                -1.015030e-03 3 1  ON 58
ci_60                 5.745918e-04 3 1  ON 59
ci_61                 6.518305e-04 3 1  ON 60
ci_62                -2.617973e-04 3 1  ON 61
ci_63                -5.894121e-04 3 1  ON 62
ci_64                -5.037507e-04 3 1  ON 63
ci_65                -2.750330e-04 3 1  ON 64
ci_66                -6.984323e-04 3 1  ON 65
ci_67                -5.690630e-04 3 1  ON 66
ci_68                -6.066213e-04 3 1  ON 67
ci_69                 2.446264e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3366e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8322
    reference variance = 0.673764
====================================================
  Execution time = 2.6002e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5353e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5035e-01
  Total weights = 1.964434609e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5121e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437001641766
                                         uncertainty =       0.002091172830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437001641766
                                         uncertainty =       0.002091172830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467464218
  error estimate for blocks of size 2^( 2) =       0.000492619127
  error estimate for blocks of size 2^( 3) =       0.000516516551
  error estimate for blocks of size 2^( 4) =       0.000533936419
  error estimate for blocks of size 2^( 5) =       0.000545068814
  error estimate for blocks of size 2^( 6) =       0.000552084697
  error estimate for blocks of size 2^( 7) =       0.000551426031

      target function =      -0.745056960645
              le_mean =     -22.815030918807
             les_mean =     520.975987606773
             stat err =       0.000545628990
             autocorr =       1.362379586903
   target nu stat err =       0.000545628990
   target dn stat err =       0.002984243491
      target stat err =       0.002539896389
              std dev =       0.661094236801
             le_variance =       0.437045589931


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281503091881e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745064613220       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745064780122       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745064797111       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745064803868       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745064805726       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745064806732       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745064806583       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745064806597       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745064806557       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 2.084805e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745064613220       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745064654956       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745064659204       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745064660893       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745064661357       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745064661609       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745064661573       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745064661575       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745064661566       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 5.212697e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745064613220       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745064623655       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745064624717       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745064625139       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745064625257       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745064625316       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745064625311       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745064625308       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745064625309       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 1.303217e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166784 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0523e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.321451e-01 3 1  ON 0
ci_02                -3.190672e-02 3 1  ON 1
ci_03                -3.158322e-02 3 1  ON 2
ci_04                 2.838380e-02 3 1  ON 3
ci_05                -2.372334e-02 3 1  ON 4
ci_06                -2.329218e-02 3 1  ON 5
ci_07                 2.702720e-02 3 1  ON 6
ci_08                -6.693074e-03 3 1  ON 7
ci_09                -9.506587e-03 3 1  ON 8
ci_10                -9.510487e-03 3 1  ON 9
ci_11                 1.312225e-02 3 1  ON 10
ci_12                 7.874131e-03 3 1  ON 11
ci_13                 1.273041e-02 3 1  ON 12
ci_14                 1.306538e-02 3 1  ON 13
ci_15                 7.256709e-03 3 1  ON 14
ci_16                 7.483321e-03 3 1  ON 15
ci_17                -7.782618e-03 3 1  ON 16
ci_18                -7.299331e-03 3 1  ON 17
ci_19                 9.386526e-03 3 1  ON 18
ci_20                 6.906708e-03 3 1  ON 19
ci_21                 8.798746e-03 3 1  ON 20
ci_22                 8.857118e-03 3 1  ON 21
ci_23                 4.972901e-03 3 1  ON 22
ci_24                 4.354710e-03 3 1  ON 23
ci_25                 3.173724e-03 3 1  ON 24
ci_26                 3.225410e-03 3 1  ON 25
ci_27                 3.316796e-03 3 1  ON 26
ci_28                 2.506244e-03 3 1  ON 27
ci_29                 2.130177e-03 3 1  ON 28
ci_30                -1.683461e-03 3 1  ON 29
ci_31                -1.655024e-03 3 1  ON 30
ci_32                -1.414034e-03 3 1  ON 31
ci_33                -1.081241e-03 3 1  ON 32
ci_34                 1.531476e-03 3 1  ON 33
ci_35                 1.264552e-03 3 1  ON 34
ci_36                -1.216169e-03 3 1  ON 35
ci_37                -1.183331e-03 3 1  ON 36
ci_38                -5.124759e-04 3 1  ON 37
ci_39                -6.940634e-04 3 1  ON 38
ci_40                -1.671970e-03 3 1  ON 39
ci_41                -1.487470e-03 3 1  ON 40
ci_42                -1.175041e-03 3 1  ON 41
ci_43                -2.922073e-03 3 1  ON 42
ci_44                -1.754164e-03 3 1  ON 43
ci_45                -7.134958e-04 3 1  ON 44
ci_46                -5.516316e-04 3 1  ON 45
ci_47                 1.182848e-03 3 1  ON 46
ci_48                 6.651673e-04 3 1  ON 47
ci_49                -9.364152e-04 3 1  ON 48
ci_50                -7.131367e-04 3 1  ON 49
ci_51                 4.298555e-04 3 1  ON 50
ci_52                 4.533814e-04 3 1  ON 51
ci_53                -6.090290e-04 3 1  ON 52
ci_54                -9.550856e-04 3 1  ON 53
ci_55                -7.062551e-04 3 1  ON 54
ci_56                 1.902605e-03 3 1  ON 55
ci_57                 1.698670e-03 3 1  ON 56
ci_58                -7.148528e-04 3 1  ON 57
ci_59                -1.014958e-03 3 1  ON 58
ci_60                 5.745733e-04 3 1  ON 59
ci_61                 6.517694e-04 3 1  ON 60
ci_62                -2.617457e-04 3 1  ON 61
ci_63                -5.893442e-04 3 1  ON 62
ci_64                -5.037192e-04 3 1  ON 63
ci_65                -2.751435e-04 3 1  ON 64
ci_66                -6.983883e-04 3 1  ON 65
ci_67                -5.691110e-04 3 1  ON 66
ci_68                -6.067095e-04 3 1  ON 67
ci_69                 2.443609e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7706
    reference variance = 0.604065
====================================================
  Execution time = 2.5769e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4898e-01
  Total weights = 1.9641e+06
  Execution time = 3.9623e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434667958563
                                         uncertainty =       0.001754886433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434667958563
                                         uncertainty =       0.001754886433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466287556
  error estimate for blocks of size 2^( 2) =       0.000491661207
  error estimate for blocks of size 2^( 3) =       0.000515521601
  error estimate for blocks of size 2^( 4) =       0.000534187212
  error estimate for blocks of size 2^( 5) =       0.000544264955
  error estimate for blocks of size 2^( 6) =       0.000551020461
  error estimate for blocks of size 2^( 7) =       0.000556871985

      target function =      -0.746187857303
              le_mean =     -22.813956010728
             les_mean =     520.925571510273
             stat err =       0.000546586153
             autocorr =       1.374072346527
   target nu stat err =       0.000546586153
   target dn stat err =       0.002768156604
      target stat err =       0.002370243254
              std dev =       0.659430186208
             le_variance =       0.434848170483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434667542553
                                         uncertainty =       0.001754876399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434667542553
                                         uncertainty =       0.001754876399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466287335
  error estimate for blocks of size 2^( 2) =       0.000491661071
  error estimate for blocks of size 2^( 3) =       0.000515521548
  error estimate for blocks of size 2^( 4) =       0.000534187233
  error estimate for blocks of size 2^( 5) =       0.000544265029
  error estimate for blocks of size 2^( 6) =       0.000551020585
  error estimate for blocks of size 2^( 7) =       0.000556872130

      target function =      -0.746189290860
              le_mean =     -22.813956020405
             les_mean =     520.925570220553
             stat err =       0.000546586244
             autocorr =       1.374074106892
   target nu stat err =       0.000546586244
   target dn stat err =       0.002768062141
      target stat err =       0.002370176530
              std dev =       0.659429873562
             le_variance =       0.434847758147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434667750477
                                         uncertainty =       0.001754881414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434667750477
                                         uncertainty =       0.001754881414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466287446
  error estimate for blocks of size 2^( 2) =       0.000491661139
  error estimate for blocks of size 2^( 3) =       0.000515521574
  error estimate for blocks of size 2^( 4) =       0.000534187223
  error estimate for blocks of size 2^( 5) =       0.000544264992
  error estimate for blocks of size 2^( 6) =       0.000551020523
  error estimate for blocks of size 2^( 7) =       0.000556872058

      target function =      -0.746188596714
              le_mean =     -22.813956015560
             les_mean =     520.925570837793
             stat err =       0.000546586199
             autocorr =       1.374073226897
   target nu stat err =       0.000546586199
   target dn stat err =       0.002768109202
      target stat err =       0.002370209894
              std dev =       0.659430029824
             le_variance =       0.434847964234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434667932546
                                         uncertainty =       0.001754885805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434667932546
                                         uncertainty =       0.001754885805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466287543
  error estimate for blocks of size 2^( 2) =       0.000491661199
  error estimate for blocks of size 2^( 3) =       0.000515521598
  error estimate for blocks of size 2^( 4) =       0.000534187213
  error estimate for blocks of size 2^( 5) =       0.000544264960
  error estimate for blocks of size 2^( 6) =       0.000551020469
  error estimate for blocks of size 2^( 7) =       0.000556871994

      target function =      -0.746187953142
              le_mean =     -22.813956011331
             les_mean =     520.925571422055
             stat err =       0.000546586159
             autocorr =       1.374072456575
   target nu stat err =       0.000546586159
   target dn stat err =       0.002768150662
      target stat err =       0.002370239091
              std dev =       0.659430166656
             le_variance =       0.434848144696


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746187857303        initial
     1.5625e+02     1.5625e+03             2.0848e-06        -0.746189290860  <--
     6.2500e+02     6.2500e+03             5.2127e-07        -0.746188596714
     2.5000e+03     2.5000e+04             1.3032e-07        -0.746187953142

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 4.3852e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.321436e-01 3 1  ON 0
ci_02                -3.190618e-02 3 1  ON 1
ci_03                -3.158232e-02 3 1  ON 2
ci_04                 2.838295e-02 3 1  ON 3
ci_05                -2.372197e-02 3 1  ON 4
ci_06                -2.329171e-02 3 1  ON 5
ci_07                 2.702714e-02 3 1  ON 6
ci_08                -6.692792e-03 3 1  ON 7
ci_09                -9.506253e-03 3 1  ON 8
ci_10                -9.510379e-03 3 1  ON 9
ci_11                 1.312239e-02 3 1  ON 10
ci_12                 7.873882e-03 3 1  ON 11
ci_13                 1.273043e-02 3 1  ON 12
ci_14                 1.306548e-02 3 1  ON 13
ci_15                 7.256476e-03 3 1  ON 14
ci_16                 7.483072e-03 3 1  ON 15
ci_17                -7.782911e-03 3 1  ON 16
ci_18                -7.298633e-03 3 1  ON 17
ci_19                 9.386591e-03 3 1  ON 18
ci_20                 6.906281e-03 3 1  ON 19
ci_21                 8.798763e-03 3 1  ON 20
ci_22                 8.856978e-03 3 1  ON 21
ci_23                 4.972712e-03 3 1  ON 22
ci_24                 4.355146e-03 3 1  ON 23
ci_25                 3.173843e-03 3 1  ON 24
ci_26                 3.224997e-03 3 1  ON 25
ci_27                 3.316759e-03 3 1  ON 26
ci_28                 2.505970e-03 3 1  ON 27
ci_29                 2.129992e-03 3 1  ON 28
ci_30                -1.683306e-03 3 1  ON 29
ci_31                -1.654774e-03 3 1  ON 30
ci_32                -1.413992e-03 3 1  ON 31
ci_33                -1.081102e-03 3 1  ON 32
ci_34                 1.531571e-03 3 1  ON 33
ci_35                 1.264296e-03 3 1  ON 34
ci_36                -1.216148e-03 3 1  ON 35
ci_37                -1.183336e-03 3 1  ON 36
ci_38                -5.127077e-04 3 1  ON 37
ci_39                -6.940484e-04 3 1  ON 38
ci_40                -1.671845e-03 3 1  ON 39
ci_41                -1.487595e-03 3 1  ON 40
ci_42                -1.175269e-03 3 1  ON 41
ci_43                -2.921896e-03 3 1  ON 42
ci_44                -1.754156e-03 3 1  ON 43
ci_45                -7.134210e-04 3 1  ON 44
ci_46                -5.516738e-04 3 1  ON 45
ci_47                 1.182941e-03 3 1  ON 46
ci_48                 6.651923e-04 3 1  ON 47
ci_49                -9.363305e-04 3 1  ON 48
ci_50                -7.130202e-04 3 1  ON 49
ci_51                 4.299430e-04 3 1  ON 50
ci_52                 4.531740e-04 3 1  ON 51
ci_53                -6.090207e-04 3 1  ON 52
ci_54                -9.550502e-04 3 1  ON 53
ci_55                -7.064494e-04 3 1  ON 54
ci_56                 1.902598e-03 3 1  ON 55
ci_57                 1.698694e-03 3 1  ON 56
ci_58                -7.145525e-04 3 1  ON 57
ci_59                -1.014743e-03 3 1  ON 58
ci_60                 5.745177e-04 3 1  ON 59
ci_61                 6.515864e-04 3 1  ON 60
ci_62                -2.615909e-04 3 1  ON 61
ci_63                -5.891406e-04 3 1  ON 62
ci_64                -5.036248e-04 3 1  ON 63
ci_65                -2.754750e-04 3 1  ON 64
ci_66                -6.982566e-04 3 1  ON 65
ci_67                -5.692547e-04 3 1  ON 66
ci_68                -6.069741e-04 3 1  ON 67
ci_69                 2.435643e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4381e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.871
    reference variance = 0.355423
====================================================
  Execution time = 2.5940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4831e-01
  Total weights = 1.964255164e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5022e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435260275276
                                         uncertainty =       0.002012594263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435260275276
                                         uncertainty =       0.002012594263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466508497
  error estimate for blocks of size 2^( 2) =       0.000491574705
  error estimate for blocks of size 2^( 3) =       0.000515138038
  error estimate for blocks of size 2^( 4) =       0.000532947744
  error estimate for blocks of size 2^( 5) =       0.000543644559
  error estimate for blocks of size 2^( 6) =       0.000550399501
  error estimate for blocks of size 2^( 7) =       0.000555021466

      target function =      -0.746743755425
              le_mean =     -22.814474428463
             les_mean =     520.948556570742
             stat err =       0.000545503318
             autocorr =       1.367337347344
   target nu stat err =       0.000545503318
   target dn stat err =       0.002971318762
      target stat err =       0.002538523609
              std dev =       0.659742642813
             le_variance =       0.435260354746


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281447442846e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746751439116       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746751957626       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746752018376       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746752029622       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746752031096       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746752031755       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746752032319       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746752032528       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746752032389       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746752032408       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 8.430350e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746751439116       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746751568865       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746751584060       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746751586871       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746751587239       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746751587403       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746751587544       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746751587597       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746751587562       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746751587566       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 2.108687e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746751439116       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746751471561       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746751475360       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746751476063       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746751476155       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746751476196       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746751476232       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746751476244       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746751476235       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746751476238       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 5.272404e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170244 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0451e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.321414e-01 3 1  ON 0
ci_02                -3.190521e-02 3 1  ON 1
ci_03                -3.158091e-02 3 1  ON 2
ci_04                 2.838227e-02 3 1  ON 3
ci_05                -2.372141e-02 3 1  ON 4
ci_06                -2.329104e-02 3 1  ON 5
ci_07                 2.702674e-02 3 1  ON 6
ci_08                -6.692233e-03 3 1  ON 7
ci_09                -9.505577e-03 3 1  ON 8
ci_10                -9.510203e-03 3 1  ON 9
ci_11                 1.312241e-02 3 1  ON 10
ci_12                 7.873509e-03 3 1  ON 11
ci_13                 1.273058e-02 3 1  ON 12
ci_14                 1.306573e-02 3 1  ON 13
ci_15                 7.256371e-03 3 1  ON 14
ci_16                 7.482578e-03 3 1  ON 15
ci_17                -7.782703e-03 3 1  ON 16
ci_18                -7.298374e-03 3 1  ON 17
ci_19                 9.386678e-03 3 1  ON 18
ci_20                 6.906113e-03 3 1  ON 19
ci_21                 8.798548e-03 3 1  ON 20
ci_22                 8.856853e-03 3 1  ON 21
ci_23                 4.972556e-03 3 1  ON 22
ci_24                 4.354950e-03 3 1  ON 23
ci_25                 3.174032e-03 3 1  ON 24
ci_26                 3.224904e-03 3 1  ON 25
ci_27                 3.317235e-03 3 1  ON 26
ci_28                 2.505846e-03 3 1  ON 27
ci_29                 2.130104e-03 3 1  ON 28
ci_30                -1.683072e-03 3 1  ON 29
ci_31                -1.654362e-03 3 1  ON 30
ci_32                -1.413897e-03 3 1  ON 31
ci_33                -1.081175e-03 3 1  ON 32
ci_34                 1.530822e-03 3 1  ON 33
ci_35                 1.264500e-03 3 1  ON 34
ci_36                -1.215991e-03 3 1  ON 35
ci_37                -1.183033e-03 3 1  ON 36
ci_38                -5.125208e-04 3 1  ON 37
ci_39                -6.943885e-04 3 1  ON 38
ci_40                -1.671626e-03 3 1  ON 39
ci_41                -1.487663e-03 3 1  ON 40
ci_42                -1.175328e-03 3 1  ON 41
ci_43                -2.921571e-03 3 1  ON 42
ci_44                -1.754309e-03 3 1  ON 43
ci_45                -7.132714e-04 3 1  ON 44
ci_46                -5.516908e-04 3 1  ON 45
ci_47                 1.183461e-03 3 1  ON 46
ci_48                 6.653243e-04 3 1  ON 47
ci_49                -9.361476e-04 3 1  ON 48
ci_50                -7.131345e-04 3 1  ON 49
ci_51                 4.297519e-04 3 1  ON 50
ci_52                 4.532519e-04 3 1  ON 51
ci_53                -6.092250e-04 3 1  ON 52
ci_54                -9.550027e-04 3 1  ON 53
ci_55                -7.066828e-04 3 1  ON 54
ci_56                 1.902726e-03 3 1  ON 55
ci_57                 1.698985e-03 3 1  ON 56
ci_58                -7.148223e-04 3 1  ON 57
ci_59                -1.014573e-03 3 1  ON 58
ci_60                 5.744341e-04 3 1  ON 59
ci_61                 6.517465e-04 3 1  ON 60
ci_62                -2.614839e-04 3 1  ON 61
ci_63                -5.892828e-04 3 1  ON 62
ci_64                -5.033668e-04 3 1  ON 63
ci_65                -2.752281e-04 3 1  ON 64
ci_66                -6.979847e-04 3 1  ON 65
ci_67                -5.693998e-04 3 1  ON 66
ci_68                -6.074532e-04 3 1  ON 67
ci_69                 2.380189e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7018
    reference variance = 0.331277
====================================================
  Execution time = 2.5137e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4108e-01
  Total weights = 1.9643e+06
  Execution time = 3.4883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430539200116
                                         uncertainty =       0.001691346524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430539200116
                                         uncertainty =       0.001691346524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463966426
  error estimate for blocks of size 2^( 2) =       0.000489424687
  error estimate for blocks of size 2^( 3) =       0.000512893589
  error estimate for blocks of size 2^( 4) =       0.000530539729
  error estimate for blocks of size 2^( 5) =       0.000541580148
  error estimate for blocks of size 2^( 6) =       0.000547629112
  error estimate for blocks of size 2^( 7) =       0.000553236103

      target function =      -0.752782130477
              le_mean =     -22.813511638819
             les_mean =     520.897394752339
             stat err =       0.000543246273
             autocorr =       1.370946165773
   target nu stat err =       0.000543246273
   target dn stat err =       0.002168624769
      target stat err =       0.001924196360
              std dev =       0.656147612116
             le_variance =       0.430529688886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430537170943
                                         uncertainty =       0.001691251079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430537170943
                                         uncertainty =       0.001691251079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463965331
  error estimate for blocks of size 2^( 2) =       0.000489423896
  error estimate for blocks of size 2^( 3) =       0.000512893131
  error estimate for blocks of size 2^( 4) =       0.000530539520
  error estimate for blocks of size 2^( 5) =       0.000541580052
  error estimate for blocks of size 2^( 6) =       0.000547629053
  error estimate for blocks of size 2^( 7) =       0.000553236307

      target function =      -0.752783456069
              le_mean =     -22.813511686751
             les_mean =     520.897395367309
             stat err =       0.000543246233
             autocorr =       1.370952435167
   target nu stat err =       0.000543246233
   target dn stat err =       0.002168289630
      target stat err =       0.001923935200
              std dev =       0.656146063795
             le_variance =       0.430527657034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430538184199
                                         uncertainty =       0.001691298727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430538184199
                                         uncertainty =       0.001691298727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463965878
  error estimate for blocks of size 2^( 2) =       0.000489424291
  error estimate for blocks of size 2^( 3) =       0.000512893360
  error estimate for blocks of size 2^( 4) =       0.000530539624
  error estimate for blocks of size 2^( 5) =       0.000541580100
  error estimate for blocks of size 2^( 6) =       0.000547629082
  error estimate for blocks of size 2^( 7) =       0.000553236205

      target function =      -0.752783236041
              le_mean =     -22.813511662717
             les_mean =     520.897394530790
             stat err =       0.000543246253
             autocorr =       1.370949303637
   target nu stat err =       0.000543246253
   target dn stat err =       0.002168455516
      target stat err =       0.001924066585
              std dev =       0.656146836942
             le_variance =       0.430528671629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430539073042
                                         uncertainty =       0.001691340544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430539073042
                                         uncertainty =       0.001691340544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463966357
  error estimate for blocks of size 2^( 2) =       0.000489424637
  error estimate for blocks of size 2^( 3) =       0.000512893561
  error estimate for blocks of size 2^( 4) =       0.000530539716
  error estimate for blocks of size 2^( 5) =       0.000541580142
  error estimate for blocks of size 2^( 6) =       0.000547629108
  error estimate for blocks of size 2^( 7) =       0.000553236116

      target function =      -0.752782272915
              le_mean =     -22.813511641799
             les_mean =     520.897394719270
             stat err =       0.000543246270
             autocorr =       1.370946558102
   target nu stat err =       0.000543246270
   target dn stat err =       0.002168603576
      target stat err =       0.001924180129
              std dev =       0.656147515155
             le_variance =       0.430529561645


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.752782130477        initial
     3.9062e+01     3.9062e+02             8.4304e-06        -0.752783456069  <--
     1.5625e+02     1.5625e+03             2.1087e-06        -0.752783236041
     6.2500e+02     6.2500e+03             5.2724e-07        -0.752782272915

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 4.2645e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.321351e-01 3 1  ON 0
ci_02                -3.190231e-02 3 1  ON 1
ci_03                -3.157669e-02 3 1  ON 2
ci_04                 2.838024e-02 3 1  ON 3
ci_05                -2.371975e-02 3 1  ON 4
ci_06                -2.328901e-02 3 1  ON 5
ci_07                 2.702555e-02 3 1  ON 6
ci_08                -6.690561e-03 3 1  ON 7
ci_09                -9.503551e-03 3 1  ON 8
ci_10                -9.509675e-03 3 1  ON 9
ci_11                 1.312248e-02 3 1  ON 10
ci_12                 7.872390e-03 3 1  ON 11
ci_13                 1.273105e-02 3 1  ON 12
ci_14                 1.306649e-02 3 1  ON 13
ci_15                 7.256059e-03 3 1  ON 14
ci_16                 7.481098e-03 3 1  ON 15
ci_17                -7.782080e-03 3 1  ON 16
ci_18                -7.297601e-03 3 1  ON 17
ci_19                 9.386938e-03 3 1  ON 18
ci_20                 6.905612e-03 3 1  ON 19
ci_21                 8.797905e-03 3 1  ON 20
ci_22                 8.856478e-03 3 1  ON 21
ci_23                 4.972088e-03 3 1  ON 22
ci_24                 4.354362e-03 3 1  ON 23
ci_25                 3.174598e-03 3 1  ON 24
ci_26                 3.224626e-03 3 1  ON 25
ci_27                 3.318664e-03 3 1  ON 26
ci_28                 2.505473e-03 3 1  ON 27
ci_29                 2.130441e-03 3 1  ON 28
ci_30                -1.682370e-03 3 1  ON 29
ci_31                -1.653127e-03 3 1  ON 30
ci_32                -1.413615e-03 3 1  ON 31
ci_33                -1.081391e-03 3 1  ON 32
ci_34                 1.528579e-03 3 1  ON 33
ci_35                 1.265112e-03 3 1  ON 34
ci_36                -1.215520e-03 3 1  ON 35
ci_37                -1.182126e-03 3 1  ON 36
ci_38                -5.119611e-04 3 1  ON 37
ci_39                -6.954076e-04 3 1  ON 38
ci_40                -1.670971e-03 3 1  ON 39
ci_41                -1.487868e-03 3 1  ON 40
ci_42                -1.175506e-03 3 1  ON 41
ci_43                -2.920595e-03 3 1  ON 42
ci_44                -1.754769e-03 3 1  ON 43
ci_45                -7.128233e-04 3 1  ON 44
ci_46                -5.517419e-04 3 1  ON 45
ci_47                 1.185020e-03 3 1  ON 46
ci_48                 6.657199e-04 3 1  ON 47
ci_49                -9.355997e-04 3 1  ON 48
ci_50                -7.134768e-04 3 1  ON 49
ci_51                 4.291790e-04 3 1  ON 50
ci_52                 4.534851e-04 3 1  ON 51
ci_53                -6.098367e-04 3 1  ON 52
ci_54                -9.548603e-04 3 1  ON 53
ci_55                -7.073823e-04 3 1  ON 54
ci_56                 1.903109e-03 3 1  ON 55
ci_57                 1.699857e-03 3 1  ON 56
ci_58                -7.156307e-04 3 1  ON 57
ci_59                -1.014064e-03 3 1  ON 58
ci_60                 5.741835e-04 3 1  ON 59
ci_61                 6.522265e-04 3 1  ON 60
ci_62                -2.611635e-04 3 1  ON 61
ci_63                -5.897090e-04 3 1  ON 62
ci_64                -5.025937e-04 3 1  ON 63
ci_65                -2.744886e-04 3 1  ON 64
ci_66                -6.971700e-04 3 1  ON 65
ci_67                -5.698345e-04 3 1  ON 66
ci_68                -6.088887e-04 3 1  ON 67
ci_69                 2.214026e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3102e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8371
    reference variance = 0.389489
====================================================
  Execution time = 2.6031e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5335e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4422e-01
  Total weights = 1.964228803e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433798945691
                                         uncertainty =       0.003356686745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433798945691
                                         uncertainty =       0.003356686745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465714467
  error estimate for blocks of size 2^( 2) =       0.000491084258
  error estimate for blocks of size 2^( 3) =       0.000514743877
  error estimate for blocks of size 2^( 4) =       0.000532252469
  error estimate for blocks of size 2^( 5) =       0.000543113364
  error estimate for blocks of size 2^( 6) =       0.000550203490
  error estimate for blocks of size 2^( 7) =       0.000553898181

      target function =      -0.750153338941
              le_mean =     -22.815059203148
             les_mean =     520.971147336260
             stat err =       0.000544866876
             autocorr =       1.368804282929
   target nu stat err =       0.000544866876
   target dn stat err =       0.003898535671
      target stat err =       0.003323057067
              std dev =       0.658619715094
             le_variance =       0.433779929111


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281505920315e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750167267380       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750169604667       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750169920144       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750169983373       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750170009119       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750170008885       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750170008973       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750170007946       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750170007936       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 2.427045e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750167267380       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750167853942       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750167932977       residual = 7.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750167948796       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750167955226       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750167955158       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750167955179       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750167954923       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750167954921       residual = 7.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 6.081310e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750167267380       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750167414161       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750167433931       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750167437886       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750167439493       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750167439475       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750167439481       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750167439417       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750167439416       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 1.521186e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173270 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0565e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.321290e-01 3 1  ON 0
ci_02                -3.189825e-02 3 1  ON 1
ci_03                -3.157228e-02 3 1  ON 2
ci_04                 2.837755e-02 3 1  ON 3
ci_05                -2.371482e-02 3 1  ON 4
ci_06                -2.328329e-02 3 1  ON 5
ci_07                 2.702721e-02 3 1  ON 6
ci_08                -6.688307e-03 3 1  ON 7
ci_09                -9.502007e-03 3 1  ON 8
ci_10                -9.507973e-03 3 1  ON 9
ci_11                 1.312084e-02 3 1  ON 10
ci_12                 7.871296e-03 3 1  ON 11
ci_13                 1.273096e-02 3 1  ON 12
ci_14                 1.306540e-02 3 1  ON 13
ci_15                 7.255160e-03 3 1  ON 14
ci_16                 7.479053e-03 3 1  ON 15
ci_17                -7.782187e-03 3 1  ON 16
ci_18                -7.296890e-03 3 1  ON 17
ci_19                 9.387304e-03 3 1  ON 18
ci_20                 6.904366e-03 3 1  ON 19
ci_21                 8.798423e-03 3 1  ON 20
ci_22                 8.854235e-03 3 1  ON 21
ci_23                 4.972937e-03 3 1  ON 22
ci_24                 4.355188e-03 3 1  ON 23
ci_25                 3.173313e-03 3 1  ON 24
ci_26                 3.223717e-03 3 1  ON 25
ci_27                 3.318753e-03 3 1  ON 26
ci_28                 2.505125e-03 3 1  ON 27
ci_29                 2.131101e-03 3 1  ON 28
ci_30                -1.681571e-03 3 1  ON 29
ci_31                -1.651540e-03 3 1  ON 30
ci_32                -1.413156e-03 3 1  ON 31
ci_33                -1.080975e-03 3 1  ON 32
ci_34                 1.529853e-03 3 1  ON 33
ci_35                 1.263773e-03 3 1  ON 34
ci_36                -1.216335e-03 3 1  ON 35
ci_37                -1.181859e-03 3 1  ON 36
ci_38                -5.119384e-04 3 1  ON 37
ci_39                -6.958596e-04 3 1  ON 38
ci_40                -1.671176e-03 3 1  ON 39
ci_41                -1.486562e-03 3 1  ON 40
ci_42                -1.175533e-03 3 1  ON 41
ci_43                -2.918742e-03 3 1  ON 42
ci_44                -1.754604e-03 3 1  ON 43
ci_45                -7.114396e-04 3 1  ON 44
ci_46                -5.508692e-04 3 1  ON 45
ci_47                 1.187077e-03 3 1  ON 46
ci_48                 6.655707e-04 3 1  ON 47
ci_49                -9.358203e-04 3 1  ON 48
ci_50                -7.143696e-04 3 1  ON 49
ci_51                 4.285151e-04 3 1  ON 50
ci_52                 4.526141e-04 3 1  ON 51
ci_53                -6.107924e-04 3 1  ON 52
ci_54                -9.541499e-04 3 1  ON 53
ci_55                -7.068276e-04 3 1  ON 54
ci_56                 1.902868e-03 3 1  ON 55
ci_57                 1.700591e-03 3 1  ON 56
ci_58                -7.160427e-04 3 1  ON 57
ci_59                -1.013887e-03 3 1  ON 58
ci_60                 5.746829e-04 3 1  ON 59
ci_61                 6.518445e-04 3 1  ON 60
ci_62                -2.621922e-04 3 1  ON 61
ci_63                -5.897225e-04 3 1  ON 62
ci_64                -5.024262e-04 3 1  ON 63
ci_65                -2.756031e-04 3 1  ON 64
ci_66                -6.982818e-04 3 1  ON 65
ci_67                -5.703972e-04 3 1  ON 66
ci_68                -6.089702e-04 3 1  ON 67
ci_69                 2.100029e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.6712
    reference variance = 2.87084
====================================================
  Execution time = 2.5435e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4773e-01
  Total weights = 1.9637e+06
  Execution time = 3.4951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435234674999
                                         uncertainty =       0.002970911521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435234674999
                                         uncertainty =       0.002970911521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466563014
  error estimate for blocks of size 2^( 2) =       0.000491364256
  error estimate for blocks of size 2^( 3) =       0.000514392048
  error estimate for blocks of size 2^( 4) =       0.000531520493
  error estimate for blocks of size 2^( 5) =       0.000542274883
  error estimate for blocks of size 2^( 6) =       0.000548314534
  error estimate for blocks of size 2^( 7) =       0.000549716208

      target function =      -0.747197332907
              le_mean =     -22.813005847222
             les_mean =     520.880984353830
             stat err =       0.000542956529
             autocorr =       1.354283240456
   target nu stat err =       0.000542956529
   target dn stat err =       0.003907145224
      target stat err =       0.003293932235
              std dev =       0.659819742607
             le_variance =       0.435362092734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435230837527
                                         uncertainty =       0.002971242558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435230837527
                                         uncertainty =       0.002971242558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466560985
  error estimate for blocks of size 2^( 2) =       0.000491363366
  error estimate for blocks of size 2^( 3) =       0.000514392419
  error estimate for blocks of size 2^( 4) =       0.000531521594
  error estimate for blocks of size 2^( 5) =       0.000542276326
  error estimate for blocks of size 2^( 6) =       0.000548316982
  error estimate for blocks of size 2^( 7) =       0.000549718929

      target function =      -0.747221427479
              le_mean =     -22.813006006658
             les_mean =     520.880962550032
             stat err =       0.000542958458
             autocorr =       1.354304641954
   target nu stat err =       0.000542958458
   target dn stat err =       0.003908232552
      target stat err =       0.003295028424
              std dev =       0.659816872408
             le_variance =       0.435358305114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435232742395
                                         uncertainty =       0.002971077081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435232742395
                                         uncertainty =       0.002971077081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466561992
  error estimate for blocks of size 2^( 2) =       0.000491363805
  error estimate for blocks of size 2^( 3) =       0.000514392230
  error estimate for blocks of size 2^( 4) =       0.000531521042
  error estimate for blocks of size 2^( 5) =       0.000542275603
  error estimate for blocks of size 2^( 6) =       0.000548315758
  error estimate for blocks of size 2^( 7) =       0.000549717569

      target function =      -0.747219786019
              le_mean =     -22.813005926080
             les_mean =     520.880960858561
             stat err =       0.000542957493
             autocorr =       1.354293979517
   target nu stat err =       0.000542957493
   target dn stat err =       0.003907617894
      target stat err =       0.003294512681
              std dev =       0.659818297108
             le_variance =       0.435360185199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435234432422
                                         uncertainty =       0.002970932197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435234432422
                                         uncertainty =       0.002970932197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466562886
  error estimate for blocks of size 2^( 2) =       0.000491364199
  error estimate for blocks of size 2^( 3) =       0.000514392070
  error estimate for blocks of size 2^( 4) =       0.000531520561
  error estimate for blocks of size 2^( 5) =       0.000542274973
  error estimate for blocks of size 2^( 6) =       0.000548314687
  error estimate for blocks of size 2^( 7) =       0.000549716377

      target function =      -0.747204871116
              le_mean =     -22.813005856983
             les_mean =     520.880975704130
             stat err =       0.000542956649
             autocorr =       1.354284584021
   target nu stat err =       0.000542956649
   target dn stat err =       0.003907152663
      target stat err =       0.003294003723
              std dev =       0.659819561164
             le_variance =       0.435361853294


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747197332907        initial
     9.7656e+00     9.7656e+01             2.4270e-05        -0.747221427479  <--
     3.9062e+01     3.9062e+02             6.0813e-06        -0.747219786019
     1.5625e+02     1.5625e+03             1.5212e-06        -0.747204871116

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 4.3008e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.321109e-01 3 1  ON 0
ci_02                -3.188614e-02 3 1  ON 1
ci_03                -3.155909e-02 3 1  ON 2
ci_04                 2.836954e-02 3 1  ON 3
ci_05                -2.370012e-02 3 1  ON 4
ci_06                -2.326621e-02 3 1  ON 5
ci_07                 2.703217e-02 3 1  ON 6
ci_08                -6.681580e-03 3 1  ON 7
ci_09                -9.497393e-03 3 1  ON 8
ci_10                -9.502887e-03 3 1  ON 9
ci_11                 1.311591e-02 3 1  ON 10
ci_12                 7.868029e-03 3 1  ON 11
ci_13                 1.273068e-02 3 1  ON 12
ci_14                 1.306213e-02 3 1  ON 13
ci_15                 7.252474e-03 3 1  ON 14
ci_16                 7.472943e-03 3 1  ON 15
ci_17                -7.782502e-03 3 1  ON 16
ci_18                -7.294764e-03 3 1  ON 17
ci_19                 9.388396e-03 3 1  ON 18
ci_20                 6.900648e-03 3 1  ON 19
ci_21                 8.799973e-03 3 1  ON 20
ci_22                 8.847527e-03 3 1  ON 21
ci_23                 4.975473e-03 3 1  ON 22
ci_24                 4.357659e-03 3 1  ON 23
ci_25                 3.169476e-03 3 1  ON 24
ci_26                 3.221003e-03 3 1  ON 25
ci_27                 3.319019e-03 3 1  ON 26
ci_28                 2.504082e-03 3 1  ON 27
ci_29                 2.133070e-03 3 1  ON 28
ci_30                -1.679182e-03 3 1  ON 29
ci_31                -1.646794e-03 3 1  ON 30
ci_32                -1.411785e-03 3 1  ON 31
ci_33                -1.079733e-03 3 1  ON 32
ci_34                 1.533659e-03 3 1  ON 33
ci_35                 1.259778e-03 3 1  ON 34
ci_36                -1.218766e-03 3 1  ON 35
ci_37                -1.181060e-03 3 1  ON 36
ci_38                -5.118708e-04 3 1  ON 37
ci_39                -6.972093e-04 3 1  ON 38
ci_40                -1.671787e-03 3 1  ON 39
ci_41                -1.482664e-03 3 1  ON 40
ci_42                -1.175614e-03 3 1  ON 41
ci_43                -2.913208e-03 3 1  ON 42
ci_44                -1.754109e-03 3 1  ON 43
ci_45                -7.073099e-04 3 1  ON 44
ci_46                -5.482638e-04 3 1  ON 45
ci_47                 1.193230e-03 3 1  ON 46
ci_48                 6.651227e-04 3 1  ON 47
ci_49                -9.364772e-04 3 1  ON 48
ci_50                -7.170324e-04 3 1  ON 49
ci_51                 4.265335e-04 3 1  ON 50
ci_52                 4.500144e-04 3 1  ON 51
ci_53                -6.136428e-04 3 1  ON 52
ci_54                -9.520271e-04 3 1  ON 53
ci_55                -7.051702e-04 3 1  ON 54
ci_56                 1.902147e-03 3 1  ON 55
ci_57                 1.702783e-03 3 1  ON 56
ci_58                -7.172728e-04 3 1  ON 57
ci_59                -1.013359e-03 3 1  ON 58
ci_60                 5.761772e-04 3 1  ON 59
ci_61                 6.507008e-04 3 1  ON 60
ci_62                -2.652605e-04 3 1  ON 61
ci_63                -5.897621e-04 3 1  ON 62
ci_64                -5.019257e-04 3 1  ON 63
ci_65                -2.789291e-04 3 1  ON 64
ci_66                -7.016007e-04 3 1  ON 65
ci_67                -5.720760e-04 3 1  ON 66
ci_68                -6.092127e-04 3 1  ON 67
ci_69                 1.759671e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3579e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8896
    reference variance = 0.768407
====================================================
  Execution time = 2.5987e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4507e-01
  Total weights = 1.964437385e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435045723999
                                         uncertainty =       0.001866082394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435045723999
                                         uncertainty =       0.001866082394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466381902
  error estimate for blocks of size 2^( 2) =       0.000491932839
  error estimate for blocks of size 2^( 3) =       0.000515579902
  error estimate for blocks of size 2^( 4) =       0.000533105825
  error estimate for blocks of size 2^( 5) =       0.000544969119
  error estimate for blocks of size 2^( 6) =       0.000551196786
  error estimate for blocks of size 2^( 7) =       0.000553173921

      target function =      -0.749451159191
              le_mean =     -22.815034049756
             les_mean =     520.970850018642
             stat err =       0.000545611413
             autocorr =       1.368621990542
   target nu stat err =       0.000545611413
   target dn stat err =       0.002184093095
      target stat err =       0.001925484683
              std dev =       0.659563610919
             le_variance =       0.435024156848


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281503404976e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749455109378       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749462217016       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749464083634       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749464419576       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749464420250       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749464478125       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749464493074       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749464488411       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749464487194       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749464487345       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.628989e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749455109378       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749456913610       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749457384712       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749457468624       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749457468358       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749457482644       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749457486319       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749457485156       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749457484856       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749457484894       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 4.104897e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749455109378       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749455562177       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749455680233       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749455701205       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749455701111       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749455704671       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749455705586       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749455705295       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749455705221       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749455705230       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 1.028272e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176752 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0614e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.320698e-01 3 1  ON 0
ci_02                -3.187215e-02 3 1  ON 1
ci_03                -3.154325e-02 3 1  ON 2
ci_04                 2.836070e-02 3 1  ON 3
ci_05                -2.368909e-02 3 1  ON 4
ci_06                -2.325604e-02 3 1  ON 5
ci_07                 2.702835e-02 3 1  ON 6
ci_08                -6.670707e-03 3 1  ON 7
ci_09                -9.489294e-03 3 1  ON 8
ci_10                -9.500798e-03 3 1  ON 9
ci_11                 1.311756e-02 3 1  ON 10
ci_12                 7.864373e-03 3 1  ON 11
ci_13                 1.272946e-02 3 1  ON 12
ci_14                 1.306670e-02 3 1  ON 13
ci_15                 7.247900e-03 3 1  ON 14
ci_16                 7.473022e-03 3 1  ON 15
ci_17                -7.781434e-03 3 1  ON 16
ci_18                -7.285066e-03 3 1  ON 17
ci_19                 9.387167e-03 3 1  ON 18
ci_20                 6.894614e-03 3 1  ON 19
ci_21                 8.797614e-03 3 1  ON 20
ci_22                 8.848848e-03 3 1  ON 21
ci_23                 4.974449e-03 3 1  ON 22
ci_24                 4.359647e-03 3 1  ON 23
ci_25                 3.170680e-03 3 1  ON 24
ci_26                 3.217263e-03 3 1  ON 25
ci_27                 3.318226e-03 3 1  ON 26
ci_28                 2.503993e-03 3 1  ON 27
ci_29                 2.127601e-03 3 1  ON 28
ci_30                -1.676386e-03 3 1  ON 29
ci_31                -1.651565e-03 3 1  ON 30
ci_32                -1.405792e-03 3 1  ON 31
ci_33                -1.078512e-03 3 1  ON 32
ci_34                 1.539076e-03 3 1  ON 33
ci_35                 1.260382e-03 3 1  ON 34
ci_36                -1.214540e-03 3 1  ON 35
ci_37                -1.178486e-03 3 1  ON 36
ci_38                -5.142069e-04 3 1  ON 37
ci_39                -6.978451e-04 3 1  ON 38
ci_40                -1.672829e-03 3 1  ON 39
ci_41                -1.479729e-03 3 1  ON 40
ci_42                -1.179039e-03 3 1  ON 41
ci_43                -2.908781e-03 3 1  ON 42
ci_44                -1.760485e-03 3 1  ON 43
ci_45                -7.052121e-04 3 1  ON 44
ci_46                -5.490066e-04 3 1  ON 45
ci_47                 1.193157e-03 3 1  ON 46
ci_48                 6.674029e-04 3 1  ON 47
ci_49                -9.317803e-04 3 1  ON 48
ci_50                -7.180772e-04 3 1  ON 49
ci_51                 4.271755e-04 3 1  ON 50
ci_52                 4.489926e-04 3 1  ON 51
ci_53                -6.117509e-04 3 1  ON 52
ci_54                -9.499605e-04 3 1  ON 53
ci_55                -7.053615e-04 3 1  ON 54
ci_56                 1.907627e-03 3 1  ON 55
ci_57                 1.706618e-03 3 1  ON 56
ci_58                -7.165624e-04 3 1  ON 57
ci_59                -1.014702e-03 3 1  ON 58
ci_60                 5.766637e-04 3 1  ON 59
ci_61                 6.550736e-04 3 1  ON 60
ci_62                -2.651672e-04 3 1  ON 61
ci_63                -5.950201e-04 3 1  ON 62
ci_64                -5.031343e-04 3 1  ON 63
ci_65                -2.756225e-04 3 1  ON 64
ci_66                -7.006886e-04 3 1  ON 65
ci_67                -5.714881e-04 3 1  ON 66
ci_68                -6.062006e-04 3 1  ON 67
ci_69                 1.265123e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8405
    reference variance = 0.332821
====================================================
  Execution time = 2.5182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4445e-01
  Total weights = 1.9641e+06
  Execution time = 3.4865e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431523050645
                                         uncertainty =       0.002027755072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431523050645
                                         uncertainty =       0.002027755072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464501160
  error estimate for blocks of size 2^( 2) =       0.000490198836
  error estimate for blocks of size 2^( 3) =       0.000513883562
  error estimate for blocks of size 2^( 4) =       0.000531438253
  error estimate for blocks of size 2^( 5) =       0.000542607713
  error estimate for blocks of size 2^( 6) =       0.000548884437
  error estimate for blocks of size 2^( 7) =       0.000555096607

      target function =      -0.749964064462
              le_mean =     -22.814352165133
             les_mean =     520.939114665705
             stat err =       0.000544506752
             autocorr =       1.374146177032
   target nu stat err =       0.000544506752
   target dn stat err =       0.002446189061
      target stat err =       0.002134855699
              std dev =       0.656903840084
             le_variance =       0.431522655117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431496089940
                                         uncertainty =       0.002027501769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431496089940
                                         uncertainty =       0.002027501769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464486715
  error estimate for blocks of size 2^( 2) =       0.000490188466
  error estimate for blocks of size 2^( 3) =       0.000513878410
  error estimate for blocks of size 2^( 4) =       0.000531436411
  error estimate for blocks of size 2^( 5) =       0.000542608564
  error estimate for blocks of size 2^( 6) =       0.000548889096
  error estimate for blocks of size 2^( 7) =       0.000555100684

      target function =      -0.749941439731
              le_mean =     -22.814352374897
             les_mean =     520.939151290259
             stat err =       0.000544508689
             autocorr =       1.374241421952
   target nu stat err =       0.000544508689
   target dn stat err =       0.002444792182
      target stat err =       0.002133613071
              std dev =       0.656883411558
             le_variance =       0.431495816380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431509301774
                                         uncertainty =       0.002027624335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431509301774
                                         uncertainty =       0.002027624335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464493793
  error estimate for blocks of size 2^( 2) =       0.000490193533
  error estimate for blocks of size 2^( 3) =       0.000513880876
  error estimate for blocks of size 2^( 4) =       0.000531437247
  error estimate for blocks of size 2^( 5) =       0.000542608097
  error estimate for blocks of size 2^( 6) =       0.000548886792
  error estimate for blocks of size 2^( 7) =       0.000555098668

      target function =      -0.749946263746
              le_mean =     -22.814352270315
             les_mean =     520.939140747237
             stat err =       0.000544507701
             autocorr =       1.374194552113
   target nu stat err =       0.000544507701
   target dn stat err =       0.002445438351
      target stat err =       0.002134157000
              std dev =       0.656893422110
             le_variance =       0.431508968012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431521314738
                                         uncertainty =       0.002027738406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431521314738
                                         uncertainty =       0.002027738406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464500230
  error estimate for blocks of size 2^( 2) =       0.000490198165
  error estimate for blocks of size 2^( 3) =       0.000513883220
  error estimate for blocks of size 2^( 4) =       0.000531438121
  error estimate for blocks of size 2^( 5) =       0.000542607754
  error estimate for blocks of size 2^( 6) =       0.000548884724
  error estimate for blocks of size 2^( 7) =       0.000555096856

      target function =      -0.749965693467
              le_mean =     -22.814352176090
             les_mean =     520.939113219557
             stat err =       0.000544506864
             autocorr =       1.374152241085
   target nu stat err =       0.000544506864
   target dn stat err =       0.002446040169
      target stat err =       0.002134745244
              std dev =       0.656902524691
             le_variance =       0.431520926945


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749964064462        initial
     2.4414e+00     2.4414e+01             1.6290e-04        -0.749941439731
     9.7656e+00     9.7656e+01             4.1049e-05        -0.749946263746
     3.9062e+01     3.9062e+02             1.0283e-05        -0.749965693467  <--

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 4.2688e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.321006e-01 3 1  ON 0
ci_02                -3.188263e-02 3 1  ON 1
ci_03                -3.155512e-02 3 1  ON 2
ci_04                 2.836732e-02 3 1  ON 3
ci_05                -2.369735e-02 3 1  ON 4
ci_06                -2.326366e-02 3 1  ON 5
ci_07                 2.703121e-02 3 1  ON 6
ci_08                -6.678852e-03 3 1  ON 7
ci_09                -9.495362e-03 3 1  ON 8
ci_10                -9.502363e-03 3 1  ON 9
ci_11                 1.311633e-02 3 1  ON 10
ci_12                 7.867112e-03 3 1  ON 11
ci_13                 1.273037e-02 3 1  ON 12
ci_14                 1.306328e-02 3 1  ON 13
ci_15                 7.251327e-03 3 1  ON 14
ci_16                 7.472963e-03 3 1  ON 15
ci_17                -7.782234e-03 3 1  ON 16
ci_18                -7.292332e-03 3 1  ON 17
ci_19                 9.388087e-03 3 1  ON 18
ci_20                 6.899134e-03 3 1  ON 19
ci_21                 8.799382e-03 3 1  ON 20
ci_22                 8.847858e-03 3 1  ON 21
ci_23                 4.975215e-03 3 1  ON 22
ci_24                 4.358157e-03 3 1  ON 23
ci_25                 3.169778e-03 3 1  ON 24
ci_26                 3.220065e-03 3 1  ON 25
ci_27                 3.318820e-03 3 1  ON 26
ci_28                 2.504060e-03 3 1  ON 27
ci_29                 2.131699e-03 3 1  ON 28
ci_30                -1.678482e-03 3 1  ON 29
ci_31                -1.647990e-03 3 1  ON 30
ci_32                -1.410281e-03 3 1  ON 31
ci_33                -1.079426e-03 3 1  ON 32
ci_34                 1.535017e-03 3 1  ON 33
ci_35                 1.259929e-03 3 1  ON 34
ci_36                -1.217705e-03 3 1  ON 35
ci_37                -1.180414e-03 3 1  ON 36
ci_38                -5.124569e-04 3 1  ON 37
ci_39                -6.973688e-04 3 1  ON 38
ci_40                -1.672049e-03 3 1  ON 39
ci_41                -1.481927e-03 3 1  ON 40
ci_42                -1.176474e-03 3 1  ON 41
ci_43                -2.912098e-03 3 1  ON 42
ci_44                -1.755709e-03 3 1  ON 43
ci_45                -7.067834e-04 3 1  ON 44
ci_46                -5.484503e-04 3 1  ON 45
ci_47                 1.193212e-03 3 1  ON 46
ci_48                 6.656939e-04 3 1  ON 47
ci_49                -9.352985e-04 3 1  ON 48
ci_50                -7.172948e-04 3 1  ON 49
ci_51                 4.266946e-04 3 1  ON 50
ci_52                 4.497580e-04 3 1  ON 51
ci_53                -6.131678e-04 3 1  ON 52
ci_54                -9.515085e-04 3 1  ON 53
ci_55                -7.052180e-04 3 1  ON 54
ci_56                 1.903522e-03 3 1  ON 55
ci_57                 1.703746e-03 3 1  ON 56
ci_58                -7.170945e-04 3 1  ON 57
ci_59                -1.013696e-03 3 1  ON 58
ci_60                 5.762989e-04 3 1  ON 59
ci_61                 6.517960e-04 3 1  ON 60
ci_62                -2.652372e-04 3 1  ON 61
ci_63                -5.910821e-04 3 1  ON 62
ci_64                -5.022290e-04 3 1  ON 63
ci_65                -2.780993e-04 3 1  ON 64
ci_66                -7.013719e-04 3 1  ON 65
ci_67                -5.719285e-04 3 1  ON 66
ci_68                -6.084570e-04 3 1  ON 67
ci_69                 1.635588e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3308e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8488
    reference variance = 0.356323
====================================================
  Execution time = 2.6055e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4614e-01
  Total weights = 1.964328390e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433273775417
                                         uncertainty =       0.003574131652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433273775417
                                         uncertainty =       0.003574131652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465412168
  error estimate for blocks of size 2^( 2) =       0.000490514944
  error estimate for blocks of size 2^( 3) =       0.000513949323
  error estimate for blocks of size 2^( 4) =       0.000531277687
  error estimate for blocks of size 2^( 5) =       0.000542338017
  error estimate for blocks of size 2^( 6) =       0.000548235415
  error estimate for blocks of size 2^( 7) =       0.000553577708

      target function =      -0.748544233119
              le_mean =     -22.814417985973
             les_mean =     520.943805111898
             stat err =       0.000543857207
             autocorr =       1.365508187166
   target nu stat err =       0.000543857207
   target dn stat err =       0.004265573133
      target stat err =       0.003606916762
              std dev =       0.658192200000
             le_variance =       0.433216972141


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281441798597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748560768958       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748563996250       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748564404967       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748564472245       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748564495198       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748564494135       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748564496284       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748564496202       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748564496988       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748564496721       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 2.773571e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748560768958       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748561578922       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748561681315       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748561698152       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748561703892       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748561703620       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748561704157       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748561704136       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748561704331       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748561704265       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 6.957773e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748560768958       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748560971646       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748560997257       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748561001468       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748561002903       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748561002834       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748561002969       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748561002964       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748561003012       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748561002996       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 1.740940e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180227 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0589e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.320965e-01 3 1  ON 0
ci_02                -3.187567e-02 3 1  ON 1
ci_03                -3.155089e-02 3 1  ON 2
ci_04                 2.836387e-02 3 1  ON 3
ci_05                -2.369310e-02 3 1  ON 4
ci_06                -2.326207e-02 3 1  ON 5
ci_07                 2.702927e-02 3 1  ON 6
ci_08                -6.676130e-03 3 1  ON 7
ci_09                -9.492836e-03 3 1  ON 8
ci_10                -9.499933e-03 3 1  ON 9
ci_11                 1.311459e-02 3 1  ON 10
ci_12                 7.863142e-03 3 1  ON 11
ci_13                 1.273029e-02 3 1  ON 12
ci_14                 1.306444e-02 3 1  ON 13
ci_15                 7.247544e-03 3 1  ON 14
ci_16                 7.471591e-03 3 1  ON 15
ci_17                -7.780842e-03 3 1  ON 16
ci_18                -7.289129e-03 3 1  ON 17
ci_19                 9.386870e-03 3 1  ON 18
ci_20                 6.898322e-03 3 1  ON 19
ci_21                 8.799023e-03 3 1  ON 20
ci_22                 8.846539e-03 3 1  ON 21
ci_23                 4.975224e-03 3 1  ON 22
ci_24                 4.360074e-03 3 1  ON 23
ci_25                 3.168294e-03 3 1  ON 24
ci_26                 3.220441e-03 3 1  ON 25
ci_27                 3.317003e-03 3 1  ON 26
ci_28                 2.504136e-03 3 1  ON 27
ci_29                 2.131661e-03 3 1  ON 28
ci_30                -1.677883e-03 3 1  ON 29
ci_31                -1.647797e-03 3 1  ON 30
ci_32                -1.409556e-03 3 1  ON 31
ci_33                -1.078014e-03 3 1  ON 32
ci_34                 1.532427e-03 3 1  ON 33
ci_35                 1.260133e-03 3 1  ON 34
ci_36                -1.217878e-03 3 1  ON 35
ci_37                -1.178796e-03 3 1  ON 36
ci_38                -5.127073e-04 3 1  ON 37
ci_39                -6.978661e-04 3 1  ON 38
ci_40                -1.672955e-03 3 1  ON 39
ci_41                -1.482230e-03 3 1  ON 40
ci_42                -1.175299e-03 3 1  ON 41
ci_43                -2.912913e-03 3 1  ON 42
ci_44                -1.753359e-03 3 1  ON 43
ci_45                -7.070888e-04 3 1  ON 44
ci_46                -5.492990e-04 3 1  ON 45
ci_47                 1.193864e-03 3 1  ON 46
ci_48                 6.676890e-04 3 1  ON 47
ci_49                -9.359863e-04 3 1  ON 48
ci_50                -7.174233e-04 3 1  ON 49
ci_51                 4.264527e-04 3 1  ON 50
ci_52                 4.506304e-04 3 1  ON 51
ci_53                -6.142023e-04 3 1  ON 52
ci_54                -9.529859e-04 3 1  ON 53
ci_55                -7.055486e-04 3 1  ON 54
ci_56                 1.903048e-03 3 1  ON 55
ci_57                 1.704124e-03 3 1  ON 56
ci_58                -7.179987e-04 3 1  ON 57
ci_59                -1.012876e-03 3 1  ON 58
ci_60                 5.775389e-04 3 1  ON 59
ci_61                 6.519571e-04 3 1  ON 60
ci_62                -2.637415e-04 3 1  ON 61
ci_63                -5.890696e-04 3 1  ON 62
ci_64                -5.009191e-04 3 1  ON 63
ci_65                -2.770570e-04 3 1  ON 64
ci_66                -7.017927e-04 3 1  ON 65
ci_67                -5.719417e-04 3 1  ON 66
ci_68                -6.098989e-04 3 1  ON 67
ci_69                 1.680696e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8114
    reference variance = 0.416176
====================================================
  Execution time = 2.5361e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5293e-01
  Total weights = 1.9641e+06
  Execution time = 3.5100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437903490764
                                         uncertainty =       0.002797633655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437903490764
                                         uncertainty =       0.002797633655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467884133
  error estimate for blocks of size 2^( 2) =       0.000493266866
  error estimate for blocks of size 2^( 3) =       0.000517227268
  error estimate for blocks of size 2^( 4) =       0.000535101860
  error estimate for blocks of size 2^( 5) =       0.000545775532
  error estimate for blocks of size 2^( 6) =       0.000552432131
  error estimate for blocks of size 2^( 7) =       0.000554407007

      target function =      -0.742874934378
              le_mean =     -22.814085734941
             les_mean =     520.935488848623
             stat err =       0.000546929132
             autocorr =       1.366423988327
   target nu stat err =       0.000546929132
   target dn stat err =       0.005237425606
      target stat err =       0.004340121447
              std dev =       0.661688087145
             le_variance =       0.437831124669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437897585642
                                         uncertainty =       0.002797908529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437897585642
                                         uncertainty =       0.002797908529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467880975
  error estimate for blocks of size 2^( 2) =       0.000493265228
  error estimate for blocks of size 2^( 3) =       0.000517226871
  error estimate for blocks of size 2^( 4) =       0.000535102562
  error estimate for blocks of size 2^( 5) =       0.000545776602
  error estimate for blocks of size 2^( 6) =       0.000552433254
  error estimate for blocks of size 2^( 7) =       0.000554408192

      target function =      -0.742943201593
              le_mean =     -22.814085633302
             les_mean =     520.935400975061
             stat err =       0.000546930153
             autocorr =       1.366447532746
   target nu stat err =       0.000546930153
   target dn stat err =       0.005241543378
      target stat err =       0.004344258005
              std dev =       0.661683620795
             le_variance =       0.437825214028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437900517034
                                         uncertainty =       0.002797770927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437900517034
                                         uncertainty =       0.002797770927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467882543
  error estimate for blocks of size 2^( 2) =       0.000493266037
  error estimate for blocks of size 2^( 3) =       0.000517227063
  error estimate for blocks of size 2^( 4) =       0.000535102206
  error estimate for blocks of size 2^( 5) =       0.000545776062
  error estimate for blocks of size 2^( 6) =       0.000552432689
  error estimate for blocks of size 2^( 7) =       0.000554407595

      target function =      -0.742930158371
              le_mean =     -22.814085683453
             les_mean =     520.935419181322
             stat err =       0.000546929638
             autocorr =       1.366435804622
   target nu stat err =       0.000546929638
   target dn stat err =       0.005239362606
      target stat err =       0.004342334646
              std dev =       0.661685837975
             le_variance =       0.437828148176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437903117511
                                         uncertainty =       0.002797650764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437903117511
                                         uncertainty =       0.002797650764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467883934
  error estimate for blocks of size 2^( 2) =       0.000493266761
  error estimate for blocks of size 2^( 3) =       0.000517227242
  error estimate for blocks of size 2^( 4) =       0.000535101903
  error estimate for blocks of size 2^( 5) =       0.000545775598
  error estimate for blocks of size 2^( 6) =       0.000552432200
  error estimate for blocks of size 2^( 7) =       0.000554407080

      target function =      -0.742889174390
              le_mean =     -22.814085728568
             les_mean =     520.935471202064
             stat err =       0.000546929195
             autocorr =       1.366425467362
   target nu stat err =       0.000546929195
   target dn stat err =       0.005237597626
      target stat err =       0.004340426001
              std dev =       0.661687804838
             le_variance =       0.437830751071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742874934378        initial
     9.7656e+00     9.7656e+01             2.7736e-05        -0.742943201593  <--
     3.9062e+01     3.9062e+02             6.9578e-06        -0.742930158371
     1.5625e+02     1.5625e+03             1.7409e-06        -0.742889174390

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 4.5255e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.320844e-01 3 1  ON 0
ci_02                -3.185489e-02 3 1  ON 1
ci_03                -3.153828e-02 3 1  ON 2
ci_04                 2.835357e-02 3 1  ON 3
ci_05                -2.368039e-02 3 1  ON 4
ci_06                -2.325733e-02 3 1  ON 5
ci_07                 2.702346e-02 3 1  ON 6
ci_08                -6.668008e-03 3 1  ON 7
ci_09                -9.485291e-03 3 1  ON 8
ci_10                -9.492670e-03 3 1  ON 9
ci_11                 1.310940e-02 3 1  ON 10
ci_12                 7.851293e-03 3 1  ON 11
ci_13                 1.273002e-02 3 1  ON 12
ci_14                 1.306792e-02 3 1  ON 13
ci_15                 7.236247e-03 3 1  ON 14
ci_16                 7.467494e-03 3 1  ON 15
ci_17                -7.776680e-03 3 1  ON 16
ci_18                -7.279564e-03 3 1  ON 17
ci_19                 9.383239e-03 3 1  ON 18
ci_20                 6.895898e-03 3 1  ON 19
ci_21                 8.797948e-03 3 1  ON 20
ci_22                 8.842594e-03 3 1  ON 21
ci_23                 4.975250e-03 3 1  ON 22
ci_24                 4.365807e-03 3 1  ON 23
ci_25                 3.163863e-03 3 1  ON 24
ci_26                 3.221567e-03 3 1  ON 25
ci_27                 3.311578e-03 3 1  ON 26
ci_28                 2.504364e-03 3 1  ON 27
ci_29                 2.131546e-03 3 1  ON 28
ci_30                -1.676091e-03 3 1  ON 29
ci_31                -1.647222e-03 3 1  ON 30
ci_32                -1.407395e-03 3 1  ON 31
ci_33                -1.073801e-03 3 1  ON 32
ci_34                 1.524691e-03 3 1  ON 33
ci_35                 1.260745e-03 3 1  ON 34
ci_36                -1.218395e-03 3 1  ON 35
ci_37                -1.173964e-03 3 1  ON 36
ci_38                -5.134539e-04 3 1  ON 37
ci_39                -6.993496e-04 3 1  ON 38
ci_40                -1.675657e-03 3 1  ON 39
ci_41                -1.483133e-03 3 1  ON 40
ci_42                -1.171793e-03 3 1  ON 41
ci_43                -2.915343e-03 3 1  ON 42
ci_44                -1.746340e-03 3 1  ON 43
ci_45                -7.080000e-04 3 1  ON 44
ci_46                -5.518310e-04 3 1  ON 45
ci_47                 1.195813e-03 3 1  ON 46
ci_48                 6.736535e-04 3 1  ON 47
ci_49                -9.380392e-04 3 1  ON 48
ci_50                -7.178063e-04 3 1  ON 49
ci_51                 4.257300e-04 3 1  ON 50
ci_52                 4.532329e-04 3 1  ON 51
ci_53                -6.172877e-04 3 1  ON 52
ci_54                -9.573972e-04 3 1  ON 53
ci_55                -7.065359e-04 3 1  ON 54
ci_56                 1.901632e-03 3 1  ON 55
ci_57                 1.705253e-03 3 1  ON 56
ci_58                -7.206981e-04 3 1  ON 57
ci_59                -1.010431e-03 3 1  ON 58
ci_60                 5.812519e-04 3 1  ON 59
ci_61                 6.524389e-04 3 1  ON 60
ci_62                -2.592801e-04 3 1  ON 61
ci_63                -5.830665e-04 3 1  ON 62
ci_64                -4.970098e-04 3 1  ON 63
ci_65                -2.739463e-04 3 1  ON 64
ci_66                -7.030484e-04 3 1  ON 65
ci_67                -5.719812e-04 3 1  ON 66
ci_68                -6.142061e-04 3 1  ON 67
ci_69                 1.815384e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5850e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8131
    reference variance = 0.281752
====================================================
  Execution time = 2.5861e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5358e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5050e-01
  Total weights = 1.964448066e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436980121993
                                         uncertainty =       0.003024757501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436980121993
                                         uncertainty =       0.003024757501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467386502
  error estimate for blocks of size 2^( 2) =       0.000492437532
  error estimate for blocks of size 2^( 3) =       0.000516470688
  error estimate for blocks of size 2^( 4) =       0.000533186526
  error estimate for blocks of size 2^( 5) =       0.000542447452
  error estimate for blocks of size 2^( 6) =       0.000548447015
  error estimate for blocks of size 2^( 7) =       0.000550437433

      target function =      -0.744926717755
              le_mean =     -22.813982134451
             les_mean =     520.928283355725
             stat err =       0.000543629607
             autocorr =       1.352863159649
   target nu stat err =       0.000543629607
   target dn stat err =       0.003672156949
      target stat err =       0.003088792434
              std dev =       0.660984329483
             le_variance =       0.436900283822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281398213445e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744938452219       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744948049309       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744949790144       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744950012091       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744950187078       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744950262305       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744950263470       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744950265530       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744950262400       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744950265657       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744950264984       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 8.027970e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744938452219       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744940888201       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744941327253       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744941382932       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744941426760       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744941445347       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744941445547       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744941446048       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744941445273       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744941446075       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744941445909       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 2.034248e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744938452219       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744939063553       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744939173558       residual = 7.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744939187489       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744939198451       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744939203084       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744939203128       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744939203253       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744939203059       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744939203259       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744939203218       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 5.102943e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184292 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0405e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.320646e-01 3 1  ON 0
ci_02                -3.183455e-02 3 1  ON 1
ci_03                -3.153065e-02 3 1  ON 2
ci_04                 2.833898e-02 3 1  ON 3
ci_05                -2.367199e-02 3 1  ON 4
ci_06                -2.324120e-02 3 1  ON 5
ci_07                 2.701908e-02 3 1  ON 6
ci_08                -6.658904e-03 3 1  ON 7
ci_09                -9.489860e-03 3 1  ON 8
ci_10                -9.473877e-03 3 1  ON 9
ci_11                 1.311138e-02 3 1  ON 10
ci_12                 7.841900e-03 3 1  ON 11
ci_13                 1.272435e-02 3 1  ON 12
ci_14                 1.307316e-02 3 1  ON 13
ci_15                 7.217081e-03 3 1  ON 14
ci_16                 7.472659e-03 3 1  ON 15
ci_17                -7.767731e-03 3 1  ON 16
ci_18                -7.272922e-03 3 1  ON 17
ci_19                 9.382369e-03 3 1  ON 18
ci_20                 6.894017e-03 3 1  ON 19
ci_21                 8.801336e-03 3 1  ON 20
ci_22                 8.843664e-03 3 1  ON 21
ci_23                 4.969518e-03 3 1  ON 22
ci_24                 4.380203e-03 3 1  ON 23
ci_25                 3.159231e-03 3 1  ON 24
ci_26                 3.218956e-03 3 1  ON 25
ci_27                 3.317385e-03 3 1  ON 26
ci_28                 2.500241e-03 3 1  ON 27
ci_29                 2.126927e-03 3 1  ON 28
ci_30                -1.672655e-03 3 1  ON 29
ci_31                -1.646676e-03 3 1  ON 30
ci_32                -1.404029e-03 3 1  ON 31
ci_33                -1.075637e-03 3 1  ON 32
ci_34                 1.531232e-03 3 1  ON 33
ci_35                 1.266096e-03 3 1  ON 34
ci_36                -1.216678e-03 3 1  ON 35
ci_37                -1.173950e-03 3 1  ON 36
ci_38                -5.176777e-04 3 1  ON 37
ci_39                -6.942303e-04 3 1  ON 38
ci_40                -1.676036e-03 3 1  ON 39
ci_41                -1.480061e-03 3 1  ON 40
ci_42                -1.169343e-03 3 1  ON 41
ci_43                -2.912240e-03 3 1  ON 42
ci_44                -1.754104e-03 3 1  ON 43
ci_45                -7.068123e-04 3 1  ON 44
ci_46                -5.476836e-04 3 1  ON 45
ci_47                 1.204597e-03 3 1  ON 46
ci_48                 6.702610e-04 3 1  ON 47
ci_49                -9.389003e-04 3 1  ON 48
ci_50                -7.201423e-04 3 1  ON 49
ci_51                 4.250129e-04 3 1  ON 50
ci_52                 4.518609e-04 3 1  ON 51
ci_53                -6.243463e-04 3 1  ON 52
ci_54                -9.572472e-04 3 1  ON 53
ci_55                -7.091793e-04 3 1  ON 54
ci_56                 1.899169e-03 3 1  ON 55
ci_57                 1.709745e-03 3 1  ON 56
ci_58                -7.312080e-04 3 1  ON 57
ci_59                -1.005335e-03 3 1  ON 58
ci_60                 5.916468e-04 3 1  ON 59
ci_61                 6.591135e-04 3 1  ON 60
ci_62                -2.625744e-04 3 1  ON 61
ci_63                -5.784449e-04 3 1  ON 62
ci_64                -4.933121e-04 3 1  ON 63
ci_65                -2.732544e-04 3 1  ON 64
ci_66                -7.045837e-04 3 1  ON 65
ci_67                -5.727335e-04 3 1  ON 66
ci_68                -6.191103e-04 3 1  ON 67
ci_69                 1.301753e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7565
    reference variance = 0.361966
====================================================
  Execution time = 2.5197e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4533e-01
  Total weights = 1.9642e+06
  Execution time = 3.5089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430603640948
                                         uncertainty =       0.001800468521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430603640948
                                         uncertainty =       0.001800468521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463960522
  error estimate for blocks of size 2^( 2) =       0.000489384589
  error estimate for blocks of size 2^( 3) =       0.000512752285
  error estimate for blocks of size 2^( 4) =       0.000530777382
  error estimate for blocks of size 2^( 5) =       0.000542437729
  error estimate for blocks of size 2^( 6) =       0.000547731136
  error estimate for blocks of size 2^( 7) =       0.000550967216

      target function =      -0.749191629988
              le_mean =     -22.815227585815
             les_mean =     520.979980862385
             stat err =       0.000542978366
             autocorr =       1.369629163489
   target nu stat err =       0.000542978366
   target dn stat err =       0.003959598993
      target stat err =       0.003365335442
              std dev =       0.656139262998
             le_variance =       0.430518732448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430572346970
                                         uncertainty =       0.001798769701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430572346970
                                         uncertainty =       0.001798769701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463943683
  error estimate for blocks of size 2^( 2) =       0.000489372419
  error estimate for blocks of size 2^( 3) =       0.000512744176
  error estimate for blocks of size 2^( 4) =       0.000530773331
  error estimate for blocks of size 2^( 5) =       0.000542436128
  error estimate for blocks of size 2^( 6) =       0.000547729994
  error estimate for blocks of size 2^( 7) =       0.000550966099

      target function =      -0.749184173606
              le_mean =     -22.815227913694
             les_mean =     520.980005306361
             stat err =       0.000542976388
             autocorr =       1.369718608024
   target nu stat err =       0.000542976388
   target dn stat err =       0.003895810467
      target stat err =       0.003312826086
              std dev =       0.656115449329
             le_variance =       0.430487482848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430587594466
                                         uncertainty =       0.001799588103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430587594466
                                         uncertainty =       0.001799588103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463951888
  error estimate for blocks of size 2^( 2) =       0.000489378324
  error estimate for blocks of size 2^( 3) =       0.000512748082
  error estimate for blocks of size 2^( 4) =       0.000530775227
  error estimate for blocks of size 2^( 5) =       0.000542436810
  error estimate for blocks of size 2^( 6) =       0.000547730478
  error estimate for blocks of size 2^( 7) =       0.000550966513

      target function =      -0.749255664481
              le_mean =     -22.815227722632
             les_mean =     520.979910823502
             stat err =       0.000542977257
             autocorr =       1.369674547974
   target nu stat err =       0.000542977257
   target dn stat err =       0.003924885418
      target stat err =       0.003337352584
              std dev =       0.656127052411
             le_variance =       0.430502708906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430601605954
                                         uncertainty =       0.001800355807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430601605954
                                         uncertainty =       0.001800355807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463959427
  error estimate for blocks of size 2^( 2) =       0.000489383792
  error estimate for blocks of size 2^( 3) =       0.000512751747
  error estimate for blocks of size 2^( 4) =       0.000530777100
  error estimate for blocks of size 2^( 5) =       0.000542437603
  error estimate for blocks of size 2^( 6) =       0.000547731044
  error estimate for blocks of size 2^( 7) =       0.000550967117

      target function =      -0.749202112301
              le_mean =     -22.815227600006
             les_mean =     520.979969010834
             stat err =       0.000542978216
             autocorr =       1.369634874343
   target nu stat err =       0.000542978216
   target dn stat err =       0.003955171533
      target stat err =       0.003361786950
              std dev =       0.656137714497
             le_variance =       0.430516700385


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749191629988        initial
     2.4414e+00     2.4414e+01             8.0280e-05        -0.749184173606
     9.7656e+00     9.7656e+01             2.0342e-05        -0.749255664481  <--
     3.9062e+01     3.9062e+02             5.1029e-06        -0.749202112301

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 4.2843e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.320646e-01 3 1  ON 0
ci_02                -3.183455e-02 3 1  ON 1
ci_03                -3.153065e-02 3 1  ON 2
ci_04                 2.833898e-02 3 1  ON 3
ci_05                -2.367199e-02 3 1  ON 4
ci_06                -2.324120e-02 3 1  ON 5
ci_07                 2.701908e-02 3 1  ON 6
ci_08                -6.658904e-03 3 1  ON 7
ci_09                -9.489860e-03 3 1  ON 8
ci_10                -9.473877e-03 3 1  ON 9
ci_11                 1.311138e-02 3 1  ON 10
ci_12                 7.841900e-03 3 1  ON 11
ci_13                 1.272435e-02 3 1  ON 12
ci_14                 1.307316e-02 3 1  ON 13
ci_15                 7.217081e-03 3 1  ON 14
ci_16                 7.472659e-03 3 1  ON 15
ci_17                -7.767731e-03 3 1  ON 16
ci_18                -7.272922e-03 3 1  ON 17
ci_19                 9.382369e-03 3 1  ON 18
ci_20                 6.894017e-03 3 1  ON 19
ci_21                 8.801336e-03 3 1  ON 20
ci_22                 8.843664e-03 3 1  ON 21
ci_23                 4.969518e-03 3 1  ON 22
ci_24                 4.380203e-03 3 1  ON 23
ci_25                 3.159231e-03 3 1  ON 24
ci_26                 3.218956e-03 3 1  ON 25
ci_27                 3.317385e-03 3 1  ON 26
ci_28                 2.500241e-03 3 1  ON 27
ci_29                 2.126927e-03 3 1  ON 28
ci_30                -1.672655e-03 3 1  ON 29
ci_31                -1.646676e-03 3 1  ON 30
ci_32                -1.404029e-03 3 1  ON 31
ci_33                -1.075637e-03 3 1  ON 32
ci_34                 1.531232e-03 3 1  ON 33
ci_35                 1.266096e-03 3 1  ON 34
ci_36                -1.216678e-03 3 1  ON 35
ci_37                -1.173950e-03 3 1  ON 36
ci_38                -5.176777e-04 3 1  ON 37
ci_39                -6.942303e-04 3 1  ON 38
ci_40                -1.676036e-03 3 1  ON 39
ci_41                -1.480061e-03 3 1  ON 40
ci_42                -1.169343e-03 3 1  ON 41
ci_43                -2.912240e-03 3 1  ON 42
ci_44                -1.754104e-03 3 1  ON 43
ci_45                -7.068123e-04 3 1  ON 44
ci_46                -5.476836e-04 3 1  ON 45
ci_47                 1.204597e-03 3 1  ON 46
ci_48                 6.702610e-04 3 1  ON 47
ci_49                -9.389003e-04 3 1  ON 48
ci_50                -7.201423e-04 3 1  ON 49
ci_51                 4.250129e-04 3 1  ON 50
ci_52                 4.518609e-04 3 1  ON 51
ci_53                -6.243463e-04 3 1  ON 52
ci_54                -9.572472e-04 3 1  ON 53
ci_55                -7.091793e-04 3 1  ON 54
ci_56                 1.899169e-03 3 1  ON 55
ci_57                 1.709745e-03 3 1  ON 56
ci_58                -7.312080e-04 3 1  ON 57
ci_59                -1.005335e-03 3 1  ON 58
ci_60                 5.916468e-04 3 1  ON 59
ci_61                 6.591135e-04 3 1  ON 60
ci_62                -2.625744e-04 3 1  ON 61
ci_63                -5.784449e-04 3 1  ON 62
ci_64                -4.933121e-04 3 1  ON 63
ci_65                -2.732544e-04 3 1  ON 64
ci_66                -7.045837e-04 3 1  ON 65
ci_67                -5.727335e-04 3 1  ON 66
ci_68                -6.191103e-04 3 1  ON 67
ci_69                 1.301753e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3254e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7244
    reference variance = 0.440183
====================================================
  Execution time = 2.5916e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5369e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4822e-01
  Total weights = 1.963997900e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436378115229
                                         uncertainty =       0.002011104230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436378115229
                                         uncertainty =       0.002011104230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467129615
  error estimate for blocks of size 2^( 2) =       0.000492692331
  error estimate for blocks of size 2^( 3) =       0.000517198961
  error estimate for blocks of size 2^( 4) =       0.000534034702
  error estimate for blocks of size 2^( 5) =       0.000545179341
  error estimate for blocks of size 2^( 6) =       0.000551140906
  error estimate for blocks of size 2^( 7) =       0.000553356430

      target function =      -0.746823747005
              le_mean =     -22.815163737177
             les_mean =     520.979919320643
             stat err =       0.000545927845
             autocorr =       1.365826983162
   target nu stat err =       0.000545927845
   target dn stat err =       0.002450660928
      target stat err =       0.002124307816
              std dev =       0.660621037364
             le_variance =       0.436420155008


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281516373718e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746828873871       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746837999487       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746839884160       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746840160762       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746840170134       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746840178311       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746840185648       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746840184935       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746840183998       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.139480e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746828873871       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746831189734       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746831665173       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746831734371       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746831736449       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746831738504       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746831740284       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746831740137       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746831739892       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 2.873458e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746828873871       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746829455031       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746829574160       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746829591462       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746829591965       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746829592479       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746829592921       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746829592886       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746829592824       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 7.199305e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187319 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0439e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.320358e-01 3 1  ON 0
ci_02                -3.181299e-02 3 1  ON 1
ci_03                -3.150999e-02 3 1  ON 2
ci_04                 2.832677e-02 3 1  ON 3
ci_05                -2.365603e-02 3 1  ON 4
ci_06                -2.322597e-02 3 1  ON 5
ci_07                 2.701222e-02 3 1  ON 6
ci_08                -6.652139e-03 3 1  ON 7
ci_09                -9.491588e-03 3 1  ON 8
ci_10                -9.470270e-03 3 1  ON 9
ci_11                 1.310858e-02 3 1  ON 10
ci_12                 7.831637e-03 3 1  ON 11
ci_13                 1.272110e-02 3 1  ON 12
ci_14                 1.307263e-02 3 1  ON 13
ci_15                 7.210477e-03 3 1  ON 14
ci_16                 7.471846e-03 3 1  ON 15
ci_17                -7.759973e-03 3 1  ON 16
ci_18                -7.274302e-03 3 1  ON 17
ci_19                 9.381260e-03 3 1  ON 18
ci_20                 6.892885e-03 3 1  ON 19
ci_21                 8.799052e-03 3 1  ON 20
ci_22                 8.837791e-03 3 1  ON 21
ci_23                 4.971268e-03 3 1  ON 22
ci_24                 4.378521e-03 3 1  ON 23
ci_25                 3.160267e-03 3 1  ON 24
ci_26                 3.219820e-03 3 1  ON 25
ci_27                 3.318318e-03 3 1  ON 26
ci_28                 2.497700e-03 3 1  ON 27
ci_29                 2.123921e-03 3 1  ON 28
ci_30                -1.674480e-03 3 1  ON 29
ci_31                -1.640677e-03 3 1  ON 30
ci_32                -1.399847e-03 3 1  ON 31
ci_33                -1.072106e-03 3 1  ON 32
ci_34                 1.529886e-03 3 1  ON 33
ci_35                 1.274044e-03 3 1  ON 34
ci_36                -1.217493e-03 3 1  ON 35
ci_37                -1.172625e-03 3 1  ON 36
ci_38                -5.174839e-04 3 1  ON 37
ci_39                -6.959635e-04 3 1  ON 38
ci_40                -1.677466e-03 3 1  ON 39
ci_41                -1.475755e-03 3 1  ON 40
ci_42                -1.172969e-03 3 1  ON 41
ci_43                -2.904974e-03 3 1  ON 42
ci_44                -1.753837e-03 3 1  ON 43
ci_45                -7.082125e-04 3 1  ON 44
ci_46                -5.503888e-04 3 1  ON 45
ci_47                 1.213493e-03 3 1  ON 46
ci_48                 6.785784e-04 3 1  ON 47
ci_49                -9.397888e-04 3 1  ON 48
ci_50                -7.203976e-04 3 1  ON 49
ci_51                 4.252706e-04 3 1  ON 50
ci_52                 4.467460e-04 3 1  ON 51
ci_53                -6.259440e-04 3 1  ON 52
ci_54                -9.517928e-04 3 1  ON 53
ci_55                -7.125985e-04 3 1  ON 54
ci_56                 1.897905e-03 3 1  ON 55
ci_57                 1.708860e-03 3 1  ON 56
ci_58                -7.325382e-04 3 1  ON 57
ci_59                -1.008398e-03 3 1  ON 58
ci_60                 5.835423e-04 3 1  ON 59
ci_61                 6.600401e-04 3 1  ON 60
ci_62                -2.663824e-04 3 1  ON 61
ci_63                -5.761700e-04 3 1  ON 62
ci_64                -4.879629e-04 3 1  ON 63
ci_65                -2.760547e-04 3 1  ON 64
ci_66                -7.074775e-04 3 1  ON 65
ci_67                -5.719384e-04 3 1  ON 66
ci_68                -6.247298e-04 3 1  ON 67
ci_69                 1.141058e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7729
    reference variance = 0.309715
====================================================
  Execution time = 2.5189e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4985e-01
  Total weights = 1.9642e+06
  Execution time = 3.5063e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434061441259
                                         uncertainty =       0.002215107582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434061441259
                                         uncertainty =       0.002215107582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465860397
  error estimate for blocks of size 2^( 2) =       0.000490824755
  error estimate for blocks of size 2^( 3) =       0.000514691370
  error estimate for blocks of size 2^( 4) =       0.000532123970
  error estimate for blocks of size 2^( 5) =       0.000542836292
  error estimate for blocks of size 2^( 6) =       0.000548321067
  error estimate for blocks of size 2^( 7) =       0.000552352952

      target function =      -0.745377873922
              le_mean =     -22.814931017095
             les_mean =     520.971032837832
             stat err =       0.000543908570
             autocorr =       1.363139235040
   target nu stat err =       0.000543908570
   target dn stat err =       0.004022598148
      target stat err =       0.003381692139
              std dev =       0.658826091971
             le_variance =       0.434051819462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434042187225
                                         uncertainty =       0.002215402018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434042187225
                                         uncertainty =       0.002215402018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465850048
  error estimate for blocks of size 2^( 2) =       0.000490819187
  error estimate for blocks of size 2^( 3) =       0.000514690548
  error estimate for blocks of size 2^( 4) =       0.000532126054
  error estimate for blocks of size 2^( 5) =       0.000542841121
  error estimate for blocks of size 2^( 6) =       0.000548327436
  error estimate for blocks of size 2^( 7) =       0.000552360203

      target function =      -0.745511075113
              le_mean =     -22.814932131994
             les_mean =     520.970922756557
             stat err =       0.000543913704
             autocorr =       1.363225537377
   target nu stat err =       0.000543913704
   target dn stat err =       0.004016598527
      target stat err =       0.003378003385
              std dev =       0.658811455231
             le_variance =       0.434032533543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434051580478
                                         uncertainty =       0.002215256674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434051580478
                                         uncertainty =       0.002215256674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465855097
  error estimate for blocks of size 2^( 2) =       0.000490821879
  error estimate for blocks of size 2^( 3) =       0.000514690902
  error estimate for blocks of size 2^( 4) =       0.000532124974
  error estimate for blocks of size 2^( 5) =       0.000542838686
  error estimate for blocks of size 2^( 6) =       0.000548324239
  error estimate for blocks of size 2^( 7) =       0.000552356572

      target function =      -0.745491812705
              le_mean =     -22.814931558958
             les_mean =     520.970919870199
             stat err =       0.000543911118
             autocorr =       1.363183024222
   target nu stat err =       0.000543911118
   target dn stat err =       0.004018617752
      target stat err =       0.003379472158
              std dev =       0.658818596062
             le_variance =       0.434041942517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434060191797
                                         uncertainty =       0.002215126132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434060191797
                                         uncertainty =       0.002215126132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465859726
  error estimate for blocks of size 2^( 2) =       0.000490824387
  error estimate for blocks of size 2^( 3) =       0.000514691306
  error estimate for blocks of size 2^( 4) =       0.000532124090
  error estimate for blocks of size 2^( 5) =       0.000542836588
  error estimate for blocks of size 2^( 6) =       0.000548321459
  error estimate for blocks of size 2^( 7) =       0.000552353401

      target function =      -0.745413194793
              le_mean =     -22.814931082094
             les_mean =     520.970993113876
             stat err =       0.000543908884
             autocorr =       1.363144741335
   target nu stat err =       0.000543908884
   target dn stat err =       0.004021426774
      target stat err =       0.003381054433
              std dev =       0.658825142191
             le_variance =       0.434050567982


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745377873922        initial
     2.4414e+00     2.4414e+01             1.1395e-04        -0.745511075113  <--
     9.7656e+00     9.7656e+01             2.8735e-05        -0.745491812705
     3.9062e+01     3.9062e+02             7.1993e-06        -0.745413194793

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 4.2827e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.319506e-01 3 1  ON 0
ci_02                -3.174949e-02 3 1  ON 1
ci_03                -3.144914e-02 3 1  ON 2
ci_04                 2.829095e-02 3 1  ON 3
ci_05                -2.360906e-02 3 1  ON 4
ci_06                -2.318118e-02 3 1  ON 5
ci_07                 2.699191e-02 3 1  ON 6
ci_08                -6.632227e-03 3 1  ON 7
ci_09                -9.496688e-03 3 1  ON 8
ci_10                -9.459620e-03 3 1  ON 9
ci_11                 1.310034e-02 3 1  ON 10
ci_12                 7.801442e-03 3 1  ON 11
ci_13                 1.271145e-02 3 1  ON 12
ci_14                 1.307108e-02 3 1  ON 13
ci_15                 7.190994e-03 3 1  ON 14
ci_16                 7.469457e-03 3 1  ON 15
ci_17                -7.737083e-03 3 1  ON 16
ci_18                -7.278350e-03 3 1  ON 17
ci_19                 9.378019e-03 3 1  ON 18
ci_20                 6.889556e-03 3 1  ON 19
ci_21                 8.792295e-03 3 1  ON 20
ci_22                 8.820376e-03 3 1  ON 21
ci_23                 4.976408e-03 3 1  ON 22
ci_24                 4.373563e-03 3 1  ON 23
ci_25                 3.163316e-03 3 1  ON 24
ci_26                 3.222364e-03 3 1  ON 25
ci_27                 3.321059e-03 3 1  ON 26
ci_28                 2.490177e-03 3 1  ON 27
ci_29                 2.115029e-03 3 1  ON 28
ci_30                -1.679864e-03 3 1  ON 29
ci_31                -1.622861e-03 3 1  ON 30
ci_32                -1.387560e-03 3 1  ON 31
ci_33                -1.061733e-03 3 1  ON 32
ci_34                 1.525939e-03 3 1  ON 33
ci_35                 1.297501e-03 3 1  ON 34
ci_36                -1.219884e-03 3 1  ON 35
ci_37                -1.168710e-03 3 1  ON 36
ci_38                -5.169008e-04 3 1  ON 37
ci_39                -7.010567e-04 3 1  ON 38
ci_40                -1.681649e-03 3 1  ON 39
ci_41                -1.463110e-03 3 1  ON 40
ci_42                -1.183650e-03 3 1  ON 41
ci_43                -2.883538e-03 3 1  ON 42
ci_44                -1.753024e-03 3 1  ON 43
ci_45                -7.123239e-04 3 1  ON 44
ci_46                -5.583328e-04 3 1  ON 45
ci_47                 1.239833e-03 3 1  ON 46
ci_48                 7.031627e-04 3 1  ON 47
ci_49                -9.423930e-04 3 1  ON 48
ci_50                -7.211430e-04 3 1  ON 49
ci_51                 4.260210e-04 3 1  ON 50
ci_52                 4.317113e-04 3 1  ON 51
ci_53                -6.306146e-04 3 1  ON 52
ci_54                -9.357098e-04 3 1  ON 53
ci_55                -7.226809e-04 3 1  ON 54
ci_56                 1.894200e-03 3 1  ON 55
ci_57                 1.706267e-03 3 1  ON 56
ci_58                -7.364478e-04 3 1  ON 57
ci_59                -1.017404e-03 3 1  ON 58
ci_60                 5.594439e-04 3 1  ON 59
ci_61                 6.627911e-04 3 1  ON 60
ci_62                -2.775505e-04 3 1  ON 61
ci_63                -5.694870e-04 3 1  ON 62
ci_64                -4.722294e-04 3 1  ON 63
ci_65                -2.842880e-04 3 1  ON 64
ci_66                -7.159759e-04 3 1  ON 65
ci_67                -5.695930e-04 3 1  ON 66
ci_68                -6.412678e-04 3 1  ON 67
ci_69                 6.672673e-06 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3273e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.764
    reference variance = 0.37133
====================================================
  Execution time = 2.5980e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5223e-01
  Total weights = 1.963974077e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5319e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438819187251
                                         uncertainty =       0.003017652971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438819187251
                                         uncertainty =       0.003017652971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468395548
  error estimate for blocks of size 2^( 2) =       0.000494086101
  error estimate for blocks of size 2^( 3) =       0.000517866750
  error estimate for blocks of size 2^( 4) =       0.000535339693
  error estimate for blocks of size 2^( 5) =       0.000546630237
  error estimate for blocks of size 2^( 6) =       0.000552685778
  error estimate for blocks of size 2^( 7) =       0.000556747748

      target function =      -0.743497544434
              le_mean =     -22.813837309933
             les_mean =     520.923400306859
             stat err =       0.000547850864
             autocorr =       1.368041224607
   target nu stat err =       0.000547850864
   target dn stat err =       0.004816317323
      target stat err =       0.004003493375
              std dev =       0.662411336669
             le_variance =       0.438788778948


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281383730993e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743517974022       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743559649205       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743563526745       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743564588487       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743564897846       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743565030050       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743565054021       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743565040461       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743565033290       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743565033528       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 3.765006e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743517974022       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743529009603       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743530013576       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743530283923       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743530360475       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743530392024       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743530397044       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743530393606       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743530391881       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 9.725656e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743517974022       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743520774359       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743521027580       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743521095460       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743521114532       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743521122316       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743521123508       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743521122647       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743521122220       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 2.452381e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190546 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0521e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.318534e-01 3 1  ON 0
ci_02                -3.167090e-02 3 1  ON 1
ci_03                -3.136140e-02 3 1  ON 2
ci_04                 2.821694e-02 3 1  ON 3
ci_05                -2.355523e-02 3 1  ON 4
ci_06                -2.310155e-02 3 1  ON 5
ci_07                 2.699136e-02 3 1  ON 6
ci_08                -6.597393e-03 3 1  ON 7
ci_09                -9.477706e-03 3 1  ON 8
ci_10                -9.449675e-03 3 1  ON 9
ci_11                 1.307668e-02 3 1  ON 10
ci_12                 7.790891e-03 3 1  ON 11
ci_13                 1.269843e-02 3 1  ON 12
ci_14                 1.308614e-02 3 1  ON 13
ci_15                 7.183985e-03 3 1  ON 14
ci_16                 7.441839e-03 3 1  ON 15
ci_17                -7.681871e-03 3 1  ON 16
ci_18                -7.267041e-03 3 1  ON 17
ci_19                 9.395193e-03 3 1  ON 18
ci_20                 6.850763e-03 3 1  ON 19
ci_21                 8.782618e-03 3 1  ON 20
ci_22                 8.818947e-03 3 1  ON 21
ci_23                 4.983812e-03 3 1  ON 22
ci_24                 4.356114e-03 3 1  ON 23
ci_25                 3.147678e-03 3 1  ON 24
ci_26                 3.217687e-03 3 1  ON 25
ci_27                 3.307176e-03 3 1  ON 26
ci_28                 2.462401e-03 3 1  ON 27
ci_29                 2.129255e-03 3 1  ON 28
ci_30                -1.671150e-03 3 1  ON 29
ci_31                -1.598002e-03 3 1  ON 30
ci_32                -1.422047e-03 3 1  ON 31
ci_33                -1.059100e-03 3 1  ON 32
ci_34                 1.521917e-03 3 1  ON 33
ci_35                 1.295610e-03 3 1  ON 34
ci_36                -1.218017e-03 3 1  ON 35
ci_37                -1.163171e-03 3 1  ON 36
ci_38                -5.135703e-04 3 1  ON 37
ci_39                -6.830243e-04 3 1  ON 38
ci_40                -1.679495e-03 3 1  ON 39
ci_41                -1.444301e-03 3 1  ON 40
ci_42                -1.188168e-03 3 1  ON 41
ci_43                -2.908547e-03 3 1  ON 42
ci_44                -1.744693e-03 3 1  ON 43
ci_45                -7.195127e-04 3 1  ON 44
ci_46                -5.543972e-04 3 1  ON 45
ci_47                 1.258100e-03 3 1  ON 46
ci_48                 7.143955e-04 3 1  ON 47
ci_49                -9.118076e-04 3 1  ON 48
ci_50                -7.287100e-04 3 1  ON 49
ci_51                 3.927828e-04 3 1  ON 50
ci_52                 4.411993e-04 3 1  ON 51
ci_53                -6.406461e-04 3 1  ON 52
ci_54                -9.416658e-04 3 1  ON 53
ci_55                -7.170581e-04 3 1  ON 54
ci_56                 1.878289e-03 3 1  ON 55
ci_57                 1.699553e-03 3 1  ON 56
ci_58                -7.162856e-04 3 1  ON 57
ci_59                -1.008244e-03 3 1  ON 58
ci_60                 5.370611e-04 3 1  ON 59
ci_61                 6.619279e-04 3 1  ON 60
ci_62                -2.783975e-04 3 1  ON 61
ci_63                -5.591774e-04 3 1  ON 62
ci_64                -4.422443e-04 3 1  ON 63
ci_65                -2.844136e-04 3 1  ON 64
ci_66                -7.176886e-04 3 1  ON 65
ci_67                -5.797344e-04 3 1  ON 66
ci_68                -6.502771e-04 3 1  ON 67
ci_69                -2.417812e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7799
    reference variance = 0.502707
====================================================
  Execution time = 2.5316e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4640e-01
  Total weights = 1.9641e+06
  Execution time = 3.4973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434976133177
                                         uncertainty =       0.002048049471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434976133177
                                         uncertainty =       0.002048049471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466418952
  error estimate for blocks of size 2^( 2) =       0.000491786637
  error estimate for blocks of size 2^( 3) =       0.000515763897
  error estimate for blocks of size 2^( 4) =       0.000533096319
  error estimate for blocks of size 2^( 5) =       0.000543562321
  error estimate for blocks of size 2^( 6) =       0.000550065374
  error estimate for blocks of size 2^( 7) =       0.000556028984

      target function =      -0.748380056151
              le_mean =     -22.814157411859
             les_mean =     520.932123570691
             stat err =       0.000545688249
             autocorr =       1.368790010013
   target nu stat err =       0.000545688249
   target dn stat err =       0.002550975050
      target stat err =       0.002209750541
              std dev =       0.659616007109
             le_variance =       0.435093276834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434901939371
                                         uncertainty =       0.002050675992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434901939371
                                         uncertainty =       0.002050675992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466378887
  error estimate for blocks of size 2^( 2) =       0.000491769907
  error estimate for blocks of size 2^( 3) =       0.000515766902
  error estimate for blocks of size 2^( 4) =       0.000533115559
  error estimate for blocks of size 2^( 5) =       0.000543592333
  error estimate for blocks of size 2^( 6) =       0.000550107248
  error estimate for blocks of size 2^( 7) =       0.000556070991

      target function =      -0.747999966635
              le_mean =     -22.814155245145
             les_mean =     520.932481082715
             stat err =       0.000545721533
             autocorr =       1.369192199850
   target nu stat err =       0.000545721533
   target dn stat err =       0.002587373511
      target stat err =       0.002236727614
              std dev =       0.659559347670
             le_variance =       0.435018533098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434935230136
                                         uncertainty =       0.002049393633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434935230136
                                         uncertainty =       0.002049393633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466396866
  error estimate for blocks of size 2^( 2) =       0.000491776723
  error estimate for blocks of size 2^( 3) =       0.000515764237
  error estimate for blocks of size 2^( 4) =       0.000533105433
  error estimate for blocks of size 2^( 5) =       0.000543577130
  error estimate for blocks of size 2^( 6) =       0.000550086239
  error estimate for blocks of size 2^( 7) =       0.000556049144

      target function =      -0.745634276646
              le_mean =     -22.814155940527
             les_mean =     520.935353569310
             stat err =       0.000545704487
             autocorr =       1.369001113786
   target nu stat err =       0.000545704487
   target dn stat err =       0.004139992107
      target stat err =       0.003475977277
              std dev =       0.659584773587
             le_variance =       0.435052073548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434970711351
                                         uncertainty =       0.002048215790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434970711351
                                         uncertainty =       0.002048215790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466416025
  error estimate for blocks of size 2^( 2) =       0.000491785258
  error estimate for blocks of size 2^( 3) =       0.000515763820
  error estimate for blocks of size 2^( 4) =       0.000533097334
  error estimate for blocks of size 2^( 5) =       0.000543564009
  error estimate for blocks of size 2^( 6) =       0.000550067830
  error estimate for blocks of size 2^( 7) =       0.000556031483

      target function =      -0.748378762464
              le_mean =     -22.814157205539
             les_mean =     520.932115703805
             stat err =       0.000545690164
             autocorr =       1.368816793800
   target nu stat err =       0.000545690164
   target dn stat err =       0.002551822250
      target stat err =       0.002210421560
              std dev =       0.659611868296
             le_variance =       0.435087816797


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748380056151        initial  <--
     6.1035e-01     6.1035e+00             3.7650e-04        -0.747999966635
     2.4414e+00     2.4414e+01             9.7257e-05        -0.745634276646
     9.7656e+00     9.7656e+01             2.4524e-05        -0.748378762464

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8909
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.319506e-01 3 1  ON 0
ci_02                -3.174949e-02 3 1  ON 1
ci_03                -3.144914e-02 3 1  ON 2
ci_04                 2.829095e-02 3 1  ON 3
ci_05                -2.360906e-02 3 1  ON 4
ci_06                -2.318118e-02 3 1  ON 5
ci_07                 2.699191e-02 3 1  ON 6
ci_08                -6.632227e-03 3 1  ON 7
ci_09                -9.496688e-03 3 1  ON 8
ci_10                -9.459620e-03 3 1  ON 9
ci_11                 1.310034e-02 3 1  ON 10
ci_12                 7.801442e-03 3 1  ON 11
ci_13                 1.271145e-02 3 1  ON 12
ci_14                 1.307108e-02 3 1  ON 13
ci_15                 7.190994e-03 3 1  ON 14
ci_16                 7.469457e-03 3 1  ON 15
ci_17                -7.737083e-03 3 1  ON 16
ci_18                -7.278350e-03 3 1  ON 17
ci_19                 9.378019e-03 3 1  ON 18
ci_20                 6.889556e-03 3 1  ON 19
ci_21                 8.792295e-03 3 1  ON 20
ci_22                 8.820376e-03 3 1  ON 21
ci_23                 4.976408e-03 3 1  ON 22
ci_24                 4.373563e-03 3 1  ON 23
ci_25                 3.163316e-03 3 1  ON 24
ci_26                 3.222364e-03 3 1  ON 25
ci_27                 3.321059e-03 3 1  ON 26
ci_28                 2.490177e-03 3 1  ON 27
ci_29                 2.115029e-03 3 1  ON 28
ci_30                -1.679864e-03 3 1  ON 29
ci_31                -1.622861e-03 3 1  ON 30
ci_32                -1.387560e-03 3 1  ON 31
ci_33                -1.061733e-03 3 1  ON 32
ci_34                 1.525939e-03 3 1  ON 33
ci_35                 1.297501e-03 3 1  ON 34
ci_36                -1.219884e-03 3 1  ON 35
ci_37                -1.168710e-03 3 1  ON 36
ci_38                -5.169008e-04 3 1  ON 37
ci_39                -7.010567e-04 3 1  ON 38
ci_40                -1.681649e-03 3 1  ON 39
ci_41                -1.463110e-03 3 1  ON 40
ci_42                -1.183650e-03 3 1  ON 41
ci_43                -2.883538e-03 3 1  ON 42
ci_44                -1.753024e-03 3 1  ON 43
ci_45                -7.123239e-04 3 1  ON 44
ci_46                -5.583328e-04 3 1  ON 45
ci_47                 1.239833e-03 3 1  ON 46
ci_48                 7.031627e-04 3 1  ON 47
ci_49                -9.423930e-04 3 1  ON 48
ci_50                -7.211430e-04 3 1  ON 49
ci_51                 4.260210e-04 3 1  ON 50
ci_52                 4.317113e-04 3 1  ON 51
ci_53                -6.306146e-04 3 1  ON 52
ci_54                -9.357098e-04 3 1  ON 53
ci_55                -7.226809e-04 3 1  ON 54
ci_56                 1.894200e-03 3 1  ON 55
ci_57                 1.706267e-03 3 1  ON 56
ci_58                -7.364478e-04 3 1  ON 57
ci_59                -1.017404e-03 3 1  ON 58
ci_60                 5.594439e-04 3 1  ON 59
ci_61                 6.627911e-04 3 1  ON 60
ci_62                -2.775505e-04 3 1  ON 61
ci_63                -5.694870e-04 3 1  ON 62
ci_64                -4.722294e-04 3 1  ON 63
ci_65                -2.842880e-04 3 1  ON 64
ci_66                -7.159759e-04 3 1  ON 65
ci_67                -5.695930e-04 3 1  ON 66
ci_68                -6.412678e-04 3 1  ON 67
ci_69                 6.672673e-06 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3418e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7441
    reference variance = 0.353977
====================================================
  Execution time = 2.5983e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4812e-01
  Total weights = 1.964148755e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436203832147
                                         uncertainty =       0.002528247307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436203832147
                                         uncertainty =       0.002528247307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466994959
  error estimate for blocks of size 2^( 2) =       0.000491875412
  error estimate for blocks of size 2^( 3) =       0.000515780335
  error estimate for blocks of size 2^( 4) =       0.000533037576
  error estimate for blocks of size 2^( 5) =       0.000543657541
  error estimate for blocks of size 2^( 6) =       0.000547548608
  error estimate for blocks of size 2^( 7) =       0.000550573542

      target function =      -0.746898027587
              le_mean =     -22.813946060911
             les_mean =     520.924258166732
             stat err =       0.000543704317
             autocorr =       1.355505167152
   target nu stat err =       0.000543704317
   target dn stat err =       0.003113131703
      target stat err =       0.002651453094
              std dev =       0.660430604189
             le_variance =       0.436168582950


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281394606091e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746906352339       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746910252444       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746910916704       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746911038263       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746911054329       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746911057711       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746911051625       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746911050819       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746911048614       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746911049294       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 5.023966e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746906352339       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746907333225       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746907499899       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746907530308       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746907534284       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746907535107       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746907533584       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746907533383       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746907532836       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746907533006       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 1.260321e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746906352339       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746906597930       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746906639636       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746906647240       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746906648231       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746906648436       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746906648055       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746906648005       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746906647868       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746906647911       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 3.153522e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194030 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0519e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.319380e-01 3 1  ON 0
ci_02                -3.174375e-02 3 1  ON 1
ci_03                -3.143781e-02 3 1  ON 2
ci_04                 2.828461e-02 3 1  ON 3
ci_05                -2.359981e-02 3 1  ON 4
ci_06                -2.318107e-02 3 1  ON 5
ci_07                 2.698966e-02 3 1  ON 6
ci_08                -6.629057e-03 3 1  ON 7
ci_09                -9.492379e-03 3 1  ON 8
ci_10                -9.456947e-03 3 1  ON 9
ci_11                 1.309857e-02 3 1  ON 10
ci_12                 7.797110e-03 3 1  ON 11
ci_13                 1.271225e-02 3 1  ON 12
ci_14                 1.306927e-02 3 1  ON 13
ci_15                 7.190951e-03 3 1  ON 14
ci_16                 7.464986e-03 3 1  ON 15
ci_17                -7.735958e-03 3 1  ON 16
ci_18                -7.279432e-03 3 1  ON 17
ci_19                 9.377142e-03 3 1  ON 18
ci_20                 6.888898e-03 3 1  ON 19
ci_21                 8.791286e-03 3 1  ON 20
ci_22                 8.819342e-03 3 1  ON 21
ci_23                 4.977681e-03 3 1  ON 22
ci_24                 4.372948e-03 3 1  ON 23
ci_25                 3.164635e-03 3 1  ON 24
ci_26                 3.223361e-03 3 1  ON 25
ci_27                 3.323090e-03 3 1  ON 26
ci_28                 2.488352e-03 3 1  ON 27
ci_29                 2.115636e-03 3 1  ON 28
ci_30                -1.678328e-03 3 1  ON 29
ci_31                -1.621519e-03 3 1  ON 30
ci_32                -1.386015e-03 3 1  ON 31
ci_33                -1.061895e-03 3 1  ON 32
ci_34                 1.526173e-03 3 1  ON 33
ci_35                 1.299745e-03 3 1  ON 34
ci_36                -1.220897e-03 3 1  ON 35
ci_37                -1.168723e-03 3 1  ON 36
ci_38                -5.164595e-04 3 1  ON 37
ci_39                -7.008797e-04 3 1  ON 38
ci_40                -1.680830e-03 3 1  ON 39
ci_41                -1.461416e-03 3 1  ON 40
ci_42                -1.184738e-03 3 1  ON 41
ci_43                -2.882223e-03 3 1  ON 42
ci_44                -1.755451e-03 3 1  ON 43
ci_45                -7.117850e-04 3 1  ON 44
ci_46                -5.579581e-04 3 1  ON 45
ci_47                 1.238076e-03 3 1  ON 46
ci_48                 7.046862e-04 3 1  ON 47
ci_49                -9.428569e-04 3 1  ON 48
ci_50                -7.211951e-04 3 1  ON 49
ci_51                 4.237695e-04 3 1  ON 50
ci_52                 4.321706e-04 3 1  ON 51
ci_53                -6.308963e-04 3 1  ON 52
ci_54                -9.360882e-04 3 1  ON 53
ci_55                -7.214481e-04 3 1  ON 54
ci_56                 1.895002e-03 3 1  ON 55
ci_57                 1.706498e-03 3 1  ON 56
ci_58                -7.365706e-04 3 1  ON 57
ci_59                -1.015857e-03 3 1  ON 58
ci_60                 5.569742e-04 3 1  ON 59
ci_61                 6.615745e-04 3 1  ON 60
ci_62                -2.777154e-04 3 1  ON 61
ci_63                -5.705498e-04 3 1  ON 62
ci_64                -4.717042e-04 3 1  ON 63
ci_65                -2.836956e-04 3 1  ON 64
ci_66                -7.149252e-04 3 1  ON 65
ci_67                -5.708986e-04 3 1  ON 66
ci_68                -6.409939e-04 3 1  ON 67
ci_69                 5.240628e-06 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.9015
    reference variance = 0.405593
====================================================
  Execution time = 2.5180e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5022e-01
  Total weights = 1.9641e+06
  Execution time = 3.4946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436849907759
                                         uncertainty =       0.002219564876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436849907759
                                         uncertainty =       0.002219564876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467378691
  error estimate for blocks of size 2^( 2) =       0.000492031135
  error estimate for blocks of size 2^( 3) =       0.000515569324
  error estimate for blocks of size 2^( 4) =       0.000532493050
  error estimate for blocks of size 2^( 5) =       0.000543708286
  error estimate for blocks of size 2^( 6) =       0.000550928577
  error estimate for blocks of size 2^( 7) =       0.000555963547

      target function =      -0.745158091598
              le_mean =     -22.814328473039
             les_mean =     520.943810984346
             stat err =       0.000545773365
             autocorr =       1.363599583229
   target nu stat err =       0.000545773365
   target dn stat err =       0.003253515284
      target stat err =       0.002754454369
              std dev =       0.660973283195
             le_variance =       0.436885681098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436834505417
                                         uncertainty =       0.002218305285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436834505417
                                         uncertainty =       0.002218305285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467370449
  error estimate for blocks of size 2^( 2) =       0.000492025316
  error estimate for blocks of size 2^( 3) =       0.000515565549
  error estimate for blocks of size 2^( 4) =       0.000532490615
  error estimate for blocks of size 2^( 5) =       0.000543707128
  error estimate for blocks of size 2^( 6) =       0.000550927984
  error estimate for blocks of size 2^( 7) =       0.000555963318

      target function =      -0.745171960753
              le_mean =     -22.814328359349
             les_mean =     520.943789012811
             stat err =       0.000545772261
             autocorr =       1.363642158376
   target nu stat err =       0.000545772261
   target dn stat err =       0.003252472649
      target stat err =       0.002753713519
              std dev =       0.660961627238
             le_variance =       0.436870272681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436842140927
                                         uncertainty =       0.002218930792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436842140927
                                         uncertainty =       0.002218930792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467374535
  error estimate for blocks of size 2^( 2) =       0.000492028197
  error estimate for blocks of size 2^( 3) =       0.000515567413
  error estimate for blocks of size 2^( 4) =       0.000532491812
  error estimate for blocks of size 2^( 5) =       0.000543707690
  error estimate for blocks of size 2^( 6) =       0.000550928265
  error estimate for blocks of size 2^( 7) =       0.000555963418

      target function =      -0.745166268693
              le_mean =     -22.814328412200
             les_mean =     520.943798312176
             stat err =       0.000545772796
             autocorr =       1.363620991635
   target nu stat err =       0.000545772796
   target dn stat err =       0.003252950523
      target stat err =       0.002754057886
              std dev =       0.660967405554
             le_variance =       0.436877911205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436848933008
                                         uncertainty =       0.002219485440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436848933008
                                         uncertainty =       0.002219485440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467378169
  error estimate for blocks of size 2^( 2) =       0.000492030766
  error estimate for blocks of size 2^( 3) =       0.000515569083
  error estimate for blocks of size 2^( 4) =       0.000532492894
  error estimate for blocks of size 2^( 5) =       0.000543708210
  error estimate for blocks of size 2^( 6) =       0.000550928537
  error estimate for blocks of size 2^( 7) =       0.000555963530

      target function =      -0.745159274168
              le_mean =     -22.814328465014
             les_mean =     520.943809186938
             stat err =       0.000545773293
             autocorr =       1.363602263463
   target nu stat err =       0.000545773293
   target dn stat err =       0.003253439830
      target stat err =       0.002754402050
              std dev =       0.660972545544
             le_variance =       0.436884705963


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745158091598        initial
     6.1035e+00     6.1035e+01             5.0240e-05        -0.745171960753  <--
     2.4414e+01     2.4414e+02             1.2603e-05        -0.745166268693
     9.7656e+01     9.7656e+02             3.1535e-06        -0.745159274168

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 4.5570e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.319004e-01 3 1  ON 0
ci_02                -3.172666e-02 3 1  ON 1
ci_03                -3.140406e-02 3 1  ON 2
ci_04                 2.826575e-02 3 1  ON 3
ci_05                -2.357226e-02 3 1  ON 4
ci_06                -2.318075e-02 3 1  ON 5
ci_07                 2.698296e-02 3 1  ON 6
ci_08                -6.619619e-03 3 1  ON 7
ci_09                -9.479535e-03 3 1  ON 8
ci_10                -9.448981e-03 3 1  ON 9
ci_11                 1.309329e-02 3 1  ON 10
ci_12                 7.784217e-03 3 1  ON 11
ci_13                 1.271465e-02 3 1  ON 12
ci_14                 1.306385e-02 3 1  ON 13
ci_15                 7.190823e-03 3 1  ON 14
ci_16                 7.451667e-03 3 1  ON 15
ci_17                -7.732602e-03 3 1  ON 16
ci_18                -7.282654e-03 3 1  ON 17
ci_19                 9.374536e-03 3 1  ON 18
ci_20                 6.886940e-03 3 1  ON 19
ci_21                 8.788269e-03 3 1  ON 20
ci_22                 8.816260e-03 3 1  ON 21
ci_23                 4.981469e-03 3 1  ON 22
ci_24                 4.371114e-03 3 1  ON 23
ci_25                 3.168557e-03 3 1  ON 24
ci_26                 3.226333e-03 3 1  ON 25
ci_27                 3.329138e-03 3 1  ON 26
ci_28                 2.482911e-03 3 1  ON 27
ci_29                 2.117440e-03 3 1  ON 28
ci_30                -1.673739e-03 3 1  ON 29
ci_31                -1.617510e-03 3 1  ON 30
ci_32                -1.381416e-03 3 1  ON 31
ci_33                -1.062381e-03 3 1  ON 32
ci_34                 1.526875e-03 3 1  ON 33
ci_35                 1.306432e-03 3 1  ON 34
ci_36                -1.223910e-03 3 1  ON 35
ci_37                -1.168760e-03 3 1  ON 36
ci_38                -5.151465e-04 3 1  ON 37
ci_39                -7.003508e-04 3 1  ON 38
ci_40                -1.678397e-03 3 1  ON 39
ci_41                -1.456378e-03 3 1  ON 40
ci_42                -1.187977e-03 3 1  ON 41
ci_43                -2.878297e-03 3 1  ON 42
ci_44                -1.762679e-03 3 1  ON 43
ci_45                -7.101806e-04 3 1  ON 44
ci_46                -5.568415e-04 3 1  ON 45
ci_47                 1.232842e-03 3 1  ON 46
ci_48                 7.092374e-04 3 1  ON 47
ci_49                -9.442350e-04 3 1  ON 48
ci_50                -7.213494e-04 3 1  ON 49
ci_51                 4.170697e-04 3 1  ON 50
ci_52                 4.335372e-04 3 1  ON 51
ci_53                -6.317330e-04 3 1  ON 52
ci_54                -9.372145e-04 3 1  ON 53
ci_55                -7.177743e-04 3 1  ON 54
ci_56                 1.897386e-03 3 1  ON 55
ci_57                 1.707189e-03 3 1  ON 56
ci_58                -7.369357e-04 3 1  ON 57
ci_59                -1.011254e-03 3 1  ON 58
ci_60                 5.495917e-04 3 1  ON 59
ci_61                 6.579389e-04 3 1  ON 60
ci_62                -2.782040e-04 3 1  ON 61
ci_63                -5.737095e-04 3 1  ON 62
ci_64                -4.701405e-04 3 1  ON 63
ci_65                -2.819310e-04 3 1  ON 64
ci_66                -7.117977e-04 3 1  ON 65
ci_67                -5.747847e-04 3 1  ON 66
ci_68                -6.401757e-04 3 1  ON 67
ci_69                 9.756090e-07 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6095e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.883
    reference variance = 0.367605
====================================================
  Execution time = 2.5893e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5380e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4990e-01
  Total weights = 1.964374735e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5702e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436702785183
                                         uncertainty =       0.002716173930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436702785183
                                         uncertainty =       0.002716173930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467256646
  error estimate for blocks of size 2^( 2) =       0.000492348773
  error estimate for blocks of size 2^( 3) =       0.000516466094
  error estimate for blocks of size 2^( 4) =       0.000534489965
  error estimate for blocks of size 2^( 5) =       0.000546132468
  error estimate for blocks of size 2^( 6) =       0.000551909961
  error estimate for blocks of size 2^( 7) =       0.000557073632

      target function =      -0.745421708032
              le_mean =     -22.813703601447
             les_mean =     520.914974349096
             stat err =       0.000547401506
             autocorr =       1.372464123750
   target nu stat err =       0.000547401506
   target dn stat err =       0.003571150969
      target stat err =       0.003010612500
              std dev =       0.660800686563
             le_variance =       0.436657547362


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281370360145e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745433020066       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745452427738       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745454748300       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745455100914       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745455275364       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745455361654       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745455338567       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745455331317       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745455337889       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745455336048       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 1.687668e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745433020066       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745437987525       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745438576056       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745438664354       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745438707696       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745438728726       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745438722854       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745438721059       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745438722688       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745438722230       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 4.311704e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745433020066       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745434269368       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745434417032       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745434439113       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745434449930       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745434455153       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745434453679       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745434453231       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745434453637       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745434453523       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 1.083868e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197525 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0473e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.318631e-01 3 1  ON 0
ci_02                -3.168354e-02 3 1  ON 1
ci_03                -3.138269e-02 3 1  ON 2
ci_04                 2.823325e-02 3 1  ON 3
ci_05                -2.354862e-02 3 1  ON 4
ci_06                -2.315405e-02 3 1  ON 5
ci_07                 2.697222e-02 3 1  ON 6
ci_08                -6.608356e-03 3 1  ON 7
ci_09                -9.462540e-03 3 1  ON 8
ci_10                -9.431294e-03 3 1  ON 9
ci_11                 1.308911e-02 3 1  ON 10
ci_12                 7.774328e-03 3 1  ON 11
ci_13                 1.270301e-02 3 1  ON 12
ci_14                 1.307361e-02 3 1  ON 13
ci_15                 7.191160e-03 3 1  ON 14
ci_16                 7.438799e-03 3 1  ON 15
ci_17                -7.706591e-03 3 1  ON 16
ci_18                -7.292988e-03 3 1  ON 17
ci_19                 9.375981e-03 3 1  ON 18
ci_20                 6.874835e-03 3 1  ON 19
ci_21                 8.781243e-03 3 1  ON 20
ci_22                 8.805579e-03 3 1  ON 21
ci_23                 4.991103e-03 3 1  ON 22
ci_24                 4.368031e-03 3 1  ON 23
ci_25                 3.171507e-03 3 1  ON 24
ci_26                 3.244193e-03 3 1  ON 25
ci_27                 3.329128e-03 3 1  ON 26
ci_28                 2.481077e-03 3 1  ON 27
ci_29                 2.116988e-03 3 1  ON 28
ci_30                -1.668043e-03 3 1  ON 29
ci_31                -1.611042e-03 3 1  ON 30
ci_32                -1.382019e-03 3 1  ON 31
ci_33                -1.065829e-03 3 1  ON 32
ci_34                 1.522154e-03 3 1  ON 33
ci_35                 1.316143e-03 3 1  ON 34
ci_36                -1.212561e-03 3 1  ON 35
ci_37                -1.160938e-03 3 1  ON 36
ci_38                -5.076789e-04 3 1  ON 37
ci_39                -6.956777e-04 3 1  ON 38
ci_40                -1.680975e-03 3 1  ON 39
ci_41                -1.447706e-03 3 1  ON 40
ci_42                -1.191903e-03 3 1  ON 41
ci_43                -2.876532e-03 3 1  ON 42
ci_44                -1.751569e-03 3 1  ON 43
ci_45                -7.123803e-04 3 1  ON 44
ci_46                -5.596077e-04 3 1  ON 45
ci_47                 1.237991e-03 3 1  ON 46
ci_48                 7.182358e-04 3 1  ON 47
ci_49                -9.402265e-04 3 1  ON 48
ci_50                -7.186315e-04 3 1  ON 49
ci_51                 4.169320e-04 3 1  ON 50
ci_52                 4.319024e-04 3 1  ON 51
ci_53                -6.299638e-04 3 1  ON 52
ci_54                -9.415334e-04 3 1  ON 53
ci_55                -7.203764e-04 3 1  ON 54
ci_56                 1.900205e-03 3 1  ON 55
ci_57                 1.708011e-03 3 1  ON 56
ci_58                -7.323247e-04 3 1  ON 57
ci_59                -1.023587e-03 3 1  ON 58
ci_60                 5.624725e-04 3 1  ON 59
ci_61                 6.472698e-04 3 1  ON 60
ci_62                -2.784996e-04 3 1  ON 61
ci_63                -5.737603e-04 3 1  ON 62
ci_64                -4.750126e-04 3 1  ON 63
ci_65                -2.858522e-04 3 1  ON 64
ci_66                -7.179315e-04 3 1  ON 65
ci_67                -5.632113e-04 3 1  ON 66
ci_68                -6.334471e-04 3 1  ON 67
ci_69                -8.845951e-06 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7926
    reference variance = 0.266968
====================================================
  Execution time = 2.5280e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4841e-01
  Total weights = 1.9639e+06
  Execution time = 3.5030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434736282943
                                         uncertainty =       0.002433133082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434736282943
                                         uncertainty =       0.002433133082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466211720
  error estimate for blocks of size 2^( 2) =       0.000491823185
  error estimate for blocks of size 2^( 3) =       0.000515568972
  error estimate for blocks of size 2^( 4) =       0.000533581454
  error estimate for blocks of size 2^( 5) =       0.000545234193
  error estimate for blocks of size 2^( 6) =       0.000551922239
  error estimate for blocks of size 2^( 7) =       0.000557882590

      target function =      -0.746690664241
              le_mean =     -22.814801217310
             les_mean =     520.963533308699
             stat err =       0.000547155119
             autocorr =       1.377382498340
   target nu stat err =       0.000547155119
   target dn stat err =       0.002975133472
      target stat err =       0.002542920329
              std dev =       0.659322936658
             le_variance =       0.434706734804

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.170598
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434700653399
                                         uncertainty =       0.002432223191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434700653399
                                         uncertainty =       0.002432223191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466192619
  error estimate for blocks of size 2^( 2) =       0.000491812204
  error estimate for blocks of size 2^( 3) =       0.000515566504
  error estimate for blocks of size 2^( 4) =       0.000533584625
  error estimate for blocks of size 2^( 5) =       0.000545240009
  error estimate for blocks of size 2^( 6) =       0.000551932297
  error estimate for blocks of size 2^( 7) =       0.000557891171

      target function =      -0.742488358450
              le_mean =     -22.814801995043
             les_mean =     520.968634586443
             stat err =       0.000547162026
             autocorr =       1.377530139811
   target nu stat err =       0.000547162026
   target dn stat err =       0.005728064483
      target stat err =       0.004739375103
              std dev =       0.659295925097
             le_variance =       0.434671116850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434717613340
                                         uncertainty =       0.002432654912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434717613340
                                         uncertainty =       0.002432654912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466201711
  error estimate for blocks of size 2^( 2) =       0.000491817333
  error estimate for blocks of size 2^( 3) =       0.000515567461
  error estimate for blocks of size 2^( 4) =       0.000533582839
  error estimate for blocks of size 2^( 5) =       0.000545236937
  error estimate for blocks of size 2^( 6) =       0.000551927167
  error estimate for blocks of size 2^( 7) =       0.000557886865

      target function =      -0.746615090287
              le_mean =     -22.814801525451
             les_mean =     520.963638359091
             stat err =       0.000547158452
             autocorr =       1.377458417349
   target nu stat err =       0.000547158452
   target dn stat err =       0.002987694249
      target stat err =       0.002552543695
              std dev =       0.659308783057
             le_variance =       0.434688071416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434733885397
                                         uncertainty =       0.002433071753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434733885397
                                         uncertainty =       0.002433071753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466210434
  error estimate for blocks of size 2^( 2) =       0.000491822423
  error estimate for blocks of size 2^( 3) =       0.000515568755
  error estimate for blocks of size 2^( 4) =       0.000533581601
  error estimate for blocks of size 2^( 5) =       0.000545234511
  error estimate for blocks of size 2^( 6) =       0.000551922828
  error estimate for blocks of size 2^( 7) =       0.000557883097

      target function =      -0.746684868809
              le_mean =     -22.814801248450
             les_mean =     520.963541704925
             stat err =       0.000547155509
             autocorr =       1.377392057488
   target nu stat err =       0.000547155509
   target dn stat err =       0.002976349576
      target stat err =       0.002543862209
              std dev =       0.659321119076
             le_variance =       0.434704338060


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746690664241        initial  <--
     1.5259e+00     1.5259e+01             1.6877e-04        -0.742488358450
     6.1035e+00     6.1035e+01             4.3117e-05        -0.746615090287
     2.4414e+01     2.4414e+02             1.0839e-05        -0.746684868809

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8973
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.319004e-01 3 1  ON 0
ci_02                -3.172666e-02 3 1  ON 1
ci_03                -3.140406e-02 3 1  ON 2
ci_04                 2.826575e-02 3 1  ON 3
ci_05                -2.357226e-02 3 1  ON 4
ci_06                -2.318075e-02 3 1  ON 5
ci_07                 2.698296e-02 3 1  ON 6
ci_08                -6.619619e-03 3 1  ON 7
ci_09                -9.479535e-03 3 1  ON 8
ci_10                -9.448981e-03 3 1  ON 9
ci_11                 1.309329e-02 3 1  ON 10
ci_12                 7.784217e-03 3 1  ON 11
ci_13                 1.271465e-02 3 1  ON 12
ci_14                 1.306385e-02 3 1  ON 13
ci_15                 7.190823e-03 3 1  ON 14
ci_16                 7.451667e-03 3 1  ON 15
ci_17                -7.732602e-03 3 1  ON 16
ci_18                -7.282654e-03 3 1  ON 17
ci_19                 9.374536e-03 3 1  ON 18
ci_20                 6.886940e-03 3 1  ON 19
ci_21                 8.788269e-03 3 1  ON 20
ci_22                 8.816260e-03 3 1  ON 21
ci_23                 4.981469e-03 3 1  ON 22
ci_24                 4.371114e-03 3 1  ON 23
ci_25                 3.168557e-03 3 1  ON 24
ci_26                 3.226333e-03 3 1  ON 25
ci_27                 3.329138e-03 3 1  ON 26
ci_28                 2.482911e-03 3 1  ON 27
ci_29                 2.117440e-03 3 1  ON 28
ci_30                -1.673739e-03 3 1  ON 29
ci_31                -1.617510e-03 3 1  ON 30
ci_32                -1.381416e-03 3 1  ON 31
ci_33                -1.062381e-03 3 1  ON 32
ci_34                 1.526875e-03 3 1  ON 33
ci_35                 1.306432e-03 3 1  ON 34
ci_36                -1.223910e-03 3 1  ON 35
ci_37                -1.168760e-03 3 1  ON 36
ci_38                -5.151465e-04 3 1  ON 37
ci_39                -7.003508e-04 3 1  ON 38
ci_40                -1.678397e-03 3 1  ON 39
ci_41                -1.456378e-03 3 1  ON 40
ci_42                -1.187977e-03 3 1  ON 41
ci_43                -2.878297e-03 3 1  ON 42
ci_44                -1.762679e-03 3 1  ON 43
ci_45                -7.101806e-04 3 1  ON 44
ci_46                -5.568415e-04 3 1  ON 45
ci_47                 1.232842e-03 3 1  ON 46
ci_48                 7.092374e-04 3 1  ON 47
ci_49                -9.442350e-04 3 1  ON 48
ci_50                -7.213494e-04 3 1  ON 49
ci_51                 4.170697e-04 3 1  ON 50
ci_52                 4.335372e-04 3 1  ON 51
ci_53                -6.317330e-04 3 1  ON 52
ci_54                -9.372145e-04 3 1  ON 53
ci_55                -7.177743e-04 3 1  ON 54
ci_56                 1.897386e-03 3 1  ON 55
ci_57                 1.707189e-03 3 1  ON 56
ci_58                -7.369357e-04 3 1  ON 57
ci_59                -1.011254e-03 3 1  ON 58
ci_60                 5.495917e-04 3 1  ON 59
ci_61                 6.579389e-04 3 1  ON 60
ci_62                -2.782040e-04 3 1  ON 61
ci_63                -5.737095e-04 3 1  ON 62
ci_64                -4.701405e-04 3 1  ON 63
ci_65                -2.819310e-04 3 1  ON 64
ci_66                -7.117977e-04 3 1  ON 65
ci_67                -5.747847e-04 3 1  ON 66
ci_68                -6.401757e-04 3 1  ON 67
ci_69                 9.756090e-07 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3380e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7741
    reference variance = 0.421197
====================================================
  Execution time = 2.5860e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4928e-01
  Total weights = 1.964114584e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5364e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435761790383
                                         uncertainty =       0.002502998681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435761790383
                                         uncertainty =       0.002502998681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466825221
  error estimate for blocks of size 2^( 2) =       0.000491961716
  error estimate for blocks of size 2^( 3) =       0.000515112793
  error estimate for blocks of size 2^( 4) =       0.000532069755
  error estimate for blocks of size 2^( 5) =       0.000542849406
  error estimate for blocks of size 2^( 6) =       0.000547934485
  error estimate for blocks of size 2^( 7) =       0.000550613330

      target function =      -0.745939852057
              le_mean =     -22.815077030320
             les_mean =     520.977022671994
             stat err =       0.000543366744
             autocorr =       1.354807169191
   target nu stat err =       0.000543366744
   target dn stat err =       0.003285304199
      target stat err =       0.002788302860
              std dev =       0.660190558824
             le_variance =       0.435851573961


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281507703032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745949387204       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745951916903       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745952349236       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745952452401       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745952502239       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745952526769       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745952531460       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745952528062       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745952527584       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745952527609       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745952527501       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 2.488776e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745949387204       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745950021187       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745950129435       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745950155234       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745950167688       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745950173809       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745950174976       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745950174127       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745950174008       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745950174014       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745950173987       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 6.230232e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745949387204       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745949545798       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745949572870       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745949579320       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745949582433       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745949583963       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745949584254       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745949584042       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745949584012       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745949584014       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745949584007       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 1.558077e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206465 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0414e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.318941e-01 3 1  ON 0
ci_02                -3.172429e-02 3 1  ON 1
ci_03                -3.139840e-02 3 1  ON 2
ci_04                 2.826422e-02 3 1  ON 3
ci_05                -2.356917e-02 3 1  ON 4
ci_06                -2.318016e-02 3 1  ON 5
ci_07                 2.698094e-02 3 1  ON 6
ci_08                -6.617987e-03 3 1  ON 7
ci_09                -9.479543e-03 3 1  ON 8
ci_10                -9.448200e-03 3 1  ON 9
ci_11                 1.309365e-02 3 1  ON 10
ci_12                 7.783651e-03 3 1  ON 11
ci_13                 1.271374e-02 3 1  ON 12
ci_14                 1.306609e-02 3 1  ON 13
ci_15                 7.191754e-03 3 1  ON 14
ci_16                 7.450883e-03 3 1  ON 15
ci_17                -7.730885e-03 3 1  ON 16
ci_18                -7.281199e-03 3 1  ON 17
ci_19                 9.374143e-03 3 1  ON 18
ci_20                 6.886418e-03 3 1  ON 19
ci_21                 8.787362e-03 3 1  ON 20
ci_22                 8.817220e-03 3 1  ON 21
ci_23                 4.981684e-03 3 1  ON 22
ci_24                 4.370557e-03 3 1  ON 23
ci_25                 3.166969e-03 3 1  ON 24
ci_26                 3.224832e-03 3 1  ON 25
ci_27                 3.329204e-03 3 1  ON 26
ci_28                 2.482704e-03 3 1  ON 27
ci_29                 2.116758e-03 3 1  ON 28
ci_30                -1.672210e-03 3 1  ON 29
ci_31                -1.617574e-03 3 1  ON 30
ci_32                -1.382033e-03 3 1  ON 31
ci_33                -1.061528e-03 3 1  ON 32
ci_34                 1.526715e-03 3 1  ON 33
ci_35                 1.305263e-03 3 1  ON 34
ci_36                -1.223279e-03 3 1  ON 35
ci_37                -1.166357e-03 3 1  ON 36
ci_38                -5.146970e-04 3 1  ON 37
ci_39                -7.003520e-04 3 1  ON 38
ci_40                -1.678092e-03 3 1  ON 39
ci_41                -1.456241e-03 3 1  ON 40
ci_42                -1.186639e-03 3 1  ON 41
ci_43                -2.878208e-03 3 1  ON 42
ci_44                -1.762299e-03 3 1  ON 43
ci_45                -7.129479e-04 3 1  ON 44
ci_46                -5.561436e-04 3 1  ON 45
ci_47                 1.233193e-03 3 1  ON 46
ci_48                 7.142569e-04 3 1  ON 47
ci_49                -9.441834e-04 3 1  ON 48
ci_50                -7.219910e-04 3 1  ON 49
ci_51                 4.169877e-04 3 1  ON 50
ci_52                 4.334912e-04 3 1  ON 51
ci_53                -6.318114e-04 3 1  ON 52
ci_54                -9.362182e-04 3 1  ON 53
ci_55                -7.183082e-04 3 1  ON 54
ci_56                 1.896989e-03 3 1  ON 55
ci_57                 1.707733e-03 3 1  ON 56
ci_58                -7.369925e-04 3 1  ON 57
ci_59                -1.011485e-03 3 1  ON 58
ci_60                 5.508594e-04 3 1  ON 59
ci_61                 6.605476e-04 3 1  ON 60
ci_62                -2.777286e-04 3 1  ON 61
ci_63                -5.739128e-04 3 1  ON 62
ci_64                -4.692057e-04 3 1  ON 63
ci_65                -2.825835e-04 3 1  ON 64
ci_66                -7.115962e-04 3 1  ON 65
ci_67                -5.745182e-04 3 1  ON 66
ci_68                -6.408635e-04 3 1  ON 67
ci_69                 3.255399e-07 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7784
    reference variance = 0.274164
====================================================
  Execution time = 2.5413e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5281e-01
  Total weights = 1.9640e+06
  Execution time = 3.5002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436423265354
                                         uncertainty =       0.002282686811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436423265354
                                         uncertainty =       0.002282686811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467070767
  error estimate for blocks of size 2^( 2) =       0.000492475969
  error estimate for blocks of size 2^( 3) =       0.000515831848
  error estimate for blocks of size 2^( 4) =       0.000532913845
  error estimate for blocks of size 2^( 5) =       0.000544366960
  error estimate for blocks of size 2^( 6) =       0.000551738731
  error estimate for blocks of size 2^( 7) =       0.000553332011

      target function =      -0.743022208403
              le_mean =     -22.815102884840
             les_mean =     520.981736865523
             stat err =       0.000545587887
             autocorr =       1.364470233823
   target nu stat err =       0.000545587887
   target dn stat err =       0.003357895064
      target stat err =       0.002825960625
              std dev =       0.660537813288
             le_variance =       0.436310202783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436419339704
                                         uncertainty =       0.002282420149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436419339704
                                         uncertainty =       0.002282420149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467068672
  error estimate for blocks of size 2^( 2) =       0.000492474871
  error estimate for blocks of size 2^( 3) =       0.000515831622
  error estimate for blocks of size 2^( 4) =       0.000532914038
  error estimate for blocks of size 2^( 5) =       0.000544367031
  error estimate for blocks of size 2^( 6) =       0.000551739446
  error estimate for blocks of size 2^( 7) =       0.000553333294

      target function =      -0.743016744801
              le_mean =     -22.815102708098
             les_mean =     520.981735440703
             stat err =       0.000545588452
             autocorr =       1.364485303005
   target nu stat err =       0.000545588452
   target dn stat err =       0.003358762282
      target stat err =       0.002826615948
              std dev =       0.660534850541
             le_variance =       0.436306288779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436421287189
                                         uncertainty =       0.002282552652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436421287189
                                         uncertainty =       0.002282552652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467069711
  error estimate for blocks of size 2^( 2) =       0.000492475413
  error estimate for blocks of size 2^( 3) =       0.000515831729
  error estimate for blocks of size 2^( 4) =       0.000532913937
  error estimate for blocks of size 2^( 5) =       0.000544366993
  error estimate for blocks of size 2^( 6) =       0.000551739085
  error estimate for blocks of size 2^( 7) =       0.000553332644

      target function =      -0.743023148046
              le_mean =     -22.815102794780
             les_mean =     520.981731610652
             stat err =       0.000545588165
             autocorr =       1.364477793075
   target nu stat err =       0.000545588165
   target dn stat err =       0.003358275119
      target stat err =       0.002826272559
              std dev =       0.660536320330
             le_variance =       0.436308230475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436423016717
                                         uncertainty =       0.002282669973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436423016717
                                         uncertainty =       0.002282669973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467070634
  error estimate for blocks of size 2^( 2) =       0.000492475899
  error estimate for blocks of size 2^( 3) =       0.000515831832
  error estimate for blocks of size 2^( 4) =       0.000532913856
  error estimate for blocks of size 2^( 5) =       0.000544366964
  error estimate for blocks of size 2^( 6) =       0.000551738775
  error estimate for blocks of size 2^( 7) =       0.000553332090

      target function =      -0.743022764143
              le_mean =     -22.815102873539
             les_mean =     520.981735673590
             stat err =       0.000545587921
             autocorr =       1.364471180117
   target nu stat err =       0.000545587921
   target dn stat err =       0.003357938187
      target stat err =       0.002825999353
              std dev =       0.660537625636
             le_variance =       0.436309954881


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743022208403        initial
     1.5259e+01     1.5259e+02             2.4888e-05        -0.743016744801
     6.1035e+01     6.1035e+02             6.2302e-06        -0.743023148046  <--
     2.4414e+02     2.4414e+03             1.5581e-06        -0.743022764143

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 4.3014e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.318941e-01 3 1  ON 0
ci_02                -3.172429e-02 3 1  ON 1
ci_03                -3.139840e-02 3 1  ON 2
ci_04                 2.826422e-02 3 1  ON 3
ci_05                -2.356917e-02 3 1  ON 4
ci_06                -2.318016e-02 3 1  ON 5
ci_07                 2.698094e-02 3 1  ON 6
ci_08                -6.617987e-03 3 1  ON 7
ci_09                -9.479543e-03 3 1  ON 8
ci_10                -9.448200e-03 3 1  ON 9
ci_11                 1.309365e-02 3 1  ON 10
ci_12                 7.783651e-03 3 1  ON 11
ci_13                 1.271374e-02 3 1  ON 12
ci_14                 1.306609e-02 3 1  ON 13
ci_15                 7.191754e-03 3 1  ON 14
ci_16                 7.450883e-03 3 1  ON 15
ci_17                -7.730885e-03 3 1  ON 16
ci_18                -7.281199e-03 3 1  ON 17
ci_19                 9.374143e-03 3 1  ON 18
ci_20                 6.886418e-03 3 1  ON 19
ci_21                 8.787362e-03 3 1  ON 20
ci_22                 8.817220e-03 3 1  ON 21
ci_23                 4.981684e-03 3 1  ON 22
ci_24                 4.370557e-03 3 1  ON 23
ci_25                 3.166969e-03 3 1  ON 24
ci_26                 3.224832e-03 3 1  ON 25
ci_27                 3.329204e-03 3 1  ON 26
ci_28                 2.482704e-03 3 1  ON 27
ci_29                 2.116758e-03 3 1  ON 28
ci_30                -1.672210e-03 3 1  ON 29
ci_31                -1.617574e-03 3 1  ON 30
ci_32                -1.382033e-03 3 1  ON 31
ci_33                -1.061528e-03 3 1  ON 32
ci_34                 1.526715e-03 3 1  ON 33
ci_35                 1.305263e-03 3 1  ON 34
ci_36                -1.223279e-03 3 1  ON 35
ci_37                -1.166357e-03 3 1  ON 36
ci_38                -5.146970e-04 3 1  ON 37
ci_39                -7.003520e-04 3 1  ON 38
ci_40                -1.678092e-03 3 1  ON 39
ci_41                -1.456241e-03 3 1  ON 40
ci_42                -1.186639e-03 3 1  ON 41
ci_43                -2.878208e-03 3 1  ON 42
ci_44                -1.762299e-03 3 1  ON 43
ci_45                -7.129479e-04 3 1  ON 44
ci_46                -5.561436e-04 3 1  ON 45
ci_47                 1.233193e-03 3 1  ON 46
ci_48                 7.142569e-04 3 1  ON 47
ci_49                -9.441834e-04 3 1  ON 48
ci_50                -7.219910e-04 3 1  ON 49
ci_51                 4.169877e-04 3 1  ON 50
ci_52                 4.334912e-04 3 1  ON 51
ci_53                -6.318114e-04 3 1  ON 52
ci_54                -9.362182e-04 3 1  ON 53
ci_55                -7.183082e-04 3 1  ON 54
ci_56                 1.896989e-03 3 1  ON 55
ci_57                 1.707733e-03 3 1  ON 56
ci_58                -7.369925e-04 3 1  ON 57
ci_59                -1.011485e-03 3 1  ON 58
ci_60                 5.508594e-04 3 1  ON 59
ci_61                 6.605476e-04 3 1  ON 60
ci_62                -2.777286e-04 3 1  ON 61
ci_63                -5.739128e-04 3 1  ON 62
ci_64                -4.692057e-04 3 1  ON 63
ci_65                -2.825835e-04 3 1  ON 64
ci_66                -7.115962e-04 3 1  ON 65
ci_67                -5.745182e-04 3 1  ON 66
ci_68                -6.408635e-04 3 1  ON 67
ci_69                 3.255399e-07 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3443e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.8259
    reference variance = 0.432091
====================================================
  Execution time = 2.5923e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5362e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4623e-01
  Total weights = 1.964182655e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5594e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434282273458
                                         uncertainty =       0.001966389621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434282273458
                                         uncertainty =       0.001966389621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465964596
  error estimate for blocks of size 2^( 2) =       0.000491087982
  error estimate for blocks of size 2^( 3) =       0.000514867315
  error estimate for blocks of size 2^( 4) =       0.000531753027
  error estimate for blocks of size 2^( 5) =       0.000541341583
  error estimate for blocks of size 2^( 6) =       0.000548045255
  error estimate for blocks of size 2^( 7) =       0.000553412331

      target function =      -0.748476873072
              le_mean =     -22.814441116024
             les_mean =     520.944954048677
             stat err =       0.000543638049
             autocorr =       1.361174642315
   target nu stat err =       0.000543638049
   target dn stat err =       0.002667373607
      target stat err =       0.002304066370
              std dev =       0.658973451330
             le_variance =       0.434246009558


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281444111602e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748482963886       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748483995991       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748484179443       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748484209903       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748484235666       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748484235675       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748484236322       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748484237244       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748484236787       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 1.437341e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748482963886       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748483222553       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748483268482       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748483276101       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748483282539       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748483282538       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748483282698       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748483282928       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748483282815       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 3.598103e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748482963886       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748483028593       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748483040079       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748483041984       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748483043593       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748483043594       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748483043633       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748483043690       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748483043662       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 8.998232e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213839 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0499e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_01                 1.318905e-01 3 1  ON 0
ci_02                -3.172291e-02 3 1  ON 1
ci_03                -3.139715e-02 3 1  ON 2
ci_04                 2.826220e-02 3 1  ON 3
ci_05                -2.356617e-02 3 1  ON 4
ci_06                -2.317872e-02 3 1  ON 5
ci_07                 2.698105e-02 3 1  ON 6
ci_08                -6.616785e-03 3 1  ON 7
ci_09                -9.478809e-03 3 1  ON 8
ci_10                -9.446526e-03 3 1  ON 9
ci_11                 1.309430e-02 3 1  ON 10
ci_12                 7.783228e-03 3 1  ON 11
ci_13                 1.271275e-02 3 1  ON 12
ci_14                 1.306672e-02 3 1  ON 13
ci_15                 7.190709e-03 3 1  ON 14
ci_16                 7.449812e-03 3 1  ON 15
ci_17                -7.730043e-03 3 1  ON 16
ci_18                -7.280383e-03 3 1  ON 17
ci_19                 9.373860e-03 3 1  ON 18
ci_20                 6.886391e-03 3 1  ON 19
ci_21                 8.787072e-03 3 1  ON 20
ci_22                 8.815740e-03 3 1  ON 21
ci_23                 4.981949e-03 3 1  ON 22
ci_24                 4.370670e-03 3 1  ON 23
ci_25                 3.167376e-03 3 1  ON 24
ci_26                 3.224389e-03 3 1  ON 25
ci_27                 3.327698e-03 3 1  ON 26
ci_28                 2.481974e-03 3 1  ON 27
ci_29                 2.117062e-03 3 1  ON 28
ci_30                -1.671930e-03 3 1  ON 29
ci_31                -1.616984e-03 3 1  ON 30
ci_32                -1.382093e-03 3 1  ON 31
ci_33                -1.061322e-03 3 1  ON 32
ci_34                 1.526678e-03 3 1  ON 33
ci_35                 1.304933e-03 3 1  ON 34
ci_36                -1.222880e-03 3 1  ON 35
ci_37                -1.165888e-03 3 1  ON 36
ci_38                -5.150207e-04 3 1  ON 37
ci_39                -7.000523e-04 3 1  ON 38
ci_40                -1.678306e-03 3 1  ON 39
ci_41                -1.455879e-03 3 1  ON 40
ci_42                -1.185943e-03 3 1  ON 41
ci_43                -2.878712e-03 3 1  ON 42
ci_44                -1.762467e-03 3 1  ON 43
ci_45                -7.121586e-04 3 1  ON 44
ci_46                -5.565331e-04 3 1  ON 45
ci_47                 1.233803e-03 3 1  ON 46
ci_48                 7.156244e-04 3 1  ON 47
ci_49                -9.444447e-04 3 1  ON 48
ci_50                -7.216969e-04 3 1  ON 49
ci_51                 4.171709e-04 3 1  ON 50
ci_52                 4.329313e-04 3 1  ON 51
ci_53                -6.323514e-04 3 1  ON 52
ci_54                -9.365504e-04 3 1  ON 53
ci_55                -7.192100e-04 3 1  ON 54
ci_56                 1.895866e-03 3 1  ON 55
ci_57                 1.707372e-03 3 1  ON 56
ci_58                -7.366683e-04 3 1  ON 57
ci_59                -1.011015e-03 3 1  ON 58
ci_60                 5.506986e-04 3 1  ON 59
ci_61                 6.598913e-04 3 1  ON 60
ci_62                -2.773975e-04 3 1  ON 61
ci_63                -5.734297e-04 3 1  ON 62
ci_64                -4.685778e-04 3 1  ON 63
ci_65                -2.832975e-04 3 1  ON 64
ci_66                -7.114360e-04 3 1  ON 65
ci_67                -5.741338e-04 3 1  ON 66
ci_68                -6.411638e-04 3 1  ON 67
ci_69                 7.442523e-07 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.901
    reference variance = 0.441548
====================================================
  Execution time = 2.5167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4884e-01
  Total weights = 1.9640e+06
  Execution time = 3.4887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436316540842
                                         uncertainty =       0.002541994158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436316540842
                                         uncertainty =       0.002541994158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467075955
  error estimate for blocks of size 2^( 2) =       0.000491884474
  error estimate for blocks of size 2^( 3) =       0.000515623828
  error estimate for blocks of size 2^( 4) =       0.000533028684
  error estimate for blocks of size 2^( 5) =       0.000543733679
  error estimate for blocks of size 2^( 6) =       0.000551050660
  error estimate for blocks of size 2^( 7) =       0.000556311891

      target function =      -0.746308280349
              le_mean =     -22.815516340920
             les_mean =     520.996628937557
             stat err =       0.000546031228
             autocorr =       1.366658297301
   target nu stat err =       0.000546031228
   target dn stat err =       0.002768588994
      target stat err =       0.002376685511
              std dev =       0.660545149895
             le_variance =       0.436319895050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436313805397
                                         uncertainty =       0.002542069843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436313805397
                                         uncertainty =       0.002542069843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467074499
  error estimate for blocks of size 2^( 2) =       0.000491883646
  error estimate for blocks of size 2^( 3) =       0.000515623530
  error estimate for blocks of size 2^( 4) =       0.000533028758
  error estimate for blocks of size 2^( 5) =       0.000543733956
  error estimate for blocks of size 2^( 6) =       0.000551051182
  error estimate for blocks of size 2^( 7) =       0.000556312752

      target function =      -0.746311921431
              le_mean =     -22.815516332457
             les_mean =     520.996624163189
             stat err =       0.000546031662
             autocorr =       1.366668988920
   target nu stat err =       0.000546031662
   target dn stat err =       0.002768766656
      target stat err =       0.002376850600
              std dev =       0.660543090744
             le_variance =       0.436317174729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436315167896
                                         uncertainty =       0.002542032018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436315167896
                                         uncertainty =       0.002542032018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467075224
  error estimate for blocks of size 2^( 2) =       0.000491884058
  error estimate for blocks of size 2^( 3) =       0.000515623677
  error estimate for blocks of size 2^( 4) =       0.000533028720
  error estimate for blocks of size 2^( 5) =       0.000543733817
  error estimate for blocks of size 2^( 6) =       0.000551050920
  error estimate for blocks of size 2^( 7) =       0.000556312321

      target function =      -0.746310393768
              le_mean =     -22.815516336296
             les_mean =     520.996626179586
             stat err =       0.000546031444
             autocorr =       1.366663655343
   target nu stat err =       0.000546031444
   target dn stat err =       0.002768675513
      target stat err =       0.002376768003
              std dev =       0.660544116381
             le_variance =       0.436318529686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436316368883
                                         uncertainty =       0.002541998888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436316368883
                                         uncertainty =       0.002541998888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467075863
  error estimate for blocks of size 2^( 2) =       0.000491884421
  error estimate for blocks of size 2^( 3) =       0.000515623809
  error estimate for blocks of size 2^( 4) =       0.000533028689
  error estimate for blocks of size 2^( 5) =       0.000543733696
  error estimate for blocks of size 2^( 6) =       0.000551050692
  error estimate for blocks of size 2^( 7) =       0.000556311944

      target function =      -0.746308583277
              le_mean =     -22.815516340298
             les_mean =     520.996628544116
             stat err =       0.000546031255
             autocorr =       1.366658967514
   target nu stat err =       0.000546031255
   target dn stat err =       0.002768599467
      target stat err =       0.002376695786
              std dev =       0.660545020449
             le_variance =       0.436319724040


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746308280349        initial
     1.5259e+01     1.5259e+02             1.4373e-05        -0.746311921431  <--
     6.1035e+01     6.1035e+02             3.5981e-06        -0.746310393768
     2.4414e+02     2.4414e+03             8.9982e-07        -0.746308583277

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 4.2699e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_01                 1.318798e-01 3 1  ON 0
ci_02                -3.171877e-02 3 1  ON 1
ci_03                -3.139340e-02 3 1  ON 2
ci_04                 2.825617e-02 3 1  ON 3
ci_05                -2.355719e-02 3 1  ON 4
ci_06                -2.317440e-02 3 1  ON 5
ci_07                 2.698137e-02 3 1  ON 6
ci_08                -6.613191e-03 3 1  ON 7
ci_09                -9.476613e-03 3 1  ON 8
ci_10                -9.441516e-03 3 1  ON 9
ci_11                 1.309625e-02 3 1  ON 10
ci_12                 7.781963e-03 3 1  ON 11
ci_13                 1.270979e-02 3 1  ON 12
ci_14                 1.306861e-02 3 1  ON 13
ci_15                 7.187581e-03 3 1  ON 14
ci_16                 7.446612e-03 3 1  ON 15
ci_17                -7.727522e-03 3 1  ON 16
ci_18                -7.277943e-03 3 1  ON 17
ci_19                 9.373012e-03 3 1  ON 18
ci_20                 6.886310e-03 3 1  ON 19
ci_21                 8.786204e-03 3 1  ON 20
ci_22                 8.811310e-03 3 1  ON 21
ci_23                 4.982744e-03 3 1  ON 22
ci_24                 4.371007e-03 3 1  ON 23
ci_25                 3.168594e-03 3 1  ON 24
ci_26                 3.223065e-03 3 1  ON 25
ci_27                 3.323193e-03 3 1  ON 26
ci_28                 2.479789e-03 3 1  ON 27
ci_29                 2.117970e-03 3 1  ON 28
ci_30                -1.671093e-03 3 1  ON 29
ci_31                -1.615216e-03 3 1  ON 30
ci_32                -1.382271e-03 3 1  ON 31
ci_33                -1.060706e-03 3 1  ON 32
ci_34                 1.526566e-03 3 1  ON 33
ci_35                 1.303947e-03 3 1  ON 34
ci_36                -1.221687e-03 3 1  ON 35
ci_37                -1.164483e-03 3 1  ON 36
ci_38                -5.159889e-04 3 1  ON 37
ci_39                -6.991563e-04 3 1  ON 38
ci_40                -1.678943e-03 3 1  ON 39
ci_41                -1.454797e-03 3 1  ON 40
ci_42                -1.183861e-03 3 1  ON 41
ci_43                -2.880219e-03 3 1  ON 42
ci_44                -1.762967e-03 3 1  ON 43
ci_45                -7.097990e-04 3 1  ON 44
ci_46                -5.576981e-04 3 1  ON 45
ci_47                 1.235627e-03 3 1  ON 46
ci_48                 7.197166e-04 3 1  ON 47
ci_49                -9.452257e-04 3 1  ON 48
ci_50                -7.208180e-04 3 1  ON 49
ci_51                 4.177184e-04 3 1  ON 50
ci_52                 4.312572e-04 3 1  ON 51
ci_53                -6.339654e-04 3 1  ON 52
ci_54                -9.375437e-04 3 1  ON 53
ci_55                -7.219076e-04 3 1  ON 54
ci_56                 1.892506e-03 3 1  ON 55
ci_57                 1.706294e-03 3 1  ON 56
ci_58                -7.356986e-04 3 1  ON 57
ci_59                -1.009607e-03 3 1  ON 58
ci_60                 5.502170e-04 3 1  ON 59
ci_61                 6.579255e-04 3 1  ON 60
ci_62                -2.764077e-04 3 1  ON 61
ci_63                -5.719855e-04 3 1  ON 62
ci_64                -4.667001e-04 3 1  ON 63
ci_65                -2.854321e-04 3 1  ON 64
ci_66                -7.109572e-04 3 1  ON 65
ci_67                -5.729842e-04 3 1  ON 66
ci_68                -6.420618e-04 3 1  ON 67
ci_69                 1.996309e-06 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3213e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7623
    reference variance = 0.295771
====================================================
  Execution time = 2.5938e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5049e-01
  Total weights = 1.964125425e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5437e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436514438441
                                         uncertainty =       0.002457983215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436514438441
                                         uncertainty =       0.002457983215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467173517
  error estimate for blocks of size 2^( 2) =       0.000492269671
  error estimate for blocks of size 2^( 3) =       0.000516872282
  error estimate for blocks of size 2^( 4) =       0.000533990761
  error estimate for blocks of size 2^( 5) =       0.000544665281
  error estimate for blocks of size 2^( 6) =       0.000552677740
  error estimate for blocks of size 2^( 7) =       0.000555478564

      target function =      -0.744939490298
              le_mean =     -22.814975573063
             les_mean =     520.973605057972
             stat err =       0.000546703087
             autocorr =       1.369451386424
   target nu stat err =       0.000546703087
   target dn stat err =       0.002840126404
      target stat err =       0.002423726630
              std dev =       0.660683124219
             le_variance =       0.436502190627


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281497557306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744946492191       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744955183072       residual = 6.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744956898762       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744956987584       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744957061953       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744957085962       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744957078800       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744957074726       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744957073714       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744957072593       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 6.971302e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744946492191       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744948686822       residual = 6.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744949118362       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744949140485       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744949159054       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744949164999       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744949163182       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744949162174       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744949161924       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744949161647       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 1.752525e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744946492191       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744947042235       residual = 6.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744947150285       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744947155810       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744947160451       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744947161933       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744947161478       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744947161226       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744947161164       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744947161095       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 4.387421e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221941 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0499e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_01                 1.318622e-01 3 1  ON 0
ci_02                -3.170324e-02 3 1  ON 1
ci_03                -3.138346e-02 3 1  ON 2
ci_04                 2.824884e-02 3 1  ON 3
ci_05                -2.354008e-02 3 1  ON 4
ci_06                -2.316221e-02 3 1  ON 5
ci_07                 2.698407e-02 3 1  ON 6
ci_08                -6.600929e-03 3 1  ON 7
ci_09                -9.470225e-03 3 1  ON 8
ci_10                -9.438507e-03 3 1  ON 9
ci_11                 1.309389e-02 3 1  ON 10
ci_12                 7.779498e-03 3 1  ON 11
ci_13                 1.270817e-02 3 1  ON 12
ci_14                 1.306768e-02 3 1  ON 13
ci_15                 7.186215e-03 3 1  ON 14
ci_16                 7.446030e-03 3 1  ON 15
ci_17                -7.725658e-03 3 1  ON 16
ci_18                -7.275247e-03 3 1  ON 17
ci_19                 9.372390e-03 3 1  ON 18
ci_20                 6.882222e-03 3 1  ON 19
ci_21                 8.785868e-03 3 1  ON 20
ci_22                 8.806277e-03 3 1  ON 21
ci_23                 4.981979e-03 3 1  ON 22
ci_24                 4.368430e-03 3 1  ON 23
ci_25                 3.167762e-03 3 1  ON 24
ci_26                 3.222043e-03 3 1  ON 25
ci_27                 3.317725e-03 3 1  ON 26
ci_28                 2.474152e-03 3 1  ON 27
ci_29                 2.116940e-03 3 1  ON 28
ci_30                -1.669222e-03 3 1  ON 29
ci_31                -1.616285e-03 3 1  ON 30
ci_32                -1.379271e-03 3 1  ON 31
ci_33                -1.059942e-03 3 1  ON 32
ci_34                 1.521204e-03 3 1  ON 33
ci_35                 1.304459e-03 3 1  ON 34
ci_36                -1.220093e-03 3 1  ON 35
ci_37                -1.163767e-03 3 1  ON 36
ci_38                -5.170711e-04 3 1  ON 37
ci_39                -7.015280e-04 3 1  ON 38
ci_40                -1.675732e-03 3 1  ON 39
ci_41                -1.453243e-03 3 1  ON 40
ci_42                -1.185968e-03 3 1  ON 41
ci_43                -2.879960e-03 3 1  ON 42
ci_44                -1.765531e-03 3 1  ON 43
ci_45                -7.061406e-04 3 1  ON 44
ci_46                -5.589959e-04 3 1  ON 45
ci_47                 1.234644e-03 3 1  ON 46
ci_48                 7.227269e-04 3 1  ON 47
ci_49                -9.459630e-04 3 1  ON 48
ci_50                -7.221114e-04 3 1  ON 49
ci_51                 4.163619e-04 3 1  ON 50
ci_52                 4.291312e-04 3 1  ON 51
ci_53                -6.316182e-04 3 1  ON 52
ci_54                -9.333686e-04 3 1  ON 53
ci_55                -7.194761e-04 3 1  ON 54
ci_56                 1.895174e-03 3 1  ON 55
ci_57                 1.705724e-03 3 1  ON 56
ci_58                -7.384571e-04 3 1  ON 57
ci_59                -1.008945e-03 3 1  ON 58
ci_60                 5.565679e-04 3 1  ON 59
ci_61                 6.567887e-04 3 1  ON 60
ci_62                -2.779888e-04 3 1  ON 61
ci_63                -5.754633e-04 3 1  ON 62
ci_64                -4.649646e-04 3 1  ON 63
ci_65                -2.809106e-04 3 1  ON 64
ci_66                -7.109054e-04 3 1  ON 65
ci_67                -5.731130e-04 3 1  ON 66
ci_68                -6.464464e-04 3 1  ON 67
ci_69                 1.174721e-06 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7968
    reference variance = 0.564386
====================================================
  Execution time = 2.5240e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4694e-01
  Total weights = 1.9644e+06
  Execution time = 3.5000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435502560375
                                         uncertainty =       0.001880705445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435502560375
                                         uncertainty =       0.001880705445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466719858
  error estimate for blocks of size 2^( 2) =       0.000492348294
  error estimate for blocks of size 2^( 3) =       0.000515841747
  error estimate for blocks of size 2^( 4) =       0.000534076022
  error estimate for blocks of size 2^( 5) =       0.000544249840
  error estimate for blocks of size 2^( 6) =       0.000551754155
  error estimate for blocks of size 2^( 7) =       0.000553515224

      target function =      -0.745513855999
              le_mean =     -22.815263812687
             les_mean =     520.986057182506
             stat err =       0.000545898810
             autocorr =       1.368080766132
   target nu stat err =       0.000545898810
   target dn stat err =       0.003701033874
      target stat err =       0.003123418827
              std dev =       0.660041552327
             le_variance =       0.435654850798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435483843770
                                         uncertainty =       0.001880503590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435483843770
                                         uncertainty =       0.001880503590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466709865
  error estimate for blocks of size 2^( 2) =       0.000492341868
  error estimate for blocks of size 2^( 3) =       0.000515839188
  error estimate for blocks of size 2^( 4) =       0.000534076904
  error estimate for blocks of size 2^( 5) =       0.000544252309
  error estimate for blocks of size 2^( 6) =       0.000551756756
  error estimate for blocks of size 2^( 7) =       0.000553518688

      target function =      -0.747919828914
              le_mean =     -22.815263589759
             les_mean =     520.983159023638
             stat err =       0.000545901164
             autocorr =       1.368151149447
   target nu stat err =       0.000545901164
   target dn stat err =       0.002382141367
      target stat err =       0.002075947292
              std dev =       0.660027420586
             le_variance =       0.435636195925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435493051436
                                         uncertainty =       0.001880603066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435493051436
                                         uncertainty =       0.001880603066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466714781
  error estimate for blocks of size 2^( 2) =       0.000492345020
  error estimate for blocks of size 2^( 3) =       0.000515840424
  error estimate for blocks of size 2^( 4) =       0.000534076452
  error estimate for blocks of size 2^( 5) =       0.000544251071
  error estimate for blocks of size 2^( 6) =       0.000551755454
  error estimate for blocks of size 2^( 7) =       0.000553516969

      target function =      -0.747911614165
              le_mean =     -22.815263692517
             les_mean =     520.983173573999
             stat err =       0.000545899987
             autocorr =       1.368116425720
   target nu stat err =       0.000545899987
   target dn stat err =       0.002381730193
      target stat err =       0.002075576016
              std dev =       0.660034372588
             le_variance =       0.435645372998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435501361216
                                         uncertainty =       0.001880692526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435501361216
                                         uncertainty =       0.001880692526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466719217
  error estimate for blocks of size 2^( 2) =       0.000492347883
  error estimate for blocks of size 2^( 3) =       0.000515841584
  error estimate for blocks of size 2^( 4) =       0.000534076096
  error estimate for blocks of size 2^( 5) =       0.000544250018
  error estimate for blocks of size 2^( 6) =       0.000551754333
  error estimate for blocks of size 2^( 7) =       0.000553515458

      target function =      -0.747870682820
              le_mean =     -22.815263802261
             les_mean =     520.983227699536
             stat err =       0.000545898976
             autocorr =       1.368085350718
   target nu stat err =       0.000545898976
   target dn stat err =       0.002383669932
      target stat err =       0.002076903776
              std dev =       0.660040646890
             le_variance =       0.435653655547


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745513855999        initial
     3.8147e+00     3.8147e+01             6.9713e-05        -0.747919828914  <--
     1.5259e+01     1.5259e+02             1.7525e-05        -0.747911614165
     6.1035e+01     6.1035e+02             4.3874e-06        -0.747870682820

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 4.5872e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_01                 1.318101e-01 3 1  ON 0
ci_02                -3.165721e-02 3 1  ON 1
ci_03                -3.135399e-02 3 1  ON 2
ci_04                 2.822716e-02 3 1  ON 3
ci_05                -2.348935e-02 3 1  ON 4
ci_06                -2.312606e-02 3 1  ON 5
ci_07                 2.699209e-02 3 1  ON 6
ci_08                -6.564647e-03 3 1  ON 7
ci_09                -9.451279e-03 3 1  ON 8
ci_10                -9.429578e-03 3 1  ON 9
ci_11                 1.308686e-02 3 1  ON 10
ci_12                 7.772187e-03 3 1  ON 11
ci_13                 1.270334e-02 3 1  ON 12
ci_14                 1.306489e-02 3 1  ON 13
ci_15                 7.182174e-03 3 1  ON 14
ci_16                 7.444312e-03 3 1  ON 15
ci_17                -7.720105e-03 3 1  ON 16
ci_18                -7.267234e-03 3 1  ON 17
ci_19                 9.370552e-03 3 1  ON 18
ci_20                 6.870108e-03 3 1  ON 19
ci_21                 8.784860e-03 3 1  ON 20
ci_22                 8.791318e-03 3 1  ON 21
ci_23                 4.979719e-03 3 1  ON 22
ci_24                 4.360762e-03 3 1  ON 23
ci_25                 3.165299e-03 3 1  ON 24
ci_26                 3.219015e-03 3 1  ON 25
ci_27                 3.301513e-03 3 1  ON 26
ci_28                 2.457437e-03 3 1  ON 27
ci_29                 2.113879e-03 3 1  ON 28
ci_30                -1.663657e-03 3 1  ON 29
ci_31                -1.619481e-03 3 1  ON 30
ci_32                -1.370391e-03 3 1  ON 31
ci_33                -1.057678e-03 3 1  ON 32
ci_34                 1.505316e-03 3 1  ON 33
ci_35                 1.306002e-03 3 1  ON 34
ci_36                -1.215372e-03 3 1  ON 35
ci_37                -1.161644e-03 3 1  ON 36
ci_38                -5.202785e-04 3 1  ON 37
ci_39                -7.085474e-04 3 1  ON 38
ci_40                -1.666244e-03 3 1  ON 39
ci_41                -1.448645e-03 3 1  ON 40
ci_42                -1.192209e-03 3 1  ON 41
ci_43                -2.879158e-03 3 1  ON 42
ci_44                -1.773121e-03 3 1  ON 43
ci_45                -6.953071e-04 3 1  ON 44
ci_46                -5.628328e-04 3 1  ON 45
ci_47                 1.231713e-03 3 1  ON 46
ci_48                 7.316687e-04 3 1  ON 47
ci_49                -9.481424e-04 3 1  ON 48
ci_50                -7.259342e-04 3 1  ON 49
ci_51                 4.123429e-04 3 1  ON 50
ci_52                 4.228320e-04 3 1  ON 51
ci_53                -6.246782e-04 3 1  ON 52
ci_54                -9.209862e-04 3 1  ON 53
ci_55                -7.122681e-04 3 1  ON 54
ci_56                 1.903074e-03 3 1  ON 55
ci_57                 1.704038e-03 3 1  ON 56
ci_58                -7.466369e-04 3 1  ON 57
ci_59                -1.006977e-03 3 1  ON 58
ci_60                 5.755054e-04 3 1  ON 59
ci_61                 6.533932e-04 3 1  ON 60
ci_62                -2.826568e-04 3 1  ON 61
ci_63                -5.857471e-04 3 1  ON 62
ci_64                -4.598244e-04 3 1  ON 63
ci_65                -2.675189e-04 3 1  ON 64
ci_66                -7.107536e-04 3 1  ON 65
ci_67                -5.734885e-04 3 1  ON 66
ci_68                -6.594397e-04 3 1  ON 67
ci_69                -1.268650e-06 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6387e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.7463
    reference variance = 0.400946
====================================================
  Execution time = 2.6380e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4586e-01
  Total weights = 1.963921915e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433061772695
                                         uncertainty =       0.001980844369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433061772695
                                         uncertainty =       0.001980844369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465349480
  error estimate for blocks of size 2^( 2) =       0.000490833612
  error estimate for blocks of size 2^( 3) =       0.000514315956
  error estimate for blocks of size 2^( 4) =       0.000531585591
  error estimate for blocks of size 2^( 5) =       0.000541822627
  error estimate for blocks of size 2^( 6) =       0.000547838220
  error estimate for blocks of size 2^( 7) =       0.000551584352

      target function =      -0.748792402570
              le_mean =     -22.815282660601
             les_mean =     520.982981212812
             stat err =       0.000543207697
             autocorr =       1.362615627828
   target nu stat err =       0.000543207697
   target dn stat err =       0.002768614478
      target stat err =       0.002390403946
              std dev =       0.658103545411
             le_variance =       0.433100276483


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281528266060e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748799011753       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748826358572       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748831167927       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748832088738       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748832640485       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748832744126       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748832729739       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748832718718       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748832725680       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 3.259873e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748799011753       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748806124978       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748807354756       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748807587597       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748807724804       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748807748998       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748807745077       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748807742458       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748807744154       residual = 6.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 8.319400e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748799011753       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748800808223       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748801117413       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748801175782       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748801210027       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748801215965       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748801214964       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748801214319       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748801214740       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 2.090753e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229355 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0909e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_01                 1.317269e-01 3 1  ON 0
ci_02                -3.162354e-02 3 1  ON 1
ci_03                -3.131888e-02 3 1  ON 2
ci_04                 2.819399e-02 3 1  ON 3
ci_05                -2.345096e-02 3 1  ON 4
ci_06                -2.310557e-02 3 1  ON 5
ci_07                 2.699262e-02 3 1  ON 6
ci_08                -6.538059e-03 3 1  ON 7
ci_09                -9.414506e-03 3 1  ON 8
ci_10                -9.426618e-03 3 1  ON 9
ci_11                 1.309104e-02 3 1  ON 10
ci_12                 7.770935e-03 3 1  ON 11
ci_13                 1.271072e-02 3 1  ON 12
ci_14                 1.305925e-02 3 1  ON 13
ci_15                 7.173971e-03 3 1  ON 14
ci_16                 7.422963e-03 3 1  ON 15
ci_17                -7.715294e-03 3 1  ON 16
ci_18                -7.244301e-03 3 1  ON 17
ci_19                 9.376456e-03 3 1  ON 18
ci_20                 6.851716e-03 3 1  ON 19
ci_21                 8.785948e-03 3 1  ON 20
ci_22                 8.801068e-03 3 1  ON 21
ci_23                 4.982689e-03 3 1  ON 22
ci_24                 4.365770e-03 3 1  ON 23
ci_25                 3.164258e-03 3 1  ON 24
ci_26                 3.227623e-03 3 1  ON 25
ci_27                 3.298978e-03 3 1  ON 26
ci_28                 2.460451e-03 3 1  ON 27
ci_29                 2.073311e-03 3 1  ON 28
ci_30                -1.656844e-03 3 1  ON 29
ci_31                -1.607834e-03 3 1  ON 30
ci_32                -1.361282e-03 3 1  ON 31
ci_33                -1.037457e-03 3 1  ON 32
ci_34                 1.486955e-03 3 1  ON 33
ci_35                 1.304835e-03 3 1  ON 34
ci_36                -1.210528e-03 3 1  ON 35
ci_37                -1.141337e-03 3 1  ON 36
ci_38                -5.192676e-04 3 1  ON 37
ci_39                -7.128101e-04 3 1  ON 38
ci_40                -1.660383e-03 3 1  ON 39
ci_41                -1.458595e-03 3 1  ON 40
ci_42                -1.182739e-03 3 1  ON 41
ci_43                -2.881397e-03 3 1  ON 42
ci_44                -1.780883e-03 3 1  ON 43
ci_45                -6.918257e-04 3 1  ON 44
ci_46                -5.507590e-04 3 1  ON 45
ci_47                 1.231828e-03 3 1  ON 46
ci_48                 7.147522e-04 3 1  ON 47
ci_49                -9.488917e-04 3 1  ON 48
ci_50                -7.334458e-04 3 1  ON 49
ci_51                 4.018406e-04 3 1  ON 50
ci_52                 4.171311e-04 3 1  ON 51
ci_53                -6.299238e-04 3 1  ON 52
ci_54                -9.169086e-04 3 1  ON 53
ci_55                -7.146999e-04 3 1  ON 54
ci_56                 1.891510e-03 3 1  ON 55
ci_57                 1.703781e-03 3 1  ON 56
ci_58                -7.442795e-04 3 1  ON 57
ci_59                -9.928523e-04 3 1  ON 58
ci_60                 5.846701e-04 3 1  ON 59
ci_61                 6.632055e-04 3 1  ON 60
ci_62                -2.812326e-04 3 1  ON 61
ci_63                -5.639046e-04 3 1  ON 62
ci_64                -4.450766e-04 3 1  ON 63
ci_65                -2.718871e-04 3 1  ON 64
ci_66                -7.076415e-04 3 1  ON 65
ci_67                -5.726784e-04 3 1  ON 66
ci_68                -7.043102e-04 3 1  ON 67
ci_69                -1.637441e-06 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.8258
    reference variance = 0.367521
====================================================
  Execution time = 2.5230e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5119e-01
  Total weights = 1.9644e+06
  Execution time = 3.4923e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437776662274
                                         uncertainty =       0.002131337835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437776662274
                                         uncertainty =       0.002131337835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467896815
  error estimate for blocks of size 2^( 2) =       0.000493130961
  error estimate for blocks of size 2^( 3) =       0.000516890566
  error estimate for blocks of size 2^( 4) =       0.000534099624
  error estimate for blocks of size 2^( 5) =       0.000545270397
  error estimate for blocks of size 2^( 6) =       0.000552840197
  error estimate for blocks of size 2^( 7) =       0.000556301580

      target function =      -0.743402381683
              le_mean =     -22.814803893524
             les_mean =     520.967632899913
             stat err =       0.000547127949
             autocorr =       1.367343477178
   target nu stat err =       0.000547127949
   target dn stat err =       0.003296341978
      target stat err =       0.002778450339
              std dev =       0.661706021814
             le_variance =       0.437854859305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437728879689
                                         uncertainty =       0.002131312528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437728879689
                                         uncertainty =       0.002131312528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467871127
  error estimate for blocks of size 2^( 2) =       0.000493116672
  error estimate for blocks of size 2^( 3) =       0.000516887705
  error estimate for blocks of size 2^( 4) =       0.000534109084
  error estimate for blocks of size 2^( 5) =       0.000545286481
  error estimate for blocks of size 2^( 6) =       0.000552864402
  error estimate for blocks of size 2^( 7) =       0.000556331175

      target function =      -0.744156154968
              le_mean =     -22.814805712148
             les_mean =     520.966801900805
             stat err =       0.000547147786
             autocorr =       1.367592786784
   target nu stat err =       0.000547147786
   target dn stat err =       0.003098983175
      target stat err =       0.002625419027
              std dev =       0.661669693489
             le_variance =       0.437806783282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437750935645
                                         uncertainty =       0.002131285527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437750935645
                                         uncertainty =       0.002131285527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467882988
  error estimate for blocks of size 2^( 2) =       0.000493123041
  error estimate for blocks of size 2^( 3) =       0.000516888529
  error estimate for blocks of size 2^( 4) =       0.000534103914
  error estimate for blocks of size 2^( 5) =       0.000545278014
  error estimate for blocks of size 2^( 6) =       0.000552852145
  error estimate for blocks of size 2^( 7) =       0.000556316376

      target function =      -0.744339381854
              le_mean =     -22.814804730793
             les_mean =     520.966535025321
             stat err =       0.000547137613
             autocorr =       1.367472596283
   target nu stat err =       0.000547137613
   target dn stat err =       0.003079372714
      target stat err =       0.002610937152
              std dev =       0.661686467706
             le_variance =       0.437828981546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437773298556
                                         uncertainty =       0.002131329395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437773298556
                                         uncertainty =       0.002131329395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467895008
  error estimate for blocks of size 2^( 2) =       0.000493129904
  error estimate for blocks of size 2^( 3) =       0.000516890194
  error estimate for blocks of size 2^( 4) =       0.000534099982
  error estimate for blocks of size 2^( 5) =       0.000545271110
  error estimate for blocks of size 2^( 6) =       0.000552841659
  error estimate for blocks of size 2^( 7) =       0.000556303357

      target function =      -0.744385227363
              le_mean =     -22.814804046351
             les_mean =     520.966448279603
             stat err =       0.000547129027
             autocorr =       1.367359427843
   target nu stat err =       0.000547129027
   target dn stat err =       0.003068523831
      target stat err =       0.002602542110
              std dev =       0.661703465766
             le_variance =       0.437851476607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743402381683        initial
     9.5367e-01     9.5367e+00             3.2599e-04        -0.744156154968
     3.8147e+00     3.8147e+01             8.3194e-05        -0.744339381854
     1.5259e+01     1.5259e+02             2.0908e-05        -0.744385227363  <--

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 4.2766e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_01                 1.317891e-01 3 1  ON 0
ci_02                -3.164871e-02 3 1  ON 1
ci_03                -3.134513e-02 3 1  ON 2
ci_04                 2.821879e-02 3 1  ON 3
ci_05                -2.347966e-02 3 1  ON 4
ci_06                -2.312089e-02 3 1  ON 5
ci_07                 2.699222e-02 3 1  ON 6
ci_08                -6.557933e-03 3 1  ON 7
ci_09                -9.442009e-03 3 1  ON 8
ci_10                -9.428833e-03 3 1  ON 9
ci_11                 1.308791e-02 3 1  ON 10
ci_12                 7.771871e-03 3 1  ON 11
ci_13                 1.270519e-02 3 1  ON 12
ci_14                 1.306347e-02 3 1  ON 13
ci_15                 7.180103e-03 3 1  ON 14
ci_16                 7.438930e-03 3 1  ON 15
ci_17                -7.718893e-03 3 1  ON 16
ci_18                -7.261455e-03 3 1  ON 17
ci_19                 9.372043e-03 3 1  ON 18
ci_20                 6.865468e-03 3 1  ON 19
ci_21                 8.785134e-03 3 1  ON 20
ci_22                 8.793776e-03 3 1  ON 21
ci_23                 4.980467e-03 3 1  ON 22
ci_24                 4.362021e-03 3 1  ON 23
ci_25                 3.165036e-03 3 1  ON 24
ci_26                 3.221185e-03 3 1  ON 25
ci_27                 3.300871e-03 3 1  ON 26
ci_28                 2.458197e-03 3 1  ON 27
ci_29                 2.103646e-03 3 1  ON 28
ci_30                -1.661942e-03 3 1  ON 29
ci_31                -1.616551e-03 3 1  ON 30
ci_32                -1.368089e-03 3 1  ON 31
ci_33                -1.052566e-03 3 1  ON 32
ci_34                 1.500683e-03 3 1  ON 33
ci_35                 1.305706e-03 3 1  ON 34
ci_36                -1.214148e-03 3 1  ON 35
ci_37                -1.156517e-03 3 1  ON 36
ci_38                -5.200221e-04 3 1  ON 37
ci_39                -7.096228e-04 3 1  ON 38
ci_40                -1.664762e-03 3 1  ON 39
ci_41                -1.451158e-03 3 1  ON 40
ci_42                -1.189816e-03 3 1  ON 41
ci_43                -2.879727e-03 3 1  ON 42
ci_44                -1.775088e-03 3 1  ON 43
ci_45                -6.944282e-04 3 1  ON 44
ci_46                -5.597849e-04 3 1  ON 45
ci_47                 1.231739e-03 3 1  ON 46
ci_48                 7.274066e-04 3 1  ON 47
ci_49                -9.483328e-04 3 1  ON 48
ci_50                -7.278324e-04 3 1  ON 49
ci_51                 4.096911e-04 3 1  ON 50
ci_52                 4.213921e-04 3 1  ON 51
ci_53                -6.260049e-04 3 1  ON 52
ci_54                -9.199575e-04 3 1  ON 53
ci_55                -7.128816e-04 3 1  ON 54
ci_56                 1.900151e-03 3 1  ON 55
ci_57                 1.703973e-03 3 1  ON 56
ci_58                -7.460404e-04 3 1  ON 57
ci_59                -1.003409e-03 3 1  ON 58
ci_60                 5.778083e-04 3 1  ON 59
ci_61                 6.558610e-04 3 1  ON 60
ci_62                -2.822959e-04 3 1  ON 61
ci_63                -5.802263e-04 3 1  ON 62
ci_64                -4.561025e-04 3 1  ON 63
ci_65                -2.686214e-04 3 1  ON 64
ci_66                -7.099684e-04 3 1  ON 65
ci_67                -5.732831e-04 3 1  ON 66
ci_68                -6.707647e-04 3 1  ON 67
ci_69                -1.363014e-06 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3691e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.7722
    reference variance = 0.425214
====================================================
  Execution time = 2.6052e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5375e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5564e-01
  Total weights = 1.964368359e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5328e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439326096273
                                         uncertainty =       0.003189314117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439326096273
                                         uncertainty =       0.003189314117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468701171
  error estimate for blocks of size 2^( 2) =       0.000493733329
  error estimate for blocks of size 2^( 3) =       0.000517509038
  error estimate for blocks of size 2^( 4) =       0.000534398597
  error estimate for blocks of size 2^( 5) =       0.000543544461
  error estimate for blocks of size 2^( 6) =       0.000549558812
  error estimate for blocks of size 2^( 7) =       0.000554107057

      target function =      -0.740703513505
              le_mean =     -22.814969837015
             les_mean =     520.978486202011
             stat err =       0.000545402231
             autocorr =       1.354071954927
   target nu stat err =       0.000545402231
   target dn stat err =       0.004483200661
      target stat err =       0.003711317144
              std dev =       0.662843553232
             le_variance =       0.439361576061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281496983702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740721288087       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740729492629       residual = 5.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740730714060       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740730868016       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740730851853       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740730863686       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740730863516       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740730863769       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740730862644       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740730862543       residual = 6.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 6.188245e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740721288087       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740723358908       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740723665816       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740723704298       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740723700171       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740723703114       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740723703070       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740723703130       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740723702852       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740723702830       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 1.555702e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740721288087       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740721807037       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740721883862       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740721893481       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740721892444       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740721893179       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740721893168       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740721893183       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740721893114       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740721893108       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 3.894698e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237461 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0605e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_01                 1.317736e-01 3 1  ON 0
ci_02                -3.163936e-02 3 1  ON 1
ci_03                -3.133133e-02 3 1  ON 2
ci_04                 2.820887e-02 3 1  ON 3
ci_05                -2.346492e-02 3 1  ON 4
ci_06                -2.310976e-02 3 1  ON 5
ci_07                 2.698918e-02 3 1  ON 6
ci_08                -6.553626e-03 3 1  ON 7
ci_09                -9.432270e-03 3 1  ON 8
ci_10                -9.419807e-03 3 1  ON 9
ci_11                 1.308615e-02 3 1  ON 10
ci_12                 7.771225e-03 3 1  ON 11
ci_13                 1.270283e-02 3 1  ON 12
ci_14                 1.306772e-02 3 1  ON 13
ci_15                 7.179017e-03 3 1  ON 14
ci_16                 7.440424e-03 3 1  ON 15
ci_17                -7.708668e-03 3 1  ON 16
ci_18                -7.259504e-03 3 1  ON 17
ci_19                 9.371564e-03 3 1  ON 18
ci_20                 6.863664e-03 3 1  ON 19
ci_21                 8.778818e-03 3 1  ON 20
ci_22                 8.795285e-03 3 1  ON 21
ci_23                 4.977530e-03 3 1  ON 22
ci_24                 4.368457e-03 3 1  ON 23
ci_25                 3.165640e-03 3 1  ON 24
ci_26                 3.216378e-03 3 1  ON 25
ci_27                 3.304893e-03 3 1  ON 26
ci_28                 2.459927e-03 3 1  ON 27
ci_29                 2.099206e-03 3 1  ON 28
ci_30                -1.663494e-03 3 1  ON 29
ci_31                -1.617874e-03 3 1  ON 30
ci_32                -1.368832e-03 3 1  ON 31
ci_33                -1.054257e-03 3 1  ON 32
ci_34                 1.504518e-03 3 1  ON 33
ci_35                 1.301718e-03 3 1  ON 34
ci_36                -1.212796e-03 3 1  ON 35
ci_37                -1.155377e-03 3 1  ON 36
ci_38                -5.201770e-04 3 1  ON 37
ci_39                -7.064498e-04 3 1  ON 38
ci_40                -1.667810e-03 3 1  ON 39
ci_41                -1.450486e-03 3 1  ON 40
ci_42                -1.184292e-03 3 1  ON 41
ci_43                -2.880660e-03 3 1  ON 42
ci_44                -1.770053e-03 3 1  ON 43
ci_45                -6.957245e-04 3 1  ON 44
ci_46                -5.587545e-04 3 1  ON 45
ci_47                 1.234445e-03 3 1  ON 46
ci_48                 7.310202e-04 3 1  ON 47
ci_49                -9.465785e-04 3 1  ON 48
ci_50                -7.272933e-04 3 1  ON 49
ci_51                 4.080037e-04 3 1  ON 50
ci_52                 4.226997e-04 3 1  ON 51
ci_53                -6.242435e-04 3 1  ON 52
ci_54                -9.126298e-04 3 1  ON 53
ci_55                -7.128931e-04 3 1  ON 54
ci_56                 1.899710e-03 3 1  ON 55
ci_57                 1.704713e-03 3 1  ON 56
ci_58                -7.499574e-04 3 1  ON 57
ci_59                -9.972283e-04 3 1  ON 58
ci_60                 5.778513e-04 3 1  ON 59
ci_61                 6.537412e-04 3 1  ON 60
ci_62                -2.854906e-04 3 1  ON 61
ci_63                -5.780402e-04 3 1  ON 62
ci_64                -4.586638e-04 3 1  ON 63
ci_65                -2.671094e-04 3 1  ON 64
ci_66                -7.108371e-04 3 1  ON 65
ci_67                -5.705071e-04 3 1  ON 66
ci_68                -6.733551e-04 3 1  ON 67
ci_69                -1.024640e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.8653
    reference variance = 0.498034
====================================================
  Execution time = 2.5363e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4486e-01
  Total weights = 1.9648e+06
  Execution time = 3.4971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431886476514
                                         uncertainty =       0.001881658031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431886476514
                                         uncertainty =       0.001881658031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464705996
  error estimate for blocks of size 2^( 2) =       0.000489979259
  error estimate for blocks of size 2^( 3) =       0.000513822658
  error estimate for blocks of size 2^( 4) =       0.000531213261
  error estimate for blocks of size 2^( 5) =       0.000542733019
  error estimate for blocks of size 2^( 6) =       0.000548977382
  error estimate for blocks of size 2^( 7) =       0.000552415891

      target function =      -0.749600734074
              le_mean =     -22.814722274561
             les_mean =     520.956440822348
             stat err =       0.000543834888
             autocorr =       1.369549008049
   target nu stat err =       0.000543834888
   target dn stat err =       0.002421332283
      target stat err =       0.002113911129
              std dev =       0.657193522211
             le_variance =       0.431903325636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431878543600
                                         uncertainty =       0.001882221784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431878543600
                                         uncertainty =       0.001882221784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464701724
  error estimate for blocks of size 2^( 2) =       0.000489978328
  error estimate for blocks of size 2^( 3) =       0.000513825180
  error estimate for blocks of size 2^( 4) =       0.000531219579
  error estimate for blocks of size 2^( 5) =       0.000542739416
  error estimate for blocks of size 2^( 6) =       0.000548984045
  error estimate for blocks of size 2^( 7) =       0.000552425908

      target function =      -0.749646750724
              le_mean =     -22.814722486445
             les_mean =     520.956395508901
             stat err =       0.000543842237
             autocorr =       1.369611203214
   target nu stat err =       0.000543842237
   target dn stat err =       0.002414380736
      target stat err =       0.002108593886
              std dev =       0.657187480671
             le_variance =       0.431895384750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431882401963
                                         uncertainty =       0.001881939911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431882401963
                                         uncertainty =       0.001881939911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464703802
  error estimate for blocks of size 2^( 2) =       0.000489978748
  error estimate for blocks of size 2^( 3) =       0.000513823890
  error estimate for blocks of size 2^( 4) =       0.000531216404
  error estimate for blocks of size 2^( 5) =       0.000542736195
  error estimate for blocks of size 2^( 6) =       0.000548980700
  error estimate for blocks of size 2^( 7) =       0.000552420906

      target function =      -0.749640327265
              le_mean =     -22.814722371059
             les_mean =     520.956397908107
             stat err =       0.000543838551
             autocorr =       1.369580391269
   target nu stat err =       0.000543838551
   target dn stat err =       0.002417091471
      target stat err =       0.002110729168
              std dev =       0.657190419222
             le_variance =       0.431899247117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431885957795
                                         uncertainty =       0.001881693080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431885957795
                                         uncertainty =       0.001881693080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464705717
  error estimate for blocks of size 2^( 2) =       0.000489979190
  error estimate for blocks of size 2^( 3) =       0.000513822807
  error estimate for blocks of size 2^( 4) =       0.000531213650
  error estimate for blocks of size 2^( 5) =       0.000542733410
  error estimate for blocks of size 2^( 6) =       0.000548977792
  error estimate for blocks of size 2^( 7) =       0.000552416516

      target function =      -0.749609925999
              le_mean =     -22.814722285903
             les_mean =     520.956430352335
             stat err =       0.000543835342
             autocorr =       1.369552940697
   target nu stat err =       0.000543835342
   target dn stat err =       0.002420679407
      target stat err =       0.002113437975
              std dev =       0.657193127190
             le_variance =       0.431902806426


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749600734074        initial
     3.8147e+00     3.8147e+01             6.1882e-05        -0.749646750724  <--
     1.5259e+01     1.5259e+02             1.5557e-05        -0.749640327265
     6.1035e+01     6.1035e+02             3.8947e-06        -0.749609925999

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 4.2948e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_01                 1.317273e-01 3 1  ON 0
ci_02                -3.161163e-02 3 1  ON 1
ci_03                -3.129040e-02 3 1  ON 2
ci_04                 2.817953e-02 3 1  ON 3
ci_05                -2.342120e-02 3 1  ON 4
ci_06                -2.307677e-02 3 1  ON 5
ci_07                 2.698012e-02 3 1  ON 6
ci_08                -6.540860e-03 3 1  ON 7
ci_09                -9.403342e-03 3 1  ON 8
ci_10                -9.393015e-03 3 1  ON 9
ci_11                 1.308092e-02 3 1  ON 10
ci_12                 7.769317e-03 3 1  ON 11
ci_13                 1.269577e-02 3 1  ON 12
ci_14                 1.308038e-02 3 1  ON 13
ci_15                 7.175802e-03 3 1  ON 14
ci_16                 7.444870e-03 3 1  ON 15
ci_17                -7.678320e-03 3 1  ON 16
ci_18                -7.253701e-03 3 1  ON 17
ci_19                 9.370149e-03 3 1  ON 18
ci_20                 6.858313e-03 3 1  ON 19
ci_21                 8.760029e-03 3 1  ON 20
ci_22                 8.799777e-03 3 1  ON 21
ci_23                 4.968843e-03 3 1  ON 22
ci_24                 4.387623e-03 3 1  ON 23
ci_25                 3.167426e-03 3 1  ON 24
ci_26                 3.202119e-03 3 1  ON 25
ci_27                 3.316832e-03 3 1  ON 26
ci_28                 2.465038e-03 3 1  ON 27
ci_29                 2.086027e-03 3 1  ON 28
ci_30                -1.668096e-03 3 1  ON 29
ci_31                -1.621821e-03 3 1  ON 30
ci_32                -1.371035e-03 3 1  ON 31
ci_33                -1.059272e-03 3 1  ON 32
ci_34                 1.515906e-03 3 1  ON 33
ci_35                 1.289892e-03 3 1  ON 34
ci_36                -1.208792e-03 3 1  ON 35
ci_37                -1.152001e-03 3 1  ON 36
ci_38                -5.206329e-04 3 1  ON 37
ci_39                -6.970487e-04 3 1  ON 38
ci_40                -1.676818e-03 3 1  ON 39
ci_41                -1.448495e-03 3 1  ON 40
ci_42                -1.167937e-03 3 1  ON 41
ci_43                -2.883415e-03 3 1  ON 42
ci_44                -1.755103e-03 3 1  ON 43
ci_45                -6.995617e-04 3 1  ON 44
ci_46                -5.557055e-04 3 1  ON 45
ci_47                 1.242478e-03 3 1  ON 46
ci_48                 7.417682e-04 3 1  ON 47
ci_49                -9.413806e-04 3 1  ON 48
ci_50                -7.256980e-04 3 1  ON 49
ci_51                 4.029988e-04 3 1  ON 50
ci_52                 4.265688e-04 3 1  ON 51
ci_53                -6.190390e-04 3 1  ON 52
ci_54                -8.909111e-04 3 1  ON 53
ci_55                -7.129371e-04 3 1  ON 54
ci_56                 1.898407e-03 3 1  ON 55
ci_57                 1.706913e-03 3 1  ON 56
ci_58                -7.615647e-04 3 1  ON 57
ci_59                -9.789149e-04 3 1  ON 58
ci_60                 5.779848e-04 3 1  ON 59
ci_61                 6.474312e-04 3 1  ON 60
ci_62                -2.949338e-04 3 1  ON 61
ci_63                -5.715663e-04 3 1  ON 62
ci_64                -4.662473e-04 3 1  ON 63
ci_65                -2.626324e-04 3 1  ON 64
ci_66                -7.134047e-04 3 1  ON 65
ci_67                -5.622864e-04 3 1  ON 66
ci_68                -6.810347e-04 3 1  ON 67
ci_69                -3.657354e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3568e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.8127
    reference variance = 1.5863
====================================================
  Execution time = 2.5848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5377e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4828e-01
  Total weights = 1.964336236e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434204960325
                                         uncertainty =       0.001893219940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434204960325
                                         uncertainty =       0.001893219940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466009276
  error estimate for blocks of size 2^( 2) =       0.000490962260
  error estimate for blocks of size 2^( 3) =       0.000514402347
  error estimate for blocks of size 2^( 4) =       0.000531695894
  error estimate for blocks of size 2^( 5) =       0.000542712086
  error estimate for blocks of size 2^( 6) =       0.000549625631
  error estimate for blocks of size 2^( 7) =       0.000550408245

      target function =      -0.746773185267
              le_mean =     -22.814889446725
             les_mean =     520.967462963083
             stat err =       0.000543610464
             autocorr =       1.360775537657
   target nu stat err =       0.000543610464
   target dn stat err =       0.002511189179
      target stat err =       0.002170648368
              std dev =       0.659036637835
             le_variance =       0.434329290008


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281488944672e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746778494598       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746806050319       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746809996363       residual = 9.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746810620478       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746810860628       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746811045350       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746811053152       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746811059183       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746811056628       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746811050506       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 3.355543e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746778494598       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746785647153       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746786656467       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746786811984       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746786871165       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746786915919       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746786917484       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746786918895       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746786918197       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746786916753       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 8.566096e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746778494598       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746780300008       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746780553790       residual = 8.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746780592625       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746780607361       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746780618455       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746780618822       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746780619168       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746780618990       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746780618635       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 2.152921e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.245574 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0402e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_01                 1.316416e-01 3 1  ON 0
ci_02                -3.157303e-02 3 1  ON 1
ci_03                -3.124097e-02 3 1  ON 2
ci_04                 2.812997e-02 3 1  ON 3
ci_05                -2.337493e-02 3 1  ON 4
ci_06                -2.305203e-02 3 1  ON 5
ci_07                 2.696395e-02 3 1  ON 6
ci_08                -6.519412e-03 3 1  ON 7
ci_09                -9.373240e-03 3 1  ON 8
ci_10                -9.379119e-03 3 1  ON 9
ci_11                 1.306586e-02 3 1  ON 10
ci_12                 7.753340e-03 3 1  ON 11
ci_13                 1.266969e-02 3 1  ON 12
ci_14                 1.306656e-02 3 1  ON 13
ci_15                 7.175425e-03 3 1  ON 14
ci_16                 7.424530e-03 3 1  ON 15
ci_17                -7.643808e-03 3 1  ON 16
ci_18                -7.260764e-03 3 1  ON 17
ci_19                 9.360655e-03 3 1  ON 18
ci_20                 6.828339e-03 3 1  ON 19
ci_21                 8.755397e-03 3 1  ON 20
ci_22                 8.799605e-03 3 1  ON 21
ci_23                 4.951351e-03 3 1  ON 22
ci_24                 4.392306e-03 3 1  ON 23
ci_25                 3.170667e-03 3 1  ON 24
ci_26                 3.201429e-03 3 1  ON 25
ci_27                 3.318994e-03 3 1  ON 26
ci_28                 2.452605e-03 3 1  ON 27
ci_29                 2.092184e-03 3 1  ON 28
ci_30                -1.676488e-03 3 1  ON 29
ci_31                -1.629130e-03 3 1  ON 30
ci_32                -1.387850e-03 3 1  ON 31
ci_33                -1.066123e-03 3 1  ON 32
ci_34                 1.512240e-03 3 1  ON 33
ci_35                 1.308855e-03 3 1  ON 34
ci_36                -1.200456e-03 3 1  ON 35
ci_37                -1.156288e-03 3 1  ON 36
ci_38                -5.211171e-04 3 1  ON 37
ci_39                -6.872804e-04 3 1  ON 38
ci_40                -1.670121e-03 3 1  ON 39
ci_41                -1.447565e-03 3 1  ON 40
ci_42                -1.172131e-03 3 1  ON 41
ci_43                -2.868984e-03 3 1  ON 42
ci_44                -1.762522e-03 3 1  ON 43
ci_45                -7.022719e-04 3 1  ON 44
ci_46                -5.593409e-04 3 1  ON 45
ci_47                 1.252616e-03 3 1  ON 46
ci_48                 7.460012e-04 3 1  ON 47
ci_49                -9.441859e-04 3 1  ON 48
ci_50                -7.222651e-04 3 1  ON 49
ci_51                 4.009311e-04 3 1  ON 50
ci_52                 4.186313e-04 3 1  ON 51
ci_53                -6.121133e-04 3 1  ON 52
ci_54                -8.928470e-04 3 1  ON 53
ci_55                -6.932767e-04 3 1  ON 54
ci_56                 1.908874e-03 3 1  ON 55
ci_57                 1.711866e-03 3 1  ON 56
ci_58                -7.658654e-04 3 1  ON 57
ci_59                -9.957367e-04 3 1  ON 58
ci_60                 5.467593e-04 3 1  ON 59
ci_61                 6.358956e-04 3 1  ON 60
ci_62                -2.977581e-04 3 1  ON 61
ci_63                -5.602259e-04 3 1  ON 62
ci_64                -4.688089e-04 3 1  ON 63
ci_65                -2.743573e-04 3 1  ON 64
ci_66                -7.270509e-04 3 1  ON 65
ci_67                -5.732368e-04 3 1  ON 66
ci_68                -6.738781e-04 3 1  ON 67
ci_69                -5.495136e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.8937
    reference variance = 0.449792
====================================================
  Execution time = 2.5209e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4502e-01
  Total weights = 1.9646e+06
  Execution time = 3.4934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434620986878
                                         uncertainty =       0.002092200357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434620986878
                                         uncertainty =       0.002092200357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466305842
  error estimate for blocks of size 2^( 2) =       0.000491503302
  error estimate for blocks of size 2^( 3) =       0.000515774565
  error estimate for blocks of size 2^( 4) =       0.000532797414
  error estimate for blocks of size 2^( 5) =       0.000543629574
  error estimate for blocks of size 2^( 6) =       0.000549310527
  error estimate for blocks of size 2^( 7) =       0.000554125182

      target function =      -0.749333744594
              le_mean =     -22.814745628798
             les_mean =     520.957825154226
             stat err =       0.000544965674
             autocorr =       1.365829799908
   target nu stat err =       0.000544965674
   target dn stat err =       0.002579376242
      target stat err =       0.002239728069
              std dev =       0.659456045576
             le_variance =       0.434882276047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434558209275
                                         uncertainty =       0.002091643377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434558209275
                                         uncertainty =       0.002091643377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466271781
  error estimate for blocks of size 2^( 2) =       0.000491483543
  error estimate for blocks of size 2^( 3) =       0.000515770346
  error estimate for blocks of size 2^( 4) =       0.000532807322
  error estimate for blocks of size 2^( 5) =       0.000543649914
  error estimate for blocks of size 2^( 6) =       0.000549332072
  error estimate for blocks of size 2^( 7) =       0.000554148472

      target function =      -0.749494294266
              le_mean =     -22.814745930696
             les_mean =     520.957646910290
             stat err =       0.000544984445
             autocorr =       1.366123455089
   target nu stat err =       0.000544984445
   target dn stat err =       0.002571915586
      target stat err =       0.002234655987
              std dev =       0.659407877048
             le_variance =       0.434818748313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434587622546
                                         uncertainty =       0.002091910340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434587622546
                                         uncertainty =       0.002091910340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466287745
  error estimate for blocks of size 2^( 2) =       0.000491492616
  error estimate for blocks of size 2^( 3) =       0.000515771917
  error estimate for blocks of size 2^( 4) =       0.000532802065
  error estimate for blocks of size 2^( 5) =       0.000543639623
  error estimate for blocks of size 2^( 6) =       0.000549321237
  error estimate for blocks of size 2^( 7) =       0.000554136806

      target function =      -0.749502899105
              le_mean =     -22.814745653602
             les_mean =     520.957623965891
             stat err =       0.000544974933
             autocorr =       1.365982228362
   target nu stat err =       0.000544974933
   target dn stat err =       0.002572934467
      target stat err =       0.002235521390
              std dev =       0.659430453378
             le_variance =       0.434848522843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434616667034
                                         uncertainty =       0.002092162714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434616667034
                                         uncertainty =       0.002092162714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466303499
  error estimate for blocks of size 2^( 2) =       0.000491501920
  error estimate for blocks of size 2^( 3) =       0.000515774224
  error estimate for blocks of size 2^( 4) =       0.000532797973
  error estimate for blocks of size 2^( 5) =       0.000543630845
  error estimate for blocks of size 2^( 6) =       0.000549311892
  error estimate for blocks of size 2^( 7) =       0.000554126687

      target function =      -0.749353967428
              le_mean =     -22.814745651156
             les_mean =     520.957801990947
             stat err =       0.000544966849
             autocorr =       1.365849411480
   target nu stat err =       0.000544966849
   target dn stat err =       0.002577381399
      target stat err =       0.002238240262
              std dev =       0.659452733041
             le_variance =       0.434877907115


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749333744594        initial
     9.5367e-01     9.5367e+00             3.3555e-04        -0.749494294266
     3.8147e+00     3.8147e+01             8.5661e-05        -0.749502899105  <--
     1.5259e+01     1.5259e+02             2.1529e-05        -0.749353967428

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 4.2768e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_01                 1.316416e-01 3 1  ON 0
ci_02                -3.157303e-02 3 1  ON 1
ci_03                -3.124097e-02 3 1  ON 2
ci_04                 2.812997e-02 3 1  ON 3
ci_05                -2.337493e-02 3 1  ON 4
ci_06                -2.305203e-02 3 1  ON 5
ci_07                 2.696395e-02 3 1  ON 6
ci_08                -6.519412e-03 3 1  ON 7
ci_09                -9.373240e-03 3 1  ON 8
ci_10                -9.379119e-03 3 1  ON 9
ci_11                 1.306586e-02 3 1  ON 10
ci_12                 7.753340e-03 3 1  ON 11
ci_13                 1.266969e-02 3 1  ON 12
ci_14                 1.306656e-02 3 1  ON 13
ci_15                 7.175425e-03 3 1  ON 14
ci_16                 7.424530e-03 3 1  ON 15
ci_17                -7.643808e-03 3 1  ON 16
ci_18                -7.260764e-03 3 1  ON 17
ci_19                 9.360655e-03 3 1  ON 18
ci_20                 6.828339e-03 3 1  ON 19
ci_21                 8.755397e-03 3 1  ON 20
ci_22                 8.799605e-03 3 1  ON 21
ci_23                 4.951351e-03 3 1  ON 22
ci_24                 4.392306e-03 3 1  ON 23
ci_25                 3.170667e-03 3 1  ON 24
ci_26                 3.201429e-03 3 1  ON 25
ci_27                 3.318994e-03 3 1  ON 26
ci_28                 2.452605e-03 3 1  ON 27
ci_29                 2.092184e-03 3 1  ON 28
ci_30                -1.676488e-03 3 1  ON 29
ci_31                -1.629130e-03 3 1  ON 30
ci_32                -1.387850e-03 3 1  ON 31
ci_33                -1.066123e-03 3 1  ON 32
ci_34                 1.512240e-03 3 1  ON 33
ci_35                 1.308855e-03 3 1  ON 34
ci_36                -1.200456e-03 3 1  ON 35
ci_37                -1.156288e-03 3 1  ON 36
ci_38                -5.211171e-04 3 1  ON 37
ci_39                -6.872804e-04 3 1  ON 38
ci_40                -1.670121e-03 3 1  ON 39
ci_41                -1.447565e-03 3 1  ON 40
ci_42                -1.172131e-03 3 1  ON 41
ci_43                -2.868984e-03 3 1  ON 42
ci_44                -1.762522e-03 3 1  ON 43
ci_45                -7.022719e-04 3 1  ON 44
ci_46                -5.593409e-04 3 1  ON 45
ci_47                 1.252616e-03 3 1  ON 46
ci_48                 7.460012e-04 3 1  ON 47
ci_49                -9.441859e-04 3 1  ON 48
ci_50                -7.222651e-04 3 1  ON 49
ci_51                 4.009311e-04 3 1  ON 50
ci_52                 4.186313e-04 3 1  ON 51
ci_53                -6.121133e-04 3 1  ON 52
ci_54                -8.928470e-04 3 1  ON 53
ci_55                -6.932767e-04 3 1  ON 54
ci_56                 1.908874e-03 3 1  ON 55
ci_57                 1.711866e-03 3 1  ON 56
ci_58                -7.658654e-04 3 1  ON 57
ci_59                -9.957367e-04 3 1  ON 58
ci_60                 5.467593e-04 3 1  ON 59
ci_61                 6.358956e-04 3 1  ON 60
ci_62                -2.977581e-04 3 1  ON 61
ci_63                -5.602259e-04 3 1  ON 62
ci_64                -4.688089e-04 3 1  ON 63
ci_65                -2.743573e-04 3 1  ON 64
ci_66                -7.270509e-04 3 1  ON 65
ci_67                -5.732368e-04 3 1  ON 66
ci_68                -6.738781e-04 3 1  ON 67
ci_69                -5.495136e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3186e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.7527
    reference variance = 0.310902
====================================================
  Execution time = 2.5980e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5355e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4888e-01
  Total weights = 1.964183232e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436064649552
                                         uncertainty =       0.001813770916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436064649552
                                         uncertainty =       0.001813770916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466922615
  error estimate for blocks of size 2^( 2) =       0.000492181790
  error estimate for blocks of size 2^( 3) =       0.000516156413
  error estimate for blocks of size 2^( 4) =       0.000533686523
  error estimate for blocks of size 2^( 5) =       0.000544217745
  error estimate for blocks of size 2^( 6) =       0.000552133712
  error estimate for blocks of size 2^( 7) =       0.000554293419

      target function =      -0.746277274558
              le_mean =     -22.815541464605
             les_mean =     520.997814028503
             stat err =       0.000546082850
             autocorr =       1.367814668367
   target nu stat err =       0.000546082850
   target dn stat err =       0.002572483078
      target stat err =       0.002219636087
              std dev =       0.660328294315
             le_variance =       0.436033456273


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281554146461e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746282877704       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746305626641       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746308008769       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746308508697       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746308516969       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746308460331       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746308473705       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746308489505       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746308498154       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746308497067       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 3.088811e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746282877704       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746288782570       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746289391499       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746289516311       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746289516692       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746289502058       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746289505375       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746289509302       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746289511348       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746289511085       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 7.888252e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746282877704       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746284368179       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746284521264       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746284552446       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746284552431       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746284548744       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746284549571       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746284550551       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746284551056       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746284550990       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 1.982764e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253696 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0520e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_01                 1.315627e-01 3 1  ON 0
ci_02                -3.150228e-02 3 1  ON 1
ci_03                -3.119920e-02 3 1  ON 2
ci_04                 2.809658e-02 3 1  ON 3
ci_05                -2.334619e-02 3 1  ON 4
ci_06                -2.301062e-02 3 1  ON 5
ci_07                 2.695881e-02 3 1  ON 6
ci_08                -6.510201e-03 3 1  ON 7
ci_09                -9.366293e-03 3 1  ON 8
ci_10                -9.370312e-03 3 1  ON 9
ci_11                 1.304600e-02 3 1  ON 10
ci_12                 7.735535e-03 3 1  ON 11
ci_13                 1.267055e-02 3 1  ON 12
ci_14                 1.309102e-02 3 1  ON 13
ci_15                 7.155076e-03 3 1  ON 14
ci_16                 7.415351e-03 3 1  ON 15
ci_17                -7.629821e-03 3 1  ON 16
ci_18                -7.255143e-03 3 1  ON 17
ci_19                 9.364160e-03 3 1  ON 18
ci_20                 6.842977e-03 3 1  ON 19
ci_21                 8.756635e-03 3 1  ON 20
ci_22                 8.803209e-03 3 1  ON 21
ci_23                 4.943856e-03 3 1  ON 22
ci_24                 4.391824e-03 3 1  ON 23
ci_25                 3.169582e-03 3 1  ON 24
ci_26                 3.197929e-03 3 1  ON 25
ci_27                 3.324562e-03 3 1  ON 26
ci_28                 2.458910e-03 3 1  ON 27
ci_29                 2.081089e-03 3 1  ON 28
ci_30                -1.668658e-03 3 1  ON 29
ci_31                -1.621098e-03 3 1  ON 30
ci_32                -1.384733e-03 3 1  ON 31
ci_33                -1.056701e-03 3 1  ON 32
ci_34                 1.519719e-03 3 1  ON 33
ci_35                 1.308393e-03 3 1  ON 34
ci_36                -1.202185e-03 3 1  ON 35
ci_37                -1.159428e-03 3 1  ON 36
ci_38                -5.331614e-04 3 1  ON 37
ci_39                -6.804692e-04 3 1  ON 38
ci_40                -1.666502e-03 3 1  ON 39
ci_41                -1.450978e-03 3 1  ON 40
ci_42                -1.186732e-03 3 1  ON 41
ci_43                -2.871715e-03 3 1  ON 42
ci_44                -1.772094e-03 3 1  ON 43
ci_45                -6.966466e-04 3 1  ON 44
ci_46                -5.626947e-04 3 1  ON 45
ci_47                 1.266809e-03 3 1  ON 46
ci_48                 7.591252e-04 3 1  ON 47
ci_49                -9.355825e-04 3 1  ON 48
ci_50                -7.194473e-04 3 1  ON 49
ci_51                 3.915087e-04 3 1  ON 50
ci_52                 4.188258e-04 3 1  ON 51
ci_53                -6.118019e-04 3 1  ON 52
ci_54                -8.887360e-04 3 1  ON 53
ci_55                -7.055852e-04 3 1  ON 54
ci_56                 1.906514e-03 3 1  ON 55
ci_57                 1.721701e-03 3 1  ON 56
ci_58                -7.566708e-04 3 1  ON 57
ci_59                -9.995797e-04 3 1  ON 58
ci_60                 5.368390e-04 3 1  ON 59
ci_61                 6.366842e-04 3 1  ON 60
ci_62                -2.913622e-04 3 1  ON 61
ci_63                -5.664002e-04 3 1  ON 62
ci_64                -4.726729e-04 3 1  ON 63
ci_65                -2.862088e-04 3 1  ON 64
ci_66                -7.350622e-04 3 1  ON 65
ci_67                -5.627710e-04 3 1  ON 66
ci_68                -6.828358e-04 3 1  ON 67
ci_69                -6.895909e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.9287
    reference variance = 0.412025
====================================================
  Execution time = 2.5204e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5913e-01
  Total weights = 1.9641e+06
  Execution time = 3.4975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440248936868
                                         uncertainty =       0.003152232202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440248936868
                                         uncertainty =       0.003152232202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469237179
  error estimate for blocks of size 2^( 2) =       0.000494002176
  error estimate for blocks of size 2^( 3) =       0.000516702889
  error estimate for blocks of size 2^( 4) =       0.000534011350
  error estimate for blocks of size 2^( 5) =       0.000544328156
  error estimate for blocks of size 2^( 6) =       0.000550749895
  error estimate for blocks of size 2^( 7) =       0.000554518207

      target function =      -0.737832827941
              le_mean =     -22.815201819430
             les_mean =     520.992559950027
             stat err =       0.000545901902
             autocorr =       1.353456757618
   target nu stat err =       0.000545901902
   target dn stat err =       0.007324602447
      target stat err =       0.005969569271
              std dev =       0.663601581897
             le_variance =       0.440367059497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440188849123
                                         uncertainty =       0.003150722425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440188849123
                                         uncertainty =       0.003150722425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469205014
  error estimate for blocks of size 2^( 2) =       0.000493982728
  error estimate for blocks of size 2^( 3) =       0.000516698815
  error estimate for blocks of size 2^( 4) =       0.000534017104
  error estimate for blocks of size 2^( 5) =       0.000544340295
  error estimate for blocks of size 2^( 6) =       0.000550760645
  error estimate for blocks of size 2^( 7) =       0.000554528829

      target function =      -0.737702992127
              le_mean =     -22.815201872685
             les_mean =     520.992722502720
             stat err =       0.000545911718
             autocorr =       1.353691008253
   target nu stat err =       0.000545911718
   target dn stat err =       0.007327171190
      target stat err =       0.005969552509
              std dev =       0.663556094766
             le_variance =       0.440306690902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440217195990
                                         uncertainty =       0.003151458431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440217195990
                                         uncertainty =       0.003151458431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469220190
  error estimate for blocks of size 2^( 2) =       0.000493991762
  error estimate for blocks of size 2^( 3) =       0.000516700443
  error estimate for blocks of size 2^( 4) =       0.000534013985
  error estimate for blocks of size 2^( 5) =       0.000544334073
  error estimate for blocks of size 2^( 6) =       0.000550755132
  error estimate for blocks of size 2^( 7) =       0.000554523414

      target function =      -0.737809138492
              le_mean =     -22.815201724187
             les_mean =     520.992584818208
             stat err =       0.000545906651
             autocorr =       1.353578314932
   target nu stat err =       0.000545906651
   target dn stat err =       0.007324942748
      target stat err =       0.005969462108
              std dev =       0.663577557091
             le_variance =       0.440335174275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440244843827
                                         uncertainty =       0.003152132078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440244843827
                                         uncertainty =       0.003152132078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469234988
  error estimate for blocks of size 2^( 2) =       0.000494000814
  error estimate for blocks of size 2^( 3) =       0.000516702533
  error estimate for blocks of size 2^( 4) =       0.000534011635
  error estimate for blocks of size 2^( 5) =       0.000544328854
  error estimate for blocks of size 2^( 6) =       0.000550750511
  error estimate for blocks of size 2^( 7) =       0.000554518826

      target function =      -0.737834358868
              le_mean =     -22.815201792086
             les_mean =     520.992556815044
             stat err =       0.000545902457
             autocorr =       1.353472144879
   target nu stat err =       0.000545902457
   target dn stat err =       0.007324559769
      target stat err =       0.005969559303
              std dev =       0.663598484286
             le_variance =       0.440362948346


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.737832827941        initial
     9.5367e-01     9.5367e+00             3.0888e-04        -0.737702992127
     3.8147e+00     3.8147e+01             7.8883e-05        -0.737809138492
     1.5259e+01     1.5259e+02             1.9828e-05        -0.737834358868  <--

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 4.3474e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_01                 1.316218e-01 3 1  ON 0
ci_02                -3.155518e-02 3 1  ON 1
ci_03                -3.123044e-02 3 1  ON 2
ci_04                 2.812154e-02 3 1  ON 3
ci_05                -2.336767e-02 3 1  ON 4
ci_06                -2.304158e-02 3 1  ON 5
ci_07                 2.696265e-02 3 1  ON 6
ci_08                -6.517092e-03 3 1  ON 7
ci_09                -9.371490e-03 3 1  ON 8
ci_10                -9.376902e-03 3 1  ON 9
ci_11                 1.306085e-02 3 1  ON 10
ci_12                 7.748842e-03 3 1  ON 11
ci_13                 1.266991e-02 3 1  ON 12
ci_14                 1.307270e-02 3 1  ON 13
ci_15                 7.170296e-03 3 1  ON 14
ci_16                 7.422216e-03 3 1  ON 15
ci_17                -7.640284e-03 3 1  ON 16
ci_18                -7.259349e-03 3 1  ON 17
ci_19                 9.361539e-03 3 1  ON 18
ci_20                 6.832034e-03 3 1  ON 19
ci_21                 8.755708e-03 3 1  ON 20
ci_22                 8.800512e-03 3 1  ON 21
ci_23                 4.949458e-03 3 1  ON 22
ci_24                 4.392183e-03 3 1  ON 23
ci_25                 3.170393e-03 3 1  ON 24
ci_26                 3.200547e-03 3 1  ON 25
ci_27                 3.320398e-03 3 1  ON 26
ci_28                 2.454198e-03 3 1  ON 27
ci_29                 2.089388e-03 3 1  ON 28
ci_30                -1.674520e-03 3 1  ON 29
ci_31                -1.627108e-03 3 1  ON 30
ci_32                -1.387063e-03 3 1  ON 31
ci_33                -1.063742e-03 3 1  ON 32
ci_34                 1.514123e-03 3 1  ON 33
ci_35                 1.308732e-03 3 1  ON 34
ci_36                -1.200894e-03 3 1  ON 35
ci_37                -1.157081e-03 3 1  ON 36
ci_38                -5.241590e-04 3 1  ON 37
ci_39                -6.855617e-04 3 1  ON 38
ci_40                -1.669207e-03 3 1  ON 39
ci_41                -1.448426e-03 3 1  ON 40
ci_42                -1.175817e-03 3 1  ON 41
ci_43                -2.869675e-03 3 1  ON 42
ci_44                -1.764938e-03 3 1  ON 43
ci_45                -7.008531e-04 3 1  ON 44
ci_46                -5.601880e-04 3 1  ON 45
ci_47                 1.256188e-03 3 1  ON 46
ci_48                 7.493043e-04 3 1  ON 47
ci_49                -9.420136e-04 3 1  ON 48
ci_50                -7.215528e-04 3 1  ON 49
ci_51                 3.985531e-04 3 1  ON 50
ci_52                 4.186810e-04 3 1  ON 51
ci_53                -6.120352e-04 3 1  ON 52
ci_54                -8.918083e-04 3 1  ON 53
ci_55                -6.963779e-04 3 1  ON 54
ci_56                 1.908278e-03 3 1  ON 55
ci_57                 1.714351e-03 3 1  ON 56
ci_58                -7.635429e-04 3 1  ON 57
ci_59                -9.967069e-04 3 1  ON 58
ci_60                 5.442674e-04 3 1  ON 59
ci_61                 6.360938e-04 3 1  ON 60
ci_62                -2.961425e-04 3 1  ON 61
ci_63                -5.617859e-04 3 1  ON 62
ci_64                -4.697844e-04 3 1  ON 63
ci_65                -2.773501e-04 3 1  ON 64
ci_66                -7.290730e-04 3 1  ON 65
ci_67                -5.705940e-04 3 1  ON 66
ci_68                -6.761385e-04 3 1  ON 67
ci_69                -5.848565e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4009e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8118
    reference variance = 0.396468
====================================================
  Execution time = 2.6271e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4916e-01
  Total weights = 1.963776094e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437017104514
                                         uncertainty =       0.002195383195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437017104514
                                         uncertainty =       0.002195383195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467428019
  error estimate for blocks of size 2^( 2) =       0.000492774088
  error estimate for blocks of size 2^( 3) =       0.000515965647
  error estimate for blocks of size 2^( 4) =       0.000533230363
  error estimate for blocks of size 2^( 5) =       0.000544485166
  error estimate for blocks of size 2^( 6) =       0.000549277383
  error estimate for blocks of size 2^( 7) =       0.000553080319

      target function =      -0.746037742109
              le_mean =     -22.814516683009
             les_mean =     520.951335713121
             stat err =       0.000545018308
             autocorr =       1.359542214891
   target nu stat err =       0.000545018308
   target dn stat err =       0.003088744202
      target stat err =       0.002628428349
              std dev =       0.661043044510
             le_variance =       0.436977906695


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281451668301e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746046120729       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746050871998       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746051501183       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746051617438       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746051681117       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746051706370       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746051704462       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746051702873       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746051704286       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 7.874125e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746046120729       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746047319637       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746047477791       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746047506900       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746047522789       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746047529041       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746047528547       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746047528153       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746047528503       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 1.979344e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746046120729       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746046421157       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746046460750       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746046468030       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746046472000       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746046473559       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746046473434       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746046473336       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746046473423       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 4.955169e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256728 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0782e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_01                 1.316020e-01 3 1  ON 0
ci_02                -3.154101e-02 3 1  ON 1
ci_03                -3.121510e-02 3 1  ON 2
ci_04                 2.811650e-02 3 1  ON 3
ci_05                -2.336426e-02 3 1  ON 4
ci_06                -2.303044e-02 3 1  ON 5
ci_07                 2.695704e-02 3 1  ON 6
ci_08                -6.514464e-03 3 1  ON 7
ci_09                -9.369081e-03 3 1  ON 8
ci_10                -9.377550e-03 3 1  ON 9
ci_11                 1.305963e-02 3 1  ON 10
ci_12                 7.747288e-03 3 1  ON 11
ci_13                 1.266949e-02 3 1  ON 12
ci_14                 1.307154e-02 3 1  ON 13
ci_15                 7.164653e-03 3 1  ON 14
ci_16                 7.418547e-03 3 1  ON 15
ci_17                -7.638963e-03 3 1  ON 16
ci_18                -7.257810e-03 3 1  ON 17
ci_19                 9.360550e-03 3 1  ON 18
ci_20                 6.833597e-03 3 1  ON 19
ci_21                 8.759002e-03 3 1  ON 20
ci_22                 8.799254e-03 3 1  ON 21
ci_23                 4.950584e-03 3 1  ON 22
ci_24                 4.395337e-03 3 1  ON 23
ci_25                 3.171814e-03 3 1  ON 24
ci_26                 3.200701e-03 3 1  ON 25
ci_27                 3.321106e-03 3 1  ON 26
ci_28                 2.454893e-03 3 1  ON 27
ci_29                 2.087821e-03 3 1  ON 28
ci_30                -1.675661e-03 3 1  ON 29
ci_31                -1.628222e-03 3 1  ON 30
ci_32                -1.388960e-03 3 1  ON 31
ci_33                -1.060190e-03 3 1  ON 32
ci_34                 1.512631e-03 3 1  ON 33
ci_35                 1.311284e-03 3 1  ON 34
ci_36                -1.200398e-03 3 1  ON 35
ci_37                -1.154297e-03 3 1  ON 36
ci_38                -5.230725e-04 3 1  ON 37
ci_39                -6.834782e-04 3 1  ON 38
ci_40                -1.667494e-03 3 1  ON 39
ci_41                -1.446792e-03 3 1  ON 40
ci_42                -1.176789e-03 3 1  ON 41
ci_43                -2.872581e-03 3 1  ON 42
ci_44                -1.761975e-03 3 1  ON 43
ci_45                -7.006348e-04 3 1  ON 44
ci_46                -5.590206e-04 3 1  ON 45
ci_47                 1.258442e-03 3 1  ON 46
ci_48                 7.499038e-04 3 1  ON 47
ci_49                -9.409689e-04 3 1  ON 48
ci_50                -7.206598e-04 3 1  ON 49
ci_51                 3.986005e-04 3 1  ON 50
ci_52                 4.176576e-04 3 1  ON 51
ci_53                -6.135043e-04 3 1  ON 52
ci_54                -8.907366e-04 3 1  ON 53
ci_55                -6.956050e-04 3 1  ON 54
ci_56                 1.908660e-03 3 1  ON 55
ci_57                 1.716522e-03 3 1  ON 56
ci_58                -7.625056e-04 3 1  ON 57
ci_59                -9.919371e-04 3 1  ON 58
ci_60                 5.443717e-04 3 1  ON 59
ci_61                 6.362793e-04 3 1  ON 60
ci_62                -2.962758e-04 3 1  ON 61
ci_63                -5.618649e-04 3 1  ON 62
ci_64                -4.696814e-04 3 1  ON 63
ci_65                -2.771485e-04 3 1  ON 64
ci_66                -7.292463e-04 3 1  ON 65
ci_67                -5.690816e-04 3 1  ON 66
ci_68                -6.792224e-04 3 1  ON 67
ci_69                -5.785510e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8786
    reference variance = 0.316667
====================================================
  Execution time = 2.5509e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5050e-01
  Total weights = 1.9643e+06
  Execution time = 3.4956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437232478665
                                         uncertainty =       0.002620609202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437232478665
                                         uncertainty =       0.002620609202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467578396
  error estimate for blocks of size 2^( 2) =       0.000492539988
  error estimate for blocks of size 2^( 3) =       0.000516436115
  error estimate for blocks of size 2^( 4) =       0.000534341952
  error estimate for blocks of size 2^( 5) =       0.000544376620
  error estimate for blocks of size 2^( 6) =       0.000547621867
  error estimate for blocks of size 2^( 7) =       0.000551346411

      target function =      -0.744943835422
              le_mean =     -22.815219782848
             les_mean =     520.984735184956
             stat err =       0.000544421712
             autocorr =       1.355695022045
   target nu stat err =       0.000544421712
   target dn stat err =       0.003769088187
      target stat err =       0.003173422758
              std dev =       0.661255708454
             le_variance =       0.437259111963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437217846800
                                         uncertainty =       0.002620266412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437217846800
                                         uncertainty =       0.002620266412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467570579
  error estimate for blocks of size 2^( 2) =       0.000492535153
  error estimate for blocks of size 2^( 3) =       0.000516434395
  error estimate for blocks of size 2^( 4) =       0.000534343238
  error estimate for blocks of size 2^( 5) =       0.000544379206
  error estimate for blocks of size 2^( 6) =       0.000547626423
  error estimate for blocks of size 2^( 7) =       0.000551352798

      target function =      -0.744430016074
              le_mean =     -22.815220127063
             les_mean =     520.985372565221
             stat err =       0.000544425416
             autocorr =       1.355758798042
   target nu stat err =       0.000544425416
   target dn stat err =       0.003817846340
      target stat err =       0.003208648181
              std dev =       0.661244653877
             le_variance =       0.437244492281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437225068711
                                         uncertainty =       0.002620436296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437225068711
                                         uncertainty =       0.002620436296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467574437
  error estimate for blocks of size 2^( 2) =       0.000492537532
  error estimate for blocks of size 2^( 3) =       0.000516435227
  error estimate for blocks of size 2^( 4) =       0.000534342576
  error estimate for blocks of size 2^( 5) =       0.000544377902
  error estimate for blocks of size 2^( 6) =       0.000547624137
  error estimate for blocks of size 2^( 7) =       0.000551349608

      target function =      -0.744897003783
              le_mean =     -22.815219953706
             les_mean =     520.984799643634
             stat err =       0.000544423556
             autocorr =       1.355727159624
   target nu stat err =       0.000544423556
   target dn stat err =       0.003769335889
      target stat err =       0.003173233166
              std dev =       0.661250110141
             le_variance =       0.437251708162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437231546479
                                         uncertainty =       0.002620587486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437231546479
                                         uncertainty =       0.002620587486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467577898
  error estimate for blocks of size 2^( 2) =       0.000492539678
  error estimate for blocks of size 2^( 3) =       0.000516436001
  error estimate for blocks of size 2^( 4) =       0.000534342028
  error estimate for blocks of size 2^( 5) =       0.000544376778
  error estimate for blocks of size 2^( 6) =       0.000547622149
  error estimate for blocks of size 2^( 7) =       0.000551346809

      target function =      -0.744941261992
              le_mean =     -22.815219803613
             les_mean =     520.984739246246
             stat err =       0.000544421941
             autocorr =       1.355699048589
   target nu stat err =       0.000544421941
   target dn stat err =       0.003769072165
      target stat err =       0.003173388375
              std dev =       0.661255004177
             le_variance =       0.437258180549


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744943835422        initial  <--
     3.8147e+00     3.8147e+01             7.8741e-05        -0.744430016074
     1.5259e+01     1.5259e+02             1.9793e-05        -0.744897003783
     6.1035e+01     6.1035e+02             4.9552e-06        -0.744941261992

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0798
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_01                 1.316218e-01 3 1  ON 0
ci_02                -3.155518e-02 3 1  ON 1
ci_03                -3.123044e-02 3 1  ON 2
ci_04                 2.812154e-02 3 1  ON 3
ci_05                -2.336767e-02 3 1  ON 4
ci_06                -2.304158e-02 3 1  ON 5
ci_07                 2.696265e-02 3 1  ON 6
ci_08                -6.517092e-03 3 1  ON 7
ci_09                -9.371490e-03 3 1  ON 8
ci_10                -9.376902e-03 3 1  ON 9
ci_11                 1.306085e-02 3 1  ON 10
ci_12                 7.748842e-03 3 1  ON 11
ci_13                 1.266991e-02 3 1  ON 12
ci_14                 1.307270e-02 3 1  ON 13
ci_15                 7.170296e-03 3 1  ON 14
ci_16                 7.422216e-03 3 1  ON 15
ci_17                -7.640284e-03 3 1  ON 16
ci_18                -7.259349e-03 3 1  ON 17
ci_19                 9.361539e-03 3 1  ON 18
ci_20                 6.832034e-03 3 1  ON 19
ci_21                 8.755708e-03 3 1  ON 20
ci_22                 8.800512e-03 3 1  ON 21
ci_23                 4.949458e-03 3 1  ON 22
ci_24                 4.392183e-03 3 1  ON 23
ci_25                 3.170393e-03 3 1  ON 24
ci_26                 3.200547e-03 3 1  ON 25
ci_27                 3.320398e-03 3 1  ON 26
ci_28                 2.454198e-03 3 1  ON 27
ci_29                 2.089388e-03 3 1  ON 28
ci_30                -1.674520e-03 3 1  ON 29
ci_31                -1.627108e-03 3 1  ON 30
ci_32                -1.387063e-03 3 1  ON 31
ci_33                -1.063742e-03 3 1  ON 32
ci_34                 1.514123e-03 3 1  ON 33
ci_35                 1.308732e-03 3 1  ON 34
ci_36                -1.200894e-03 3 1  ON 35
ci_37                -1.157081e-03 3 1  ON 36
ci_38                -5.241590e-04 3 1  ON 37
ci_39                -6.855617e-04 3 1  ON 38
ci_40                -1.669207e-03 3 1  ON 39
ci_41                -1.448426e-03 3 1  ON 40
ci_42                -1.175817e-03 3 1  ON 41
ci_43                -2.869675e-03 3 1  ON 42
ci_44                -1.764938e-03 3 1  ON 43
ci_45                -7.008531e-04 3 1  ON 44
ci_46                -5.601880e-04 3 1  ON 45
ci_47                 1.256188e-03 3 1  ON 46
ci_48                 7.493043e-04 3 1  ON 47
ci_49                -9.420136e-04 3 1  ON 48
ci_50                -7.215528e-04 3 1  ON 49
ci_51                 3.985531e-04 3 1  ON 50
ci_52                 4.186810e-04 3 1  ON 51
ci_53                -6.120352e-04 3 1  ON 52
ci_54                -8.918083e-04 3 1  ON 53
ci_55                -6.963779e-04 3 1  ON 54
ci_56                 1.908278e-03 3 1  ON 55
ci_57                 1.714351e-03 3 1  ON 56
ci_58                -7.635429e-04 3 1  ON 57
ci_59                -9.967069e-04 3 1  ON 58
ci_60                 5.442674e-04 3 1  ON 59
ci_61                 6.360938e-04 3 1  ON 60
ci_62                -2.961425e-04 3 1  ON 61
ci_63                -5.617859e-04 3 1  ON 62
ci_64                -4.697844e-04 3 1  ON 63
ci_65                -2.773501e-04 3 1  ON 64
ci_66                -7.290730e-04 3 1  ON 65
ci_67                -5.705940e-04 3 1  ON 66
ci_68                -6.761385e-04 3 1  ON 67
ci_69                -5.848565e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3903e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.9751
    reference variance = 1.08538
====================================================
  Execution time = 2.5927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4617e-01
  Total weights = 1.964456545e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432642118985
                                         uncertainty =       0.002143049275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432642118985
                                         uncertainty =       0.002143049275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465143003
  error estimate for blocks of size 2^( 2) =       0.000490111922
  error estimate for blocks of size 2^( 3) =       0.000513439615
  error estimate for blocks of size 2^( 4) =       0.000530193151
  error estimate for blocks of size 2^( 5) =       0.000540333258
  error estimate for blocks of size 2^( 6) =       0.000544241402
  error estimate for blocks of size 2^( 7) =       0.000551535285

      target function =      -0.748527599515
              le_mean =     -22.814331978827
             les_mean =     520.939909591939
             stat err =       0.000541575774
             autocorr =       1.355643427513
   target nu stat err =       0.000541575774
   target dn stat err =       0.003120147509
      target stat err =       0.002669422511
              std dev =       0.657811543739
             le_variance =       0.432716027076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281433197883e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748536084282       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748536688020       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748536796322       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748536812714       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748536818081       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748536818374       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748536818438       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748536818750       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748536818620       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748536818507       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+01 is 6.227054e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748536084282       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748536235369       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748536262460       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748536266558       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748536267900       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748536267972       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748536267988       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748536268066       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748536268034       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748536268005       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+02 is 1.557582e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748536084282       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748536122063       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748536128837       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748536129862       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748536130197       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748536130215       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748536130219       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748536130239       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748536130230       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748536130223       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+02 is 3.894468e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260192 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0489e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_01                 1.316202e-01 3 1  ON 0
ci_02                -3.155388e-02 3 1  ON 1
ci_03                -3.122937e-02 3 1  ON 2
ci_04                 2.812035e-02 3 1  ON 3
ci_05                -2.336745e-02 3 1  ON 4
ci_06                -2.304125e-02 3 1  ON 5
ci_07                 2.696268e-02 3 1  ON 6
ci_08                -6.516586e-03 3 1  ON 7
ci_09                -9.371070e-03 3 1  ON 8
ci_10                -9.376429e-03 3 1  ON 9
ci_11                 1.306044e-02 3 1  ON 10
ci_12                 7.748831e-03 3 1  ON 11
ci_13                 1.266969e-02 3 1  ON 12
ci_14                 1.307312e-02 3 1  ON 13
ci_15                 7.170273e-03 3 1  ON 14
ci_16                 7.421512e-03 3 1  ON 15
ci_17                -7.639782e-03 3 1  ON 16
ci_18                -7.259097e-03 3 1  ON 17
ci_19                 9.360992e-03 3 1  ON 18
ci_20                 6.832128e-03 3 1  ON 19
ci_21                 8.755736e-03 3 1  ON 20
ci_22                 8.800523e-03 3 1  ON 21
ci_23                 4.949134e-03 3 1  ON 22
ci_24                 4.391676e-03 3 1  ON 23
ci_25                 3.170584e-03 3 1  ON 24
ci_26                 3.200846e-03 3 1  ON 25
ci_27                 3.320108e-03 3 1  ON 26
ci_28                 2.454282e-03 3 1  ON 27
ci_29                 2.089139e-03 3 1  ON 28
ci_30                -1.674252e-03 3 1  ON 29
ci_31                -1.626971e-03 3 1  ON 30
ci_32                -1.387024e-03 3 1  ON 31
ci_33                -1.063731e-03 3 1  ON 32
ci_34                 1.514362e-03 3 1  ON 33
ci_35                 1.308877e-03 3 1  ON 34
ci_36                -1.200965e-03 3 1  ON 35
ci_37                -1.157128e-03 3 1  ON 36
ci_38                -5.241294e-04 3 1  ON 37
ci_39                -6.852333e-04 3 1  ON 38
ci_40                -1.668737e-03 3 1  ON 39
ci_41                -1.448202e-03 3 1  ON 40
ci_42                -1.175679e-03 3 1  ON 41
ci_43                -2.870010e-03 3 1  ON 42
ci_44                -1.765417e-03 3 1  ON 43
ci_45                -7.008897e-04 3 1  ON 44
ci_46                -5.597734e-04 3 1  ON 45
ci_47                 1.256093e-03 3 1  ON 46
ci_48                 7.500517e-04 3 1  ON 47
ci_49                -9.422211e-04 3 1  ON 48
ci_50                -7.215262e-04 3 1  ON 49
ci_51                 3.985990e-04 3 1  ON 50
ci_52                 4.183169e-04 3 1  ON 51
ci_53                -6.120069e-04 3 1  ON 52
ci_54                -8.915423e-04 3 1  ON 53
ci_55                -6.965066e-04 3 1  ON 54
ci_56                 1.908151e-03 3 1  ON 55
ci_57                 1.714575e-03 3 1  ON 56
ci_58                -7.634744e-04 3 1  ON 57
ci_59                -9.964150e-04 3 1  ON 58
ci_60                 5.444266e-04 3 1  ON 59
ci_61                 6.358854e-04 3 1  ON 60
ci_62                -2.962752e-04 3 1  ON 61
ci_63                -5.617542e-04 3 1  ON 62
ci_64                -4.688472e-04 3 1  ON 63
ci_65                -2.778930e-04 3 1  ON 64
ci_66                -7.291969e-04 3 1  ON 65
ci_67                -5.704241e-04 3 1  ON 66
ci_68                -6.762691e-04 3 1  ON 67
ci_69                -5.892720e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.6855
    reference variance = 0.434002
====================================================
  Execution time = 2.5274e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4590e-01
  Total weights = 1.9643e+06
  Execution time = 3.5074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433691706783
                                         uncertainty =       0.001818589537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433691706783
                                         uncertainty =       0.001818589537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465663404
  error estimate for blocks of size 2^( 2) =       0.000490995503
  error estimate for blocks of size 2^( 3) =       0.000515186447
  error estimate for blocks of size 2^( 4) =       0.000532252834
  error estimate for blocks of size 2^( 5) =       0.000543760451
  error estimate for blocks of size 2^( 6) =       0.000549282007
  error estimate for blocks of size 2^( 7) =       0.000552649672

      target function =      -0.748754210646
              le_mean =     -22.814505599175
             les_mean =     520.947564434079
             stat err =       0.000544486241
             autocorr =       1.367192297961
   target nu stat err =       0.000544486241
   target dn stat err =       0.002628446684
      target stat err =       0.002274872955
              std dev =       0.658547500765
             le_variance =       0.433684810764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433690184892
                                         uncertainty =       0.001818579359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433690184892
                                         uncertainty =       0.001818579359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465662583
  error estimate for blocks of size 2^( 2) =       0.000490994991
  error estimate for blocks of size 2^( 3) =       0.000515186264
  error estimate for blocks of size 2^( 4) =       0.000532252935
  error estimate for blocks of size 2^( 5) =       0.000543760770
  error estimate for blocks of size 2^( 6) =       0.000549282322
  error estimate for blocks of size 2^( 7) =       0.000552650048

      target function =      -0.748756032605
              le_mean =     -22.814505606600
             les_mean =     520.947562586061
             stat err =       0.000544486519
             autocorr =       1.367198510718
   target nu stat err =       0.000544486519
   target dn stat err =       0.002628887010
      target stat err =       0.002275237749
              std dev =       0.658546340759
             le_variance =       0.433683282927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433690944643
                                         uncertainty =       0.001818584431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433690944643
                                         uncertainty =       0.001818584431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465662993
  error estimate for blocks of size 2^( 2) =       0.000490995247
  error estimate for blocks of size 2^( 3) =       0.000515186356
  error estimate for blocks of size 2^( 4) =       0.000532252885
  error estimate for blocks of size 2^( 5) =       0.000543760611
  error estimate for blocks of size 2^( 6) =       0.000549282164
  error estimate for blocks of size 2^( 7) =       0.000552649860

      target function =      -0.748755158074
              le_mean =     -22.814505602805
             les_mean =     520.947563462614
             stat err =       0.000544486380
             autocorr =       1.367195407605
   target nu stat err =       0.000544486380
   target dn stat err =       0.002628666475
      target stat err =       0.002275055265
              std dev =       0.658546919853
             le_variance =       0.433684045647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433691611434
                                         uncertainty =       0.001818588898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433691611434
                                         uncertainty =       0.001818588898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465663352
  error estimate for blocks of size 2^( 2) =       0.000490995471
  error estimate for blocks of size 2^( 3) =       0.000515186436
  error estimate for blocks of size 2^( 4) =       0.000532252841
  error estimate for blocks of size 2^( 5) =       0.000543760471
  error estimate for blocks of size 2^( 6) =       0.000549282026
  error estimate for blocks of size 2^( 7) =       0.000552649695

      target function =      -0.748754333056
              le_mean =     -22.814505599620
             les_mean =     520.947564307464
             stat err =       0.000544486258
             autocorr =       1.367192686816
   target nu stat err =       0.000544486258
   target dn stat err =       0.002628474098
      target stat err =       0.002274895719
              std dev =       0.658547428089
             le_variance =       0.433684715043


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748754210646        initial
     3.8147e+01     3.8147e+02             6.2271e-06        -0.748756032605  <--
     1.5259e+02     1.5259e+03             1.5576e-06        -0.748755158074
     6.1035e+02     6.1035e+03             3.8945e-07        -0.748754333056

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 4.2868e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_01                 1.316156e-01 3 1  ON 0
ci_02                -3.154997e-02 3 1  ON 1
ci_03                -3.122619e-02 3 1  ON 2
ci_04                 2.811678e-02 3 1  ON 3
ci_05                -2.336676e-02 3 1  ON 4
ci_06                -2.304025e-02 3 1  ON 5
ci_07                 2.696274e-02 3 1  ON 6
ci_08                -6.515073e-03 3 1  ON 7
ci_09                -9.369812e-03 3 1  ON 8
ci_10                -9.375012e-03 3 1  ON 9
ci_11                 1.305920e-02 3 1  ON 10
ci_12                 7.748798e-03 3 1  ON 11
ci_13                 1.266903e-02 3 1  ON 12
ci_14                 1.307439e-02 3 1  ON 13
ci_15                 7.170206e-03 3 1  ON 14
ci_16                 7.419402e-03 3 1  ON 15
ci_17                -7.638279e-03 3 1  ON 16
ci_18                -7.258341e-03 3 1  ON 17
ci_19                 9.359352e-03 3 1  ON 18
ci_20                 6.832409e-03 3 1  ON 19
ci_21                 8.755818e-03 3 1  ON 20
ci_22                 8.800555e-03 3 1  ON 21
ci_23                 4.948162e-03 3 1  ON 22
ci_24                 4.390156e-03 3 1  ON 23
ci_25                 3.171155e-03 3 1  ON 24
ci_26                 3.201743e-03 3 1  ON 25
ci_27                 3.319237e-03 3 1  ON 26
ci_28                 2.454534e-03 3 1  ON 27
ci_29                 2.088392e-03 3 1  ON 28
ci_30                -1.673449e-03 3 1  ON 29
ci_31                -1.626560e-03 3 1  ON 30
ci_32                -1.386907e-03 3 1  ON 31
ci_33                -1.063695e-03 3 1  ON 32
ci_34                 1.515076e-03 3 1  ON 33
ci_35                 1.309310e-03 3 1  ON 34
ci_36                -1.201177e-03 3 1  ON 35
ci_37                -1.157271e-03 3 1  ON 36
ci_38                -5.240410e-04 3 1  ON 37
ci_39                -6.842492e-04 3 1  ON 38
ci_40                -1.667330e-03 3 1  ON 39
ci_41                -1.447534e-03 3 1  ON 40
ci_42                -1.175266e-03 3 1  ON 41
ci_43                -2.871015e-03 3 1  ON 42
ci_44                -1.766851e-03 3 1  ON 43
ci_45                -7.009991e-04 3 1  ON 44
ci_46                -5.585311e-04 3 1  ON 45
ci_47                 1.255806e-03 3 1  ON 46
ci_48                 7.522919e-04 3 1  ON 47
ci_49                -9.428429e-04 3 1  ON 48
ci_50                -7.214465e-04 3 1  ON 49
ci_51                 3.987366e-04 3 1  ON 50
ci_52                 4.172259e-04 3 1  ON 51
ci_53                -6.119222e-04 3 1  ON 52
ci_54                -8.907453e-04 3 1  ON 53
ci_55                -6.968926e-04 3 1  ON 54
ci_56                 1.907769e-03 3 1  ON 55
ci_57                 1.715246e-03 3 1  ON 56
ci_58                -7.632693e-04 3 1  ON 57
ci_59                -9.955407e-04 3 1  ON 58
ci_60                 5.449039e-04 3 1  ON 59
ci_61                 6.352609e-04 3 1  ON 60
ci_62                -2.966728e-04 3 1  ON 61
ci_63                -5.616590e-04 3 1  ON 62
ci_64                -4.660390e-04 3 1  ON 63
ci_65                -2.795194e-04 3 1  ON 64
ci_66                -7.295684e-04 3 1  ON 65
ci_67                -5.699151e-04 3 1  ON 66
ci_68                -6.766602e-04 3 1  ON 67
ci_69                -6.025021e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3363e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.9416
    reference variance = 0.850577
====================================================
  Execution time = 2.5983e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6530e-01
  Total weights = 1.964138854e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436776361697
                                         uncertainty =       0.004754383511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436776361697
                                         uncertainty =       0.004754383511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467315851
  error estimate for blocks of size 2^( 2) =       0.000492599871
  error estimate for blocks of size 2^( 3) =       0.000516123357
  error estimate for blocks of size 2^( 4) =       0.000532135385
  error estimate for blocks of size 2^( 5) =       0.000541872184
  error estimate for blocks of size 2^( 6) =       0.000547934911
  error estimate for blocks of size 2^( 7) =       0.000551880387

      target function =      -0.732509166610
              le_mean =     -22.815263341956
             les_mean =     521.001537963715
             stat err =       0.000543455717
             autocorr =       1.352406650224
   target nu stat err =       0.000543455717
   target dn stat err =       0.021395153370
      target stat err =       0.017119452282
              std dev =       0.660884415085
             le_variance =       0.436768210103


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281526334196e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.732908901511       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.732914640398       residual = 8.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.732915277688       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.732915315066       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.732915334006       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.732915346659       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.732915350918       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.732915348983       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.732915348178       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.732915347410       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+00 is 4.660144e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.732908901511       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.732910341374       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.732910500974       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.732910510290       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.732910515009       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.732910518162       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.732910519222       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.732910518739       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.732910518538       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.732910518347       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+01 is 1.168886e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.732908901511       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.732909261799       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.732909301717       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.732909304044       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.732909305223       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.732909306010       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.732909306275       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.732909306154       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.732909306105       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.732909306057       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+02 is 2.924630e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263707 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0505e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_01                 1.316070e-01 3 1  ON 0
ci_02                -3.154196e-02 3 1  ON 1
ci_03                -3.122385e-02 3 1  ON 2
ci_04                 2.811709e-02 3 1  ON 3
ci_05                -2.335507e-02 3 1  ON 4
ci_06                -2.303641e-02 3 1  ON 5
ci_07                 2.696149e-02 3 1  ON 6
ci_08                -6.513559e-03 3 1  ON 7
ci_09                -9.367857e-03 3 1  ON 8
ci_10                -9.366295e-03 3 1  ON 9
ci_11                 1.306009e-02 3 1  ON 10
ci_12                 7.747427e-03 3 1  ON 11
ci_13                 1.266753e-02 3 1  ON 12
ci_14                 1.307240e-02 3 1  ON 13
ci_15                 7.169769e-03 3 1  ON 14
ci_16                 7.413201e-03 3 1  ON 15
ci_17                -7.633938e-03 3 1  ON 16
ci_18                -7.259754e-03 3 1  ON 17
ci_19                 9.358540e-03 3 1  ON 18
ci_20                 6.831431e-03 3 1  ON 19
ci_21                 8.754504e-03 3 1  ON 20
ci_22                 8.798385e-03 3 1  ON 21
ci_23                 4.946901e-03 3 1  ON 22
ci_24                 4.390662e-03 3 1  ON 23
ci_25                 3.173475e-03 3 1  ON 24
ci_26                 3.203701e-03 3 1  ON 25
ci_27                 3.318908e-03 3 1  ON 26
ci_28                 2.452327e-03 3 1  ON 27
ci_29                 2.087432e-03 3 1  ON 28
ci_30                -1.674243e-03 3 1  ON 29
ci_31                -1.623799e-03 3 1  ON 30
ci_32                -1.386594e-03 3 1  ON 31
ci_33                -1.062713e-03 3 1  ON 32
ci_34                 1.513668e-03 3 1  ON 33
ci_35                 1.313767e-03 3 1  ON 34
ci_36                -1.200274e-03 3 1  ON 35
ci_37                -1.156849e-03 3 1  ON 36
ci_38                -5.240106e-04 3 1  ON 37
ci_39                -6.834815e-04 3 1  ON 38
ci_40                -1.666600e-03 3 1  ON 39
ci_41                -1.447400e-03 3 1  ON 40
ci_42                -1.178529e-03 3 1  ON 41
ci_43                -2.870738e-03 3 1  ON 42
ci_44                -1.765699e-03 3 1  ON 43
ci_45                -6.996995e-04 3 1  ON 44
ci_46                -5.579888e-04 3 1  ON 45
ci_47                 1.257113e-03 3 1  ON 46
ci_48                 7.531326e-04 3 1  ON 47
ci_49                -9.423512e-04 3 1  ON 48
ci_50                -7.221043e-04 3 1  ON 49
ci_51                 3.987055e-04 3 1  ON 50
ci_52                 4.168368e-04 3 1  ON 51
ci_53                -6.134157e-04 3 1  ON 52
ci_54                -8.909611e-04 3 1  ON 53
ci_55                -6.962282e-04 3 1  ON 54
ci_56                 1.908992e-03 3 1  ON 55
ci_57                 1.717387e-03 3 1  ON 56
ci_58                -7.624349e-04 3 1  ON 57
ci_59                -9.929771e-04 3 1  ON 58
ci_60                 5.448640e-04 3 1  ON 59
ci_61                 6.362710e-04 3 1  ON 60
ci_62                -2.971811e-04 3 1  ON 61
ci_63                -5.632235e-04 3 1  ON 62
ci_64                -4.653765e-04 3 1  ON 63
ci_65                -2.803722e-04 3 1  ON 64
ci_66                -7.289991e-04 3 1  ON 65
ci_67                -5.696378e-04 3 1  ON 66
ci_68                -6.769297e-04 3 1  ON 67
ci_69                -6.101054e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.7432
    reference variance = 0.456049
====================================================
  Execution time = 2.5174e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4450e-01
  Total weights = 1.9643e+06
  Execution time = 3.5045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431977947767
                                         uncertainty =       0.001827546523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431977947767
                                         uncertainty =       0.001827546523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464768062
  error estimate for blocks of size 2^( 2) =       0.000489960285
  error estimate for blocks of size 2^( 3) =       0.000514137945
  error estimate for blocks of size 2^( 4) =       0.000532108215
  error estimate for blocks of size 2^( 5) =       0.000542428769
  error estimate for blocks of size 2^( 6) =       0.000545805865
  error estimate for blocks of size 2^( 7) =       0.000550677244

      target function =      -0.749921843863
              le_mean =     -22.814739711016
             les_mean =     520.956852106576
             stat err =       0.000542755023
             autocorr =       1.363751212117
   target nu stat err =       0.000542755023
   target dn stat err =       0.002538249360
      target stat err =       0.002209302206
              std dev =       0.657281296900
             le_variance =       0.432018703254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431969552891
                                         uncertainty =       0.001826949298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431969552891
                                         uncertainty =       0.001826949298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464763546
  error estimate for blocks of size 2^( 2) =       0.000489957198
  error estimate for blocks of size 2^( 3) =       0.000514136038
  error estimate for blocks of size 2^( 4) =       0.000532107302
  error estimate for blocks of size 2^( 5) =       0.000542428224
  error estimate for blocks of size 2^( 6) =       0.000545806142
  error estimate for blocks of size 2^( 7) =       0.000550678414

      target function =      -0.749923404777
              le_mean =     -22.814740047793
             les_mean =     520.956865608903
             stat err =       0.000542755020
             autocorr =       1.363777704412
   target nu stat err =       0.000542755020
   target dn stat err =       0.002538858322
      target stat err =       0.002209802368
              std dev =       0.657274909548
             le_variance =       0.432010306721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431973715413
                                         uncertainty =       0.001827245457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431973715413
                                         uncertainty =       0.001827245457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464765785
  error estimate for blocks of size 2^( 2) =       0.000489958725
  error estimate for blocks of size 2^( 3) =       0.000514136978
  error estimate for blocks of size 2^( 4) =       0.000532107746
  error estimate for blocks of size 2^( 5) =       0.000542428485
  error estimate for blocks of size 2^( 6) =       0.000545805992
  error estimate for blocks of size 2^( 7) =       0.000550677820

      target function =      -0.749923637112
              le_mean =     -22.814739876974
             les_mean =     520.956857536890
             stat err =       0.000542755011
             autocorr =       1.363764513591
   target nu stat err =       0.000542755011
   target dn stat err =       0.002538543796
      target stat err =       0.002209549932
              std dev =       0.657278076678
             le_variance =       0.432014470082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431977415889
                                         uncertainty =       0.001827508685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431977415889
                                         uncertainty =       0.001827508685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464767776
  error estimate for blocks of size 2^( 2) =       0.000489960088
  error estimate for blocks of size 2^( 3) =       0.000514137823
  error estimate for blocks of size 2^( 4) =       0.000532108155
  error estimate for blocks of size 2^( 5) =       0.000542428732
  error estimate for blocks of size 2^( 6) =       0.000545805880
  error estimate for blocks of size 2^( 7) =       0.000550677315

      target function =      -0.749922314151
              le_mean =     -22.814739731437
             les_mean =     520.956852476545
             stat err =       0.000542755020
             autocorr =       1.363752877509
   target nu stat err =       0.000542755020
   target dn stat err =       0.002538285083
      target stat err =       0.002209333695
              std dev =       0.657280892219
             le_variance =       0.432018171276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749921843863        initial
     9.5367e+00     9.5367e+01             4.6601e-05        -0.749923404777
     3.8147e+01     3.8147e+02             1.1689e-05        -0.749923637112  <--
     1.5259e+02     1.5259e+03             2.9246e-06        -0.749922314151

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 4.2792e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_01                 1.316070e-01 3 1  ON 0
ci_02                -3.154196e-02 3 1  ON 1
ci_03                -3.122385e-02 3 1  ON 2
ci_04                 2.811709e-02 3 1  ON 3
ci_05                -2.335507e-02 3 1  ON 4
ci_06                -2.303641e-02 3 1  ON 5
ci_07                 2.696149e-02 3 1  ON 6
ci_08                -6.513559e-03 3 1  ON 7
ci_09                -9.367857e-03 3 1  ON 8
ci_10                -9.366295e-03 3 1  ON 9
ci_11                 1.306009e-02 3 1  ON 10
ci_12                 7.747427e-03 3 1  ON 11
ci_13                 1.266753e-02 3 1  ON 12
ci_14                 1.307240e-02 3 1  ON 13
ci_15                 7.169769e-03 3 1  ON 14
ci_16                 7.413201e-03 3 1  ON 15
ci_17                -7.633938e-03 3 1  ON 16
ci_18                -7.259754e-03 3 1  ON 17
ci_19                 9.358540e-03 3 1  ON 18
ci_20                 6.831431e-03 3 1  ON 19
ci_21                 8.754504e-03 3 1  ON 20
ci_22                 8.798385e-03 3 1  ON 21
ci_23                 4.946901e-03 3 1  ON 22
ci_24                 4.390662e-03 3 1  ON 23
ci_25                 3.173475e-03 3 1  ON 24
ci_26                 3.203701e-03 3 1  ON 25
ci_27                 3.318908e-03 3 1  ON 26
ci_28                 2.452327e-03 3 1  ON 27
ci_29                 2.087432e-03 3 1  ON 28
ci_30                -1.674243e-03 3 1  ON 29
ci_31                -1.623799e-03 3 1  ON 30
ci_32                -1.386594e-03 3 1  ON 31
ci_33                -1.062713e-03 3 1  ON 32
ci_34                 1.513668e-03 3 1  ON 33
ci_35                 1.313767e-03 3 1  ON 34
ci_36                -1.200274e-03 3 1  ON 35
ci_37                -1.156849e-03 3 1  ON 36
ci_38                -5.240106e-04 3 1  ON 37
ci_39                -6.834815e-04 3 1  ON 38
ci_40                -1.666600e-03 3 1  ON 39
ci_41                -1.447400e-03 3 1  ON 40
ci_42                -1.178529e-03 3 1  ON 41
ci_43                -2.870738e-03 3 1  ON 42
ci_44                -1.765699e-03 3 1  ON 43
ci_45                -6.996995e-04 3 1  ON 44
ci_46                -5.579888e-04 3 1  ON 45
ci_47                 1.257113e-03 3 1  ON 46
ci_48                 7.531326e-04 3 1  ON 47
ci_49                -9.423512e-04 3 1  ON 48
ci_50                -7.221043e-04 3 1  ON 49
ci_51                 3.987055e-04 3 1  ON 50
ci_52                 4.168368e-04 3 1  ON 51
ci_53                -6.134157e-04 3 1  ON 52
ci_54                -8.909611e-04 3 1  ON 53
ci_55                -6.962282e-04 3 1  ON 54
ci_56                 1.908992e-03 3 1  ON 55
ci_57                 1.717387e-03 3 1  ON 56
ci_58                -7.624349e-04 3 1  ON 57
ci_59                -9.929771e-04 3 1  ON 58
ci_60                 5.448640e-04 3 1  ON 59
ci_61                 6.362710e-04 3 1  ON 60
ci_62                -2.971811e-04 3 1  ON 61
ci_63                -5.632235e-04 3 1  ON 62
ci_64                -4.653765e-04 3 1  ON 63
ci_65                -2.803722e-04 3 1  ON 64
ci_66                -7.289991e-04 3 1  ON 65
ci_67                -5.696378e-04 3 1  ON 66
ci_68                -6.769297e-04 3 1  ON 67
ci_69                -6.101054e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.7725
    reference variance = 0.436375
====================================================
  Execution time = 2.5891e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4812e-01
  Total weights = 1.964213274e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434392588765
                                         uncertainty =       0.001966547754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434392588765
                                         uncertainty =       0.001966547754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466035851
  error estimate for blocks of size 2^( 2) =       0.000491602177
  error estimate for blocks of size 2^( 3) =       0.000515126215
  error estimate for blocks of size 2^( 4) =       0.000532906202
  error estimate for blocks of size 2^( 5) =       0.000543884686
  error estimate for blocks of size 2^( 6) =       0.000548045553
  error estimate for blocks of size 2^( 7) =       0.000552217540

      target function =      -0.746904027263
              le_mean =     -22.814401067875
             les_mean =     520.945017142540
             stat err =       0.000544263495
             autocorr =       1.363891299784
   target nu stat err =       0.000544263495
   target dn stat err =       0.002758260280
      target stat err =       0.002367618515
              std dev =       0.659074220706
             le_variance =       0.434378828399


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281440106787e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746910485414       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746912819238       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746913117582       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746913157495       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746913159795       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746913161980       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746913158907       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746913155479       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746913155253       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746913155310       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+00 is 2.459170e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746910485414       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746911071105       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746911145855       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746911155832       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746911156398       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746911156940       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746911156171       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746911155315       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746911155259       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746911155273       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+01 is 6.161438e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746910485414       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746910631977       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746910650675       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746910653169       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746910653310       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746910653445       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746910653253       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746910653039       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746910653025       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746910653029       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+02 is 1.541207e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267194 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0432e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_01                 1.316009e-01 3 1  ON 0
ci_02                -3.153656e-02 3 1  ON 1
ci_03                -3.121877e-02 3 1  ON 2
ci_04                 2.811384e-02 3 1  ON 3
ci_05                -2.335156e-02 3 1  ON 4
ci_06                -2.303315e-02 3 1  ON 5
ci_07                 2.695986e-02 3 1  ON 6
ci_08                -6.512022e-03 3 1  ON 7
ci_09                -9.366233e-03 3 1  ON 8
ci_10                -9.363682e-03 3 1  ON 9
ci_11                 1.305852e-02 3 1  ON 10
ci_12                 7.746257e-03 3 1  ON 11
ci_13                 1.266760e-02 3 1  ON 12
ci_14                 1.307327e-02 3 1  ON 13
ci_15                 7.168779e-03 3 1  ON 14
ci_16                 7.413013e-03 3 1  ON 15
ci_17                -7.633265e-03 3 1  ON 16
ci_18                -7.259088e-03 3 1  ON 17
ci_19                 9.359258e-03 3 1  ON 18
ci_20                 6.831328e-03 3 1  ON 19
ci_21                 8.754540e-03 3 1  ON 20
ci_22                 8.797441e-03 3 1  ON 21
ci_23                 4.946632e-03 3 1  ON 22
ci_24                 4.391746e-03 3 1  ON 23
ci_25                 3.172393e-03 3 1  ON 24
ci_26                 3.202413e-03 3 1  ON 25
ci_27                 3.320250e-03 3 1  ON 26
ci_28                 2.452833e-03 3 1  ON 27
ci_29                 2.088456e-03 3 1  ON 28
ci_30                -1.672884e-03 3 1  ON 29
ci_31                -1.623505e-03 3 1  ON 30
ci_32                -1.385653e-03 3 1  ON 31
ci_33                -1.062771e-03 3 1  ON 32
ci_34                 1.513812e-03 3 1  ON 33
ci_35                 1.313323e-03 3 1  ON 34
ci_36                -1.199208e-03 3 1  ON 35
ci_37                -1.157200e-03 3 1  ON 36
ci_38                -5.244099e-04 3 1  ON 37
ci_39                -6.839541e-04 3 1  ON 38
ci_40                -1.666305e-03 3 1  ON 39
ci_41                -1.448224e-03 3 1  ON 40
ci_42                -1.178830e-03 3 1  ON 41
ci_43                -2.867882e-03 3 1  ON 42
ci_44                -1.765363e-03 3 1  ON 43
ci_45                -6.990072e-04 3 1  ON 44
ci_46                -5.566876e-04 3 1  ON 45
ci_47                 1.258215e-03 3 1  ON 46
ci_48                 7.548457e-04 3 1  ON 47
ci_49                -9.429507e-04 3 1  ON 48
ci_50                -7.219605e-04 3 1  ON 49
ci_51                 3.969828e-04 3 1  ON 50
ci_52                 4.165313e-04 3 1  ON 51
ci_53                -6.141303e-04 3 1  ON 52
ci_54                -8.929986e-04 3 1  ON 53
ci_55                -6.974710e-04 3 1  ON 54
ci_56                 1.909136e-03 3 1  ON 55
ci_57                 1.717168e-03 3 1  ON 56
ci_58                -7.641627e-04 3 1  ON 57
ci_59                -9.925753e-04 3 1  ON 58
ci_60                 5.465224e-04 3 1  ON 59
ci_61                 6.364972e-04 3 1  ON 60
ci_62                -2.985807e-04 3 1  ON 61
ci_63                -5.643352e-04 3 1  ON 62
ci_64                -4.646413e-04 3 1  ON 63
ci_65                -2.804237e-04 3 1  ON 64
ci_66                -7.285401e-04 3 1  ON 65
ci_67                -5.700360e-04 3 1  ON 66
ci_68                -6.760756e-04 3 1  ON 67
ci_69                -6.217978e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8072
    reference variance = 0.425876
====================================================
  Execution time = 2.5193e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4736e-01
  Total weights = 1.9643e+06
  Execution time = 3.5024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435017351192
                                         uncertainty =       0.002225287220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435017351192
                                         uncertainty =       0.002225287220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466339503
  error estimate for blocks of size 2^( 2) =       0.000491559176
  error estimate for blocks of size 2^( 3) =       0.000515284841
  error estimate for blocks of size 2^( 4) =       0.000532628622
  error estimate for blocks of size 2^( 5) =       0.000544079324
  error estimate for blocks of size 2^( 6) =       0.000550112016
  error estimate for blocks of size 2^( 7) =       0.000554911432

      target function =      -0.747526823246
              le_mean =     -22.813784817305
             les_mean =     520.916144402468
             stat err =       0.000545432848
             autocorr =       1.367975022288
   target nu stat err =       0.000545432848
   target dn stat err =       0.002736642230
      target stat err =       0.002352246842
              std dev =       0.659503649923
             le_variance =       0.434945064262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435011920827
                                         uncertainty =       0.002225194551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435011920827
                                         uncertainty =       0.002225194551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466336594
  error estimate for blocks of size 2^( 2) =       0.000491557583
  error estimate for blocks of size 2^( 3) =       0.000515284455
  error estimate for blocks of size 2^( 4) =       0.000532629291
  error estimate for blocks of size 2^( 5) =       0.000544080338
  error estimate for blocks of size 2^( 6) =       0.000550113070
  error estimate for blocks of size 2^( 7) =       0.000554913491

      target function =      -0.747545730625
              le_mean =     -22.813784966665
             les_mean =     520.916128454494
             stat err =       0.000545434047
             autocorr =       1.367998105408
   target nu stat err =       0.000545434047
   target dn stat err =       0.002736417999
      target stat err =       0.002352182797
              std dev =       0.659499535476
             le_variance =       0.434939637294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435014620129
                                         uncertainty =       0.002225240685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435014620129
                                         uncertainty =       0.002225240685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466338040
  error estimate for blocks of size 2^( 2) =       0.000491558373
  error estimate for blocks of size 2^( 3) =       0.000515284644
  error estimate for blocks of size 2^( 4) =       0.000532628954
  error estimate for blocks of size 2^( 5) =       0.000544079830
  error estimate for blocks of size 2^( 6) =       0.000550112543
  error estimate for blocks of size 2^( 7) =       0.000554912463

      target function =      -0.747537778024
              le_mean =     -22.813784890955
             les_mean =     520.916134574002
             stat err =       0.000545433447
             autocorr =       1.367986612207
   target nu stat err =       0.000545433447
   target dn stat err =       0.002736517134
      target stat err =       0.002352213534
              std dev =       0.659501580674
             le_variance =       0.434942334912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435017008751
                                         uncertainty =       0.002225281388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435017008751
                                         uncertainty =       0.002225281388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466339320
  error estimate for blocks of size 2^( 2) =       0.000491559075
  error estimate for blocks of size 2^( 3) =       0.000515284816
  error estimate for blocks of size 2^( 4) =       0.000532628663
  error estimate for blocks of size 2^( 5) =       0.000544079387
  error estimate for blocks of size 2^( 6) =       0.000550112081
  error estimate for blocks of size 2^( 7) =       0.000554911561

      target function =      -0.747528449601
              le_mean =     -22.813784826369
             les_mean =     520.916142857960
             stat err =       0.000545432923
             autocorr =       1.367976473575
   target nu stat err =       0.000545432923
   target dn stat err =       0.002736624422
      target stat err =       0.002352242500
              std dev =       0.659503390466
             le_variance =       0.434944722037


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747526823246        initial
     9.5367e+00     9.5367e+01             2.4592e-05        -0.747545730625  <--
     3.8147e+01     3.8147e+02             6.1614e-06        -0.747537778024
     1.5259e+02     1.5259e+03             1.5412e-06        -0.747528449601

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 4.2793e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_01                 1.315825e-01 3 1  ON 0
ci_02                -3.152044e-02 3 1  ON 1
ci_03                -3.120359e-02 3 1  ON 2
ci_04                 2.810413e-02 3 1  ON 3
ci_05                -2.334108e-02 3 1  ON 4
ci_06                -2.302341e-02 3 1  ON 5
ci_07                 2.695498e-02 3 1  ON 6
ci_08                -6.507433e-03 3 1  ON 7
ci_09                -9.361383e-03 3 1  ON 8
ci_10                -9.355873e-03 3 1  ON 9
ci_11                 1.305383e-02 3 1  ON 10
ci_12                 7.742765e-03 3 1  ON 11
ci_13                 1.266778e-02 3 1  ON 12
ci_14                 1.307587e-02 3 1  ON 13
ci_15                 7.165822e-03 3 1  ON 14
ci_16                 7.412454e-03 3 1  ON 15
ci_17                -7.631254e-03 3 1  ON 16
ci_18                -7.257099e-03 3 1  ON 17
ci_19                 9.361402e-03 3 1  ON 18
ci_20                 6.831022e-03 3 1  ON 19
ci_21                 8.754646e-03 3 1  ON 20
ci_22                 8.794618e-03 3 1  ON 21
ci_23                 4.945828e-03 3 1  ON 22
ci_24                 4.394989e-03 3 1  ON 23
ci_25                 3.169163e-03 3 1  ON 24
ci_26                 3.198566e-03 3 1  ON 25
ci_27                 3.324258e-03 3 1  ON 26
ci_28                 2.454343e-03 3 1  ON 27
ci_29                 2.091509e-03 3 1  ON 28
ci_30                -1.668819e-03 3 1  ON 29
ci_31                -1.622626e-03 3 1  ON 30
ci_32                -1.382845e-03 3 1  ON 31
ci_33                -1.062947e-03 3 1  ON 32
ci_34                 1.514243e-03 3 1  ON 33
ci_35                 1.312002e-03 3 1  ON 34
ci_36                -1.196028e-03 3 1  ON 35
ci_37                -1.158245e-03 3 1  ON 36
ci_38                -5.256014e-04 3 1  ON 37
ci_39                -6.853640e-04 3 1  ON 38
ci_40                -1.665423e-03 3 1  ON 39
ci_41                -1.450687e-03 3 1  ON 40
ci_42                -1.179730e-03 3 1  ON 41
ci_43                -2.859351e-03 3 1  ON 42
ci_44                -1.764359e-03 3 1  ON 43
ci_45                -6.969402e-04 3 1  ON 44
ci_46                -5.528037e-04 3 1  ON 45
ci_47                 1.261514e-03 3 1  ON 46
ci_48                 7.599676e-04 3 1  ON 47
ci_49                -9.447392e-04 3 1  ON 48
ci_50                -7.215321e-04 3 1  ON 49
ci_51                 3.918415e-04 3 1  ON 50
ci_52                 4.156188e-04 3 1  ON 51
ci_53                -6.162616e-04 3 1  ON 52
ci_54                -8.990820e-04 3 1  ON 53
ci_55                -7.011809e-04 3 1  ON 54
ci_56                 1.909564e-03 3 1  ON 55
ci_57                 1.716517e-03 3 1  ON 56
ci_58                -7.693205e-04 3 1  ON 57
ci_59                -9.913757e-04 3 1  ON 58
ci_60                 5.514849e-04 3 1  ON 59
ci_61                 6.371732e-04 3 1  ON 60
ci_62                -3.027549e-04 3 1  ON 61
ci_63                -5.676509e-04 3 1  ON 62
ci_64                -4.624467e-04 3 1  ON 63
ci_65                -2.805771e-04 3 1  ON 64
ci_66                -7.271704e-04 3 1  ON 65
ci_67                -5.712244e-04 3 1  ON 66
ci_68                -6.735250e-04 3 1  ON 67
ci_69                -6.567054e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3231e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.7063
    reference variance = 0.453305
====================================================
  Execution time = 2.7920e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4875e-01
  Total weights = 1.964095902e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5197e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434006268660
                                         uncertainty =       0.001965931679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434006268660
                                         uncertainty =       0.001965931679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465820545
  error estimate for blocks of size 2^( 2) =       0.000491140608
  error estimate for blocks of size 2^( 3) =       0.000514670761
  error estimate for blocks of size 2^( 4) =       0.000531770432
  error estimate for blocks of size 2^( 5) =       0.000544124657
  error estimate for blocks of size 2^( 6) =       0.000551760214
  error estimate for blocks of size 2^( 7) =       0.000553587967

      target function =      -0.746384225645
              le_mean =     -22.815197747117
             les_mean =     520.981996223301
             stat err =       0.000545310818
             autocorr =       1.370411356109
   target nu stat err =       0.000545310818
   target dn stat err =       0.003175517586
      target stat err =       0.002703666943
              std dev =       0.658769731794
             le_variance =       0.433977559527


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281519774712e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746393098670       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746401145239       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746402504654       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746402607166       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746402694751       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746402707377       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746402708121       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746402709159       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746402708562       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+00 is 1.243621e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746393098670       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746395142326       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746395485380       residual = 8.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746395510772       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746395532529       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746395535568       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746395535739       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746395535995       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746395535845       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+00 is 3.135822e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746393098670       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746393611625       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746393697590       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746393703922       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746393709353       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746393710105       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746393710147       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746393710211       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746393710173       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+01 is 7.856486e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270246 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2449e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_01                 1.315511e-01 3 1  ON 0
ci_02                -3.150762e-02 3 1  ON 1
ci_03                -3.118851e-02 3 1  ON 2
ci_04                 2.809152e-02 3 1  ON 3
ci_05                -2.331674e-02 3 1  ON 4
ci_06                -2.300878e-02 3 1  ON 5
ci_07                 2.695487e-02 3 1  ON 6
ci_08                -6.496240e-03 3 1  ON 7
ci_09                -9.354050e-03 3 1  ON 8
ci_10                -9.352786e-03 3 1  ON 9
ci_11                 1.305501e-02 3 1  ON 10
ci_12                 7.733836e-03 3 1  ON 11
ci_13                 1.267076e-02 3 1  ON 12
ci_14                 1.308220e-02 3 1  ON 13
ci_15                 7.161788e-03 3 1  ON 14
ci_16                 7.412791e-03 3 1  ON 15
ci_17                -7.624669e-03 3 1  ON 16
ci_18                -7.246691e-03 3 1  ON 17
ci_19                 9.359971e-03 3 1  ON 18
ci_20                 6.828619e-03 3 1  ON 19
ci_21                 8.756585e-03 3 1  ON 20
ci_22                 8.797799e-03 3 1  ON 21
ci_23                 4.944708e-03 3 1  ON 22
ci_24                 4.395008e-03 3 1  ON 23
ci_25                 3.168456e-03 3 1  ON 24
ci_26                 3.195548e-03 3 1  ON 25
ci_27                 3.320221e-03 3 1  ON 26
ci_28                 2.451498e-03 3 1  ON 27
ci_29                 2.092854e-03 3 1  ON 28
ci_30                -1.665160e-03 3 1  ON 29
ci_31                -1.624720e-03 3 1  ON 30
ci_32                -1.381047e-03 3 1  ON 31
ci_33                -1.056352e-03 3 1  ON 32
ci_34                 1.515146e-03 3 1  ON 33
ci_35                 1.314469e-03 3 1  ON 34
ci_36                -1.191991e-03 3 1  ON 35
ci_37                -1.151663e-03 3 1  ON 36
ci_38                -5.204801e-04 3 1  ON 37
ci_39                -6.842720e-04 3 1  ON 38
ci_40                -1.666575e-03 3 1  ON 39
ci_41                -1.446684e-03 3 1  ON 40
ci_42                -1.176539e-03 3 1  ON 41
ci_43                -2.859590e-03 3 1  ON 42
ci_44                -1.762544e-03 3 1  ON 43
ci_45                -6.986109e-04 3 1  ON 44
ci_46                -5.559494e-04 3 1  ON 45
ci_47                 1.259832e-03 3 1  ON 46
ci_48                 7.597731e-04 3 1  ON 47
ci_49                -9.390676e-04 3 1  ON 48
ci_50                -7.249365e-04 3 1  ON 49
ci_51                 3.937768e-04 3 1  ON 50
ci_52                 4.221958e-04 3 1  ON 51
ci_53                -6.209072e-04 3 1  ON 52
ci_54                -8.996320e-04 3 1  ON 53
ci_55                -7.021756e-04 3 1  ON 54
ci_56                 1.906769e-03 3 1  ON 55
ci_57                 1.718887e-03 3 1  ON 56
ci_58                -7.732321e-04 3 1  ON 57
ci_59                -9.844627e-04 3 1  ON 58
ci_60                 5.543570e-04 3 1  ON 59
ci_61                 6.294377e-04 3 1  ON 60
ci_62                -3.018052e-04 3 1  ON 61
ci_63                -5.637393e-04 3 1  ON 62
ci_64                -4.618836e-04 3 1  ON 63
ci_65                -2.851721e-04 3 1  ON 64
ci_66                -7.253217e-04 3 1  ON 65
ci_67                -5.707137e-04 3 1  ON 66
ci_68                -6.723997e-04 3 1  ON 67
ci_69                -7.446616e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8667
    reference variance = 0.80474
====================================================
  Execution time = 2.5418e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.5150e-01
  Total weights = 1.9641e+06
  Execution time = 3.5152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435353260780
                                         uncertainty =       0.002523330309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435353260780
                                         uncertainty =       0.002523330309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466581885
  error estimate for blocks of size 2^( 2) =       0.000491587599
  error estimate for blocks of size 2^( 3) =       0.000515699248
  error estimate for blocks of size 2^( 4) =       0.000533930964
  error estimate for blocks of size 2^( 5) =       0.000546671431
  error estimate for blocks of size 2^( 6) =       0.000554759096
  error estimate for blocks of size 2^( 7) =       0.000559173413

      target function =      -0.744076002048
              le_mean =     -22.813482832247
             les_mean =     520.906516246345
             stat err =       0.000548633726
             autocorr =       1.382640441576
   target nu stat err =       0.000548633726
   target dn stat err =       0.005322194611
      target stat err =       0.004419453998
              std dev =       0.659846430127
             le_variance =       0.435397311351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435333227151
                                         uncertainty =       0.002522580288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435333227151
                                         uncertainty =       0.002522580288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466571136
  error estimate for blocks of size 2^( 2) =       0.000491581371
  error estimate for blocks of size 2^( 3) =       0.000515698838
  error estimate for blocks of size 2^( 4) =       0.000533933696
  error estimate for blocks of size 2^( 5) =       0.000546675706
  error estimate for blocks of size 2^( 6) =       0.000554763499
  error estimate for blocks of size 2^( 7) =       0.000559179342

      target function =      -0.744094479860
              le_mean =     -22.813481759647
             les_mean =     520.906444949758
             stat err =       0.000548638061
             autocorr =       1.382726003502
   target nu stat err =       0.000548638061
   target dn stat err =       0.005312770670
      target stat err =       0.004411986168
              std dev =       0.659831227836
             le_variance =       0.435377249227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435343020804
                                         uncertainty =       0.002522943147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435343020804
                                         uncertainty =       0.002522943147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466576391
  error estimate for blocks of size 2^( 2) =       0.000491584396
  error estimate for blocks of size 2^( 3) =       0.000515698994
  error estimate for blocks of size 2^( 4) =       0.000533932300
  error estimate for blocks of size 2^( 5) =       0.000546673544
  error estimate for blocks of size 2^( 6) =       0.000554761281
  error estimate for blocks of size 2^( 7) =       0.000559176373

      target function =      -0.744092098242
              le_mean =     -22.813482268346
             les_mean =     520.906470999168
             stat err =       0.000548635874
             autocorr =       1.382683834642
   target nu stat err =       0.000548635874
   target dn stat err =       0.005317663490
      target stat err =       0.004415947943
              std dev =       0.659838659781
             le_variance =       0.435387056941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435351964224
                                         uncertainty =       0.002523281143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435351964224
                                         uncertainty =       0.002523281143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466581190
  error estimate for blocks of size 2^( 2) =       0.000491587190
  error estimate for blocks of size 2^( 3) =       0.000515699209
  error estimate for blocks of size 2^( 4) =       0.000533931123
  error estimate for blocks of size 2^( 5) =       0.000546671688
  error estimate for blocks of size 2^( 6) =       0.000554759362
  error estimate for blocks of size 2^( 7) =       0.000559173775

      target function =      -0.744083067469
              le_mean =     -22.813482759588
             les_mean =     520.906504347305
             stat err =       0.000548633987
             autocorr =       1.382645880858
   target nu stat err =       0.000548633987
   target dn stat err =       0.005321615452
      target stat err =       0.004419064795
              std dev =       0.659845446291
             le_variance =       0.435396012991


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744076002048        initial
     2.3842e+00     2.3842e+01             1.2436e-04        -0.744094479860  <--
     9.5367e+00     9.5367e+01             3.1358e-05        -0.744092098242
     3.8147e+01     3.8147e+02             7.8565e-06        -0.744083067469

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 4.3102e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_01                 1.314581e-01 3 1  ON 0
ci_02                -3.146994e-02 3 1  ON 1
ci_03                -3.114415e-02 3 1  ON 2
ci_04                 2.805451e-02 3 1  ON 3
ci_05                -2.324506e-02 3 1  ON 4
ci_06                -2.296570e-02 3 1  ON 5
ci_07                 2.695455e-02 3 1  ON 6
ci_08                -6.463349e-03 3 1  ON 7
ci_09                -9.332396e-03 3 1  ON 8
ci_10                -9.343651e-03 3 1  ON 9
ci_11                 1.305854e-02 3 1  ON 10
ci_12                 7.707596e-03 3 1  ON 11
ci_13                 1.267961e-02 3 1  ON 12
ci_14                 1.310104e-02 3 1  ON 13
ci_15                 7.149914e-03 3 1  ON 14
ci_16                 7.413790e-03 3 1  ON 15
ci_17                -7.605215e-03 3 1  ON 16
ci_18                -7.216003e-03 3 1  ON 17
ci_19                 9.355781e-03 3 1  ON 18
ci_20                 6.821550e-03 3 1  ON 19
ci_21                 8.762306e-03 3 1  ON 20
ci_22                 8.807222e-03 3 1  ON 21
ci_23                 4.941424e-03 3 1  ON 22
ci_24                 4.395049e-03 3 1  ON 23
ci_25                 3.166378e-03 3 1  ON 24
ci_26                 3.186661e-03 3 1  ON 25
ci_27                 3.308334e-03 3 1  ON 26
ci_28                 2.443082e-03 3 1  ON 27
ci_29                 2.096793e-03 3 1  ON 28
ci_30                -1.654319e-03 3 1  ON 29
ci_31                -1.630918e-03 3 1  ON 30
ci_32                -1.375791e-03 3 1  ON 31
ci_33                -1.036998e-03 3 1  ON 32
ci_34                 1.517828e-03 3 1  ON 33
ci_35                 1.321761e-03 3 1  ON 34
ci_36                -1.180130e-03 3 1  ON 35
ci_37                -1.132329e-03 3 1  ON 36
ci_38                -5.054210e-04 3 1  ON 37
ci_39                -6.810580e-04 3 1  ON 38
ci_40                -1.669935e-03 3 1  ON 39
ci_41                -1.434939e-03 3 1  ON 40
ci_42                -1.167173e-03 3 1  ON 41
ci_43                -2.860253e-03 3 1  ON 42
ci_44                -1.757185e-03 3 1  ON 43
ci_45                -7.035225e-04 3 1  ON 44
ci_46                -5.651881e-04 3 1  ON 45
ci_47                 1.254846e-03 3 1  ON 46
ci_48                 7.592159e-04 3 1  ON 47
ci_49                -9.224003e-04 3 1  ON 48
ci_50                -7.349147e-04 3 1  ON 49
ci_51                 3.994507e-04 3 1  ON 50
ci_52                 4.415101e-04 3 1  ON 51
ci_53                -6.345162e-04 3 1  ON 52
ci_54                -9.012571e-04 3 1  ON 53
ci_55                -7.051125e-04 3 1  ON 54
ci_56                 1.898568e-03 3 1  ON 55
ci_57                 1.725849e-03 3 1  ON 56
ci_58                -7.847498e-04 3 1  ON 57
ci_59                -9.641205e-04 3 1  ON 58
ci_60                 5.628987e-04 3 1  ON 59
ci_61                 6.064310e-04 3 1  ON 60
ci_62                -2.990168e-04 3 1  ON 61
ci_63                -5.522566e-04 3 1  ON 62
ci_64                -4.602296e-04 3 1  ON 63
ci_65                -2.986828e-04 3 1  ON 64
ci_66                -7.198851e-04 3 1  ON 65
ci_67                -5.692035e-04 3 1  ON 66
ci_68                -6.690867e-04 3 1  ON 67
ci_69                -1.003413e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5557e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8257
    reference variance = 0.341215
====================================================
  Execution time = 2.5990e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5234e-01
  Total weights = 1.964450848e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5329e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437195518390
                                         uncertainty =       0.002276589887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437195518390
                                         uncertainty =       0.002276589887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467507002
  error estimate for blocks of size 2^( 2) =       0.000492432026
  error estimate for blocks of size 2^( 3) =       0.000516469766
  error estimate for blocks of size 2^( 4) =       0.000534004345
  error estimate for blocks of size 2^( 5) =       0.000545529501
  error estimate for blocks of size 2^( 6) =       0.000552785411
  error estimate for blocks of size 2^( 7) =       0.000556025321

      target function =      -0.743404200646
              le_mean =     -22.814567529095
             les_mean =     520.956834036705
             stat err =       0.000547086145
             autocorr =       1.369415351031
   target nu stat err =       0.000547086145
   target dn stat err =       0.004663874830
      target stat err =       0.003882835614
              std dev =       0.661154743247
             le_variance =       0.437125594518


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281456752910e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743423311256       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743473446988       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743480021813       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743480776591       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743480743380       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743480896254       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743480962784       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743480976459       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743480993756       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743480996321       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-01 is 4.216807e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743423311256       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743436593720       residual = 4.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743438296228       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743438484787       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743438473761       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743438511675       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743438527735       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743438530961       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743438534993       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743438535535       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+00 is 1.111491e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743423311256       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743426682196       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743427111609       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743427158702       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743427155765       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743427165221       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743427169196       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743427169990       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743427170979       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743427171108       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+00 is 2.816993e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273760 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0532e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_01                 1.313684e-01 3 1  ON 0
ci_02                -3.137376e-02 3 1  ON 1
ci_03                -3.103300e-02 3 1  ON 2
ci_04                 2.797949e-02 3 1  ON 3
ci_05                -2.321609e-02 3 1  ON 4
ci_06                -2.293831e-02 3 1  ON 5
ci_07                 2.694304e-02 3 1  ON 6
ci_08                -6.436223e-03 3 1  ON 7
ci_09                -9.323129e-03 3 1  ON 8
ci_10                -9.278269e-03 3 1  ON 9
ci_11                 1.307576e-02 3 1  ON 10
ci_12                 7.677470e-03 3 1  ON 11
ci_13                 1.266450e-02 3 1  ON 12
ci_14                 1.306555e-02 3 1  ON 13
ci_15                 7.105657e-03 3 1  ON 14
ci_16                 7.397943e-03 3 1  ON 15
ci_17                -7.557436e-03 3 1  ON 16
ci_18                -7.201291e-03 3 1  ON 17
ci_19                 9.344743e-03 3 1  ON 18
ci_20                 6.807567e-03 3 1  ON 19
ci_21                 8.746253e-03 3 1  ON 20
ci_22                 8.793364e-03 3 1  ON 21
ci_23                 4.932082e-03 3 1  ON 22
ci_24                 4.441308e-03 3 1  ON 23
ci_25                 3.154393e-03 3 1  ON 24
ci_26                 3.178841e-03 3 1  ON 25
ci_27                 3.354928e-03 3 1  ON 26
ci_28                 2.418851e-03 3 1  ON 27
ci_29                 2.093887e-03 3 1  ON 28
ci_30                -1.641826e-03 3 1  ON 29
ci_31                -1.632648e-03 3 1  ON 30
ci_32                -1.369989e-03 3 1  ON 31
ci_33                -1.032674e-03 3 1  ON 32
ci_34                 1.551412e-03 3 1  ON 33
ci_35                 1.288760e-03 3 1  ON 34
ci_36                -1.169436e-03 3 1  ON 35
ci_37                -1.144540e-03 3 1  ON 36
ci_38                -5.135681e-04 3 1  ON 37
ci_39                -6.770164e-04 3 1  ON 38
ci_40                -1.669250e-03 3 1  ON 39
ci_41                -1.432695e-03 3 1  ON 40
ci_42                -1.164483e-03 3 1  ON 41
ci_43                -2.794091e-03 3 1  ON 42
ci_44                -1.769257e-03 3 1  ON 43
ci_45                -6.932837e-04 3 1  ON 44
ci_46                -5.651332e-04 3 1  ON 45
ci_47                 1.244193e-03 3 1  ON 46
ci_48                 7.720431e-04 3 1  ON 47
ci_49                -9.540553e-04 3 1  ON 48
ci_50                -7.425220e-04 3 1  ON 49
ci_51                 4.034383e-04 3 1  ON 50
ci_52                 4.333907e-04 3 1  ON 51
ci_53                -6.214655e-04 3 1  ON 52
ci_54                -9.157699e-04 3 1  ON 53
ci_55                -7.224096e-04 3 1  ON 54
ci_56                 1.904589e-03 3 1  ON 55
ci_57                 1.737866e-03 3 1  ON 56
ci_58                -7.790652e-04 3 1  ON 57
ci_59                -9.363935e-04 3 1  ON 58
ci_60                 5.773255e-04 3 1  ON 59
ci_61                 6.203874e-04 3 1  ON 60
ci_62                -2.916752e-04 3 1  ON 61
ci_63                -5.456135e-04 3 1  ON 62
ci_64                -4.624342e-04 3 1  ON 63
ci_65                -2.874741e-04 3 1  ON 64
ci_66                -7.377069e-04 3 1  ON 65
ci_67                -5.896060e-04 3 1  ON 66
ci_68                -6.754247e-04 3 1  ON 67
ci_69                -1.414775e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.7781
    reference variance = 0.309455
====================================================
  Execution time = 2.5107e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4533e-01
  Total weights = 1.9648e+06
  Execution time = 3.5071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433462636235
                                         uncertainty =       0.001852025762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433462636235
                                         uncertainty =       0.001852025762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465532312
  error estimate for blocks of size 2^( 2) =       0.000490748299
  error estimate for blocks of size 2^( 3) =       0.000514594698
  error estimate for blocks of size 2^( 4) =       0.000532192833
  error estimate for blocks of size 2^( 5) =       0.000543852944
  error estimate for blocks of size 2^( 6) =       0.000551649328
  error estimate for blocks of size 2^( 7) =       0.000555567450

      target function =      -0.749211902608
              le_mean =     -22.814575231491
             les_mean =     520.950194101555
             stat err =       0.000545815639
             autocorr =       1.374650488298
   target nu stat err =       0.000545815639
   target dn stat err =       0.002598128181
      target stat err =       0.002253793668
              std dev =       0.658362108732
             le_variance =       0.433440666215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433379497133
                                         uncertainty =       0.001847744242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433379497133
                                         uncertainty =       0.001847744242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465487845
  error estimate for blocks of size 2^( 2) =       0.000490723378
  error estimate for blocks of size 2^( 3) =       0.000514590316
  error estimate for blocks of size 2^( 4) =       0.000532204531
  error estimate for blocks of size 2^( 5) =       0.000543866796
  error estimate for blocks of size 2^( 6) =       0.000551670003
  error estimate for blocks of size 2^( 7) =       0.000555580129

      target function =      -0.749113621429
              le_mean =     -22.814573638346
             les_mean =     520.950239037591
             stat err =       0.000545830365
             autocorr =       1.374987324468
   target nu stat err =       0.000545830365
   target dn stat err =       0.002604755322
      target stat err =       0.002258551938
              std dev =       0.658299222946
             le_variance =       0.433357866931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433416394890
                                         uncertainty =       0.001849696637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433416394890
                                         uncertainty =       0.001849696637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465507576
  error estimate for blocks of size 2^( 2) =       0.000490733823
  error estimate for blocks of size 2^( 3) =       0.000514591053
  error estimate for blocks of size 2^( 4) =       0.000532197697
  error estimate for blocks of size 2^( 5) =       0.000543858974
  error estimate for blocks of size 2^( 6) =       0.000551658739
  error estimate for blocks of size 2^( 7) =       0.000555572226

      target function =      -0.749194917158
              le_mean =     -22.814573929629
             les_mean =     520.950155009243
             stat err =       0.000545821909
             autocorr =       1.374828166957
   target nu stat err =       0.000545821909
   target dn stat err =       0.002600518779
      target stat err =       0.002255615328
              std dev =       0.658327127159
             le_variance =       0.433394606353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433456464945
                                         uncertainty =       0.001851720057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433456464945
                                         uncertainty =       0.001851720057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465529010
  error estimate for blocks of size 2^( 2) =       0.000490746295
  error estimate for blocks of size 2^( 3) =       0.000514594066
  error estimate for blocks of size 2^( 4) =       0.000532193278
  error estimate for blocks of size 2^( 5) =       0.000543853532
  error estimate for blocks of size 2^( 6) =       0.000551650372
  error estimate for blocks of size 2^( 7) =       0.000555567893

      target function =      -0.749219047415
              le_mean =     -22.814575016106
             les_mean =     520.950175716631
             stat err =       0.000545816269
             autocorr =       1.374673159653
   target nu stat err =       0.000545816269
   target dn stat err =       0.002598295596
      target stat err =       0.002253969202
              std dev =       0.658357439535
             le_variance =       0.433434518191


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749211902608        initial
     5.9605e-01     5.9605e+00             4.2168e-04        -0.749113621429
     2.3842e+00     2.3842e+01             1.1115e-04        -0.749194917158
     9.5367e+00     9.5367e+01             2.8170e-05        -0.749219047415  <--

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 4.2729e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_01                 1.314355e-01 3 1  ON 0
ci_02                -3.144556e-02 3 1  ON 1
ci_03                -3.111598e-02 3 1  ON 2
ci_04                 2.803546e-02 3 1  ON 3
ci_05                -2.323770e-02 3 1  ON 4
ci_06                -2.295873e-02 3 1  ON 5
ci_07                 2.695164e-02 3 1  ON 6
ci_08                -6.456468e-03 3 1  ON 7
ci_09                -9.330045e-03 3 1  ON 8
ci_10                -9.327088e-03 3 1  ON 9
ci_11                 1.306289e-02 3 1  ON 10
ci_12                 7.699949e-03 3 1  ON 11
ci_13                 1.267580e-02 3 1  ON 12
ci_14                 1.309210e-02 3 1  ON 13
ci_15                 7.138707e-03 3 1  ON 14
ci_16                 7.409767e-03 3 1  ON 15
ci_17                -7.593110e-03 3 1  ON 16
ci_18                -7.212278e-03 3 1  ON 17
ci_19                 9.352969e-03 3 1  ON 18
ci_20                 6.817997e-03 3 1  ON 19
ci_21                 8.758262e-03 3 1  ON 20
ci_22                 8.803720e-03 3 1  ON 21
ci_23                 4.939049e-03 3 1  ON 22
ci_24                 4.406718e-03 3 1  ON 23
ci_25                 3.163335e-03 3 1  ON 24
ci_26                 3.184669e-03 3 1  ON 25
ci_27                 3.320136e-03 3 1  ON 26
ci_28                 2.436949e-03 3 1  ON 27
ci_29                 2.096060e-03 3 1  ON 28
ci_30                -1.651170e-03 3 1  ON 29
ci_31                -1.631357e-03 3 1  ON 30
ci_32                -1.374317e-03 3 1  ON 31
ci_33                -1.035896e-03 3 1  ON 32
ci_34                 1.526337e-03 3 1  ON 33
ci_35                 1.313391e-03 3 1  ON 34
ci_36                -1.177416e-03 3 1  ON 35
ci_37                -1.135430e-03 3 1  ON 36
ci_38                -5.074894e-04 3 1  ON 37
ci_39                -6.800327e-04 3 1  ON 38
ci_40                -1.669760e-03 3 1  ON 39
ci_41                -1.434369e-03 3 1  ON 40
ci_42                -1.166485e-03 3 1  ON 41
ci_43                -2.843488e-03 3 1  ON 42
ci_44                -1.760251e-03 3 1  ON 43
ci_45                -7.009269e-04 3 1  ON 44
ci_46                -5.651747e-04 3 1  ON 45
ci_47                 1.252147e-03 3 1  ON 46
ci_48                 7.624523e-04 3 1  ON 47
ci_49                -9.304466e-04 3 1  ON 48
ci_50                -7.368525e-04 3 1  ON 49
ci_51                 4.004635e-04 3 1  ON 50
ci_52                 4.394531e-04 3 1  ON 51
ci_53                -6.311987e-04 3 1  ON 52
ci_54                -9.049432e-04 3 1  ON 53
ci_55                -7.095041e-04 3 1  ON 54
ci_56                 1.900098e-03 3 1  ON 55
ci_57                 1.728900e-03 3 1  ON 56
ci_58                -7.833052e-04 3 1  ON 57
ci_59                -9.570833e-04 3 1  ON 58
ci_60                 5.665366e-04 3 1  ON 59
ci_61                 6.099483e-04 3 1  ON 60
ci_62                -2.971523e-04 3 1  ON 61
ci_63                -5.505670e-04 3 1  ON 62
ci_64                -4.607917e-04 3 1  ON 63
ci_65                -2.958355e-04 3 1  ON 64
ci_66                -7.244112e-04 3 1  ON 65
ci_67                -5.743852e-04 3 1  ON 66
ci_68                -6.706993e-04 3 1  ON 67
ci_69                -1.107682e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.8317
    reference variance = 0.485779
====================================================
  Execution time = 2.5912e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5322e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4574e-01
  Total weights = 1.964182743e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433358630903
                                         uncertainty =       0.001879798925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433358630903
                                         uncertainty =       0.001879798925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465490103
  error estimate for blocks of size 2^( 2) =       0.000490480021
  error estimate for blocks of size 2^( 3) =       0.000514385209
  error estimate for blocks of size 2^( 4) =       0.000530719133
  error estimate for blocks of size 2^( 5) =       0.000541131789
  error estimate for blocks of size 2^( 6) =       0.000546581184
  error estimate for blocks of size 2^( 7) =       0.000547189373

      target function =      -0.748893720141
              le_mean =     -22.815211809352
             les_mean =     520.979628058906
             stat err =       0.000541405370
             autocorr =       1.352770779088
   target nu stat err =       0.000541405370
   target dn stat err =       0.002476843313
      target stat err =       0.002155324877
              std dev =       0.658302417274
             le_variance =       0.433362072588


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281521180935e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748898957091       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748908190928       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748909960552       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748910366924       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748910653740       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748910703832       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748910696381       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748910692190       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748910689194       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748910688458       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+00 is 1.242898e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748898957091       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748901302163       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748901748944       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748901850736       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748901922244       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748901934431       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748901932516       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748901931476       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748901930737       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748901930559       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+00 is 3.133965e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748898957091       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748899545693       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748899657664       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748899683124       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748899700987       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748899704013       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748899703531       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748899703271       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748899703087       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748899703043       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+01 is 7.851807e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277212 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0447e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_01                 1.314041e-01 3 1  ON 0
ci_02                -3.143232e-02 3 1  ON 1
ci_03                -3.110183e-02 3 1  ON 2
ci_04                 2.802462e-02 3 1  ON 3
ci_05                -2.322370e-02 3 1  ON 4
ci_06                -2.294161e-02 3 1  ON 5
ci_07                 2.695238e-02 3 1  ON 6
ci_08                -6.452531e-03 3 1  ON 7
ci_09                -9.319577e-03 3 1  ON 8
ci_10                -9.324130e-03 3 1  ON 9
ci_11                 1.306501e-02 3 1  ON 10
ci_12                 7.702323e-03 3 1  ON 11
ci_13                 1.266896e-02 3 1  ON 12
ci_14                 1.308879e-02 3 1  ON 13
ci_15                 7.138834e-03 3 1  ON 14
ci_16                 7.404448e-03 3 1  ON 15
ci_17                -7.585353e-03 3 1  ON 16
ci_18                -7.204441e-03 3 1  ON 17
ci_19                 9.352598e-03 3 1  ON 18
ci_20                 6.809344e-03 3 1  ON 19
ci_21                 8.750710e-03 3 1  ON 20
ci_22                 8.800391e-03 3 1  ON 21
ci_23                 4.940831e-03 3 1  ON 22
ci_24                 4.412068e-03 3 1  ON 23
ci_25                 3.159142e-03 3 1  ON 24
ci_26                 3.186077e-03 3 1  ON 25
ci_27                 3.321675e-03 3 1  ON 26
ci_28                 2.427410e-03 3 1  ON 27
ci_29                 2.098096e-03 3 1  ON 28
ci_30                -1.652343e-03 3 1  ON 29
ci_31                -1.633294e-03 3 1  ON 30
ci_32                -1.368690e-03 3 1  ON 31
ci_33                -1.038371e-03 3 1  ON 32
ci_34                 1.522596e-03 3 1  ON 33
ci_35                 1.310056e-03 3 1  ON 34
ci_36                -1.171936e-03 3 1  ON 35
ci_37                -1.127008e-03 3 1  ON 36
ci_38                -5.029009e-04 3 1  ON 37
ci_39                -6.789181e-04 3 1  ON 38
ci_40                -1.669269e-03 3 1  ON 39
ci_41                -1.427817e-03 3 1  ON 40
ci_42                -1.169368e-03 3 1  ON 41
ci_43                -2.828317e-03 3 1  ON 42
ci_44                -1.764308e-03 3 1  ON 43
ci_45                -7.013895e-04 3 1  ON 44
ci_46                -5.576327e-04 3 1  ON 45
ci_47                 1.248420e-03 3 1  ON 46
ci_48                 7.578468e-04 3 1  ON 47
ci_49                -9.299655e-04 3 1  ON 48
ci_50                -7.388220e-04 3 1  ON 49
ci_51                 4.008324e-04 3 1  ON 50
ci_52                 4.351384e-04 3 1  ON 51
ci_53                -6.338221e-04 3 1  ON 52
ci_54                -9.089598e-04 3 1  ON 53
ci_55                -7.065323e-04 3 1  ON 54
ci_56                 1.905844e-03 3 1  ON 55
ci_57                 1.734074e-03 3 1  ON 56
ci_58                -7.826896e-04 3 1  ON 57
ci_59                -9.624306e-04 3 1  ON 58
ci_60                 5.584014e-04 3 1  ON 59
ci_61                 6.227062e-04 3 1  ON 60
ci_62                -3.017954e-04 3 1  ON 61
ci_63                -5.534826e-04 3 1  ON 62
ci_64                -4.530272e-04 3 1  ON 63
ci_65                -3.016262e-04 3 1  ON 64
ci_66                -7.220421e-04 3 1  ON 65
ci_67                -5.773605e-04 3 1  ON 66
ci_68                -6.673360e-04 3 1  ON 67
ci_69                -1.183394e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.8599
    reference variance = 0.345184
====================================================
  Execution time = 2.5217e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6001e-01
  Total weights = 1.9642e+06
  Execution time = 3.4936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438012238218
                                         uncertainty =       0.004625875864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438012238218
                                         uncertainty =       0.004625875864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468026897
  error estimate for blocks of size 2^( 2) =       0.000493193076
  error estimate for blocks of size 2^( 3) =       0.000517346104
  error estimate for blocks of size 2^( 4) =       0.000534717030
  error estimate for blocks of size 2^( 5) =       0.000545428525
  error estimate for blocks of size 2^( 6) =       0.000551333248
  error estimate for blocks of size 2^( 7) =       0.000556920606

      target function =      -0.737223920445
              le_mean =     -22.815340058958
             les_mean =     520.999588010211
             stat err =       0.000547099852
             autocorr =       1.366443160210
   target nu stat err =       0.000547099852
   target dn stat err =       0.009013345445
      target stat err =       0.007323083887
              std dev =       0.661889984888
             le_variance =       0.438098352095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438453136463
                                         uncertainty =       0.005050460950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438453136463
                                         uncertainty =       0.005050460950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468261802
  error estimate for blocks of size 2^( 2) =       0.000493420012
  error estimate for blocks of size 2^( 3) =       0.000517567181
  error estimate for blocks of size 2^( 4) =       0.000534930436
  error estimate for blocks of size 2^( 5) =       0.000545635847
  error estimate for blocks of size 2^( 6) =       0.000551525020
  error estimate for blocks of size 2^( 7) =       0.000557106578

      target function =      -0.736364137363
              le_mean =     -22.815337281427
             les_mean =     521.000508962907
             stat err =       0.000547299470
             autocorr =       1.366068859282
   target nu stat err =       0.000547299470
   target dn stat err =       0.009774784619
      target stat err =       0.007919393795
              std dev =       0.662222191237
             le_variance =       0.438538230567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438226571659
                                         uncertainty =       0.004832064472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438226571659
                                         uncertainty =       0.004832064472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468141107
  error estimate for blocks of size 2^( 2) =       0.000493303474
  error estimate for blocks of size 2^( 3) =       0.000517453733
  error estimate for blocks of size 2^( 4) =       0.000534820953
  error estimate for blocks of size 2^( 5) =       0.000545529461
  error estimate for blocks of size 2^( 6) =       0.000551426561
  error estimate for blocks of size 2^( 7) =       0.000557010998

      target function =      -0.736930029934
              le_mean =     -22.815338647829
             les_mean =     520.999879425259
             stat err =       0.000547196993
             autocorr =       1.366261559875
   target nu stat err =       0.000547196993
   target dn stat err =       0.009380775956
      target stat err =       0.007613638170
              std dev =       0.662051502477
             le_variance =       0.438312191932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438038191032
                                         uncertainty =       0.004650818834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438038191032
                                         uncertainty =       0.004650818834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468040728
  error estimate for blocks of size 2^( 2) =       0.000493206452
  error estimate for blocks of size 2^( 3) =       0.000517359153
  error estimate for blocks of size 2^( 4) =       0.000534729632
  error estimate for blocks of size 2^( 5) =       0.000545440765
  error estimate for blocks of size 2^( 6) =       0.000551344560
  error estimate for blocks of size 2^( 7) =       0.000556931556

      target function =      -0.737192938673
              le_mean =     -22.815339881198
             les_mean =     520.999617295926
             stat err =       0.000547111628
             autocorr =       1.366421223902
   target nu stat err =       0.000547111628
   target dn stat err =       0.009057750702
      target stat err =       0.007358309236
              std dev =       0.661909544717
             le_variance =       0.438124245387


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.737223920445        initial  <--
     2.3842e+00     2.3842e+01             1.2429e-04        -0.736364137363
     9.5367e+00     9.5367e+01             3.1340e-05        -0.736930029934
     3.8147e+01     3.8147e+02             7.8518e-06        -0.737192938673

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7794
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_01                 1.314355e-01 3 1  ON 0
ci_02                -3.144556e-02 3 1  ON 1
ci_03                -3.111598e-02 3 1  ON 2
ci_04                 2.803546e-02 3 1  ON 3
ci_05                -2.323770e-02 3 1  ON 4
ci_06                -2.295873e-02 3 1  ON 5
ci_07                 2.695164e-02 3 1  ON 6
ci_08                -6.456468e-03 3 1  ON 7
ci_09                -9.330045e-03 3 1  ON 8
ci_10                -9.327088e-03 3 1  ON 9
ci_11                 1.306289e-02 3 1  ON 10
ci_12                 7.699949e-03 3 1  ON 11
ci_13                 1.267580e-02 3 1  ON 12
ci_14                 1.309210e-02 3 1  ON 13
ci_15                 7.138707e-03 3 1  ON 14
ci_16                 7.409767e-03 3 1  ON 15
ci_17                -7.593110e-03 3 1  ON 16
ci_18                -7.212278e-03 3 1  ON 17
ci_19                 9.352969e-03 3 1  ON 18
ci_20                 6.817997e-03 3 1  ON 19
ci_21                 8.758262e-03 3 1  ON 20
ci_22                 8.803720e-03 3 1  ON 21
ci_23                 4.939049e-03 3 1  ON 22
ci_24                 4.406718e-03 3 1  ON 23
ci_25                 3.163335e-03 3 1  ON 24
ci_26                 3.184669e-03 3 1  ON 25
ci_27                 3.320136e-03 3 1  ON 26
ci_28                 2.436949e-03 3 1  ON 27
ci_29                 2.096060e-03 3 1  ON 28
ci_30                -1.651170e-03 3 1  ON 29
ci_31                -1.631357e-03 3 1  ON 30
ci_32                -1.374317e-03 3 1  ON 31
ci_33                -1.035896e-03 3 1  ON 32
ci_34                 1.526337e-03 3 1  ON 33
ci_35                 1.313391e-03 3 1  ON 34
ci_36                -1.177416e-03 3 1  ON 35
ci_37                -1.135430e-03 3 1  ON 36
ci_38                -5.074894e-04 3 1  ON 37
ci_39                -6.800327e-04 3 1  ON 38
ci_40                -1.669760e-03 3 1  ON 39
ci_41                -1.434369e-03 3 1  ON 40
ci_42                -1.166485e-03 3 1  ON 41
ci_43                -2.843488e-03 3 1  ON 42
ci_44                -1.760251e-03 3 1  ON 43
ci_45                -7.009269e-04 3 1  ON 44
ci_46                -5.651747e-04 3 1  ON 45
ci_47                 1.252147e-03 3 1  ON 46
ci_48                 7.624523e-04 3 1  ON 47
ci_49                -9.304466e-04 3 1  ON 48
ci_50                -7.368525e-04 3 1  ON 49
ci_51                 4.004635e-04 3 1  ON 50
ci_52                 4.394531e-04 3 1  ON 51
ci_53                -6.311987e-04 3 1  ON 52
ci_54                -9.049432e-04 3 1  ON 53
ci_55                -7.095041e-04 3 1  ON 54
ci_56                 1.900098e-03 3 1  ON 55
ci_57                 1.728900e-03 3 1  ON 56
ci_58                -7.833052e-04 3 1  ON 57
ci_59                -9.570833e-04 3 1  ON 58
ci_60                 5.665366e-04 3 1  ON 59
ci_61                 6.099483e-04 3 1  ON 60
ci_62                -2.971523e-04 3 1  ON 61
ci_63                -5.505670e-04 3 1  ON 62
ci_64                -4.607917e-04 3 1  ON 63
ci_65                -2.958355e-04 3 1  ON 64
ci_66                -7.244112e-04 3 1  ON 65
ci_67                -5.743852e-04 3 1  ON 66
ci_68                -6.706993e-04 3 1  ON 67
ci_69                -1.107682e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3231e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.8891
    reference variance = 0.33014
====================================================
  Execution time = 2.5960e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.7772e-01
  Total weights = 1.964390234e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441157506328
                                         uncertainty =       0.007510682842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441157506328
                                         uncertainty =       0.007510682842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469667627
  error estimate for blocks of size 2^( 2) =       0.000494778880
  error estimate for blocks of size 2^( 3) =       0.000518202745
  error estimate for blocks of size 2^( 4) =       0.000534948183
  error estimate for blocks of size 2^( 5) =       0.000546600497
  error estimate for blocks of size 2^( 6) =       0.000551852771
  error estimate for blocks of size 2^( 7) =       0.000556796523

      target function =      -0.722307978165
              le_mean =     -22.814641660671
             les_mean =     520.985593732183
             stat err =       0.000547549494
             autocorr =       1.359144118398
   target nu stat err =       0.000547549494
   target dn stat err =       0.031159786729
      target stat err =       0.024227296813
              std dev =       0.664210328186
             le_variance =       0.441175360069


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281464166067e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.723121249349       residual = 6.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.723142662846       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.723143758687       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.723143872120       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.723143904389       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.723143913655       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.723143920275       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.723143922674       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.723143923611       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.723143924122       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.723143924091       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 5.617816e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.723121249349       residual = 6.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.723126611145       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.723126885399       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.723126913766       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.723126921827       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.723126924140       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.723126925794       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.723126926393       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.723126926627       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.723126926754       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.723126926746       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 1.406595e-05

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.723121249349       residual = 6.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.723122590325       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.723122658907       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.723122666000       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.723122668014       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.723122668592       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.723122669006       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.723122669155       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.723122669214       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.723122669246       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.723122669244       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 3.517829e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.281372 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0468e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_01                 1.314315e-01 3 1  ON 0
ci_02                -3.143149e-02 3 1  ON 1
ci_03                -3.111447e-02 3 1  ON 2
ci_04                 2.803463e-02 3 1  ON 3
ci_05                -2.323702e-02 3 1  ON 4
ci_06                -2.295924e-02 3 1  ON 5
ci_07                 2.695117e-02 3 1  ON 6
ci_08                -6.455833e-03 3 1  ON 7
ci_09                -9.331039e-03 3 1  ON 8
ci_10                -9.329297e-03 3 1  ON 9
ci_11                 1.306278e-02 3 1  ON 10
ci_12                 7.700371e-03 3 1  ON 11
ci_13                 1.267827e-02 3 1  ON 12
ci_14                 1.309331e-02 3 1  ON 13
ci_15                 7.137884e-03 3 1  ON 14
ci_16                 7.409505e-03 3 1  ON 15
ci_17                -7.591943e-03 3 1  ON 16
ci_18                -7.212473e-03 3 1  ON 17
ci_19                 9.353419e-03 3 1  ON 18
ci_20                 6.819848e-03 3 1  ON 19
ci_21                 8.758063e-03 3 1  ON 20
ci_22                 8.804571e-03 3 1  ON 21
ci_23                 4.938244e-03 3 1  ON 22
ci_24                 4.407186e-03 3 1  ON 23
ci_25                 3.163351e-03 3 1  ON 24
ci_26                 3.184659e-03 3 1  ON 25
ci_27                 3.319800e-03 3 1  ON 26
ci_28                 2.436689e-03 3 1  ON 27
ci_29                 2.095482e-03 3 1  ON 28
ci_30                -1.650515e-03 3 1  ON 29
ci_31                -1.632255e-03 3 1  ON 30
ci_32                -1.374700e-03 3 1  ON 31
ci_33                -1.036372e-03 3 1  ON 32
ci_34                 1.526116e-03 3 1  ON 33
ci_35                 1.302857e-03 3 1  ON 34
ci_36                -1.175621e-03 3 1  ON 35
ci_37                -1.134649e-03 3 1  ON 36
ci_38                -5.078781e-04 3 1  ON 37
ci_39                -6.797949e-04 3 1  ON 38
ci_40                -1.669532e-03 3 1  ON 39
ci_41                -1.431419e-03 3 1  ON 40
ci_42                -1.166362e-03 3 1  ON 41
ci_43                -2.842993e-03 3 1  ON 42
ci_44                -1.756832e-03 3 1  ON 43
ci_45                -7.004371e-04 3 1  ON 44
ci_46                -5.654403e-04 3 1  ON 45
ci_47                 1.252209e-03 3 1  ON 46
ci_48                 7.632059e-04 3 1  ON 47
ci_49                -9.305210e-04 3 1  ON 48
ci_50                -7.367690e-04 3 1  ON 49
ci_51                 4.007609e-04 3 1  ON 50
ci_52                 4.387021e-04 3 1  ON 51
ci_53                -6.313007e-04 3 1  ON 52
ci_54                -9.085946e-04 3 1  ON 53
ci_55                -7.099397e-04 3 1  ON 54
ci_56                 1.897688e-03 3 1  ON 55
ci_57                 1.729016e-03 3 1  ON 56
ci_58                -7.831363e-04 3 1  ON 57
ci_59                -9.574923e-04 3 1  ON 58
ci_60                 5.669000e-04 3 1  ON 59
ci_61                 6.096694e-04 3 1  ON 60
ci_62                -2.965497e-04 3 1  ON 61
ci_63                -5.505487e-04 3 1  ON 62
ci_64                -4.597350e-04 3 1  ON 63
ci_65                -2.961355e-04 3 1  ON 64
ci_66                -7.245372e-04 3 1  ON 65
ci_67                -5.793920e-04 3 1  ON 66
ci_68                -6.667261e-04 3 1  ON 67
ci_69                -1.109269e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.8827
    reference variance = 0.336423
====================================================
  Execution time = 2.5113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4857e-01
  Total weights = 1.9640e+06
  Execution time = 3.4920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434598823340
                                         uncertainty =       0.002114820820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434598823340
                                         uncertainty =       0.002114820820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466117027
  error estimate for blocks of size 2^( 2) =       0.000491634431
  error estimate for blocks of size 2^( 3) =       0.000515225510
  error estimate for blocks of size 2^( 4) =       0.000533403888
  error estimate for blocks of size 2^( 5) =       0.000544737224
  error estimate for blocks of size 2^( 6) =       0.000549228622
  error estimate for blocks of size 2^( 7) =       0.000554727051

      target function =      -0.746466222155
              le_mean =     -22.814546432018
             les_mean =     520.952172697545
             stat err =       0.000545524196
             autocorr =       1.369739877921
   target nu stat err =       0.000545524196
   target dn stat err =       0.003577879381
      target stat err =       0.003027716786
              std dev =       0.659189021882
             le_variance =       0.434530166569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434594570859
                                         uncertainty =       0.002114807429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434594570859
                                         uncertainty =       0.002114807429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466114757
  error estimate for blocks of size 2^( 2) =       0.000491633118
  error estimate for blocks of size 2^( 3) =       0.000515225382
  error estimate for blocks of size 2^( 4) =       0.000533404498
  error estimate for blocks of size 2^( 5) =       0.000544738018
  error estimate for blocks of size 2^( 6) =       0.000549230070
  error estimate for blocks of size 2^( 7) =       0.000554729353

      target function =      -0.746612539654
              le_mean =     -22.814546475991
             les_mean =     520.951998308978
             stat err =       0.000545525485
             autocorr =       1.369759692708
   target nu stat err =       0.000545525485
   target dn stat err =       0.003571594813
      target stat err =       0.003023773342
              std dev =       0.659185810921
             le_variance =       0.434525933320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434596674765
                                         uncertainty =       0.002114813729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434596674765
                                         uncertainty =       0.002114813729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466115880
  error estimate for blocks of size 2^( 2) =       0.000491633763
  error estimate for blocks of size 2^( 3) =       0.000515225439
  error estimate for blocks of size 2^( 4) =       0.000533404188
  error estimate for blocks of size 2^( 5) =       0.000544737618
  error estimate for blocks of size 2^( 6) =       0.000549229346
  error estimate for blocks of size 2^( 7) =       0.000554728201

      target function =      -0.746569497172
              le_mean =     -22.814546448793
             les_mean =     520.952048963771
             stat err =       0.000545524838
             autocorr =       1.369749844518
   target nu stat err =       0.000545524838
   target dn stat err =       0.003571848566
      target stat err =       0.003023637625
              std dev =       0.659187399484
             le_variance =       0.434528027638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434598552501
                                         uncertainty =       0.002114819891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434598552501
                                         uncertainty =       0.002114819891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466116883
  error estimate for blocks of size 2^( 2) =       0.000491634346
  error estimate for blocks of size 2^( 3) =       0.000515225500
  error estimate for blocks of size 2^( 4) =       0.000533403925
  error estimate for blocks of size 2^( 5) =       0.000544737273
  error estimate for blocks of size 2^( 6) =       0.000549228713
  error estimate for blocks of size 2^( 7) =       0.000554727195

      target function =      -0.746482607604
              le_mean =     -22.814546433530
             les_mean =     520.952153015986
             stat err =       0.000545524277
             autocorr =       1.369741131076
   target nu stat err =       0.000545524277
   target dn stat err =       0.003576341408
      target stat err =       0.003026597629
              std dev =       0.659188817364
             le_variance =       0.434529896938


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746466222155        initial
     2.3842e+01     2.3842e+02             5.6178e-05        -0.746612539654  <--
     9.5367e+01     9.5367e+02             1.4066e-05        -0.746569497172
     3.8147e+02     3.8147e+03             3.5178e-06        -0.746482607604

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 4.2592e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_01                 1.314195e-01 3 1  ON 0
ci_02                -3.138938e-02 3 1  ON 1
ci_03                -3.110997e-02 3 1  ON 2
ci_04                 2.803214e-02 3 1  ON 3
ci_05                -2.323501e-02 3 1  ON 4
ci_06                -2.296077e-02 3 1  ON 5
ci_07                 2.694977e-02 3 1  ON 6
ci_08                -6.453932e-03 3 1  ON 7
ci_09                -9.334015e-03 3 1  ON 8
ci_10                -9.335914e-03 3 1  ON 9
ci_11                 1.306246e-02 3 1  ON 10
ci_12                 7.701635e-03 3 1  ON 11
ci_13                 1.268566e-02 3 1  ON 12
ci_14                 1.309697e-02 3 1  ON 13
ci_15                 7.135421e-03 3 1  ON 14
ci_16                 7.408719e-03 3 1  ON 15
ci_17                -7.588450e-03 3 1  ON 16
ci_18                -7.213058e-03 3 1  ON 17
ci_19                 9.354764e-03 3 1  ON 18
ci_20                 6.825386e-03 3 1  ON 19
ci_21                 8.757470e-03 3 1  ON 20
ci_22                 8.807121e-03 3 1  ON 21
ci_23                 4.935836e-03 3 1  ON 22
ci_24                 4.408587e-03 3 1  ON 23
ci_25                 3.163400e-03 3 1  ON 24
ci_26                 3.184628e-03 3 1  ON 25
ci_27                 3.318793e-03 3 1  ON 26
ci_28                 2.435912e-03 3 1  ON 27
ci_29                 2.093753e-03 3 1  ON 28
ci_30                -1.648551e-03 3 1  ON 29
ci_31                -1.634942e-03 3 1  ON 30
ci_32                -1.375847e-03 3 1  ON 31
ci_33                -1.037796e-03 3 1  ON 32
ci_34                 1.525456e-03 3 1  ON 33
ci_35                 1.271325e-03 3 1  ON 34
ci_36                -1.170249e-03 3 1  ON 35
ci_37                -1.132311e-03 3 1  ON 36
ci_38                -5.090415e-04 3 1  ON 37
ci_39                -6.790830e-04 3 1  ON 38
ci_40                -1.668846e-03 3 1  ON 39
ci_41                -1.422588e-03 3 1  ON 40
ci_42                -1.165994e-03 3 1  ON 41
ci_43                -2.841512e-03 3 1  ON 42
ci_44                -1.746594e-03 3 1  ON 43
ci_45                -6.989708e-04 3 1  ON 44
ci_46                -5.662353e-04 3 1  ON 45
ci_47                 1.252394e-03 3 1  ON 46
ci_48                 7.654638e-04 3 1  ON 47
ci_49                -9.307437e-04 3 1  ON 48
ci_50                -7.365192e-04 3 1  ON 49
ci_51                 4.016508e-04 3 1  ON 50
ci_52                 4.364534e-04 3 1  ON 51
ci_53                -6.316058e-04 3 1  ON 52
ci_54                -9.195262e-04 3 1  ON 53
ci_55                -7.112438e-04 3 1  ON 54
ci_56                 1.890475e-03 3 1  ON 55
ci_57                 1.729363e-03 3 1  ON 56
ci_58                -7.826301e-04 3 1  ON 57
ci_59                -9.587161e-04 3 1  ON 58
ci_60                 5.679895e-04 3 1  ON 59
ci_61                 6.088334e-04 3 1  ON 60
ci_62                -2.947463e-04 3 1  ON 61
ci_63                -5.504939e-04 3 1  ON 62
ci_64                -4.565718e-04 3 1  ON 63
ci_65                -2.970330e-04 3 1  ON 64
ci_66                -7.249147e-04 3 1  ON 65
ci_67                -5.943781e-04 3 1  ON 66
ci_68                -6.548323e-04 3 1  ON 67
ci_69                -1.114023e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3064e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.8495
    reference variance = 0.381732
====================================================
  Execution time = 2.7682e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5289e-01
  Total weights = 1.964321435e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5972e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440804197816
                                         uncertainty =       0.004734155746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440804197816
                                         uncertainty =       0.004734155746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469453059
  error estimate for blocks of size 2^( 2) =       0.000494527680
  error estimate for blocks of size 2^( 3) =       0.000517801551
  error estimate for blocks of size 2^( 4) =       0.000534679340
  error estimate for blocks of size 2^( 5) =       0.000544900031
  error estimate for blocks of size 2^( 6) =       0.000549739180
  error estimate for blocks of size 2^( 7) =       0.000553594077

      target function =      -0.742943772274
              le_mean =     -22.814139717027
             les_mean =     520.937856542516
             stat err =       0.000545728157
             autocorr =       1.351351651571
   target nu stat err =       0.000545728157
   target dn stat err =       0.006117026421
      target stat err =       0.005057140522
              std dev =       0.663906883241
             le_variance =       0.440772349615


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281413971703e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742977510668       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742982765926       residual = 5.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742983701616       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742983912416       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742983987684       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742984024170       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742984029142       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742984031700       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742984032621       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742984031882       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 4.902926e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742977510668       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742978832773       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742979067487       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742979120254       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742979139042       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742979148117       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742979149341       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742979149975       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742979150204       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742979150020       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 1.229774e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742977510668       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742977841716       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742977900445       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742977913641       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742977918336       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742977920601       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742977920906       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742977921065       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742977921122       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742977921076       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 3.076973e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.284842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2289e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_01                 1.314072e-01 3 1  ON 0
ci_02                -3.138691e-02 3 1  ON 1
ci_03                -3.110752e-02 3 1  ON 2
ci_04                 2.802444e-02 3 1  ON 3
ci_05                -2.322724e-02 3 1  ON 4
ci_06                -2.295124e-02 3 1  ON 5
ci_07                 2.695051e-02 3 1  ON 6
ci_08                -6.451187e-03 3 1  ON 7
ci_09                -9.334721e-03 3 1  ON 8
ci_10                -9.332925e-03 3 1  ON 9
ci_11                 1.306275e-02 3 1  ON 10
ci_12                 7.702718e-03 3 1  ON 11
ci_13                 1.268560e-02 3 1  ON 12
ci_14                 1.309262e-02 3 1  ON 13
ci_15                 7.129717e-03 3 1  ON 14
ci_16                 7.406791e-03 3 1  ON 15
ci_17                -7.585911e-03 3 1  ON 16
ci_18                -7.209585e-03 3 1  ON 17
ci_19                 9.354103e-03 3 1  ON 18
ci_20                 6.825939e-03 3 1  ON 19
ci_21                 8.758581e-03 3 1  ON 20
ci_22                 8.805737e-03 3 1  ON 21
ci_23                 4.935332e-03 3 1  ON 22
ci_24                 4.407770e-03 3 1  ON 23
ci_25                 3.164174e-03 3 1  ON 24
ci_26                 3.184383e-03 3 1  ON 25
ci_27                 3.314119e-03 3 1  ON 26
ci_28                 2.434054e-03 3 1  ON 27
ci_29                 2.093315e-03 3 1  ON 28
ci_30                -1.646522e-03 3 1  ON 29
ci_31                -1.629128e-03 3 1  ON 30
ci_32                -1.372317e-03 3 1  ON 31
ci_33                -1.034057e-03 3 1  ON 32
ci_34                 1.528389e-03 3 1  ON 33
ci_35                 1.273025e-03 3 1  ON 34
ci_36                -1.170648e-03 3 1  ON 35
ci_37                -1.131081e-03 3 1  ON 36
ci_38                -5.088411e-04 3 1  ON 37
ci_39                -6.795359e-04 3 1  ON 38
ci_40                -1.668230e-03 3 1  ON 39
ci_41                -1.421976e-03 3 1  ON 40
ci_42                -1.163833e-03 3 1  ON 41
ci_43                -2.839896e-03 3 1  ON 42
ci_44                -1.756185e-03 3 1  ON 43
ci_45                -6.977678e-04 3 1  ON 44
ci_46                -5.662439e-04 3 1  ON 45
ci_47                 1.257517e-03 3 1  ON 46
ci_48                 7.663531e-04 3 1  ON 47
ci_49                -9.303239e-04 3 1  ON 48
ci_50                -7.364789e-04 3 1  ON 49
ci_51                 4.005678e-04 3 1  ON 50
ci_52                 4.353716e-04 3 1  ON 51
ci_53                -6.316654e-04 3 1  ON 52
ci_54                -9.192375e-04 3 1  ON 53
ci_55                -7.094893e-04 3 1  ON 54
ci_56                 1.890494e-03 3 1  ON 55
ci_57                 1.728528e-03 3 1  ON 56
ci_58                -7.787621e-04 3 1  ON 57
ci_59                -9.593371e-04 3 1  ON 58
ci_60                 5.687299e-04 3 1  ON 59
ci_61                 6.075554e-04 3 1  ON 60
ci_62                -2.955560e-04 3 1  ON 61
ci_63                -5.477631e-04 3 1  ON 62
ci_64                -4.571294e-04 3 1  ON 63
ci_65                -3.003845e-04 3 1  ON 64
ci_66                -7.255258e-04 3 1  ON 65
ci_67                -5.954049e-04 3 1  ON 66
ci_68                -6.579281e-04 3 1  ON 67
ci_69                -1.136378e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.8191
    reference variance = 0.419431
====================================================
  Execution time = 2.5078e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5012e-01
  Total weights = 1.9645e+06
  Execution time = 3.5045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434857527040
                                         uncertainty =       0.002344520875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434857527040
                                         uncertainty =       0.002344520875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466255534
  error estimate for blocks of size 2^( 2) =       0.000491358838
  error estimate for blocks of size 2^( 3) =       0.000515194243
  error estimate for blocks of size 2^( 4) =       0.000532397544
  error estimate for blocks of size 2^( 5) =       0.000543221108
  error estimate for blocks of size 2^( 6) =       0.000550297564
  error estimate for blocks of size 2^( 7) =       0.000551798716

      target function =      -0.745185832127
              le_mean =     -22.815174503331
             les_mean =     520.982378737534
             stat err =       0.000544428733
             autocorr =       1.363433864808
   target nu stat err =       0.000544428733
   target dn stat err =       0.003647667217
      target stat err =       0.003076700401
              std dev =       0.659384899498
             le_variance =       0.434788445685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434849069720
                                         uncertainty =       0.002343973107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434849069720
                                         uncertainty =       0.002343973107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466250997
  error estimate for blocks of size 2^( 2) =       0.000491356521
  error estimate for blocks of size 2^( 3) =       0.000515193419
  error estimate for blocks of size 2^( 4) =       0.000532397578
  error estimate for blocks of size 2^( 5) =       0.000543222035
  error estimate for blocks of size 2^( 6) =       0.000550299694
  error estimate for blocks of size 2^( 7) =       0.000551801436

      target function =      -0.745379288194
              le_mean =     -22.815174187320
             les_mean =     520.982131803975
             stat err =       0.000544430186
             autocorr =       1.363467674854
   target nu stat err =       0.000544430186
   target dn stat err =       0.003477553447
      target stat err =       0.002940366896
              std dev =       0.659378483481
             le_variance =       0.434779984478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434853230889
                                         uncertainty =       0.002344245631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434853230889
                                         uncertainty =       0.002344245631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466253229
  error estimate for blocks of size 2^( 2) =       0.000491357651
  error estimate for blocks of size 2^( 3) =       0.000515193808
  error estimate for blocks of size 2^( 4) =       0.000532397539
  error estimate for blocks of size 2^( 5) =       0.000543221552
  error estimate for blocks of size 2^( 6) =       0.000550298616
  error estimate for blocks of size 2^( 7) =       0.000551800054

      target function =      -0.745294668658
              le_mean =     -22.815174339395
             les_mean =     520.982240402736
             stat err =       0.000544429440
             autocorr =       1.363450884803
   target nu stat err =       0.000544429440
   target dn stat err =       0.003556672275
      target stat err =       0.003003801953
              std dev =       0.659381640364
             le_variance =       0.434784147649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434856984189
                                         uncertainty =       0.002344486425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434856984189
                                         uncertainty =       0.002344486425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466255243
  error estimate for blocks of size 2^( 2) =       0.000491358687
  error estimate for blocks of size 2^( 3) =       0.000515194186
  error estimate for blocks of size 2^( 4) =       0.000532397541
  error estimate for blocks of size 2^( 5) =       0.000543221161
  error estimate for blocks of size 2^( 6) =       0.000550297693
  error estimate for blocks of size 2^( 7) =       0.000551798880

      target function =      -0.745200577544
              le_mean =     -22.815174482186
             les_mean =     520.982360040716
             stat err =       0.000544428819
             autocorr =       1.363435997508
   target nu stat err =       0.000544428819
   target dn stat err =       0.003635624853
      target stat err =       0.003067054019
              std dev =       0.659384487690
             le_variance =       0.434787902606


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745185832127        initial
     5.9605e+00     5.9605e+01             4.9029e-05        -0.745379288194  <--
     2.3842e+01     2.3842e+02             1.2298e-05        -0.745294668658
     9.5367e+01     9.5367e+02             3.0770e-06        -0.745200577544

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 4.2639e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_01                 1.313705e-01 3 1  ON 0
ci_02                -3.137955e-02 3 1  ON 1
ci_03                -3.110024e-02 3 1  ON 2
ci_04                 2.800154e-02 3 1  ON 3
ci_05                -2.320412e-02 3 1  ON 4
ci_06                -2.292286e-02 3 1  ON 5
ci_07                 2.695271e-02 3 1  ON 6
ci_08                -6.443014e-03 3 1  ON 7
ci_09                -9.336821e-03 3 1  ON 8
ci_10                -9.324017e-03 3 1  ON 9
ci_11                 1.306364e-02 3 1  ON 10
ci_12                 7.705941e-03 3 1  ON 11
ci_13                 1.268544e-02 3 1  ON 12
ci_14                 1.307959e-02 3 1  ON 13
ci_15                 7.112729e-03 3 1  ON 14
ci_16                 7.401049e-03 3 1  ON 15
ci_17                -7.578346e-03 3 1  ON 16
ci_18                -7.199233e-03 3 1  ON 17
ci_19                 9.352137e-03 3 1  ON 18
ci_20                 6.827589e-03 3 1  ON 19
ci_21                 8.761897e-03 3 1  ON 20
ci_22                 8.801598e-03 3 1  ON 21
ci_23                 4.933835e-03 3 1  ON 22
ci_24                 4.405333e-03 3 1  ON 23
ci_25                 3.166477e-03 3 1  ON 24
ci_26                 3.183649e-03 3 1  ON 25
ci_27                 3.300193e-03 3 1  ON 26
ci_28                 2.428514e-03 3 1  ON 27
ci_29                 2.092008e-03 3 1  ON 28
ci_30                -1.640468e-03 3 1  ON 29
ci_31                -1.611771e-03 3 1  ON 30
ci_32                -1.361820e-03 3 1  ON 31
ci_33                -1.022942e-03 3 1  ON 32
ci_34                 1.537128e-03 3 1  ON 33
ci_35                 1.278098e-03 3 1  ON 34
ci_36                -1.171836e-03 3 1  ON 35
ci_37                -1.127426e-03 3 1  ON 36
ci_38                -5.082446e-04 3 1  ON 37
ci_39                -6.808844e-04 3 1  ON 38
ci_40                -1.666397e-03 3 1  ON 39
ci_41                -1.420158e-03 3 1  ON 40
ci_42                -1.157410e-03 3 1  ON 41
ci_43                -2.835081e-03 3 1  ON 42
ci_44                -1.784742e-03 3 1  ON 43
ci_45                -6.941890e-04 3 1  ON 44
ci_46                -5.662682e-04 3 1  ON 45
ci_47                 1.272801e-03 3 1  ON 46
ci_48                 7.690027e-04 3 1  ON 47
ci_49                -9.290726e-04 3 1  ON 48
ci_50                -7.363593e-04 3 1  ON 49
ci_51                 3.973455e-04 3 1  ON 50
ci_52                 4.321517e-04 3 1  ON 51
ci_53                -6.318414e-04 3 1  ON 52
ci_54                -9.183740e-04 3 1  ON 53
ci_55                -7.042611e-04 3 1  ON 54
ci_56                 1.890549e-03 3 1  ON 55
ci_57                 1.726047e-03 3 1  ON 56
ci_58                -7.672547e-04 3 1  ON 57
ci_59                -9.611867e-04 3 1  ON 58
ci_60                 5.709378e-04 3 1  ON 59
ci_61                 6.037304e-04 3 1  ON 60
ci_62                -2.979621e-04 3 1  ON 61
ci_63                -5.396447e-04 3 1  ON 62
ci_64                -4.587880e-04 3 1  ON 63
ci_65                -3.103567e-04 3 1  ON 64
ci_66                -7.273426e-04 3 1  ON 65
ci_67                -5.984585e-04 3 1  ON 66
ci_68                -6.671412e-04 3 1  ON 67
ci_69                -1.202951e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4933e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.8698
    reference variance = 0.412821
====================================================
  Execution time = 2.5837e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5363e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4866e-01
  Total weights = 1.964575104e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436386769991
                                         uncertainty =       0.003455801437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436386769991
                                         uncertainty =       0.003455801437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467096084
  error estimate for blocks of size 2^( 2) =       0.000492711784
  error estimate for blocks of size 2^( 3) =       0.000516765837
  error estimate for blocks of size 2^( 4) =       0.000534821229
  error estimate for blocks of size 2^( 5) =       0.000546287705
  error estimate for blocks of size 2^( 6) =       0.000551797165
  error estimate for blocks of size 2^( 7) =       0.000556607830

      target function =      -0.746450052194
              le_mean =     -22.814729481247
             les_mean =     520.960542855667
             stat err =       0.000547378482
             autocorr =       1.373292316628
   target nu stat err =       0.000547378482
   target dn stat err =       0.003892299690
      target stat err =       0.003284692314
              std dev =       0.660573616366
             le_variance =       0.436357502639


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281472948125e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746463402915       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746479510282       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746480763850       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746480899331       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746480910044       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746480926940       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746480912825       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746480914610       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746480912429       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.000566e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746463402915       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746467530385       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746467847822       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746467881728       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746467884241       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746467888360       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746467884841       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746467885285       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746467884748       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 2.556431e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746463402915       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746464441269       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746464520883       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746464529361       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746464529978       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746464531001       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746464530122       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746464530233       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746464530099       residual = 4.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 6.426427e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.287875 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0368e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_01                 1.313720e-01 3 1  ON 0
ci_02                -3.135624e-02 3 1  ON 1
ci_03                -3.109567e-02 3 1  ON 2
ci_04                 2.797774e-02 3 1  ON 3
ci_05                -2.318888e-02 3 1  ON 4
ci_06                -2.289729e-02 3 1  ON 5
ci_07                 2.695927e-02 3 1  ON 6
ci_08                -6.443143e-03 3 1  ON 7
ci_09                -9.326504e-03 3 1  ON 8
ci_10                -9.310767e-03 3 1  ON 9
ci_11                 1.305631e-02 3 1  ON 10
ci_12                 7.699592e-03 3 1  ON 11
ci_13                 1.268109e-02 3 1  ON 12
ci_14                 1.308022e-02 3 1  ON 13
ci_15                 7.106681e-03 3 1  ON 14
ci_16                 7.388293e-03 3 1  ON 15
ci_17                -7.563459e-03 3 1  ON 16
ci_18                -7.199521e-03 3 1  ON 17
ci_19                 9.349260e-03 3 1  ON 18
ci_20                 6.824101e-03 3 1  ON 19
ci_21                 8.764312e-03 3 1  ON 20
ci_22                 8.808268e-03 3 1  ON 21
ci_23                 4.941763e-03 3 1  ON 22
ci_24                 4.404657e-03 3 1  ON 23
ci_25                 3.162290e-03 3 1  ON 24
ci_26                 3.174902e-03 3 1  ON 25
ci_27                 3.299071e-03 3 1  ON 26
ci_28                 2.453739e-03 3 1  ON 27
ci_29                 2.096583e-03 3 1  ON 28
ci_30                -1.630443e-03 3 1  ON 29
ci_31                -1.612430e-03 3 1  ON 30
ci_32                -1.350129e-03 3 1  ON 31
ci_33                -1.014876e-03 3 1  ON 32
ci_34                 1.517863e-03 3 1  ON 33
ci_35                 1.271403e-03 3 1  ON 34
ci_36                -1.168513e-03 3 1  ON 35
ci_37                -1.125681e-03 3 1  ON 36
ci_38                -5.167697e-04 3 1  ON 37
ci_39                -6.823974e-04 3 1  ON 38
ci_40                -1.666996e-03 3 1  ON 39
ci_41                -1.412945e-03 3 1  ON 40
ci_42                -1.170344e-03 3 1  ON 41
ci_43                -2.819256e-03 3 1  ON 42
ci_44                -1.780238e-03 3 1  ON 43
ci_45                -6.843355e-04 3 1  ON 44
ci_46                -5.608933e-04 3 1  ON 45
ci_47                 1.278343e-03 3 1  ON 46
ci_48                 7.855054e-04 3 1  ON 47
ci_49                -9.306571e-04 3 1  ON 48
ci_50                -7.331640e-04 3 1  ON 49
ci_51                 3.942895e-04 3 1  ON 50
ci_52                 4.206167e-04 3 1  ON 51
ci_53                -6.329821e-04 3 1  ON 52
ci_54                -9.179584e-04 3 1  ON 53
ci_55                -7.014660e-04 3 1  ON 54
ci_56                 1.896714e-03 3 1  ON 55
ci_57                 1.742626e-03 3 1  ON 56
ci_58                -7.792097e-04 3 1  ON 57
ci_59                -9.641179e-04 3 1  ON 58
ci_60                 5.787994e-04 3 1  ON 59
ci_61                 6.030343e-04 3 1  ON 60
ci_62                -2.968506e-04 3 1  ON 61
ci_63                -5.353939e-04 3 1  ON 62
ci_64                -4.516243e-04 3 1  ON 63
ci_65                -3.098058e-04 3 1  ON 64
ci_66                -7.269368e-04 3 1  ON 65
ci_67                -5.942040e-04 3 1  ON 66
ci_68                -6.577004e-04 3 1  ON 67
ci_69                -1.207075e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.7121
    reference variance = 1.02427
====================================================
  Execution time = 2.5140e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4861e-01
  Total weights = 1.9642e+06
  Execution time = 3.5053e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435452463496
                                         uncertainty =       0.002232422577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435452463496
                                         uncertainty =       0.002232422577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466553298
  error estimate for blocks of size 2^( 2) =       0.000491573112
  error estimate for blocks of size 2^( 3) =       0.000515543241
  error estimate for blocks of size 2^( 4) =       0.000533591763
  error estimate for blocks of size 2^( 5) =       0.000544554076
  error estimate for blocks of size 2^( 6) =       0.000549500548
  error estimate for blocks of size 2^( 7) =       0.000550947893

      target function =      -0.746495820860
              le_mean =     -22.814346067858
             les_mean =     520.942998942400
             stat err =       0.000544648570
             autocorr =       1.362793987470
   target nu stat err =       0.000544648570
   target dn stat err =       0.002824474208
      target stat err =       0.002418135026
              std dev =       0.659806000973
             le_variance =       0.435343958919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435422633206
                                         uncertainty =       0.002231540093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435422633206
                                         uncertainty =       0.002231540093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466537333
  error estimate for blocks of size 2^( 2) =       0.000491562900
  error estimate for blocks of size 2^( 3) =       0.000515536875
  error estimate for blocks of size 2^( 4) =       0.000533589753
  error estimate for blocks of size 2^( 5) =       0.000544556930
  error estimate for blocks of size 2^( 6) =       0.000549506600
  error estimate for blocks of size 2^( 7) =       0.000550950543

      target function =      -0.746533346736
              le_mean =     -22.814344827197
             les_mean =     520.942897067488
             stat err =       0.000544650956
             autocorr =       1.362899199070
   target nu stat err =       0.000544650956
   target dn stat err =       0.002822908549
      target stat err =       0.002417110043
              std dev =       0.659783423862
             le_variance =       0.435314166402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435436890737
                                         uncertainty =       0.002231968188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435436890737
                                         uncertainty =       0.002231968188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466544963
  error estimate for blocks of size 2^( 2) =       0.000491567815
  error estimate for blocks of size 2^( 3) =       0.000515539809
  error estimate for blocks of size 2^( 4) =       0.000533590560
  error estimate for blocks of size 2^( 5) =       0.000544555427
  error estimate for blocks of size 2^( 6) =       0.000549503466
  error estimate for blocks of size 2^( 7) =       0.000550949555

      target function =      -0.741811240780
              le_mean =     -22.814345500193
             les_mean =     520.948624375946
             stat err =       0.000544649752
             autocorr =       1.362848591943
   target nu stat err =       0.000544649752
   target dn stat err =       0.006358489489
      target stat err =       0.005239564267
              std dev =       0.659794214749
             le_variance =       0.435328405817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435450464287
                                         uncertainty =       0.002232364278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435450464287
                                         uncertainty =       0.002232364278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466552228
  error estimate for blocks of size 2^( 2) =       0.000491572413
  error estimate for blocks of size 2^( 3) =       0.000515542789
  error estimate for blocks of size 2^( 4) =       0.000533591592
  error estimate for blocks of size 2^( 5) =       0.000544554218
  error estimate for blocks of size 2^( 6) =       0.000549500900
  error estimate for blocks of size 2^( 7) =       0.000550948031

      target function =      -0.746500424086
              le_mean =     -22.814345977411
             les_mean =     520.942989262805
             stat err =       0.000544648685
             autocorr =       1.362800814691
   target nu stat err =       0.000544648685
   target dn stat err =       0.002824292183
      target stat err =       0.002418017528
              std dev =       0.659804487881
             le_variance =       0.435341962228


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746495820860        initial
     1.4901e+00     1.4901e+01             1.0006e-04        -0.746533346736  <--
     5.9605e+00     5.9605e+01             2.5564e-05        -0.741811240780
     2.3842e+01     2.3842e+02             6.4264e-06        -0.746500424086

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 4.2766e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_01                 1.313765e-01 3 1  ON 0
ci_02                -3.128839e-02 3 1  ON 1
ci_03                -3.108253e-02 3 1  ON 2
ci_04                 2.790877e-02 3 1  ON 3
ci_05                -2.314444e-02 3 1  ON 4
ci_06                -2.282280e-02 3 1  ON 5
ci_07                 2.697836e-02 3 1  ON 6
ci_08                -6.443433e-03 3 1  ON 7
ci_09                -9.296403e-03 3 1  ON 8
ci_10                -9.272092e-03 3 1  ON 9
ci_11                 1.303481e-02 3 1  ON 10
ci_12                 7.681083e-03 3 1  ON 11
ci_13                 1.266838e-02 3 1  ON 12
ci_14                 1.308215e-02 3 1  ON 13
ci_15                 7.089111e-03 3 1  ON 14
ci_16                 7.351197e-03 3 1  ON 15
ci_17                -7.520041e-03 3 1  ON 16
ci_18                -7.200370e-03 3 1  ON 17
ci_19                 9.340924e-03 3 1  ON 18
ci_20                 6.813944e-03 3 1  ON 19
ci_21                 8.771334e-03 3 1  ON 20
ci_22                 8.827896e-03 3 1  ON 21
ci_23                 4.964715e-03 3 1  ON 22
ci_24                 4.402729e-03 3 1  ON 23
ci_25                 3.150136e-03 3 1  ON 24
ci_26                 3.149497e-03 3 1  ON 25
ci_27                 3.295875e-03 3 1  ON 26
ci_28                 2.527124e-03 3 1  ON 27
ci_29                 2.109829e-03 3 1  ON 28
ci_30                -1.600972e-03 3 1  ON 29
ci_31                -1.614443e-03 3 1  ON 30
ci_32                -1.316276e-03 3 1  ON 31
ci_33                -9.915324e-04 3 1  ON 32
ci_34                 1.461696e-03 3 1  ON 33
ci_35                 1.251958e-03 3 1  ON 34
ci_36                -1.158863e-03 3 1  ON 35
ci_37                -1.120641e-03 3 1  ON 36
ci_38                -5.415138e-04 3 1  ON 37
ci_39                -6.868011e-04 3 1  ON 38
ci_40                -1.668711e-03 3 1  ON 39
ci_41                -1.392027e-03 3 1  ON 40
ci_42                -1.207819e-03 3 1  ON 41
ci_43                -2.773085e-03 3 1  ON 42
ci_44                -1.767020e-03 3 1  ON 43
ci_45                -6.557124e-04 3 1  ON 44
ci_46                -5.452946e-04 3 1  ON 45
ci_47                 1.294496e-03 3 1  ON 46
ci_48                 8.339025e-04 3 1  ON 47
ci_49                -9.352472e-04 3 1  ON 48
ci_50                -7.239323e-04 3 1  ON 49
ci_51                 3.854154e-04 3 1  ON 50
ci_52                 3.871302e-04 3 1  ON 51
ci_53                -6.362919e-04 3 1  ON 52
ci_54                -9.167790e-04 3 1  ON 53
ci_55                -6.933349e-04 3 1  ON 54
ci_56                 1.914591e-03 3 1  ON 55
ci_57                 1.790679e-03 3 1  ON 56
ci_58                -8.139627e-04 3 1  ON 57
ci_59                -9.726508e-04 3 1  ON 58
ci_60                 6.020157e-04 3 1  ON 59
ci_61                 6.010229e-04 3 1  ON 60
ci_62                -2.936532e-04 3 1  ON 61
ci_63                -5.230911e-04 3 1  ON 62
ci_64                -4.308434e-04 3 1  ON 63
ci_65                -3.082080e-04 3 1  ON 64
ci_66                -7.257690e-04 3 1  ON 65
ci_67                -5.818876e-04 3 1  ON 66
ci_68                -6.302859e-04 3 1  ON 67
ci_69                -1.219122e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3169e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8074
    reference variance = 0.355721
====================================================
  Execution time = 2.6011e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4533e-01
  Total weights = 1.964007197e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5260e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432894669977
                                         uncertainty =       0.001678839786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432894669977
                                         uncertainty =       0.001678839786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465216273
  error estimate for blocks of size 2^( 2) =       0.000490484020
  error estimate for blocks of size 2^( 3) =       0.000514018396
  error estimate for blocks of size 2^( 4) =       0.000531397914
  error estimate for blocks of size 2^( 5) =       0.000541818287
  error estimate for blocks of size 2^( 6) =       0.000547547743
  error estimate for blocks of size 2^( 7) =       0.000552335907

      target function =      -0.749223440938
              le_mean =     -22.814340960076
             les_mean =     520.939486919047
             stat err =       0.000543274963
             autocorr =       1.363733743088
   target nu stat err =       0.000543274963
   target dn stat err =       0.002874637267
      target stat err =       0.002475478038
              std dev =       0.657915162515
             le_variance =       0.432852361068


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281434096008e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749230620167       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749264152305       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749269833347       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749270974327       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749271283266       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749271422168       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749271420344       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749271441907       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749271413941       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 5.454418e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749230620167       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749239813367       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749241322394       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749241614013       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749241686919       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749241718542       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749241716742       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749241721871       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749241715443       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.435321e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749230620167       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749232975367       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749233358517       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749233431752       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749233449640       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749233457329       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749233456793       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749233458056       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749233456489       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 3.636330e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290887 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0546e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_01                 1.312330e-01 3 1  ON 0
ci_02                -3.116143e-02 3 1  ON 1
ci_03                -3.102888e-02 3 1  ON 2
ci_04                 2.782565e-02 3 1  ON 3
ci_05                -2.310113e-02 3 1  ON 4
ci_06                -2.276426e-02 3 1  ON 5
ci_07                 2.696083e-02 3 1  ON 6
ci_08                -6.391653e-03 3 1  ON 7
ci_09                -9.251198e-03 3 1  ON 8
ci_10                -9.233569e-03 3 1  ON 9
ci_11                 1.302561e-02 3 1  ON 10
ci_12                 7.646464e-03 3 1  ON 11
ci_13                 1.265850e-02 3 1  ON 12
ci_14                 1.311833e-02 3 1  ON 13
ci_15                 7.057873e-03 3 1  ON 14
ci_16                 7.316155e-03 3 1  ON 15
ci_17                -7.491026e-03 3 1  ON 16
ci_18                -7.201940e-03 3 1  ON 17
ci_19                 9.318647e-03 3 1  ON 18
ci_20                 6.817227e-03 3 1  ON 19
ci_21                 8.781631e-03 3 1  ON 20
ci_22                 8.784162e-03 3 1  ON 21
ci_23                 4.971290e-03 3 1  ON 22
ci_24                 4.400280e-03 3 1  ON 23
ci_25                 3.132226e-03 3 1  ON 24
ci_26                 3.140079e-03 3 1  ON 25
ci_27                 3.323866e-03 3 1  ON 26
ci_28                 2.498040e-03 3 1  ON 27
ci_29                 2.123736e-03 3 1  ON 28
ci_30                -1.590569e-03 3 1  ON 29
ci_31                -1.612788e-03 3 1  ON 30
ci_32                -1.296684e-03 3 1  ON 31
ci_33                -1.008475e-03 3 1  ON 32
ci_34                 1.466500e-03 3 1  ON 33
ci_35                 1.230800e-03 3 1  ON 34
ci_36                -1.130424e-03 3 1  ON 35
ci_37                -1.119156e-03 3 1  ON 36
ci_38                -5.304412e-04 3 1  ON 37
ci_39                -6.692697e-04 3 1  ON 38
ci_40                -1.678257e-03 3 1  ON 39
ci_41                -1.415883e-03 3 1  ON 40
ci_42                -1.218186e-03 3 1  ON 41
ci_43                -2.709410e-03 3 1  ON 42
ci_44                -1.755790e-03 3 1  ON 43
ci_45                -6.360686e-04 3 1  ON 44
ci_46                -5.355349e-04 3 1  ON 45
ci_47                 1.312192e-03 3 1  ON 46
ci_48                 8.517971e-04 3 1  ON 47
ci_49                -9.507480e-04 3 1  ON 48
ci_50                -7.403273e-04 3 1  ON 49
ci_51                 3.598625e-04 3 1  ON 50
ci_52                 3.833914e-04 3 1  ON 51
ci_53                -6.491577e-04 3 1  ON 52
ci_54                -8.999890e-04 3 1  ON 53
ci_55                -6.689087e-04 3 1  ON 54
ci_56                 1.903877e-03 3 1  ON 55
ci_57                 1.811486e-03 3 1  ON 56
ci_58                -8.195240e-04 3 1  ON 57
ci_59                -9.765867e-04 3 1  ON 58
ci_60                 6.076677e-04 3 1  ON 59
ci_61                 5.775302e-04 3 1  ON 60
ci_62                -2.962864e-04 3 1  ON 61
ci_63                -5.134901e-04 3 1  ON 62
ci_64                -4.066508e-04 3 1  ON 63
ci_65                -3.149637e-04 3 1  ON 64
ci_66                -7.127270e-04 3 1  ON 65
ci_67                -5.853933e-04 3 1  ON 66
ci_68                -6.409394e-04 3 1  ON 67
ci_69                -1.817875e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8486
    reference variance = 0.372313
====================================================
  Execution time = 2.5223e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4554e-01
  Total weights = 1.9644e+06
  Execution time = 3.5073e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434344582243
                                         uncertainty =       0.003348617233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434344582243
                                         uncertainty =       0.003348617233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466014290
  error estimate for blocks of size 2^( 2) =       0.000491526048
  error estimate for blocks of size 2^( 3) =       0.000514877883
  error estimate for blocks of size 2^( 4) =       0.000532406143
  error estimate for blocks of size 2^( 5) =       0.000544617011
  error estimate for blocks of size 2^( 6) =       0.000549481584
  error estimate for blocks of size 2^( 7) =       0.000553593299

      target function =      -0.748985256239
              le_mean =     -22.815051790660
             les_mean =     520.972203530139
             stat err =       0.000545024509
             autocorr =       1.367834634986
   target nu stat err =       0.000545024509
   target dn stat err =       0.004100247604
      target stat err =       0.003478668382
              std dev =       0.659043729306
             le_variance =       0.434338637138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434201862545
                                         uncertainty =       0.003300799959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434201862545
                                         uncertainty =       0.003300799959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465937828
  error estimate for blocks of size 2^( 2) =       0.000491476317
  error estimate for blocks of size 2^( 3) =       0.000514855107
  error estimate for blocks of size 2^( 4) =       0.000532403437
  error estimate for blocks of size 2^( 5) =       0.000544624018
  error estimate for blocks of size 2^( 6) =       0.000549485424
  error estimate for blocks of size 2^( 7) =       0.000553600189

      target function =      -0.748957118867
              le_mean =     -22.815052625994
             les_mean =     520.972275675064
             stat err =       0.000545028267
             autocorr =       1.368302473164
   target nu stat err =       0.000545028267
   target dn stat err =       0.004064435931
      target stat err =       0.003448965905
              std dev =       0.658935595517
             le_variance =       0.434196119039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434264657063
                                         uncertainty =       0.003322312026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434264657063
                                         uncertainty =       0.003322312026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465971472
  error estimate for blocks of size 2^( 2) =       0.000491497686
  error estimate for blocks of size 2^( 3) =       0.000514864112
  error estimate for blocks of size 2^( 4) =       0.000532403161
  error estimate for blocks of size 2^( 5) =       0.000544619398
  error estimate for blocks of size 2^( 6) =       0.000549482132
  error estimate for blocks of size 2^( 7) =       0.000553595362

      target function =      -0.749058324766
              le_mean =     -22.815051816184
             les_mean =     520.972117454816
             stat err =       0.000545025013
             autocorr =       1.368088559160
   target nu stat err =       0.000545025013
   target dn stat err =       0.004076085668
      target stat err =       0.003459460870
              std dev =       0.658983174939
             le_variance =       0.434258824853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434334012896
                                         uncertainty =       0.003345218437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434334012896
                                         uncertainty =       0.003345218437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466008628
  error estimate for blocks of size 2^( 2) =       0.000491522227
  error estimate for blocks of size 2^( 3) =       0.000514875925
  error estimate for blocks of size 2^( 4) =       0.000532405558
  error estimate for blocks of size 2^( 5) =       0.000544617115
  error estimate for blocks of size 2^( 6) =       0.000549481448
  error estimate for blocks of size 2^( 7) =       0.000553593359

      target function =      -0.749007943984
              le_mean =     -22.815051734313
             les_mean =     520.972173833768
             stat err =       0.000545024370
             autocorr =       1.367867175980
   target nu stat err =       0.000545024370
   target dn stat err =       0.004096487118
      target stat err =       0.003475782323
              std dev =       0.659035721825
             le_variance =       0.434328082642


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748985256239        initial
     3.7253e-01     3.7253e+00             5.4544e-04        -0.748957118867
     1.4901e+00     1.4901e+01             1.4353e-04        -0.749058324766  <--
     5.9605e+00     5.9605e+01             3.6363e-05        -0.749007943984

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 4.2853e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_01                 1.312330e-01 3 1  ON 0
ci_02                -3.116143e-02 3 1  ON 1
ci_03                -3.102888e-02 3 1  ON 2
ci_04                 2.782565e-02 3 1  ON 3
ci_05                -2.310113e-02 3 1  ON 4
ci_06                -2.276426e-02 3 1  ON 5
ci_07                 2.696083e-02 3 1  ON 6
ci_08                -6.391653e-03 3 1  ON 7
ci_09                -9.251198e-03 3 1  ON 8
ci_10                -9.233569e-03 3 1  ON 9
ci_11                 1.302561e-02 3 1  ON 10
ci_12                 7.646464e-03 3 1  ON 11
ci_13                 1.265850e-02 3 1  ON 12
ci_14                 1.311833e-02 3 1  ON 13
ci_15                 7.057873e-03 3 1  ON 14
ci_16                 7.316155e-03 3 1  ON 15
ci_17                -7.491026e-03 3 1  ON 16
ci_18                -7.201940e-03 3 1  ON 17
ci_19                 9.318647e-03 3 1  ON 18
ci_20                 6.817227e-03 3 1  ON 19
ci_21                 8.781631e-03 3 1  ON 20
ci_22                 8.784162e-03 3 1  ON 21
ci_23                 4.971290e-03 3 1  ON 22
ci_24                 4.400280e-03 3 1  ON 23
ci_25                 3.132226e-03 3 1  ON 24
ci_26                 3.140079e-03 3 1  ON 25
ci_27                 3.323866e-03 3 1  ON 26
ci_28                 2.498040e-03 3 1  ON 27
ci_29                 2.123736e-03 3 1  ON 28
ci_30                -1.590569e-03 3 1  ON 29
ci_31                -1.612788e-03 3 1  ON 30
ci_32                -1.296684e-03 3 1  ON 31
ci_33                -1.008475e-03 3 1  ON 32
ci_34                 1.466500e-03 3 1  ON 33
ci_35                 1.230800e-03 3 1  ON 34
ci_36                -1.130424e-03 3 1  ON 35
ci_37                -1.119156e-03 3 1  ON 36
ci_38                -5.304412e-04 3 1  ON 37
ci_39                -6.692697e-04 3 1  ON 38
ci_40                -1.678257e-03 3 1  ON 39
ci_41                -1.415883e-03 3 1  ON 40
ci_42                -1.218186e-03 3 1  ON 41
ci_43                -2.709410e-03 3 1  ON 42
ci_44                -1.755790e-03 3 1  ON 43
ci_45                -6.360686e-04 3 1  ON 44
ci_46                -5.355349e-04 3 1  ON 45
ci_47                 1.312192e-03 3 1  ON 46
ci_48                 8.517971e-04 3 1  ON 47
ci_49                -9.507480e-04 3 1  ON 48
ci_50                -7.403273e-04 3 1  ON 49
ci_51                 3.598625e-04 3 1  ON 50
ci_52                 3.833914e-04 3 1  ON 51
ci_53                -6.491577e-04 3 1  ON 52
ci_54                -8.999890e-04 3 1  ON 53
ci_55                -6.689087e-04 3 1  ON 54
ci_56                 1.903877e-03 3 1  ON 55
ci_57                 1.811486e-03 3 1  ON 56
ci_58                -8.195240e-04 3 1  ON 57
ci_59                -9.765867e-04 3 1  ON 58
ci_60                 6.076677e-04 3 1  ON 59
ci_61                 5.775302e-04 3 1  ON 60
ci_62                -2.962864e-04 3 1  ON 61
ci_63                -5.134901e-04 3 1  ON 62
ci_64                -4.066508e-04 3 1  ON 63
ci_65                -3.149637e-04 3 1  ON 64
ci_66                -7.127270e-04 3 1  ON 65
ci_67                -5.853933e-04 3 1  ON 66
ci_68                -6.409394e-04 3 1  ON 67
ci_69                -1.817875e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3404e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7906
    reference variance = 0.314384
====================================================
  Execution time = 2.5900e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5314e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4723e-01
  Total weights = 1.964083750e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5070e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433255593671
                                         uncertainty =       0.001980196697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433255593671
                                         uncertainty =       0.001980196697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465461025
  error estimate for blocks of size 2^( 2) =       0.000491232523
  error estimate for blocks of size 2^( 3) =       0.000515083545
  error estimate for blocks of size 2^( 4) =       0.000532902970
  error estimate for blocks of size 2^( 5) =       0.000544655085
  error estimate for blocks of size 2^( 6) =       0.000553154537
  error estimate for blocks of size 2^( 7) =       0.000557117172

      target function =      -0.747645530116
              le_mean =     -22.814378947976
             les_mean =     520.943115282892
             stat err =       0.000546957441
             autocorr =       1.380830678097
   target nu stat err =       0.000546957441
   target dn stat err =       0.002915244371
      target stat err =       0.002499253652
              std dev =       0.658261294427
             le_variance =       0.433307931741


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281437894798e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747651833098       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747706175992       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747711777911       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747712617270       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747712579749       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747712596846       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747712613205       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747712648850       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747712648053       residual = 9.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 5.965134e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747651833098       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747666763619       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747668251311       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747668464013       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747668450333       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747668454930       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747668458527       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747668467048       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747668466583       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.620846e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747651833098       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747655660433       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747656038130       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747656091406       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747656087681       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747656088858       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747656089722       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747656091823       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747656091690       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 4.142055e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.293948 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0415e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_01                 1.311269e-01 3 1  ON 0
ci_02                -3.099935e-02 3 1  ON 1
ci_03                -3.095942e-02 3 1  ON 2
ci_04                 2.771587e-02 3 1  ON 3
ci_05                -2.305079e-02 3 1  ON 4
ci_06                -2.269655e-02 3 1  ON 5
ci_07                 2.693244e-02 3 1  ON 6
ci_08                -6.318383e-03 3 1  ON 7
ci_09                -9.203284e-03 3 1  ON 8
ci_10                -9.233982e-03 3 1  ON 9
ci_11                 1.299258e-02 3 1  ON 10
ci_12                 7.604992e-03 3 1  ON 11
ci_13                 1.266485e-02 3 1  ON 12
ci_14                 1.310045e-02 3 1  ON 13
ci_15                 7.048824e-03 3 1  ON 14
ci_16                 7.285545e-03 3 1  ON 15
ci_17                -7.448602e-03 3 1  ON 16
ci_18                -7.169684e-03 3 1  ON 17
ci_19                 9.294900e-03 3 1  ON 18
ci_20                 6.832973e-03 3 1  ON 19
ci_21                 8.772063e-03 3 1  ON 20
ci_22                 8.762018e-03 3 1  ON 21
ci_23                 4.988100e-03 3 1  ON 22
ci_24                 4.388313e-03 3 1  ON 23
ci_25                 3.113492e-03 3 1  ON 24
ci_26                 3.146118e-03 3 1  ON 25
ci_27                 3.313712e-03 3 1  ON 26
ci_28                 2.513674e-03 3 1  ON 27
ci_29                 2.169887e-03 3 1  ON 28
ci_30                -1.616298e-03 3 1  ON 29
ci_31                -1.620363e-03 3 1  ON 30
ci_32                -1.350199e-03 3 1  ON 31
ci_33                -1.062041e-03 3 1  ON 32
ci_34                 1.474210e-03 3 1  ON 33
ci_35                 1.217438e-03 3 1  ON 34
ci_36                -1.116872e-03 3 1  ON 35
ci_37                -1.115610e-03 3 1  ON 36
ci_38                -5.173601e-04 3 1  ON 37
ci_39                -6.198552e-04 3 1  ON 38
ci_40                -1.677099e-03 3 1  ON 39
ci_41                -1.401736e-03 3 1  ON 40
ci_42                -1.185591e-03 3 1  ON 41
ci_43                -2.696716e-03 3 1  ON 42
ci_44                -1.769350e-03 3 1  ON 43
ci_45                -6.235540e-04 3 1  ON 44
ci_46                -5.110331e-04 3 1  ON 45
ci_47                 1.305421e-03 3 1  ON 46
ci_48                 8.847308e-04 3 1  ON 47
ci_49                -9.632004e-04 3 1  ON 48
ci_50                -7.652654e-04 3 1  ON 49
ci_51                 3.673114e-04 3 1  ON 50
ci_52                 3.732995e-04 3 1  ON 51
ci_53                -6.398623e-04 3 1  ON 52
ci_54                -8.771147e-04 3 1  ON 53
ci_55                -6.743404e-04 3 1  ON 54
ci_56                 1.879698e-03 3 1  ON 55
ci_57                 1.786427e-03 3 1  ON 56
ci_58                -8.332293e-04 3 1  ON 57
ci_59                -9.229663e-04 3 1  ON 58
ci_60                 6.078069e-04 3 1  ON 59
ci_61                 5.616161e-04 3 1  ON 60
ci_62                -3.179508e-04 3 1  ON 61
ci_63                -5.195741e-04 3 1  ON 62
ci_64                -3.901754e-04 3 1  ON 63
ci_65                -3.300283e-04 3 1  ON 64
ci_66                -6.599170e-04 3 1  ON 65
ci_67                -5.828279e-04 3 1  ON 66
ci_68                -6.756400e-04 3 1  ON 67
ci_69                -1.890679e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.8465
    reference variance = 0.333174
====================================================
  Execution time = 2.5259e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5035e-01
  Total weights = 1.9639e+06
  Execution time = 3.5023e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437827329252
                                         uncertainty =       0.001911987478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437827329252
                                         uncertainty =       0.001911987478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467942311
  error estimate for blocks of size 2^( 2) =       0.000492947991
  error estimate for blocks of size 2^( 3) =       0.000516565303
  error estimate for blocks of size 2^( 4) =       0.000533424229
  error estimate for blocks of size 2^( 5) =       0.000543299513
  error estimate for blocks of size 2^( 6) =       0.000550125104
  error estimate for blocks of size 2^( 7) =       0.000554631305

      target function =      -0.741991267316
              le_mean =     -22.814756236885
             les_mean =     520.967166353742
             stat err =       0.000545370038
             autocorr =       1.358306932731
   target nu stat err =       0.000545370038
   target dn stat err =       0.004573460480
      target stat err =       0.003795885181
              std dev =       0.661770362891
             le_variance =       0.437940013201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437710396058
                                         uncertainty =       0.001911332476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437710396058
                                         uncertainty =       0.001911332476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467879929
  error estimate for blocks of size 2^( 2) =       0.000492913781
  error estimate for blocks of size 2^( 3) =       0.000516559554
  error estimate for blocks of size 2^( 4) =       0.000533441480
  error estimate for blocks of size 2^( 5) =       0.000543331232
  error estimate for blocks of size 2^( 6) =       0.000550165932
  error estimate for blocks of size 2^( 7) =       0.000554678404

      target function =      -0.733228615158
              le_mean =     -22.814760884107
             les_mean =     520.977965680452
             stat err =       0.000545404262
             autocorr =       1.358839692166
   target nu stat err =       0.000545404262
   target dn stat err =       0.015346620588
      target stat err =       0.012298383273
              std dev =       0.661682141120
             le_variance =       0.437823255877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437758514302
                                         uncertainty =       0.001911286680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437758514302
                                         uncertainty =       0.001911286680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467905595
  error estimate for blocks of size 2^( 2) =       0.000492926493
  error estimate for blocks of size 2^( 3) =       0.000516559384
  error estimate for blocks of size 2^( 4) =       0.000533431224
  error estimate for blocks of size 2^( 5) =       0.000543313226
  error estimate for blocks of size 2^( 6) =       0.000550141957
  error estimate for blocks of size 2^( 7) =       0.000554650447

      target function =      -0.744394535957
              le_mean =     -22.814758367721
             les_mean =     520.964354203972
             stat err =       0.000545384214
             autocorr =       1.358590739402
   target nu stat err =       0.000545384214
   target dn stat err =       0.002848122516
      target stat err =       0.002425530945
              std dev =       0.661718437702
             le_variance =       0.437871290794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437817928106
                                         uncertainty =       0.001911884366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437817928106
                                         uncertainty =       0.001911884366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467937295
  error estimate for blocks of size 2^( 2) =       0.000492945093
  error estimate for blocks of size 2^( 3) =       0.000516564696
  error estimate for blocks of size 2^( 4) =       0.000533425292
  error estimate for blocks of size 2^( 5) =       0.000543301803
  error estimate for blocks of size 2^( 6) =       0.000550127387
  error estimate for blocks of size 2^( 7) =       0.000554633491

      target function =      -0.745009498675
              le_mean =     -22.814756280300
             les_mean =     520.963515978131
             stat err =       0.000545371993
             autocorr =       1.358345795176
   target nu stat err =       0.000545371993
   target dn stat err =       0.002504447599
      target stat err =       0.002155575294
              std dev =       0.661763268866
             le_variance =       0.437930624020


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741991267316        initial
     3.7253e-01     3.7253e+00             5.9651e-04        -0.733228615158
     1.4901e+00     1.4901e+01             1.6208e-04        -0.744394535957
     5.9605e+00     5.9605e+01             4.1421e-05        -0.745009498675  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 4.2865e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_01                 1.312061e-01 3 1  ON 0
ci_02                -3.112001e-02 3 1  ON 1
ci_03                -3.101112e-02 3 1  ON 2
ci_04                 2.779750e-02 3 1  ON 3
ci_05                -2.308822e-02 3 1  ON 4
ci_06                -2.274692e-02 3 1  ON 5
ci_07                 2.695360e-02 3 1  ON 6
ci_08                -6.372866e-03 3 1  ON 7
ci_09                -9.238977e-03 3 1  ON 8
ci_10                -9.233676e-03 3 1  ON 9
ci_11                 1.301721e-02 3 1  ON 10
ci_12                 7.635835e-03 3 1  ON 11
ci_13                 1.266014e-02 3 1  ON 12
ci_14                 1.311381e-02 3 1  ON 13
ci_15                 7.055550e-03 3 1  ON 14
ci_16                 7.308341e-03 3 1  ON 15
ci_17                -7.480194e-03 3 1  ON 16
ci_18                -7.193721e-03 3 1  ON 17
ci_19                 9.312538e-03 3 1  ON 18
ci_20                 6.821243e-03 3 1  ON 19
ci_21                 8.779196e-03 3 1  ON 20
ci_22                 8.778511e-03 3 1  ON 21
ci_23                 4.975603e-03 3 1  ON 22
ci_24                 4.397228e-03 3 1  ON 23
ci_25                 3.127421e-03 3 1  ON 24
ci_26                 3.141618e-03 3 1  ON 25
ci_27                 3.321274e-03 3 1  ON 26
ci_28                 2.502045e-03 3 1  ON 27
ci_29                 2.135560e-03 3 1  ON 28
ci_30                -1.597106e-03 3 1  ON 29
ci_31                -1.614716e-03 3 1  ON 30
ci_32                -1.310405e-03 3 1  ON 31
ci_33                -1.022204e-03 3 1  ON 32
ci_34                 1.468459e-03 3 1  ON 33
ci_35                 1.227359e-03 3 1  ON 34
ci_36                -1.126956e-03 3 1  ON 35
ci_37                -1.118254e-03 3 1  ON 36
ci_38                -5.270939e-04 3 1  ON 37
ci_39                -6.566118e-04 3 1  ON 38
ci_40                -1.677965e-03 3 1  ON 39
ci_41                -1.412256e-03 3 1  ON 40
ci_42                -1.209825e-03 3 1  ON 41
ci_43                -2.706167e-03 3 1  ON 42
ci_44                -1.759265e-03 3 1  ON 43
ci_45                -6.328576e-04 3 1  ON 44
ci_46                -5.292550e-04 3 1  ON 45
ci_47                 1.310458e-03 3 1  ON 46
ci_48                 8.601785e-04 3 1  ON 47
ci_49                -9.539385e-04 3 1  ON 48
ci_50                -7.467388e-04 3 1  ON 49
ci_51                 3.617784e-04 3 1  ON 50
ci_52                 3.808050e-04 3 1  ON 51
ci_53                -6.467653e-04 3 1  ON 52
ci_54                -8.941493e-04 3 1  ON 53
ci_55                -6.702933e-04 3 1  ON 54
ci_56                 1.897673e-03 3 1  ON 55
ci_57                 1.805057e-03 3 1  ON 56
ci_58                -8.230323e-04 3 1  ON 57
ci_59                -9.628467e-04 3 1  ON 58
ci_60                 6.077058e-04 3 1  ON 59
ci_61                 5.734919e-04 3 1  ON 60
ci_62                -3.018580e-04 3 1  ON 61
ci_63                -5.150561e-04 3 1  ON 62
ci_64                -4.024418e-04 3 1  ON 63
ci_65                -3.188189e-04 3 1  ON 64
ci_66                -6.992004e-04 3 1  ON 65
ci_67                -5.847392e-04 3 1  ON 66
ci_68                -6.498261e-04 3 1  ON 67
ci_69                -1.836588e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3286e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.8626
    reference variance = 0.989739
====================================================
  Execution time = 2.7972e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4530e-01
  Total weights = 1.964367044e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432373359476
                                         uncertainty =       0.002113570949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432373359476
                                         uncertainty =       0.002113570949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464961797
  error estimate for blocks of size 2^( 2) =       0.000489922336
  error estimate for blocks of size 2^( 3) =       0.000513997669
  error estimate for blocks of size 2^( 4) =       0.000531271917
  error estimate for blocks of size 2^( 5) =       0.000543812964
  error estimate for blocks of size 2^( 6) =       0.000550372577
  error estimate for blocks of size 2^( 7) =       0.000554120356

      target function =      -0.749251171300
              le_mean =     -22.814181913168
             les_mean =     520.932195567225
             stat err =       0.000544894454
             autocorr =       1.373378464287
   target nu stat err =       0.000544894454
   target dn stat err =       0.002782930801
      target stat err =       0.002401361135
              std dev =       0.657555278869
             le_variance =       0.432378944769


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281418191317e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749257906886       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749268778143       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749270520839       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749270858968       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749271044554       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749271159935       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749271204308       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749271204848       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749271202749       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749271202005       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.467503e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749257906886       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749260694246       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749261136570       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749261221372       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749261267688       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749261296270       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749261307133       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749261307223       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749261306706       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749261306531       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 3.720161e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749257906886       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749258608213       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749258719215       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749258740430       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749258752003       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749258759131       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749258761832       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749258761851       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749258761723       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749258761679       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 9.333143e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.297450 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2498e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_01                 1.311689e-01 3 1  ON 0
ci_02                -3.109421e-02 3 1  ON 1
ci_03                -3.098725e-02 3 1  ON 2
ci_04                 2.777622e-02 3 1  ON 3
ci_05                -2.306567e-02 3 1  ON 4
ci_06                -2.274490e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354174e-03 3 1  ON 7
ci_09                -9.236166e-03 3 1  ON 8
ci_10                -9.226452e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627898e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058114e-03 3 1  ON 14
ci_16                 7.299942e-03 3 1  ON 15
ci_17                -7.468966e-03 3 1  ON 16
ci_18                -7.185615e-03 3 1  ON 17
ci_19                 9.309459e-03 3 1  ON 18
ci_20                 6.818793e-03 3 1  ON 19
ci_21                 8.774061e-03 3 1  ON 20
ci_22                 8.773342e-03 3 1  ON 21
ci_23                 4.977846e-03 3 1  ON 22
ci_24                 4.388757e-03 3 1  ON 23
ci_25                 3.124213e-03 3 1  ON 24
ci_26                 3.150441e-03 3 1  ON 25
ci_27                 3.326767e-03 3 1  ON 26
ci_28                 2.505842e-03 3 1  ON 27
ci_29                 2.138174e-03 3 1  ON 28
ci_30                -1.586275e-03 3 1  ON 29
ci_31                -1.612308e-03 3 1  ON 30
ci_32                -1.313340e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461966e-03 3 1  ON 33
ci_35                 1.221732e-03 3 1  ON 34
ci_36                -1.116942e-03 3 1  ON 35
ci_37                -1.122367e-03 3 1  ON 36
ci_38                -5.287665e-04 3 1  ON 37
ci_39                -6.422527e-04 3 1  ON 38
ci_40                -1.673120e-03 3 1  ON 39
ci_41                -1.413581e-03 3 1  ON 40
ci_42                -1.208530e-03 3 1  ON 41
ci_43                -2.700310e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300618e-04 3 1  ON 44
ci_46                -5.317765e-04 3 1  ON 45
ci_47                 1.304118e-03 3 1  ON 46
ci_48                 8.704690e-04 3 1  ON 47
ci_49                -9.525982e-04 3 1  ON 48
ci_50                -7.380908e-04 3 1  ON 49
ci_51                 3.640956e-04 3 1  ON 50
ci_52                 3.764097e-04 3 1  ON 51
ci_53                -6.473191e-04 3 1  ON 52
ci_54                -9.086549e-04 3 1  ON 53
ci_55                -6.740919e-04 3 1  ON 54
ci_56                 1.893490e-03 3 1  ON 55
ci_57                 1.812212e-03 3 1  ON 56
ci_58                -8.217781e-04 3 1  ON 57
ci_59                -9.599703e-04 3 1  ON 58
ci_60                 6.219833e-04 3 1  ON 59
ci_61                 5.642797e-04 3 1  ON 60
ci_62                -3.000529e-04 3 1  ON 61
ci_63                -5.128102e-04 3 1  ON 62
ci_64                -4.067351e-04 3 1  ON 63
ci_65                -3.135718e-04 3 1  ON 64
ci_66                -6.969392e-04 3 1  ON 65
ci_67                -5.894714e-04 3 1  ON 66
ci_68                -6.488117e-04 3 1  ON 67
ci_69                -1.883399e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.9011
    reference variance = 0.691212
====================================================
  Execution time = 2.5228e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5276e-01
  Total weights = 1.9643e+06
  Execution time = 3.4907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437910456887
                                         uncertainty =       0.002523799134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437910456887
                                         uncertainty =       0.002523799134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467977512
  error estimate for blocks of size 2^( 2) =       0.000492980944
  error estimate for blocks of size 2^( 3) =       0.000516375471
  error estimate for blocks of size 2^( 4) =       0.000533907465
  error estimate for blocks of size 2^( 5) =       0.000545264889
  error estimate for blocks of size 2^( 6) =       0.000552246132
  error estimate for blocks of size 2^( 7) =       0.000555846961

      target function =      -0.743004464073
              le_mean =     -22.814954674802
             les_mean =     520.974987069595
             stat err =       0.000546816362
             autocorr =       1.365315542246
   target nu stat err =       0.000546816362
   target dn stat err =       0.004431219865
      target stat err =       0.003692118878
              std dev =       0.661820143794
             le_variance =       0.438005902731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437870581933
                                         uncertainty =       0.002519998012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437870581933
                                         uncertainty =       0.002519998012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467956008
  error estimate for blocks of size 2^( 2) =       0.000492966448
  error estimate for blocks of size 2^( 3) =       0.000516367629
  error estimate for blocks of size 2^( 4) =       0.000533905469
  error estimate for blocks of size 2^( 5) =       0.000545265089
  error estimate for blocks of size 2^( 6) =       0.000552249483
  error estimate for blocks of size 2^( 7) =       0.000555852581

      target function =      -0.743034643082
              le_mean =     -22.814954012958
             les_mean =     520.974920389228
             stat err =       0.000546818155
             autocorr =       1.365449981014
   target nu stat err =       0.000546818155
   target dn stat err =       0.004407088148
      target stat err =       0.003672843418
              std dev =       0.661789733479
             le_variance =       0.437965651338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437889853684
                                         uncertainty =       0.002521848456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437889853684
                                         uncertainty =       0.002521848456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467966402
  error estimate for blocks of size 2^( 2) =       0.000492973421
  error estimate for blocks of size 2^( 3) =       0.000516371328
  error estimate for blocks of size 2^( 4) =       0.000533906334
  error estimate for blocks of size 2^( 5) =       0.000545264851
  error estimate for blocks of size 2^( 6) =       0.000552247610
  error estimate for blocks of size 2^( 7) =       0.000555849617

      target function =      -0.743109974849
              le_mean =     -22.814954300137
             les_mean =     520.974841758299
             stat err =       0.000546817103
             autocorr =       1.365384068666
   target nu stat err =       0.000546817103
   target dn stat err =       0.004417070642
      target stat err =       0.003681675459
              std dev =       0.661804432916
             le_variance =       0.437985107427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437907840282
                                         uncertainty =       0.002523552933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437907840282
                                         uncertainty =       0.002523552933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467976101
  error estimate for blocks of size 2^( 2) =       0.000492979985
  error estimate for blocks of size 2^( 3) =       0.000516374937
  error estimate for blocks of size 2^( 4) =       0.000533907309
  error estimate for blocks of size 2^( 5) =       0.000545264870
  error estimate for blocks of size 2^( 6) =       0.000552246303
  error estimate for blocks of size 2^( 7) =       0.000555847279

      target function =      -0.743021293828
              le_mean =     -22.814954622006
             les_mean =     520.974964204442
             stat err =       0.000546816440
             autocorr =       1.365324167731
   target nu stat err =       0.000546816440
   target dn stat err =       0.004429206125
      target stat err =       0.003690650657
              std dev =       0.661818148718
             le_variance =       0.438003261973


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743004464073        initial
     1.4901e+00     1.4901e+01             1.4675e-04        -0.743034643082
     5.9605e+00     5.9605e+01             3.7202e-05        -0.743109974849  <--
     2.3842e+01     2.3842e+02             9.3331e-06        -0.743021293828

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 4.2784e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_01                 1.311689e-01 3 1  ON 0
ci_02                -3.109421e-02 3 1  ON 1
ci_03                -3.098725e-02 3 1  ON 2
ci_04                 2.777622e-02 3 1  ON 3
ci_05                -2.306567e-02 3 1  ON 4
ci_06                -2.274490e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354174e-03 3 1  ON 7
ci_09                -9.236166e-03 3 1  ON 8
ci_10                -9.226452e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627898e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058114e-03 3 1  ON 14
ci_16                 7.299942e-03 3 1  ON 15
ci_17                -7.468966e-03 3 1  ON 16
ci_18                -7.185615e-03 3 1  ON 17
ci_19                 9.309459e-03 3 1  ON 18
ci_20                 6.818793e-03 3 1  ON 19
ci_21                 8.774061e-03 3 1  ON 20
ci_22                 8.773342e-03 3 1  ON 21
ci_23                 4.977846e-03 3 1  ON 22
ci_24                 4.388757e-03 3 1  ON 23
ci_25                 3.124213e-03 3 1  ON 24
ci_26                 3.150441e-03 3 1  ON 25
ci_27                 3.326767e-03 3 1  ON 26
ci_28                 2.505842e-03 3 1  ON 27
ci_29                 2.138174e-03 3 1  ON 28
ci_30                -1.586275e-03 3 1  ON 29
ci_31                -1.612308e-03 3 1  ON 30
ci_32                -1.313340e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461966e-03 3 1  ON 33
ci_35                 1.221732e-03 3 1  ON 34
ci_36                -1.116942e-03 3 1  ON 35
ci_37                -1.122367e-03 3 1  ON 36
ci_38                -5.287665e-04 3 1  ON 37
ci_39                -6.422527e-04 3 1  ON 38
ci_40                -1.673120e-03 3 1  ON 39
ci_41                -1.413581e-03 3 1  ON 40
ci_42                -1.208530e-03 3 1  ON 41
ci_43                -2.700310e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300618e-04 3 1  ON 44
ci_46                -5.317765e-04 3 1  ON 45
ci_47                 1.304118e-03 3 1  ON 46
ci_48                 8.704690e-04 3 1  ON 47
ci_49                -9.525982e-04 3 1  ON 48
ci_50                -7.380908e-04 3 1  ON 49
ci_51                 3.640956e-04 3 1  ON 50
ci_52                 3.764097e-04 3 1  ON 51
ci_53                -6.473191e-04 3 1  ON 52
ci_54                -9.086549e-04 3 1  ON 53
ci_55                -6.740919e-04 3 1  ON 54
ci_56                 1.893490e-03 3 1  ON 55
ci_57                 1.812212e-03 3 1  ON 56
ci_58                -8.217781e-04 3 1  ON 57
ci_59                -9.599703e-04 3 1  ON 58
ci_60                 6.219833e-04 3 1  ON 59
ci_61                 5.642797e-04 3 1  ON 60
ci_62                -3.000529e-04 3 1  ON 61
ci_63                -5.128102e-04 3 1  ON 62
ci_64                -4.067351e-04 3 1  ON 63
ci_65                -3.135718e-04 3 1  ON 64
ci_66                -6.969392e-04 3 1  ON 65
ci_67                -5.894714e-04 3 1  ON 66
ci_68                -6.488117e-04 3 1  ON 67
ci_69                -1.883399e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5287e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7436
    reference variance = 0.372638
====================================================
  Execution time = 2.6016e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5320e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4795e-01
  Total weights = 1.964111432e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435873515426
                                         uncertainty =       0.002851892243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435873515426
                                         uncertainty =       0.002851892243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466772780
  error estimate for blocks of size 2^( 2) =       0.000491736257
  error estimate for blocks of size 2^( 3) =       0.000515430957
  error estimate for blocks of size 2^( 4) =       0.000534202945
  error estimate for blocks of size 2^( 5) =       0.000545553984
  error estimate for blocks of size 2^( 6) =       0.000551364882
  error estimate for blocks of size 2^( 7) =       0.000553502912

      target function =      -0.747043190964
              le_mean =     -22.814455428254
             les_mean =     520.947325688485
             stat err =       0.000546156181
             autocorr =       1.369060567331
   target nu stat err =       0.000546156181
   target dn stat err =       0.003380533877
      target stat err =       0.002871683152
              std dev =       0.660116395798
             le_variance =       0.435753656002


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281445542825e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747053398891       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747070369908       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747072249339       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747072512328       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747072601413       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747072620910       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747072615685       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747072615493       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747072618239       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747072619528       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.007510e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747053398891       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747057754176       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747058230940       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747058296612       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747058318792       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747058323538       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747058322224       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747058322163       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747058322814       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747058323128       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 2.548494e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747053398891       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747054494980       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747054614607       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747054631018       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747054636557       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747054637735       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747054637406       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747054637390       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747054637551       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747054637629       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 6.390063e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300934 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0534e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_01                 1.311434e-01 3 1  ON 0
ci_02                -3.106933e-02 3 1  ON 1
ci_03                -3.097320e-02 3 1  ON 2
ci_04                 2.777024e-02 3 1  ON 3
ci_05                -2.306153e-02 3 1  ON 4
ci_06                -2.274623e-02 3 1  ON 5
ci_07                 2.693500e-02 3 1  ON 6
ci_08                -6.335076e-03 3 1  ON 7
ci_09                -9.226821e-03 3 1  ON 8
ci_10                -9.219655e-03 3 1  ON 9
ci_11                 1.299618e-02 3 1  ON 10
ci_12                 7.620819e-03 3 1  ON 11
ci_13                 1.265370e-02 3 1  ON 12
ci_14                 1.312156e-02 3 1  ON 13
ci_15                 7.059197e-03 3 1  ON 14
ci_16                 7.299527e-03 3 1  ON 15
ci_17                -7.479689e-03 3 1  ON 16
ci_18                -7.180663e-03 3 1  ON 17
ci_19                 9.319632e-03 3 1  ON 18
ci_20                 6.837357e-03 3 1  ON 19
ci_21                 8.770574e-03 3 1  ON 20
ci_22                 8.775392e-03 3 1  ON 21
ci_23                 4.995845e-03 3 1  ON 22
ci_24                 4.387453e-03 3 1  ON 23
ci_25                 3.107154e-03 3 1  ON 24
ci_26                 3.144074e-03 3 1  ON 25
ci_27                 3.326552e-03 3 1  ON 26
ci_28                 2.500949e-03 3 1  ON 27
ci_29                 2.129321e-03 3 1  ON 28
ci_30                -1.587218e-03 3 1  ON 29
ci_31                -1.612213e-03 3 1  ON 30
ci_32                -1.320387e-03 3 1  ON 31
ci_33                -1.026173e-03 3 1  ON 32
ci_34                 1.485364e-03 3 1  ON 33
ci_35                 1.220334e-03 3 1  ON 34
ci_36                -1.122969e-03 3 1  ON 35
ci_37                -1.122279e-03 3 1  ON 36
ci_38                -5.276228e-04 3 1  ON 37
ci_39                -6.402838e-04 3 1  ON 38
ci_40                -1.662460e-03 3 1  ON 39
ci_41                -1.394905e-03 3 1  ON 40
ci_42                -1.227431e-03 3 1  ON 41
ci_43                -2.677203e-03 3 1  ON 42
ci_44                -1.752942e-03 3 1  ON 43
ci_45                -6.285576e-04 3 1  ON 44
ci_46                -5.203813e-04 3 1  ON 45
ci_47                 1.309649e-03 3 1  ON 46
ci_48                 8.734381e-04 3 1  ON 47
ci_49                -9.559627e-04 3 1  ON 48
ci_50                -7.365559e-04 3 1  ON 49
ci_51                 3.696608e-04 3 1  ON 50
ci_52                 3.799546e-04 3 1  ON 51
ci_53                -6.452723e-04 3 1  ON 52
ci_54                -9.136107e-04 3 1  ON 53
ci_55                -6.865220e-04 3 1  ON 54
ci_56                 1.875487e-03 3 1  ON 55
ci_57                 1.810305e-03 3 1  ON 56
ci_58                -8.084391e-04 3 1  ON 57
ci_59                -9.705645e-04 3 1  ON 58
ci_60                 6.234185e-04 3 1  ON 59
ci_61                 5.660663e-04 3 1  ON 60
ci_62                -2.953824e-04 3 1  ON 61
ci_63                -5.054755e-04 3 1  ON 62
ci_64                -4.070614e-04 3 1  ON 63
ci_65                -3.307909e-04 3 1  ON 64
ci_66                -6.966687e-04 3 1  ON 65
ci_67                -5.822436e-04 3 1  ON 66
ci_68                -6.451223e-04 3 1  ON 67
ci_69                -1.916027e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7899
    reference variance = 0.274267
====================================================
  Execution time = 2.5264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4566e-01
  Total weights = 1.9643e+06
  Execution time = 3.4936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434435464436
                                         uncertainty =       0.002257747825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434435464436
                                         uncertainty =       0.002257747825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466055978
  error estimate for blocks of size 2^( 2) =       0.000491105501
  error estimate for blocks of size 2^( 3) =       0.000515057086
  error estimate for blocks of size 2^( 4) =       0.000532155818
  error estimate for blocks of size 2^( 5) =       0.000543416464
  error estimate for blocks of size 2^( 6) =       0.000549440014
  error estimate for blocks of size 2^( 7) =       0.000553376563

      target function =      -0.748945413862
              le_mean =     -22.815716987198
             les_mean =     521.002618383445
             stat err =       0.000544597215
             autocorr =       1.365446428959
   target nu stat err =       0.000544597215
   target dn stat err =       0.002983880857
      target stat err =       0.002567778762
              std dev =       0.659102684799
             le_variance =       0.434416349109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434451424790
                                         uncertainty =       0.002265305863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434451424790
                                         uncertainty =       0.002265305863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466064477
  error estimate for blocks of size 2^( 2) =       0.000491115901
  error estimate for blocks of size 2^( 3) =       0.000515069351
  error estimate for blocks of size 2^( 4) =       0.000532170022
  error estimate for blocks of size 2^( 5) =       0.000543431018
  error estimate for blocks of size 2^( 6) =       0.000549455595
  error estimate for blocks of size 2^( 7) =       0.000553386329

      target function =      -0.748784931848
              le_mean =     -22.815717996424
             les_mean =     521.002856340920
             stat err =       0.000544610741
             autocorr =       1.365464455669
   target nu stat err =       0.000544610741
   target dn stat err =       0.002997029780
      target stat err =       0.002577394582
              std dev =       0.659114704069
             le_variance =       0.434432193119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434443152797
                                         uncertainty =       0.002261523973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434443152797
                                         uncertainty =       0.002261523973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466060071
  error estimate for blocks of size 2^( 2) =       0.000491110556
  error estimate for blocks of size 2^( 3) =       0.000515063098
  error estimate for blocks of size 2^( 4) =       0.000532162812
  error estimate for blocks of size 2^( 5) =       0.000543423723
  error estimate for blocks of size 2^( 6) =       0.000549447767
  error estimate for blocks of size 2^( 7) =       0.000553381304

      target function =      -0.747777255613
              le_mean =     -22.815717421251
             les_mean =     521.004036328294
             stat err =       0.000544603901
             autocorr =       1.365455978085
   target nu stat err =       0.000544603901
   target dn stat err =       0.003166011414
      target stat err =       0.002707717929
              std dev =       0.659108472717
             le_variance =       0.434423978807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434436368859
                                         uncertainty =       0.002258211517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434436368859
                                         uncertainty =       0.002258211517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466056459
  error estimate for blocks of size 2^( 2) =       0.000491106103
  error estimate for blocks of size 2^( 3) =       0.000515057807
  error estimate for blocks of size 2^( 4) =       0.000532156668
  error estimate for blocks of size 2^( 5) =       0.000543417338
  error estimate for blocks of size 2^( 6) =       0.000549440958
  error estimate for blocks of size 2^( 7) =       0.000553377124

      target function =      -0.748931115068
              le_mean =     -22.815717034749
             les_mean =     521.002637652359
             stat err =       0.000544598022
             autocorr =       1.365447657179
   target nu stat err =       0.000544598022
   target dn stat err =       0.002984459738
      target stat err =       0.002568154085
              std dev =       0.659103365387
             le_variance =       0.434417246264


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748945413862        initial  <--
     1.4901e+00     1.4901e+01             1.0075e-04        -0.748784931848
     5.9605e+00     5.9605e+01             2.5485e-05        -0.747777255613
     2.3842e+01     2.3842e+02             6.3901e-06        -0.748931115068

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8483
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_01                 1.311689e-01 3 1  ON 0
ci_02                -3.109421e-02 3 1  ON 1
ci_03                -3.098725e-02 3 1  ON 2
ci_04                 2.777622e-02 3 1  ON 3
ci_05                -2.306567e-02 3 1  ON 4
ci_06                -2.274490e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354174e-03 3 1  ON 7
ci_09                -9.236166e-03 3 1  ON 8
ci_10                -9.226452e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627898e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058114e-03 3 1  ON 14
ci_16                 7.299942e-03 3 1  ON 15
ci_17                -7.468966e-03 3 1  ON 16
ci_18                -7.185615e-03 3 1  ON 17
ci_19                 9.309459e-03 3 1  ON 18
ci_20                 6.818793e-03 3 1  ON 19
ci_21                 8.774061e-03 3 1  ON 20
ci_22                 8.773342e-03 3 1  ON 21
ci_23                 4.977846e-03 3 1  ON 22
ci_24                 4.388757e-03 3 1  ON 23
ci_25                 3.124213e-03 3 1  ON 24
ci_26                 3.150441e-03 3 1  ON 25
ci_27                 3.326767e-03 3 1  ON 26
ci_28                 2.505842e-03 3 1  ON 27
ci_29                 2.138174e-03 3 1  ON 28
ci_30                -1.586275e-03 3 1  ON 29
ci_31                -1.612308e-03 3 1  ON 30
ci_32                -1.313340e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461966e-03 3 1  ON 33
ci_35                 1.221732e-03 3 1  ON 34
ci_36                -1.116942e-03 3 1  ON 35
ci_37                -1.122367e-03 3 1  ON 36
ci_38                -5.287665e-04 3 1  ON 37
ci_39                -6.422527e-04 3 1  ON 38
ci_40                -1.673120e-03 3 1  ON 39
ci_41                -1.413581e-03 3 1  ON 40
ci_42                -1.208530e-03 3 1  ON 41
ci_43                -2.700310e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300618e-04 3 1  ON 44
ci_46                -5.317765e-04 3 1  ON 45
ci_47                 1.304118e-03 3 1  ON 46
ci_48                 8.704690e-04 3 1  ON 47
ci_49                -9.525982e-04 3 1  ON 48
ci_50                -7.380908e-04 3 1  ON 49
ci_51                 3.640956e-04 3 1  ON 50
ci_52                 3.764097e-04 3 1  ON 51
ci_53                -6.473191e-04 3 1  ON 52
ci_54                -9.086549e-04 3 1  ON 53
ci_55                -6.740919e-04 3 1  ON 54
ci_56                 1.893490e-03 3 1  ON 55
ci_57                 1.812212e-03 3 1  ON 56
ci_58                -8.217781e-04 3 1  ON 57
ci_59                -9.599703e-04 3 1  ON 58
ci_60                 6.219833e-04 3 1  ON 59
ci_61                 5.642797e-04 3 1  ON 60
ci_62                -3.000529e-04 3 1  ON 61
ci_63                -5.128102e-04 3 1  ON 62
ci_64                -4.067351e-04 3 1  ON 63
ci_65                -3.135718e-04 3 1  ON 64
ci_66                -6.969392e-04 3 1  ON 65
ci_67                -5.894714e-04 3 1  ON 66
ci_68                -6.488117e-04 3 1  ON 67
ci_69                -1.883399e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3415e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.792
    reference variance = 2.19045
====================================================
  Execution time = 2.5927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6004e-01
  Total weights = 1.964271108e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5599e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445275758898
                                         uncertainty =       0.005150002522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445275758898
                                         uncertainty =       0.005150002522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471812061
  error estimate for blocks of size 2^( 2) =       0.000496770026
  error estimate for blocks of size 2^( 3) =       0.000520097899
  error estimate for blocks of size 2^( 4) =       0.000537794847
  error estimate for blocks of size 2^( 5) =       0.000549759707
  error estimate for blocks of size 2^( 6) =       0.000555915179
  error estimate for blocks of size 2^( 7) =       0.000557650828

      target function =      -0.737096698851
              le_mean =     -22.814876225004
             les_mean =     520.978616691287
             stat err =       0.000550280140
             autocorr =       1.360284037164
   target nu stat err =       0.000550280140
   target dn stat err =       0.007346220355
      target stat err =       0.005972713882
              std dev =       0.667243015233
             le_variance =       0.445213241378


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281487622500e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737143661991       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737145481566       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737145755661       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737145771959       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737145772127       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737145773309       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737145772132       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737145772466       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737145773037       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+01 is 2.400415e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737143661991       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737144117956       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737144186554       residual = 7.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737144190621       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737144190660       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737144190953       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737144190659       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737144190743       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737144190885       residual = 7.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+01 is 6.013625e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737143661991       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737143776049       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737143793203       residual = 7.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737143794219       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737143794229       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737143794303       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737143794229       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737143794250       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737143794285       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+02 is 1.504195e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.303951 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0495e+01
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_01                 1.311644e-01 3 1  ON 0
ci_02                -3.108819e-02 3 1  ON 1
ci_03                -3.098369e-02 3 1  ON 2
ci_04                 2.777392e-02 3 1  ON 3
ci_05                -2.306437e-02 3 1  ON 4
ci_06                -2.274860e-02 3 1  ON 5
ci_07                 2.694766e-02 3 1  ON 6
ci_08                -6.352679e-03 3 1  ON 7
ci_09                -9.235853e-03 3 1  ON 8
ci_10                -9.227196e-03 3 1  ON 9
ci_11                 1.301274e-02 3 1  ON 10
ci_12                 7.626507e-03 3 1  ON 11
ci_13                 1.265492e-02 3 1  ON 12
ci_14                 1.311659e-02 3 1  ON 13
ci_15                 7.058430e-03 3 1  ON 14
ci_16                 7.299009e-03 3 1  ON 15
ci_17                -7.467774e-03 3 1  ON 16
ci_18                -7.188186e-03 3 1  ON 17
ci_19                 9.309110e-03 3 1  ON 18
ci_20                 6.817551e-03 3 1  ON 19
ci_21                 8.773739e-03 3 1  ON 20
ci_22                 8.773861e-03 3 1  ON 21
ci_23                 4.977154e-03 3 1  ON 22
ci_24                 4.388401e-03 3 1  ON 23
ci_25                 3.124256e-03 3 1  ON 24
ci_26                 3.150527e-03 3 1  ON 25
ci_27                 3.326091e-03 3 1  ON 26
ci_28                 2.506654e-03 3 1  ON 27
ci_29                 2.137637e-03 3 1  ON 28
ci_30                -1.585448e-03 3 1  ON 29
ci_31                -1.612295e-03 3 1  ON 30
ci_32                -1.313669e-03 3 1  ON 31
ci_33                -1.024161e-03 3 1  ON 32
ci_34                 1.462316e-03 3 1  ON 33
ci_35                 1.222646e-03 3 1  ON 34
ci_36                -1.117734e-03 3 1  ON 35
ci_37                -1.121238e-03 3 1  ON 36
ci_38                -5.289471e-04 3 1  ON 37
ci_39                -6.415709e-04 3 1  ON 38
ci_40                -1.673458e-03 3 1  ON 39
ci_41                -1.413991e-03 3 1  ON 40
ci_42                -1.209385e-03 3 1  ON 41
ci_43                -2.700617e-03 3 1  ON 42
ci_44                -1.765450e-03 3 1  ON 43
ci_45                -6.299403e-04 3 1  ON 44
ci_46                -5.317015e-04 3 1  ON 45
ci_47                 1.302634e-03 3 1  ON 46
ci_48                 8.718427e-04 3 1  ON 47
ci_49                -9.521134e-04 3 1  ON 48
ci_50                -7.378072e-04 3 1  ON 49
ci_51                 3.636791e-04 3 1  ON 50
ci_52                 3.759549e-04 3 1  ON 51
ci_53                -6.478463e-04 3 1  ON 52
ci_54                -9.081449e-04 3 1  ON 53
ci_55                -6.744221e-04 3 1  ON 54
ci_56                 1.893559e-03 3 1  ON 55
ci_57                 1.811236e-03 3 1  ON 56
ci_58                -8.229678e-04 3 1  ON 57
ci_59                -9.595074e-04 3 1  ON 58
ci_60                 6.216339e-04 3 1  ON 59
ci_61                 5.633759e-04 3 1  ON 60
ci_62                -2.999629e-04 3 1  ON 61
ci_63                -5.124299e-04 3 1  ON 62
ci_64                -4.065325e-04 3 1  ON 63
ci_65                -3.138213e-04 3 1  ON 64
ci_66                -6.959618e-04 3 1  ON 65
ci_67                -5.892440e-04 3 1  ON 66
ci_68                -6.496529e-04 3 1  ON 67
ci_69                -1.878481e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.8383
    reference variance = 0.370883
====================================================
  Execution time = 2.5161e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4540e-01
  Total weights = 1.9642e+06
  Execution time = 3.5265e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434751554847
                                         uncertainty =       0.002217664593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434751554847
                                         uncertainty =       0.002217664593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466276490
  error estimate for blocks of size 2^( 2) =       0.000491595840
  error estimate for blocks of size 2^( 3) =       0.000515164598
  error estimate for blocks of size 2^( 4) =       0.000532876053
  error estimate for blocks of size 2^( 5) =       0.000545302506
  error estimate for blocks of size 2^( 6) =       0.000549642904
  error estimate for blocks of size 2^( 7) =       0.000552716255

      target function =      -0.749177943662
              le_mean =     -22.815287522641
             les_mean =     520.982741677170
             stat err =       0.000545134430
             autocorr =       1.366847893317
   target nu stat err =       0.000545134430
   target dn stat err =       0.002762149156
      target stat err =       0.002388122647
              std dev =       0.659414535356
             le_variance =       0.434827529439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434748801502
                                         uncertainty =       0.002217752398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434748801502
                                         uncertainty =       0.002217752398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466275011
  error estimate for blocks of size 2^( 2) =       0.000491595073
  error estimate for blocks of size 2^( 3) =       0.000515164577
  error estimate for blocks of size 2^( 4) =       0.000532876251
  error estimate for blocks of size 2^( 5) =       0.000545303114
  error estimate for blocks of size 2^( 6) =       0.000549643715
  error estimate for blocks of size 2^( 7) =       0.000552717355

      target function =      -0.749159755192
              le_mean =     -22.815287651272
             les_mean =     520.982769291881
             stat err =       0.000545135109
             autocorr =       1.366859965566
   target nu stat err =       0.000545135109
   target dn stat err =       0.002764028360
      target stat err =       0.002389530394
              std dev =       0.659412444830
             le_variance =       0.434824772396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434750171233
                                         uncertainty =       0.002217708562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434750171233
                                         uncertainty =       0.002217708562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466275747
  error estimate for blocks of size 2^( 2) =       0.000491595453
  error estimate for blocks of size 2^( 3) =       0.000515164585
  error estimate for blocks of size 2^( 4) =       0.000532876150
  error estimate for blocks of size 2^( 5) =       0.000545302808
  error estimate for blocks of size 2^( 6) =       0.000549643307
  error estimate for blocks of size 2^( 7) =       0.000552716803

      target function =      -0.749169593314
              le_mean =     -22.815287586014
             les_mean =     520.982754551699
             stat err =       0.000545134767
             autocorr =       1.366853940507
   target nu stat err =       0.000545134767
   target dn stat err =       0.002763072214
      target stat err =       0.002388817741
              std dev =       0.659413484830
             le_variance =       0.434826143976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434751381341
                                         uncertainty =       0.002217670088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434751381341
                                         uncertainty =       0.002217670088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466276396
  error estimate for blocks of size 2^( 2) =       0.000491595791
  error estimate for blocks of size 2^( 3) =       0.000515164596
  error estimate for blocks of size 2^( 4) =       0.000532876065
  error estimate for blocks of size 2^( 5) =       0.000545302543
  error estimate for blocks of size 2^( 6) =       0.000549642954
  error estimate for blocks of size 2^( 7) =       0.000552716324

      target function =      -0.749176949051
              le_mean =     -22.815287530458
             les_mean =     520.982743222873
             stat err =       0.000545134471
             autocorr =       1.366848649535
   target nu stat err =       0.000545134471
   target dn stat err =       0.002762262649
      target stat err =       0.002388208310
              std dev =       0.659414403621
             le_variance =       0.434827355702


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749177943662        initial  <--
     1.4901e+01     1.4901e+02             2.4004e-05        -0.749159755192
     5.9605e+01     5.9605e+02             6.0136e-06        -0.749169593314
     2.3842e+02     2.3842e+03             1.5042e-06        -0.749176949051

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7896
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_01                 1.311689e-01 3 1  ON 0
ci_02                -3.109421e-02 3 1  ON 1
ci_03                -3.098725e-02 3 1  ON 2
ci_04                 2.777622e-02 3 1  ON 3
ci_05                -2.306567e-02 3 1  ON 4
ci_06                -2.274490e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354174e-03 3 1  ON 7
ci_09                -9.236166e-03 3 1  ON 8
ci_10                -9.226452e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627898e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058114e-03 3 1  ON 14
ci_16                 7.299942e-03 3 1  ON 15
ci_17                -7.468966e-03 3 1  ON 16
ci_18                -7.185615e-03 3 1  ON 17
ci_19                 9.309459e-03 3 1  ON 18
ci_20                 6.818793e-03 3 1  ON 19
ci_21                 8.774061e-03 3 1  ON 20
ci_22                 8.773342e-03 3 1  ON 21
ci_23                 4.977846e-03 3 1  ON 22
ci_24                 4.388757e-03 3 1  ON 23
ci_25                 3.124213e-03 3 1  ON 24
ci_26                 3.150441e-03 3 1  ON 25
ci_27                 3.326767e-03 3 1  ON 26
ci_28                 2.505842e-03 3 1  ON 27
ci_29                 2.138174e-03 3 1  ON 28
ci_30                -1.586275e-03 3 1  ON 29
ci_31                -1.612308e-03 3 1  ON 30
ci_32                -1.313340e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461966e-03 3 1  ON 33
ci_35                 1.221732e-03 3 1  ON 34
ci_36                -1.116942e-03 3 1  ON 35
ci_37                -1.122367e-03 3 1  ON 36
ci_38                -5.287665e-04 3 1  ON 37
ci_39                -6.422527e-04 3 1  ON 38
ci_40                -1.673120e-03 3 1  ON 39
ci_41                -1.413581e-03 3 1  ON 40
ci_42                -1.208530e-03 3 1  ON 41
ci_43                -2.700310e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300618e-04 3 1  ON 44
ci_46                -5.317765e-04 3 1  ON 45
ci_47                 1.304118e-03 3 1  ON 46
ci_48                 8.704690e-04 3 1  ON 47
ci_49                -9.525982e-04 3 1  ON 48
ci_50                -7.380908e-04 3 1  ON 49
ci_51                 3.640956e-04 3 1  ON 50
ci_52                 3.764097e-04 3 1  ON 51
ci_53                -6.473191e-04 3 1  ON 52
ci_54                -9.086549e-04 3 1  ON 53
ci_55                -6.740919e-04 3 1  ON 54
ci_56                 1.893490e-03 3 1  ON 55
ci_57                 1.812212e-03 3 1  ON 56
ci_58                -8.217781e-04 3 1  ON 57
ci_59                -9.599703e-04 3 1  ON 58
ci_60                 6.219833e-04 3 1  ON 59
ci_61                 5.642797e-04 3 1  ON 60
ci_62                -3.000529e-04 3 1  ON 61
ci_63                -5.128102e-04 3 1  ON 62
ci_64                -4.067351e-04 3 1  ON 63
ci_65                -3.135718e-04 3 1  ON 64
ci_66                -6.969392e-04 3 1  ON 65
ci_67                -5.894714e-04 3 1  ON 66
ci_68                -6.488117e-04 3 1  ON 67
ci_69                -1.883399e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3305e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.8849
    reference variance = 0.379373
====================================================
  Execution time = 2.5909e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5296e-01
  Total weights = 1.964277855e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438695409180
                                         uncertainty =       0.002407180664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438695409180
                                         uncertainty =       0.002407180664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468314413
  error estimate for blocks of size 2^( 2) =       0.000493563178
  error estimate for blocks of size 2^( 3) =       0.000516722446
  error estimate for blocks of size 2^( 4) =       0.000534881235
  error estimate for blocks of size 2^( 5) =       0.000546118608
  error estimate for blocks of size 2^( 6) =       0.000550667477
  error estimate for blocks of size 2^( 7) =       0.000554021302

      target function =      -0.742900471767
              le_mean =     -22.815895475880
             les_mean =     521.018051274650
             stat err =       0.000546422156
             autocorr =       1.361386854572
   target nu stat err =       0.000546422156
   target dn stat err =       0.002995238012
      target stat err =       0.002537882644
              std dev =       0.662296593993
             le_variance =       0.438636778414


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281589547588e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742908209050       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742908318746       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742908339732       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742908344539       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742908344740       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742908345613       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742908345565       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742908345607       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742908345604       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.515393e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742908209050       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742908236481       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742908241728       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742908242930       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742908242980       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742908243199       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742908243186       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742908243197       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742908243195       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 3.789308e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742908209050       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742908215908       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742908217220       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742908217518       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742908217533       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742908217593       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742908217582       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742908217589       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742908217584       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 9.473786e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306977 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0447e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_01                 1.311686e-01 3 1  ON 0
ci_02                -3.109403e-02 3 1  ON 1
ci_03                -3.098698e-02 3 1  ON 2
ci_04                 2.777599e-02 3 1  ON 3
ci_05                -2.306529e-02 3 1  ON 4
ci_06                -2.274477e-02 3 1  ON 5
ci_07                 2.694786e-02 3 1  ON 6
ci_08                -6.354067e-03 3 1  ON 7
ci_09                -9.236144e-03 3 1  ON 8
ci_10                -9.226266e-03 3 1  ON 9
ci_11                 1.301196e-02 3 1  ON 10
ci_12                 7.627876e-03 3 1  ON 11
ci_13                 1.265617e-02 3 1  ON 12
ci_14                 1.311565e-02 3 1  ON 13
ci_15                 7.058135e-03 3 1  ON 14
ci_16                 7.299903e-03 3 1  ON 15
ci_17                -7.468697e-03 3 1  ON 16
ci_18                -7.185594e-03 3 1  ON 17
ci_19                 9.309430e-03 3 1  ON 18
ci_20                 6.818825e-03 3 1  ON 19
ci_21                 8.774030e-03 3 1  ON 20
ci_22                 8.773398e-03 3 1  ON 21
ci_23                 4.977833e-03 3 1  ON 22
ci_24                 4.388645e-03 3 1  ON 23
ci_25                 3.124261e-03 3 1  ON 24
ci_26                 3.150431e-03 3 1  ON 25
ci_27                 3.326743e-03 3 1  ON 26
ci_28                 2.505843e-03 3 1  ON 27
ci_29                 2.138231e-03 3 1  ON 28
ci_30                -1.586246e-03 3 1  ON 29
ci_31                -1.612259e-03 3 1  ON 30
ci_32                -1.313308e-03 3 1  ON 31
ci_33                -1.023840e-03 3 1  ON 32
ci_34                 1.461947e-03 3 1  ON 33
ci_35                 1.221681e-03 3 1  ON 34
ci_36                -1.116952e-03 3 1  ON 35
ci_37                -1.122326e-03 3 1  ON 36
ci_38                -5.287803e-04 3 1  ON 37
ci_39                -6.421935e-04 3 1  ON 38
ci_40                -1.673132e-03 3 1  ON 39
ci_41                -1.413517e-03 3 1  ON 40
ci_42                -1.208556e-03 3 1  ON 41
ci_43                -2.700282e-03 3 1  ON 42
ci_44                -1.763866e-03 3 1  ON 43
ci_45                -6.300538e-04 3 1  ON 44
ci_46                -5.316609e-04 3 1  ON 45
ci_47                 1.304138e-03 3 1  ON 46
ci_48                 8.705344e-04 3 1  ON 47
ci_49                -9.526211e-04 3 1  ON 48
ci_50                -7.381333e-04 3 1  ON 49
ci_51                 3.640633e-04 3 1  ON 50
ci_52                 3.765126e-04 3 1  ON 51
ci_53                -6.472316e-04 3 1  ON 52
ci_54                -9.086326e-04 3 1  ON 53
ci_55                -6.741091e-04 3 1  ON 54
ci_56                 1.893473e-03 3 1  ON 55
ci_57                 1.812149e-03 3 1  ON 56
ci_58                -8.217350e-04 3 1  ON 57
ci_59                -9.599122e-04 3 1  ON 58
ci_60                 6.218429e-04 3 1  ON 59
ci_61                 5.642145e-04 3 1  ON 60
ci_62                -3.000772e-04 3 1  ON 61
ci_63                -5.128041e-04 3 1  ON 62
ci_64                -4.067259e-04 3 1  ON 63
ci_65                -3.134558e-04 3 1  ON 64
ci_66                -6.969318e-04 3 1  ON 65
ci_67                -5.894606e-04 3 1  ON 66
ci_68                -6.487744e-04 3 1  ON 67
ci_69                -1.883866e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.9255
    reference variance = 0.349209
====================================================
  Execution time = 2.5113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5300e-01
  Total weights = 1.9642e+06
  Execution time = 3.5109e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435195155496
                                         uncertainty =       0.001905194370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435195155496
                                         uncertainty =       0.001905194370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466550220
  error estimate for blocks of size 2^( 2) =       0.000492059193
  error estimate for blocks of size 2^( 3) =       0.000516001152
  error estimate for blocks of size 2^( 4) =       0.000533317341
  error estimate for blocks of size 2^( 5) =       0.000544252949
  error estimate for blocks of size 2^( 6) =       0.000550179685
  error estimate for blocks of size 2^( 7) =       0.000553331772

      target function =      -0.742874653732
              le_mean =     -22.814678838930
             les_mean =     520.962566330498
             stat err =       0.000545270437
             autocorr =       1.365925794041
   target nu stat err =       0.000545270437
   target dn stat err =       0.003654261317
      target stat err =       0.003061249575
              std dev =       0.659801649178
             le_variance =       0.435338216258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435194863793
                                         uncertainty =       0.001905175559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435194863793
                                         uncertainty =       0.001905175559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466550065
  error estimate for blocks of size 2^( 2) =       0.000492059120
  error estimate for blocks of size 2^( 3) =       0.000516001162
  error estimate for blocks of size 2^( 4) =       0.000533317399
  error estimate for blocks of size 2^( 5) =       0.000544253034
  error estimate for blocks of size 2^( 6) =       0.000550179760
  error estimate for blocks of size 2^( 7) =       0.000553331892

      target function =      -0.742870759133
              le_mean =     -22.814678825724
             les_mean =     520.962570450407
             stat err =       0.000545270521
             autocorr =       1.365927126152
   target nu stat err =       0.000545270521
   target dn stat err =       0.003656691726
      target stat err =       0.003063175173
              std dev =       0.659801429705
             le_variance =       0.435337926641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435195009576
                                         uncertainty =       0.001905184962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435195009576
                                         uncertainty =       0.001905184962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466550143
  error estimate for blocks of size 2^( 2) =       0.000492059156
  error estimate for blocks of size 2^( 3) =       0.000516001157
  error estimate for blocks of size 2^( 4) =       0.000533317370
  error estimate for blocks of size 2^( 5) =       0.000544252992
  error estimate for blocks of size 2^( 6) =       0.000550179723
  error estimate for blocks of size 2^( 7) =       0.000553331832

      target function =      -0.742872723390
              le_mean =     -22.814678832321
             les_mean =     520.962568369551
             stat err =       0.000545270479
             autocorr =       1.365926460275
   target nu stat err =       0.000545270479
   target dn stat err =       0.003655475636
      target stat err =       0.003062211797
              std dev =       0.659801539389
             le_variance =       0.435338071380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435195137251
                                         uncertainty =       0.001905193194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435195137251
                                         uncertainty =       0.001905193194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466550211
  error estimate for blocks of size 2^( 2) =       0.000492059188
  error estimate for blocks of size 2^( 3) =       0.000516001153
  error estimate for blocks of size 2^( 4) =       0.000533317345
  error estimate for blocks of size 2^( 5) =       0.000544252954
  error estimate for blocks of size 2^( 6) =       0.000550179690
  error estimate for blocks of size 2^( 7) =       0.000553331780

      target function =      -0.742874414651
              le_mean =     -22.814678838104
             les_mean =     520.962566582665
             stat err =       0.000545270442
             autocorr =       1.365925877326
   target nu stat err =       0.000545270442
   target dn stat err =       0.003654412990
      target stat err =       0.003061369776
              std dev =       0.659801635451
             le_variance =       0.435338198143


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742874653732        initial  <--
     1.4901e+02     1.4901e+03             1.5154e-06        -0.742870759133
     5.9605e+02     5.9605e+03             3.7893e-07        -0.742872723390
     2.3842e+03     2.3842e+04             9.4738e-08        -0.742874414651

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7633
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_01                 1.311689e-01 3 1  ON 0
ci_02                -3.109421e-02 3 1  ON 1
ci_03                -3.098725e-02 3 1  ON 2
ci_04                 2.777622e-02 3 1  ON 3
ci_05                -2.306567e-02 3 1  ON 4
ci_06                -2.274490e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354174e-03 3 1  ON 7
ci_09                -9.236166e-03 3 1  ON 8
ci_10                -9.226452e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627898e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058114e-03 3 1  ON 14
ci_16                 7.299942e-03 3 1  ON 15
ci_17                -7.468966e-03 3 1  ON 16
ci_18                -7.185615e-03 3 1  ON 17
ci_19                 9.309459e-03 3 1  ON 18
ci_20                 6.818793e-03 3 1  ON 19
ci_21                 8.774061e-03 3 1  ON 20
ci_22                 8.773342e-03 3 1  ON 21
ci_23                 4.977846e-03 3 1  ON 22
ci_24                 4.388757e-03 3 1  ON 23
ci_25                 3.124213e-03 3 1  ON 24
ci_26                 3.150441e-03 3 1  ON 25
ci_27                 3.326767e-03 3 1  ON 26
ci_28                 2.505842e-03 3 1  ON 27
ci_29                 2.138174e-03 3 1  ON 28
ci_30                -1.586275e-03 3 1  ON 29
ci_31                -1.612308e-03 3 1  ON 30
ci_32                -1.313340e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461966e-03 3 1  ON 33
ci_35                 1.221732e-03 3 1  ON 34
ci_36                -1.116942e-03 3 1  ON 35
ci_37                -1.122367e-03 3 1  ON 36
ci_38                -5.287665e-04 3 1  ON 37
ci_39                -6.422527e-04 3 1  ON 38
ci_40                -1.673120e-03 3 1  ON 39
ci_41                -1.413581e-03 3 1  ON 40
ci_42                -1.208530e-03 3 1  ON 41
ci_43                -2.700310e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300618e-04 3 1  ON 44
ci_46                -5.317765e-04 3 1  ON 45
ci_47                 1.304118e-03 3 1  ON 46
ci_48                 8.704690e-04 3 1  ON 47
ci_49                -9.525982e-04 3 1  ON 48
ci_50                -7.380908e-04 3 1  ON 49
ci_51                 3.640956e-04 3 1  ON 50
ci_52                 3.764097e-04 3 1  ON 51
ci_53                -6.473191e-04 3 1  ON 52
ci_54                -9.086549e-04 3 1  ON 53
ci_55                -6.740919e-04 3 1  ON 54
ci_56                 1.893490e-03 3 1  ON 55
ci_57                 1.812212e-03 3 1  ON 56
ci_58                -8.217781e-04 3 1  ON 57
ci_59                -9.599703e-04 3 1  ON 58
ci_60                 6.219833e-04 3 1  ON 59
ci_61                 5.642797e-04 3 1  ON 60
ci_62                -3.000529e-04 3 1  ON 61
ci_63                -5.128102e-04 3 1  ON 62
ci_64                -4.067351e-04 3 1  ON 63
ci_65                -3.135718e-04 3 1  ON 64
ci_66                -6.969392e-04 3 1  ON 65
ci_67                -5.894714e-04 3 1  ON 66
ci_68                -6.488117e-04 3 1  ON 67
ci_69                -1.883399e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3216e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.832
    reference variance = 0.336811
====================================================
  Execution time = 2.7741e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6699e-01
  Total weights = 1.964124843e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450103004692
                                         uncertainty =       0.011940653324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450103004692
                                         uncertainty =       0.011940653324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474366886
  error estimate for blocks of size 2^( 2) =       0.000499714273
  error estimate for blocks of size 2^( 3) =       0.000522689803
  error estimate for blocks of size 2^( 4) =       0.000539406829
  error estimate for blocks of size 2^( 5) =       0.000549595014
  error estimate for blocks of size 2^( 6) =       0.000555804349
  error estimate for blocks of size 2^( 7) =       0.000558903640

      target function =      -0.731316942825
              le_mean =     -22.815480947025
             les_mean =     521.013165666374
             stat err =       0.000550927458
             autocorr =       1.348838974293
   target nu stat err =       0.000550927458
   target dn stat err =       0.016386020261
      target stat err =       0.013075909544
              std dev =       0.670856083905
             le_variance =       0.450047885312


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281548094702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.731548406971       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.731548418312       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.731548420406       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.731548420709       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.731548420766       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.731548420789       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.731548420806       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.731548420811       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.731548420813       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.731548420814       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+03 is 1.247171e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.731548406971       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.731548409806       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.731548410330       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.731548410406       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.731548410420       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.731548410431       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.731548410418       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.731548410433       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.731548410431       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.731548410437       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+03 is 3.117991e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.731548406971       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.731548407680       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.731548407811       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.731548407830       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.731548407825       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.731548407808       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.731548407852       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.731548407836       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.731548407836       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.731548407887       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+04 is 7.795019e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310474 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2270e+01
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_01                 1.311689e-01 3 1  ON 0
ci_02                -3.109420e-02 3 1  ON 1
ci_03                -3.098721e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306564e-02 3 1  ON 4
ci_06                -2.274490e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354176e-03 3 1  ON 7
ci_09                -9.236151e-03 3 1  ON 8
ci_10                -9.226457e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627890e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058104e-03 3 1  ON 14
ci_16                 7.299933e-03 3 1  ON 15
ci_17                -7.468965e-03 3 1  ON 16
ci_18                -7.185605e-03 3 1  ON 17
ci_19                 9.309449e-03 3 1  ON 18
ci_20                 6.818788e-03 3 1  ON 19
ci_21                 8.774058e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977849e-03 3 1  ON 22
ci_24                 4.388748e-03 3 1  ON 23
ci_25                 3.124200e-03 3 1  ON 24
ci_26                 3.150442e-03 3 1  ON 25
ci_27                 3.326779e-03 3 1  ON 26
ci_28                 2.505826e-03 3 1  ON 27
ci_29                 2.138171e-03 3 1  ON 28
ci_30                -1.586282e-03 3 1  ON 29
ci_31                -1.612299e-03 3 1  ON 30
ci_32                -1.313328e-03 3 1  ON 31
ci_33                -1.023868e-03 3 1  ON 32
ci_34                 1.461968e-03 3 1  ON 33
ci_35                 1.221722e-03 3 1  ON 34
ci_36                -1.116943e-03 3 1  ON 35
ci_37                -1.122373e-03 3 1  ON 36
ci_38                -5.287714e-04 3 1  ON 37
ci_39                -6.422415e-04 3 1  ON 38
ci_40                -1.673118e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208523e-03 3 1  ON 41
ci_43                -2.700298e-03 3 1  ON 42
ci_44                -1.763820e-03 3 1  ON 43
ci_45                -6.300586e-04 3 1  ON 44
ci_46                -5.317787e-04 3 1  ON 45
ci_47                 1.304128e-03 3 1  ON 46
ci_48                 8.704648e-04 3 1  ON 47
ci_49                -9.526052e-04 3 1  ON 48
ci_50                -7.380898e-04 3 1  ON 49
ci_51                 3.640999e-04 3 1  ON 50
ci_52                 3.764090e-04 3 1  ON 51
ci_53                -6.473128e-04 3 1  ON 52
ci_54                -9.086515e-04 3 1  ON 53
ci_55                -6.740966e-04 3 1  ON 54
ci_56                 1.893493e-03 3 1  ON 55
ci_57                 1.812215e-03 3 1  ON 56
ci_58                -8.217839e-04 3 1  ON 57
ci_59                -9.599662e-04 3 1  ON 58
ci_60                 6.219686e-04 3 1  ON 59
ci_61                 5.642518e-04 3 1  ON 60
ci_62                -3.000578e-04 3 1  ON 61
ci_63                -5.128145e-04 3 1  ON 62
ci_64                -4.067277e-04 3 1  ON 63
ci_65                -3.135784e-04 3 1  ON 64
ci_66                -6.969430e-04 3 1  ON 65
ci_67                -5.894752e-04 3 1  ON 66
ci_68                -6.488064e-04 3 1  ON 67
ci_69                -1.883379e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.8851
    reference variance = 0.407825
====================================================
  Execution time = 2.5218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4559e-01
  Total weights = 1.9644e+06
  Execution time = 3.4982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434672694696
                                         uncertainty =       0.002581232414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434672694696
                                         uncertainty =       0.002581232414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466161796
  error estimate for blocks of size 2^( 2) =       0.000491308171
  error estimate for blocks of size 2^( 3) =       0.000514849434
  error estimate for blocks of size 2^( 4) =       0.000532370155
  error estimate for blocks of size 2^( 5) =       0.000543553408
  error estimate for blocks of size 2^( 6) =       0.000549880430
  error estimate for blocks of size 2^( 7) =       0.000553574100

      target function =      -0.749011673545
              le_mean =     -22.814605038677
             les_mean =     520.951791056737
             stat err =       0.000544844523
             autocorr =       1.366066439877
   target nu stat err =       0.000544844523
   target dn stat err =       0.003121486666
      target stat err =       0.002675787939
              std dev =       0.659252334832
             le_variance =       0.434613640981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434672680235
                                         uncertainty =       0.002581230906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434672680235
                                         uncertainty =       0.002581230906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466161789
  error estimate for blocks of size 2^( 2) =       0.000491308169
  error estimate for blocks of size 2^( 3) =       0.000514849436
  error estimate for blocks of size 2^( 4) =       0.000532370160
  error estimate for blocks of size 2^( 5) =       0.000543553415
  error estimate for blocks of size 2^( 6) =       0.000549880438
  error estimate for blocks of size 2^( 7) =       0.000553574103

      target function =      -0.749011665943
              le_mean =     -22.814605039205
             les_mean =     520.951791089952
             stat err =       0.000544844529
             autocorr =       1.366066514047
   target nu stat err =       0.000544844529
   target dn stat err =       0.003121483973
      target stat err =       0.002675785701
              std dev =       0.659252323701
             le_variance =       0.434613626305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434672687465
                                         uncertainty =       0.002581231660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434672687465
                                         uncertainty =       0.002581231660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466161793
  error estimate for blocks of size 2^( 2) =       0.000491308170
  error estimate for blocks of size 2^( 3) =       0.000514849435
  error estimate for blocks of size 2^( 4) =       0.000532370158
  error estimate for blocks of size 2^( 5) =       0.000543553411
  error estimate for blocks of size 2^( 6) =       0.000549880434
  error estimate for blocks of size 2^( 7) =       0.000553574101

      target function =      -0.749011669753
              le_mean =     -22.814605038941
             les_mean =     520.951791073332
             stat err =       0.000544844526
             autocorr =       1.366066476947
   target nu stat err =       0.000544844526
   target dn stat err =       0.003121485319
      target stat err =       0.002675786820
              std dev =       0.659252329266
             le_variance =       0.434613633643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434672693792
                                         uncertainty =       0.002581232320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434672693792
                                         uncertainty =       0.002581232320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466161796
  error estimate for blocks of size 2^( 2) =       0.000491308171
  error estimate for blocks of size 2^( 3) =       0.000514849434
  error estimate for blocks of size 2^( 4) =       0.000532370156
  error estimate for blocks of size 2^( 5) =       0.000543553408
  error estimate for blocks of size 2^( 6) =       0.000549880431
  error estimate for blocks of size 2^( 7) =       0.000553574100

      target function =      -0.749011673072
              le_mean =     -22.814605038710
             les_mean =     520.951791058810
             stat err =       0.000544844524
             autocorr =       1.366066444506
   target nu stat err =       0.000544844524
   target dn stat err =       0.003121486498
      target stat err =       0.002675787800
              std dev =       0.659252334136
             le_variance =       0.434613640064


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749011673545        initial  <--
     1.4901e+03     1.4901e+04             1.2472e-07        -0.749011665943
     5.9605e+03     5.9605e+04             3.1180e-08        -0.749011669753
     2.3842e+04     2.3842e+05             7.7950e-09        -0.749011673072

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7989
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_01                 1.311689e-01 3 1  ON 0
ci_02                -3.109421e-02 3 1  ON 1
ci_03                -3.098725e-02 3 1  ON 2
ci_04                 2.777622e-02 3 1  ON 3
ci_05                -2.306567e-02 3 1  ON 4
ci_06                -2.274490e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354174e-03 3 1  ON 7
ci_09                -9.236166e-03 3 1  ON 8
ci_10                -9.226452e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627898e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058114e-03 3 1  ON 14
ci_16                 7.299942e-03 3 1  ON 15
ci_17                -7.468966e-03 3 1  ON 16
ci_18                -7.185615e-03 3 1  ON 17
ci_19                 9.309459e-03 3 1  ON 18
ci_20                 6.818793e-03 3 1  ON 19
ci_21                 8.774061e-03 3 1  ON 20
ci_22                 8.773342e-03 3 1  ON 21
ci_23                 4.977846e-03 3 1  ON 22
ci_24                 4.388757e-03 3 1  ON 23
ci_25                 3.124213e-03 3 1  ON 24
ci_26                 3.150441e-03 3 1  ON 25
ci_27                 3.326767e-03 3 1  ON 26
ci_28                 2.505842e-03 3 1  ON 27
ci_29                 2.138174e-03 3 1  ON 28
ci_30                -1.586275e-03 3 1  ON 29
ci_31                -1.612308e-03 3 1  ON 30
ci_32                -1.313340e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461966e-03 3 1  ON 33
ci_35                 1.221732e-03 3 1  ON 34
ci_36                -1.116942e-03 3 1  ON 35
ci_37                -1.122367e-03 3 1  ON 36
ci_38                -5.287665e-04 3 1  ON 37
ci_39                -6.422527e-04 3 1  ON 38
ci_40                -1.673120e-03 3 1  ON 39
ci_41                -1.413581e-03 3 1  ON 40
ci_42                -1.208530e-03 3 1  ON 41
ci_43                -2.700310e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300618e-04 3 1  ON 44
ci_46                -5.317765e-04 3 1  ON 45
ci_47                 1.304118e-03 3 1  ON 46
ci_48                 8.704690e-04 3 1  ON 47
ci_49                -9.525982e-04 3 1  ON 48
ci_50                -7.380908e-04 3 1  ON 49
ci_51                 3.640956e-04 3 1  ON 50
ci_52                 3.764097e-04 3 1  ON 51
ci_53                -6.473191e-04 3 1  ON 52
ci_54                -9.086549e-04 3 1  ON 53
ci_55                -6.740919e-04 3 1  ON 54
ci_56                 1.893490e-03 3 1  ON 55
ci_57                 1.812212e-03 3 1  ON 56
ci_58                -8.217781e-04 3 1  ON 57
ci_59                -9.599703e-04 3 1  ON 58
ci_60                 6.219833e-04 3 1  ON 59
ci_61                 5.642797e-04 3 1  ON 60
ci_62                -3.000529e-04 3 1  ON 61
ci_63                -5.128102e-04 3 1  ON 62
ci_64                -4.067351e-04 3 1  ON 63
ci_65                -3.135718e-04 3 1  ON 64
ci_66                -6.969392e-04 3 1  ON 65
ci_67                -5.894714e-04 3 1  ON 66
ci_68                -6.488117e-04 3 1  ON 67
ci_69                -1.883399e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5074e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.812
    reference variance = 0.380649
====================================================
  Execution time = 2.5847e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4643e-01
  Total weights = 1.964007505e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434380070040
                                         uncertainty =       0.001972958727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434380070040
                                         uncertainty =       0.001972958727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466039753
  error estimate for blocks of size 2^( 2) =       0.000490747446
  error estimate for blocks of size 2^( 3) =       0.000514372871
  error estimate for blocks of size 2^( 4) =       0.000531407198
  error estimate for blocks of size 2^( 5) =       0.000542794535
  error estimate for blocks of size 2^( 6) =       0.000549711458
  error estimate for blocks of size 2^( 7) =       0.000551488314

      target function =      -0.748306181072
              le_mean =     -22.813834787413
             les_mean =     520.917489033896
             stat err =       0.000543850376
             autocorr =       1.361798775370
   target nu stat err =       0.000543850376
   target dn stat err =       0.002483154442
      target stat err =       0.002153477047
              std dev =       0.659079739995
             le_variance =       0.434386103671


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281383478741e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748311365679       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748311366735       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748311366882       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748311366899       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748311366898       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748311366900       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748311366932       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748311366929       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748311366890       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748311366925       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+04 is 1.241499e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748311365679       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748311365943       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748311365979       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748311365984       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748311365983       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748311365983       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748311365823       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748311366071       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748311366030       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748311366007       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+04 is 3.103751e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748311365679       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748311365745       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748311365754       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748311365756       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748311365755       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748311365755       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748311365755       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748311365755       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748311365755       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748311365688       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+05 is 7.759380e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.313971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0390e+01
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_01                 1.311689e-01 3 1  ON 0
ci_02                -3.109420e-02 3 1  ON 1
ci_03                -3.098724e-02 3 1  ON 2
ci_04                 2.777621e-02 3 1  ON 3
ci_05                -2.306567e-02 3 1  ON 4
ci_06                -2.274490e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354173e-03 3 1  ON 7
ci_09                -9.236164e-03 3 1  ON 8
ci_10                -9.226451e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627897e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058114e-03 3 1  ON 14
ci_16                 7.299942e-03 3 1  ON 15
ci_17                -7.468965e-03 3 1  ON 16
ci_18                -7.185616e-03 3 1  ON 17
ci_19                 9.309459e-03 3 1  ON 18
ci_20                 6.818793e-03 3 1  ON 19
ci_21                 8.774061e-03 3 1  ON 20
ci_22                 8.773342e-03 3 1  ON 21
ci_23                 4.977845e-03 3 1  ON 22
ci_24                 4.388757e-03 3 1  ON 23
ci_25                 3.124212e-03 3 1  ON 24
ci_26                 3.150441e-03 3 1  ON 25
ci_27                 3.326766e-03 3 1  ON 26
ci_28                 2.505843e-03 3 1  ON 27
ci_29                 2.138173e-03 3 1  ON 28
ci_30                -1.586274e-03 3 1  ON 29
ci_31                -1.612307e-03 3 1  ON 30
ci_32                -1.313339e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461966e-03 3 1  ON 33
ci_35                 1.221733e-03 3 1  ON 34
ci_36                -1.116942e-03 3 1  ON 35
ci_37                -1.122367e-03 3 1  ON 36
ci_38                -5.287667e-04 3 1  ON 37
ci_39                -6.422529e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413580e-03 3 1  ON 40
ci_42                -1.208529e-03 3 1  ON 41
ci_43                -2.700311e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300615e-04 3 1  ON 44
ci_46                -5.317766e-04 3 1  ON 45
ci_47                 1.304118e-03 3 1  ON 46
ci_48                 8.704691e-04 3 1  ON 47
ci_49                -9.525982e-04 3 1  ON 48
ci_50                -7.380907e-04 3 1  ON 49
ci_51                 3.640955e-04 3 1  ON 50
ci_52                 3.764092e-04 3 1  ON 51
ci_53                -6.473190e-04 3 1  ON 52
ci_54                -9.086557e-04 3 1  ON 53
ci_55                -6.740925e-04 3 1  ON 54
ci_56                 1.893490e-03 3 1  ON 55
ci_57                 1.812212e-03 3 1  ON 56
ci_58                -8.217777e-04 3 1  ON 57
ci_59                -9.599700e-04 3 1  ON 58
ci_60                 6.219832e-04 3 1  ON 59
ci_61                 5.642809e-04 3 1  ON 60
ci_62                -3.000525e-04 3 1  ON 61
ci_63                -5.128102e-04 3 1  ON 62
ci_64                -4.067353e-04 3 1  ON 63
ci_65                -3.135715e-04 3 1  ON 64
ci_66                -6.969388e-04 3 1  ON 65
ci_67                -5.894701e-04 3 1  ON 66
ci_68                -6.488117e-04 3 1  ON 67
ci_69                -1.883400e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.9481
    reference variance = 0.2676
====================================================
  Execution time = 2.5296e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.7076e-01
  Total weights = 1.9643e+06
  Execution time = 3.4963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452117817043
                                         uncertainty =       0.014601921208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452117817043
                                         uncertainty =       0.014601921208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475431777
  error estimate for blocks of size 2^( 2) =       0.000500669718
  error estimate for blocks of size 2^( 3) =       0.000524288068
  error estimate for blocks of size 2^( 4) =       0.000542018970
  error estimate for blocks of size 2^( 5) =       0.000552698591
  error estimate for blocks of size 2^( 6) =       0.000558369982
  error estimate for blocks of size 2^( 7) =       0.000560084247

      target function =      -0.728231718311
              le_mean =     -22.814937003434
             les_mean =     520.992114571837
             stat err =       0.000553292947
             autocorr =       1.354359186397
   target nu stat err =       0.000553292947
   target dn stat err =       0.019770296564
      target stat err =       0.015628332054
              std dev =       0.672362066591
             le_variance =       0.452070748591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452117764022
                                         uncertainty =       0.014601870786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452117764022
                                         uncertainty =       0.014601870786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475431749
  error estimate for blocks of size 2^( 2) =       0.000500669692
  error estimate for blocks of size 2^( 3) =       0.000524288043
  error estimate for blocks of size 2^( 4) =       0.000542018947
  error estimate for blocks of size 2^( 5) =       0.000552698569
  error estimate for blocks of size 2^( 6) =       0.000558369960
  error estimate for blocks of size 2^( 7) =       0.000560084227

      target function =      -0.728231769109
              le_mean =     -22.814937003390
             les_mean =     520.992114508338
             stat err =       0.000553292925
             autocorr =       1.354359237648
   target nu stat err =       0.000553292925
   target dn stat err =       0.019770229268
      target stat err =       0.015628281063
              std dev =       0.672362027215
             le_variance =       0.452070695641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452117790532
                                         uncertainty =       0.014601895997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452117790532
                                         uncertainty =       0.014601895997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475431763
  error estimate for blocks of size 2^( 2) =       0.000500669705
  error estimate for blocks of size 2^( 3) =       0.000524288055
  error estimate for blocks of size 2^( 4) =       0.000542018958
  error estimate for blocks of size 2^( 5) =       0.000552698580
  error estimate for blocks of size 2^( 6) =       0.000558369971
  error estimate for blocks of size 2^( 7) =       0.000560084237

      target function =      -0.728231743710
              le_mean =     -22.814937003412
             les_mean =     520.992114540088
             stat err =       0.000553292936
             autocorr =       1.354359212021
   target nu stat err =       0.000553292936
   target dn stat err =       0.019770262916
      target stat err =       0.015628306558
              std dev =       0.672362046903
             le_variance =       0.452070722116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452117813730
                                         uncertainty =       0.014601918057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452117813730
                                         uncertainty =       0.014601918057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475431775
  error estimate for blocks of size 2^( 2) =       0.000500669716
  error estimate for blocks of size 2^( 3) =       0.000524288066
  error estimate for blocks of size 2^( 4) =       0.000542018968
  error estimate for blocks of size 2^( 5) =       0.000552698590
  error estimate for blocks of size 2^( 6) =       0.000558369980
  error estimate for blocks of size 2^( 7) =       0.000560084246

      target function =      -0.728231721486
              le_mean =     -22.814937003431
             les_mean =     520.992114567869
             stat err =       0.000553292946
             autocorr =       1.354359189598
   target nu stat err =       0.000553292946
   target dn stat err =       0.019770292358
      target stat err =       0.015628328867
              std dev =       0.672362064130
             le_variance =       0.452070745281


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.728231718311        initial
     1.4901e+04     1.4901e+05             1.2415e-08        -0.728231769109  <--
     5.9605e+04     5.9605e+05             3.1038e-09        -0.728231743710
     2.3842e+05     2.3842e+06             7.7594e-10        -0.728231721486

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 4.2886e+01
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_01                 1.311689e-01 3 1  ON 0
ci_02                -3.109420e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777621e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354170e-03 3 1  ON 7
ci_09                -9.236160e-03 3 1  ON 8
ci_10                -9.226448e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627894e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058111e-03 3 1  ON 14
ci_16                 7.299944e-03 3 1  ON 15
ci_17                -7.468961e-03 3 1  ON 16
ci_18                -7.185617e-03 3 1  ON 17
ci_19                 9.309461e-03 3 1  ON 18
ci_20                 6.818792e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773341e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124210e-03 3 1  ON 24
ci_26                 3.150440e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505844e-03 3 1  ON 27
ci_29                 2.138173e-03 3 1  ON 28
ci_30                -1.586271e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313338e-03 3 1  ON 31
ci_33                -1.023875e-03 3 1  ON 32
ci_34                 1.461964e-03 3 1  ON 33
ci_35                 1.221735e-03 3 1  ON 34
ci_36                -1.116942e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287674e-04 3 1  ON 37
ci_39                -6.422535e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208529e-03 3 1  ON 41
ci_43                -2.700312e-03 3 1  ON 42
ci_44                -1.763800e-03 3 1  ON 43
ci_45                -6.300606e-04 3 1  ON 44
ci_46                -5.317768e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704695e-04 3 1  ON 47
ci_49                -9.525983e-04 3 1  ON 48
ci_50                -7.380907e-04 3 1  ON 49
ci_51                 3.640952e-04 3 1  ON 50
ci_52                 3.764076e-04 3 1  ON 51
ci_53                -6.473188e-04 3 1  ON 52
ci_54                -9.086579e-04 3 1  ON 53
ci_55                -6.740941e-04 3 1  ON 54
ci_56                 1.893489e-03 3 1  ON 55
ci_57                 1.812212e-03 3 1  ON 56
ci_58                -8.217764e-04 3 1  ON 57
ci_59                -9.599690e-04 3 1  ON 58
ci_60                 6.219830e-04 3 1  ON 59
ci_61                 5.642847e-04 3 1  ON 60
ci_62                -3.000511e-04 3 1  ON 61
ci_63                -5.128105e-04 3 1  ON 62
ci_64                -4.067360e-04 3 1  ON 63
ci_65                -3.135707e-04 3 1  ON 64
ci_66                -6.969379e-04 3 1  ON 65
ci_67                -5.894662e-04 3 1  ON 66
ci_68                -6.488116e-04 3 1  ON 67
ci_69                -1.883401e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3288e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.8347
    reference variance = 0.536691
====================================================
  Execution time = 2.5914e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5302e-01
  Total weights = 1.964202227e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439096853957
                                         uncertainty =       0.003406069946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439096853957
                                         uncertainty =       0.003406069946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468595765
  error estimate for blocks of size 2^( 2) =       0.000493844165
  error estimate for blocks of size 2^( 3) =       0.000518019658
  error estimate for blocks of size 2^( 4) =       0.000535338815
  error estimate for blocks of size 2^( 5) =       0.000546119461
  error estimate for blocks of size 2^( 6) =       0.000553454745
  error estimate for blocks of size 2^( 7) =       0.000559262883

      target function =      -0.742847334487
              le_mean =     -22.815224581655
             les_mean =     520.987491703901
             stat err =       0.000548543976
             autocorr =       1.370333205478
   target nu stat err =       0.000548543976
   target dn stat err =       0.004605851489
      target stat err =       0.003834037787
              std dev =       0.662694486160
             le_variance =       0.439163981987


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281522458166e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742865932533       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742865937508       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742865938385       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742865938572       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742865938575       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742865938582       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742865938574       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742865938576       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742865938571       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742865938569       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+03 is 5.443408e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742865932533       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742865933777       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742865933996       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742865934043       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742865934057       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742865934026       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742865934056       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742865934059       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742865934038       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742865934048       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+04 is 1.360864e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742865932533       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742865932844       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742865932899       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742865932907       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742865932896       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742865932938       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742865932869       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742865932933       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742865932909       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742865932910       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+04 is 3.402168e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.317437 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0441e+01
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098722e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274488e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354164e-03 3 1  ON 7
ci_09                -9.236158e-03 3 1  ON 8
ci_10                -9.226447e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627893e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058105e-03 3 1  ON 14
ci_16                 7.299938e-03 3 1  ON 15
ci_17                -7.468962e-03 3 1  ON 16
ci_18                -7.185615e-03 3 1  ON 17
ci_19                 9.309460e-03 3 1  ON 18
ci_20                 6.818791e-03 3 1  ON 19
ci_21                 8.774059e-03 3 1  ON 20
ci_22                 8.773337e-03 3 1  ON 21
ci_23                 4.977840e-03 3 1  ON 22
ci_24                 4.388750e-03 3 1  ON 23
ci_25                 3.124205e-03 3 1  ON 24
ci_26                 3.150439e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505841e-03 3 1  ON 27
ci_29                 2.138172e-03 3 1  ON 28
ci_30                -1.586272e-03 3 1  ON 29
ci_31                -1.612307e-03 3 1  ON 30
ci_32                -1.313341e-03 3 1  ON 31
ci_33                -1.023873e-03 3 1  ON 32
ci_34                 1.461965e-03 3 1  ON 33
ci_35                 1.221737e-03 3 1  ON 34
ci_36                -1.116939e-03 3 1  ON 35
ci_37                -1.122367e-03 3 1  ON 36
ci_38                -5.287667e-04 3 1  ON 37
ci_39                -6.422530e-04 3 1  ON 38
ci_40                -1.673120e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208529e-03 3 1  ON 41
ci_43                -2.700304e-03 3 1  ON 42
ci_44                -1.763797e-03 3 1  ON 43
ci_45                -6.300594e-04 3 1  ON 44
ci_46                -5.317791e-04 3 1  ON 45
ci_47                 1.304123e-03 3 1  ON 46
ci_48                 8.704743e-04 3 1  ON 47
ci_49                -9.526027e-04 3 1  ON 48
ci_50                -7.380903e-04 3 1  ON 49
ci_51                 3.640951e-04 3 1  ON 50
ci_52                 3.764067e-04 3 1  ON 51
ci_53                -6.473193e-04 3 1  ON 52
ci_54                -9.086578e-04 3 1  ON 53
ci_55                -6.740975e-04 3 1  ON 54
ci_56                 1.893490e-03 3 1  ON 55
ci_57                 1.812211e-03 3 1  ON 56
ci_58                -8.217763e-04 3 1  ON 57
ci_59                -9.599680e-04 3 1  ON 58
ci_60                 6.219794e-04 3 1  ON 59
ci_61                 5.642958e-04 3 1  ON 60
ci_62                -3.000516e-04 3 1  ON 61
ci_63                -5.128116e-04 3 1  ON 62
ci_64                -4.067381e-04 3 1  ON 63
ci_65                -3.135722e-04 3 1  ON 64
ci_66                -6.969368e-04 3 1  ON 65
ci_67                -5.894660e-04 3 1  ON 66
ci_68                -6.488126e-04 3 1  ON 67
ci_69                -1.883477e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.8909
    reference variance = 0.491589
====================================================
  Execution time = 2.5261e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4540e-01
  Total weights = 1.9641e+06
  Execution time = 3.5096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433418499513
                                         uncertainty =       0.001784422190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433418499513
                                         uncertainty =       0.001784422190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465534695
  error estimate for blocks of size 2^( 2) =       0.000490669131
  error estimate for blocks of size 2^( 3) =       0.000514476038
  error estimate for blocks of size 2^( 4) =       0.000532151104
  error estimate for blocks of size 2^( 5) =       0.000543426538
  error estimate for blocks of size 2^( 6) =       0.000548579658
  error estimate for blocks of size 2^( 7) =       0.000553323001

      target function =      -0.749175601103
              le_mean =     -22.814975904711
             les_mean =     520.968525173546
             stat err =       0.000544370075
             autocorr =       1.367364753312
   target nu stat err =       0.000544370075
   target dn stat err =       0.002332749276
      target stat err =       0.002041789193
              std dev =       0.658365479005
             le_variance =       0.433445103946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433418492612
                                         uncertainty =       0.001784422288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433418492612
                                         uncertainty =       0.001784422288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465534691
  error estimate for blocks of size 2^( 2) =       0.000490669130
  error estimate for blocks of size 2^( 3) =       0.000514476040
  error estimate for blocks of size 2^( 4) =       0.000532151106
  error estimate for blocks of size 2^( 5) =       0.000543426542
  error estimate for blocks of size 2^( 6) =       0.000548579663
  error estimate for blocks of size 2^( 7) =       0.000553323006

      target function =      -0.749175492052
              le_mean =     -22.814975905017
             les_mean =     520.968525318018
             stat err =       0.000544370079
             autocorr =       1.367364795002
   target nu stat err =       0.000544370079
   target dn stat err =       0.002332752663
      target stat err =       0.002041791330
              std dev =       0.658365473702
             le_variance =       0.433445096962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433418496063
                                         uncertainty =       0.001784422239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433418496063
                                         uncertainty =       0.001784422239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465534693
  error estimate for blocks of size 2^( 2) =       0.000490669131
  error estimate for blocks of size 2^( 3) =       0.000514476039
  error estimate for blocks of size 2^( 4) =       0.000532151105
  error estimate for blocks of size 2^( 5) =       0.000543426540
  error estimate for blocks of size 2^( 6) =       0.000548579660
  error estimate for blocks of size 2^( 7) =       0.000553323004

      target function =      -0.749175547245
              le_mean =     -22.814975904864
             les_mean =     520.968525244984
             stat err =       0.000544370077
             autocorr =       1.367364774159
   target nu stat err =       0.000544370077
   target dn stat err =       0.002332750969
      target stat err =       0.002041790265
              std dev =       0.658365476353
             le_variance =       0.433445100454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433418499082
                                         uncertainty =       0.001784422196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433418499082
                                         uncertainty =       0.001784422196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465534694
  error estimate for blocks of size 2^( 2) =       0.000490669131
  error estimate for blocks of size 2^( 3) =       0.000514476038
  error estimate for blocks of size 2^( 4) =       0.000532151104
  error estimate for blocks of size 2^( 5) =       0.000543426538
  error estimate for blocks of size 2^( 6) =       0.000548579658
  error estimate for blocks of size 2^( 7) =       0.000553323002

      target function =      -0.749175594442
              le_mean =     -22.814975904730
             les_mean =     520.968525182391
             stat err =       0.000544370075
             autocorr =       1.367364755910
   target nu stat err =       0.000544370075
   target dn stat err =       0.002332749488
      target stat err =       0.002041789327
              std dev =       0.658365478674
             le_variance =       0.433445103510


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749175601103        initial  <--
     3.7253e+03     3.7253e+04             5.4434e-08        -0.749175492052
     1.4901e+04     1.4901e+05             1.3609e-08        -0.749175547245
     5.9605e+04     5.9605e+05             3.4022e-09        -0.749175594442

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8054
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_01                 1.311689e-01 3 1  ON 0
ci_02                -3.109420e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777621e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354170e-03 3 1  ON 7
ci_09                -9.236160e-03 3 1  ON 8
ci_10                -9.226448e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627894e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058111e-03 3 1  ON 14
ci_16                 7.299944e-03 3 1  ON 15
ci_17                -7.468961e-03 3 1  ON 16
ci_18                -7.185617e-03 3 1  ON 17
ci_19                 9.309461e-03 3 1  ON 18
ci_20                 6.818792e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773341e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124210e-03 3 1  ON 24
ci_26                 3.150440e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505844e-03 3 1  ON 27
ci_29                 2.138173e-03 3 1  ON 28
ci_30                -1.586271e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313338e-03 3 1  ON 31
ci_33                -1.023875e-03 3 1  ON 32
ci_34                 1.461964e-03 3 1  ON 33
ci_35                 1.221735e-03 3 1  ON 34
ci_36                -1.116942e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287674e-04 3 1  ON 37
ci_39                -6.422535e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208529e-03 3 1  ON 41
ci_43                -2.700312e-03 3 1  ON 42
ci_44                -1.763800e-03 3 1  ON 43
ci_45                -6.300606e-04 3 1  ON 44
ci_46                -5.317768e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704695e-04 3 1  ON 47
ci_49                -9.525983e-04 3 1  ON 48
ci_50                -7.380907e-04 3 1  ON 49
ci_51                 3.640952e-04 3 1  ON 50
ci_52                 3.764076e-04 3 1  ON 51
ci_53                -6.473188e-04 3 1  ON 52
ci_54                -9.086579e-04 3 1  ON 53
ci_55                -6.740941e-04 3 1  ON 54
ci_56                 1.893489e-03 3 1  ON 55
ci_57                 1.812212e-03 3 1  ON 56
ci_58                -8.217764e-04 3 1  ON 57
ci_59                -9.599690e-04 3 1  ON 58
ci_60                 6.219830e-04 3 1  ON 59
ci_61                 5.642847e-04 3 1  ON 60
ci_62                -3.000511e-04 3 1  ON 61
ci_63                -5.128105e-04 3 1  ON 62
ci_64                -4.067360e-04 3 1  ON 63
ci_65                -3.135707e-04 3 1  ON 64
ci_66                -6.969379e-04 3 1  ON 65
ci_67                -5.894662e-04 3 1  ON 66
ci_68                -6.488116e-04 3 1  ON 67
ci_69                -1.883401e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3251e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.8591
    reference variance = 0.395415
====================================================
  Execution time = 2.5996e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5326e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.5044e-01
  Total weights = 1.964029241e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5264e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436436744636
                                         uncertainty =       0.004482274216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436436744636
                                         uncertainty =       0.004482274216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467124069
  error estimate for blocks of size 2^( 2) =       0.000492596724
  error estimate for blocks of size 2^( 3) =       0.000516654042
  error estimate for blocks of size 2^( 4) =       0.000533767142
  error estimate for blocks of size 2^( 5) =       0.000544859386
  error estimate for blocks of size 2^( 6) =       0.000551703190
  error estimate for blocks of size 2^( 7) =       0.000556215267

      target function =      -0.744942260692
              le_mean =     -22.813207201079
             les_mean =     520.892867607738
             stat err =       0.000546636246
             autocorr =       1.369406420838
   target nu stat err =       0.000546636246
   target dn stat err =       0.006758320072
      target stat err =       0.005602417387
              std dev =       0.660613193904
             le_variance =       0.436409791960


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281320720108e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744983689006       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744983689585       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744983689674       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744983689682       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744983689693       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744983689711       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744983689662       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744983689719       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744983689709       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+04 is 8.373726e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744983689006       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744983689151       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744983689173       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744983689175       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744983689178       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744983689179       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744983689035       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744983689538       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744983689464       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+05 is 2.093433e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744983689006       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744983689042       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744983689048       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744983688635       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744983688966       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744983688418       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744983689191       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744983688297       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744983689838       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+05 is 5.233582e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.320460 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0531e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_01                 1.311689e-01 3 1  ON 0
ci_02                -3.109420e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777621e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354169e-03 3 1  ON 7
ci_09                -9.236160e-03 3 1  ON 8
ci_10                -9.226448e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627894e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058111e-03 3 1  ON 14
ci_16                 7.299944e-03 3 1  ON 15
ci_17                -7.468961e-03 3 1  ON 16
ci_18                -7.185616e-03 3 1  ON 17
ci_19                 9.309461e-03 3 1  ON 18
ci_20                 6.818792e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773341e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124210e-03 3 1  ON 24
ci_26                 3.150440e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505844e-03 3 1  ON 27
ci_29                 2.138173e-03 3 1  ON 28
ci_30                -1.586271e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313338e-03 3 1  ON 31
ci_33                -1.023875e-03 3 1  ON 32
ci_34                 1.461964e-03 3 1  ON 33
ci_35                 1.221735e-03 3 1  ON 34
ci_36                -1.116942e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287675e-04 3 1  ON 37
ci_39                -6.422537e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208529e-03 3 1  ON 41
ci_43                -2.700311e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300602e-04 3 1  ON 44
ci_46                -5.317771e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704701e-04 3 1  ON 47
ci_49                -9.525982e-04 3 1  ON 48
ci_50                -7.380908e-04 3 1  ON 49
ci_51                 3.640953e-04 3 1  ON 50
ci_52                 3.764077e-04 3 1  ON 51
ci_53                -6.473189e-04 3 1  ON 52
ci_54                -9.086579e-04 3 1  ON 53
ci_55                -6.740940e-04 3 1  ON 54
ci_56                 1.893488e-03 3 1  ON 55
ci_57                 1.812212e-03 3 1  ON 56
ci_58                -8.217763e-04 3 1  ON 57
ci_59                -9.599686e-04 3 1  ON 58
ci_60                 6.219823e-04 3 1  ON 59
ci_61                 5.642848e-04 3 1  ON 60
ci_62                -3.000509e-04 3 1  ON 61
ci_63                -5.128105e-04 3 1  ON 62
ci_64                -4.067357e-04 3 1  ON 63
ci_65                -3.135709e-04 3 1  ON 64
ci_66                -6.969378e-04 3 1  ON 65
ci_67                -5.894662e-04 3 1  ON 66
ci_68                -6.488119e-04 3 1  ON 67
ci_69                -1.883406e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.8218
    reference variance = 0.368029
====================================================
  Execution time = 2.5242e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4753e-01
  Total weights = 1.9644e+06
  Execution time = 3.5107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434580052197
                                         uncertainty =       0.002084429126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434580052197
                                         uncertainty =       0.002084429126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466092461
  error estimate for blocks of size 2^( 2) =       0.000491581179
  error estimate for blocks of size 2^( 3) =       0.000515254291
  error estimate for blocks of size 2^( 4) =       0.000531800512
  error estimate for blocks of size 2^( 5) =       0.000543325408
  error estimate for blocks of size 2^( 6) =       0.000549574465
  error estimate for blocks of size 2^( 7) =       0.000551465694

      target function =      -0.747393631993
              le_mean =     -22.813865886879
             les_mean =     520.920002498774
             stat err =       0.000544041520
             autocorr =       1.362447996608
   target nu stat err =       0.000544041520
   target dn stat err =       0.003073124014
      target stat err =       0.002622313573
              std dev =       0.659154278991
             le_variance =       0.434484363512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434580050679
                                         uncertainty =       0.002084429082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434580050679
                                         uncertainty =       0.002084429082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466092460
  error estimate for blocks of size 2^( 2) =       0.000491581179
  error estimate for blocks of size 2^( 3) =       0.000515254291
  error estimate for blocks of size 2^( 4) =       0.000531800512
  error estimate for blocks of size 2^( 5) =       0.000543325408
  error estimate for blocks of size 2^( 6) =       0.000549574466
  error estimate for blocks of size 2^( 7) =       0.000551465695

      target function =      -0.747393637132
              le_mean =     -22.813865886769
             les_mean =     520.920002487567
             stat err =       0.000544041520
             autocorr =       1.362448003292
   target nu stat err =       0.000544041520
   target dn stat err =       0.003073123764
      target stat err =       0.002622313406
              std dev =       0.659154277842
             le_variance =       0.434484361998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434580051438
                                         uncertainty =       0.002084429104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434580051438
                                         uncertainty =       0.002084429104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466092460
  error estimate for blocks of size 2^( 2) =       0.000491581179
  error estimate for blocks of size 2^( 3) =       0.000515254291
  error estimate for blocks of size 2^( 4) =       0.000531800512
  error estimate for blocks of size 2^( 5) =       0.000543325408
  error estimate for blocks of size 2^( 6) =       0.000549574465
  error estimate for blocks of size 2^( 7) =       0.000551465695

      target function =      -0.747393634563
              le_mean =     -22.813865886824
             les_mean =     520.920002493171
             stat err =       0.000544041520
             autocorr =       1.362447999956
   target nu stat err =       0.000544041520
   target dn stat err =       0.003073123889
      target stat err =       0.002622313489
              std dev =       0.659154278417
             le_variance =       0.434484362755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434580052102
                                         uncertainty =       0.002084429123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434580052102
                                         uncertainty =       0.002084429123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466092460
  error estimate for blocks of size 2^( 2) =       0.000491581179
  error estimate for blocks of size 2^( 3) =       0.000515254291
  error estimate for blocks of size 2^( 4) =       0.000531800512
  error estimate for blocks of size 2^( 5) =       0.000543325408
  error estimate for blocks of size 2^( 6) =       0.000549574465
  error estimate for blocks of size 2^( 7) =       0.000551465694

      target function =      -0.747393632314
              le_mean =     -22.813865886872
             les_mean =     520.920002498074
             stat err =       0.000544041520
             autocorr =       1.362447997025
   target nu stat err =       0.000544041520
   target dn stat err =       0.003073123998
      target stat err =       0.002622313562
              std dev =       0.659154278919
             le_variance =       0.434484363418


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747393631993        initial
     3.7253e+04     3.7253e+05             8.3737e-09        -0.747393637132  <--
     1.4901e+05     1.4901e+06             2.0934e-09        -0.747393634563
     5.9605e+05     5.9605e+06             5.2336e-10        -0.747393632314

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 4.2848e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109420e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777621e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354169e-03 3 1  ON 7
ci_09                -9.236159e-03 3 1  ON 8
ci_10                -9.226447e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627895e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058111e-03 3 1  ON 14
ci_16                 7.299944e-03 3 1  ON 15
ci_17                -7.468961e-03 3 1  ON 16
ci_18                -7.185615e-03 3 1  ON 17
ci_19                 9.309459e-03 3 1  ON 18
ci_20                 6.818790e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150442e-03 3 1  ON 25
ci_27                 3.326765e-03 3 1  ON 26
ci_28                 2.505844e-03 3 1  ON 27
ci_29                 2.138173e-03 3 1  ON 28
ci_30                -1.586269e-03 3 1  ON 29
ci_31                -1.612307e-03 3 1  ON 30
ci_32                -1.313338e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461961e-03 3 1  ON 33
ci_35                 1.221734e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287680e-04 3 1  ON 37
ci_39                -6.422542e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413578e-03 3 1  ON 40
ci_42                -1.208530e-03 3 1  ON 41
ci_43                -2.700308e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300593e-04 3 1  ON 44
ci_46                -5.317778e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704719e-04 3 1  ON 47
ci_49                -9.525978e-04 3 1  ON 48
ci_50                -7.380913e-04 3 1  ON 49
ci_51                 3.640956e-04 3 1  ON 50
ci_52                 3.764080e-04 3 1  ON 51
ci_53                -6.473189e-04 3 1  ON 52
ci_54                -9.086577e-04 3 1  ON 53
ci_55                -6.740936e-04 3 1  ON 54
ci_56                 1.893487e-03 3 1  ON 55
ci_57                 1.812211e-03 3 1  ON 56
ci_58                -8.217759e-04 3 1  ON 57
ci_59                -9.599672e-04 3 1  ON 58
ci_60                 6.219801e-04 3 1  ON 59
ci_61                 5.642850e-04 3 1  ON 60
ci_62                -3.000503e-04 3 1  ON 61
ci_63                -5.128105e-04 3 1  ON 62
ci_64                -4.067350e-04 3 1  ON 63
ci_65                -3.135717e-04 3 1  ON 64
ci_66                -6.969375e-04 3 1  ON 65
ci_67                -5.894663e-04 3 1  ON 66
ci_68                -6.488127e-04 3 1  ON 67
ci_69                -1.883420e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3384e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.7859
    reference variance = 0.481433
====================================================
  Execution time = 2.6953e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5369e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4504e-01
  Total weights = 1.964379031e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432924870898
                                         uncertainty =       0.002440210229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432924870898
                                         uncertainty =       0.002440210229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465283013
  error estimate for blocks of size 2^( 2) =       0.000490596343
  error estimate for blocks of size 2^( 3) =       0.000514077657
  error estimate for blocks of size 2^( 4) =       0.000531579898
  error estimate for blocks of size 2^( 5) =       0.000542602906
  error estimate for blocks of size 2^( 6) =       0.000548590016
  error estimate for blocks of size 2^( 7) =       0.000550968696

      target function =      -0.749468781101
              le_mean =     -22.814295922768
             les_mean =     520.937135284486
             stat err =       0.000543435379
             autocorr =       1.364147784928
   target nu stat err =       0.000543435379
   target dn stat err =       0.003239464081
      target stat err =       0.002773487124
              std dev =       0.658009547854
             le_variance =       0.432976565067


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281429592277e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749478010436       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749478012133       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749478012525       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749478012578       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749478012593       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749478012581       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749478012585       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749478012578       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749478012605       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+03 is 2.176773e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749478010436       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749478010860       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749478010958       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749478010966       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749478010975       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749478010998       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749478010974       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749478010974       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749478010974       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+04 is 5.441945e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749478010436       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749478010542       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749478010566       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749478010570       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749478010570       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749478010570       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749478010570       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749478010640       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749478010696       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+05 is 1.360487e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.323497 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1830e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354167e-03 3 1  ON 7
ci_09                -9.236157e-03 3 1  ON 8
ci_10                -9.226444e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627893e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058109e-03 3 1  ON 14
ci_16                 7.299943e-03 3 1  ON 15
ci_17                -7.468959e-03 3 1  ON 16
ci_18                -7.185615e-03 3 1  ON 17
ci_19                 9.309458e-03 3 1  ON 18
ci_20                 6.818788e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773342e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388753e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150442e-03 3 1  ON 25
ci_27                 3.326763e-03 3 1  ON 26
ci_28                 2.505844e-03 3 1  ON 27
ci_29                 2.138172e-03 3 1  ON 28
ci_30                -1.586270e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313338e-03 3 1  ON 31
ci_33                -1.023878e-03 3 1  ON 32
ci_34                 1.461962e-03 3 1  ON 33
ci_35                 1.221733e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122365e-03 3 1  ON 36
ci_38                -5.287676e-04 3 1  ON 37
ci_39                -6.422535e-04 3 1  ON 38
ci_40                -1.673122e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208530e-03 3 1  ON 41
ci_43                -2.700306e-03 3 1  ON 42
ci_44                -1.763800e-03 3 1  ON 43
ci_45                -6.300593e-04 3 1  ON 44
ci_46                -5.317779e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704725e-04 3 1  ON 47
ci_49                -9.525977e-04 3 1  ON 48
ci_50                -7.380930e-04 3 1  ON 49
ci_51                 3.640955e-04 3 1  ON 50
ci_52                 3.764077e-04 3 1  ON 51
ci_53                -6.473190e-04 3 1  ON 52
ci_54                -9.086585e-04 3 1  ON 53
ci_55                -6.740931e-04 3 1  ON 54
ci_56                 1.893486e-03 3 1  ON 55
ci_57                 1.812210e-03 3 1  ON 56
ci_58                -8.217762e-04 3 1  ON 57
ci_59                -9.599676e-04 3 1  ON 58
ci_60                 6.219821e-04 3 1  ON 59
ci_61                 5.642851e-04 3 1  ON 60
ci_62                -3.000487e-04 3 1  ON 61
ci_63                -5.128111e-04 3 1  ON 62
ci_64                -4.067349e-04 3 1  ON 63
ci_65                -3.135718e-04 3 1  ON 64
ci_66                -6.969372e-04 3 1  ON 65
ci_67                -5.894660e-04 3 1  ON 66
ci_68                -6.488127e-04 3 1  ON 67
ci_69                -1.883437e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.8274
    reference variance = 0.375745
====================================================
  Execution time = 2.4632e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4832e-01
  Total weights = 1.9642e+06
  Execution time = 3.5819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434409337806
                                         uncertainty =       0.001882611892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434409337806
                                         uncertainty =       0.001882611892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466046253
  error estimate for blocks of size 2^( 2) =       0.000491070778
  error estimate for blocks of size 2^( 3) =       0.000515123259
  error estimate for blocks of size 2^( 4) =       0.000531733078
  error estimate for blocks of size 2^( 5) =       0.000542570439
  error estimate for blocks of size 2^( 6) =       0.000547119240
  error estimate for blocks of size 2^( 7) =       0.000551465653

      target function =      -0.746733816722
              le_mean =     -22.813717159296
             les_mean =     520.914011976315
             stat err =       0.000543222103
             autocorr =       1.358616309684
   target nu stat err =       0.000543222103
   target dn stat err =       0.002879571753
      target stat err =       0.002461214559
              std dev =       0.659088931221
             le_variance =       0.434398219259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434409334349
                                         uncertainty =       0.001882612008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434409334349
                                         uncertainty =       0.001882612008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466046251
  error estimate for blocks of size 2^( 2) =       0.000491070777
  error estimate for blocks of size 2^( 3) =       0.000515123260
  error estimate for blocks of size 2^( 4) =       0.000531733079
  error estimate for blocks of size 2^( 5) =       0.000542570440
  error estimate for blocks of size 2^( 6) =       0.000547119241
  error estimate for blocks of size 2^( 7) =       0.000551465654

      target function =      -0.746733805683
              le_mean =     -22.813717159165
             les_mean =     520.914011983648
             stat err =       0.000543222104
             autocorr =       1.358616325186
   target nu stat err =       0.000543222104
   target dn stat err =       0.002879570846
      target stat err =       0.002461213760
              std dev =       0.659088928597
             le_variance =       0.434398215799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434409336077
                                         uncertainty =       0.001882611950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434409336077
                                         uncertainty =       0.001882611950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466046252
  error estimate for blocks of size 2^( 2) =       0.000491070778
  error estimate for blocks of size 2^( 3) =       0.000515123260
  error estimate for blocks of size 2^( 4) =       0.000531733079
  error estimate for blocks of size 2^( 5) =       0.000542570439
  error estimate for blocks of size 2^( 6) =       0.000547119241
  error estimate for blocks of size 2^( 7) =       0.000551465654

      target function =      -0.746733811209
              le_mean =     -22.813717159230
             les_mean =     520.914011979974
             stat err =       0.000543222103
             autocorr =       1.358616317431
   target nu stat err =       0.000543222103
   target dn stat err =       0.002879571299
      target stat err =       0.002461214160
              std dev =       0.659088929909
             le_variance =       0.434398217529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434409337590
                                         uncertainty =       0.001882611899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434409337590
                                         uncertainty =       0.001882611899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466046253
  error estimate for blocks of size 2^( 2) =       0.000491070778
  error estimate for blocks of size 2^( 3) =       0.000515123259
  error estimate for blocks of size 2^( 4) =       0.000531733078
  error estimate for blocks of size 2^( 5) =       0.000542570439
  error estimate for blocks of size 2^( 6) =       0.000547119240
  error estimate for blocks of size 2^( 7) =       0.000551465653

      target function =      -0.746733816034
              le_mean =     -22.813717159288
             les_mean =     520.914011976771
             stat err =       0.000543222103
             autocorr =       1.358616310643
   target nu stat err =       0.000543222103
   target dn stat err =       0.002879571696
      target stat err =       0.002461214509
              std dev =       0.659088931057
             le_variance =       0.434398219042


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746733816722        initial  <--
     9.3132e+03     9.3132e+04             2.1768e-08        -0.746733805683
     3.7253e+04     3.7253e+05             5.4419e-09        -0.746733811209
     1.4901e+05     1.4901e+06             1.3605e-09        -0.746733816034

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2749
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109420e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777621e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354169e-03 3 1  ON 7
ci_09                -9.236159e-03 3 1  ON 8
ci_10                -9.226447e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627895e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058111e-03 3 1  ON 14
ci_16                 7.299944e-03 3 1  ON 15
ci_17                -7.468961e-03 3 1  ON 16
ci_18                -7.185615e-03 3 1  ON 17
ci_19                 9.309459e-03 3 1  ON 18
ci_20                 6.818790e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150442e-03 3 1  ON 25
ci_27                 3.326765e-03 3 1  ON 26
ci_28                 2.505844e-03 3 1  ON 27
ci_29                 2.138173e-03 3 1  ON 28
ci_30                -1.586269e-03 3 1  ON 29
ci_31                -1.612307e-03 3 1  ON 30
ci_32                -1.313338e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461961e-03 3 1  ON 33
ci_35                 1.221734e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287680e-04 3 1  ON 37
ci_39                -6.422542e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413578e-03 3 1  ON 40
ci_42                -1.208530e-03 3 1  ON 41
ci_43                -2.700308e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300593e-04 3 1  ON 44
ci_46                -5.317778e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704719e-04 3 1  ON 47
ci_49                -9.525978e-04 3 1  ON 48
ci_50                -7.380913e-04 3 1  ON 49
ci_51                 3.640956e-04 3 1  ON 50
ci_52                 3.764080e-04 3 1  ON 51
ci_53                -6.473189e-04 3 1  ON 52
ci_54                -9.086577e-04 3 1  ON 53
ci_55                -6.740936e-04 3 1  ON 54
ci_56                 1.893487e-03 3 1  ON 55
ci_57                 1.812211e-03 3 1  ON 56
ci_58                -8.217759e-04 3 1  ON 57
ci_59                -9.599672e-04 3 1  ON 58
ci_60                 6.219801e-04 3 1  ON 59
ci_61                 5.642850e-04 3 1  ON 60
ci_62                -3.000503e-04 3 1  ON 61
ci_63                -5.128105e-04 3 1  ON 62
ci_64                -4.067350e-04 3 1  ON 63
ci_65                -3.135717e-04 3 1  ON 64
ci_66                -6.969375e-04 3 1  ON 65
ci_67                -5.894663e-04 3 1  ON 66
ci_68                -6.488127e-04 3 1  ON 67
ci_69                -1.883420e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4113e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.7684
    reference variance = 0.301129
====================================================
  Execution time = 2.5268e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5619e-01
  Total weights = 1.964156456e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437914275555
                                         uncertainty =       0.002263493210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437914275555
                                         uncertainty =       0.002263493210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467914935
  error estimate for blocks of size 2^( 2) =       0.000492807415
  error estimate for blocks of size 2^( 3) =       0.000516407605
  error estimate for blocks of size 2^( 4) =       0.000534341302
  error estimate for blocks of size 2^( 5) =       0.000546357328
  error estimate for blocks of size 2^( 6) =       0.000552797755
  error estimate for blocks of size 2^( 7) =       0.000557398587

      target function =      -0.740237711781
              le_mean =     -22.814451253208
             les_mean =     520.955376110291
             stat err =       0.000547723743
             autocorr =       1.370216901229
   target nu stat err =       0.000547723743
   target dn stat err =       0.006306864577
      target stat err =       0.005176910071
              std dev =       0.661731647346
             le_variance =       0.437888773100


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281445125321e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740273133392       residual = 4.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740273133821       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740273133852       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740273133855       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740273133885       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740273133859       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740273133973       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740273133857       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740273133986       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740273133857       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+04 is 2.687090e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740273133392       residual = 4.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740273133499       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740273133507       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740273133508       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740273133508       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740273133508       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740273133508       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740273134102       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740273133508       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740273133508       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+05 is 6.717728e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740273133392       residual = 4.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740273133419       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740273133421       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740273133421       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740273133421       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740273133421       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740273133421       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740273135399       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740273133421       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740273132746       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+06 is 1.679432e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.326939 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9822e+01
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109420e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777621e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354168e-03 3 1  ON 7
ci_09                -9.236159e-03 3 1  ON 8
ci_10                -9.226446e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627894e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058111e-03 3 1  ON 14
ci_16                 7.299944e-03 3 1  ON 15
ci_17                -7.468961e-03 3 1  ON 16
ci_18                -7.185616e-03 3 1  ON 17
ci_19                 9.309459e-03 3 1  ON 18
ci_20                 6.818791e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150442e-03 3 1  ON 25
ci_27                 3.326765e-03 3 1  ON 26
ci_28                 2.505845e-03 3 1  ON 27
ci_29                 2.138172e-03 3 1  ON 28
ci_30                -1.586269e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313338e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461961e-03 3 1  ON 33
ci_35                 1.221734e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287679e-04 3 1  ON 37
ci_39                -6.422541e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413578e-03 3 1  ON 40
ci_42                -1.208530e-03 3 1  ON 41
ci_43                -2.700307e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300591e-04 3 1  ON 44
ci_46                -5.317779e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704718e-04 3 1  ON 47
ci_49                -9.525975e-04 3 1  ON 48
ci_50                -7.380913e-04 3 1  ON 49
ci_51                 3.640958e-04 3 1  ON 50
ci_52                 3.764078e-04 3 1  ON 51
ci_53                -6.473190e-04 3 1  ON 52
ci_54                -9.086578e-04 3 1  ON 53
ci_55                -6.740936e-04 3 1  ON 54
ci_56                 1.893487e-03 3 1  ON 55
ci_57                 1.812210e-03 3 1  ON 56
ci_58                -8.217759e-04 3 1  ON 57
ci_59                -9.599672e-04 3 1  ON 58
ci_60                 6.219802e-04 3 1  ON 59
ci_61                 5.642850e-04 3 1  ON 60
ci_62                -3.000502e-04 3 1  ON 61
ci_63                -5.128105e-04 3 1  ON 62
ci_64                -4.067351e-04 3 1  ON 63
ci_65                -3.135719e-04 3 1  ON 64
ci_66                -6.969375e-04 3 1  ON 65
ci_67                -5.894663e-04 3 1  ON 66
ci_68                -6.488128e-04 3 1  ON 67
ci_69                -1.883422e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.8252
    reference variance = 0.352009
====================================================
  Execution time = 2.4563e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4405e-01
  Total weights = 1.9643e+06
  Execution time = 3.5218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431633032208
                                         uncertainty =       0.001811262617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431633032208
                                         uncertainty =       0.001811262617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464527674
  error estimate for blocks of size 2^( 2) =       0.000489713313
  error estimate for blocks of size 2^( 3) =       0.000513097409
  error estimate for blocks of size 2^( 4) =       0.000530944842
  error estimate for blocks of size 2^( 5) =       0.000542167212
  error estimate for blocks of size 2^( 6) =       0.000548851547
  error estimate for blocks of size 2^( 7) =       0.000551461616

      target function =      -0.750309682606
              le_mean =     -22.815567214128
             les_mean =     520.994154149524
             stat err =       0.000543356304
             autocorr =       1.368189446872
   target nu stat err =       0.000543356304
   target dn stat err =       0.002962013488
      target stat err =       0.002558151972
              std dev =       0.656941336832
             le_variance =       0.431571920039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431633031451
                                         uncertainty =       0.001811262536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431633031451
                                         uncertainty =       0.001811262536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464527674
  error estimate for blocks of size 2^( 2) =       0.000489713313
  error estimate for blocks of size 2^( 3) =       0.000513097409
  error estimate for blocks of size 2^( 4) =       0.000530944842
  error estimate for blocks of size 2^( 5) =       0.000542167212
  error estimate for blocks of size 2^( 6) =       0.000548851547
  error estimate for blocks of size 2^( 7) =       0.000551461616

      target function =      -0.750309685251
              le_mean =     -22.815567214125
             les_mean =     520.994154146232
             stat err =       0.000543356304
             autocorr =       1.368189449476
   target nu stat err =       0.000543356304
   target dn stat err =       0.002962012777
      target stat err =       0.002558151410
              std dev =       0.656941336255
             le_variance =       0.431571919281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431633031830
                                         uncertainty =       0.001811262576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431633031830
                                         uncertainty =       0.001811262576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464527674
  error estimate for blocks of size 2^( 2) =       0.000489713313
  error estimate for blocks of size 2^( 3) =       0.000513097409
  error estimate for blocks of size 2^( 4) =       0.000530944842
  error estimate for blocks of size 2^( 5) =       0.000542167212
  error estimate for blocks of size 2^( 6) =       0.000548851547
  error estimate for blocks of size 2^( 7) =       0.000551461616

      target function =      -0.750309683928
              le_mean =     -22.815567214126
             les_mean =     520.994154147878
             stat err =       0.000543356304
             autocorr =       1.368189448176
   target nu stat err =       0.000543356304
   target dn stat err =       0.002962013132
      target stat err =       0.002558151691
              std dev =       0.656941336544
             le_variance =       0.431571919660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431633032161
                                         uncertainty =       0.001811262612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431633032161
                                         uncertainty =       0.001811262612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464527674
  error estimate for blocks of size 2^( 2) =       0.000489713313
  error estimate for blocks of size 2^( 3) =       0.000513097409
  error estimate for blocks of size 2^( 4) =       0.000530944842
  error estimate for blocks of size 2^( 5) =       0.000542167212
  error estimate for blocks of size 2^( 6) =       0.000548851547
  error estimate for blocks of size 2^( 7) =       0.000551461616

      target function =      -0.750309682771
              le_mean =     -22.815567214128
             les_mean =     520.994154149318
             stat err =       0.000543356304
             autocorr =       1.368189447038
   target nu stat err =       0.000543356304
   target dn stat err =       0.002962013444
      target stat err =       0.002558151937
              std dev =       0.656941336796
             le_variance =       0.431571919992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750309682606        initial
     9.3132e+04     9.3132e+05             2.6871e-09        -0.750309685251  <--
     3.7253e+05     3.7253e+06             6.7177e-10        -0.750309683928
     1.4901e+06     1.4901e+07             1.6794e-10        -0.750309682771

*****************************************************************************
Applying the update for shift_i =   9.3132e+04     and shift_s =   9.3132e+05
*****************************************************************************

  Execution time = 4.2230e+01
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354167e-03 3 1  ON 7
ci_09                -9.236159e-03 3 1  ON 8
ci_10                -9.226445e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627892e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058109e-03 3 1  ON 14
ci_16                 7.299945e-03 3 1  ON 15
ci_17                -7.468963e-03 3 1  ON 16
ci_18                -7.185616e-03 3 1  ON 17
ci_19                 9.309460e-03 3 1  ON 18
ci_20                 6.818791e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150442e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505845e-03 3 1  ON 27
ci_29                 2.138172e-03 3 1  ON 28
ci_30                -1.586268e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313337e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461961e-03 3 1  ON 33
ci_35                 1.221734e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287675e-04 3 1  ON 37
ci_39                -6.422541e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208532e-03 3 1  ON 41
ci_43                -2.700305e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300585e-04 3 1  ON 44
ci_46                -5.317781e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704713e-04 3 1  ON 47
ci_49                -9.525969e-04 3 1  ON 48
ci_50                -7.380912e-04 3 1  ON 49
ci_51                 3.640962e-04 3 1  ON 50
ci_52                 3.764073e-04 3 1  ON 51
ci_53                -6.473192e-04 3 1  ON 52
ci_54                -9.086581e-04 3 1  ON 53
ci_55                -6.740937e-04 3 1  ON 54
ci_56                 1.893487e-03 3 1  ON 55
ci_57                 1.812210e-03 3 1  ON 56
ci_58                -8.217759e-04 3 1  ON 57
ci_59                -9.599671e-04 3 1  ON 58
ci_60                 6.219802e-04 3 1  ON 59
ci_61                 5.642852e-04 3 1  ON 60
ci_62                -3.000501e-04 3 1  ON 61
ci_63                -5.128106e-04 3 1  ON 62
ci_64                -4.067355e-04 3 1  ON 63
ci_65                -3.135725e-04 3 1  ON 64
ci_66                -6.969375e-04 3 1  ON 65
ci_67                -5.894662e-04 3 1  ON 66
ci_68                -6.488133e-04 3 1  ON 67
ci_69                -1.883427e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2057e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.844
    reference variance = 0.229742
====================================================
  Execution time = 2.5171e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4656e-01
  Total weights = 1.964461920e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434348414058
                                         uncertainty =       0.002320821798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434348414058
                                         uncertainty =       0.002320821798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466020843
  error estimate for blocks of size 2^( 2) =       0.000491268164
  error estimate for blocks of size 2^( 3) =       0.000515232132
  error estimate for blocks of size 2^( 4) =       0.000533074655
  error estimate for blocks of size 2^( 5) =       0.000543545496
  error estimate for blocks of size 2^( 6) =       0.000548928511
  error estimate for blocks of size 2^( 7) =       0.000550792248

      target function =      -0.748197458225
              le_mean =     -22.814354665419
             les_mean =     520.941340753475
             stat err =       0.000544085227
             autocorr =       1.363085779490
   target nu stat err =       0.000544085227
   target dn stat err =       0.003181061027
      target stat err =       0.002717276882
              std dev =       0.659052996096
             le_variance =       0.434350851663


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281435466542e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748206337731       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748206338224       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748206338300       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748206338319       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748206338327       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748206338361       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748206338310       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748206338355       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748206338341       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+04 is 9.715643e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748206337731       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748206337854       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748206337873       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748206337877       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748206337874       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748206337586       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748206337976       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748206337691       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748206337855       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+04 is 2.428913e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748206337731       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748206337762       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748206337767       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748206337768       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748206337930       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748206337359       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748206338381       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748206337432       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748206338967       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+05 is 6.072284e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.329938 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9687e+01
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354167e-03 3 1  ON 7
ci_09                -9.236159e-03 3 1  ON 8
ci_10                -9.226444e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627892e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058109e-03 3 1  ON 14
ci_16                 7.299944e-03 3 1  ON 15
ci_17                -7.468962e-03 3 1  ON 16
ci_18                -7.185616e-03 3 1  ON 17
ci_19                 9.309459e-03 3 1  ON 18
ci_20                 6.818790e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388753e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150443e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505845e-03 3 1  ON 27
ci_29                 2.138171e-03 3 1  ON 28
ci_30                -1.586268e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313337e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461961e-03 3 1  ON 33
ci_35                 1.221733e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287675e-04 3 1  ON 37
ci_39                -6.422543e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208532e-03 3 1  ON 41
ci_43                -2.700306e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300589e-04 3 1  ON 44
ci_46                -5.317780e-04 3 1  ON 45
ci_47                 1.304121e-03 3 1  ON 46
ci_48                 8.704717e-04 3 1  ON 47
ci_49                -9.525967e-04 3 1  ON 48
ci_50                -7.380915e-04 3 1  ON 49
ci_51                 3.640962e-04 3 1  ON 50
ci_52                 3.764070e-04 3 1  ON 51
ci_53                -6.473195e-04 3 1  ON 52
ci_54                -9.086579e-04 3 1  ON 53
ci_55                -6.740939e-04 3 1  ON 54
ci_56                 1.893487e-03 3 1  ON 55
ci_57                 1.812210e-03 3 1  ON 56
ci_58                -8.217759e-04 3 1  ON 57
ci_59                -9.599667e-04 3 1  ON 58
ci_60                 6.219796e-04 3 1  ON 59
ci_61                 5.642848e-04 3 1  ON 60
ci_62                -3.000503e-04 3 1  ON 61
ci_63                -5.128102e-04 3 1  ON 62
ci_64                -4.067347e-04 3 1  ON 63
ci_65                -3.135719e-04 3 1  ON 64
ci_66                -6.969372e-04 3 1  ON 65
ci_67                -5.894661e-04 3 1  ON 66
ci_68                -6.488134e-04 3 1  ON 67
ci_69                -1.883430e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.8529
    reference variance = 0.866843
====================================================
  Execution time = 2.4404e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5513e-01
  Total weights = 1.9642e+06
  Execution time = 3.5066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434781269063
                                         uncertainty =       0.002061923337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434781269063
                                         uncertainty =       0.002061923337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466385897
  error estimate for blocks of size 2^( 2) =       0.000491541087
  error estimate for blocks of size 2^( 3) =       0.000515658494
  error estimate for blocks of size 2^( 4) =       0.000532758653
  error estimate for blocks of size 2^( 5) =       0.000545752519
  error estimate for blocks of size 2^( 6) =       0.000551898426
  error estimate for blocks of size 2^( 7) =       0.000555066143

      target function =      -0.741121643568
              le_mean =     -22.814422148603
             les_mean =     520.952985182042
             stat err =       0.000546368935
             autocorr =       1.372401482606
   target nu stat err =       0.000546368935
   target dn stat err =       0.004674839860
      target stat err =       0.003867210471
              std dev =       0.659569261108
             le_variance =       0.435031610198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434781267489
                                         uncertainty =       0.002061923378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434781267489
                                         uncertainty =       0.002061923378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466385896
  error estimate for blocks of size 2^( 2) =       0.000491541087
  error estimate for blocks of size 2^( 3) =       0.000515658494
  error estimate for blocks of size 2^( 4) =       0.000532758653
  error estimate for blocks of size 2^( 5) =       0.000545752520
  error estimate for blocks of size 2^( 6) =       0.000551898427
  error estimate for blocks of size 2^( 7) =       0.000555066143

      target function =      -0.741121599830
              le_mean =     -22.814422148504
             les_mean =     520.952985230769
             stat err =       0.000546368936
             autocorr =       1.372401489474
   target nu stat err =       0.000546368936
   target dn stat err =       0.004674868412
      target stat err =       0.003867233066
              std dev =       0.659569259974
             le_variance =       0.435031608702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434781268276
                                         uncertainty =       0.002061923357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434781268276
                                         uncertainty =       0.002061923357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466385897
  error estimate for blocks of size 2^( 2) =       0.000491541087
  error estimate for blocks of size 2^( 3) =       0.000515658494
  error estimate for blocks of size 2^( 4) =       0.000532758653
  error estimate for blocks of size 2^( 5) =       0.000545752519
  error estimate for blocks of size 2^( 6) =       0.000551898426
  error estimate for blocks of size 2^( 7) =       0.000555066143

      target function =      -0.741121621701
              le_mean =     -22.814422148553
             les_mean =     520.952985206403
             stat err =       0.000546368935
             autocorr =       1.372401486042
   target nu stat err =       0.000546368935
   target dn stat err =       0.004674854136
      target stat err =       0.003867221768
              std dev =       0.659569260541
             le_variance =       0.435031609450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434781268965
                                         uncertainty =       0.002061923339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434781268965
                                         uncertainty =       0.002061923339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466385897
  error estimate for blocks of size 2^( 2) =       0.000491541087
  error estimate for blocks of size 2^( 3) =       0.000515658494
  error estimate for blocks of size 2^( 4) =       0.000532758653
  error estimate for blocks of size 2^( 5) =       0.000545752519
  error estimate for blocks of size 2^( 6) =       0.000551898426
  error estimate for blocks of size 2^( 7) =       0.000555066143

      target function =      -0.741121640835
              le_mean =     -22.814422148597
             les_mean =     520.952985185087
             stat err =       0.000546368935
             autocorr =       1.372401483035
   target nu stat err =       0.000546368935
   target dn stat err =       0.004674841645
      target stat err =       0.003867211883
              std dev =       0.659569261037
             le_variance =       0.435031610105


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741121643568        initial  <--
     2.3283e+04     2.3283e+05             9.7156e-09        -0.741121599830
     9.3132e+04     9.3132e+05             2.4289e-09        -0.741121621701
     3.7253e+05     3.7253e+06             6.0723e-10        -0.741121640835

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.0044
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354167e-03 3 1  ON 7
ci_09                -9.236159e-03 3 1  ON 8
ci_10                -9.226445e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627892e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058109e-03 3 1  ON 14
ci_16                 7.299945e-03 3 1  ON 15
ci_17                -7.468963e-03 3 1  ON 16
ci_18                -7.185616e-03 3 1  ON 17
ci_19                 9.309460e-03 3 1  ON 18
ci_20                 6.818791e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150442e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505845e-03 3 1  ON 27
ci_29                 2.138172e-03 3 1  ON 28
ci_30                -1.586268e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313337e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461961e-03 3 1  ON 33
ci_35                 1.221734e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287675e-04 3 1  ON 37
ci_39                -6.422541e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208532e-03 3 1  ON 41
ci_43                -2.700305e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300585e-04 3 1  ON 44
ci_46                -5.317781e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704713e-04 3 1  ON 47
ci_49                -9.525969e-04 3 1  ON 48
ci_50                -7.380912e-04 3 1  ON 49
ci_51                 3.640962e-04 3 1  ON 50
ci_52                 3.764073e-04 3 1  ON 51
ci_53                -6.473192e-04 3 1  ON 52
ci_54                -9.086581e-04 3 1  ON 53
ci_55                -6.740937e-04 3 1  ON 54
ci_56                 1.893487e-03 3 1  ON 55
ci_57                 1.812210e-03 3 1  ON 56
ci_58                -8.217759e-04 3 1  ON 57
ci_59                -9.599671e-04 3 1  ON 58
ci_60                 6.219802e-04 3 1  ON 59
ci_61                 5.642852e-04 3 1  ON 60
ci_62                -3.000501e-04 3 1  ON 61
ci_63                -5.128106e-04 3 1  ON 62
ci_64                -4.067355e-04 3 1  ON 63
ci_65                -3.135725e-04 3 1  ON 64
ci_66                -6.969375e-04 3 1  ON 65
ci_67                -5.894662e-04 3 1  ON 66
ci_68                -6.488133e-04 3 1  ON 67
ci_69                -1.883427e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1696e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.9057
    reference variance = 0.622044
====================================================
  Execution time = 2.5190e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5363e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5091e-01
  Total weights = 1.964241578e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5059e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437317025653
                                         uncertainty =       0.002150293145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437317025653
                                         uncertainty =       0.002150293145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467581491
  error estimate for blocks of size 2^( 2) =       0.000492886531
  error estimate for blocks of size 2^( 3) =       0.000516442816
  error estimate for blocks of size 2^( 4) =       0.000535872842
  error estimate for blocks of size 2^( 5) =       0.000546555800
  error estimate for blocks of size 2^( 6) =       0.000553388743
  error estimate for blocks of size 2^( 7) =       0.000555893788

      target function =      -0.744593514581
              le_mean =     -22.813701309683
             les_mean =     520.915878567903
             stat err =       0.000547927793
             autocorr =       1.373194445085
   target nu stat err =       0.000547927793
   target dn stat err =       0.002946749177
      target stat err =       0.002502438871
              std dev =       0.661260085992
             le_variance =       0.437264901326


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281370130968e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744600917140       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744600917226       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744600917233       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744600917234       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744600917234       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744600916962       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744600917358       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744600917618       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744600916790       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+05 is 1.156571e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744600917140       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744600917161       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744600917163       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744600917163       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744600917164       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744600919858       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744600916751       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744600917260       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744600916192       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+05 is 2.891429e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744600917140       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744600917145       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744600917146       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744600917146       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744600917146       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744600917145       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744600918532       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744600919126       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744600923053       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+06 is 7.228573e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.332962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9705e+01
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354167e-03 3 1  ON 7
ci_09                -9.236159e-03 3 1  ON 8
ci_10                -9.226445e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627892e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058109e-03 3 1  ON 14
ci_16                 7.299944e-03 3 1  ON 15
ci_17                -7.468963e-03 3 1  ON 16
ci_18                -7.185616e-03 3 1  ON 17
ci_19                 9.309460e-03 3 1  ON 18
ci_20                 6.818791e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150442e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505845e-03 3 1  ON 27
ci_29                 2.138172e-03 3 1  ON 28
ci_30                -1.586268e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313337e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461961e-03 3 1  ON 33
ci_35                 1.221734e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287675e-04 3 1  ON 37
ci_39                -6.422541e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208532e-03 3 1  ON 41
ci_43                -2.700305e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300585e-04 3 1  ON 44
ci_46                -5.317781e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704714e-04 3 1  ON 47
ci_49                -9.525969e-04 3 1  ON 48
ci_50                -7.380912e-04 3 1  ON 49
ci_51                 3.640961e-04 3 1  ON 50
ci_52                 3.764072e-04 3 1  ON 51
ci_53                -6.473192e-04 3 1  ON 52
ci_54                -9.086581e-04 3 1  ON 53
ci_55                -6.740937e-04 3 1  ON 54
ci_56                 1.893487e-03 3 1  ON 55
ci_57                 1.812210e-03 3 1  ON 56
ci_58                -8.217759e-04 3 1  ON 57
ci_59                -9.599670e-04 3 1  ON 58
ci_60                 6.219802e-04 3 1  ON 59
ci_61                 5.642851e-04 3 1  ON 60
ci_62                -3.000501e-04 3 1  ON 61
ci_63                -5.128106e-04 3 1  ON 62
ci_64                -4.067354e-04 3 1  ON 63
ci_65                -3.135724e-04 3 1  ON 64
ci_66                -6.969375e-04 3 1  ON 65
ci_67                -5.894662e-04 3 1  ON 66
ci_68                -6.488133e-04 3 1  ON 67
ci_69                -1.883427e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.7702
    reference variance = 0.43224
====================================================
  Execution time = 2.4360e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4567e-01
  Total weights = 1.9642e+06
  Execution time = 3.5191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433860977411
                                         uncertainty =       0.001798932754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433860977411
                                         uncertainty =       0.001798932754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465763952
  error estimate for blocks of size 2^( 2) =       0.000491247371
  error estimate for blocks of size 2^( 3) =       0.000515059104
  error estimate for blocks of size 2^( 4) =       0.000532510434
  error estimate for blocks of size 2^( 5) =       0.000543377709
  error estimate for blocks of size 2^( 6) =       0.000550391596
  error estimate for blocks of size 2^( 7) =       0.000555425806

      target function =      -0.748948287221
              le_mean =     -22.815302096768
             les_mean =     520.983683795661
             stat err =       0.000545426386
             autocorr =       1.371325466786
   target nu stat err =       0.000545426386
   target dn stat err =       0.002394790020
      target stat err =       0.002091489096
              std dev =       0.658689698125
             le_variance =       0.433872118416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433860977223
                                         uncertainty =       0.001798932754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433860977223
                                         uncertainty =       0.001798932754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465763952
  error estimate for blocks of size 2^( 2) =       0.000491247371
  error estimate for blocks of size 2^( 3) =       0.000515059104
  error estimate for blocks of size 2^( 4) =       0.000532510434
  error estimate for blocks of size 2^( 5) =       0.000543377709
  error estimate for blocks of size 2^( 6) =       0.000550391596
  error estimate for blocks of size 2^( 7) =       0.000555425806

      target function =      -0.748948286956
              le_mean =     -22.815302096758
             les_mean =     520.983683795511
             stat err =       0.000545426386
             autocorr =       1.371325467668
   target nu stat err =       0.000545426386
   target dn stat err =       0.002394790043
      target stat err =       0.002091489113
              std dev =       0.658689697984
             le_variance =       0.433872118230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433860977317
                                         uncertainty =       0.001798932754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433860977317
                                         uncertainty =       0.001798932754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465763952
  error estimate for blocks of size 2^( 2) =       0.000491247371
  error estimate for blocks of size 2^( 3) =       0.000515059104
  error estimate for blocks of size 2^( 4) =       0.000532510434
  error estimate for blocks of size 2^( 5) =       0.000543377709
  error estimate for blocks of size 2^( 6) =       0.000550391596
  error estimate for blocks of size 2^( 7) =       0.000555425806

      target function =      -0.748948287088
              le_mean =     -22.815302096763
             les_mean =     520.983683795586
             stat err =       0.000545426386
             autocorr =       1.371325467220
   target nu stat err =       0.000545426386
   target dn stat err =       0.002394790031
      target stat err =       0.002091489105
              std dev =       0.658689698054
             le_variance =       0.433872118323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433860977399
                                         uncertainty =       0.001798932754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433860977399
                                         uncertainty =       0.001798932754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465763952
  error estimate for blocks of size 2^( 2) =       0.000491247371
  error estimate for blocks of size 2^( 3) =       0.000515059104
  error estimate for blocks of size 2^( 4) =       0.000532510434
  error estimate for blocks of size 2^( 5) =       0.000543377709
  error estimate for blocks of size 2^( 6) =       0.000550391596
  error estimate for blocks of size 2^( 7) =       0.000555425806

      target function =      -0.748948287204
              le_mean =     -22.815302096768
             les_mean =     520.983683795652
             stat err =       0.000545426386
             autocorr =       1.371325466845
   target nu stat err =       0.000545426386
   target dn stat err =       0.002394790021
      target stat err =       0.002091489097
              std dev =       0.658689698116
             le_variance =       0.433872118404


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748948287221        initial  <--
     2.3283e+05     2.3283e+06             1.1566e-09        -0.748948286956
     9.3132e+05     9.3132e+06             2.8914e-10        -0.748948287088
     3.7253e+06     3.7253e+07             7.2286e-11        -0.748948287204

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.0065
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354167e-03 3 1  ON 7
ci_09                -9.236159e-03 3 1  ON 8
ci_10                -9.226445e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627892e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058109e-03 3 1  ON 14
ci_16                 7.299945e-03 3 1  ON 15
ci_17                -7.468963e-03 3 1  ON 16
ci_18                -7.185616e-03 3 1  ON 17
ci_19                 9.309460e-03 3 1  ON 18
ci_20                 6.818791e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150442e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505845e-03 3 1  ON 27
ci_29                 2.138172e-03 3 1  ON 28
ci_30                -1.586268e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313337e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461961e-03 3 1  ON 33
ci_35                 1.221734e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287675e-04 3 1  ON 37
ci_39                -6.422541e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208532e-03 3 1  ON 41
ci_43                -2.700305e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300585e-04 3 1  ON 44
ci_46                -5.317781e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704713e-04 3 1  ON 47
ci_49                -9.525969e-04 3 1  ON 48
ci_50                -7.380912e-04 3 1  ON 49
ci_51                 3.640962e-04 3 1  ON 50
ci_52                 3.764073e-04 3 1  ON 51
ci_53                -6.473192e-04 3 1  ON 52
ci_54                -9.086581e-04 3 1  ON 53
ci_55                -6.740937e-04 3 1  ON 54
ci_56                 1.893487e-03 3 1  ON 55
ci_57                 1.812210e-03 3 1  ON 56
ci_58                -8.217759e-04 3 1  ON 57
ci_59                -9.599671e-04 3 1  ON 58
ci_60                 6.219802e-04 3 1  ON 59
ci_61                 5.642852e-04 3 1  ON 60
ci_62                -3.000501e-04 3 1  ON 61
ci_63                -5.128106e-04 3 1  ON 62
ci_64                -4.067355e-04 3 1  ON 63
ci_65                -3.135725e-04 3 1  ON 64
ci_66                -6.969375e-04 3 1  ON 65
ci_67                -5.894662e-04 3 1  ON 66
ci_68                -6.488133e-04 3 1  ON 67
ci_69                -1.883427e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1728e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.8047
    reference variance = 0.61014
====================================================
  Execution time = 2.5201e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5365e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4874e-01
  Total weights = 1.964242573e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5279e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436212946769
                                         uncertainty =       0.002728672058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436212946769
                                         uncertainty =       0.002728672058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467045735
  error estimate for blocks of size 2^( 2) =       0.000492392931
  error estimate for blocks of size 2^( 3) =       0.000515969764
  error estimate for blocks of size 2^( 4) =       0.000533118195
  error estimate for blocks of size 2^( 5) =       0.000543920956
  error estimate for blocks of size 2^( 6) =       0.000548693938
  error estimate for blocks of size 2^( 7) =       0.000551450706

      target function =      -0.746387876882
              le_mean =     -22.814273226789
             les_mean =     520.939799614871
             stat err =       0.000544295949
             autocorr =       1.358161397047
   target nu stat err =       0.000544295949
   target dn stat err =       0.003589390346
      target stat err =       0.003034938731
              std dev =       0.660502412886
             le_variance =       0.436263437428


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281427322679e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746399360061       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746399360070       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746399360071       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746399360071       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746399360072       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746399360072       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746399360072       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746399360072       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746399360072       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746399357533       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+06 is 9.486662e-11

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746399360061       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746399360063       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746399360064       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746399360064       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746399353740       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746399366636       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746399361227       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746399359521       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746399360663       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746399375313       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+06 is 2.371672e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746399360061       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746399360062       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746399360062       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746399360062       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746399360062       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746399335490       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746399305946       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746399410766       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746399364130       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746399293078       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+07 is 5.929200e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.336389 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9738e+01
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354167e-03 3 1  ON 7
ci_09                -9.236159e-03 3 1  ON 8
ci_10                -9.226445e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627892e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058109e-03 3 1  ON 14
ci_16                 7.299945e-03 3 1  ON 15
ci_17                -7.468963e-03 3 1  ON 16
ci_18                -7.185616e-03 3 1  ON 17
ci_19                 9.309460e-03 3 1  ON 18
ci_20                 6.818791e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150442e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505845e-03 3 1  ON 27
ci_29                 2.138172e-03 3 1  ON 28
ci_30                -1.586268e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313337e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461961e-03 3 1  ON 33
ci_35                 1.221734e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287675e-04 3 1  ON 37
ci_39                -6.422541e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208532e-03 3 1  ON 41
ci_43                -2.700305e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300585e-04 3 1  ON 44
ci_46                -5.317781e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704714e-04 3 1  ON 47
ci_49                -9.525969e-04 3 1  ON 48
ci_50                -7.380912e-04 3 1  ON 49
ci_51                 3.640962e-04 3 1  ON 50
ci_52                 3.764073e-04 3 1  ON 51
ci_53                -6.473192e-04 3 1  ON 52
ci_54                -9.086581e-04 3 1  ON 53
ci_55                -6.740937e-04 3 1  ON 54
ci_56                 1.893487e-03 3 1  ON 55
ci_57                 1.812210e-03 3 1  ON 56
ci_58                -8.217758e-04 3 1  ON 57
ci_59                -9.599671e-04 3 1  ON 58
ci_60                 6.219802e-04 3 1  ON 59
ci_61                 5.642852e-04 3 1  ON 60
ci_62                -3.000501e-04 3 1  ON 61
ci_63                -5.128106e-04 3 1  ON 62
ci_64                -4.067355e-04 3 1  ON 63
ci_65                -3.135725e-04 3 1  ON 64
ci_66                -6.969375e-04 3 1  ON 65
ci_67                -5.894662e-04 3 1  ON 66
ci_68                -6.488133e-04 3 1  ON 67
ci_69                -1.883427e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.7418
    reference variance = 0.258221
====================================================
  Execution time = 2.6519e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4633e-01
  Total weights = 1.9643e+06
  Execution time = 3.5194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432954537787
                                         uncertainty =       0.002314563218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432954537787
                                         uncertainty =       0.002314563218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465261540
  error estimate for blocks of size 2^( 2) =       0.000490520067
  error estimate for blocks of size 2^( 3) =       0.000514828252
  error estimate for blocks of size 2^( 4) =       0.000532859582
  error estimate for blocks of size 2^( 5) =       0.000545208768
  error estimate for blocks of size 2^( 6) =       0.000550983224
  error estimate for blocks of size 2^( 7) =       0.000554725933

      target function =      -0.748394537118
              le_mean =     -22.814153571942
             les_mean =     520.931929546334
             stat err =       0.000545944377
             autocorr =       1.376900273009
   target nu stat err =       0.000545944377
   target dn stat err =       0.002819374929
      target stat err =       0.002425618253
              std dev =       0.657979180122
             le_variance =       0.432936601474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432954537774
                                         uncertainty =       0.002314563220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432954537774
                                         uncertainty =       0.002314563220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465261540
  error estimate for blocks of size 2^( 2) =       0.000490520067
  error estimate for blocks of size 2^( 3) =       0.000514828252
  error estimate for blocks of size 2^( 4) =       0.000532859582
  error estimate for blocks of size 2^( 5) =       0.000545208768
  error estimate for blocks of size 2^( 6) =       0.000550983224
  error estimate for blocks of size 2^( 7) =       0.000554725933

      target function =      -0.748394537144
              le_mean =     -22.814153571943
             les_mean =     520.931929546318
             stat err =       0.000545944377
             autocorr =       1.376900273061
   target nu stat err =       0.000545944377
   target dn stat err =       0.002819374928
      target stat err =       0.002425618252
              std dev =       0.657979180113
             le_variance =       0.432936601462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432954537780
                                         uncertainty =       0.002314563219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432954537780
                                         uncertainty =       0.002314563219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465261540
  error estimate for blocks of size 2^( 2) =       0.000490520067
  error estimate for blocks of size 2^( 3) =       0.000514828252
  error estimate for blocks of size 2^( 4) =       0.000532859582
  error estimate for blocks of size 2^( 5) =       0.000545208768
  error estimate for blocks of size 2^( 6) =       0.000550983224
  error estimate for blocks of size 2^( 7) =       0.000554725933

      target function =      -0.748394537131
              le_mean =     -22.814153571943
             les_mean =     520.931929546326
             stat err =       0.000545944377
             autocorr =       1.376900273039
   target nu stat err =       0.000545944377
   target dn stat err =       0.002819374928
      target stat err =       0.002425618252
              std dev =       0.657979180118
             le_variance =       0.432936601468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432954537786
                                         uncertainty =       0.002314563218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432954537786
                                         uncertainty =       0.002314563218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465261540
  error estimate for blocks of size 2^( 2) =       0.000490520067
  error estimate for blocks of size 2^( 3) =       0.000514828252
  error estimate for blocks of size 2^( 4) =       0.000532859582
  error estimate for blocks of size 2^( 5) =       0.000545208768
  error estimate for blocks of size 2^( 6) =       0.000550983224
  error estimate for blocks of size 2^( 7) =       0.000554725933

      target function =      -0.748394537120
              le_mean =     -22.814153571942
             les_mean =     520.931929546333
             stat err =       0.000545944377
             autocorr =       1.376900273014
   target nu stat err =       0.000545944377
   target dn stat err =       0.002819374929
      target stat err =       0.002425618253
              std dev =       0.657979180122
             le_variance =       0.432936601473


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748394537118        initial
     2.3283e+06     2.3283e+07             9.4867e-11        -0.748394537144  <--
     9.3132e+06     9.3132e+07             2.3717e-11        -0.748394537131
     3.7253e+07     3.7253e+08             5.9292e-12        -0.748394537120

*****************************************************************************
Applying the update for shift_i =   2.3283e+06     and shift_s =   2.3283e+07
*****************************************************************************

  Execution time = 4.4166e+01
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354167e-03 3 1  ON 7
ci_09                -9.236159e-03 3 1  ON 8
ci_10                -9.226445e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627892e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058109e-03 3 1  ON 14
ci_16                 7.299945e-03 3 1  ON 15
ci_17                -7.468963e-03 3 1  ON 16
ci_18                -7.185616e-03 3 1  ON 17
ci_19                 9.309460e-03 3 1  ON 18
ci_20                 6.818791e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150442e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505845e-03 3 1  ON 27
ci_29                 2.138172e-03 3 1  ON 28
ci_30                -1.586268e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313337e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461961e-03 3 1  ON 33
ci_35                 1.221734e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287675e-04 3 1  ON 37
ci_39                -6.422541e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208532e-03 3 1  ON 41
ci_43                -2.700305e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300585e-04 3 1  ON 44
ci_46                -5.317781e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704714e-04 3 1  ON 47
ci_49                -9.525969e-04 3 1  ON 48
ci_50                -7.380912e-04 3 1  ON 49
ci_51                 3.640961e-04 3 1  ON 50
ci_52                 3.764072e-04 3 1  ON 51
ci_53                -6.473192e-04 3 1  ON 52
ci_54                -9.086581e-04 3 1  ON 53
ci_55                -6.740937e-04 3 1  ON 54
ci_56                 1.893487e-03 3 1  ON 55
ci_57                 1.812210e-03 3 1  ON 56
ci_58                -8.217758e-04 3 1  ON 57
ci_59                -9.599671e-04 3 1  ON 58
ci_60                 6.219802e-04 3 1  ON 59
ci_61                 5.642852e-04 3 1  ON 60
ci_62                -3.000501e-04 3 1  ON 61
ci_63                -5.128106e-04 3 1  ON 62
ci_64                -4.067355e-04 3 1  ON 63
ci_65                -3.135725e-04 3 1  ON 64
ci_66                -6.969375e-04 3 1  ON 65
ci_67                -5.894662e-04 3 1  ON 66
ci_68                -6.488133e-04 3 1  ON 67
ci_69                -1.883427e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3909e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.7746
    reference variance = 0.386651
====================================================
  Execution time = 2.5104e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5373e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4553e-01
  Total weights = 1.964199816e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433444549045
                                         uncertainty =       0.002208945970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433444549045
                                         uncertainty =       0.002208945970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465509771
  error estimate for blocks of size 2^( 2) =       0.000491217364
  error estimate for blocks of size 2^( 3) =       0.000515000538
  error estimate for blocks of size 2^( 4) =       0.000532258280
  error estimate for blocks of size 2^( 5) =       0.000542961611
  error estimate for blocks of size 2^( 6) =       0.000550292767
  error estimate for blocks of size 2^( 7) =       0.000552397670

      target function =      -0.749062819967
              le_mean =     -22.814648041687
             les_mean =     520.953694774061
             stat err =       0.000544477582
             autocorr =       1.368051364037
   target nu stat err =       0.000544477582
   target dn stat err =       0.002741397997
      target stat err =       0.002368200841
              std dev =       0.658330231990
             le_variance =       0.433398694352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281464804169e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749069340511       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749069340546       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749069340553       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749069340554       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749069340554       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749069340554       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749069340554       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749069340554       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749069340554       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749069340554       residual = 1.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+05 is 4.610975e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749069340511       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749069340520       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749069340522       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749069340522       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749069340522       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749069340522       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749069340522       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749069340522       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749069343507       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749069340522       residual = 1.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+06 is 1.152744e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749069340511       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749069340513       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749069340514       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749069340514       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749069340514       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749069340514       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749069340514       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749069340514       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749069340514       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749069326093       residual = 1.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+06 is 2.881864e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.339865 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9647e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354167e-03 3 1  ON 7
ci_09                -9.236159e-03 3 1  ON 8
ci_10                -9.226445e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627892e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058109e-03 3 1  ON 14
ci_16                 7.299945e-03 3 1  ON 15
ci_17                -7.468963e-03 3 1  ON 16
ci_18                -7.185616e-03 3 1  ON 17
ci_19                 9.309460e-03 3 1  ON 18
ci_20                 6.818791e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150442e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505845e-03 3 1  ON 27
ci_29                 2.138172e-03 3 1  ON 28
ci_30                -1.586268e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313337e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461961e-03 3 1  ON 33
ci_35                 1.221734e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287675e-04 3 1  ON 37
ci_39                -6.422541e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208532e-03 3 1  ON 41
ci_43                -2.700305e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300585e-04 3 1  ON 44
ci_46                -5.317781e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704714e-04 3 1  ON 47
ci_49                -9.525969e-04 3 1  ON 48
ci_50                -7.380912e-04 3 1  ON 49
ci_51                 3.640961e-04 3 1  ON 50
ci_52                 3.764072e-04 3 1  ON 51
ci_53                -6.473192e-04 3 1  ON 52
ci_54                -9.086581e-04 3 1  ON 53
ci_55                -6.740938e-04 3 1  ON 54
ci_56                 1.893487e-03 3 1  ON 55
ci_57                 1.812210e-03 3 1  ON 56
ci_58                -8.217758e-04 3 1  ON 57
ci_59                -9.599671e-04 3 1  ON 58
ci_60                 6.219802e-04 3 1  ON 59
ci_61                 5.642852e-04 3 1  ON 60
ci_62                -3.000501e-04 3 1  ON 61
ci_63                -5.128106e-04 3 1  ON 62
ci_64                -4.067355e-04 3 1  ON 63
ci_65                -3.135725e-04 3 1  ON 64
ci_66                -6.969375e-04 3 1  ON 65
ci_67                -5.894662e-04 3 1  ON 66
ci_68                -6.488133e-04 3 1  ON 67
ci_69                -1.883427e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.8683
    reference variance = 0.595613
====================================================
  Execution time = 2.4384e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5106e-01
  Total weights = 1.9644e+06
  Execution time = 3.5135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438739105861
                                         uncertainty =       0.002980863100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438739105861
                                         uncertainty =       0.002980863100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468380205
  error estimate for blocks of size 2^( 2) =       0.000493744624
  error estimate for blocks of size 2^( 3) =       0.000517344607
  error estimate for blocks of size 2^( 4) =       0.000535138141
  error estimate for blocks of size 2^( 5) =       0.000545152937
  error estimate for blocks of size 2^( 6) =       0.000554168010
  error estimate for blocks of size 2^( 7) =       0.000557488410

      target function =      -0.744467897741
              le_mean =     -22.814558296551
             les_mean =     520.955131059710
             stat err =       0.000547986875
             autocorr =       1.368810249648
   target nu stat err =       0.000547986875
   target dn stat err =       0.003556596812
      target stat err =       0.002995263148
              std dev =       0.662389637840
             le_variance =       0.438760032317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438739105771
                                         uncertainty =       0.002980863098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438739105771
                                         uncertainty =       0.002980863098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468380205
  error estimate for blocks of size 2^( 2) =       0.000493744624
  error estimate for blocks of size 2^( 3) =       0.000517344607
  error estimate for blocks of size 2^( 4) =       0.000535138141
  error estimate for blocks of size 2^( 5) =       0.000545152937
  error estimate for blocks of size 2^( 6) =       0.000554168010
  error estimate for blocks of size 2^( 7) =       0.000557488410

      target function =      -0.744467898729
              le_mean =     -22.814558296556
             les_mean =     520.955131058712
             stat err =       0.000547986875
             autocorr =       1.368810250038
   target nu stat err =       0.000547986875
   target dn stat err =       0.003556596696
      target stat err =       0.002995263063
              std dev =       0.662389637772
             le_variance =       0.438760032227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438739105816
                                         uncertainty =       0.002980863099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438739105816
                                         uncertainty =       0.002980863099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468380205
  error estimate for blocks of size 2^( 2) =       0.000493744624
  error estimate for blocks of size 2^( 3) =       0.000517344607
  error estimate for blocks of size 2^( 4) =       0.000535138141
  error estimate for blocks of size 2^( 5) =       0.000545152937
  error estimate for blocks of size 2^( 6) =       0.000554168010
  error estimate for blocks of size 2^( 7) =       0.000557488410

      target function =      -0.744467898235
              le_mean =     -22.814558296553
             les_mean =     520.955131059211
             stat err =       0.000547986875
             autocorr =       1.368810249847
   target nu stat err =       0.000547986875
   target dn stat err =       0.003556596754
      target stat err =       0.002995263106
              std dev =       0.662389637806
             le_variance =       0.438760032272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438739105856
                                         uncertainty =       0.002980863100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438739105856
                                         uncertainty =       0.002980863100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468380205
  error estimate for blocks of size 2^( 2) =       0.000493744624
  error estimate for blocks of size 2^( 3) =       0.000517344607
  error estimate for blocks of size 2^( 4) =       0.000535138141
  error estimate for blocks of size 2^( 5) =       0.000545152937
  error estimate for blocks of size 2^( 6) =       0.000554168010
  error estimate for blocks of size 2^( 7) =       0.000557488410

      target function =      -0.744467897803
              le_mean =     -22.814558296552
             les_mean =     520.955131059648
             stat err =       0.000547986875
             autocorr =       1.368810249657
   target nu stat err =       0.000547986875
   target dn stat err =       0.003556596805
      target stat err =       0.002995263143
              std dev =       0.662389637835
             le_variance =       0.438760032312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744467897741        initial
     5.8208e+05     5.8208e+06             4.6110e-10        -0.744467898729  <--
     2.3283e+06     2.3283e+07             1.1527e-10        -0.744467898235
     9.3132e+06     9.3132e+07             2.8819e-11        -0.744467897803

*****************************************************************************
Applying the update for shift_i =   5.8208e+05     and shift_s =   5.8208e+06
*****************************************************************************

  Execution time = 4.1968e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354167e-03 3 1  ON 7
ci_09                -9.236159e-03 3 1  ON 8
ci_10                -9.226445e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627892e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058109e-03 3 1  ON 14
ci_16                 7.299945e-03 3 1  ON 15
ci_17                -7.468963e-03 3 1  ON 16
ci_18                -7.185616e-03 3 1  ON 17
ci_19                 9.309460e-03 3 1  ON 18
ci_20                 6.818791e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150442e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505845e-03 3 1  ON 27
ci_29                 2.138172e-03 3 1  ON 28
ci_30                -1.586268e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313337e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461961e-03 3 1  ON 33
ci_35                 1.221734e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287675e-04 3 1  ON 37
ci_39                -6.422541e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208532e-03 3 1  ON 41
ci_43                -2.700305e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300585e-04 3 1  ON 44
ci_46                -5.317781e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704715e-04 3 1  ON 47
ci_49                -9.525969e-04 3 1  ON 48
ci_50                -7.380912e-04 3 1  ON 49
ci_51                 3.640962e-04 3 1  ON 50
ci_52                 3.764072e-04 3 1  ON 51
ci_53                -6.473191e-04 3 1  ON 52
ci_54                -9.086580e-04 3 1  ON 53
ci_55                -6.740939e-04 3 1  ON 54
ci_56                 1.893486e-03 3 1  ON 55
ci_57                 1.812210e-03 3 1  ON 56
ci_58                -8.217758e-04 3 1  ON 57
ci_59                -9.599670e-04 3 1  ON 58
ci_60                 6.219802e-04 3 1  ON 59
ci_61                 5.642851e-04 3 1  ON 60
ci_62                -3.000501e-04 3 1  ON 61
ci_63                -5.128106e-04 3 1  ON 62
ci_64                -4.067355e-04 3 1  ON 63
ci_65                -3.135725e-04 3 1  ON 64
ci_66                -6.969375e-04 3 1  ON 65
ci_67                -5.894662e-04 3 1  ON 66
ci_68                -6.488134e-04 3 1  ON 67
ci_69                -1.883427e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1620e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.8427
    reference variance = 0.414623
====================================================
  Execution time = 2.5123e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4917e-01
  Total weights = 1.964356328e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434773144850
                                         uncertainty =       0.002031337089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434773144850
                                         uncertainty =       0.002031337089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466227464
  error estimate for blocks of size 2^( 2) =       0.000491801165
  error estimate for blocks of size 2^( 3) =       0.000515358585
  error estimate for blocks of size 2^( 4) =       0.000531968406
  error estimate for blocks of size 2^( 5) =       0.000543441865
  error estimate for blocks of size 2^( 6) =       0.000550530200
  error estimate for blocks of size 2^( 7) =       0.000555147043

      target function =      -0.746033899115
              le_mean =     -22.814070317881
             les_mean =     520.930972260114
             stat err =       0.000545271878
             autocorr =       1.367824865777
   target nu stat err =       0.000545271878
   target dn stat err =       0.002984117192
      target stat err =       0.002542539583
              std dev =       0.659345202772
             le_variance =       0.434736096418


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281407031788e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746041609515       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746041609633       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746041609650       residual = 6.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746041609650       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746041609773       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746041609868       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746041609970       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746041609798       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746041609824       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+05 is 1.699043e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746041609515       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746041609545       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746041609549       residual = 6.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746041609549       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746041609470       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746041609429       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746041609549       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746041609457       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746041609403       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+05 is 4.247607e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746041609515       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746041609523       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746041609524       residual = 6.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746041608272       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746041609524       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746041607993       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746041610878       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746041608629       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746041607890       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+06 is 1.061901e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.342891 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9686e+01
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354167e-03 3 1  ON 7
ci_09                -9.236159e-03 3 1  ON 8
ci_10                -9.226445e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627892e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058109e-03 3 1  ON 14
ci_16                 7.299945e-03 3 1  ON 15
ci_17                -7.468962e-03 3 1  ON 16
ci_18                -7.185616e-03 3 1  ON 17
ci_19                 9.309460e-03 3 1  ON 18
ci_20                 6.818791e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977842e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150442e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505845e-03 3 1  ON 27
ci_29                 2.138172e-03 3 1  ON 28
ci_30                -1.586268e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313337e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461961e-03 3 1  ON 33
ci_35                 1.221734e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287674e-04 3 1  ON 37
ci_39                -6.422540e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208532e-03 3 1  ON 41
ci_43                -2.700305e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300584e-04 3 1  ON 44
ci_46                -5.317781e-04 3 1  ON 45
ci_47                 1.304120e-03 3 1  ON 46
ci_48                 8.704715e-04 3 1  ON 47
ci_49                -9.525968e-04 3 1  ON 48
ci_50                -7.380912e-04 3 1  ON 49
ci_51                 3.640962e-04 3 1  ON 50
ci_52                 3.764072e-04 3 1  ON 51
ci_53                -6.473191e-04 3 1  ON 52
ci_54                -9.086580e-04 3 1  ON 53
ci_55                -6.740940e-04 3 1  ON 54
ci_56                 1.893486e-03 3 1  ON 55
ci_57                 1.812210e-03 3 1  ON 56
ci_58                -8.217757e-04 3 1  ON 57
ci_59                -9.599670e-04 3 1  ON 58
ci_60                 6.219803e-04 3 1  ON 59
ci_61                 5.642850e-04 3 1  ON 60
ci_62                -3.000501e-04 3 1  ON 61
ci_63                -5.128105e-04 3 1  ON 62
ci_64                -4.067356e-04 3 1  ON 63
ci_65                -3.135725e-04 3 1  ON 64
ci_66                -6.969375e-04 3 1  ON 65
ci_67                -5.894662e-04 3 1  ON 66
ci_68                -6.488134e-04 3 1  ON 67
ci_69                -1.883427e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.7097
    reference variance = 1.80475
====================================================
  Execution time = 2.4490e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5096e-01
  Total weights = 1.9641e+06
  Execution time = 3.5071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439069308922
                                         uncertainty =       0.003207697015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439069308922
                                         uncertainty =       0.003207697015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468569279
  error estimate for blocks of size 2^( 2) =       0.000493879427
  error estimate for blocks of size 2^( 3) =       0.000517611332
  error estimate for blocks of size 2^( 4) =       0.000535133787
  error estimate for blocks of size 2^( 5) =       0.000546104583
  error estimate for blocks of size 2^( 6) =       0.000553490658
  error estimate for blocks of size 2^( 7) =       0.000555633602

      target function =      -0.744550045036
              le_mean =     -22.813917668825
             les_mean =     520.925799037468
             stat err =       0.000547590658
             autocorr =       1.365728701662
   target nu stat err =       0.000547590658
   target dn stat err =       0.003575093680
      target stat err =       0.003007899120
              std dev =       0.662657029957
             le_variance =       0.439114339351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439069308579
                                         uncertainty =       0.003207696980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439069308579
                                         uncertainty =       0.003207696980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468569279
  error estimate for blocks of size 2^( 2) =       0.000493879427
  error estimate for blocks of size 2^( 3) =       0.000517611332
  error estimate for blocks of size 2^( 4) =       0.000535133787
  error estimate for blocks of size 2^( 5) =       0.000546104583
  error estimate for blocks of size 2^( 6) =       0.000553490658
  error estimate for blocks of size 2^( 7) =       0.000555633602

      target function =      -0.744550047626
              le_mean =     -22.813917668819
             les_mean =     520.925799034037
             stat err =       0.000547590658
             autocorr =       1.365728702822
   target nu stat err =       0.000547590658
   target dn stat err =       0.003575093761
      target stat err =       0.003007899205
              std dev =       0.662657029697
             le_variance =       0.439114339007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439069308750
                                         uncertainty =       0.003207696997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439069308750
                                         uncertainty =       0.003207696997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468569279
  error estimate for blocks of size 2^( 2) =       0.000493879427
  error estimate for blocks of size 2^( 3) =       0.000517611332
  error estimate for blocks of size 2^( 4) =       0.000535133787
  error estimate for blocks of size 2^( 5) =       0.000546104583
  error estimate for blocks of size 2^( 6) =       0.000553490658
  error estimate for blocks of size 2^( 7) =       0.000555633602

      target function =      -0.744550046331
              le_mean =     -22.813917668822
             les_mean =     520.925799035752
             stat err =       0.000547590658
             autocorr =       1.365728702249
   target nu stat err =       0.000547590658
   target dn stat err =       0.003575093721
      target stat err =       0.003007899162
              std dev =       0.662657029827
             le_variance =       0.439114339179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439069308901
                                         uncertainty =       0.003207697013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439069308901
                                         uncertainty =       0.003207697013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468569279
  error estimate for blocks of size 2^( 2) =       0.000493879427
  error estimate for blocks of size 2^( 3) =       0.000517611332
  error estimate for blocks of size 2^( 4) =       0.000535133787
  error estimate for blocks of size 2^( 5) =       0.000546104583
  error estimate for blocks of size 2^( 6) =       0.000553490658
  error estimate for blocks of size 2^( 7) =       0.000555633602

      target function =      -0.744550045198
              le_mean =     -22.813917668825
             les_mean =     520.925799037253
             stat err =       0.000547590658
             autocorr =       1.365728701735
   target nu stat err =       0.000547590658
   target dn stat err =       0.003575093685
      target stat err =       0.003007899125
              std dev =       0.662657029940
             le_variance =       0.439114339329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744550045036        initial
     1.4552e+05     1.4552e+06             1.6990e-09        -0.744550047626  <--
     5.8208e+05     5.8208e+06             4.2476e-10        -0.744550046331
     2.3283e+06     2.3283e+07             1.0619e-10        -0.744550045198

*****************************************************************************
Applying the update for shift_i =   1.4552e+05     and shift_s =   1.4552e+06
*****************************************************************************

  Execution time = 4.2051e+01
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354167e-03 3 1  ON 7
ci_09                -9.236159e-03 3 1  ON 8
ci_10                -9.226444e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627892e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058109e-03 3 1  ON 14
ci_16                 7.299945e-03 3 1  ON 15
ci_17                -7.468962e-03 3 1  ON 16
ci_18                -7.185616e-03 3 1  ON 17
ci_19                 9.309460e-03 3 1  ON 18
ci_20                 6.818791e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977841e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150443e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505846e-03 3 1  ON 27
ci_29                 2.138171e-03 3 1  ON 28
ci_30                -1.586267e-03 3 1  ON 29
ci_31                -1.612306e-03 3 1  ON 30
ci_32                -1.313338e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461961e-03 3 1  ON 33
ci_35                 1.221734e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287672e-04 3 1  ON 37
ci_39                -6.422538e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208532e-03 3 1  ON 41
ci_43                -2.700305e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300583e-04 3 1  ON 44
ci_46                -5.317782e-04 3 1  ON 45
ci_47                 1.304121e-03 3 1  ON 46
ci_48                 8.704718e-04 3 1  ON 47
ci_49                -9.525965e-04 3 1  ON 48
ci_50                -7.380914e-04 3 1  ON 49
ci_51                 3.640964e-04 3 1  ON 50
ci_52                 3.764073e-04 3 1  ON 51
ci_53                -6.473191e-04 3 1  ON 52
ci_54                -9.086579e-04 3 1  ON 53
ci_55                -6.740943e-04 3 1  ON 54
ci_56                 1.893486e-03 3 1  ON 55
ci_57                 1.812209e-03 3 1  ON 56
ci_58                -8.217754e-04 3 1  ON 57
ci_59                -9.599668e-04 3 1  ON 58
ci_60                 6.219805e-04 3 1  ON 59
ci_61                 5.642848e-04 3 1  ON 60
ci_62                -3.000501e-04 3 1  ON 61
ci_63                -5.128104e-04 3 1  ON 62
ci_64                -4.067359e-04 3 1  ON 63
ci_65                -3.135724e-04 3 1  ON 64
ci_66                -6.969376e-04 3 1  ON 65
ci_67                -5.894660e-04 3 1  ON 66
ci_68                -6.488136e-04 3 1  ON 67
ci_69                -1.883427e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1742e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.7696
    reference variance = 0.704155
====================================================
  Execution time = 2.5255e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5115e-01
  Total weights = 1.964466870e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4877e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437134112919
                                         uncertainty =       0.002183732443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437134112919
                                         uncertainty =       0.002183732443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467587439
  error estimate for blocks of size 2^( 2) =       0.000492744252
  error estimate for blocks of size 2^( 3) =       0.000516594790
  error estimate for blocks of size 2^( 4) =       0.000534263247
  error estimate for blocks of size 2^( 5) =       0.000544346210
  error estimate for blocks of size 2^( 6) =       0.000552031791
  error estimate for blocks of size 2^( 7) =       0.000551202461

      target function =      -0.744396887949
              le_mean =     -22.814483506226
             les_mean =     520.951808211796
             stat err =       0.000545460927
             autocorr =       1.360822935526
   target nu stat err =       0.000545460927
   target dn stat err =       0.003019900607
      target stat err =       0.002561975926
              std dev =       0.661268498080
             le_variance =       0.437276026553


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281448350623e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744404779097       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744404779641       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744404779720       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744404779719       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744404779729       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744404779734       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744404779749       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744404779720       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744404779710       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+04 is 5.352960e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744404779097       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744404779233       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744404779253       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744404779258       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744404779271       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744404779194       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744404779138       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744404779260       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744404779260       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+05 is 1.338241e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744404779097       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744404779131       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744404779136       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744404779137       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744404779235       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744404779138       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744404780720       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744404780496       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744404779593       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+05 is 3.345602e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.345965 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9752e+01
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306566e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354166e-03 3 1  ON 7
ci_09                -9.236158e-03 3 1  ON 8
ci_10                -9.226444e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627892e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058109e-03 3 1  ON 14
ci_16                 7.299945e-03 3 1  ON 15
ci_17                -7.468962e-03 3 1  ON 16
ci_18                -7.185616e-03 3 1  ON 17
ci_19                 9.309460e-03 3 1  ON 18
ci_20                 6.818790e-03 3 1  ON 19
ci_21                 8.774060e-03 3 1  ON 20
ci_22                 8.773340e-03 3 1  ON 21
ci_23                 4.977841e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150443e-03 3 1  ON 25
ci_27                 3.326764e-03 3 1  ON 26
ci_28                 2.505845e-03 3 1  ON 27
ci_29                 2.138171e-03 3 1  ON 28
ci_30                -1.586267e-03 3 1  ON 29
ci_31                -1.612305e-03 3 1  ON 30
ci_32                -1.313338e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461962e-03 3 1  ON 33
ci_35                 1.221734e-03 3 1  ON 34
ci_36                -1.116941e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287669e-04 3 1  ON 37
ci_39                -6.422539e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208532e-03 3 1  ON 41
ci_43                -2.700305e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300583e-04 3 1  ON 44
ci_46                -5.317780e-04 3 1  ON 45
ci_47                 1.304121e-03 3 1  ON 46
ci_48                 8.704717e-04 3 1  ON 47
ci_49                -9.525969e-04 3 1  ON 48
ci_50                -7.380914e-04 3 1  ON 49
ci_51                 3.640963e-04 3 1  ON 50
ci_52                 3.764071e-04 3 1  ON 51
ci_53                -6.473191e-04 3 1  ON 52
ci_54                -9.086575e-04 3 1  ON 53
ci_55                -6.740943e-04 3 1  ON 54
ci_56                 1.893486e-03 3 1  ON 55
ci_57                 1.812209e-03 3 1  ON 56
ci_58                -8.217751e-04 3 1  ON 57
ci_59                -9.599671e-04 3 1  ON 58
ci_60                 6.219803e-04 3 1  ON 59
ci_61                 5.642847e-04 3 1  ON 60
ci_62                -3.000496e-04 3 1  ON 61
ci_63                -5.128102e-04 3 1  ON 62
ci_64                -4.067358e-04 3 1  ON 63
ci_65                -3.135720e-04 3 1  ON 64
ci_66                -6.969373e-04 3 1  ON 65
ci_67                -5.894662e-04 3 1  ON 66
ci_68                -6.488133e-04 3 1  ON 67
ci_69                -1.883428e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.7325
    reference variance = 0.403585
====================================================
  Execution time = 2.4588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4866e-01
  Total weights = 1.9642e+06
  Execution time = 3.5089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436533738082
                                         uncertainty =       0.002701574057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436533738082
                                         uncertainty =       0.002701574057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467191548
  error estimate for blocks of size 2^( 2) =       0.000492415658
  error estimate for blocks of size 2^( 3) =       0.000515743426
  error estimate for blocks of size 2^( 4) =       0.000533308152
  error estimate for blocks of size 2^( 5) =       0.000544238607
  error estimate for blocks of size 2^( 6) =       0.000552602846
  error estimate for blocks of size 2^( 7) =       0.000556441028

      target function =      -0.746452081409
              le_mean =     -22.814487172085
             les_mean =     520.949487700171
             stat err =       0.000546647658
             autocorr =       1.369068030716
   target nu stat err =       0.000546647658
   target dn stat err =       0.003288412841
      target stat err =       0.002792899035
              std dev =       0.660708623453
             le_variance =       0.436535885106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436533736804
                                         uncertainty =       0.002701573970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436533736804
                                         uncertainty =       0.002701573970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467191547
  error estimate for blocks of size 2^( 2) =       0.000492415657
  error estimate for blocks of size 2^( 3) =       0.000515743426
  error estimate for blocks of size 2^( 4) =       0.000533308153
  error estimate for blocks of size 2^( 5) =       0.000544238607
  error estimate for blocks of size 2^( 6) =       0.000552602846
  error estimate for blocks of size 2^( 7) =       0.000556441028

      target function =      -0.746452083389
              le_mean =     -22.814487172067
             les_mean =     520.949487696949
             stat err =       0.000546647659
             autocorr =       1.369068036109
   target nu stat err =       0.000546647659
   target dn stat err =       0.003288412797
      target stat err =       0.002792899014
              std dev =       0.660708622489
             le_variance =       0.436535883831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436533737443
                                         uncertainty =       0.002701574013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436533737443
                                         uncertainty =       0.002701574013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467191548
  error estimate for blocks of size 2^( 2) =       0.000492415658
  error estimate for blocks of size 2^( 3) =       0.000515743426
  error estimate for blocks of size 2^( 4) =       0.000533308153
  error estimate for blocks of size 2^( 5) =       0.000544238607
  error estimate for blocks of size 2^( 6) =       0.000552602846
  error estimate for blocks of size 2^( 7) =       0.000556441028

      target function =      -0.746452082399
              le_mean =     -22.814487172076
             les_mean =     520.949487698560
             stat err =       0.000546647658
             autocorr =       1.369068033416
   target nu stat err =       0.000546647658
   target dn stat err =       0.003288412819
      target stat err =       0.002792899025
              std dev =       0.660708622971
             le_variance =       0.436535884468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436533738002
                                         uncertainty =       0.002701574051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436533738002
                                         uncertainty =       0.002701574051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467191548
  error estimate for blocks of size 2^( 2) =       0.000492415658
  error estimate for blocks of size 2^( 3) =       0.000515743426
  error estimate for blocks of size 2^( 4) =       0.000533308152
  error estimate for blocks of size 2^( 5) =       0.000544238607
  error estimate for blocks of size 2^( 6) =       0.000552602846
  error estimate for blocks of size 2^( 7) =       0.000556441028

      target function =      -0.746452081533
              le_mean =     -22.814487172084
             les_mean =     520.949487699969
             stat err =       0.000546647658
             autocorr =       1.369068031071
   target nu stat err =       0.000546647658
   target dn stat err =       0.003288412838
      target stat err =       0.002792899034
              std dev =       0.660708623393
             le_variance =       0.436535885026


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746452081409        initial
     3.6380e+04     3.6380e+05             5.3530e-09        -0.746452083389  <--
     1.4552e+05     1.4552e+06             1.3382e-09        -0.746452082399
     5.8208e+05     5.8208e+06             3.3456e-10        -0.746452081533

*****************************************************************************
Applying the update for shift_i =   3.6380e+04     and shift_s =   3.6380e+05
*****************************************************************************

  Execution time = 4.2201e+01
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098723e-02 3 1  ON 2
ci_04                 2.777620e-02 3 1  ON 3
ci_05                -2.306565e-02 3 1  ON 4
ci_06                -2.274489e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354164e-03 3 1  ON 7
ci_09                -9.236155e-03 3 1  ON 8
ci_10                -9.226444e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627892e-03 3 1  ON 11
ci_13                 1.265619e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058108e-03 3 1  ON 14
ci_16                 7.299944e-03 3 1  ON 15
ci_17                -7.468962e-03 3 1  ON 16
ci_18                -7.185615e-03 3 1  ON 17
ci_19                 9.309459e-03 3 1  ON 18
ci_20                 6.818788e-03 3 1  ON 19
ci_21                 8.774059e-03 3 1  ON 20
ci_22                 8.773341e-03 3 1  ON 21
ci_23                 4.977840e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150443e-03 3 1  ON 25
ci_27                 3.326763e-03 3 1  ON 26
ci_28                 2.505844e-03 3 1  ON 27
ci_29                 2.138171e-03 3 1  ON 28
ci_30                -1.586266e-03 3 1  ON 29
ci_31                -1.612305e-03 3 1  ON 30
ci_32                -1.313338e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461963e-03 3 1  ON 33
ci_35                 1.221732e-03 3 1  ON 34
ci_36                -1.116940e-03 3 1  ON 35
ci_37                -1.122366e-03 3 1  ON 36
ci_38                -5.287658e-04 3 1  ON 37
ci_39                -6.422542e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208532e-03 3 1  ON 41
ci_43                -2.700304e-03 3 1  ON 42
ci_44                -1.763801e-03 3 1  ON 43
ci_45                -6.300583e-04 3 1  ON 44
ci_46                -5.317773e-04 3 1  ON 45
ci_47                 1.304123e-03 3 1  ON 46
ci_48                 8.704713e-04 3 1  ON 47
ci_49                -9.525980e-04 3 1  ON 48
ci_50                -7.380915e-04 3 1  ON 49
ci_51                 3.640959e-04 3 1  ON 50
ci_52                 3.764066e-04 3 1  ON 51
ci_53                -6.473189e-04 3 1  ON 52
ci_54                -9.086565e-04 3 1  ON 53
ci_55                -6.740943e-04 3 1  ON 54
ci_56                 1.893486e-03 3 1  ON 55
ci_57                 1.812210e-03 3 1  ON 56
ci_58                -8.217739e-04 3 1  ON 57
ci_59                -9.599680e-04 3 1  ON 58
ci_60                 6.219798e-04 3 1  ON 59
ci_61                 5.642843e-04 3 1  ON 60
ci_62                -3.000483e-04 3 1  ON 61
ci_63                -5.128098e-04 3 1  ON 62
ci_64                -4.067355e-04 3 1  ON 63
ci_65                -3.135710e-04 3 1  ON 64
ci_66                -6.969362e-04 3 1  ON 65
ci_67                -5.894669e-04 3 1  ON 66
ci_68                -6.488125e-04 3 1  ON 67
ci_69                -1.883432e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1958e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.7981
    reference variance = 0.309029
====================================================
  Execution time = 2.5144e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4810e-01
  Total weights = 1.964185766e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5197e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433648718758
                                         uncertainty =       0.001793014720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433648718758
                                         uncertainty =       0.001793014720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465640455
  error estimate for blocks of size 2^( 2) =       0.000491048022
  error estimate for blocks of size 2^( 3) =       0.000515168196
  error estimate for blocks of size 2^( 4) =       0.000532891193
  error estimate for blocks of size 2^( 5) =       0.000544606055
  error estimate for blocks of size 2^( 6) =       0.000550393347
  error estimate for blocks of size 2^( 7) =       0.000554749430

      target function =      -0.746921382952
              le_mean =     -22.814373614566
             les_mean =     520.943743126247
             stat err =       0.000545660006
             autocorr =       1.373228591070
   target nu stat err =       0.000545660006
   target dn stat err =       0.002795844078
      target stat err =       0.002398190491
              std dev =       0.658515047076
             le_variance =       0.433642067225


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281437361457e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746928080205       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746928082354       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746928083352       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746928083576       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746928083641       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746928083636       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746928083638       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746928083633       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746928083612       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746928083614       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746928083640       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+03 is 2.348997e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746928080205       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746928080742       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746928080992       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746928081049       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746928081059       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746928080968       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746928081089       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746928081037       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746928081035       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746928081011       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746928081059       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+04 is 5.872506e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746928080205       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746928080339       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746928080402       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746928080497       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746928080306       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746928080492       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746928080690       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746928080166       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746928080378       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746928080499       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746928080614       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+05 is 1.468127e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.350044 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9673e+01
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109419e-02 3 1  ON 1
ci_03                -3.098722e-02 3 1  ON 2
ci_04                 2.777619e-02 3 1  ON 3
ci_05                -2.306565e-02 3 1  ON 4
ci_06                -2.274488e-02 3 1  ON 5
ci_07                 2.694791e-02 3 1  ON 6
ci_08                -6.354162e-03 3 1  ON 7
ci_09                -9.236154e-03 3 1  ON 8
ci_10                -9.226440e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627892e-03 3 1  ON 11
ci_13                 1.265620e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058108e-03 3 1  ON 14
ci_16                 7.299944e-03 3 1  ON 15
ci_17                -7.468960e-03 3 1  ON 16
ci_18                -7.185612e-03 3 1  ON 17
ci_19                 9.309457e-03 3 1  ON 18
ci_20                 6.818787e-03 3 1  ON 19
ci_21                 8.774058e-03 3 1  ON 20
ci_22                 8.773341e-03 3 1  ON 21
ci_23                 4.977839e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150441e-03 3 1  ON 25
ci_27                 3.326762e-03 3 1  ON 26
ci_28                 2.505842e-03 3 1  ON 27
ci_29                 2.138171e-03 3 1  ON 28
ci_30                -1.586267e-03 3 1  ON 29
ci_31                -1.612304e-03 3 1  ON 30
ci_32                -1.313338e-03 3 1  ON 31
ci_33                -1.023876e-03 3 1  ON 32
ci_34                 1.461963e-03 3 1  ON 33
ci_35                 1.221732e-03 3 1  ON 34
ci_36                -1.116940e-03 3 1  ON 35
ci_37                -1.122367e-03 3 1  ON 36
ci_38                -5.287665e-04 3 1  ON 37
ci_39                -6.422538e-04 3 1  ON 38
ci_40                -1.673121e-03 3 1  ON 39
ci_41                -1.413579e-03 3 1  ON 40
ci_42                -1.208531e-03 3 1  ON 41
ci_43                -2.700303e-03 3 1  ON 42
ci_44                -1.763802e-03 3 1  ON 43
ci_45                -6.300595e-04 3 1  ON 44
ci_46                -5.317773e-04 3 1  ON 45
ci_47                 1.304124e-03 3 1  ON 46
ci_48                 8.704724e-04 3 1  ON 47
ci_49                -9.525977e-04 3 1  ON 48
ci_50                -7.380910e-04 3 1  ON 49
ci_51                 3.640957e-04 3 1  ON 50
ci_52                 3.764062e-04 3 1  ON 51
ci_53                -6.473200e-04 3 1  ON 52
ci_54                -9.086565e-04 3 1  ON 53
ci_55                -6.740936e-04 3 1  ON 54
ci_56                 1.893485e-03 3 1  ON 55
ci_57                 1.812209e-03 3 1  ON 56
ci_58                -8.217750e-04 3 1  ON 57
ci_59                -9.599686e-04 3 1  ON 58
ci_60                 6.219812e-04 3 1  ON 59
ci_61                 5.642832e-04 3 1  ON 60
ci_62                -3.000484e-04 3 1  ON 61
ci_63                -5.128099e-04 3 1  ON 62
ci_64                -4.067357e-04 3 1  ON 63
ci_65                -3.135683e-04 3 1  ON 64
ci_66                -6.969355e-04 3 1  ON 65
ci_67                -5.894672e-04 3 1  ON 66
ci_68                -6.488152e-04 3 1  ON 67
ci_69                -1.883450e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.7495
    reference variance = 0.340326
====================================================
  Execution time = 2.6254e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5260e-01
  Total weights = 1.9644e+06
  Execution time = 3.5083e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439003070862
                                         uncertainty =       0.003274978240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439003070862
                                         uncertainty =       0.003274978240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468477298
  error estimate for blocks of size 2^( 2) =       0.000493992762
  error estimate for blocks of size 2^( 3) =       0.000517865642
  error estimate for blocks of size 2^( 4) =       0.000535531352
  error estimate for blocks of size 2^( 5) =       0.000546218385
  error estimate for blocks of size 2^( 6) =       0.000553167235
  error estimate for blocks of size 2^( 7) =       0.000555968185

      target function =      -0.743197352529
              le_mean =     -22.815061535047
             les_mean =     520.979630661964
             stat err =       0.000547721289
             autocorr =       1.366916996979
   target nu stat err =       0.000547721289
   target dn stat err =       0.004174627904
      target stat err =       0.003486736607
              std dev =       0.662526947847
             le_variance =       0.438941956624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439003065345
                                         uncertainty =       0.003274978463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439003065345
                                         uncertainty =       0.003274978463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468477295
  error estimate for blocks of size 2^( 2) =       0.000493992761
  error estimate for blocks of size 2^( 3) =       0.000517865642
  error estimate for blocks of size 2^( 4) =       0.000535531353
  error estimate for blocks of size 2^( 5) =       0.000546218387
  error estimate for blocks of size 2^( 6) =       0.000553167237
  error estimate for blocks of size 2^( 7) =       0.000555968186

      target function =      -0.743197368529
              le_mean =     -22.815061535053
             les_mean =     520.979630642788
             stat err =       0.000547721291
             autocorr =       1.366917020922
   target nu stat err =       0.000547721291
   target dn stat err =       0.004174626674
      target stat err =       0.003486735759
              std dev =       0.662526943677
             le_variance =       0.438941951098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439003068104
                                         uncertainty =       0.003274978352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439003068104
                                         uncertainty =       0.003274978352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468477296
  error estimate for blocks of size 2^( 2) =       0.000493992761
  error estimate for blocks of size 2^( 3) =       0.000517865642
  error estimate for blocks of size 2^( 4) =       0.000535531352
  error estimate for blocks of size 2^( 5) =       0.000546218386
  error estimate for blocks of size 2^( 6) =       0.000553167236
  error estimate for blocks of size 2^( 7) =       0.000555968185

      target function =      -0.743197360530
              le_mean =     -22.815061535050
             les_mean =     520.979630652374
             stat err =       0.000547721290
             autocorr =       1.366917008947
   target nu stat err =       0.000547721290
   target dn stat err =       0.004174627289
      target stat err =       0.003486736183
              std dev =       0.662526945762
             le_variance =       0.438941953861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439003070517
                                         uncertainty =       0.003274978254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439003070517
                                         uncertainty =       0.003274978254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468477297
  error estimate for blocks of size 2^( 2) =       0.000493992762
  error estimate for blocks of size 2^( 3) =       0.000517865642
  error estimate for blocks of size 2^( 4) =       0.000535531352
  error estimate for blocks of size 2^( 5) =       0.000546218385
  error estimate for blocks of size 2^( 6) =       0.000553167235
  error estimate for blocks of size 2^( 7) =       0.000555968185

      target function =      -0.743197353530
              le_mean =     -22.815061535048
             les_mean =     520.979630660765
             stat err =       0.000547721289
             autocorr =       1.366916998473
   target nu stat err =       0.000547721289
   target dn stat err =       0.004174627827
      target stat err =       0.003486736554
              std dev =       0.662526947587
             le_variance =       0.438941956278


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743197352529        initial
     9.0949e+03     9.0949e+04             2.3490e-08        -0.743197368529  <--
     3.6380e+04     3.6380e+05             5.8725e-09        -0.743197360530
     1.4552e+05     1.4552e+06             1.4681e-09        -0.743197353530

*****************************************************************************
Applying the update for shift_i =   9.0949e+03     and shift_s =   9.0949e+04
*****************************************************************************

  Execution time = 4.3829e+01
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109418e-02 3 1  ON 1
ci_03                -3.098720e-02 3 1  ON 2
ci_04                 2.777618e-02 3 1  ON 3
ci_05                -2.306563e-02 3 1  ON 4
ci_06                -2.274487e-02 3 1  ON 5
ci_07                 2.694790e-02 3 1  ON 6
ci_08                -6.354154e-03 3 1  ON 7
ci_09                -9.236151e-03 3 1  ON 8
ci_10                -9.226429e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627893e-03 3 1  ON 11
ci_13                 1.265620e-02 3 1  ON 12
ci_14                 1.311553e-02 3 1  ON 13
ci_15                 7.058108e-03 3 1  ON 14
ci_16                 7.299943e-03 3 1  ON 15
ci_17                -7.468955e-03 3 1  ON 16
ci_18                -7.185604e-03 3 1  ON 17
ci_19                 9.309452e-03 3 1  ON 18
ci_20                 6.818783e-03 3 1  ON 19
ci_21                 8.774057e-03 3 1  ON 20
ci_22                 8.773341e-03 3 1  ON 21
ci_23                 4.977836e-03 3 1  ON 22
ci_24                 4.388754e-03 3 1  ON 23
ci_25                 3.124209e-03 3 1  ON 24
ci_26                 3.150437e-03 3 1  ON 25
ci_27                 3.326761e-03 3 1  ON 26
ci_28                 2.505835e-03 3 1  ON 27
ci_29                 2.138170e-03 3 1  ON 28
ci_30                -1.586268e-03 3 1  ON 29
ci_31                -1.612301e-03 3 1  ON 30
ci_32                -1.313336e-03 3 1  ON 31
ci_33                -1.023874e-03 3 1  ON 32
ci_34                 1.461964e-03 3 1  ON 33
ci_35                 1.221731e-03 3 1  ON 34
ci_36                -1.116939e-03 3 1  ON 35
ci_37                -1.122372e-03 3 1  ON 36
ci_38                -5.287687e-04 3 1  ON 37
ci_39                -6.422527e-04 3 1  ON 38
ci_40                -1.673122e-03 3 1  ON 39
ci_41                -1.413581e-03 3 1  ON 40
ci_42                -1.208528e-03 3 1  ON 41
ci_43                -2.700299e-03 3 1  ON 42
ci_44                -1.763804e-03 3 1  ON 43
ci_45                -6.300631e-04 3 1  ON 44
ci_46                -5.317773e-04 3 1  ON 45
ci_47                 1.304126e-03 3 1  ON 46
ci_48                 8.704755e-04 3 1  ON 47
ci_49                -9.525967e-04 3 1  ON 48
ci_50                -7.380894e-04 3 1  ON 49
ci_51                 3.640951e-04 3 1  ON 50
ci_52                 3.764050e-04 3 1  ON 51
ci_53                -6.473233e-04 3 1  ON 52
ci_54                -9.086565e-04 3 1  ON 53
ci_55                -6.740915e-04 3 1  ON 54
ci_56                 1.893483e-03 3 1  ON 55
ci_57                 1.812208e-03 3 1  ON 56
ci_58                -8.217780e-04 3 1  ON 57
ci_59                -9.599705e-04 3 1  ON 58
ci_60                 6.219855e-04 3 1  ON 59
ci_61                 5.642798e-04 3 1  ON 60
ci_62                -3.000484e-04 3 1  ON 61
ci_63                -5.128104e-04 3 1  ON 62
ci_64                -4.067364e-04 3 1  ON 63
ci_65                -3.135604e-04 3 1  ON 64
ci_66                -6.969332e-04 3 1  ON 65
ci_67                -5.894682e-04 3 1  ON 66
ci_68                -6.488233e-04 3 1  ON 67
ci_69                -1.883503e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3527e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.8179
    reference variance = 0.920928
====================================================
  Execution time = 2.5202e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5361e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4765e-01
  Total weights = 1.964420754e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5309e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434045903742
                                         uncertainty =       0.001768200413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434045903742
                                         uncertainty =       0.001768200413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465863975
  error estimate for blocks of size 2^( 2) =       0.000490973113
  error estimate for blocks of size 2^( 3) =       0.000514905463
  error estimate for blocks of size 2^( 4) =       0.000532684501
  error estimate for blocks of size 2^( 5) =       0.000543869949
  error estimate for blocks of size 2^( 6) =       0.000551345126
  error estimate for blocks of size 2^( 7) =       0.000553362120

      target function =      -0.747298889271
              le_mean =     -22.815011396826
             les_mean =     520.972391867540
             stat err =       0.000545315424
             autocorr =       1.370179001787
   target nu stat err =       0.000545315424
   target dn stat err =       0.002833751699
      target stat err =       0.002433238119
              std dev =       0.658831151684
             le_variance =       0.434058486429


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281501139683e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747307136347       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747307147212       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747307148433       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747307148745       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747307148935       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747307148987       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747307148986       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747307148983       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747307148985       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747307148987       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+03 is 1.192100e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747307136347       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747307139064       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747307139369       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747307139441       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747307139507       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747307139507       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747307139515       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747307139507       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747307139508       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747307139511       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+03 is 2.980275e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747307136347       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747307137026       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747307137103       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747307137110       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747307137109       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747307137158       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747307137140       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747307137100       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747307137168       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747307137179       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+04 is 7.450705e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.353542 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9742e+01
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_01                 1.311688e-01 3 1  ON 0
ci_02                -3.109416e-02 3 1  ON 1
ci_03                -3.098719e-02 3 1  ON 2
ci_04                 2.777617e-02 3 1  ON 3
ci_05                -2.306562e-02 3 1  ON 4
ci_06                -2.274486e-02 3 1  ON 5
ci_07                 2.694790e-02 3 1  ON 6
ci_08                -6.354140e-03 3 1  ON 7
ci_09                -9.236150e-03 3 1  ON 8
ci_10                -9.226418e-03 3 1  ON 9
ci_11                 1.301208e-02 3 1  ON 10
ci_12                 7.627887e-03 3 1  ON 11
ci_13                 1.265620e-02 3 1  ON 12
ci_14                 1.311553e-02 3 1  ON 13
ci_15                 7.058098e-03 3 1  ON 14
ci_16                 7.299940e-03 3 1  ON 15
ci_17                -7.468956e-03 3 1  ON 16
ci_18                -7.185601e-03 3 1  ON 17
ci_19                 9.309452e-03 3 1  ON 18
ci_20                 6.818777e-03 3 1  ON 19
ci_21                 8.774063e-03 3 1  ON 20
ci_22                 8.773332e-03 3 1  ON 21
ci_23                 4.977836e-03 3 1  ON 22
ci_24                 4.388765e-03 3 1  ON 23
ci_25                 3.124203e-03 3 1  ON 24
ci_26                 3.150436e-03 3 1  ON 25
ci_27                 3.326761e-03 3 1  ON 26
ci_28                 2.505828e-03 3 1  ON 27
ci_29                 2.138167e-03 3 1  ON 28
ci_30                -1.586265e-03 3 1  ON 29
ci_31                -1.612295e-03 3 1  ON 30
ci_32                -1.313347e-03 3 1  ON 31
ci_33                -1.023878e-03 3 1  ON 32
ci_34                 1.461954e-03 3 1  ON 33
ci_35                 1.221731e-03 3 1  ON 34
ci_36                -1.116942e-03 3 1  ON 35
ci_37                -1.122371e-03 3 1  ON 36
ci_38                -5.287684e-04 3 1  ON 37
ci_39                -6.422524e-04 3 1  ON 38
ci_40                -1.673123e-03 3 1  ON 39
ci_41                -1.413564e-03 3 1  ON 40
ci_42                -1.208532e-03 3 1  ON 41
ci_43                -2.700296e-03 3 1  ON 42
ci_44                -1.763804e-03 3 1  ON 43
ci_45                -6.300634e-04 3 1  ON 44
ci_46                -5.317740e-04 3 1  ON 45
ci_47                 1.304131e-03 3 1  ON 46
ci_48                 8.704807e-04 3 1  ON 47
ci_49                -9.525947e-04 3 1  ON 48
ci_50                -7.380875e-04 3 1  ON 49
ci_51                 3.640947e-04 3 1  ON 50
ci_52                 3.764071e-04 3 1  ON 51
ci_53                -6.473182e-04 3 1  ON 52
ci_54                -9.086593e-04 3 1  ON 53
ci_55                -6.740844e-04 3 1  ON 54
ci_56                 1.893481e-03 3 1  ON 55
ci_57                 1.812206e-03 3 1  ON 56
ci_58                -8.217835e-04 3 1  ON 57
ci_59                -9.599619e-04 3 1  ON 58
ci_60                 6.219766e-04 3 1  ON 59
ci_61                 5.642812e-04 3 1  ON 60
ci_62                -3.000487e-04 3 1  ON 61
ci_63                -5.128086e-04 3 1  ON 62
ci_64                -4.067367e-04 3 1  ON 63
ci_65                -3.135552e-04 3 1  ON 64
ci_66                -6.969332e-04 3 1  ON 65
ci_67                -5.894714e-04 3 1  ON 66
ci_68                -6.488283e-04 3 1  ON 67
ci_69                -1.883567e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.8561
    reference variance = 1.40515
====================================================
  Execution time = 2.4542e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4647e-01
  Total weights = 1.9642e+06
  Execution time = 3.5099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433682228847
                                         uncertainty =       0.002011667034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433682228847
                                         uncertainty =       0.002011667034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465705965
  error estimate for blocks of size 2^( 2) =       0.000491218777
  error estimate for blocks of size 2^( 3) =       0.000514571754
  error estimate for blocks of size 2^( 4) =       0.000532001910
  error estimate for blocks of size 2^( 5) =       0.000543179424
  error estimate for blocks of size 2^( 6) =       0.000548485272
  error estimate for blocks of size 2^( 7) =       0.000548974320

      target function =      -0.748278390863
              le_mean =     -22.814213907108
             les_mean =     520.934822351935
             stat err =       0.000543160231
             autocorr =       1.360292576004
   target nu stat err =       0.000543160231
   target dn stat err =       0.002793294035
      target stat err =       0.002403306420
              std dev =       0.658607691834
             le_variance =       0.433764091743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433682208089
                                         uncertainty =       0.002011666884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433682208089
                                         uncertainty =       0.002011666884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465705954
  error estimate for blocks of size 2^( 2) =       0.000491218771
  error estimate for blocks of size 2^( 3) =       0.000514571754
  error estimate for blocks of size 2^( 4) =       0.000532001913
  error estimate for blocks of size 2^( 5) =       0.000543179429
  error estimate for blocks of size 2^( 6) =       0.000548485277
  error estimate for blocks of size 2^( 7) =       0.000548974324

      target function =      -0.748278404834
              le_mean =     -22.814213905890
             les_mean =     520.934822279597
             stat err =       0.000543160235
             autocorr =       1.360292662267
   target nu stat err =       0.000543160235
   target dn stat err =       0.002793292790
      target stat err =       0.002403305500
              std dev =       0.658607676022
             le_variance =       0.433764070915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433682218468
                                         uncertainty =       0.002011666959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433682218468
                                         uncertainty =       0.002011666959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465705959
  error estimate for blocks of size 2^( 2) =       0.000491218774
  error estimate for blocks of size 2^( 3) =       0.000514571754
  error estimate for blocks of size 2^( 4) =       0.000532001911
  error estimate for blocks of size 2^( 5) =       0.000543179426
  error estimate for blocks of size 2^( 6) =       0.000548485274
  error estimate for blocks of size 2^( 7) =       0.000548974322

      target function =      -0.748278397860
              le_mean =     -22.814213906499
             les_mean =     520.934822315751
             stat err =       0.000543160233
             autocorr =       1.360292619142
   target nu stat err =       0.000543160233
   target dn stat err =       0.002793293412
      target stat err =       0.002403305960
              std dev =       0.658607683928
             le_variance =       0.433764081328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433682227550
                                         uncertainty =       0.002011667025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433682227550
                                         uncertainty =       0.002011667025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465705964
  error estimate for blocks of size 2^( 2) =       0.000491218777
  error estimate for blocks of size 2^( 3) =       0.000514571754
  error estimate for blocks of size 2^( 4) =       0.000532001910
  error estimate for blocks of size 2^( 5) =       0.000543179424
  error estimate for blocks of size 2^( 6) =       0.000548485272
  error estimate for blocks of size 2^( 7) =       0.000548974320

      target function =      -0.748278391739
              le_mean =     -22.814213907032
             les_mean =     520.934822347410
             stat err =       0.000543160232
             autocorr =       1.360292581404
   target nu stat err =       0.000543160232
   target dn stat err =       0.002793293957
      target stat err =       0.002403306363
              std dev =       0.658607690846
             le_variance =       0.433764090441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748278390863        initial
     2.2737e+03     2.2737e+04             1.1921e-07        -0.748278404834  <--
     9.0949e+03     9.0949e+04             2.9803e-08        -0.748278397860
     3.6380e+04     3.6380e+05             7.4507e-09        -0.748278391739

*****************************************************************************
Applying the update for shift_i =   2.2737e+03     and shift_s =   2.2737e+04
*****************************************************************************

  Execution time = 4.2142e+01
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_01                 1.311687e-01 3 1  ON 0
ci_02                -3.109411e-02 3 1  ON 1
ci_03                -3.098716e-02 3 1  ON 2
ci_04                 2.777613e-02 3 1  ON 3
ci_05                -2.306560e-02 3 1  ON 4
ci_06                -2.274482e-02 3 1  ON 5
ci_07                 2.694790e-02 3 1  ON 6
ci_08                -6.354098e-03 3 1  ON 7
ci_09                -9.236147e-03 3 1  ON 8
ci_10                -9.226384e-03 3 1  ON 9
ci_11                 1.301209e-02 3 1  ON 10
ci_12                 7.627870e-03 3 1  ON 11
ci_13                 1.265620e-02 3 1  ON 12
ci_14                 1.311552e-02 3 1  ON 13
ci_15                 7.058070e-03 3 1  ON 14
ci_16                 7.299931e-03 3 1  ON 15
ci_17                -7.468959e-03 3 1  ON 16
ci_18                -7.185593e-03 3 1  ON 17
ci_19                 9.309452e-03 3 1  ON 18
ci_20                 6.818757e-03 3 1  ON 19
ci_21                 8.774084e-03 3 1  ON 20
ci_22                 8.773306e-03 3 1  ON 21
ci_23                 4.977839e-03 3 1  ON 22
ci_24                 4.388796e-03 3 1  ON 23
ci_25                 3.124186e-03 3 1  ON 24
ci_26                 3.150432e-03 3 1  ON 25
ci_27                 3.326762e-03 3 1  ON 26
ci_28                 2.505806e-03 3 1  ON 27
ci_29                 2.138157e-03 3 1  ON 28
ci_30                -1.586255e-03 3 1  ON 29
ci_31                -1.612277e-03 3 1  ON 30
ci_32                -1.313382e-03 3 1  ON 31
ci_33                -1.023888e-03 3 1  ON 32
ci_34                 1.461925e-03 3 1  ON 33
ci_35                 1.221733e-03 3 1  ON 34
ci_36                -1.116948e-03 3 1  ON 35
ci_37                -1.122369e-03 3 1  ON 36
ci_38                -5.287674e-04 3 1  ON 37
ci_39                -6.422514e-04 3 1  ON 38
ci_40                -1.673128e-03 3 1  ON 39
ci_41                -1.413514e-03 3 1  ON 40
ci_42                -1.208545e-03 3 1  ON 41
ci_43                -2.700289e-03 3 1  ON 42
ci_44                -1.763806e-03 3 1  ON 43
ci_45                -6.300644e-04 3 1  ON 44
ci_46                -5.317642e-04 3 1  ON 45
ci_47                 1.304147e-03 3 1  ON 46
ci_48                 8.704965e-04 3 1  ON 47
ci_49                -9.525887e-04 3 1  ON 48
ci_50                -7.380817e-04 3 1  ON 49
ci_51                 3.640936e-04 3 1  ON 50
ci_52                 3.764132e-04 3 1  ON 51
ci_53                -6.473029e-04 3 1  ON 52
ci_54                -9.086676e-04 3 1  ON 53
ci_55                -6.740631e-04 3 1  ON 54
ci_56                 1.893475e-03 3 1  ON 55
ci_57                 1.812203e-03 3 1  ON 56
ci_58                -8.218002e-04 3 1  ON 57
ci_59                -9.599359e-04 3 1  ON 58
ci_60                 6.219499e-04 3 1  ON 59
ci_61                 5.642854e-04 3 1  ON 60
ci_62                -3.000493e-04 3 1  ON 61
ci_63                -5.128034e-04 3 1  ON 62
ci_64                -4.067378e-04 3 1  ON 63
ci_65                -3.135396e-04 3 1  ON 64
ci_66                -6.969331e-04 3 1  ON 65
ci_67                -5.894809e-04 3 1  ON 66
ci_68                -6.488433e-04 3 1  ON 67
ci_69                -1.883759e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1889e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.8418
    reference variance = 0.369293
====================================================
  Execution time = 2.5074e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4612e-01
  Total weights = 1.964194386e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432464938280
                                         uncertainty =       0.001930673275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432464938280
                                         uncertainty =       0.001930673275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465045979
  error estimate for blocks of size 2^( 2) =       0.000490757714
  error estimate for blocks of size 2^( 3) =       0.000514391693
  error estimate for blocks of size 2^( 4) =       0.000531830181
  error estimate for blocks of size 2^( 5) =       0.000543966087
  error estimate for blocks of size 2^( 6) =       0.000550238541
  error estimate for blocks of size 2^( 7) =       0.000555752581

      target function =      -0.748570743783
              le_mean =     -22.815046262446
             les_mean =     520.972459383534
             stat err =       0.000545446848
             autocorr =       1.375666258207
   target nu stat err =       0.000545446848
   target dn stat err =       0.002552710661
      target stat err =       0.002215079223
              std dev =       0.657674330437
             le_variance =       0.432535524916


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281504626245e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748576279732       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748576313012       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748576318506       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748576319917       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748576320063       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748576320311       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748576320322       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748576320296       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748576320293       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748576320284       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+02 is 4.554441e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748576279732       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748576288053       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748576289426       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748576289779       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748576289813       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748576289878       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748576289880       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748576289873       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748576289868       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748576289870       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+03 is 1.138651e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748576279732       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748576281812       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748576282156       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748576282245       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748576282256       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748576282266       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748576282267       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748576282272       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748576282272       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748576282268       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+03 is 2.846653e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.357059 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9621e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_01                 1.311686e-01 3 1  ON 0
ci_02                -3.109401e-02 3 1  ON 1
ci_03                -3.098709e-02 3 1  ON 2
ci_04                 2.777609e-02 3 1  ON 3
ci_05                -2.306554e-02 3 1  ON 4
ci_06                -2.274481e-02 3 1  ON 5
ci_07                 2.694787e-02 3 1  ON 6
ci_08                -6.354075e-03 3 1  ON 7
ci_09                -9.236101e-03 3 1  ON 8
ci_10                -9.226337e-03 3 1  ON 9
ci_11                 1.301209e-02 3 1  ON 10
ci_12                 7.627862e-03 3 1  ON 11
ci_13                 1.265618e-02 3 1  ON 12
ci_14                 1.311554e-02 3 1  ON 13
ci_15                 7.058079e-03 3 1  ON 14
ci_16                 7.299941e-03 3 1  ON 15
ci_17                -7.468907e-03 3 1  ON 16
ci_18                -7.185609e-03 3 1  ON 17
ci_19                 9.309444e-03 3 1  ON 18
ci_20                 6.818752e-03 3 1  ON 19
ci_21                 8.774103e-03 3 1  ON 20
ci_22                 8.773312e-03 3 1  ON 21
ci_23                 4.977806e-03 3 1  ON 22
ci_24                 4.388788e-03 3 1  ON 23
ci_25                 3.124163e-03 3 1  ON 24
ci_26                 3.150430e-03 3 1  ON 25
ci_27                 3.326747e-03 3 1  ON 26
ci_28                 2.505811e-03 3 1  ON 27
ci_29                 2.138156e-03 3 1  ON 28
ci_30                -1.586258e-03 3 1  ON 29
ci_31                -1.612279e-03 3 1  ON 30
ci_32                -1.313359e-03 3 1  ON 31
ci_33                -1.023895e-03 3 1  ON 32
ci_34                 1.461908e-03 3 1  ON 33
ci_35                 1.221717e-03 3 1  ON 34
ci_36                -1.116950e-03 3 1  ON 35
ci_37                -1.122359e-03 3 1  ON 36
ci_38                -5.287776e-04 3 1  ON 37
ci_39                -6.422485e-04 3 1  ON 38
ci_40                -1.673107e-03 3 1  ON 39
ci_41                -1.413512e-03 3 1  ON 40
ci_42                -1.208541e-03 3 1  ON 41
ci_43                -2.700271e-03 3 1  ON 42
ci_44                -1.763831e-03 3 1  ON 43
ci_45                -6.300536e-04 3 1  ON 44
ci_46                -5.317579e-04 3 1  ON 45
ci_47                 1.304150e-03 3 1  ON 46
ci_48                 8.705305e-04 3 1  ON 47
ci_49                -9.525764e-04 3 1  ON 48
ci_50                -7.380841e-04 3 1  ON 49
ci_51                 3.640862e-04 3 1  ON 50
ci_52                 3.764095e-04 3 1  ON 51
ci_53                -6.473156e-04 3 1  ON 52
ci_54                -9.086720e-04 3 1  ON 53
ci_55                -6.740635e-04 3 1  ON 54
ci_56                 1.893455e-03 3 1  ON 55
ci_57                 1.812221e-03 3 1  ON 56
ci_58                -8.217966e-04 3 1  ON 57
ci_59                -9.599432e-04 3 1  ON 58
ci_60                 6.219587e-04 3 1  ON 59
ci_61                 5.642900e-04 3 1  ON 60
ci_62                -3.000460e-04 3 1  ON 61
ci_63                -5.128064e-04 3 1  ON 62
ci_64                -4.067447e-04 3 1  ON 63
ci_65                -3.135342e-04 3 1  ON 64
ci_66                -6.969282e-04 3 1  ON 65
ci_67                -5.894828e-04 3 1  ON 66
ci_68                -6.488678e-04 3 1  ON 67
ci_69                -1.884177e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.8285
    reference variance = 0.391654
====================================================
  Execution time = 2.4575e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4558e-01
  Total weights = 1.9642e+06
  Execution time = 3.5183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433355872775
                                         uncertainty =       0.002055385064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433355872775
                                         uncertainty =       0.002055385064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465490445
  error estimate for blocks of size 2^( 2) =       0.000490657246
  error estimate for blocks of size 2^( 3) =       0.000514255788
  error estimate for blocks of size 2^( 4) =       0.000531431512
  error estimate for blocks of size 2^( 5) =       0.000542471512
  error estimate for blocks of size 2^( 6) =       0.000549024960
  error estimate for blocks of size 2^( 7) =       0.000552870241

      target function =      -0.749023578389
              le_mean =     -22.814562544691
             les_mean =     520.949840562671
             stat err =       0.000543949556
             autocorr =       1.365512597976
   target nu stat err =       0.000543949556
   target dn stat err =       0.002623799109
      target stat err =       0.002272745718
              std dev =       0.658302900644
             le_variance =       0.433362708997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433355773991
                                         uncertainty =       0.002055377404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433355773991
                                         uncertainty =       0.002055377404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465490392
  error estimate for blocks of size 2^( 2) =       0.000490657214
  error estimate for blocks of size 2^( 3) =       0.000514255776
  error estimate for blocks of size 2^( 4) =       0.000531431517
  error estimate for blocks of size 2^( 5) =       0.000542471525
  error estimate for blocks of size 2^( 6) =       0.000549024981
  error estimate for blocks of size 2^( 7) =       0.000552870245

      target function =      -0.749023893519
              le_mean =     -22.814562545328
             les_mean =     520.949840214413
             stat err =       0.000543949567
             autocorr =       1.365512963690
   target nu stat err =       0.000543949567
   target dn stat err =       0.002623772256
      target stat err =       0.002272725963
              std dev =       0.658302825578
             le_variance =       0.433362610164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433355823378
                                         uncertainty =       0.002055381234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433355823378
                                         uncertainty =       0.002055381234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465490419
  error estimate for blocks of size 2^( 2) =       0.000490657230
  error estimate for blocks of size 2^( 3) =       0.000514255782
  error estimate for blocks of size 2^( 4) =       0.000531431514
  error estimate for blocks of size 2^( 5) =       0.000542471518
  error estimate for blocks of size 2^( 6) =       0.000549024970
  error estimate for blocks of size 2^( 7) =       0.000552870243

      target function =      -0.749023736189
              le_mean =     -22.814562545010
             les_mean =     520.949840388245
             stat err =       0.000543949561
             autocorr =       1.365512780841
   target nu stat err =       0.000543949561
   target dn stat err =       0.002623785676
      target stat err =       0.002272735837
              std dev =       0.658302863108
             le_variance =       0.433362659576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433355866600
                                         uncertainty =       0.002055384585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433355866600
                                         uncertainty =       0.002055384585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465490442
  error estimate for blocks of size 2^( 2) =       0.000490657244
  error estimate for blocks of size 2^( 3) =       0.000514255787
  error estimate for blocks of size 2^( 4) =       0.000531431512
  error estimate for blocks of size 2^( 5) =       0.000542471512
  error estimate for blocks of size 2^( 6) =       0.000549024961
  error estimate for blocks of size 2^( 7) =       0.000552870241

      target function =      -0.749023598139
              le_mean =     -22.814562544731
             les_mean =     520.949840540837
             stat err =       0.000543949557
             autocorr =       1.365512620828
   target nu stat err =       0.000543949557
   target dn stat err =       0.002623797429
      target stat err =       0.002272744483
              std dev =       0.658302895952
             le_variance =       0.433362702819


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749023578389        initial
     5.6843e+02     5.6843e+03             4.5544e-07        -0.749023893519  <--
     2.2737e+03     2.2737e+04             1.1387e-07        -0.749023736189
     9.0949e+03     9.0949e+04             2.8467e-08        -0.749023598139

*****************************************************************************
Applying the update for shift_i =   5.6843e+02     and shift_s =   5.6843e+03
*****************************************************************************

  Execution time = 4.2214e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_01                 1.311682e-01 3 1  ON 0
ci_02                -3.109370e-02 3 1  ON 1
ci_03                -3.098686e-02 3 1  ON 2
ci_04                 2.777595e-02 3 1  ON 3
ci_05                -2.306537e-02 3 1  ON 4
ci_06                -2.274478e-02 3 1  ON 5
ci_07                 2.694777e-02 3 1  ON 6
ci_08                -6.354004e-03 3 1  ON 7
ci_09                -9.235961e-03 3 1  ON 8
ci_10                -9.226194e-03 3 1  ON 9
ci_11                 1.301210e-02 3 1  ON 10
ci_12                 7.627839e-03 3 1  ON 11
ci_13                 1.265611e-02 3 1  ON 12
ci_14                 1.311560e-02 3 1  ON 13
ci_15                 7.058105e-03 3 1  ON 14
ci_16                 7.299972e-03 3 1  ON 15
ci_17                -7.468754e-03 3 1  ON 16
ci_18                -7.185654e-03 3 1  ON 17
ci_19                 9.309421e-03 3 1  ON 18
ci_20                 6.818735e-03 3 1  ON 19
ci_21                 8.774162e-03 3 1  ON 20
ci_22                 8.773330e-03 3 1  ON 21
ci_23                 4.977707e-03 3 1  ON 22
ci_24                 4.388765e-03 3 1  ON 23
ci_25                 3.124093e-03 3 1  ON 24
ci_26                 3.150423e-03 3 1  ON 25
ci_27                 3.326700e-03 3 1  ON 26
ci_28                 2.505826e-03 3 1  ON 27
ci_29                 2.138154e-03 3 1  ON 28
ci_30                -1.586264e-03 3 1  ON 29
ci_31                -1.612286e-03 3 1  ON 30
ci_32                -1.313291e-03 3 1  ON 31
ci_33                -1.023918e-03 3 1  ON 32
ci_34                 1.461860e-03 3 1  ON 33
ci_35                 1.221672e-03 3 1  ON 34
ci_36                -1.116957e-03 3 1  ON 35
ci_37                -1.122331e-03 3 1  ON 36
ci_38                -5.288082e-04 3 1  ON 37
ci_39                -6.422398e-04 3 1  ON 38
ci_40                -1.673047e-03 3 1  ON 39
ci_41                -1.413507e-03 3 1  ON 40
ci_42                -1.208532e-03 3 1  ON 41
ci_43                -2.700216e-03 3 1  ON 42
ci_44                -1.763906e-03 3 1  ON 43
ci_45                -6.300215e-04 3 1  ON 44
ci_46                -5.317391e-04 3 1  ON 45
ci_47                 1.304160e-03 3 1  ON 46
ci_48                 8.706324e-04 3 1  ON 47
ci_49                -9.525396e-04 3 1  ON 48
ci_50                -7.380916e-04 3 1  ON 49
ci_51                 3.640639e-04 3 1  ON 50
ci_52                 3.763986e-04 3 1  ON 51
ci_53                -6.473538e-04 3 1  ON 52
ci_54                -9.086849e-04 3 1  ON 53
ci_55                -6.740648e-04 3 1  ON 54
ci_56                 1.893396e-03 3 1  ON 55
ci_57                 1.812273e-03 3 1  ON 56
ci_58                -8.217859e-04 3 1  ON 57
ci_59                -9.599653e-04 3 1  ON 58
ci_60                 6.219849e-04 3 1  ON 59
ci_61                 5.643036e-04 3 1  ON 60
ci_62                -3.000361e-04 3 1  ON 61
ci_63                -5.128153e-04 3 1  ON 62
ci_64                -4.067656e-04 3 1  ON 63
ci_65                -3.135180e-04 3 1  ON 64
ci_66                -6.969135e-04 3 1  ON 65
ci_67                -5.894885e-04 3 1  ON 66
ci_68                -6.489413e-04 3 1  ON 67
ci_69                -1.885430e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1840e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.7684
    reference variance = 0.391787
====================================================
  Execution time = 2.5229e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5388e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4383e-01
  Total weights = 1.964327373e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5121e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432162560602
                                         uncertainty =       0.002134932299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432162560602
                                         uncertainty =       0.002134932299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464904273
  error estimate for blocks of size 2^( 2) =       0.000490324583
  error estimate for blocks of size 2^( 3) =       0.000514055045
  error estimate for blocks of size 2^( 4) =       0.000532826268
  error estimate for blocks of size 2^( 5) =       0.000543646397
  error estimate for blocks of size 2^( 6) =       0.000548595872
  error estimate for blocks of size 2^( 7) =       0.000552463579

      target function =      -0.750482383636
              le_mean =     -22.814049533057
             les_mean =     520.924682121366
             stat err =       0.000544383029
             autocorr =       1.371140881703
   target nu stat err =       0.000544383029
   target dn stat err =       0.002652677970
      target stat err =       0.002302999760
              std dev =       0.657473927833
             le_variance =       0.432271965780


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281404953306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750488437619       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750488573530       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750488593900       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750488598953       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750488600704       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750488600467       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750488600662       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750488600572       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750488600484       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750488600511       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+02 is 1.382480e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750488437619       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750488471606       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750488476699       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750488477963       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750488478401       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750488478341       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750488478389       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750488478367       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750488478345       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750488478351       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+02 is 3.456735e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750488437619       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750488446116       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750488447390       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750488447705       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750488447813       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750488447800       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750488447813       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750488447804       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750488447800       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750488447802       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+03 is 8.642171e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.360565 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9751e+01
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_01                 1.311679e-01 3 1  ON 0
ci_02                -3.109347e-02 3 1  ON 1
ci_03                -3.098673e-02 3 1  ON 2
ci_04                 2.777566e-02 3 1  ON 3
ci_05                -2.306503e-02 3 1  ON 4
ci_06                -2.274455e-02 3 1  ON 5
ci_07                 2.694767e-02 3 1  ON 6
ci_08                -6.353804e-03 3 1  ON 7
ci_09                -9.235901e-03 3 1  ON 8
ci_10                -9.226122e-03 3 1  ON 9
ci_11                 1.301204e-02 3 1  ON 10
ci_12                 7.627753e-03 3 1  ON 11
ci_13                 1.265605e-02 3 1  ON 12
ci_14                 1.311564e-02 3 1  ON 13
ci_15                 7.058063e-03 3 1  ON 14
ci_16                 7.299862e-03 3 1  ON 15
ci_17                -7.468740e-03 3 1  ON 16
ci_18                -7.185575e-03 3 1  ON 17
ci_19                 9.309418e-03 3 1  ON 18
ci_20                 6.818666e-03 3 1  ON 19
ci_21                 8.774282e-03 3 1  ON 20
ci_22                 8.773181e-03 3 1  ON 21
ci_23                 4.977662e-03 3 1  ON 22
ci_24                 4.388652e-03 3 1  ON 23
ci_25                 3.124087e-03 3 1  ON 24
ci_26                 3.150502e-03 3 1  ON 25
ci_27                 3.326695e-03 3 1  ON 26
ci_28                 2.505724e-03 3 1  ON 27
ci_29                 2.138267e-03 3 1  ON 28
ci_30                -1.586263e-03 3 1  ON 29
ci_31                -1.612265e-03 3 1  ON 30
ci_32                -1.313332e-03 3 1  ON 31
ci_33                -1.023914e-03 3 1  ON 32
ci_34                 1.461902e-03 3 1  ON 33
ci_35                 1.221546e-03 3 1  ON 34
ci_36                -1.116862e-03 3 1  ON 35
ci_37                -1.122342e-03 3 1  ON 36
ci_38                -5.288036e-04 3 1  ON 37
ci_39                -6.422302e-04 3 1  ON 38
ci_40                -1.672980e-03 3 1  ON 39
ci_41                -1.413506e-03 3 1  ON 40
ci_42                -1.208443e-03 3 1  ON 41
ci_43                -2.700279e-03 3 1  ON 42
ci_44                -1.763792e-03 3 1  ON 43
ci_45                -6.300010e-04 3 1  ON 44
ci_46                -5.317373e-04 3 1  ON 45
ci_47                 1.304188e-03 3 1  ON 46
ci_48                 8.707116e-04 3 1  ON 47
ci_49                -9.524944e-04 3 1  ON 48
ci_50                -7.381524e-04 3 1  ON 49
ci_51                 3.641466e-04 3 1  ON 50
ci_52                 3.764274e-04 3 1  ON 51
ci_53                -6.473364e-04 3 1  ON 52
ci_54                -9.086785e-04 3 1  ON 53
ci_55                -6.740441e-04 3 1  ON 54
ci_56                 1.893402e-03 3 1  ON 55
ci_57                 1.812280e-03 3 1  ON 56
ci_58                -8.218417e-04 3 1  ON 57
ci_59                -9.600154e-04 3 1  ON 58
ci_60                 6.218271e-04 3 1  ON 59
ci_61                 5.643960e-04 3 1  ON 60
ci_62                -3.000247e-04 3 1  ON 61
ci_63                -5.127309e-04 3 1  ON 62
ci_64                -4.066465e-04 3 1  ON 63
ci_65                -3.135750e-04 3 1  ON 64
ci_66                -6.968392e-04 3 1  ON 65
ci_67                -5.894764e-04 3 1  ON 66
ci_68                -6.489909e-04 3 1  ON 67
ci_69                -1.885183e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.8287
    reference variance = 0.365042
====================================================
  Execution time = 2.4620e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4770e-01
  Total weights = 1.9641e+06
  Execution time = 3.5147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435117011542
                                         uncertainty =       0.001845623099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435117011542
                                         uncertainty =       0.001845623099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466376766
  error estimate for blocks of size 2^( 2) =       0.000491798858
  error estimate for blocks of size 2^( 3) =       0.000515072317
  error estimate for blocks of size 2^( 4) =       0.000532450865
  error estimate for blocks of size 2^( 5) =       0.000542779193
  error estimate for blocks of size 2^( 6) =       0.000549204648
  error estimate for blocks of size 2^( 7) =       0.000555089290

      target function =      -0.747257062240
              le_mean =     -22.814408806422
             les_mean =     520.944945886605
             stat err =       0.000544880999
             autocorr =       1.364990139632
   target nu stat err =       0.000544880999
   target dn stat err =       0.002625838963
      target stat err =       0.002263811054
              std dev =       0.659556347648
             le_variance =       0.435014575722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435116718101
                                         uncertainty =       0.001845625992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435116718101
                                         uncertainty =       0.001845625992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466376608
  error estimate for blocks of size 2^( 2) =       0.000491798787
  error estimate for blocks of size 2^( 3) =       0.000515072336
  error estimate for blocks of size 2^( 4) =       0.000532450932
  error estimate for blocks of size 2^( 5) =       0.000542779291
  error estimate for blocks of size 2^( 6) =       0.000549204783
  error estimate for blocks of size 2^( 7) =       0.000555089422

      target function =      -0.747257945647
              le_mean =     -22.814408803325
             les_mean =     520.944944682417
             stat err =       0.000544881107
             autocorr =       1.364991603100
   target nu stat err =       0.000544881107
   target dn stat err =       0.002625730859
      target stat err =       0.002263729708
              std dev =       0.659556124737
             le_variance =       0.435014281678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435116864751
                                         uncertainty =       0.001845624544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435116864751
                                         uncertainty =       0.001845624544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466376687
  error estimate for blocks of size 2^( 2) =       0.000491798822
  error estimate for blocks of size 2^( 3) =       0.000515072326
  error estimate for blocks of size 2^( 4) =       0.000532450899
  error estimate for blocks of size 2^( 5) =       0.000542779242
  error estimate for blocks of size 2^( 6) =       0.000549204715
  error estimate for blocks of size 2^( 7) =       0.000555089356

      target function =      -0.747257515860
              le_mean =     -22.814408804867
             les_mean =     520.944945269881
             stat err =       0.000544881053
             autocorr =       1.364990871555
   target nu stat err =       0.000544881053
   target dn stat err =       0.002625784710
      target stat err =       0.002263770290
              std dev =       0.659556236139
             le_variance =       0.435014428630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435116993188
                                         uncertainty =       0.001845623280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435116993188
                                         uncertainty =       0.001845623280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466376756
  error estimate for blocks of size 2^( 2) =       0.000491798853
  error estimate for blocks of size 2^( 3) =       0.000515072318
  error estimate for blocks of size 2^( 4) =       0.000532450869
  error estimate for blocks of size 2^( 5) =       0.000542779199
  error estimate for blocks of size 2^( 6) =       0.000549204656
  error estimate for blocks of size 2^( 7) =       0.000555089298

      target function =      -0.747257120154
              le_mean =     -22.814408806227
             les_mean =     520.944945808027
             stat err =       0.000544881006
             autocorr =       1.364990231141
   target nu stat err =       0.000544881006
   target dn stat err =       0.002625832161
      target stat err =       0.002263805949
              std dev =       0.659556333706
             le_variance =       0.435014557331


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747257062240        initial
     1.4211e+02     1.4211e+03             1.3825e-06        -0.747257945647  <--
     5.6843e+02     5.6843e+03             3.4567e-07        -0.747257515860
     2.2737e+03     2.2737e+04             8.6422e-08        -0.747257120154

*****************************************************************************
Applying the update for shift_i =   1.4211e+02     and shift_s =   1.4211e+03
*****************************************************************************

  Execution time = 4.2238e+01
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_01                 1.311669e-01 3 1  ON 0
ci_02                -3.109280e-02 3 1  ON 1
ci_03                -3.098633e-02 3 1  ON 2
ci_04                 2.777479e-02 3 1  ON 3
ci_05                -2.306402e-02 3 1  ON 4
ci_06                -2.274384e-02 3 1  ON 5
ci_07                 2.694736e-02 3 1  ON 6
ci_08                -6.353203e-03 3 1  ON 7
ci_09                -9.235720e-03 3 1  ON 8
ci_10                -9.225904e-03 3 1  ON 9
ci_11                 1.301186e-02 3 1  ON 10
ci_12                 7.627497e-03 3 1  ON 11
ci_13                 1.265587e-02 3 1  ON 12
ci_14                 1.311577e-02 3 1  ON 13
ci_15                 7.057935e-03 3 1  ON 14
ci_16                 7.299532e-03 3 1  ON 15
ci_17                -7.468700e-03 3 1  ON 16
ci_18                -7.185337e-03 3 1  ON 17
ci_19                 9.309407e-03 3 1  ON 18
ci_20                 6.818461e-03 3 1  ON 19
ci_21                 8.774642e-03 3 1  ON 20
ci_22                 8.772733e-03 3 1  ON 21
ci_23                 4.977527e-03 3 1  ON 22
ci_24                 4.388313e-03 3 1  ON 23
ci_25                 3.124070e-03 3 1  ON 24
ci_26                 3.150739e-03 3 1  ON 25
ci_27                 3.326678e-03 3 1  ON 26
ci_28                 2.505418e-03 3 1  ON 27
ci_29                 2.138605e-03 3 1  ON 28
ci_30                -1.586261e-03 3 1  ON 29
ci_31                -1.612202e-03 3 1  ON 30
ci_32                -1.313457e-03 3 1  ON 31
ci_33                -1.023903e-03 3 1  ON 32
ci_34                 1.462030e-03 3 1  ON 33
ci_35                 1.221170e-03 3 1  ON 34
ci_36                -1.116578e-03 3 1  ON 35
ci_37                -1.122373e-03 3 1  ON 36
ci_38                -5.287900e-04 3 1  ON 37
ci_39                -6.422012e-04 3 1  ON 38
ci_40                -1.672781e-03 3 1  ON 39
ci_41                -1.413501e-03 3 1  ON 40
ci_42                -1.208179e-03 3 1  ON 41
ci_43                -2.700468e-03 3 1  ON 42
ci_44                -1.763450e-03 3 1  ON 43
ci_45                -6.299396e-04 3 1  ON 44
ci_46                -5.317318e-04 3 1  ON 45
ci_47                 1.304271e-03 3 1  ON 46
ci_48                 8.709491e-04 3 1  ON 47
ci_49                -9.523588e-04 3 1  ON 48
ci_50                -7.383347e-04 3 1  ON 49
ci_51                 3.643946e-04 3 1  ON 50
ci_52                 3.765138e-04 3 1  ON 51
ci_53                -6.472842e-04 3 1  ON 52
ci_54                -9.086595e-04 3 1  ON 53
ci_55                -6.739819e-04 3 1  ON 54
ci_56                 1.893422e-03 3 1  ON 55
ci_57                 1.812301e-03 3 1  ON 56
ci_58                -8.220088e-04 3 1  ON 57
ci_59                -9.601656e-04 3 1  ON 58
ci_60                 6.213536e-04 3 1  ON 59
ci_61                 5.646731e-04 3 1  ON 60
ci_62                -2.999906e-04 3 1  ON 61
ci_63                -5.124776e-04 3 1  ON 62
ci_64                -4.062894e-04 3 1  ON 63
ci_65                -3.137457e-04 3 1  ON 64
ci_66                -6.966162e-04 3 1  ON 65
ci_67                -5.894403e-04 3 1  ON 66
ci_68                -6.491395e-04 3 1  ON 67
ci_69                -1.884439e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1994e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.7166
    reference variance = 0.400127
====================================================
  Execution time = 2.5116e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5362e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5222e-01
  Total weights = 1.964325593e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436857113942
                                         uncertainty =       0.002026726942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436857113942
                                         uncertainty =       0.002026726942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467423038
  error estimate for blocks of size 2^( 2) =       0.000492660672
  error estimate for blocks of size 2^( 3) =       0.000516150944
  error estimate for blocks of size 2^( 4) =       0.000532875758
  error estimate for blocks of size 2^( 5) =       0.000543897703
  error estimate for blocks of size 2^( 6) =       0.000550033786
  error estimate for blocks of size 2^( 7) =       0.000552905259

      target function =      -0.743515216370
              le_mean =     -22.814944984222
             les_mean =     520.973933996333
             stat err =       0.000544928126
             autocorr =       1.359121307613
   target nu stat err =       0.000544928126
   target dn stat err =       0.003217214047
      target stat err =       0.002715789005
              std dev =       0.661036000095
             le_variance =       0.436968593421


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281494498422e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+01, overlap shift 3.5527e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743524205694       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743524924965       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743525029591       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743525053006       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743525058326       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743525060945       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743525060767       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743525061568       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743525061641       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743525061616       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+01 is 7.780646e-06

solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743524205694       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743524385701       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743524411874       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743524417730       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743524419059       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743524419713       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743524419669       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743524419869       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743524419887       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743524419880       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+02 is 1.947001e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743524205694       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743524250708       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743524257252       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743524258716       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743524259048       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743524259212       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743524259200       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743524259249       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743524259254       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743524259254       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+02 is 4.868653e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.364056 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9668e+01
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_01                 1.311651e-01 3 1  ON 0
ci_02                -3.109085e-02 3 1  ON 1
ci_03                -3.098520e-02 3 1  ON 2
ci_04                 2.777400e-02 3 1  ON 3
ci_05                -2.306369e-02 3 1  ON 4
ci_06                -2.274311e-02 3 1  ON 5
ci_07                 2.694689e-02 3 1  ON 6
ci_08                -6.352677e-03 3 1  ON 7
ci_09                -9.235244e-03 3 1  ON 8
ci_10                -9.225223e-03 3 1  ON 9
ci_11                 1.301193e-02 3 1  ON 10
ci_12                 7.626943e-03 3 1  ON 11
ci_13                 1.265592e-02 3 1  ON 12
ci_14                 1.311576e-02 3 1  ON 13
ci_15                 7.057861e-03 3 1  ON 14
ci_16                 7.299712e-03 3 1  ON 15
ci_17                -7.468040e-03 3 1  ON 16
ci_18                -7.185411e-03 3 1  ON 17
ci_19                 9.309169e-03 3 1  ON 18
ci_20                 6.818559e-03 3 1  ON 19
ci_21                 8.774567e-03 3 1  ON 20
ci_22                 8.772834e-03 3 1  ON 21
ci_23                 4.977676e-03 3 1  ON 22
ci_24                 4.388408e-03 3 1  ON 23
ci_25                 3.124054e-03 3 1  ON 24
ci_26                 3.150651e-03 3 1  ON 25
ci_27                 3.326285e-03 3 1  ON 26
ci_28                 2.505608e-03 3 1  ON 27
ci_29                 2.138661e-03 3 1  ON 28
ci_30                -1.586329e-03 3 1  ON 29
ci_31                -1.611474e-03 3 1  ON 30
ci_32                -1.314179e-03 3 1  ON 31
ci_33                -1.024060e-03 3 1  ON 32
ci_34                 1.462719e-03 3 1  ON 33
ci_35                 1.220794e-03 3 1  ON 34
ci_36                -1.116279e-03 3 1  ON 35
ci_37                -1.122389e-03 3 1  ON 36
ci_38                -5.289492e-04 3 1  ON 37
ci_39                -6.422320e-04 3 1  ON 38
ci_40                -1.672563e-03 3 1  ON 39
ci_41                -1.413373e-03 3 1  ON 40
ci_42                -1.208150e-03 3 1  ON 41
ci_43                -2.701166e-03 3 1  ON 42
ci_44                -1.764136e-03 3 1  ON 43
ci_45                -6.297061e-04 3 1  ON 44
ci_46                -5.319969e-04 3 1  ON 45
ci_47                 1.304855e-03 3 1  ON 46
ci_48                 8.708352e-04 3 1  ON 47
ci_49                -9.528306e-04 3 1  ON 48
ci_50                -7.380504e-04 3 1  ON 49
ci_51                 3.643927e-04 3 1  ON 50
ci_52                 3.765237e-04 3 1  ON 51
ci_53                -6.474927e-04 3 1  ON 52
ci_54                -9.090487e-04 3 1  ON 53
ci_55                -6.741919e-04 3 1  ON 54
ci_56                 1.893293e-03 3 1  ON 55
ci_57                 1.811723e-03 3 1  ON 56
ci_58                -8.213303e-04 3 1  ON 57
ci_59                -9.605968e-04 3 1  ON 58
ci_60                 6.211423e-04 3 1  ON 59
ci_61                 5.648781e-04 3 1  ON 60
ci_62                -2.995591e-04 3 1  ON 61
ci_63                -5.124937e-04 3 1  ON 62
ci_64                -4.060195e-04 3 1  ON 63
ci_65                -3.137889e-04 3 1  ON 64
ci_66                -6.963766e-04 3 1  ON 65
ci_67                -5.894416e-04 3 1  ON 66
ci_68                -6.492400e-04 3 1  ON 67
ci_69                -1.879814e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.7862
    reference variance = 0.256566
====================================================
  Execution time = 2.4416e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4663e-01
  Total weights = 1.9645e+06
  Execution time = 3.7203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433472965424
                                         uncertainty =       0.002056588978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433472965424
                                         uncertainty =       0.002056588978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465516596
  error estimate for blocks of size 2^( 2) =       0.000490565401
  error estimate for blocks of size 2^( 3) =       0.000514209030
  error estimate for blocks of size 2^( 4) =       0.000531889013
  error estimate for blocks of size 2^( 5) =       0.000543667621
  error estimate for blocks of size 2^( 6) =       0.000550501160
  error estimate for blocks of size 2^( 7) =       0.000556117092

      target function =      -0.748182130570
              le_mean =     -22.814929570191
             les_mean =     520.967598168411
             stat err =       0.000545543722
             autocorr =       1.373373890934
   target nu stat err =       0.000545543722
   target dn stat err =       0.002849245126
      target stat err =       0.002451083695
              std dev =       0.658339883693
             le_variance =       0.433411402461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433471674087
                                         uncertainty =       0.002056670767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433471674087
                                         uncertainty =       0.002056670767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465515895
  error estimate for blocks of size 2^( 2) =       0.000490565037
  error estimate for blocks of size 2^( 3) =       0.000514209000
  error estimate for blocks of size 2^( 4) =       0.000531889241
  error estimate for blocks of size 2^( 5) =       0.000543667905
  error estimate for blocks of size 2^( 6) =       0.000550501442
  error estimate for blocks of size 2^( 7) =       0.000556117451

      target function =      -0.748181632143
              le_mean =     -22.814929534787
             les_mean =     520.967597148644
             stat err =       0.000545544010
             autocorr =       1.373379476200
   target nu stat err =       0.000545544010
   target dn stat err =       0.002849595009
      target stat err =       0.002451362974
              std dev =       0.658338892658
             le_variance =       0.433410097586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433472321070
                                         uncertainty =       0.002056629965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433472321070
                                         uncertainty =       0.002056629965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465516246
  error estimate for blocks of size 2^( 2) =       0.000490565196
  error estimate for blocks of size 2^( 3) =       0.000514209024
  error estimate for blocks of size 2^( 4) =       0.000531889132
  error estimate for blocks of size 2^( 5) =       0.000543667778
  error estimate for blocks of size 2^( 6) =       0.000550501287
  error estimate for blocks of size 2^( 7) =       0.000556117194

      target function =      -0.253025598580
              le_mean =     -22.814929516538
             les_mean =     522.096004833902
             stat err =       0.000545543848
             autocorr =       1.373376590045
   target nu stat err =       0.000545543848
   target dn stat err =       1.128928654200
      target stat err =       0.140980353318
              std dev =       0.658339389170
             le_variance =       0.433410751333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433472884467
                                         uncertainty =       0.002056594091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433472884467
                                         uncertainty =       0.002056594091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465516552
  error estimate for blocks of size 2^( 2) =       0.000490565378
  error estimate for blocks of size 2^( 3) =       0.000514209028
  error estimate for blocks of size 2^( 4) =       0.000531889027
  error estimate for blocks of size 2^( 5) =       0.000543667639
  error estimate for blocks of size 2^( 6) =       0.000550501178
  error estimate for blocks of size 2^( 7) =       0.000556117115

      target function =      -0.748178775821
              le_mean =     -22.814929567916
             les_mean =     520.967602089806
             stat err =       0.000545543739
             autocorr =       1.373374240387
   target nu stat err =       0.000545543739
   target dn stat err =       0.002849282893
      target stat err =       0.002451092878
              std dev =       0.658339821564
             le_variance =       0.433411320657


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748182130570        initial  <--
     3.5527e+01     3.5527e+02             7.7806e-06        -0.748181632143
     1.4211e+02     1.4211e+03             1.9470e-06        -0.253025598580
     5.6843e+02     5.6843e+03             4.8687e-07        -0.748178775821

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4690
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_01                 1.311669e-01 3 1  ON 0
ci_02                -3.109280e-02 3 1  ON 1
ci_03                -3.098633e-02 3 1  ON 2
ci_04                 2.777479e-02 3 1  ON 3
ci_05                -2.306402e-02 3 1  ON 4
ci_06                -2.274384e-02 3 1  ON 5
ci_07                 2.694736e-02 3 1  ON 6
ci_08                -6.353203e-03 3 1  ON 7
ci_09                -9.235720e-03 3 1  ON 8
ci_10                -9.225904e-03 3 1  ON 9
ci_11                 1.301186e-02 3 1  ON 10
ci_12                 7.627497e-03 3 1  ON 11
ci_13                 1.265587e-02 3 1  ON 12
ci_14                 1.311577e-02 3 1  ON 13
ci_15                 7.057935e-03 3 1  ON 14
ci_16                 7.299532e-03 3 1  ON 15
ci_17                -7.468700e-03 3 1  ON 16
ci_18                -7.185337e-03 3 1  ON 17
ci_19                 9.309407e-03 3 1  ON 18
ci_20                 6.818461e-03 3 1  ON 19
ci_21                 8.774642e-03 3 1  ON 20
ci_22                 8.772733e-03 3 1  ON 21
ci_23                 4.977527e-03 3 1  ON 22
ci_24                 4.388313e-03 3 1  ON 23
ci_25                 3.124070e-03 3 1  ON 24
ci_26                 3.150739e-03 3 1  ON 25
ci_27                 3.326678e-03 3 1  ON 26
ci_28                 2.505418e-03 3 1  ON 27
ci_29                 2.138605e-03 3 1  ON 28
ci_30                -1.586261e-03 3 1  ON 29
ci_31                -1.612202e-03 3 1  ON 30
ci_32                -1.313457e-03 3 1  ON 31
ci_33                -1.023903e-03 3 1  ON 32
ci_34                 1.462030e-03 3 1  ON 33
ci_35                 1.221170e-03 3 1  ON 34
ci_36                -1.116578e-03 3 1  ON 35
ci_37                -1.122373e-03 3 1  ON 36
ci_38                -5.287900e-04 3 1  ON 37
ci_39                -6.422012e-04 3 1  ON 38
ci_40                -1.672781e-03 3 1  ON 39
ci_41                -1.413501e-03 3 1  ON 40
ci_42                -1.208179e-03 3 1  ON 41
ci_43                -2.700468e-03 3 1  ON 42
ci_44                -1.763450e-03 3 1  ON 43
ci_45                -6.299396e-04 3 1  ON 44
ci_46                -5.317318e-04 3 1  ON 45
ci_47                 1.304271e-03 3 1  ON 46
ci_48                 8.709491e-04 3 1  ON 47
ci_49                -9.523588e-04 3 1  ON 48
ci_50                -7.383347e-04 3 1  ON 49
ci_51                 3.643946e-04 3 1  ON 50
ci_52                 3.765138e-04 3 1  ON 51
ci_53                -6.472842e-04 3 1  ON 52
ci_54                -9.086595e-04 3 1  ON 53
ci_55                -6.739819e-04 3 1  ON 54
ci_56                 1.893422e-03 3 1  ON 55
ci_57                 1.812301e-03 3 1  ON 56
ci_58                -8.220088e-04 3 1  ON 57
ci_59                -9.601656e-04 3 1  ON 58
ci_60                 6.213536e-04 3 1  ON 59
ci_61                 5.646731e-04 3 1  ON 60
ci_62                -2.999906e-04 3 1  ON 61
ci_63                -5.124776e-04 3 1  ON 62
ci_64                -4.062894e-04 3 1  ON 63
ci_65                -3.137457e-04 3 1  ON 64
ci_66                -6.966162e-04 3 1  ON 65
ci_67                -5.894403e-04 3 1  ON 66
ci_68                -6.491395e-04 3 1  ON 67
ci_69                -1.884439e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2142e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.7671
    reference variance = 0.415804
====================================================
  Execution time = 2.5129e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4965e-01
  Total weights = 1.964137001e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434751458564
                                         uncertainty =       0.002023534222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434751458564
                                         uncertainty =       0.002023534222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466197216
  error estimate for blocks of size 2^( 2) =       0.000491206126
  error estimate for blocks of size 2^( 3) =       0.000514579201
  error estimate for blocks of size 2^( 4) =       0.000531314751
  error estimate for blocks of size 2^( 5) =       0.000542713730
  error estimate for blocks of size 2^( 6) =       0.000550019912
  error estimate for blocks of size 2^( 7) =       0.000552844017

      target function =      -0.745631553566
              le_mean =     -22.814910860284
             les_mean =     520.969805404956
             stat err =       0.000544223102
             autocorr =       1.362744999072
   target nu stat err =       0.000544223102
   target dn stat err =       0.004113230775
      target stat err =       0.003457760948
              std dev =       0.659302425005
             le_variance =       0.434679687617


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281491086028e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745646717724       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745646787431       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745646799718       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745646803161       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745646804677       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745646805227       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745646805200       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745646805205       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745646805193       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745646805197       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+02 is 1.187084e-06

solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745646717724       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745646735152       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745646738224       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745646739085       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745646739464       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745646739602       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745646739595       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745646739599       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745646739595       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745646739594       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+03 is 2.967876e-07

solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745646717724       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745646722081       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745646722849       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745646723062       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745646723159       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745646723193       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745646723196       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745646723195       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745646723191       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745646723191       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+03 is 7.419792e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.367526 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9640e+01
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_01                 1.311666e-01 3 1  ON 0
ci_02                -3.109269e-02 3 1  ON 1
ci_03                -3.098616e-02 3 1  ON 2
ci_04                 2.777470e-02 3 1  ON 3
ci_05                -2.306392e-02 3 1  ON 4
ci_06                -2.274380e-02 3 1  ON 5
ci_07                 2.694737e-02 3 1  ON 6
ci_08                -6.353141e-03 3 1  ON 7
ci_09                -9.235703e-03 3 1  ON 8
ci_10                -9.225874e-03 3 1  ON 9
ci_11                 1.301183e-02 3 1  ON 10
ci_12                 7.627473e-03 3 1  ON 11
ci_13                 1.265588e-02 3 1  ON 12
ci_14                 1.311573e-02 3 1  ON 13
ci_15                 7.057918e-03 3 1  ON 14
ci_16                 7.299510e-03 3 1  ON 15
ci_17                -7.468659e-03 3 1  ON 16
ci_18                -7.185295e-03 3 1  ON 17
ci_19                 9.309399e-03 3 1  ON 18
ci_20                 6.818447e-03 3 1  ON 19
ci_21                 8.774611e-03 3 1  ON 20
ci_22                 8.772757e-03 3 1  ON 21
ci_23                 4.977591e-03 3 1  ON 22
ci_24                 4.388282e-03 3 1  ON 23
ci_25                 3.124064e-03 3 1  ON 24
ci_26                 3.150758e-03 3 1  ON 25
ci_27                 3.326713e-03 3 1  ON 26
ci_28                 2.505385e-03 3 1  ON 27
ci_29                 2.138602e-03 3 1  ON 28
ci_30                -1.586231e-03 3 1  ON 29
ci_31                -1.612187e-03 3 1  ON 30
ci_32                -1.313486e-03 3 1  ON 31
ci_33                -1.023920e-03 3 1  ON 32
ci_34                 1.462055e-03 3 1  ON 33
ci_35                 1.221211e-03 3 1  ON 34
ci_36                -1.116562e-03 3 1  ON 35
ci_37                -1.122377e-03 3 1  ON 36
ci_38                -5.287701e-04 3 1  ON 37
ci_39                -6.421870e-04 3 1  ON 38
ci_40                -1.672775e-03 3 1  ON 39
ci_41                -1.413533e-03 3 1  ON 40
ci_42                -1.208173e-03 3 1  ON 41
ci_43                -2.700403e-03 3 1  ON 42
ci_44                -1.763525e-03 3 1  ON 43
ci_45                -6.299234e-04 3 1  ON 44
ci_46                -5.317462e-04 3 1  ON 45
ci_47                 1.304277e-03 3 1  ON 46
ci_48                 8.709612e-04 3 1  ON 47
ci_49                -9.523339e-04 3 1  ON 48
ci_50                -7.383289e-04 3 1  ON 49
ci_51                 3.644052e-04 3 1  ON 50
ci_52                 3.765129e-04 3 1  ON 51
ci_53                -6.473026e-04 3 1  ON 52
ci_54                -9.086930e-04 3 1  ON 53
ci_55                -6.739625e-04 3 1  ON 54
ci_56                 1.893401e-03 3 1  ON 55
ci_57                 1.812328e-03 3 1  ON 56
ci_58                -8.220619e-04 3 1  ON 57
ci_59                -9.601642e-04 3 1  ON 58
ci_60                 6.212902e-04 3 1  ON 59
ci_61                 5.647068e-04 3 1  ON 60
ci_62                -3.000075e-04 3 1  ON 61
ci_63                -5.124498e-04 3 1  ON 62
ci_64                -4.062751e-04 3 1  ON 63
ci_65                -3.137604e-04 3 1  ON 64
ci_66                -6.965805e-04 3 1  ON 65
ci_67                -5.894567e-04 3 1  ON 66
ci_68                -6.491076e-04 3 1  ON 67
ci_69                -1.885804e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.8342
    reference variance = 0.352783
====================================================
  Execution time = 2.4523e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4450e-01
  Total weights = 1.9641e+06
  Execution time = 3.5078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431713677740
                                         uncertainty =       0.001950115282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431713677740
                                         uncertainty =       0.001950115282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464576667
  error estimate for blocks of size 2^( 2) =       0.000490273003
  error estimate for blocks of size 2^( 3) =       0.000514564847
  error estimate for blocks of size 2^( 4) =       0.000532166800
  error estimate for blocks of size 2^( 5) =       0.000543066849
  error estimate for blocks of size 2^( 6) =       0.000550099147
  error estimate for blocks of size 2^( 7) =       0.000550832769

      target function =      -0.749925017160
              le_mean =     -22.814683015147
             les_mean =     520.954260706871
             stat err =       0.000544041391
             autocorr =       1.371352485423
   target nu stat err =       0.000544041391
   target dn stat err =       0.002566516271
      target stat err =       0.002232285338
              std dev =       0.657010622738
             le_variance =       0.431662958390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431713502645
                                         uncertainty =       0.001950109642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431713502645
                                         uncertainty =       0.001950109642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464576573
  error estimate for blocks of size 2^( 2) =       0.000490272945
  error estimate for blocks of size 2^( 3) =       0.000514564824
  error estimate for blocks of size 2^( 4) =       0.000532166804
  error estimate for blocks of size 2^( 5) =       0.000543066868
  error estimate for blocks of size 2^( 6) =       0.000550099164
  error estimate for blocks of size 2^( 7) =       0.000550832808

      target function =      -0.749925850723
              le_mean =     -22.814683008743
             les_mean =     520.954259419517
             stat err =       0.000544041411
             autocorr =       1.371353141077
   target nu stat err =       0.000544041411
   target dn stat err =       0.002566360785
      target stat err =       0.002232164868
              std dev =       0.657010489763
             le_variance =       0.431662783659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431713590177
                                         uncertainty =       0.001950112461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431713590177
                                         uncertainty =       0.001950112461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464576620
  error estimate for blocks of size 2^( 2) =       0.000490272974
  error estimate for blocks of size 2^( 3) =       0.000514564835
  error estimate for blocks of size 2^( 4) =       0.000532166802
  error estimate for blocks of size 2^( 5) =       0.000543066859
  error estimate for blocks of size 2^( 6) =       0.000550099156
  error estimate for blocks of size 2^( 7) =       0.000550832789

      target function =      -0.749925437388
              le_mean =     -22.814683011944
             les_mean =     520.954260059027
             stat err =       0.000544041401
             autocorr =       1.371352813288
   target nu stat err =       0.000544041401
   target dn stat err =       0.002566438493
      target stat err =       0.002232225094
              std dev =       0.657010556239
             le_variance =       0.431662871009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431713666794
                                         uncertainty =       0.001950114929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431713666794
                                         uncertainty =       0.001950114929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464576661
  error estimate for blocks of size 2^( 2) =       0.000490272999
  error estimate for blocks of size 2^( 3) =       0.000514564845
  error estimate for blocks of size 2^( 4) =       0.000532166800
  error estimate for blocks of size 2^( 5) =       0.000543066850
  error estimate for blocks of size 2^( 6) =       0.000550099148
  error estimate for blocks of size 2^( 7) =       0.000550832772

      target function =      -0.749925070085
              le_mean =     -22.814683014747
             les_mean =     520.954260625413
             stat err =       0.000544041393
             autocorr =       1.371352526412
   target nu stat err =       0.000544041393
   target dn stat err =       0.002566506546
      target stat err =       0.002232277807
              std dev =       0.657010614424
             le_variance =       0.431662947466


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749925017160        initial
     3.5527e+02     3.5527e+03             1.1871e-06        -0.749925850723  <--
     1.4211e+03     1.4211e+04             2.9679e-07        -0.749925437388
     5.6843e+03     5.6843e+04             7.4198e-08        -0.749925070085

*****************************************************************************
Applying the update for shift_i =   3.5527e+02     and shift_s =   3.5527e+03
*****************************************************************************

  Execution time = 4.2101e+01
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_01                 1.311657e-01 3 1  ON 0
ci_02                -3.109238e-02 3 1  ON 1
ci_03                -3.098568e-02 3 1  ON 2
ci_04                 2.777443e-02 3 1  ON 3
ci_05                -2.306362e-02 3 1  ON 4
ci_06                -2.274369e-02 3 1  ON 5
ci_07                 2.694737e-02 3 1  ON 6
ci_08                -6.352955e-03 3 1  ON 7
ci_09                -9.235650e-03 3 1  ON 8
ci_10                -9.225783e-03 3 1  ON 9
ci_11                 1.301176e-02 3 1  ON 10
ci_12                 7.627403e-03 3 1  ON 11
ci_13                 1.265591e-02 3 1  ON 12
ci_14                 1.311563e-02 3 1  ON 13
ci_15                 7.057869e-03 3 1  ON 14
ci_16                 7.299446e-03 3 1  ON 15
ci_17                -7.468538e-03 3 1  ON 16
ci_18                -7.185169e-03 3 1  ON 17
ci_19                 9.309375e-03 3 1  ON 18
ci_20                 6.818405e-03 3 1  ON 19
ci_21                 8.774517e-03 3 1  ON 20
ci_22                 8.772830e-03 3 1  ON 21
ci_23                 4.977783e-03 3 1  ON 22
ci_24                 4.388189e-03 3 1  ON 23
ci_25                 3.124045e-03 3 1  ON 24
ci_26                 3.150817e-03 3 1  ON 25
ci_27                 3.326818e-03 3 1  ON 26
ci_28                 2.505286e-03 3 1  ON 27
ci_29                 2.138593e-03 3 1  ON 28
ci_30                -1.586140e-03 3 1  ON 29
ci_31                -1.612142e-03 3 1  ON 30
ci_32                -1.313574e-03 3 1  ON 31
ci_33                -1.023972e-03 3 1  ON 32
ci_34                 1.462128e-03 3 1  ON 33
ci_35                 1.221334e-03 3 1  ON 34
ci_36                -1.116513e-03 3 1  ON 35
ci_37                -1.122387e-03 3 1  ON 36
ci_38                -5.287104e-04 3 1  ON 37
ci_39                -6.421444e-04 3 1  ON 38
ci_40                -1.672756e-03 3 1  ON 39
ci_41                -1.413629e-03 3 1  ON 40
ci_42                -1.208154e-03 3 1  ON 41
ci_43                -2.700207e-03 3 1  ON 42
ci_44                -1.763748e-03 3 1  ON 43
ci_45                -6.298749e-04 3 1  ON 44
ci_46                -5.317897e-04 3 1  ON 45
ci_47                 1.304294e-03 3 1  ON 46
ci_48                 8.709976e-04 3 1  ON 47
ci_49                -9.522591e-04 3 1  ON 48
ci_50                -7.383113e-04 3 1  ON 49
ci_51                 3.644370e-04 3 1  ON 50
ci_52                 3.765099e-04 3 1  ON 51
ci_53                -6.473579e-04 3 1  ON 52
ci_54                -9.087934e-04 3 1  ON 53
ci_55                -6.739046e-04 3 1  ON 54
ci_56                 1.893340e-03 3 1  ON 55
ci_57                 1.812411e-03 3 1  ON 56
ci_58                -8.222213e-04 3 1  ON 57
ci_59                -9.601601e-04 3 1  ON 58
ci_60                 6.210998e-04 3 1  ON 59
ci_61                 5.648076e-04 3 1  ON 60
ci_62                -3.000582e-04 3 1  ON 61
ci_63                -5.123663e-04 3 1  ON 62
ci_64                -4.062322e-04 3 1  ON 63
ci_65                -3.138042e-04 3 1  ON 64
ci_66                -6.964735e-04 3 1  ON 65
ci_67                -5.895058e-04 3 1  ON 66
ci_68                -6.490121e-04 3 1  ON 67
ci_69                -1.889898e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1746e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.8344
    reference variance = 0.39481
====================================================
  Execution time = 2.5111e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4703e-01
  Total weights = 1.964401505e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433755656180
                                         uncertainty =       0.002226964530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433755656180
                                         uncertainty =       0.002226964530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465749683
  error estimate for blocks of size 2^( 2) =       0.000491003715
  error estimate for blocks of size 2^( 3) =       0.000514339234
  error estimate for blocks of size 2^( 4) =       0.000532062377
  error estimate for blocks of size 2^( 5) =       0.000543712348
  error estimate for blocks of size 2^( 6) =       0.000549957164
  error estimate for blocks of size 2^( 7) =       0.000553868565

      target function =      -0.747804768832
              le_mean =     -22.813467025247
             les_mean =     520.901306060113
             stat err =       0.000544900114
             autocorr =       1.368764275040
   target nu stat err =       0.000544900114
   target dn stat err =       0.002948728669
      target stat err =       0.002523343687
              std dev =       0.658669517949
             le_variance =       0.433845533875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281346702525e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747812122893       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747812397093       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747812441361       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747812453921       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747812460136       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747812463521       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747812463606       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747812463576       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747812463566       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747812463523       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747812463538       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+01 is 3.464932e-06

solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747812122893       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747812191473       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747812202543       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747812205684       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747812207237       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747812208083       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747812208104       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747812208097       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747812208094       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747812208084       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747812208088       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+02 is 8.664140e-07

solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747812122893       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747812140040       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747812142808       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747812143595       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747812143982       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747812144195       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747812144201       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747812144199       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747812144198       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747812144195       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747812144191       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+03 is 2.166148e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.371593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9631e+01
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_01                 1.311648e-01 3 1  ON 0
ci_02                -3.109205e-02 3 1  ON 1
ci_03                -3.098544e-02 3 1  ON 2
ci_04                 2.777397e-02 3 1  ON 3
ci_05                -2.306347e-02 3 1  ON 4
ci_06                -2.274338e-02 3 1  ON 5
ci_07                 2.694736e-02 3 1  ON 6
ci_08                -6.352627e-03 3 1  ON 7
ci_09                -9.235184e-03 3 1  ON 8
ci_10                -9.225623e-03 3 1  ON 9
ci_11                 1.301170e-02 3 1  ON 10
ci_12                 7.627535e-03 3 1  ON 11
ci_13                 1.265579e-02 3 1  ON 12
ci_14                 1.311583e-02 3 1  ON 13
ci_15                 7.057623e-03 3 1  ON 14
ci_16                 7.299426e-03 3 1  ON 15
ci_17                -7.468584e-03 3 1  ON 16
ci_18                -7.185004e-03 3 1  ON 17
ci_19                 9.309192e-03 3 1  ON 18
ci_20                 6.818466e-03 3 1  ON 19
ci_21                 8.774495e-03 3 1  ON 20
ci_22                 8.772833e-03 3 1  ON 21
ci_23                 4.977652e-03 3 1  ON 22
ci_24                 4.388059e-03 3 1  ON 23
ci_25                 3.124020e-03 3 1  ON 24
ci_26                 3.150870e-03 3 1  ON 25
ci_27                 3.326903e-03 3 1  ON 26
ci_28                 2.505280e-03 3 1  ON 27
ci_29                 2.138546e-03 3 1  ON 28
ci_30                -1.586130e-03 3 1  ON 29
ci_31                -1.612204e-03 3 1  ON 30
ci_32                -1.313347e-03 3 1  ON 31
ci_33                -1.023791e-03 3 1  ON 32
ci_34                 1.462002e-03 3 1  ON 33
ci_35                 1.221276e-03 3 1  ON 34
ci_36                -1.116570e-03 3 1  ON 35
ci_37                -1.122397e-03 3 1  ON 36
ci_38                -5.287814e-04 3 1  ON 37
ci_39                -6.420427e-04 3 1  ON 38
ci_40                -1.672681e-03 3 1  ON 39
ci_41                -1.413564e-03 3 1  ON 40
ci_42                -1.208309e-03 3 1  ON 41
ci_43                -2.700106e-03 3 1  ON 42
ci_44                -1.764042e-03 3 1  ON 43
ci_45                -6.297207e-04 3 1  ON 44
ci_46                -5.318803e-04 3 1  ON 45
ci_47                 1.304453e-03 3 1  ON 46
ci_48                 8.712705e-04 3 1  ON 47
ci_49                -9.522291e-04 3 1  ON 48
ci_50                -7.383970e-04 3 1  ON 49
ci_51                 3.643851e-04 3 1  ON 50
ci_52                 3.766292e-04 3 1  ON 51
ci_53                -6.473920e-04 3 1  ON 52
ci_54                -9.089193e-04 3 1  ON 53
ci_55                -6.740585e-04 3 1  ON 54
ci_56                 1.893397e-03 3 1  ON 55
ci_57                 1.812463e-03 3 1  ON 56
ci_58                -8.221801e-04 3 1  ON 57
ci_59                -9.600197e-04 3 1  ON 58
ci_60                 6.212588e-04 3 1  ON 59
ci_61                 5.650259e-04 3 1  ON 60
ci_62                -3.002151e-04 3 1  ON 61
ci_63                -5.125010e-04 3 1  ON 62
ci_64                -4.063957e-04 3 1  ON 63
ci_65                -3.139835e-04 3 1  ON 64
ci_66                -6.964393e-04 3 1  ON 65
ci_67                -5.895565e-04 3 1  ON 66
ci_68                -6.488913e-04 3 1  ON 67
ci_69                -1.892192e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.833
    reference variance = 0.45882
====================================================
  Execution time = 2.4412e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4956e-01
  Total weights = 1.9642e+06
  Execution time = 3.5209e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435230188123
                                         uncertainty =       0.001845808392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435230188123
                                         uncertainty =       0.001845808392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466554967
  error estimate for blocks of size 2^( 2) =       0.000491799215
  error estimate for blocks of size 2^( 3) =       0.000515383364
  error estimate for blocks of size 2^( 4) =       0.000533070953
  error estimate for blocks of size 2^( 5) =       0.000542142554
  error estimate for blocks of size 2^( 6) =       0.000548142299
  error estimate for blocks of size 2^( 7) =       0.000553197076

      target function =      -0.745712206111
              le_mean =     -22.814332946146
             les_mean =     520.943345902438
             stat err =       0.000544138220
             autocorr =       1.360231503288
   target nu stat err =       0.000544138220
   target dn stat err =       0.002915042775
      target stat err =       0.002485637411
              std dev =       0.659808362094
             le_variance =       0.435347074690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435229311668
                                         uncertainty =       0.001845783664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435229311668
                                         uncertainty =       0.001845783664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466554495
  error estimate for blocks of size 2^( 2) =       0.000491798876
  error estimate for blocks of size 2^( 3) =       0.000515383161
  error estimate for blocks of size 2^( 4) =       0.000533070838
  error estimate for blocks of size 2^( 5) =       0.000542142526
  error estimate for blocks of size 2^( 6) =       0.000548142281
  error estimate for blocks of size 2^( 7) =       0.000553197082

      target function =      -0.745715565694
              le_mean =     -22.814332962514
             les_mean =     520.943342590033
             stat err =       0.000544138182
             autocorr =       1.360234060933
   target nu stat err =       0.000544138182
   target dn stat err =       0.002914687595
      target stat err =       0.002485374188
              std dev =       0.659807694756
             le_variance =       0.435346194059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435229749606
                                         uncertainty =       0.001845796019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435229749606
                                         uncertainty =       0.001845796019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466554731
  error estimate for blocks of size 2^( 2) =       0.000491799045
  error estimate for blocks of size 2^( 3) =       0.000515383262
  error estimate for blocks of size 2^( 4) =       0.000533070895
  error estimate for blocks of size 2^( 5) =       0.000542142540
  error estimate for blocks of size 2^( 6) =       0.000548142290
  error estimate for blocks of size 2^( 7) =       0.000553197079

      target function =      -0.745713903128
              le_mean =     -22.814332954315
             les_mean =     520.943344224735
             stat err =       0.000544138201
             autocorr =       1.360232782655
   target nu stat err =       0.000544138201
   target dn stat err =       0.002914864970
      target stat err =       0.002485505738
              std dev =       0.659808028205
             le_variance =       0.435346634084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435230133289
                                         uncertainty =       0.001845806844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435230133289
                                         uncertainty =       0.001845806844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466554938
  error estimate for blocks of size 2^( 2) =       0.000491799194
  error estimate for blocks of size 2^( 3) =       0.000515383351
  error estimate for blocks of size 2^( 4) =       0.000533070946
  error estimate for blocks of size 2^( 5) =       0.000542142552
  error estimate for blocks of size 2^( 6) =       0.000548142298
  error estimate for blocks of size 2^( 7) =       0.000553197077

      target function =      -0.745712420177
              le_mean =     -22.814332947166
             les_mean =     520.943345690295
             stat err =       0.000544138218
             autocorr =       1.360231663230
   target nu stat err =       0.000544138218
   target dn stat err =       0.002915020531
      target stat err =       0.002485620949
              std dev =       0.659808320344
             le_variance =       0.435347019595


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745712206111        initial
     8.8818e+01     8.8818e+02             3.4649e-06        -0.745715565694  <--
     3.5527e+02     3.5527e+03             8.6641e-07        -0.745713903128
     1.4211e+03     1.4211e+04             2.1661e-07        -0.745712420177

*****************************************************************************
Applying the update for shift_i =   8.8818e+01     and shift_s =   8.8818e+02
*****************************************************************************

  Execution time = 4.2057e+01
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_01                 1.311622e-01 3 1  ON 0
ci_02                -3.109104e-02 3 1  ON 1
ci_03                -3.098471e-02 3 1  ON 2
ci_04                 2.777259e-02 3 1  ON 3
ci_05                -2.306300e-02 3 1  ON 4
ci_06                -2.274244e-02 3 1  ON 5
ci_07                 2.694732e-02 3 1  ON 6
ci_08                -6.351641e-03 3 1  ON 7
ci_09                -9.233784e-03 3 1  ON 8
ci_10                -9.225144e-03 3 1  ON 9
ci_11                 1.301154e-02 3 1  ON 10
ci_12                 7.627934e-03 3 1  ON 11
ci_13                 1.265541e-02 3 1  ON 12
ci_14                 1.311641e-02 3 1  ON 13
ci_15                 7.056888e-03 3 1  ON 14
ci_16                 7.299366e-03 3 1  ON 15
ci_17                -7.468720e-03 3 1  ON 16
ci_18                -7.184510e-03 3 1  ON 17
ci_19                 9.308645e-03 3 1  ON 18
ci_20                 6.818647e-03 3 1  ON 19
ci_21                 8.774430e-03 3 1  ON 20
ci_22                 8.772843e-03 3 1  ON 21
ci_23                 4.977258e-03 3 1  ON 22
ci_24                 4.387670e-03 3 1  ON 23
ci_25                 3.123946e-03 3 1  ON 24
ci_26                 3.151028e-03 3 1  ON 25
ci_27                 3.327158e-03 3 1  ON 26
ci_28                 2.505262e-03 3 1  ON 27
ci_29                 2.138407e-03 3 1  ON 28
ci_30                -1.586101e-03 3 1  ON 29
ci_31                -1.612387e-03 3 1  ON 30
ci_32                -1.312668e-03 3 1  ON 31
ci_33                -1.023250e-03 3 1  ON 32
ci_34                 1.461624e-03 3 1  ON 33
ci_35                 1.221103e-03 3 1  ON 34
ci_36                -1.116741e-03 3 1  ON 35
ci_37                -1.122425e-03 3 1  ON 36
ci_38                -5.289941e-04 3 1  ON 37
ci_39                -6.417380e-04 3 1  ON 38
ci_40                -1.672459e-03 3 1  ON 39
ci_41                -1.413368e-03 3 1  ON 40
ci_42                -1.208773e-03 3 1  ON 41
ci_43                -2.699803e-03 3 1  ON 42
ci_44                -1.764925e-03 3 1  ON 43
ci_45                -6.292584e-04 3 1  ON 44
ci_46                -5.321521e-04 3 1  ON 45
ci_47                 1.304927e-03 3 1  ON 46
ci_48                 8.720891e-04 3 1  ON 47
ci_49                -9.521394e-04 3 1  ON 48
ci_50                -7.386538e-04 3 1  ON 49
ci_51                 3.642293e-04 3 1  ON 50
ci_52                 3.769868e-04 3 1  ON 51
ci_53                -6.474942e-04 3 1  ON 52
ci_54                -9.092968e-04 3 1  ON 53
ci_55                -6.745202e-04 3 1  ON 54
ci_56                 1.893568e-03 3 1  ON 55
ci_57                 1.812619e-03 3 1  ON 56
ci_58                -8.220568e-04 3 1  ON 57
ci_59                -9.595987e-04 3 1  ON 58
ci_60                 6.217357e-04 3 1  ON 59
ci_61                 5.656805e-04 3 1  ON 60
ci_62                -3.006856e-04 3 1  ON 61
ci_63                -5.129049e-04 3 1  ON 62
ci_64                -4.068856e-04 3 1  ON 63
ci_65                -3.145208e-04 3 1  ON 64
ci_66                -6.963368e-04 3 1  ON 65
ci_67                -5.897086e-04 3 1  ON 66
ci_68                -6.485290e-04 3 1  ON 67
ci_69                -1.899070e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1694e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.9054
    reference variance = 0.412285
====================================================
  Execution time = 2.5132e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5367e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4600e-01
  Total weights = 1.964309175e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433915596654
                                         uncertainty =       0.002004352682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433915596654
                                         uncertainty =       0.002004352682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465769795
  error estimate for blocks of size 2^( 2) =       0.000491212351
  error estimate for blocks of size 2^( 3) =       0.000514597724
  error estimate for blocks of size 2^( 4) =       0.000531733168
  error estimate for blocks of size 2^( 5) =       0.000543258887
  error estimate for blocks of size 2^( 6) =       0.000549544302
  error estimate for blocks of size 2^( 7) =       0.000553621444

      target function =      -0.748664446654
              le_mean =     -22.813747294661
             les_mean =     520.913065918836
             stat err =       0.000544539450
             autocorr =       1.366834884322
   target nu stat err =       0.000544539450
   target dn stat err =       0.002455690342
      target stat err =       0.002133447540
              std dev =       0.658697961411
             le_variance =       0.433883004367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281374729466e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+01, overlap shift 2.2204e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748669571457       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748670293721       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748670400816       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748670429085       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748670442350       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748670443334       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748670445727       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748670445872       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748670445695       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748670445706       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+01 is 1.580302e-05

solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748669571457       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748669752332       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748669779133       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748669786202       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748669789516       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748669789759       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748669790357       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748669790393       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748669790349       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748669790352       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+01 is 3.954268e-06

solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748669571457       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748669616695       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748669623397       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748669625164       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748669625993       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748669626053       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748669626203       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748669626212       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748669626201       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748669626202       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+02 is 9.887867e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.375077 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9666e+01
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_01                 1.311583e-01 3 1  ON 0
ci_02                -3.108995e-02 3 1  ON 1
ci_03                -3.098303e-02 3 1  ON 2
ci_04                 2.777085e-02 3 1  ON 3
ci_05                -2.306202e-02 3 1  ON 4
ci_06                -2.274115e-02 3 1  ON 5
ci_07                 2.694655e-02 3 1  ON 6
ci_08                -6.350801e-03 3 1  ON 7
ci_09                -9.233233e-03 3 1  ON 8
ci_10                -9.225056e-03 3 1  ON 9
ci_11                 1.301179e-02 3 1  ON 10
ci_12                 7.627460e-03 3 1  ON 11
ci_13                 1.265513e-02 3 1  ON 12
ci_14                 1.311726e-02 3 1  ON 13
ci_15                 7.057278e-03 3 1  ON 14
ci_16                 7.299004e-03 3 1  ON 15
ci_17                -7.468440e-03 3 1  ON 16
ci_18                -7.183787e-03 3 1  ON 17
ci_19                 9.308845e-03 3 1  ON 18
ci_20                 6.818309e-03 3 1  ON 19
ci_21                 8.774524e-03 3 1  ON 20
ci_22                 8.772998e-03 3 1  ON 21
ci_23                 4.976811e-03 3 1  ON 22
ci_24                 4.387145e-03 3 1  ON 23
ci_25                 3.123595e-03 3 1  ON 24
ci_26                 3.150956e-03 3 1  ON 25
ci_27                 3.326427e-03 3 1  ON 26
ci_28                 2.505430e-03 3 1  ON 27
ci_29                 2.138394e-03 3 1  ON 28
ci_30                -1.586092e-03 3 1  ON 29
ci_31                -1.612343e-03 3 1  ON 30
ci_32                -1.312452e-03 3 1  ON 31
ci_33                -1.023820e-03 3 1  ON 32
ci_34                 1.461779e-03 3 1  ON 33
ci_35                 1.220977e-03 3 1  ON 34
ci_36                -1.117101e-03 3 1  ON 35
ci_37                -1.121939e-03 3 1  ON 36
ci_38                -5.291559e-04 3 1  ON 37
ci_39                -6.419432e-04 3 1  ON 38
ci_40                -1.672318e-03 3 1  ON 39
ci_41                -1.413430e-03 3 1  ON 40
ci_42                -1.209385e-03 3 1  ON 41
ci_43                -2.699827e-03 3 1  ON 42
ci_44                -1.764815e-03 3 1  ON 43
ci_45                -6.290154e-04 3 1  ON 44
ci_46                -5.324753e-04 3 1  ON 45
ci_47                 1.305267e-03 3 1  ON 46
ci_48                 8.726759e-04 3 1  ON 47
ci_49                -9.521076e-04 3 1  ON 48
ci_50                -7.390194e-04 3 1  ON 49
ci_51                 3.643356e-04 3 1  ON 50
ci_52                 3.768852e-04 3 1  ON 51
ci_53                -6.470974e-04 3 1  ON 52
ci_54                -9.090441e-04 3 1  ON 53
ci_55                -6.742091e-04 3 1  ON 54
ci_56                 1.893223e-03 3 1  ON 55
ci_57                 1.812695e-03 3 1  ON 56
ci_58                -8.218296e-04 3 1  ON 57
ci_59                -9.586412e-04 3 1  ON 58
ci_60                 6.216123e-04 3 1  ON 59
ci_61                 5.661082e-04 3 1  ON 60
ci_62                -3.005393e-04 3 1  ON 61
ci_63                -5.124693e-04 3 1  ON 62
ci_64                -4.072149e-04 3 1  ON 63
ci_65                -3.145283e-04 3 1  ON 64
ci_66                -6.961784e-04 3 1  ON 65
ci_67                -5.892941e-04 3 1  ON 66
ci_68                -6.486462e-04 3 1  ON 67
ci_69                -1.901799e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.8909
    reference variance = 0.558673
====================================================
  Execution time = 2.4381e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5055e-01
  Total weights = 1.9642e+06
  Execution time = 3.5106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434823193876
                                         uncertainty =       0.001857233690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434823193876
                                         uncertainty =       0.001857233690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466336719
  error estimate for blocks of size 2^( 2) =       0.000491652074
  error estimate for blocks of size 2^( 3) =       0.000515722774
  error estimate for blocks of size 2^( 4) =       0.000533053997
  error estimate for blocks of size 2^( 5) =       0.000543915885
  error estimate for blocks of size 2^( 6) =       0.000549430673
  error estimate for blocks of size 2^( 7) =       0.000552447712

      target function =      -0.744890556072
              le_mean =     -22.814642913042
             les_mean =     520.958481659970
             stat err =       0.000544712067
             autocorr =       1.364378180540
   target nu stat err =       0.000544712067
   target dn stat err =       0.003301292929
      target stat err =       0.002792063443
              std dev =       0.659499713214
             le_variance =       0.434939871729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434820521706
                                         uncertainty =       0.001857086281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434820521706
                                         uncertainty =       0.001857086281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466335290
  error estimate for blocks of size 2^( 2) =       0.000491651184
  error estimate for blocks of size 2^( 3) =       0.000515722362
  error estimate for blocks of size 2^( 4) =       0.000533053970
  error estimate for blocks of size 2^( 5) =       0.000543916005
  error estimate for blocks of size 2^( 6) =       0.000549431027
  error estimate for blocks of size 2^( 7) =       0.000552448335

      target function =      -0.744894055405
              le_mean =     -22.814642912259
             les_mean =     520.958477384586
             stat err =       0.000544712334
             autocorr =       1.364387883214
   target nu stat err =       0.000544712334
   target dn stat err =       0.003301555410
      target stat err =       0.002792300741
              std dev =       0.659497692266
             le_variance =       0.434937206105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434821854157
                                         uncertainty =       0.001857159734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434821854157
                                         uncertainty =       0.001857159734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466336003
  error estimate for blocks of size 2^( 2) =       0.000491651627
  error estimate for blocks of size 2^( 3) =       0.000515722567
  error estimate for blocks of size 2^( 4) =       0.000533053982
  error estimate for blocks of size 2^( 5) =       0.000543915944
  error estimate for blocks of size 2^( 6) =       0.000549430849
  error estimate for blocks of size 2^( 7) =       0.000552448023

      target function =      -0.744892396145
              le_mean =     -22.814642912464
             les_mean =     520.958479404315
             stat err =       0.000544712200
             autocorr =       1.364383039600
   target nu stat err =       0.000544712200
   target dn stat err =       0.003301416297
      target stat err =       0.002792176406
              std dev =       0.659498699989
             le_variance =       0.434938535287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434823026161
                                         uncertainty =       0.001857224427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434823026161
                                         uncertainty =       0.001857224427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466336630
  error estimate for blocks of size 2^( 2) =       0.000491652018
  error estimate for blocks of size 2^( 3) =       0.000515722748
  error estimate for blocks of size 2^( 4) =       0.000533053995
  error estimate for blocks of size 2^( 5) =       0.000543915892
  error estimate for blocks of size 2^( 6) =       0.000549430695
  error estimate for blocks of size 2^( 7) =       0.000552447750

      target function =      -0.744890795736
              le_mean =     -22.814642912950
             les_mean =     520.958481365418
             stat err =       0.000544712083
             autocorr =       1.364378788233
   target nu stat err =       0.000544712083
   target dn stat err =       0.003301307470
      target stat err =       0.002792076924
              std dev =       0.659499586371
             le_variance =       0.434939704424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744890556072        initial
     2.2204e+01     2.2204e+02             1.5803e-05        -0.744894055405  <--
     8.8818e+01     8.8818e+02             3.9543e-06        -0.744892396145
     3.5527e+02     3.5527e+03             9.8879e-07        -0.744890795736

*****************************************************************************
Applying the update for shift_i =   2.2204e+01     and shift_s =   2.2204e+02
*****************************************************************************

  Execution time = 4.1971e+01
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_01                 1.311464e-01 3 1  ON 0
ci_02                -3.108668e-02 3 1  ON 1
ci_03                -3.097799e-02 3 1  ON 2
ci_04                 2.776564e-02 3 1  ON 3
ci_05                -2.305909e-02 3 1  ON 4
ci_06                -2.273730e-02 3 1  ON 5
ci_07                 2.694425e-02 3 1  ON 6
ci_08                -6.348286e-03 3 1  ON 7
ci_09                -9.231583e-03 3 1  ON 8
ci_10                -9.224793e-03 3 1  ON 9
ci_11                 1.301255e-02 3 1  ON 10
ci_12                 7.626043e-03 3 1  ON 11
ci_13                 1.265429e-02 3 1  ON 12
ci_14                 1.311982e-02 3 1  ON 13
ci_15                 7.058449e-03 3 1  ON 14
ci_16                 7.297922e-03 3 1  ON 15
ci_17                -7.467603e-03 3 1  ON 16
ci_18                -7.181621e-03 3 1  ON 17
ci_19                 9.309445e-03 3 1  ON 18
ci_20                 6.817296e-03 3 1  ON 19
ci_21                 8.774805e-03 3 1  ON 20
ci_22                 8.773462e-03 3 1  ON 21
ci_23                 4.975471e-03 3 1  ON 22
ci_24                 4.385572e-03 3 1  ON 23
ci_25                 3.122545e-03 3 1  ON 24
ci_26                 3.150738e-03 3 1  ON 25
ci_27                 3.324238e-03 3 1  ON 26
ci_28                 2.505933e-03 3 1  ON 27
ci_29                 2.138356e-03 3 1  ON 28
ci_30                -1.586067e-03 3 1  ON 29
ci_31                -1.612210e-03 3 1  ON 30
ci_32                -1.311804e-03 3 1  ON 31
ci_33                -1.025527e-03 3 1  ON 32
ci_34                 1.462241e-03 3 1  ON 33
ci_35                 1.220600e-03 3 1  ON 34
ci_36                -1.118176e-03 3 1  ON 35
ci_37                -1.120485e-03 3 1  ON 36
ci_38                -5.296400e-04 3 1  ON 37
ci_39                -6.425574e-04 3 1  ON 38
ci_40                -1.671896e-03 3 1  ON 39
ci_41                -1.413616e-03 3 1  ON 40
ci_42                -1.211216e-03 3 1  ON 41
ci_43                -2.699898e-03 3 1  ON 42
ci_44                -1.764486e-03 3 1  ON 43
ci_45                -6.282880e-04 3 1  ON 44
ci_46                -5.334428e-04 3 1  ON 45
ci_47                 1.306286e-03 3 1  ON 46
ci_48                 8.744330e-04 3 1  ON 47
ci_49                -9.520122e-04 3 1  ON 48
ci_50                -7.401131e-04 3 1  ON 49
ci_51                 3.646539e-04 3 1  ON 50
ci_52                 3.765809e-04 3 1  ON 51
ci_53                -6.459098e-04 3 1  ON 52
ci_54                -9.082877e-04 3 1  ON 53
ci_55                -6.732776e-04 3 1  ON 54
ci_56                 1.892190e-03 3 1  ON 55
ci_57                 1.812922e-03 3 1  ON 56
ci_58                -8.211492e-04 3 1  ON 57
ci_59                -9.557755e-04 3 1  ON 58
ci_60                 6.212427e-04 3 1  ON 59
ci_61                 5.673897e-04 3 1  ON 60
ci_62                -3.001017e-04 3 1  ON 61
ci_63                -5.111655e-04 3 1  ON 62
ci_64                -4.082003e-04 3 1  ON 63
ci_65                -3.145507e-04 3 1  ON 64
ci_66                -6.957040e-04 3 1  ON 65
ci_67                -5.880537e-04 3 1  ON 66
ci_68                -6.489969e-04 3 1  ON 67
ci_69                -1.909965e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1643e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.7796
    reference variance = 0.255655
====================================================
  Execution time = 2.5090e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4738e-01
  Total weights = 1.964109662e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433443756056
                                         uncertainty =       0.002050860684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433443756056
                                         uncertainty =       0.002050860684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465575769
  error estimate for blocks of size 2^( 2) =       0.000490742937
  error estimate for blocks of size 2^( 3) =       0.000513694939
  error estimate for blocks of size 2^( 4) =       0.000530572329
  error estimate for blocks of size 2^( 5) =       0.000541877524
  error estimate for blocks of size 2^( 6) =       0.000547229089
  error estimate for blocks of size 2^( 7) =       0.000553921580

      target function =      -0.747522115686
              le_mean =     -22.814518459521
             les_mean =     520.949628494471
             stat err =       0.000543400130
             autocorr =       1.362256026063
   target nu stat err =       0.000543400130
   target dn stat err =       0.003007549903
      target stat err =       0.002572548262
              std dev =       0.658423567002
             le_variance =       0.433521593583


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281451845952e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+00, overlap shift 5.5511e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747530005543       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747532720089       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747533187254       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747533371991       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747533381865       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747533383786       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747533389391       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747533388700       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747533389076       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+00 is 5.596925e-05

solving harmonic davidson linear method for identity shift 2.2204e+01, overlap shift 2.2204e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747530005543       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747530688749       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747530805995       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747530852262       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747530854648       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747530855102       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747530856496       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747530856323       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747530856416       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+01 is 1.404192e-05

solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747530005543       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747530176632       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747530205972       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747530217544       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747530218135       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747530218247       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747530218595       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747530218552       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747530218575       residual = 9.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+01 is 3.513595e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.378126 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9626e+01
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_01                 1.311324e-01 3 1  ON 0
ci_02                -3.108080e-02 3 1  ON 1
ci_03                -3.097422e-02 3 1  ON 2
ci_04                 2.776197e-02 3 1  ON 3
ci_05                -2.305378e-02 3 1  ON 4
ci_06                -2.273199e-02 3 1  ON 5
ci_07                 2.694542e-02 3 1  ON 6
ci_08                -6.345085e-03 3 1  ON 7
ci_09                -9.229937e-03 3 1  ON 8
ci_10                -9.225352e-03 3 1  ON 9
ci_11                 1.301218e-02 3 1  ON 10
ci_12                 7.622513e-03 3 1  ON 11
ci_13                 1.265380e-02 3 1  ON 12
ci_14                 1.312086e-02 3 1  ON 13
ci_15                 7.056847e-03 3 1  ON 14
ci_16                 7.296721e-03 3 1  ON 15
ci_17                -7.466143e-03 3 1  ON 16
ci_18                -7.176997e-03 3 1  ON 17
ci_19                 9.307958e-03 3 1  ON 18
ci_20                 6.816646e-03 3 1  ON 19
ci_21                 8.774260e-03 3 1  ON 20
ci_22                 8.772448e-03 3 1  ON 21
ci_23                 4.977501e-03 3 1  ON 22
ci_24                 4.387771e-03 3 1  ON 23
ci_25                 3.120077e-03 3 1  ON 24
ci_26                 3.149326e-03 3 1  ON 25
ci_27                 3.324170e-03 3 1  ON 26
ci_28                 2.502750e-03 3 1  ON 27
ci_29                 2.138210e-03 3 1  ON 28
ci_30                -1.583647e-03 3 1  ON 29
ci_31                -1.613088e-03 3 1  ON 30
ci_32                -1.312766e-03 3 1  ON 31
ci_33                -1.026602e-03 3 1  ON 32
ci_34                 1.460822e-03 3 1  ON 33
ci_35                 1.220202e-03 3 1  ON 34
ci_36                -1.115255e-03 3 1  ON 35
ci_37                -1.121283e-03 3 1  ON 36
ci_38                -5.297863e-04 3 1  ON 37
ci_39                -6.431549e-04 3 1  ON 38
ci_40                -1.671722e-03 3 1  ON 39
ci_41                -1.415351e-03 3 1  ON 40
ci_42                -1.209013e-03 3 1  ON 41
ci_43                -2.702473e-03 3 1  ON 42
ci_44                -1.766362e-03 3 1  ON 43
ci_45                -6.278525e-04 3 1  ON 44
ci_46                -5.334551e-04 3 1  ON 45
ci_47                 1.307809e-03 3 1  ON 46
ci_48                 8.746458e-04 3 1  ON 47
ci_49                -9.532161e-04 3 1  ON 48
ci_50                -7.405536e-04 3 1  ON 49
ci_51                 3.638007e-04 3 1  ON 50
ci_52                 3.764537e-04 3 1  ON 51
ci_53                -6.468039e-04 3 1  ON 52
ci_54                -9.088165e-04 3 1  ON 53
ci_55                -6.734553e-04 3 1  ON 54
ci_56                 1.889105e-03 3 1  ON 55
ci_57                 1.812389e-03 3 1  ON 56
ci_58                -8.210972e-04 3 1  ON 57
ci_59                -9.554505e-04 3 1  ON 58
ci_60                 6.240226e-04 3 1  ON 59
ci_61                 5.638510e-04 3 1  ON 60
ci_62                -2.999601e-04 3 1  ON 61
ci_63                -5.139308e-04 3 1  ON 62
ci_64                -4.089290e-04 3 1  ON 63
ci_65                -3.141528e-04 3 1  ON 64
ci_66                -6.950884e-04 3 1  ON 65
ci_67                -5.882772e-04 3 1  ON 66
ci_68                -6.529243e-04 3 1  ON 67
ci_69                -1.937926e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.8124
    reference variance = 0.380748
====================================================
  Execution time = 2.4394e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4381e-01
  Total weights = 1.9642e+06
  Execution time = 3.5007e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433391602806
                                         uncertainty =       0.001729935207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433391602806
                                         uncertainty =       0.001729935207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465542751
  error estimate for blocks of size 2^( 2) =       0.000491075264
  error estimate for blocks of size 2^( 3) =       0.000514540481
  error estimate for blocks of size 2^( 4) =       0.000532346812
  error estimate for blocks of size 2^( 5) =       0.000544043123
  error estimate for blocks of size 2^( 6) =       0.000551447719
  error estimate for blocks of size 2^( 7) =       0.000553295739

      target function =      -0.750495585879
              le_mean =     -22.815015819370
             les_mean =     520.968770828341
             stat err =       0.000545283348
             autocorr =       1.371909091001
   target nu stat err =       0.000545283348
   target dn stat err =       0.002204751624
      target stat err =       0.001946866117
              std dev =       0.658376872258
             le_variance =       0.433460105924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433386160520
                                         uncertainty =       0.001730085504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433386160520
                                         uncertainty =       0.001730085504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465539840
  error estimate for blocks of size 2^( 2) =       0.000491074046
  error estimate for blocks of size 2^( 3) =       0.000514541120
  error estimate for blocks of size 2^( 4) =       0.000532349136
  error estimate for blocks of size 2^( 5) =       0.000544046151
  error estimate for blocks of size 2^( 6) =       0.000551451623
  error estimate for blocks of size 2^( 7) =       0.000553300064

      target function =      -0.750535847938
              le_mean =     -22.815015896644
             les_mean =     520.968726352858
             stat err =       0.000545286744
             autocorr =       1.371943332183
   target nu stat err =       0.000545286744
   target dn stat err =       0.002204162114
      target stat err =       0.001946596577
              std dev =       0.658372755646
             le_variance =       0.433454685377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433388850646
                                         uncertainty =       0.001730010454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433388850646
                                         uncertainty =       0.001730010454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465541279
  error estimate for blocks of size 2^( 2) =       0.000491074643
  error estimate for blocks of size 2^( 3) =       0.000514540795
  error estimate for blocks of size 2^( 4) =       0.000532347973
  error estimate for blocks of size 2^( 5) =       0.000544044638
  error estimate for blocks of size 2^( 6) =       0.000551449675
  error estimate for blocks of size 2^( 7) =       0.000553297907

      target function =      -0.750521400494
              le_mean =     -22.815015854785
             les_mean =     520.968741667130
             stat err =       0.000545285048
             autocorr =       1.371926321707
   target nu stat err =       0.000545285048
   target dn stat err =       0.002204291511
      target stat err =       0.001946627668
              std dev =       0.658374790450
             le_variance =       0.433457364701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433391256473
                                         uncertainty =       0.001729944583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433391256473
                                         uncertainty =       0.001729944583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465542566
  error estimate for blocks of size 2^( 2) =       0.000491075185
  error estimate for blocks of size 2^( 3) =       0.000514540520
  error estimate for blocks of size 2^( 4) =       0.000532346956
  error estimate for blocks of size 2^( 5) =       0.000544043312
  error estimate for blocks of size 2^( 6) =       0.000551447963
  error estimate for blocks of size 2^( 7) =       0.000553296009

      target function =      -0.750499753049
              le_mean =     -22.815015823392
             les_mean =     520.968766043545
             stat err =       0.000545283560
             autocorr =       1.371911249474
   target nu stat err =       0.000545283560
   target dn stat err =       0.002204658934
      target stat err =       0.001946812933
              std dev =       0.658376610277
             le_variance =       0.433459760959


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750495585879        initial
     5.5511e+00     5.5511e+01             5.5969e-05        -0.750535847938  <--
     2.2204e+01     2.2204e+02             1.4042e-05        -0.750521400494
     8.8818e+01     8.8818e+02             3.5136e-06        -0.750499753049

*****************************************************************************
Applying the update for shift_i =   5.5511e+00     and shift_s =   5.5511e+01
*****************************************************************************

  Execution time = 4.3644e+01
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_01                 1.310904e-01 3 1  ON 0
ci_02                -3.106329e-02 3 1  ON 1
ci_03                -3.096302e-02 3 1  ON 2
ci_04                 2.775104e-02 3 1  ON 3
ci_05                -2.303796e-02 3 1  ON 4
ci_06                -2.271620e-02 3 1  ON 5
ci_07                 2.694890e-02 3 1  ON 6
ci_08                -6.335567e-03 3 1  ON 7
ci_09                -9.225033e-03 3 1  ON 8
ci_10                -9.227019e-03 3 1  ON 9
ci_11                 1.301110e-02 3 1  ON 10
ci_12                 7.612018e-03 3 1  ON 11
ci_13                 1.265232e-02 3 1  ON 12
ci_14                 1.312397e-02 3 1  ON 13
ci_15                 7.052080e-03 3 1  ON 14
ci_16                 7.293146e-03 3 1  ON 15
ci_17                -7.461793e-03 3 1  ON 16
ci_18                -7.163226e-03 3 1  ON 17
ci_19                 9.303539e-03 3 1  ON 18
ci_20                 6.814712e-03 3 1  ON 19
ci_21                 8.772634e-03 3 1  ON 20
ci_22                 8.769426e-03 3 1  ON 21
ci_23                 4.983539e-03 3 1  ON 22
ci_24                 4.394335e-03 3 1  ON 23
ci_25                 3.112741e-03 3 1  ON 24
ci_26                 3.145122e-03 3 1  ON 25
ci_27                 3.323969e-03 3 1  ON 26
ci_28                 2.493274e-03 3 1  ON 27
ci_29                 2.137772e-03 3 1  ON 28
ci_30                -1.576429e-03 3 1  ON 29
ci_31                -1.615709e-03 3 1  ON 30
ci_32                -1.315626e-03 3 1  ON 31
ci_33                -1.029804e-03 3 1  ON 32
ci_34                 1.456606e-03 3 1  ON 33
ci_35                 1.219022e-03 3 1  ON 34
ci_36                -1.106568e-03 3 1  ON 35
ci_37                -1.123654e-03 3 1  ON 36
ci_38                -5.302229e-04 3 1  ON 37
ci_39                -6.449308e-04 3 1  ON 38
ci_40                -1.671201e-03 3 1  ON 39
ci_41                -1.420511e-03 3 1  ON 40
ci_42                -1.202463e-03 3 1  ON 41
ci_43                -2.710133e-03 3 1  ON 42
ci_44                -1.771946e-03 3 1  ON 43
ci_45                -6.265560e-04 3 1  ON 44
ci_46                -5.334916e-04 3 1  ON 45
ci_47                 1.312349e-03 3 1  ON 46
ci_48                 8.752834e-04 3 1  ON 47
ci_49                -9.567915e-04 3 1  ON 48
ci_50                -7.418612e-04 3 1  ON 49
ci_51                 3.612632e-04 3 1  ON 50
ci_52                 3.760750e-04 3 1  ON 51
ci_53                -6.494570e-04 3 1  ON 52
ci_54                -9.103926e-04 3 1  ON 53
ci_55                -6.739825e-04 3 1  ON 54
ci_56                 1.879939e-03 3 1  ON 55
ci_57                 1.810804e-03 3 1  ON 56
ci_58                -8.209451e-04 3 1  ON 57
ci_59                -9.544838e-04 3 1  ON 58
ci_60                 6.323283e-04 3 1  ON 59
ci_61                 5.532720e-04 3 1  ON 60
ci_62                -2.995363e-04 3 1  ON 61
ci_63                -5.221448e-04 3 1  ON 62
ci_64                -4.110941e-04 3 1  ON 63
ci_65                -3.129671e-04 3 1  ON 64
ci_66                -6.932590e-04 3 1  ON 65
ci_67                -5.889399e-04 3 1  ON 66
ci_68                -6.646063e-04 3 1  ON 67
ci_69                -2.021100e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3276e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.7431
    reference variance = 0.597149
====================================================
  Execution time = 2.5125e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5403e-01
  Total weights = 1.964354682e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438805432715
                                         uncertainty =       0.003510526964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438805432715
                                         uncertainty =       0.003510526964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468422949
  error estimate for blocks of size 2^( 2) =       0.000493419171
  error estimate for blocks of size 2^( 3) =       0.000517086316
  error estimate for blocks of size 2^( 4) =       0.000533822665
  error estimate for blocks of size 2^( 5) =       0.000543940502
  error estimate for blocks of size 2^( 6) =       0.000548636047
  error estimate for blocks of size 2^( 7) =       0.000553127123

      target function =      -0.742014993686
              le_mean =     -22.814262160783
             les_mean =     520.944589459046
             stat err =       0.000544881584
             autocorr =       1.353093886221
   target nu stat err =       0.000544881584
   target dn stat err =       0.005094721848
      target stat err =       0.004215289305
              std dev =       0.662450087316
             le_variance =       0.438840118186


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281426216078e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+00, overlap shift 1.3878e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742037693753       residual = 7.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742078174718       residual = 8.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742083918384       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742084366802       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742084558264       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742084650548       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742084734519       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742084740808       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742084745049       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742084748910       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+00 is 3.269947e-04

solving harmonic davidson linear method for identity shift 5.5511e+00, overlap shift 5.5511e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742037693753       residual = 7.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742048092207       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742049550679       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742049663394       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742049711407       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742049734121       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742049754782       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742049756288       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742049757319       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742049758264       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+00 is 8.378775e-05

solving harmonic davidson linear method for identity shift 2.2204e+01, overlap shift 2.2204e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742037693753       residual = 7.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742040311355       residual = 8.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742040677400       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742040705615       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742040717626       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742040723281       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742040728425       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742040728797       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742040729053       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742040729288       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+01 is 2.107838e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.381650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9663e+01
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_01                 1.310526e-01 3 1  ON 0
ci_02                -3.100075e-02 3 1  ON 1
ci_03                -3.093738e-02 3 1  ON 2
ci_04                 2.772586e-02 3 1  ON 3
ci_05                -2.300049e-02 3 1  ON 4
ci_06                -2.271210e-02 3 1  ON 5
ci_07                 2.694375e-02 3 1  ON 6
ci_08                -6.327508e-03 3 1  ON 7
ci_09                -9.200049e-03 3 1  ON 8
ci_10                -9.225343e-03 3 1  ON 9
ci_11                 1.301963e-02 3 1  ON 10
ci_12                 7.598329e-03 3 1  ON 11
ci_13                 1.266291e-02 3 1  ON 12
ci_14                 1.313152e-02 3 1  ON 13
ci_15                 7.046034e-03 3 1  ON 14
ci_16                 7.289686e-03 3 1  ON 15
ci_17                -7.439519e-03 3 1  ON 16
ci_18                -7.168718e-03 3 1  ON 17
ci_19                 9.318328e-03 3 1  ON 18
ci_20                 6.812354e-03 3 1  ON 19
ci_21                 8.778058e-03 3 1  ON 20
ci_22                 8.776465e-03 3 1  ON 21
ci_23                 4.981566e-03 3 1  ON 22
ci_24                 4.401540e-03 3 1  ON 23
ci_25                 3.110207e-03 3 1  ON 24
ci_26                 3.152805e-03 3 1  ON 25
ci_27                 3.330903e-03 3 1  ON 26
ci_28                 2.485030e-03 3 1  ON 27
ci_29                 2.153468e-03 3 1  ON 28
ci_30                -1.570837e-03 3 1  ON 29
ci_31                -1.608644e-03 3 1  ON 30
ci_32                -1.293821e-03 3 1  ON 31
ci_33                -1.015755e-03 3 1  ON 32
ci_34                 1.452962e-03 3 1  ON 33
ci_35                 1.302810e-03 3 1  ON 34
ci_36                -1.102107e-03 3 1  ON 35
ci_37                -1.121016e-03 3 1  ON 36
ci_38                -5.287097e-04 3 1  ON 37
ci_39                -6.462806e-04 3 1  ON 38
ci_40                -1.668446e-03 3 1  ON 39
ci_41                -1.404706e-03 3 1  ON 40
ci_42                -1.195504e-03 3 1  ON 41
ci_43                -2.708730e-03 3 1  ON 42
ci_44                -1.801236e-03 3 1  ON 43
ci_45                -6.185675e-04 3 1  ON 44
ci_46                -5.286116e-04 3 1  ON 45
ci_47                 1.313152e-03 3 1  ON 46
ci_48                 8.877926e-04 3 1  ON 47
ci_49                -9.531271e-04 3 1  ON 48
ci_50                -7.388600e-04 3 1  ON 49
ci_51                 3.601308e-04 3 1  ON 50
ci_52                 3.725552e-04 3 1  ON 51
ci_53                -6.560939e-04 3 1  ON 52
ci_54                -8.930149e-04 3 1  ON 53
ci_55                -6.650249e-04 3 1  ON 54
ci_56                 1.896780e-03 3 1  ON 55
ci_57                 1.810658e-03 3 1  ON 56
ci_58                -8.187810e-04 3 1  ON 57
ci_59                -9.589509e-04 3 1  ON 58
ci_60                 6.313290e-04 3 1  ON 59
ci_61                 5.607395e-04 3 1  ON 60
ci_62                -3.247324e-04 3 1  ON 61
ci_63                -5.193999e-04 3 1  ON 62
ci_64                -4.086948e-04 3 1  ON 63
ci_65                -3.148600e-04 3 1  ON 64
ci_66                -6.864401e-04 3 1  ON 65
ci_67                -5.963628e-04 3 1  ON 66
ci_68                -6.434151e-04 3 1  ON 67
ci_69                -2.018465e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.8549
    reference variance = 0.479162
====================================================
  Execution time = 2.4615e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4499e-01
  Total weights = 1.9644e+06
  Execution time = 3.5049e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433133666777
                                         uncertainty =       0.001991329738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433133666777
                                         uncertainty =       0.001991329738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465363357
  error estimate for blocks of size 2^( 2) =       0.000490687399
  error estimate for blocks of size 2^( 3) =       0.000514585427
  error estimate for blocks of size 2^( 4) =       0.000531595285
  error estimate for blocks of size 2^( 5) =       0.000541750571
  error estimate for blocks of size 2^( 6) =       0.000546654597
  error estimate for blocks of size 2^( 7) =       0.000549665947

      target function =      -0.749710895441
              le_mean =     -22.815477623195
             les_mean =     520.990781588387
             stat err =       0.000542416600
             autocorr =       1.358568612292
   target nu stat err =       0.000542416600
   target dn stat err =       0.002631747313
      target stat err =       0.002285836557
              std dev =       0.658123171113
             le_variance =       0.433126108355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433129290679
                                         uncertainty =       0.001993394221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433129290679
                                         uncertainty =       0.001993394221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465361052
  error estimate for blocks of size 2^( 2) =       0.000490693296
  error estimate for blocks of size 2^( 3) =       0.000514598645
  error estimate for blocks of size 2^( 4) =       0.000531613396
  error estimate for blocks of size 2^( 5) =       0.000541774976
  error estimate for blocks of size 2^( 6) =       0.000546680933
  error estimate for blocks of size 2^( 7) =       0.000549691591

      target function =      -0.748414916885
              le_mean =     -22.815477839298
             les_mean =     520.992335797960
             stat err =       0.000542440224
             autocorr =       1.358700414002
   target nu stat err =       0.000542440224
   target dn stat err =       0.003483251648
      target stat err =       0.002969402191
              std dev =       0.658119911404
             le_variance =       0.433121817786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433130303501
                                         uncertainty =       0.001992358084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433130303501
                                         uncertainty =       0.001992358084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465361575
  error estimate for blocks of size 2^( 2) =       0.000490689801
  error estimate for blocks of size 2^( 3) =       0.000514591570
  error estimate for blocks of size 2^( 4) =       0.000531604086
  error estimate for blocks of size 2^( 5) =       0.000541762635
  error estimate for blocks of size 2^( 6) =       0.000546667618
  error estimate for blocks of size 2^( 7) =       0.000549678606

      target function =      -0.749256759917
              le_mean =     -22.815477628521
             les_mean =     520.991322872468
             stat err =       0.000542428236
             autocorr =       1.358637310382
   target nu stat err =       0.000542428236
   target dn stat err =       0.002883686002
      target stat err =       0.002486994359
              std dev =       0.658120650365
             le_variance =       0.433122790437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433133117229
                                         uncertainty =       0.001991455413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433133117229
                                         uncertainty =       0.001991455413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465363065
  error estimate for blocks of size 2^( 2) =       0.000490687632
  error estimate for blocks of size 2^( 3) =       0.000514586132
  error estimate for blocks of size 2^( 4) =       0.000531596336
  error estimate for blocks of size 2^( 5) =       0.000541752035
  error estimate for blocks of size 2^( 6) =       0.000546656176
  error estimate for blocks of size 2^( 7) =       0.000549667478

      target function =      -0.749668768501
              le_mean =     -22.815477609735
             les_mean =     520.990831153676
             stat err =       0.000542418006
             autocorr =       1.358577362597
   target nu stat err =       0.000542418006
   target dn stat err =       0.002652950390
      target stat err =       0.002302714358
              std dev =       0.658122758044
             le_variance =       0.433125564655


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749710895441        initial  <--
     1.3878e+00     1.3878e+01             3.2699e-04        -0.748414916885
     5.5511e+00     5.5511e+01             8.3788e-05        -0.749256759917
     2.2204e+01     2.2204e+02             2.1078e-05        -0.749668768501

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1966
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_01                 1.310904e-01 3 1  ON 0
ci_02                -3.106329e-02 3 1  ON 1
ci_03                -3.096302e-02 3 1  ON 2
ci_04                 2.775104e-02 3 1  ON 3
ci_05                -2.303796e-02 3 1  ON 4
ci_06                -2.271620e-02 3 1  ON 5
ci_07                 2.694890e-02 3 1  ON 6
ci_08                -6.335567e-03 3 1  ON 7
ci_09                -9.225033e-03 3 1  ON 8
ci_10                -9.227019e-03 3 1  ON 9
ci_11                 1.301110e-02 3 1  ON 10
ci_12                 7.612018e-03 3 1  ON 11
ci_13                 1.265232e-02 3 1  ON 12
ci_14                 1.312397e-02 3 1  ON 13
ci_15                 7.052080e-03 3 1  ON 14
ci_16                 7.293146e-03 3 1  ON 15
ci_17                -7.461793e-03 3 1  ON 16
ci_18                -7.163226e-03 3 1  ON 17
ci_19                 9.303539e-03 3 1  ON 18
ci_20                 6.814712e-03 3 1  ON 19
ci_21                 8.772634e-03 3 1  ON 20
ci_22                 8.769426e-03 3 1  ON 21
ci_23                 4.983539e-03 3 1  ON 22
ci_24                 4.394335e-03 3 1  ON 23
ci_25                 3.112741e-03 3 1  ON 24
ci_26                 3.145122e-03 3 1  ON 25
ci_27                 3.323969e-03 3 1  ON 26
ci_28                 2.493274e-03 3 1  ON 27
ci_29                 2.137772e-03 3 1  ON 28
ci_30                -1.576429e-03 3 1  ON 29
ci_31                -1.615709e-03 3 1  ON 30
ci_32                -1.315626e-03 3 1  ON 31
ci_33                -1.029804e-03 3 1  ON 32
ci_34                 1.456606e-03 3 1  ON 33
ci_35                 1.219022e-03 3 1  ON 34
ci_36                -1.106568e-03 3 1  ON 35
ci_37                -1.123654e-03 3 1  ON 36
ci_38                -5.302229e-04 3 1  ON 37
ci_39                -6.449308e-04 3 1  ON 38
ci_40                -1.671201e-03 3 1  ON 39
ci_41                -1.420511e-03 3 1  ON 40
ci_42                -1.202463e-03 3 1  ON 41
ci_43                -2.710133e-03 3 1  ON 42
ci_44                -1.771946e-03 3 1  ON 43
ci_45                -6.265560e-04 3 1  ON 44
ci_46                -5.334916e-04 3 1  ON 45
ci_47                 1.312349e-03 3 1  ON 46
ci_48                 8.752834e-04 3 1  ON 47
ci_49                -9.567915e-04 3 1  ON 48
ci_50                -7.418612e-04 3 1  ON 49
ci_51                 3.612632e-04 3 1  ON 50
ci_52                 3.760750e-04 3 1  ON 51
ci_53                -6.494570e-04 3 1  ON 52
ci_54                -9.103926e-04 3 1  ON 53
ci_55                -6.739825e-04 3 1  ON 54
ci_56                 1.879939e-03 3 1  ON 55
ci_57                 1.810804e-03 3 1  ON 56
ci_58                -8.209451e-04 3 1  ON 57
ci_59                -9.544838e-04 3 1  ON 58
ci_60                 6.323283e-04 3 1  ON 59
ci_61                 5.532720e-04 3 1  ON 60
ci_62                -2.995363e-04 3 1  ON 61
ci_63                -5.221448e-04 3 1  ON 62
ci_64                -4.110941e-04 3 1  ON 63
ci_65                -3.129671e-04 3 1  ON 64
ci_66                -6.932590e-04 3 1  ON 65
ci_67                -5.889399e-04 3 1  ON 66
ci_68                -6.646063e-04 3 1  ON 67
ci_69                -2.021100e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1865e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.9329
    reference variance = 0.513807
====================================================
  Execution time = 2.5101e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5365e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5128e-01
  Total weights = 1.964128435e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437153117921
                                         uncertainty =       0.003609983705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437153117921
                                         uncertainty =       0.003609983705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467499967
  error estimate for blocks of size 2^( 2) =       0.000492843850
  error estimate for blocks of size 2^( 3) =       0.000516437463
  error estimate for blocks of size 2^( 4) =       0.000534695198
  error estimate for blocks of size 2^( 5) =       0.000546186950
  error estimate for blocks of size 2^( 6) =       0.000552263768
  error estimate for blocks of size 2^( 7) =       0.000555431335

      target function =      -0.744286249690
              le_mean =     -22.814773919471
             les_mean =     520.965188543845
             stat err =       0.000547144313
             autocorr =       1.369747792601
   target nu stat err =       0.000547144313
   target dn stat err =       0.003736664140
      target stat err =       0.003140155107
              std dev =       0.661144794135
             le_variance =       0.437112438812


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281477391947e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+01, overlap shift 1.3878e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744298548394       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744300562085       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744300874779       residual = 9.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744300939398       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744300960909       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744300980443       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744300987793       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744300988219       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744300988393       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744300988258       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+01 is 2.464557e-05

solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744298548394       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744299053211       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744299131515       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744299147680       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744299153051       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744299157928       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744299159761       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744299159867       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744299159910       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744299159876       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+01 is 6.170183e-06

solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744298548394       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744298674686       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744298694270       residual = 9.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744298698312       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744298699654       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744298700873       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744298701331       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744298701357       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744298701368       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744298701360       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+02 is 1.543096e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.385159 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9653e+01
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_01                 1.310843e-01 3 1  ON 0
ci_02                -3.106136e-02 3 1  ON 1
ci_03                -3.096097e-02 3 1  ON 2
ci_04                 2.774786e-02 3 1  ON 3
ci_05                -2.303448e-02 3 1  ON 4
ci_06                -2.271416e-02 3 1  ON 5
ci_07                 2.694942e-02 3 1  ON 6
ci_08                -6.333843e-03 3 1  ON 7
ci_09                -9.222694e-03 3 1  ON 8
ci_10                -9.226590e-03 3 1  ON 9
ci_11                 1.300992e-02 3 1  ON 10
ci_12                 7.612243e-03 3 1  ON 11
ci_13                 1.265332e-02 3 1  ON 12
ci_14                 1.312485e-02 3 1  ON 13
ci_15                 7.050509e-03 3 1  ON 14
ci_16                 7.292470e-03 3 1  ON 15
ci_17                -7.461232e-03 3 1  ON 16
ci_18                -7.162191e-03 3 1  ON 17
ci_19                 9.303153e-03 3 1  ON 18
ci_20                 6.815056e-03 3 1  ON 19
ci_21                 8.772056e-03 3 1  ON 20
ci_22                 8.769359e-03 3 1  ON 21
ci_23                 4.981721e-03 3 1  ON 22
ci_24                 4.394120e-03 3 1  ON 23
ci_25                 3.111281e-03 3 1  ON 24
ci_26                 3.144255e-03 3 1  ON 25
ci_27                 3.323130e-03 3 1  ON 26
ci_28                 2.493075e-03 3 1  ON 27
ci_29                 2.136568e-03 3 1  ON 28
ci_30                -1.576233e-03 3 1  ON 29
ci_31                -1.615067e-03 3 1  ON 30
ci_32                -1.315842e-03 3 1  ON 31
ci_33                -1.029240e-03 3 1  ON 32
ci_34                 1.456879e-03 3 1  ON 33
ci_35                 1.220250e-03 3 1  ON 34
ci_36                -1.106454e-03 3 1  ON 35
ci_37                -1.123180e-03 3 1  ON 36
ci_38                -5.308625e-04 3 1  ON 37
ci_39                -6.438965e-04 3 1  ON 38
ci_40                -1.671173e-03 3 1  ON 39
ci_41                -1.419317e-03 3 1  ON 40
ci_42                -1.203658e-03 3 1  ON 41
ci_43                -2.709760e-03 3 1  ON 42
ci_44                -1.771304e-03 3 1  ON 43
ci_45                -6.257389e-04 3 1  ON 44
ci_46                -5.344816e-04 3 1  ON 45
ci_47                 1.312559e-03 3 1  ON 46
ci_48                 8.765734e-04 3 1  ON 47
ci_49                -9.565655e-04 3 1  ON 48
ci_50                -7.415785e-04 3 1  ON 49
ci_51                 3.605914e-04 3 1  ON 50
ci_52                 3.761431e-04 3 1  ON 51
ci_53                -6.492369e-04 3 1  ON 52
ci_54                -9.095375e-04 3 1  ON 53
ci_55                -6.731762e-04 3 1  ON 54
ci_56                 1.879695e-03 3 1  ON 55
ci_57                 1.810832e-03 3 1  ON 56
ci_58                -8.219982e-04 3 1  ON 57
ci_59                -9.548998e-04 3 1  ON 58
ci_60                 6.323521e-04 3 1  ON 59
ci_61                 5.539276e-04 3 1  ON 60
ci_62                -2.991279e-04 3 1  ON 61
ci_63                -5.229551e-04 3 1  ON 62
ci_64                -4.097314e-04 3 1  ON 63
ci_65                -3.134801e-04 3 1  ON 64
ci_66                -6.918437e-04 3 1  ON 65
ci_67                -5.885725e-04 3 1  ON 66
ci_68                -6.658760e-04 3 1  ON 67
ci_69                -2.030903e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.7356
    reference variance = 0.365459
====================================================
  Execution time = 2.4372e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5685e-01
  Total weights = 1.9643e+06
  Execution time = 3.5244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442063728003
                                         uncertainty =       0.005004844322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442063728003
                                         uncertainty =       0.005004844322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470125495
  error estimate for blocks of size 2^( 2) =       0.000495516245
  error estimate for blocks of size 2^( 3) =       0.000518969524
  error estimate for blocks of size 2^( 4) =       0.000536700608
  error estimate for blocks of size 2^( 5) =       0.000546781958
  error estimate for blocks of size 2^( 6) =       0.000552133561
  error estimate for blocks of size 2^( 7) =       0.000554577778

      target function =      -0.739689242200
              le_mean =     -22.814913216243
             les_mean =     520.977117188670
             stat err =       0.000547548476
             autocorr =       1.356492954774
   target nu stat err =       0.000547548476
   target dn stat err =       0.006843932391
      target stat err =       0.005607616586
              std dev =       0.664857850421
             le_variance =       0.442035961267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442059251491
                                         uncertainty =       0.005004711917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442059251491
                                         uncertainty =       0.005004711917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470123117
  error estimate for blocks of size 2^( 2) =       0.000495514819
  error estimate for blocks of size 2^( 3) =       0.000518969126
  error estimate for blocks of size 2^( 4) =       0.000536700864
  error estimate for blocks of size 2^( 5) =       0.000546782866
  error estimate for blocks of size 2^( 6) =       0.000552134610
  error estimate for blocks of size 2^( 7) =       0.000554578889

      target function =      -0.739692889066
              le_mean =     -22.814913297192
             les_mean =     520.977116437679
             stat err =       0.000547549307
             autocorr =       1.356510796920
   target nu stat err =       0.000547549307
   target dn stat err =       0.006841719321
      target stat err =       0.005605879793
              std dev =       0.664854487483
             le_variance =       0.442031489526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442061480574
                                         uncertainty =       0.005004777860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442061480574
                                         uncertainty =       0.005004777860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470124301
  error estimate for blocks of size 2^( 2) =       0.000495515528
  error estimate for blocks of size 2^( 3) =       0.000518969323
  error estimate for blocks of size 2^( 4) =       0.000536700734
  error estimate for blocks of size 2^( 5) =       0.000546782411
  error estimate for blocks of size 2^( 6) =       0.000552134084
  error estimate for blocks of size 2^( 7) =       0.000554578332

      target function =      -0.739691314353
              le_mean =     -22.814913256195
             les_mean =     520.977116484043
             stat err =       0.000547548890
             autocorr =       1.356501897334
   target nu stat err =       0.000547548890
   target dn stat err =       0.006842820268
      target stat err =       0.005606747410
              std dev =       0.664856162065
             le_variance =       0.442033716235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442063446440
                                         uncertainty =       0.005004835995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442063446440
                                         uncertainty =       0.005004835995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470125345
  error estimate for blocks of size 2^( 2) =       0.000495516155
  error estimate for blocks of size 2^( 3) =       0.000518969499
  error estimate for blocks of size 2^( 4) =       0.000536700623
  error estimate for blocks of size 2^( 5) =       0.000546782014
  error estimate for blocks of size 2^( 6) =       0.000552133626
  error estimate for blocks of size 2^( 7) =       0.000554577847

      target function =      -0.739689528620
              le_mean =     -22.814913221173
             les_mean =     520.977117064031
             stat err =       0.000547548528
             autocorr =       1.356494073326
   target nu stat err =       0.000547548528
   target dn stat err =       0.006843792949
      target stat err =       0.005607508006
              std dev =       0.664857638901
             le_variance =       0.442035680005


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739689242200        initial
     1.3878e+01     1.3878e+02             2.4646e-05        -0.739692889066  <--
     5.5511e+01     5.5511e+02             6.1702e-06        -0.739691314353
     2.2204e+02     2.2204e+03             1.5431e-06        -0.739689528620

*****************************************************************************
Applying the update for shift_i =   1.3878e+01     and shift_s =   1.3878e+02
*****************************************************************************

  Execution time = 4.2036e+01
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_01                 1.310658e-01 3 1  ON 0
ci_02                -3.105556e-02 3 1  ON 1
ci_03                -3.095486e-02 3 1  ON 2
ci_04                 2.773835e-02 3 1  ON 3
ci_05                -2.302407e-02 3 1  ON 4
ci_06                -2.270807e-02 3 1  ON 5
ci_07                 2.695099e-02 3 1  ON 6
ci_08                -6.328689e-03 3 1  ON 7
ci_09                -9.215700e-03 3 1  ON 8
ci_10                -9.225309e-03 3 1  ON 9
ci_11                 1.300639e-02 3 1  ON 10
ci_12                 7.612918e-03 3 1  ON 11
ci_13                 1.265634e-02 3 1  ON 12
ci_14                 1.312748e-02 3 1  ON 13
ci_15                 7.045811e-03 3 1  ON 14
ci_16                 7.290446e-03 3 1  ON 15
ci_17                -7.459552e-03 3 1  ON 16
ci_18                -7.159097e-03 3 1  ON 17
ci_19                 9.301998e-03 3 1  ON 18
ci_20                 6.816082e-03 3 1  ON 19
ci_21                 8.770330e-03 3 1  ON 20
ci_22                 8.769160e-03 3 1  ON 21
ci_23                 4.976289e-03 3 1  ON 22
ci_24                 4.393479e-03 3 1  ON 23
ci_25                 3.106918e-03 3 1  ON 24
ci_26                 3.141665e-03 3 1  ON 25
ci_27                 3.320624e-03 3 1  ON 26
ci_28                 2.492477e-03 3 1  ON 27
ci_29                 2.132967e-03 3 1  ON 28
ci_30                -1.575645e-03 3 1  ON 29
ci_31                -1.613146e-03 3 1  ON 30
ci_32                -1.316488e-03 3 1  ON 31
ci_33                -1.027554e-03 3 1  ON 32
ci_34                 1.457699e-03 3 1  ON 33
ci_35                 1.223923e-03 3 1  ON 34
ci_36                -1.106115e-03 3 1  ON 35
ci_37                -1.121761e-03 3 1  ON 36
ci_38                -5.327740e-04 3 1  ON 37
ci_39                -6.408044e-04 3 1  ON 38
ci_40                -1.671091e-03 3 1  ON 39
ci_41                -1.415750e-03 3 1  ON 40
ci_42                -1.207231e-03 3 1  ON 41
ci_43                -2.708643e-03 3 1  ON 42
ci_44                -1.769382e-03 3 1  ON 43
ci_45                -6.232964e-04 3 1  ON 44
ci_46                -5.374403e-04 3 1  ON 45
ci_47                 1.313190e-03 3 1  ON 46
ci_48                 8.804333e-04 3 1  ON 47
ci_49                -9.558899e-04 3 1  ON 48
ci_50                -7.407345e-04 3 1  ON 49
ci_51                 3.585837e-04 3 1  ON 50
ci_52                 3.763461e-04 3 1  ON 51
ci_53                -6.485791e-04 3 1  ON 52
ci_54                -9.069810e-04 3 1  ON 53
ci_55                -6.707659e-04 3 1  ON 54
ci_56                 1.878968e-03 3 1  ON 55
ci_57                 1.810914e-03 3 1  ON 56
ci_58                -8.251465e-04 3 1  ON 57
ci_59                -9.561438e-04 3 1  ON 58
ci_60                 6.324243e-04 3 1  ON 59
ci_61                 5.558918e-04 3 1  ON 60
ci_62                -2.979078e-04 3 1  ON 61
ci_63                -5.253762e-04 3 1  ON 62
ci_64                -4.056583e-04 3 1  ON 63
ci_65                -3.150140e-04 3 1  ON 64
ci_66                -6.876130e-04 3 1  ON 65
ci_67                -5.874753e-04 3 1  ON 66
ci_68                -6.696722e-04 3 1  ON 67
ci_69                -2.060214e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1722e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.8619
    reference variance = 0.469337
====================================================
  Execution time = 2.5084e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4637e-01
  Total weights = 1.964320447e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435025032232
                                         uncertainty =       0.002149060380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435025032232
                                         uncertainty =       0.002149060380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466356251
  error estimate for blocks of size 2^( 2) =       0.000491915724
  error estimate for blocks of size 2^( 3) =       0.000515259544
  error estimate for blocks of size 2^( 4) =       0.000532699247
  error estimate for blocks of size 2^( 5) =       0.000543962522
  error estimate for blocks of size 2^( 6) =       0.000549659884
  error estimate for blocks of size 2^( 7) =       0.000551313055

      target function =      -0.748358642316
              le_mean =     -22.814106768763
             les_mean =     520.929836413105
             stat err =       0.000544408677
             autocorr =       1.362744607931
   target nu stat err =       0.000544408677
   target dn stat err =       0.002822736026
      target stat err =       0.002427507629
              std dev =       0.659527334788
             le_variance =       0.434976305333


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281410676876e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+00, overlap shift 3.4694e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748365494909       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748371009594       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748371648188       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748371750208       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748371815038       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748371824235       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748371816906       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748371814716       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748371813542       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+00 is 7.340143e-05

solving harmonic davidson linear method for identity shift 1.3878e+01, overlap shift 1.3878e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748365494909       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748366888428       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748367048887       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748367074456       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748367090586       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748367092856       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748367091019       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748367090470       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748367090183       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+01 is 1.846032e-05

solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748365494909       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748365844229       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748365884394       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748365890791       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748365894818       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748365895384       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748365894924       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748365894787       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748365894716       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+01 is 4.622008e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.388176 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9589e+01
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_01                 1.310473e-01 3 1  ON 0
ci_02                -3.104494e-02 3 1  ON 1
ci_03                -3.093961e-02 3 1  ON 2
ci_04                 2.773210e-02 3 1  ON 3
ci_05                -2.301430e-02 3 1  ON 4
ci_06                -2.270397e-02 3 1  ON 5
ci_07                 2.694689e-02 3 1  ON 6
ci_08                -6.325392e-03 3 1  ON 7
ci_09                -9.212982e-03 3 1  ON 8
ci_10                -9.225179e-03 3 1  ON 9
ci_11                 1.300590e-02 3 1  ON 10
ci_12                 7.609077e-03 3 1  ON 11
ci_13                 1.265399e-02 3 1  ON 12
ci_14                 1.313276e-02 3 1  ON 13
ci_15                 7.042566e-03 3 1  ON 14
ci_16                 7.288991e-03 3 1  ON 15
ci_17                -7.457564e-03 3 1  ON 16
ci_18                -7.153918e-03 3 1  ON 17
ci_19                 9.306388e-03 3 1  ON 18
ci_20                 6.819312e-03 3 1  ON 19
ci_21                 8.769990e-03 3 1  ON 20
ci_22                 8.769651e-03 3 1  ON 21
ci_23                 4.969353e-03 3 1  ON 22
ci_24                 4.393559e-03 3 1  ON 23
ci_25                 3.107676e-03 3 1  ON 24
ci_26                 3.146655e-03 3 1  ON 25
ci_27                 3.321356e-03 3 1  ON 26
ci_28                 2.490178e-03 3 1  ON 27
ci_29                 2.132244e-03 3 1  ON 28
ci_30                -1.577661e-03 3 1  ON 29
ci_31                -1.609161e-03 3 1  ON 30
ci_32                -1.314282e-03 3 1  ON 31
ci_33                -1.028198e-03 3 1  ON 32
ci_34                 1.461262e-03 3 1  ON 33
ci_35                 1.220388e-03 3 1  ON 34
ci_36                -1.105085e-03 3 1  ON 35
ci_37                -1.125422e-03 3 1  ON 36
ci_38                -5.323304e-04 3 1  ON 37
ci_39                -6.400061e-04 3 1  ON 38
ci_40                -1.672316e-03 3 1  ON 39
ci_41                -1.412879e-03 3 1  ON 40
ci_42                -1.208839e-03 3 1  ON 41
ci_43                -2.703470e-03 3 1  ON 42
ci_44                -1.765285e-03 3 1  ON 43
ci_45                -6.235781e-04 3 1  ON 44
ci_46                -5.391299e-04 3 1  ON 45
ci_47                 1.313214e-03 3 1  ON 46
ci_48                 8.842514e-04 3 1  ON 47
ci_49                -9.591536e-04 3 1  ON 48
ci_50                -7.408550e-04 3 1  ON 49
ci_51                 3.602438e-04 3 1  ON 50
ci_52                 3.733488e-04 3 1  ON 51
ci_53                -6.457704e-04 3 1  ON 52
ci_54                -9.114047e-04 3 1  ON 53
ci_55                -6.710934e-04 3 1  ON 54
ci_56                 1.875948e-03 3 1  ON 55
ci_57                 1.813965e-03 3 1  ON 56
ci_58                -8.266178e-04 3 1  ON 57
ci_59                -9.543511e-04 3 1  ON 58
ci_60                 6.268951e-04 3 1  ON 59
ci_61                 5.629448e-04 3 1  ON 60
ci_62                -2.960989e-04 3 1  ON 61
ci_63                -5.252900e-04 3 1  ON 62
ci_64                -4.072789e-04 3 1  ON 63
ci_65                -3.097819e-04 3 1  ON 64
ci_66                -6.900539e-04 3 1  ON 65
ci_67                -5.915271e-04 3 1  ON 66
ci_68                -6.704828e-04 3 1  ON 67
ci_69                -2.135301e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.8781
    reference variance = 0.417403
====================================================
  Execution time = 2.4421e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4991e-01
  Total weights = 1.9644e+06
  Execution time = 3.5197e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436910507794
                                         uncertainty =       0.002193255969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436910507794
                                         uncertainty =       0.002193255969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467449948
  error estimate for blocks of size 2^( 2) =       0.000492852250
  error estimate for blocks of size 2^( 3) =       0.000516165038
  error estimate for blocks of size 2^( 4) =       0.000533920214
  error estimate for blocks of size 2^( 5) =       0.000544899200
  error estimate for blocks of size 2^( 6) =       0.000550858535
  error estimate for blocks of size 2^( 7) =       0.000551894315

      target function =      -0.745442814171
              le_mean =     -22.815727817864
             les_mean =     521.007321328503
             stat err =       0.000545393066
             autocorr =       1.361284793087
   target nu stat err =       0.000545393066
   target dn stat err =       0.003057766383
      target stat err =       0.002604220232
              std dev =       0.661074055723
             le_variance =       0.437018907150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436896431782
                                         uncertainty =       0.002192229033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436896431782
                                         uncertainty =       0.002192229033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467442416
  error estimate for blocks of size 2^( 2) =       0.000492847752
  error estimate for blocks of size 2^( 3) =       0.000516163509
  error estimate for blocks of size 2^( 4) =       0.000533921367
  error estimate for blocks of size 2^( 5) =       0.000544901161
  error estimate for blocks of size 2^( 6) =       0.000550862779
  error estimate for blocks of size 2^( 7) =       0.000551899193

      target function =      -0.745235869882
              le_mean =     -22.815727849607
             les_mean =     521.007572595435
             stat err =       0.000545396125
             autocorr =       1.361343932856
   target nu stat err =       0.000545396125
   target dn stat err =       0.003072311922
      target stat err =       0.002614526889
              std dev =       0.661063404185
             le_variance =       0.437004824352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436903346849
                                         uncertainty =       0.002192737619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436903346849
                                         uncertainty =       0.002192737619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467446116
  error estimate for blocks of size 2^( 2) =       0.000492849952
  error estimate for blocks of size 2^( 3) =       0.000516164233
  error estimate for blocks of size 2^( 4) =       0.000533920764
  error estimate for blocks of size 2^( 5) =       0.000544900153
  error estimate for blocks of size 2^( 6) =       0.000550860615
  error estimate for blocks of size 2^( 7) =       0.000551896729

      target function =      -0.745396473672
              le_mean =     -22.815727820781
             les_mean =     521.007377407139
             stat err =       0.000545394565
             autocorr =       1.361314594385
   target nu stat err =       0.000545394565
   target dn stat err =       0.003058630025
      target stat err =       0.002604601265
              std dev =       0.661068636983
             le_variance =       0.437011742803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436909603941
                                         uncertainty =       0.002193191033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436909603941
                                         uncertainty =       0.002193191033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467449464
  error estimate for blocks of size 2^( 2) =       0.000492851958
  error estimate for blocks of size 2^( 3) =       0.000516164934
  error estimate for blocks of size 2^( 4) =       0.000533920279
  error estimate for blocks of size 2^( 5) =       0.000544899315
  error estimate for blocks of size 2^( 6) =       0.000550858790
  error estimate for blocks of size 2^( 7) =       0.000551894613

      target function =      -0.745439637852
              le_mean =     -22.815727817006
             les_mean =     521.007325124502
             stat err =       0.000545393249
             autocorr =       1.361288525686
   target nu stat err =       0.000545393249
   target dn stat err =       0.003057722636
      target stat err =       0.002604163442
              std dev =       0.661073371779
             le_variance =       0.437018002876


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745442814171        initial  <--
     3.4694e+00     3.4694e+01             7.3401e-05        -0.745235869882
     1.3878e+01     1.3878e+02             1.8460e-05        -0.745396473672
     5.5511e+01     5.5511e+02             4.6220e-06        -0.745439637852

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.0533
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_01                 1.310658e-01 3 1  ON 0
ci_02                -3.105556e-02 3 1  ON 1
ci_03                -3.095486e-02 3 1  ON 2
ci_04                 2.773835e-02 3 1  ON 3
ci_05                -2.302407e-02 3 1  ON 4
ci_06                -2.270807e-02 3 1  ON 5
ci_07                 2.695099e-02 3 1  ON 6
ci_08                -6.328689e-03 3 1  ON 7
ci_09                -9.215700e-03 3 1  ON 8
ci_10                -9.225309e-03 3 1  ON 9
ci_11                 1.300639e-02 3 1  ON 10
ci_12                 7.612918e-03 3 1  ON 11
ci_13                 1.265634e-02 3 1  ON 12
ci_14                 1.312748e-02 3 1  ON 13
ci_15                 7.045811e-03 3 1  ON 14
ci_16                 7.290446e-03 3 1  ON 15
ci_17                -7.459552e-03 3 1  ON 16
ci_18                -7.159097e-03 3 1  ON 17
ci_19                 9.301998e-03 3 1  ON 18
ci_20                 6.816082e-03 3 1  ON 19
ci_21                 8.770330e-03 3 1  ON 20
ci_22                 8.769160e-03 3 1  ON 21
ci_23                 4.976289e-03 3 1  ON 22
ci_24                 4.393479e-03 3 1  ON 23
ci_25                 3.106918e-03 3 1  ON 24
ci_26                 3.141665e-03 3 1  ON 25
ci_27                 3.320624e-03 3 1  ON 26
ci_28                 2.492477e-03 3 1  ON 27
ci_29                 2.132967e-03 3 1  ON 28
ci_30                -1.575645e-03 3 1  ON 29
ci_31                -1.613146e-03 3 1  ON 30
ci_32                -1.316488e-03 3 1  ON 31
ci_33                -1.027554e-03 3 1  ON 32
ci_34                 1.457699e-03 3 1  ON 33
ci_35                 1.223923e-03 3 1  ON 34
ci_36                -1.106115e-03 3 1  ON 35
ci_37                -1.121761e-03 3 1  ON 36
ci_38                -5.327740e-04 3 1  ON 37
ci_39                -6.408044e-04 3 1  ON 38
ci_40                -1.671091e-03 3 1  ON 39
ci_41                -1.415750e-03 3 1  ON 40
ci_42                -1.207231e-03 3 1  ON 41
ci_43                -2.708643e-03 3 1  ON 42
ci_44                -1.769382e-03 3 1  ON 43
ci_45                -6.232964e-04 3 1  ON 44
ci_46                -5.374403e-04 3 1  ON 45
ci_47                 1.313190e-03 3 1  ON 46
ci_48                 8.804333e-04 3 1  ON 47
ci_49                -9.558899e-04 3 1  ON 48
ci_50                -7.407345e-04 3 1  ON 49
ci_51                 3.585837e-04 3 1  ON 50
ci_52                 3.763461e-04 3 1  ON 51
ci_53                -6.485791e-04 3 1  ON 52
ci_54                -9.069810e-04 3 1  ON 53
ci_55                -6.707659e-04 3 1  ON 54
ci_56                 1.878968e-03 3 1  ON 55
ci_57                 1.810914e-03 3 1  ON 56
ci_58                -8.251465e-04 3 1  ON 57
ci_59                -9.561438e-04 3 1  ON 58
ci_60                 6.324243e-04 3 1  ON 59
ci_61                 5.558918e-04 3 1  ON 60
ci_62                -2.979078e-04 3 1  ON 61
ci_63                -5.253762e-04 3 1  ON 62
ci_64                -4.056583e-04 3 1  ON 63
ci_65                -3.150140e-04 3 1  ON 64
ci_66                -6.876130e-04 3 1  ON 65
ci_67                -5.874753e-04 3 1  ON 66
ci_68                -6.696722e-04 3 1  ON 67
ci_69                -2.060214e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1648e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.8229
    reference variance = 0.479707
====================================================
  Execution time = 2.5179e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4626e-01
  Total weights = 1.963989673e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432912782291
                                         uncertainty =       0.001920247906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432912782291
                                         uncertainty =       0.001920247906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465267621
  error estimate for blocks of size 2^( 2) =       0.000490570889
  error estimate for blocks of size 2^( 3) =       0.000514481303
  error estimate for blocks of size 2^( 4) =       0.000531834685
  error estimate for blocks of size 2^( 5) =       0.000543560515
  error estimate for blocks of size 2^( 6) =       0.000550105929
  error estimate for blocks of size 2^( 7) =       0.000552633417

      target function =      -0.748454790869
              le_mean =     -22.814435604759
             les_mean =     520.944727083853
             stat err =       0.000544533637
             autocorr =       1.369757741791
   target nu stat err =       0.000544533637
   target dn stat err =       0.002974902548
      target stat err =       0.002552335050
              std dev =       0.657987779671
             le_variance =       0.432947918196


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281443560476e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+01, overlap shift 3.4694e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748462499516       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748463304386       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748463402804       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748463425132       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748463431824       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748463434406       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748463435254       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748463435323       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748463435316       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+01 is 1.018498e-05

solving harmonic davidson linear method for identity shift 1.3878e+02, overlap shift 1.3878e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748462499516       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748462700948       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748462725567       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748462731150       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748462732821       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748462733466       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748462733678       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748462733695       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748462733693       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+02 is 2.547750e-06

solving harmonic davidson linear method for identity shift 5.5511e+02, overlap shift 5.5511e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748462499516       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748462549888       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748462556043       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748462557439       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748462557857       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748462558018       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748462558071       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748462558075       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748462558075       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+02 is 6.370317e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.391224 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9692e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_01                 1.310632e-01 3 1  ON 0
ci_02                -3.105421e-02 3 1  ON 1
ci_03                -3.095370e-02 3 1  ON 2
ci_04                 2.773768e-02 3 1  ON 3
ci_05                -2.302376e-02 3 1  ON 4
ci_06                -2.270633e-02 3 1  ON 5
ci_07                 2.695067e-02 3 1  ON 6
ci_08                -6.328148e-03 3 1  ON 7
ci_09                -9.214885e-03 3 1  ON 8
ci_10                -9.224356e-03 3 1  ON 9
ci_11                 1.300633e-02 3 1  ON 10
ci_12                 7.612697e-03 3 1  ON 11
ci_13                 1.265633e-02 3 1  ON 12
ci_14                 1.312706e-02 3 1  ON 13
ci_15                 7.045605e-03 3 1  ON 14
ci_16                 7.289793e-03 3 1  ON 15
ci_17                -7.459121e-03 3 1  ON 16
ci_18                -7.159058e-03 3 1  ON 17
ci_19                 9.301894e-03 3 1  ON 18
ci_20                 6.816173e-03 3 1  ON 19
ci_21                 8.770467e-03 3 1  ON 20
ci_22                 8.769205e-03 3 1  ON 21
ci_23                 4.976592e-03 3 1  ON 22
ci_24                 4.393919e-03 3 1  ON 23
ci_25                 3.106672e-03 3 1  ON 24
ci_26                 3.142255e-03 3 1  ON 25
ci_27                 3.320523e-03 3 1  ON 26
ci_28                 2.492223e-03 3 1  ON 27
ci_29                 2.133763e-03 3 1  ON 28
ci_30                -1.575381e-03 3 1  ON 29
ci_31                -1.612773e-03 3 1  ON 30
ci_32                -1.316252e-03 3 1  ON 31
ci_33                -1.027543e-03 3 1  ON 32
ci_34                 1.457634e-03 3 1  ON 33
ci_35                 1.223166e-03 3 1  ON 34
ci_36                -1.106112e-03 3 1  ON 35
ci_37                -1.121929e-03 3 1  ON 36
ci_38                -5.327527e-04 3 1  ON 37
ci_39                -6.405552e-04 3 1  ON 38
ci_40                -1.671217e-03 3 1  ON 39
ci_41                -1.415108e-03 3 1  ON 40
ci_42                -1.207282e-03 3 1  ON 41
ci_43                -2.707872e-03 3 1  ON 42
ci_44                -1.768707e-03 3 1  ON 43
ci_45                -6.230868e-04 3 1  ON 44
ci_46                -5.370572e-04 3 1  ON 45
ci_47                 1.313321e-03 3 1  ON 46
ci_48                 8.805600e-04 3 1  ON 47
ci_49                -9.555041e-04 3 1  ON 48
ci_50                -7.407086e-04 3 1  ON 49
ci_51                 3.587231e-04 3 1  ON 50
ci_52                 3.760200e-04 3 1  ON 51
ci_53                -6.487334e-04 3 1  ON 52
ci_54                -9.072880e-04 3 1  ON 53
ci_55                -6.706709e-04 3 1  ON 54
ci_56                 1.879458e-03 3 1  ON 55
ci_57                 1.811116e-03 3 1  ON 56
ci_58                -8.253414e-04 3 1  ON 57
ci_59                -9.560685e-04 3 1  ON 58
ci_60                 6.324712e-04 3 1  ON 59
ci_61                 5.563752e-04 3 1  ON 60
ci_62                -2.974669e-04 3 1  ON 61
ci_63                -5.254896e-04 3 1  ON 62
ci_64                -4.059167e-04 3 1  ON 63
ci_65                -3.153006e-04 3 1  ON 64
ci_66                -6.876297e-04 3 1  ON 65
ci_67                -5.879542e-04 3 1  ON 66
ci_68                -6.694590e-04 3 1  ON 67
ci_69                -2.065632e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.7584
    reference variance = 0.417413
====================================================
  Execution time = 2.4419e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4819e-01
  Total weights = 1.9644e+06
  Execution time = 3.5090e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435495787850
                                         uncertainty =       0.002189973139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435495787850
                                         uncertainty =       0.002189973139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466603353
  error estimate for blocks of size 2^( 2) =       0.000492377012
  error estimate for blocks of size 2^( 3) =       0.000515742519
  error estimate for blocks of size 2^( 4) =       0.000532942103
  error estimate for blocks of size 2^( 5) =       0.000544787162
  error estimate for blocks of size 2^( 6) =       0.000549492574
  error estimate for blocks of size 2^( 7) =       0.000552803967

      target function =      -0.746845210172
              le_mean =     -22.815338252438
             les_mean =     520.987853492164
             stat err =       0.000545006451
             autocorr =       1.364292763070
   target nu stat err =       0.000545006451
   target dn stat err =       0.003082381062
      target stat err =       0.002632045460
              std dev =       0.659876790080
             le_variance =       0.435437378086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435493227746
                                         uncertainty =       0.002189861210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435493227746
                                         uncertainty =       0.002189861210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466601984
  error estimate for blocks of size 2^( 2) =       0.000492376022
  error estimate for blocks of size 2^( 3) =       0.000515741954
  error estimate for blocks of size 2^( 4) =       0.000532941820
  error estimate for blocks of size 2^( 5) =       0.000544786938
  error estimate for blocks of size 2^( 6) =       0.000549492455
  error estimate for blocks of size 2^( 7) =       0.000552803805

      target function =      -0.746844772996
              le_mean =     -22.815338158456
             les_mean =     520.987849737931
             stat err =       0.000545006254
             autocorr =       1.364299784588
   target nu stat err =       0.000545006254
   target dn stat err =       0.003081153890
      target stat err =       0.002631049763
              std dev =       0.659874853784
             le_variance =       0.435434822657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435494505817
                                         uncertainty =       0.002189917100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435494505817
                                         uncertainty =       0.002189917100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466602667
  error estimate for blocks of size 2^( 2) =       0.000492376516
  error estimate for blocks of size 2^( 3) =       0.000515742236
  error estimate for blocks of size 2^( 4) =       0.000532941961
  error estimate for blocks of size 2^( 5) =       0.000544787049
  error estimate for blocks of size 2^( 6) =       0.000549492514
  error estimate for blocks of size 2^( 7) =       0.000552803885

      target function =      -0.746846173210
              le_mean =     -22.815338205210
             les_mean =     520.987850182201
             stat err =       0.000545006352
             autocorr =       1.364296277342
   target nu stat err =       0.000545006352
   target dn stat err =       0.003081759364
      target stat err =       0.002631549154
              std dev =       0.659875820433
             le_variance =       0.435436098393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435495627471
                                         uncertainty =       0.002189966130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435495627471
                                         uncertainty =       0.002189966130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466603267
  error estimate for blocks of size 2^( 2) =       0.000492376950
  error estimate for blocks of size 2^( 3) =       0.000515742483
  error estimate for blocks of size 2^( 4) =       0.000532942085
  error estimate for blocks of size 2^( 5) =       0.000544787148
  error estimate for blocks of size 2^( 6) =       0.000549492566
  error estimate for blocks of size 2^( 7) =       0.000552803956

      target function =      -0.746845438142
              le_mean =     -22.815338246513
             les_mean =     520.987852947928
             stat err =       0.000545006439
             autocorr =       1.364293202505
   target nu stat err =       0.000545006439
   target dn stat err =       0.003082302816
      target stat err =       0.002631983729
              std dev =       0.659876668780
             le_variance =       0.435437218000


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746845210172        initial
     3.4694e+01     3.4694e+02             1.0185e-05        -0.746844772996
     1.3878e+02     1.3878e+03             2.5478e-06        -0.746846173210  <--
     5.5511e+02     5.5511e+03             6.3703e-07        -0.746845438142

*****************************************************************************
Applying the update for shift_i =   1.3878e+02     and shift_s =   1.3878e+03
*****************************************************************************

  Execution time = 4.2015e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_01                 1.310632e-01 3 1  ON 0
ci_02                -3.105421e-02 3 1  ON 1
ci_03                -3.095370e-02 3 1  ON 2
ci_04                 2.773768e-02 3 1  ON 3
ci_05                -2.302376e-02 3 1  ON 4
ci_06                -2.270633e-02 3 1  ON 5
ci_07                 2.695067e-02 3 1  ON 6
ci_08                -6.328148e-03 3 1  ON 7
ci_09                -9.214885e-03 3 1  ON 8
ci_10                -9.224356e-03 3 1  ON 9
ci_11                 1.300633e-02 3 1  ON 10
ci_12                 7.612697e-03 3 1  ON 11
ci_13                 1.265633e-02 3 1  ON 12
ci_14                 1.312706e-02 3 1  ON 13
ci_15                 7.045605e-03 3 1  ON 14
ci_16                 7.289793e-03 3 1  ON 15
ci_17                -7.459121e-03 3 1  ON 16
ci_18                -7.159058e-03 3 1  ON 17
ci_19                 9.301894e-03 3 1  ON 18
ci_20                 6.816173e-03 3 1  ON 19
ci_21                 8.770467e-03 3 1  ON 20
ci_22                 8.769205e-03 3 1  ON 21
ci_23                 4.976592e-03 3 1  ON 22
ci_24                 4.393919e-03 3 1  ON 23
ci_25                 3.106672e-03 3 1  ON 24
ci_26                 3.142255e-03 3 1  ON 25
ci_27                 3.320523e-03 3 1  ON 26
ci_28                 2.492223e-03 3 1  ON 27
ci_29                 2.133763e-03 3 1  ON 28
ci_30                -1.575381e-03 3 1  ON 29
ci_31                -1.612773e-03 3 1  ON 30
ci_32                -1.316252e-03 3 1  ON 31
ci_33                -1.027543e-03 3 1  ON 32
ci_34                 1.457634e-03 3 1  ON 33
ci_35                 1.223166e-03 3 1  ON 34
ci_36                -1.106112e-03 3 1  ON 35
ci_37                -1.121929e-03 3 1  ON 36
ci_38                -5.327527e-04 3 1  ON 37
ci_39                -6.405552e-04 3 1  ON 38
ci_40                -1.671217e-03 3 1  ON 39
ci_41                -1.415108e-03 3 1  ON 40
ci_42                -1.207282e-03 3 1  ON 41
ci_43                -2.707872e-03 3 1  ON 42
ci_44                -1.768707e-03 3 1  ON 43
ci_45                -6.230868e-04 3 1  ON 44
ci_46                -5.370572e-04 3 1  ON 45
ci_47                 1.313321e-03 3 1  ON 46
ci_48                 8.805600e-04 3 1  ON 47
ci_49                -9.555041e-04 3 1  ON 48
ci_50                -7.407086e-04 3 1  ON 49
ci_51                 3.587231e-04 3 1  ON 50
ci_52                 3.760200e-04 3 1  ON 51
ci_53                -6.487334e-04 3 1  ON 52
ci_54                -9.072880e-04 3 1  ON 53
ci_55                -6.706709e-04 3 1  ON 54
ci_56                 1.879458e-03 3 1  ON 55
ci_57                 1.811116e-03 3 1  ON 56
ci_58                -8.253414e-04 3 1  ON 57
ci_59                -9.560685e-04 3 1  ON 58
ci_60                 6.324712e-04 3 1  ON 59
ci_61                 5.563752e-04 3 1  ON 60
ci_62                -2.974669e-04 3 1  ON 61
ci_63                -5.254896e-04 3 1  ON 62
ci_64                -4.059167e-04 3 1  ON 63
ci_65                -3.153006e-04 3 1  ON 64
ci_66                -6.876297e-04 3 1  ON 65
ci_67                -5.879542e-04 3 1  ON 66
ci_68                -6.694590e-04 3 1  ON 67
ci_69                -2.065632e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1712e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.7971
    reference variance = 0.313157
====================================================
  Execution time = 2.7282e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5358e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4767e-01
  Total weights = 1.964304650e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435748325083
                                         uncertainty =       0.002021853444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435748325083
                                         uncertainty =       0.002021853444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466756200
  error estimate for blocks of size 2^( 2) =       0.000491867261
  error estimate for blocks of size 2^( 3) =       0.000515200512
  error estimate for blocks of size 2^( 4) =       0.000533064947
  error estimate for blocks of size 2^( 5) =       0.000543951589
  error estimate for blocks of size 2^( 6) =       0.000551037796
  error estimate for blocks of size 2^( 7) =       0.000552510377

      target function =      -0.747283157220
              le_mean =     -22.815739740510
             les_mean =     521.005651676825
             stat err =       0.000545141177
             autocorr =       1.364073539213
   target nu stat err =       0.000545141177
   target dn stat err =       0.002604949462
      target stat err =       0.002251783495
              std dev =       0.660092948495
             le_variance =       0.435722700653


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281573974051e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+01, overlap shift 3.4694e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747289006767       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747289600335       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747289687710       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747289712893       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747289720909       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747289723056       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747289724510       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747289724363       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747289724490       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747289724499       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+01 is 7.079477e-06

solving harmonic davidson linear method for identity shift 1.3878e+02, overlap shift 1.3878e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747289006767       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747289155318       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747289177177       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747289183475       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747289185477       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747289186013       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747289186376       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747289186340       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747289186371       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747289186373       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+02 is 1.770926e-06

solving harmonic davidson linear method for identity shift 5.5511e+02, overlap shift 5.5511e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747289006767       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747289043915       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747289049381       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747289050955       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747289051455       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747289051589       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747289051680       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747289051671       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747289051679       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747289051680       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+02 is 4.427975e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.407167 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1803e+01
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_01                 1.310615e-01 3 1  ON 0
ci_02                -3.105308e-02 3 1  ON 1
ci_03                -3.095311e-02 3 1  ON 2
ci_04                 2.773720e-02 3 1  ON 3
ci_05                -2.302243e-02 3 1  ON 4
ci_06                -2.270588e-02 3 1  ON 5
ci_07                 2.695035e-02 3 1  ON 6
ci_08                -6.327457e-03 3 1  ON 7
ci_09                -9.214804e-03 3 1  ON 8
ci_10                -9.224293e-03 3 1  ON 9
ci_11                 1.300638e-02 3 1  ON 10
ci_12                 7.611647e-03 3 1  ON 11
ci_13                 1.265608e-02 3 1  ON 12
ci_14                 1.312691e-02 3 1  ON 13
ci_15                 7.045099e-03 3 1  ON 14
ci_16                 7.289260e-03 3 1  ON 15
ci_17                -7.458865e-03 3 1  ON 16
ci_18                -7.158879e-03 3 1  ON 17
ci_19                 9.301845e-03 3 1  ON 18
ci_20                 6.815891e-03 3 1  ON 19
ci_21                 8.770600e-03 3 1  ON 20
ci_22                 8.768631e-03 3 1  ON 21
ci_23                 4.976742e-03 3 1  ON 22
ci_24                 4.394136e-03 3 1  ON 23
ci_25                 3.107152e-03 3 1  ON 24
ci_26                 3.141620e-03 3 1  ON 25
ci_27                 3.320457e-03 3 1  ON 26
ci_28                 2.492609e-03 3 1  ON 27
ci_29                 2.133645e-03 3 1  ON 28
ci_30                -1.575968e-03 3 1  ON 29
ci_31                -1.612677e-03 3 1  ON 30
ci_32                -1.316086e-03 3 1  ON 31
ci_33                -1.027364e-03 3 1  ON 32
ci_34                 1.458185e-03 3 1  ON 33
ci_35                 1.222897e-03 3 1  ON 34
ci_36                -1.106049e-03 3 1  ON 35
ci_37                -1.121883e-03 3 1  ON 36
ci_38                -5.324295e-04 3 1  ON 37
ci_39                -6.401083e-04 3 1  ON 38
ci_40                -1.671353e-03 3 1  ON 39
ci_41                -1.414586e-03 3 1  ON 40
ci_42                -1.207314e-03 3 1  ON 41
ci_43                -2.707926e-03 3 1  ON 42
ci_44                -1.768855e-03 3 1  ON 43
ci_45                -6.230115e-04 3 1  ON 44
ci_46                -5.366561e-04 3 1  ON 45
ci_47                 1.313762e-03 3 1  ON 46
ci_48                 8.802715e-04 3 1  ON 47
ci_49                -9.553401e-04 3 1  ON 48
ci_50                -7.405585e-04 3 1  ON 49
ci_51                 3.583531e-04 3 1  ON 50
ci_52                 3.758026e-04 3 1  ON 51
ci_53                -6.488362e-04 3 1  ON 52
ci_54                -9.073048e-04 3 1  ON 53
ci_55                -6.708384e-04 3 1  ON 54
ci_56                 1.879752e-03 3 1  ON 55
ci_57                 1.811287e-03 3 1  ON 56
ci_58                -8.254906e-04 3 1  ON 57
ci_59                -9.558310e-04 3 1  ON 58
ci_60                 6.325028e-04 3 1  ON 59
ci_61                 5.556336e-04 3 1  ON 60
ci_62                -2.975578e-04 3 1  ON 61
ci_63                -5.253334e-04 3 1  ON 62
ci_64                -4.061318e-04 3 1  ON 63
ci_65                -3.153202e-04 3 1  ON 64
ci_66                -6.875554e-04 3 1  ON 65
ci_67                -5.878930e-04 3 1  ON 66
ci_68                -6.695039e-04 3 1  ON 67
ci_69                -2.072328e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.7476
    reference variance = 0.411787
====================================================
  Execution time = 2.4444e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4604e-01
  Total weights = 1.9643e+06
  Execution time = 3.4907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432570655397
                                         uncertainty =       0.002033830859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432570655397
                                         uncertainty =       0.002033830859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465044096
  error estimate for blocks of size 2^( 2) =       0.000490215197
  error estimate for blocks of size 2^( 3) =       0.000513618680
  error estimate for blocks of size 2^( 4) =       0.000530562746
  error estimate for blocks of size 2^( 5) =       0.000540814882
  error estimate for blocks of size 2^( 6) =       0.000546580624
  error estimate for blocks of size 2^( 7) =       0.000548909665

      target function =      -0.748635095891
              le_mean =     -22.814623909466
             les_mean =     520.953105534578
             stat err =       0.000541716979
             autocorr =       1.356927445355
   target nu stat err =       0.000541716979
   target dn stat err =       0.002817574921
      target stat err =       0.002426199322
              std dev =       0.657671667008
             le_variance =       0.432532021585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432569003846
                                         uncertainty =       0.002033712928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432569003846
                                         uncertainty =       0.002033712928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465043209
  error estimate for blocks of size 2^( 2) =       0.000490214609
  error estimate for blocks of size 2^( 3) =       0.000513618313
  error estimate for blocks of size 2^( 4) =       0.000530562473
  error estimate for blocks of size 2^( 5) =       0.000540814774
  error estimate for blocks of size 2^( 6) =       0.000546580475
  error estimate for blocks of size 2^( 7) =       0.000548909692

      target function =      -0.748638789660
              le_mean =     -22.814623915604
             les_mean =     520.953101387352
             stat err =       0.000541716853
             autocorr =       1.356931988349
   target nu stat err =       0.000541716853
   target dn stat err =       0.002817344268
      target stat err =       0.002426036180
              std dev =       0.657670413276
             le_variance =       0.432530372498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432569828472
                                         uncertainty =       0.002033771858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432569828472
                                         uncertainty =       0.002033771858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465043652
  error estimate for blocks of size 2^( 2) =       0.000490214902
  error estimate for blocks of size 2^( 3) =       0.000513618496
  error estimate for blocks of size 2^( 4) =       0.000530562609
  error estimate for blocks of size 2^( 5) =       0.000540814828
  error estimate for blocks of size 2^( 6) =       0.000546580549
  error estimate for blocks of size 2^( 7) =       0.000548909678

      target function =      -0.748638954578
              le_mean =     -22.814623912471
             les_mean =     520.953101045961
             stat err =       0.000541716916
             autocorr =       1.356929719014
   target nu stat err =       0.000541716916
   target dn stat err =       0.002817439675
      target stat err =       0.002426114296
              std dev =       0.657671039270
             le_variance =       0.432531195894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432570551945
                                         uncertainty =       0.002033823480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432570551945
                                         uncertainty =       0.002033823480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465044040
  error estimate for blocks of size 2^( 2) =       0.000490215160
  error estimate for blocks of size 2^( 3) =       0.000513618657
  error estimate for blocks of size 2^( 4) =       0.000530562729
  error estimate for blocks of size 2^( 5) =       0.000540814875
  error estimate for blocks of size 2^( 6) =       0.000546580615
  error estimate for blocks of size 2^( 7) =       0.000548909667

      target function =      -0.748635716550
              le_mean =     -22.814623909835
             les_mean =     520.953104807357
             stat err =       0.000541716971
             autocorr =       1.356927729667
   target nu stat err =       0.000541716971
   target dn stat err =       0.002817556079
      target stat err =       0.002426187999
              std dev =       0.657671588475
             le_variance =       0.432531918287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748635095891        initial
     3.4694e+01     3.4694e+02             7.0795e-06        -0.748638789660
     1.3878e+02     1.3878e+03             1.7709e-06        -0.748638954578  <--
     5.5511e+02     5.5511e+03             4.4280e-07        -0.748635716550

*****************************************************************************
Applying the update for shift_i =   1.3878e+02     and shift_s =   1.3878e+03
*****************************************************************************

  Execution time = 4.1943e+01
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_01                 1.310615e-01 3 1  ON 0
ci_02                -3.105308e-02 3 1  ON 1
ci_03                -3.095311e-02 3 1  ON 2
ci_04                 2.773720e-02 3 1  ON 3
ci_05                -2.302243e-02 3 1  ON 4
ci_06                -2.270588e-02 3 1  ON 5
ci_07                 2.695035e-02 3 1  ON 6
ci_08                -6.327457e-03 3 1  ON 7
ci_09                -9.214804e-03 3 1  ON 8
ci_10                -9.224293e-03 3 1  ON 9
ci_11                 1.300638e-02 3 1  ON 10
ci_12                 7.611647e-03 3 1  ON 11
ci_13                 1.265608e-02 3 1  ON 12
ci_14                 1.312691e-02 3 1  ON 13
ci_15                 7.045099e-03 3 1  ON 14
ci_16                 7.289260e-03 3 1  ON 15
ci_17                -7.458865e-03 3 1  ON 16
ci_18                -7.158879e-03 3 1  ON 17
ci_19                 9.301845e-03 3 1  ON 18
ci_20                 6.815891e-03 3 1  ON 19
ci_21                 8.770600e-03 3 1  ON 20
ci_22                 8.768631e-03 3 1  ON 21
ci_23                 4.976742e-03 3 1  ON 22
ci_24                 4.394136e-03 3 1  ON 23
ci_25                 3.107152e-03 3 1  ON 24
ci_26                 3.141620e-03 3 1  ON 25
ci_27                 3.320457e-03 3 1  ON 26
ci_28                 2.492609e-03 3 1  ON 27
ci_29                 2.133645e-03 3 1  ON 28
ci_30                -1.575968e-03 3 1  ON 29
ci_31                -1.612677e-03 3 1  ON 30
ci_32                -1.316086e-03 3 1  ON 31
ci_33                -1.027364e-03 3 1  ON 32
ci_34                 1.458185e-03 3 1  ON 33
ci_35                 1.222897e-03 3 1  ON 34
ci_36                -1.106049e-03 3 1  ON 35
ci_37                -1.121883e-03 3 1  ON 36
ci_38                -5.324295e-04 3 1  ON 37
ci_39                -6.401083e-04 3 1  ON 38
ci_40                -1.671353e-03 3 1  ON 39
ci_41                -1.414586e-03 3 1  ON 40
ci_42                -1.207314e-03 3 1  ON 41
ci_43                -2.707926e-03 3 1  ON 42
ci_44                -1.768855e-03 3 1  ON 43
ci_45                -6.230115e-04 3 1  ON 44
ci_46                -5.366561e-04 3 1  ON 45
ci_47                 1.313762e-03 3 1  ON 46
ci_48                 8.802715e-04 3 1  ON 47
ci_49                -9.553401e-04 3 1  ON 48
ci_50                -7.405585e-04 3 1  ON 49
ci_51                 3.583531e-04 3 1  ON 50
ci_52                 3.758026e-04 3 1  ON 51
ci_53                -6.488362e-04 3 1  ON 52
ci_54                -9.073048e-04 3 1  ON 53
ci_55                -6.708384e-04 3 1  ON 54
ci_56                 1.879752e-03 3 1  ON 55
ci_57                 1.811287e-03 3 1  ON 56
ci_58                -8.254906e-04 3 1  ON 57
ci_59                -9.558310e-04 3 1  ON 58
ci_60                 6.325028e-04 3 1  ON 59
ci_61                 5.556336e-04 3 1  ON 60
ci_62                -2.975578e-04 3 1  ON 61
ci_63                -5.253334e-04 3 1  ON 62
ci_64                -4.061318e-04 3 1  ON 63
ci_65                -3.153202e-04 3 1  ON 64
ci_66                -6.875554e-04 3 1  ON 65
ci_67                -5.878930e-04 3 1  ON 66
ci_68                -6.695039e-04 3 1  ON 67
ci_69                -2.072328e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3751e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.8348
    reference variance = 0.446783
====================================================
  Execution time = 2.5100e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5362e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4666e-01
  Total weights = 1.964192751e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435452540989
                                         uncertainty =       0.002503126595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435452540989
                                         uncertainty =       0.002503126595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466642530
  error estimate for blocks of size 2^( 2) =       0.000491728268
  error estimate for blocks of size 2^( 3) =       0.000515333428
  error estimate for blocks of size 2^( 4) =       0.000533374863
  error estimate for blocks of size 2^( 5) =       0.000543797851
  error estimate for blocks of size 2^( 6) =       0.000549867648
  error estimate for blocks of size 2^( 7) =       0.000553152396

      target function =      -0.748114156593
              le_mean =     -22.813889155402
             les_mean =     520.920199833158
             stat err =       0.000545048189
             autocorr =       1.364272629358
   target nu stat err =       0.000545048189
   target dn stat err =       0.002678812349
      target stat err =       0.002309616608
              std dev =       0.659932194990
             le_variance =       0.435510501984


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281388915540e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+01, overlap shift 3.4694e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748120286595       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748120767793       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748120900332       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748120930630       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748120943382       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748120944464       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748120943665       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748120943846       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748120943513       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748120943527       residual = 1.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+01 is 1.269645e-05

solving harmonic davidson linear method for identity shift 1.3878e+02, overlap shift 1.3878e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748120286595       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748120407025       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748120440181       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748120447755       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748120450941       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748120451210       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748120451010       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748120451056       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748120450972       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748120450976       residual = 1.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+02 is 3.175896e-06

solving harmonic davidson linear method for identity shift 5.5511e+02, overlap shift 5.5511e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748120286595       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748120316711       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748120325001       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748120326895       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748120327691       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748120327758       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748120327708       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748120327720       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748120327700       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748120327700       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+02 is 7.940856e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.410638 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9601e+01
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_01                 1.310583e-01 3 1  ON 0
ci_02                -3.105242e-02 3 1  ON 1
ci_03                -3.095189e-02 3 1  ON 2
ci_04                 2.773606e-02 3 1  ON 3
ci_05                -2.302175e-02 3 1  ON 4
ci_06                -2.270515e-02 3 1  ON 5
ci_07                 2.694984e-02 3 1  ON 6
ci_08                -6.326974e-03 3 1  ON 7
ci_09                -9.214540e-03 3 1  ON 8
ci_10                -9.223756e-03 3 1  ON 9
ci_11                 1.300660e-02 3 1  ON 10
ci_12                 7.611737e-03 3 1  ON 11
ci_13                 1.265582e-02 3 1  ON 12
ci_14                 1.312676e-02 3 1  ON 13
ci_15                 7.045043e-03 3 1  ON 14
ci_16                 7.289306e-03 3 1  ON 15
ci_17                -7.458675e-03 3 1  ON 16
ci_18                -7.158107e-03 3 1  ON 17
ci_19                 9.301964e-03 3 1  ON 18
ci_20                 6.815910e-03 3 1  ON 19
ci_21                 8.770602e-03 3 1  ON 20
ci_22                 8.768586e-03 3 1  ON 21
ci_23                 4.976664e-03 3 1  ON 22
ci_24                 4.393762e-03 3 1  ON 23
ci_25                 3.106788e-03 3 1  ON 24
ci_26                 3.141612e-03 3 1  ON 25
ci_27                 3.320359e-03 3 1  ON 26
ci_28                 2.492642e-03 3 1  ON 27
ci_29                 2.133546e-03 3 1  ON 28
ci_30                -1.575918e-03 3 1  ON 29
ci_31                -1.612680e-03 3 1  ON 30
ci_32                -1.316036e-03 3 1  ON 31
ci_33                -1.027306e-03 3 1  ON 32
ci_34                 1.458632e-03 3 1  ON 33
ci_35                 1.222980e-03 3 1  ON 34
ci_36                -1.105867e-03 3 1  ON 35
ci_37                -1.121616e-03 3 1  ON 36
ci_38                -5.321974e-04 3 1  ON 37
ci_39                -6.401993e-04 3 1  ON 38
ci_40                -1.671234e-03 3 1  ON 39
ci_41                -1.414679e-03 3 1  ON 40
ci_42                -1.206928e-03 3 1  ON 41
ci_43                -2.708044e-03 3 1  ON 42
ci_44                -1.768619e-03 3 1  ON 43
ci_45                -6.230705e-04 3 1  ON 44
ci_46                -5.362899e-04 3 1  ON 45
ci_47                 1.313922e-03 3 1  ON 46
ci_48                 8.803986e-04 3 1  ON 47
ci_49                -9.551813e-04 3 1  ON 48
ci_50                -7.406135e-04 3 1  ON 49
ci_51                 3.582735e-04 3 1  ON 50
ci_52                 3.759512e-04 3 1  ON 51
ci_53                -6.489901e-04 3 1  ON 52
ci_54                -9.073377e-04 3 1  ON 53
ci_55                -6.705647e-04 3 1  ON 54
ci_56                 1.879794e-03 3 1  ON 55
ci_57                 1.811478e-03 3 1  ON 56
ci_58                -8.252373e-04 3 1  ON 57
ci_59                -9.557543e-04 3 1  ON 58
ci_60                 6.328856e-04 3 1  ON 59
ci_61                 5.552042e-04 3 1  ON 60
ci_62                -2.973428e-04 3 1  ON 61
ci_63                -5.250309e-04 3 1  ON 62
ci_64                -4.061100e-04 3 1  ON 63
ci_65                -3.151242e-04 3 1  ON 64
ci_66                -6.876545e-04 3 1  ON 65
ci_67                -5.880781e-04 3 1  ON 66
ci_68                -6.697616e-04 3 1  ON 67
ci_69                -2.075535e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.8232
    reference variance = 0.393305
====================================================
  Execution time = 2.4509e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4840e-01
  Total weights = 1.9639e+06
  Execution time = 3.5071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436174864956
                                         uncertainty =       0.002080877060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436174864956
                                         uncertainty =       0.002080877060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466962495
  error estimate for blocks of size 2^( 2) =       0.000491945401
  error estimate for blocks of size 2^( 3) =       0.000515252446
  error estimate for blocks of size 2^( 4) =       0.000532280570
  error estimate for blocks of size 2^( 5) =       0.000544767660
  error estimate for blocks of size 2^( 6) =       0.000551771354
  error estimate for blocks of size 2^( 7) =       0.000556584903

      target function =      -0.746669957958
              le_mean =     -22.814076817314
             les_mean =     520.930503819608
             stat err =       0.000546351122
             autocorr =       1.368925068285
   target nu stat err =       0.000546351122
   target dn stat err =       0.002494434532
      target stat err =       0.002154967472
              std dev =       0.660384693597
             le_variance =       0.436107943537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436173371656
                                         uncertainty =       0.002080810047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436173371656
                                         uncertainty =       0.002080810047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466961699
  error estimate for blocks of size 2^( 2) =       0.000491944973
  error estimate for blocks of size 2^( 3) =       0.000515252349
  error estimate for blocks of size 2^( 4) =       0.000532280749
  error estimate for blocks of size 2^( 5) =       0.000544767931
  error estimate for blocks of size 2^( 6) =       0.000551771760
  error estimate for blocks of size 2^( 7) =       0.000556585504

      target function =      -0.746670614798
              le_mean =     -22.814076783009
             les_mean =     520.930501460809
             stat err =       0.000546351486
             autocorr =       1.368931564769
   target nu stat err =       0.000546351486
   target dn stat err =       0.002494616006
      target stat err =       0.002155115475
              std dev =       0.660383567177
             le_variance =       0.436106455797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436174117019
                                         uncertainty =       0.002080843505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436174117019
                                         uncertainty =       0.002080843505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466962096
  error estimate for blocks of size 2^( 2) =       0.000491945186
  error estimate for blocks of size 2^( 3) =       0.000515252397
  error estimate for blocks of size 2^( 4) =       0.000532280660
  error estimate for blocks of size 2^( 5) =       0.000544767795
  error estimate for blocks of size 2^( 6) =       0.000551771557
  error estimate for blocks of size 2^( 7) =       0.000556585203

      target function =      -0.746670327658
              le_mean =     -22.814076800052
             les_mean =     520.930502585423
             stat err =       0.000546351304
             autocorr =       1.368928319868
   target nu stat err =       0.000546351304
   target dn stat err =       0.002494524595
      target stat err =       0.002155041166
              std dev =       0.660384129415
             le_variance =       0.436107198383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436174771373
                                         uncertainty =       0.002080872862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436174771373
                                         uncertainty =       0.002080872862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466962445
  error estimate for blocks of size 2^( 2) =       0.000491945374
  error estimate for blocks of size 2^( 3) =       0.000515252439
  error estimate for blocks of size 2^( 4) =       0.000532280582
  error estimate for blocks of size 2^( 5) =       0.000544767677
  error estimate for blocks of size 2^( 6) =       0.000551771379
  error estimate for blocks of size 2^( 7) =       0.000556584940

      target function =      -0.746670008724
              le_mean =     -22.814076815145
             les_mean =     520.930503659361
             stat err =       0.000546351144
             autocorr =       1.368925474869
   target nu stat err =       0.000546351144
   target dn stat err =       0.002494445726
      target stat err =       0.002154976658
              std dev =       0.660384623006
             le_variance =       0.436107850303


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746669957958        initial
     3.4694e+01     3.4694e+02             1.2696e-05        -0.746670614798  <--
     1.3878e+02     1.3878e+03             3.1759e-06        -0.746670327658
     5.5511e+02     5.5511e+03             7.9409e-07        -0.746670008724

*****************************************************************************
Applying the update for shift_i =   3.4694e+01     and shift_s =   3.4694e+02
*****************************************************************************

  Execution time = 4.2081e+01
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_01                 1.310488e-01 3 1  ON 0
ci_02                -3.105045e-02 3 1  ON 1
ci_03                -3.094824e-02 3 1  ON 2
ci_04                 2.773265e-02 3 1  ON 3
ci_05                -2.301974e-02 3 1  ON 4
ci_06                -2.270295e-02 3 1  ON 5
ci_07                 2.694833e-02 3 1  ON 6
ci_08                -6.325526e-03 3 1  ON 7
ci_09                -9.213748e-03 3 1  ON 8
ci_10                -9.222148e-03 3 1  ON 9
ci_11                 1.300728e-02 3 1  ON 10
ci_12                 7.612006e-03 3 1  ON 11
ci_13                 1.265505e-02 3 1  ON 12
ci_14                 1.312630e-02 3 1  ON 13
ci_15                 7.044873e-03 3 1  ON 14
ci_16                 7.289444e-03 3 1  ON 15
ci_17                -7.458108e-03 3 1  ON 16
ci_18                -7.155795e-03 3 1  ON 17
ci_19                 9.302320e-03 3 1  ON 18
ci_20                 6.815968e-03 3 1  ON 19
ci_21                 8.770609e-03 3 1  ON 20
ci_22                 8.768451e-03 3 1  ON 21
ci_23                 4.976430e-03 3 1  ON 22
ci_24                 4.392641e-03 3 1  ON 23
ci_25                 3.105699e-03 3 1  ON 24
ci_26                 3.141588e-03 3 1  ON 25
ci_27                 3.320066e-03 3 1  ON 26
ci_28                 2.492741e-03 3 1  ON 27
ci_29                 2.133250e-03 3 1  ON 28
ci_30                -1.575767e-03 3 1  ON 29
ci_31                -1.612689e-03 3 1  ON 30
ci_32                -1.315886e-03 3 1  ON 31
ci_33                -1.027130e-03 3 1  ON 32
ci_34                 1.459972e-03 3 1  ON 33
ci_35                 1.223228e-03 3 1  ON 34
ci_36                -1.105322e-03 3 1  ON 35
ci_37                -1.120816e-03 3 1  ON 36
ci_38                -5.315021e-04 3 1  ON 37
ci_39                -6.404718e-04 3 1  ON 38
ci_40                -1.670877e-03 3 1  ON 39
ci_41                -1.414960e-03 3 1  ON 40
ci_42                -1.205770e-03 3 1  ON 41
ci_43                -2.708399e-03 3 1  ON 42
ci_44                -1.767912e-03 3 1  ON 43
ci_45                -6.232474e-04 3 1  ON 44
ci_46                -5.351928e-04 3 1  ON 45
ci_47                 1.314404e-03 3 1  ON 46
ci_48                 8.807796e-04 3 1  ON 47
ci_49                -9.547056e-04 3 1  ON 48
ci_50                -7.407782e-04 3 1  ON 49
ci_51                 3.580350e-04 3 1  ON 50
ci_52                 3.763965e-04 3 1  ON 51
ci_53                -6.494512e-04 3 1  ON 52
ci_54                -9.074364e-04 3 1  ON 53
ci_55                -6.697448e-04 3 1  ON 54
ci_56                 1.879920e-03 3 1  ON 55
ci_57                 1.812048e-03 3 1  ON 56
ci_58                -8.244782e-04 3 1  ON 57
ci_59                -9.555243e-04 3 1  ON 58
ci_60                 6.340334e-04 3 1  ON 59
ci_61                 5.539166e-04 3 1  ON 60
ci_62                -2.966985e-04 3 1  ON 61
ci_63                -5.241250e-04 3 1  ON 62
ci_64                -4.060446e-04 3 1  ON 63
ci_65                -3.145368e-04 3 1  ON 64
ci_66                -6.879516e-04 3 1  ON 65
ci_67                -5.886324e-04 3 1  ON 66
ci_68                -6.705338e-04 3 1  ON 67
ci_69                -2.085142e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1687e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.8391
    reference variance = 0.391153
====================================================
  Execution time = 2.5273e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5664e-01
  Total weights = 1.964199728e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5473e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435768506623
                                         uncertainty =       0.003390893912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435768506623
                                         uncertainty =       0.003390893912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466745774
  error estimate for blocks of size 2^( 2) =       0.000492222972
  error estimate for blocks of size 2^( 3) =       0.000515852749
  error estimate for blocks of size 2^( 4) =       0.000533351711
  error estimate for blocks of size 2^( 5) =       0.000544301783
  error estimate for blocks of size 2^( 6) =       0.000550942424
  error estimate for blocks of size 2^( 7) =       0.000553692684

      target function =      -0.739779026241
              le_mean =     -22.815696526806
             les_mean =     521.012650789212
             stat err =       0.000545572150
             autocorr =       1.366292224383
   target nu stat err =       0.000545572150
   target dn stat err =       0.011389288568
      target stat err =       0.009311259369
              std dev =       0.660078204030
             le_variance =       0.435703235436


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281569652681e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+00, overlap shift 8.6736e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739895686095       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739898148634       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739898440187       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739898482602       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739898500811       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739898502905       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739898501624       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739898500869       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739898501004       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739898500850       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+00 is 3.416780e-05

solving harmonic davidson linear method for identity shift 3.4694e+01, overlap shift 3.4694e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739895686095       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739896304283       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739896377329       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739896387938       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739896392491       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739896393007       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739896392685       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739896392497       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739896392531       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739896392492       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+01 is 8.573800e-06

solving harmonic davidson linear method for identity shift 1.3878e+02, overlap shift 1.3878e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739895686095       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739895840802       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739895859074       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739895861726       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739895862864       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739895862993       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739895862912       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739895862865       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739895862874       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739895862864       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+02 is 2.145450e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.414156 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9829e+01
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_01                 1.310458e-01 3 1  ON 0
ci_02                -3.104756e-02 3 1  ON 1
ci_03                -3.094252e-02 3 1  ON 2
ci_04                 2.772762e-02 3 1  ON 3
ci_05                -2.301117e-02 3 1  ON 4
ci_06                -2.270516e-02 3 1  ON 5
ci_07                 2.694821e-02 3 1  ON 6
ci_08                -6.325699e-03 3 1  ON 7
ci_09                -9.211796e-03 3 1  ON 8
ci_10                -9.222156e-03 3 1  ON 9
ci_11                 1.300648e-02 3 1  ON 10
ci_12                 7.609966e-03 3 1  ON 11
ci_13                 1.265498e-02 3 1  ON 12
ci_14                 1.312482e-02 3 1  ON 13
ci_15                 7.045969e-03 3 1  ON 14
ci_16                 7.290526e-03 3 1  ON 15
ci_17                -7.457144e-03 3 1  ON 16
ci_18                -7.153687e-03 3 1  ON 17
ci_19                 9.301912e-03 3 1  ON 18
ci_20                 6.815695e-03 3 1  ON 19
ci_21                 8.771724e-03 3 1  ON 20
ci_22                 8.770652e-03 3 1  ON 21
ci_23                 4.975978e-03 3 1  ON 22
ci_24                 4.391739e-03 3 1  ON 23
ci_25                 3.105108e-03 3 1  ON 24
ci_26                 3.139480e-03 3 1  ON 25
ci_27                 3.319596e-03 3 1  ON 26
ci_28                 2.492233e-03 3 1  ON 27
ci_29                 2.133298e-03 3 1  ON 28
ci_30                -1.575588e-03 3 1  ON 29
ci_31                -1.612638e-03 3 1  ON 30
ci_32                -1.315117e-03 3 1  ON 31
ci_33                -1.027384e-03 3 1  ON 32
ci_34                 1.456625e-03 3 1  ON 33
ci_35                 1.223166e-03 3 1  ON 34
ci_36                -1.106106e-03 3 1  ON 35
ci_37                -1.121622e-03 3 1  ON 36
ci_38                -5.312741e-04 3 1  ON 37
ci_39                -6.395620e-04 3 1  ON 38
ci_40                -1.671493e-03 3 1  ON 39
ci_41                -1.417544e-03 3 1  ON 40
ci_42                -1.205757e-03 3 1  ON 41
ci_43                -2.705468e-03 3 1  ON 42
ci_44                -1.769030e-03 3 1  ON 43
ci_45                -6.235542e-04 3 1  ON 44
ci_46                -5.354113e-04 3 1  ON 45
ci_47                 1.314197e-03 3 1  ON 46
ci_48                 8.822319e-04 3 1  ON 47
ci_49                -9.550684e-04 3 1  ON 48
ci_50                -7.408348e-04 3 1  ON 49
ci_51                 3.582581e-04 3 1  ON 50
ci_52                 3.760634e-04 3 1  ON 51
ci_53                -6.489418e-04 3 1  ON 52
ci_54                -9.066377e-04 3 1  ON 53
ci_55                -6.693994e-04 3 1  ON 54
ci_56                 1.879120e-03 3 1  ON 55
ci_57                 1.811693e-03 3 1  ON 56
ci_58                -8.255913e-04 3 1  ON 57
ci_59                -9.556568e-04 3 1  ON 58
ci_60                 6.334184e-04 3 1  ON 59
ci_61                 5.527652e-04 3 1  ON 60
ci_62                -2.964857e-04 3 1  ON 61
ci_63                -5.230057e-04 3 1  ON 62
ci_64                -4.039806e-04 3 1  ON 63
ci_65                -3.149635e-04 3 1  ON 64
ci_66                -6.875433e-04 3 1  ON 65
ci_67                -5.903707e-04 3 1  ON 66
ci_68                -6.708189e-04 3 1  ON 67
ci_69                -2.098428e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.7746
    reference variance = 0.375501
====================================================
  Execution time = 2.4358e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4544e-01
  Total weights = 1.9641e+06
  Execution time = 3.5002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433506589225
                                         uncertainty =       0.002346906217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433506589225
                                         uncertainty =       0.002346906217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465531549
  error estimate for blocks of size 2^( 2) =       0.000490559235
  error estimate for blocks of size 2^( 3) =       0.000514241970
  error estimate for blocks of size 2^( 4) =       0.000531841940
  error estimate for blocks of size 2^( 5) =       0.000543613339
  error estimate for blocks of size 2^( 6) =       0.000550691726
  error estimate for blocks of size 2^( 7) =       0.000553764575

      target function =      -0.749131779287
              le_mean =     -22.815263531026
             les_mean =     520.981700833818
             stat err =       0.000544977895
             autocorr =       1.370438458447
   target nu stat err =       0.000544977895
   target dn stat err =       0.002937531329
      target stat err =       0.002529759675
              std dev =       0.658361029997
             le_variance =       0.433439245819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433502770302
                                         uncertainty =       0.002346919515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433502770302
                                         uncertainty =       0.002346919515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465529514
  error estimate for blocks of size 2^( 2) =       0.000490558402
  error estimate for blocks of size 2^( 3) =       0.000514242221
  error estimate for blocks of size 2^( 4) =       0.000531842838
  error estimate for blocks of size 2^( 5) =       0.000543614752
  error estimate for blocks of size 2^( 6) =       0.000550693683
  error estimate for blocks of size 2^( 7) =       0.000553767125

      target function =      -0.749146469726
              le_mean =     -22.815263532836
             les_mean =     520.981683354815
             stat err =       0.000544979599
             autocorr =       1.370459010000
   target nu stat err =       0.000544979599
   target dn stat err =       0.002935687487
      target stat err =       0.002528360292
              std dev =       0.658358152507
             le_variance =       0.433435456972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433504661521
                                         uncertainty =       0.002346912560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433504661521
                                         uncertainty =       0.002346912560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465530522
  error estimate for blocks of size 2^( 2) =       0.000490558811
  error estimate for blocks of size 2^( 3) =       0.000514242090
  error estimate for blocks of size 2^( 4) =       0.000531842385
  error estimate for blocks of size 2^( 5) =       0.000543614042
  error estimate for blocks of size 2^( 6) =       0.000550692701
  error estimate for blocks of size 2^( 7) =       0.000553765848

      target function =      -0.749145248607
              le_mean =     -22.815263530239
             les_mean =     520.981684691202
             stat err =       0.000544978744
             autocorr =       1.370448775645
   target nu stat err =       0.000544978744
   target dn stat err =       0.002936587249
      target stat err =       0.002529082158
              std dev =       0.658359577457
             le_variance =       0.433437333229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433506346909
                                         uncertainty =       0.002346906990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433506346909
                                         uncertainty =       0.002346906990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465531420
  error estimate for blocks of size 2^( 2) =       0.000490559181
  error estimate for blocks of size 2^( 3) =       0.000514241984
  error estimate for blocks of size 2^( 4) =       0.000531841995
  error estimate for blocks of size 2^( 5) =       0.000543613425
  error estimate for blocks of size 2^( 6) =       0.000550691846
  error estimate for blocks of size 2^( 7) =       0.000553764732

      target function =      -0.749139575598
              le_mean =     -22.815263530626
             les_mean =     520.981691489906
             stat err =       0.000544978000
             autocorr =       1.370439745183
   target nu stat err =       0.000544978000
   target dn stat err =       0.002937401037
      target stat err =       0.002529705109
              std dev =       0.658360847405
             le_variance =       0.433439005396


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749131779287        initial
     8.6736e+00     8.6736e+01             3.4168e-05        -0.749146469726  <--
     3.4694e+01     3.4694e+02             8.5738e-06        -0.749145248607
     1.3878e+02     1.3878e+03             2.1454e-06        -0.749139575598

*****************************************************************************
Applying the update for shift_i =   8.6736e+00     and shift_s =   8.6736e+01
*****************************************************************************

  Execution time = 4.1897e+01
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_01                 1.310369e-01 3 1  ON 0
ci_02                -3.103893e-02 3 1  ON 1
ci_03                -3.092547e-02 3 1  ON 2
ci_04                 2.771262e-02 3 1  ON 3
ci_05                -2.298557e-02 3 1  ON 4
ci_06                -2.271177e-02 3 1  ON 5
ci_07                 2.694784e-02 3 1  ON 6
ci_08                -6.326213e-03 3 1  ON 7
ci_09                -9.205965e-03 3 1  ON 8
ci_10                -9.222177e-03 3 1  ON 9
ci_11                 1.300411e-02 3 1  ON 10
ci_12                 7.603880e-03 3 1  ON 11
ci_13                 1.265479e-02 3 1  ON 12
ci_14                 1.312040e-02 3 1  ON 13
ci_15                 7.049241e-03 3 1  ON 14
ci_16                 7.293759e-03 3 1  ON 15
ci_17                -7.454262e-03 3 1  ON 16
ci_18                -7.147396e-03 3 1  ON 17
ci_19                 9.300696e-03 3 1  ON 18
ci_20                 6.814882e-03 3 1  ON 19
ci_21                 8.775051e-03 3 1  ON 20
ci_22                 8.777237e-03 3 1  ON 21
ci_23                 4.974630e-03 3 1  ON 22
ci_24                 4.389042e-03 3 1  ON 23
ci_25                 3.103347e-03 3 1  ON 24
ci_26                 3.133184e-03 3 1  ON 25
ci_27                 3.318192e-03 3 1  ON 26
ci_28                 2.490715e-03 3 1  ON 27
ci_29                 2.133441e-03 3 1  ON 28
ci_30                -1.575054e-03 3 1  ON 29
ci_31                -1.612487e-03 3 1  ON 30
ci_32                -1.312822e-03 3 1  ON 31
ci_33                -1.028143e-03 3 1  ON 32
ci_34                 1.446635e-03 3 1  ON 33
ci_35                 1.222979e-03 3 1  ON 34
ci_36                -1.108445e-03 3 1  ON 35
ci_37                -1.124024e-03 3 1  ON 36
ci_38                -5.305943e-04 3 1  ON 37
ci_39                -6.368469e-04 3 1  ON 38
ci_40                -1.673329e-03 3 1  ON 39
ci_41                -1.425254e-03 3 1  ON 40
ci_42                -1.205720e-03 3 1  ON 41
ci_43                -2.696718e-03 3 1  ON 42
ci_44                -1.772370e-03 3 1  ON 43
ci_45                -6.244684e-04 3 1  ON 44
ci_46                -5.360627e-04 3 1  ON 45
ci_47                 1.313577e-03 3 1  ON 46
ci_48                 8.865748e-04 3 1  ON 47
ci_49                -9.561517e-04 3 1  ON 48
ci_50                -7.410030e-04 3 1  ON 49
ci_51                 3.589236e-04 3 1  ON 50
ci_52                 3.750695e-04 3 1  ON 51
ci_53                -6.474227e-04 3 1  ON 52
ci_54                -9.042533e-04 3 1  ON 53
ci_55                -6.683667e-04 3 1  ON 54
ci_56                 1.876731e-03 3 1  ON 55
ci_57                 1.810635e-03 3 1  ON 56
ci_58                -8.289129e-04 3 1  ON 57
ci_59                -9.560517e-04 3 1  ON 58
ci_60                 6.315792e-04 3 1  ON 59
ci_61                 5.493185e-04 3 1  ON 60
ci_62                -2.958506e-04 3 1  ON 61
ci_63                -5.196683e-04 3 1  ON 62
ci_64                -3.978235e-04 3 1  ON 63
ci_65                -3.162379e-04 3 1  ON 64
ci_66                -6.863244e-04 3 1  ON 65
ci_67                -5.955568e-04 3 1  ON 66
ci_68                -6.716693e-04 3 1  ON 67
ci_69                -2.138100e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1748e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.8355
    reference variance = 0.475836
====================================================
  Execution time = 2.5130e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5323e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5145e-01
  Total weights = 1.964413671e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5234e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438900988132
                                         uncertainty =       0.002489532587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438900988132
                                         uncertainty =       0.002489532587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468426455
  error estimate for blocks of size 2^( 2) =       0.000493719200
  error estimate for blocks of size 2^( 3) =       0.000517692863
  error estimate for blocks of size 2^( 4) =       0.000535065733
  error estimate for blocks of size 2^( 5) =       0.000546893533
  error estimate for blocks of size 2^( 6) =       0.000553304398
  error estimate for blocks of size 2^( 7) =       0.000557445537

      target function =      -0.744148562906
              le_mean =     -22.814952184068
             les_mean =     520.973493172032
             stat err =       0.000548177300
             autocorr =       1.369491266703
   target nu stat err =       0.000548177300
   target dn stat err =       0.003270735179
      target stat err =       0.002764166275
              std dev =       0.662455044976
             le_variance =       0.438846686614


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281495218407e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+00, overlap shift 2.1684e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744157972243       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744166557579       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744167803089       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744168039292       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744168088104       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744168110546       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744168094890       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744168091574       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744168091122       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+00 is 9.737400e-05

solving harmonic davidson linear method for identity shift 8.6736e+00, overlap shift 8.6736e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744157972243       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744160155077       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744160469336       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744160528631       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744160540676       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744160546166       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744160542246       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744160541432       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744160541321       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+00 is 2.457195e-05

solving harmonic davidson linear method for identity shift 3.4694e+01, overlap shift 3.4694e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744157972243       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744158520281       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744158599027       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744158613866       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744158616867       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744158618232       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744158617251       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744158617049       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744158617021       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+01 is 6.157449e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.417201 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9662e+01
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_01                 1.310124e-01 3 1  ON 0
ci_02                -3.101758e-02 3 1  ON 1
ci_03                -3.090914e-02 3 1  ON 2
ci_04                 2.769761e-02 3 1  ON 3
ci_05                -2.297058e-02 3 1  ON 4
ci_06                -2.270583e-02 3 1  ON 5
ci_07                 2.694886e-02 3 1  ON 6
ci_08                -6.321071e-03 3 1  ON 7
ci_09                -9.205955e-03 3 1  ON 8
ci_10                -9.224231e-03 3 1  ON 9
ci_11                 1.300374e-02 3 1  ON 10
ci_12                 7.600112e-03 3 1  ON 11
ci_13                 1.265668e-02 3 1  ON 12
ci_14                 1.312188e-02 3 1  ON 13
ci_15                 7.049823e-03 3 1  ON 14
ci_16                 7.295277e-03 3 1  ON 15
ci_17                -7.444389e-03 3 1  ON 16
ci_18                -7.142390e-03 3 1  ON 17
ci_19                 9.302862e-03 3 1  ON 18
ci_20                 6.818704e-03 3 1  ON 19
ci_21                 8.778597e-03 3 1  ON 20
ci_22                 8.775268e-03 3 1  ON 21
ci_23                 4.973155e-03 3 1  ON 22
ci_24                 4.390390e-03 3 1  ON 23
ci_25                 3.105420e-03 3 1  ON 24
ci_26                 3.132795e-03 3 1  ON 25
ci_27                 3.313089e-03 3 1  ON 26
ci_28                 2.491189e-03 3 1  ON 27
ci_29                 2.138254e-03 3 1  ON 28
ci_30                -1.567384e-03 3 1  ON 29
ci_31                -1.611912e-03 3 1  ON 30
ci_32                -1.308988e-03 3 1  ON 31
ci_33                -1.032325e-03 3 1  ON 32
ci_34                 1.441447e-03 3 1  ON 33
ci_35                 1.234025e-03 3 1  ON 34
ci_36                -1.100871e-03 3 1  ON 35
ci_37                -1.124475e-03 3 1  ON 36
ci_38                -5.342008e-04 3 1  ON 37
ci_39                -6.362260e-04 3 1  ON 38
ci_40                -1.670805e-03 3 1  ON 39
ci_41                -1.423873e-03 3 1  ON 40
ci_42                -1.201813e-03 3 1  ON 41
ci_43                -2.686061e-03 3 1  ON 42
ci_44                -1.786812e-03 3 1  ON 43
ci_45                -6.209421e-04 3 1  ON 44
ci_46                -5.388699e-04 3 1  ON 45
ci_47                 1.319302e-03 3 1  ON 46
ci_48                 8.866829e-04 3 1  ON 47
ci_49                -9.580173e-04 3 1  ON 48
ci_50                -7.415711e-04 3 1  ON 49
ci_51                 3.502569e-04 3 1  ON 50
ci_52                 3.736651e-04 3 1  ON 51
ci_53                -6.422194e-04 3 1  ON 52
ci_54                -9.019510e-04 3 1  ON 53
ci_55                -6.719417e-04 3 1  ON 54
ci_56                 1.877984e-03 3 1  ON 55
ci_57                 1.808612e-03 3 1  ON 56
ci_58                -8.236102e-04 3 1  ON 57
ci_59                -9.534271e-04 3 1  ON 58
ci_60                 6.367516e-04 3 1  ON 59
ci_61                 5.441271e-04 3 1  ON 60
ci_62                -2.944647e-04 3 1  ON 61
ci_63                -5.207016e-04 3 1  ON 62
ci_64                -3.968100e-04 3 1  ON 63
ci_65                -3.221358e-04 3 1  ON 64
ci_66                -6.832055e-04 3 1  ON 65
ci_67                -5.946641e-04 3 1  ON 66
ci_68                -6.622956e-04 3 1  ON 67
ci_69                -2.160959e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.7509
    reference variance = 0.290503
====================================================
  Execution time = 2.4533e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5147e-01
  Total weights = 1.9644e+06
  Execution time = 3.5017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438591115971
                                         uncertainty =       0.002538625511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438591115971
                                         uncertainty =       0.002538625511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468258024
  error estimate for blocks of size 2^( 2) =       0.000493904061
  error estimate for blocks of size 2^( 3) =       0.000517347669
  error estimate for blocks of size 2^( 4) =       0.000534806371
  error estimate for blocks of size 2^( 5) =       0.000545615719
  error estimate for blocks of size 2^( 6) =       0.000549897134
  error estimate for blocks of size 2^( 7) =       0.000553613583

      target function =      -0.744029274231
              le_mean =     -22.814664152174
             les_mean =     520.960496269840
             stat err =       0.000545983202
             autocorr =       1.359527838133
   target nu stat err =       0.000545983202
   target dn stat err =       0.003142697542
      target stat err =       0.002658756148
              std dev =       0.662216848879
             le_variance =       0.438531154939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438584329401
                                         uncertainty =       0.002539132782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438584329401
                                         uncertainty =       0.002539132782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468254383
  error estimate for blocks of size 2^( 2) =       0.000493905212
  error estimate for blocks of size 2^( 3) =       0.000517353271
  error estimate for blocks of size 2^( 4) =       0.000534815590
  error estimate for blocks of size 2^( 5) =       0.000545627443
  error estimate for blocks of size 2^( 6) =       0.000549910420
  error estimate for blocks of size 2^( 7) =       0.000553631569

      target function =      -0.744084800042
              le_mean =     -22.814663343782
             les_mean =     520.960391926765
             stat err =       0.000545996256
             autocorr =       1.359613997006
   target nu stat err =       0.000545996256
   target dn stat err =       0.003151979203
      target stat err =       0.002666591098
              std dev =       0.662211698545
             le_variance =       0.438524333690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438587457944
                                         uncertainty =       0.002538869942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438587457944
                                         uncertainty =       0.002538869942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468256062
  error estimate for blocks of size 2^( 2) =       0.000493904512
  error estimate for blocks of size 2^( 3) =       0.000517350396
  error estimate for blocks of size 2^( 4) =       0.000534810943
  error estimate for blocks of size 2^( 5) =       0.000545621563
  error estimate for blocks of size 2^( 6) =       0.000549903767
  error estimate for blocks of size 2^( 7) =       0.000553622584

      target function =      -0.744125240896
              le_mean =     -22.814663720683
             les_mean =     520.960360090618
             stat err =       0.000545989714
             autocorr =       1.359571666375
   target nu stat err =       0.000545989714
   target dn stat err =       0.003145318247
      target stat err =       0.002661527427
              std dev =       0.662214073796
             le_variance =       0.438527479534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438590632115
                                         uncertainty =       0.002538654617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438590632115
                                         uncertainty =       0.002538654617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468257765
  error estimate for blocks of size 2^( 2) =       0.000493904110
  error estimate for blocks of size 2^( 3) =       0.000517348003
  error estimate for blocks of size 2^( 4) =       0.000534806941
  error estimate for blocks of size 2^( 5) =       0.000545616453
  error estimate for blocks of size 2^( 6) =       0.000549897945
  error estimate for blocks of size 2^( 7) =       0.000553614712

      target function =      -0.744127913256
              le_mean =     -22.814664089443
             les_mean =     520.960373705529
             stat err =       0.000545984013
             autocorr =       1.359533384711
   target nu stat err =       0.000545984013
   target dn stat err =       0.003140626683
      target stat err =       0.002657781046
              std dev =       0.662216481927
             le_variance =       0.438530668935


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744029274231        initial
     2.1684e+00     2.1684e+01             9.7374e-05        -0.744084800042
     8.6736e+00     8.6736e+01             2.4572e-05        -0.744125240896
     3.4694e+01     3.4694e+02             6.1574e-06        -0.744127913256  <--

*****************************************************************************
Applying the update for shift_i =   3.4694e+01     and shift_s =   3.4694e+02
*****************************************************************************

  Execution time = 4.2080e+01
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_01                 1.310308e-01 3 1  ON 0
ci_02                -3.103357e-02 3 1  ON 1
ci_03                -3.092137e-02 3 1  ON 2
ci_04                 2.770886e-02 3 1  ON 3
ci_05                -2.298181e-02 3 1  ON 4
ci_06                -2.271028e-02 3 1  ON 5
ci_07                 2.694809e-02 3 1  ON 6
ci_08                -6.324922e-03 3 1  ON 7
ci_09                -9.205962e-03 3 1  ON 8
ci_10                -9.222693e-03 3 1  ON 9
ci_11                 1.300402e-02 3 1  ON 10
ci_12                 7.602934e-03 3 1  ON 11
ci_13                 1.265526e-02 3 1  ON 12
ci_14                 1.312077e-02 3 1  ON 13
ci_15                 7.049387e-03 3 1  ON 14
ci_16                 7.294140e-03 3 1  ON 15
ci_17                -7.451785e-03 3 1  ON 16
ci_18                -7.146140e-03 3 1  ON 17
ci_19                 9.301240e-03 3 1  ON 18
ci_20                 6.815841e-03 3 1  ON 19
ci_21                 8.775940e-03 3 1  ON 20
ci_22                 8.776743e-03 3 1  ON 21
ci_23                 4.974259e-03 3 1  ON 22
ci_24                 4.389379e-03 3 1  ON 23
ci_25                 3.103868e-03 3 1  ON 24
ci_26                 3.133087e-03 3 1  ON 25
ci_27                 3.316912e-03 3 1  ON 26
ci_28                 2.490834e-03 3 1  ON 27
ci_29                 2.134649e-03 3 1  ON 28
ci_30                -1.573131e-03 3 1  ON 29
ci_31                -1.612344e-03 3 1  ON 30
ci_32                -1.311859e-03 3 1  ON 31
ci_33                -1.029193e-03 3 1  ON 32
ci_34                 1.445333e-03 3 1  ON 33
ci_35                 1.225751e-03 3 1  ON 34
ci_36                -1.106543e-03 3 1  ON 35
ci_37                -1.124137e-03 3 1  ON 36
ci_38                -5.315001e-04 3 1  ON 37
ci_39                -6.366912e-04 3 1  ON 38
ci_40                -1.672695e-03 3 1  ON 39
ci_41                -1.424907e-03 3 1  ON 40
ci_42                -1.204739e-03 3 1  ON 41
ci_43                -2.694044e-03 3 1  ON 42
ci_44                -1.775994e-03 3 1  ON 43
ci_45                -6.235831e-04 3 1  ON 44
ci_46                -5.367674e-04 3 1  ON 45
ci_47                 1.315012e-03 3 1  ON 46
ci_48                 8.866016e-04 3 1  ON 47
ci_49                -9.566204e-04 3 1  ON 48
ci_50                -7.411456e-04 3 1  ON 49
ci_51                 3.567471e-04 3 1  ON 50
ci_52                 3.747170e-04 3 1  ON 51
ci_53                -6.461157e-04 3 1  ON 52
ci_54                -9.036758e-04 3 1  ON 53
ci_55                -6.692638e-04 3 1  ON 54
ci_56                 1.877046e-03 3 1  ON 55
ci_57                 1.810127e-03 3 1  ON 56
ci_58                -8.275818e-04 3 1  ON 57
ci_59                -9.553933e-04 3 1  ON 58
ci_60                 6.328747e-04 3 1  ON 59
ci_61                 5.480178e-04 3 1  ON 60
ci_62                -2.955025e-04 3 1  ON 61
ci_63                -5.199279e-04 3 1  ON 62
ci_64                -3.975690e-04 3 1  ON 63
ci_65                -3.177189e-04 3 1  ON 64
ci_66                -6.855411e-04 3 1  ON 65
ci_67                -5.953328e-04 3 1  ON 66
ci_68                -6.693165e-04 3 1  ON 67
ci_69                -2.143837e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1747e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.9636
    reference variance = 1.56551
====================================================
  Execution time = 2.7298e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5326e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5476e-01
  Total weights = 1.964293669e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5015e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440922105485
                                         uncertainty =       0.002709383436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440922105485
                                         uncertainty =       0.002709383436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469510602
  error estimate for blocks of size 2^( 2) =       0.000495036826
  error estimate for blocks of size 2^( 3) =       0.000518181299
  error estimate for blocks of size 2^( 4) =       0.000536060031
  error estimate for blocks of size 2^( 5) =       0.000546545377
  error estimate for blocks of size 2^( 6) =       0.000553923842
  error estimate for blocks of size 2^( 7) =       0.000560031985

      target function =      -0.741435904626
              le_mean =     -22.814102038523
             les_mean =     520.938007032745
             stat err =       0.000549140309
             autocorr =       1.367967694026
   target nu stat err =       0.000549140309
   target dn stat err =       0.003421867405
      target stat err =       0.002861923684
              std dev =       0.663988260426
             le_variance =       0.440880409984


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281410203852e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+00, overlap shift 8.6736e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741446007896       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741448779170       residual = 4.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741449283458       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741449400339       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741449450502       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741449458330       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741449462779       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741449460822       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741449460918       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741449461095       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+00 is 3.430534e-05

solving harmonic davidson linear method for identity shift 3.4694e+01, overlap shift 3.4694e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741446007896       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741446703669       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741446830084       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741446859338       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741446871859       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741446873801       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741446874905       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741446874417       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741446874441       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741446874485       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+01 is 8.596192e-06

solving harmonic davidson linear method for identity shift 1.3878e+02, overlap shift 1.3878e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741446007896       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741446182024       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741446213650       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741446220965       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741446224094       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741446224579       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741446224854       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741446224733       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741446224739       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741446224750       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+02 is 2.150293e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.420710 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1809e+01
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_01                 1.310222e-01 3 1  ON 0
ci_02                -3.102826e-02 3 1  ON 1
ci_03                -3.091758e-02 3 1  ON 2
ci_04                 2.770280e-02 3 1  ON 3
ci_05                -2.297762e-02 3 1  ON 4
ci_06                -2.270744e-02 3 1  ON 5
ci_07                 2.694614e-02 3 1  ON 6
ci_08                -6.322021e-03 3 1  ON 7
ci_09                -9.201192e-03 3 1  ON 8
ci_10                -9.222052e-03 3 1  ON 9
ci_11                 1.300108e-02 3 1  ON 10
ci_12                 7.601868e-03 3 1  ON 11
ci_13                 1.265371e-02 3 1  ON 12
ci_14                 1.312111e-02 3 1  ON 13
ci_15                 7.048653e-03 3 1  ON 14
ci_16                 7.293967e-03 3 1  ON 15
ci_17                -7.449527e-03 3 1  ON 16
ci_18                -7.142138e-03 3 1  ON 17
ci_19                 9.301065e-03 3 1  ON 18
ci_20                 6.814505e-03 3 1  ON 19
ci_21                 8.774709e-03 3 1  ON 20
ci_22                 8.776203e-03 3 1  ON 21
ci_23                 4.973448e-03 3 1  ON 22
ci_24                 4.389133e-03 3 1  ON 23
ci_25                 3.103985e-03 3 1  ON 24
ci_26                 3.132570e-03 3 1  ON 25
ci_27                 3.317190e-03 3 1  ON 26
ci_28                 2.489604e-03 3 1  ON 27
ci_29                 2.135370e-03 3 1  ON 28
ci_30                -1.574409e-03 3 1  ON 29
ci_31                -1.613091e-03 3 1  ON 30
ci_32                -1.312845e-03 3 1  ON 31
ci_33                -1.030428e-03 3 1  ON 32
ci_34                 1.445264e-03 3 1  ON 33
ci_35                 1.226786e-03 3 1  ON 34
ci_36                -1.105985e-03 3 1  ON 35
ci_37                -1.123757e-03 3 1  ON 36
ci_38                -5.309689e-04 3 1  ON 37
ci_39                -6.365367e-04 3 1  ON 38
ci_40                -1.671902e-03 3 1  ON 39
ci_41                -1.425152e-03 3 1  ON 40
ci_42                -1.205172e-03 3 1  ON 41
ci_43                -2.692411e-03 3 1  ON 42
ci_44                -1.774758e-03 3 1  ON 43
ci_45                -6.248186e-04 3 1  ON 44
ci_46                -5.362402e-04 3 1  ON 45
ci_47                 1.317098e-03 3 1  ON 46
ci_48                 8.892407e-04 3 1  ON 47
ci_49                -9.558473e-04 3 1  ON 48
ci_50                -7.408277e-04 3 1  ON 49
ci_51                 3.552623e-04 3 1  ON 50
ci_52                 3.749300e-04 3 1  ON 51
ci_53                -6.465014e-04 3 1  ON 52
ci_54                -9.013466e-04 3 1  ON 53
ci_55                -6.705061e-04 3 1  ON 54
ci_56                 1.875688e-03 3 1  ON 55
ci_57                 1.809178e-03 3 1  ON 56
ci_58                -8.288195e-04 3 1  ON 57
ci_59                -9.548350e-04 3 1  ON 58
ci_60                 6.322851e-04 3 1  ON 59
ci_61                 5.500110e-04 3 1  ON 60
ci_62                -2.969502e-04 3 1  ON 61
ci_63                -5.198493e-04 3 1  ON 62
ci_64                -3.975412e-04 3 1  ON 63
ci_65                -3.173417e-04 3 1  ON 64
ci_66                -6.843434e-04 3 1  ON 65
ci_67                -5.947982e-04 3 1  ON 66
ci_68                -6.710124e-04 3 1  ON 67
ci_69                -2.153947e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.8568
    reference variance = 0.292582
====================================================
  Execution time = 2.4553e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4571e-01
  Total weights = 1.9643e+06
  Execution time = 3.5274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432848479022
                                         uncertainty =       0.001896739555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432848479022
                                         uncertainty =       0.001896739555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465196213
  error estimate for blocks of size 2^( 2) =       0.000490805252
  error estimate for blocks of size 2^( 3) =       0.000514622939
  error estimate for blocks of size 2^( 4) =       0.000532198636
  error estimate for blocks of size 2^( 5) =       0.000542549102
  error estimate for blocks of size 2^( 6) =       0.000548188480
  error estimate for blocks of size 2^( 7) =       0.000551707652

      target function =      -0.748932427564
              le_mean =     -22.814427331453
             les_mean =     520.943779198063
             stat err =       0.000543660967
             autocorr =       1.365790118223
   target nu stat err =       0.000543660967
   target dn stat err =       0.002580133600
      target stat err =       0.002236572506
              std dev =       0.657886793255
             le_variance =       0.432815032740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432844442862
                                         uncertainty =       0.001896761360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432844442862
                                         uncertainty =       0.001896761360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465194040
  error estimate for blocks of size 2^( 2) =       0.000490804758
  error estimate for blocks of size 2^( 3) =       0.000514623888
  error estimate for blocks of size 2^( 4) =       0.000532200831
  error estimate for blocks of size 2^( 5) =       0.000542551997
  error estimate for blocks of size 2^( 6) =       0.000548191997
  error estimate for blocks of size 2^( 7) =       0.000551711893

      target function =      -0.748775845243
              le_mean =     -22.814427236323
             les_mean =     520.943962473467
             stat err =       0.000543664180
             autocorr =       1.365819019406
   target nu stat err =       0.000543664180
   target dn stat err =       0.002592718784
      target stat err =       0.002245779100
              std dev =       0.657883719852
             le_variance =       0.432810988846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432846441393
                                         uncertainty =       0.001896750039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432846441393
                                         uncertainty =       0.001896750039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465195116
  error estimate for blocks of size 2^( 2) =       0.000490804998
  error estimate for blocks of size 2^( 3) =       0.000514623409
  error estimate for blocks of size 2^( 4) =       0.000532199730
  error estimate for blocks of size 2^( 5) =       0.000542550548
  error estimate for blocks of size 2^( 6) =       0.000548190239
  error estimate for blocks of size 2^( 7) =       0.000551709775

      target function =      -0.748881526558
              le_mean =     -22.814427282340
             les_mean =     520.943837946057
             stat err =       0.000543662573
             autocorr =       1.365804628043
   target nu stat err =       0.000543662573
   target dn stat err =       0.002582764075
      target stat err =       0.002238392743
              std dev =       0.657885241696
             le_variance =       0.432812991242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432848222688
                                         uncertainty =       0.001896740812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432848222688
                                         uncertainty =       0.001896740812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465196075
  error estimate for blocks of size 2^( 2) =       0.000490805220
  error estimate for blocks of size 2^( 3) =       0.000514622997
  error estimate for blocks of size 2^( 4) =       0.000532198772
  error estimate for blocks of size 2^( 5) =       0.000542549282
  error estimate for blocks of size 2^( 6) =       0.000548188699
  error estimate for blocks of size 2^( 7) =       0.000551707917

      target function =      -0.748927725166
              le_mean =     -22.814427325133
             les_mean =     520.943784544096
             stat err =       0.000543661167
             autocorr =       1.365791934264
   target nu stat err =       0.000543661167
   target dn stat err =       0.002580307559
      target stat err =       0.002236685224
              std dev =       0.657886598072
             le_variance =       0.432814775923


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748932427564        initial  <--
     8.6736e+00     8.6736e+01             3.4305e-05        -0.748775845243
     3.4694e+01     3.4694e+02             8.5962e-06        -0.748881526558
     1.3878e+02     1.3878e+03             2.1503e-06        -0.748927725166

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2284
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_01                 1.310308e-01 3 1  ON 0
ci_02                -3.103357e-02 3 1  ON 1
ci_03                -3.092137e-02 3 1  ON 2
ci_04                 2.770886e-02 3 1  ON 3
ci_05                -2.298181e-02 3 1  ON 4
ci_06                -2.271028e-02 3 1  ON 5
ci_07                 2.694809e-02 3 1  ON 6
ci_08                -6.324922e-03 3 1  ON 7
ci_09                -9.205962e-03 3 1  ON 8
ci_10                -9.222693e-03 3 1  ON 9
ci_11                 1.300402e-02 3 1  ON 10
ci_12                 7.602934e-03 3 1  ON 11
ci_13                 1.265526e-02 3 1  ON 12
ci_14                 1.312077e-02 3 1  ON 13
ci_15                 7.049387e-03 3 1  ON 14
ci_16                 7.294140e-03 3 1  ON 15
ci_17                -7.451785e-03 3 1  ON 16
ci_18                -7.146140e-03 3 1  ON 17
ci_19                 9.301240e-03 3 1  ON 18
ci_20                 6.815841e-03 3 1  ON 19
ci_21                 8.775940e-03 3 1  ON 20
ci_22                 8.776743e-03 3 1  ON 21
ci_23                 4.974259e-03 3 1  ON 22
ci_24                 4.389379e-03 3 1  ON 23
ci_25                 3.103868e-03 3 1  ON 24
ci_26                 3.133087e-03 3 1  ON 25
ci_27                 3.316912e-03 3 1  ON 26
ci_28                 2.490834e-03 3 1  ON 27
ci_29                 2.134649e-03 3 1  ON 28
ci_30                -1.573131e-03 3 1  ON 29
ci_31                -1.612344e-03 3 1  ON 30
ci_32                -1.311859e-03 3 1  ON 31
ci_33                -1.029193e-03 3 1  ON 32
ci_34                 1.445333e-03 3 1  ON 33
ci_35                 1.225751e-03 3 1  ON 34
ci_36                -1.106543e-03 3 1  ON 35
ci_37                -1.124137e-03 3 1  ON 36
ci_38                -5.315001e-04 3 1  ON 37
ci_39                -6.366912e-04 3 1  ON 38
ci_40                -1.672695e-03 3 1  ON 39
ci_41                -1.424907e-03 3 1  ON 40
ci_42                -1.204739e-03 3 1  ON 41
ci_43                -2.694044e-03 3 1  ON 42
ci_44                -1.775994e-03 3 1  ON 43
ci_45                -6.235831e-04 3 1  ON 44
ci_46                -5.367674e-04 3 1  ON 45
ci_47                 1.315012e-03 3 1  ON 46
ci_48                 8.866016e-04 3 1  ON 47
ci_49                -9.566204e-04 3 1  ON 48
ci_50                -7.411456e-04 3 1  ON 49
ci_51                 3.567471e-04 3 1  ON 50
ci_52                 3.747170e-04 3 1  ON 51
ci_53                -6.461157e-04 3 1  ON 52
ci_54                -9.036758e-04 3 1  ON 53
ci_55                -6.692638e-04 3 1  ON 54
ci_56                 1.877046e-03 3 1  ON 55
ci_57                 1.810127e-03 3 1  ON 56
ci_58                -8.275818e-04 3 1  ON 57
ci_59                -9.553933e-04 3 1  ON 58
ci_60                 6.328747e-04 3 1  ON 59
ci_61                 5.480178e-04 3 1  ON 60
ci_62                -2.955025e-04 3 1  ON 61
ci_63                -5.199279e-04 3 1  ON 62
ci_64                -3.975690e-04 3 1  ON 63
ci_65                -3.177189e-04 3 1  ON 64
ci_66                -6.855411e-04 3 1  ON 65
ci_67                -5.953328e-04 3 1  ON 66
ci_68                -6.693165e-04 3 1  ON 67
ci_69                -2.143837e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4042e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.8473
    reference variance = 0.25854
====================================================
  Execution time = 2.5251e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4575e-01
  Total weights = 1.964485899e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0465e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434133099923
                                         uncertainty =       0.001935114859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434133099923
                                         uncertainty =       0.001935114859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465861183
  error estimate for blocks of size 2^( 2) =       0.000491205002
  error estimate for blocks of size 2^( 3) =       0.000515027332
  error estimate for blocks of size 2^( 4) =       0.000532535986
  error estimate for blocks of size 2^( 5) =       0.000545095895
  error estimate for blocks of size 2^( 6) =       0.000550532309
  error estimate for blocks of size 2^( 7) =       0.000554982684

      target function =      -0.748879605479
              le_mean =     -22.814983550617
             les_mean =     520.969227822678
             stat err =       0.000545786719
             autocorr =       1.372564858225
   target nu stat err =       0.000545786719
   target dn stat err =       0.002475153664
      target stat err =       0.002154534523
              std dev =       0.658827203494
             le_variance =       0.434053284064


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281498355062e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+01, overlap shift 8.6736e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748884744331       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748884889362       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748884915105       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748884921265       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748884924536       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748884926031       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748884925265       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748884925157       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748884925217       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748884925260       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+01 is 2.246247e-06

solving harmonic davidson linear method for identity shift 3.4694e+02, overlap shift 3.4694e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748884744331       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748884780604       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748884787042       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748884788582       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748884789399       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748884789773       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748884789581       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748884789555       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748884789570       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748884789580       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+02 is 5.616911e-07

solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748884744331       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748884753400       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748884755010       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748884755395       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748884755600       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748884755693       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748884755646       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748884755636       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748884755639       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748884755644       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+03 is 1.404309e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.424195 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0306e+01
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_01                 1.310302e-01 3 1  ON 0
ci_02                -3.103337e-02 3 1  ON 1
ci_03                -3.092111e-02 3 1  ON 2
ci_04                 2.770849e-02 3 1  ON 3
ci_05                -2.298160e-02 3 1  ON 4
ci_06                -2.271008e-02 3 1  ON 5
ci_07                 2.694801e-02 3 1  ON 6
ci_08                -6.324766e-03 3 1  ON 7
ci_09                -9.205862e-03 3 1  ON 8
ci_10                -9.222454e-03 3 1  ON 9
ci_11                 1.300385e-02 3 1  ON 10
ci_12                 7.602835e-03 3 1  ON 11
ci_13                 1.265531e-02 3 1  ON 12
ci_14                 1.312078e-02 3 1  ON 13
ci_15                 7.049223e-03 3 1  ON 14
ci_16                 7.294032e-03 3 1  ON 15
ci_17                -7.451691e-03 3 1  ON 16
ci_18                -7.146053e-03 3 1  ON 17
ci_19                 9.301366e-03 3 1  ON 18
ci_20                 6.815716e-03 3 1  ON 19
ci_21                 8.775996e-03 3 1  ON 20
ci_22                 8.776837e-03 3 1  ON 21
ci_23                 4.974218e-03 3 1  ON 22
ci_24                 4.389631e-03 3 1  ON 23
ci_25                 3.103716e-03 3 1  ON 24
ci_26                 3.133143e-03 3 1  ON 25
ci_27                 3.316763e-03 3 1  ON 26
ci_28                 2.490705e-03 3 1  ON 27
ci_29                 2.134648e-03 3 1  ON 28
ci_30                -1.572928e-03 3 1  ON 29
ci_31                -1.612288e-03 3 1  ON 30
ci_32                -1.311958e-03 3 1  ON 31
ci_33                -1.029166e-03 3 1  ON 32
ci_34                 1.445191e-03 3 1  ON 33
ci_35                 1.225794e-03 3 1  ON 34
ci_36                -1.106518e-03 3 1  ON 35
ci_37                -1.124089e-03 3 1  ON 36
ci_38                -5.315096e-04 3 1  ON 37
ci_39                -6.366846e-04 3 1  ON 38
ci_40                -1.672758e-03 3 1  ON 39
ci_41                -1.424928e-03 3 1  ON 40
ci_42                -1.204923e-03 3 1  ON 41
ci_43                -2.694407e-03 3 1  ON 42
ci_44                -1.776057e-03 3 1  ON 43
ci_45                -6.235185e-04 3 1  ON 44
ci_46                -5.368555e-04 3 1  ON 45
ci_47                 1.315095e-03 3 1  ON 46
ci_48                 8.866827e-04 3 1  ON 47
ci_49                -9.566886e-04 3 1  ON 48
ci_50                -7.412241e-04 3 1  ON 49
ci_51                 3.566868e-04 3 1  ON 50
ci_52                 3.747166e-04 3 1  ON 51
ci_53                -6.460956e-04 3 1  ON 52
ci_54                -9.038188e-04 3 1  ON 53
ci_55                -6.693329e-04 3 1  ON 54
ci_56                 1.877009e-03 3 1  ON 55
ci_57                 1.810262e-03 3 1  ON 56
ci_58                -8.276288e-04 3 1  ON 57
ci_59                -9.553064e-04 3 1  ON 58
ci_60                 6.332318e-04 3 1  ON 59
ci_61                 5.481718e-04 3 1  ON 60
ci_62                -2.955544e-04 3 1  ON 61
ci_63                -5.198532e-04 3 1  ON 62
ci_64                -3.974585e-04 3 1  ON 63
ci_65                -3.178178e-04 3 1  ON 64
ci_66                -6.855976e-04 3 1  ON 65
ci_67                -5.952704e-04 3 1  ON 66
ci_68                -6.693349e-04 3 1  ON 67
ci_69                -2.145391e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.7647
    reference variance = 0.382504
====================================================
  Execution time = 2.4577e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5373e-01
  Total weights = 1.9644e+06
  Execution time = 3.5034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437409199245
                                         uncertainty =       0.002075095862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437409199245
                                         uncertainty =       0.002075095862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468059949
  error estimate for blocks of size 2^( 2) =       0.000493389739
  error estimate for blocks of size 2^( 3) =       0.000517411209
  error estimate for blocks of size 2^( 4) =       0.000534595352
  error estimate for blocks of size 2^( 5) =       0.000546500630
  error estimate for blocks of size 2^( 6) =       0.000552734674
  error estimate for blocks of size 2^( 7) =       0.000555888957

      target function =      -0.742263392440
              le_mean =     -22.814179169946
             les_mean =     520.940504943874
             stat err =       0.000547429903
             autocorr =       1.367899128907
   target nu stat err =       0.000547429903
   target dn stat err =       0.004569537085
      target stat err =       0.003792563427
              std dev =       0.661936727412
             le_variance =       0.438160231097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437408932355
                                         uncertainty =       0.002075114871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437408932355
                                         uncertainty =       0.002075114871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468059780
  error estimate for blocks of size 2^( 2) =       0.000493389664
  error estimate for blocks of size 2^( 3) =       0.000517411243
  error estimate for blocks of size 2^( 4) =       0.000534595450
  error estimate for blocks of size 2^( 5) =       0.000546500763
  error estimate for blocks of size 2^( 6) =       0.000552734903
  error estimate for blocks of size 2^( 7) =       0.000555889210

      target function =      -0.742265046365
              le_mean =     -22.814179158820
             les_mean =     520.940502425901
             stat err =       0.000547430082
             autocorr =       1.367901004186
   target nu stat err =       0.000547430082
   target dn stat err =       0.004568724518
      target stat err =       0.003791922765
              std dev =       0.661936488961
             le_variance =       0.438159915419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437409065613
                                         uncertainty =       0.002075105349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437409065613
                                         uncertainty =       0.002075105349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468059864
  error estimate for blocks of size 2^( 2) =       0.000493389701
  error estimate for blocks of size 2^( 3) =       0.000517411226
  error estimate for blocks of size 2^( 4) =       0.000534595401
  error estimate for blocks of size 2^( 5) =       0.000546500696
  error estimate for blocks of size 2^( 6) =       0.000552734789
  error estimate for blocks of size 2^( 7) =       0.000555889084

      target function =      -0.742264233214
              le_mean =     -22.814179164373
             les_mean =     520.940503667609
             stat err =       0.000547429992
             autocorr =       1.367900066994
   target nu stat err =       0.000547429992
   target dn stat err =       0.004569129362
      target stat err =       0.003792242071
              std dev =       0.661936608037
             le_variance =       0.438160073060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437409182524
                                         uncertainty =       0.002075097046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437409182524
                                         uncertainty =       0.002075097046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468059938
  error estimate for blocks of size 2^( 2) =       0.000493389734
  error estimate for blocks of size 2^( 3) =       0.000517411211
  error estimate for blocks of size 2^( 4) =       0.000534595358
  error estimate for blocks of size 2^( 5) =       0.000546500639
  error estimate for blocks of size 2^( 6) =       0.000552734689
  error estimate for blocks of size 2^( 7) =       0.000555888973

      target function =      -0.742263499150
              le_mean =     -22.814179169249
             les_mean =     520.940504782331
             stat err =       0.000547429915
             autocorr =       1.367899246182
   target nu stat err =       0.000547429915
   target dn stat err =       0.004569485973
      target stat err =       0.003792523155
              std dev =       0.661936712478
             le_variance =       0.438160211326


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742263392440        initial
     8.6736e+01     8.6736e+02             2.2462e-06        -0.742265046365  <--
     3.4694e+02     3.4694e+03             5.6169e-07        -0.742264233214
     1.3878e+03     1.3878e+04             1.4043e-07        -0.742263499150

*****************************************************************************
Applying the update for shift_i =   8.6736e+01     and shift_s =   8.6736e+02
*****************************************************************************

  Execution time = 4.2137e+01
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_01                 1.310285e-01 3 1  ON 0
ci_02                -3.103276e-02 3 1  ON 1
ci_03                -3.092032e-02 3 1  ON 2
ci_04                 2.770740e-02 3 1  ON 3
ci_05                -2.298096e-02 3 1  ON 4
ci_06                -2.270946e-02 3 1  ON 5
ci_07                 2.694775e-02 3 1  ON 6
ci_08                -6.324298e-03 3 1  ON 7
ci_09                -9.205562e-03 3 1  ON 8
ci_10                -9.221740e-03 3 1  ON 9
ci_11                 1.300335e-02 3 1  ON 10
ci_12                 7.602537e-03 3 1  ON 11
ci_13                 1.265545e-02 3 1  ON 12
ci_14                 1.312081e-02 3 1  ON 13
ci_15                 7.048732e-03 3 1  ON 14
ci_16                 7.293710e-03 3 1  ON 15
ci_17                -7.451411e-03 3 1  ON 16
ci_18                -7.145792e-03 3 1  ON 17
ci_19                 9.301743e-03 3 1  ON 18
ci_20                 6.815340e-03 3 1  ON 19
ci_21                 8.776163e-03 3 1  ON 20
ci_22                 8.777118e-03 3 1  ON 21
ci_23                 4.974093e-03 3 1  ON 22
ci_24                 4.390384e-03 3 1  ON 23
ci_25                 3.103263e-03 3 1  ON 24
ci_26                 3.133310e-03 3 1  ON 25
ci_27                 3.316318e-03 3 1  ON 26
ci_28                 2.490317e-03 3 1  ON 27
ci_29                 2.134643e-03 3 1  ON 28
ci_30                -1.572321e-03 3 1  ON 29
ci_31                -1.612120e-03 3 1  ON 30
ci_32                -1.312254e-03 3 1  ON 31
ci_33                -1.029087e-03 3 1  ON 32
ci_34                 1.444765e-03 3 1  ON 33
ci_35                 1.225922e-03 3 1  ON 34
ci_36                -1.106441e-03 3 1  ON 35
ci_37                -1.123945e-03 3 1  ON 36
ci_38                -5.315380e-04 3 1  ON 37
ci_39                -6.366646e-04 3 1  ON 38
ci_40                -1.672947e-03 3 1  ON 39
ci_41                -1.424992e-03 3 1  ON 40
ci_42                -1.205473e-03 3 1  ON 41
ci_43                -2.695495e-03 3 1  ON 42
ci_44                -1.776247e-03 3 1  ON 43
ci_45                -6.233248e-04 3 1  ON 44
ci_46                -5.371196e-04 3 1  ON 45
ci_47                 1.315345e-03 3 1  ON 46
ci_48                 8.869261e-04 3 1  ON 47
ci_49                -9.568931e-04 3 1  ON 48
ci_50                -7.414594e-04 3 1  ON 49
ci_51                 3.565060e-04 3 1  ON 50
ci_52                 3.747155e-04 3 1  ON 51
ci_53                -6.460354e-04 3 1  ON 52
ci_54                -9.042478e-04 3 1  ON 53
ci_55                -6.695402e-04 3 1  ON 54
ci_56                 1.876900e-03 3 1  ON 55
ci_57                 1.810666e-03 3 1  ON 56
ci_58                -8.277698e-04 3 1  ON 57
ci_59                -9.550458e-04 3 1  ON 58
ci_60                 6.343027e-04 3 1  ON 59
ci_61                 5.486336e-04 3 1  ON 60
ci_62                -2.957097e-04 3 1  ON 61
ci_63                -5.196291e-04 3 1  ON 62
ci_64                -3.971272e-04 3 1  ON 63
ci_65                -3.181145e-04 3 1  ON 64
ci_66                -6.857669e-04 3 1  ON 65
ci_67                -5.950835e-04 3 1  ON 66
ci_68                -6.693901e-04 3 1  ON 67
ci_69                -2.150051e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2448e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.7372
    reference variance = 0.394427
====================================================
  Execution time = 2.5085e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4528e-01
  Total weights = 1.964145294e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433155561413
                                         uncertainty =       0.002326480193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433155561413
                                         uncertainty =       0.002326480193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465373261
  error estimate for blocks of size 2^( 2) =       0.000490631781
  error estimate for blocks of size 2^( 3) =       0.000514710561
  error estimate for blocks of size 2^( 4) =       0.000532153479
  error estimate for blocks of size 2^( 5) =       0.000544584250
  error estimate for blocks of size 2^( 6) =       0.000548703869
  error estimate for blocks of size 2^( 7) =       0.000552436734

      target function =      -0.749268197313
              le_mean =     -22.814215142195
             les_mean =     520.933692977544
             stat err =       0.000544469583
             autocorr =       1.368813853125
   target nu stat err =       0.000544469583
   target dn stat err =       0.002572637050
      target stat err =       0.002232018436
              std dev =       0.658137177672
             le_variance =       0.433144544634


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281421514220e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+01, overlap shift 2.1684e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749273866776       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749274628378       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749274766971       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749274784409       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749274787203       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749274789768       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749274789412       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749274790058       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749274789894       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749274789872       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+01 is 7.459233e-06

solving harmonic davidson linear method for identity shift 8.6736e+01, overlap shift 8.6736e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749273866776       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749274057513       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749274092201       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749274096561       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749274097258       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749274097898       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749274097809       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749274097970       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749274097929       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749274097924       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+01 is 1.866688e-06

solving harmonic davidson linear method for identity shift 3.4694e+02, overlap shift 3.4694e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749273866776       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749273914481       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749273923156       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749273924246       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749273924420       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749273924579       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749273924557       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749273924598       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749273924587       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749273924586       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+02 is 4.667895e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.427681 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9616e+01
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_01                 1.310267e-01 3 1  ON 0
ci_02                -3.103098e-02 3 1  ON 1
ci_03                -3.091901e-02 3 1  ON 2
ci_04                 2.770619e-02 3 1  ON 3
ci_05                -2.297979e-02 3 1  ON 4
ci_06                -2.270786e-02 3 1  ON 5
ci_07                 2.694729e-02 3 1  ON 6
ci_08                -6.323513e-03 3 1  ON 7
ci_09                -9.205309e-03 3 1  ON 8
ci_10                -9.220959e-03 3 1  ON 9
ci_11                 1.300358e-02 3 1  ON 10
ci_12                 7.602770e-03 3 1  ON 11
ci_13                 1.265558e-02 3 1  ON 12
ci_14                 1.312149e-02 3 1  ON 13
ci_15                 7.049024e-03 3 1  ON 14
ci_16                 7.293706e-03 3 1  ON 15
ci_17                -7.450016e-03 3 1  ON 16
ci_18                -7.146049e-03 3 1  ON 17
ci_19                 9.301530e-03 3 1  ON 18
ci_20                 6.814295e-03 3 1  ON 19
ci_21                 8.775706e-03 3 1  ON 20
ci_22                 8.777236e-03 3 1  ON 21
ci_23                 4.973391e-03 3 1  ON 22
ci_24                 4.389496e-03 3 1  ON 23
ci_25                 3.103489e-03 3 1  ON 24
ci_26                 3.133746e-03 3 1  ON 25
ci_27                 3.316626e-03 3 1  ON 26
ci_28                 2.490243e-03 3 1  ON 27
ci_29                 2.134783e-03 3 1  ON 28
ci_30                -1.572577e-03 3 1  ON 29
ci_31                -1.611520e-03 3 1  ON 30
ci_32                -1.311948e-03 3 1  ON 31
ci_33                -1.028939e-03 3 1  ON 32
ci_34                 1.444569e-03 3 1  ON 33
ci_35                 1.225978e-03 3 1  ON 34
ci_36                -1.106468e-03 3 1  ON 35
ci_37                -1.123260e-03 3 1  ON 36
ci_38                -5.313024e-04 3 1  ON 37
ci_39                -6.370837e-04 3 1  ON 38
ci_40                -1.672475e-03 3 1  ON 39
ci_41                -1.425214e-03 3 1  ON 40
ci_42                -1.205682e-03 3 1  ON 41
ci_43                -2.695914e-03 3 1  ON 42
ci_44                -1.776237e-03 3 1  ON 43
ci_45                -6.231881e-04 3 1  ON 44
ci_46                -5.368582e-04 3 1  ON 45
ci_47                 1.315839e-03 3 1  ON 46
ci_48                 8.872908e-04 3 1  ON 47
ci_49                -9.570902e-04 3 1  ON 48
ci_50                -7.411359e-04 3 1  ON 49
ci_51                 3.567576e-04 3 1  ON 50
ci_52                 3.744928e-04 3 1  ON 51
ci_53                -6.461579e-04 3 1  ON 52
ci_54                -9.039964e-04 3 1  ON 53
ci_55                -6.687161e-04 3 1  ON 54
ci_56                 1.876674e-03 3 1  ON 55
ci_57                 1.809952e-03 3 1  ON 56
ci_58                -8.279331e-04 3 1  ON 57
ci_59                -9.547353e-04 3 1  ON 58
ci_60                 6.332973e-04 3 1  ON 59
ci_61                 5.495027e-04 3 1  ON 60
ci_62                -2.955655e-04 3 1  ON 61
ci_63                -5.194918e-04 3 1  ON 62
ci_64                -3.960796e-04 3 1  ON 63
ci_65                -3.175861e-04 3 1  ON 64
ci_66                -6.849171e-04 3 1  ON 65
ci_67                -5.950065e-04 3 1  ON 66
ci_68                -6.697873e-04 3 1  ON 67
ci_69                -2.150110e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.7391
    reference variance = 0.331339
====================================================
  Execution time = 2.4515e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5319e-01
  Total weights = 1.9646e+06
  Execution time = 3.5074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435484891236
                                         uncertainty =       0.002458202567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435484891236
                                         uncertainty =       0.002458202567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466670445
  error estimate for blocks of size 2^( 2) =       0.000491718966
  error estimate for blocks of size 2^( 3) =       0.000515576644
  error estimate for blocks of size 2^( 4) =       0.000533873295
  error estimate for blocks of size 2^( 5) =       0.000544762750
  error estimate for blocks of size 2^( 6) =       0.000550829594
  error estimate for blocks of size 2^( 7) =       0.000554712628

      target function =      -0.742712103592
              le_mean =     -22.814434391101
             les_mean =     520.951601705234
             stat err =       0.000546044567
             autocorr =       1.369101310601
   target nu stat err =       0.000546044567
   target dn stat err =       0.004658464373
      target stat err =       0.003870364246
              std dev =       0.659971672316
             le_variance =       0.435562608259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435483690511
                                         uncertainty =       0.002458221519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435483690511
                                         uncertainty =       0.002458221519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466669803
  error estimate for blocks of size 2^( 2) =       0.000491718753
  error estimate for blocks of size 2^( 3) =       0.000515576863
  error estimate for blocks of size 2^( 4) =       0.000533873812
  error estimate for blocks of size 2^( 5) =       0.000544763614
  error estimate for blocks of size 2^( 6) =       0.000550830515
  error estimate for blocks of size 2^( 7) =       0.000554713641

      target function =      -0.742703480019
              le_mean =     -22.814434370948
             les_mean =     520.951611202443
             stat err =       0.000546045395
             autocorr =       1.369109233688
   target nu stat err =       0.000546045395
   target dn stat err =       0.004667450033
      target stat err =       0.003877559953
              std dev =       0.659970764193
             le_variance =       0.435561409590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435484288221
                                         uncertainty =       0.002458212020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435484288221
                                         uncertainty =       0.002458212020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466670122
  error estimate for blocks of size 2^( 2) =       0.000491718858
  error estimate for blocks of size 2^( 3) =       0.000515576753
  error estimate for blocks of size 2^( 4) =       0.000533873553
  error estimate for blocks of size 2^( 5) =       0.000544763182
  error estimate for blocks of size 2^( 6) =       0.000550830054
  error estimate for blocks of size 2^( 7) =       0.000554713134

      target function =      -0.742707908722
              le_mean =     -22.814434380823
             les_mean =     520.951606302276
             stat err =       0.000546044981
             autocorr =       1.369105279195
   target nu stat err =       0.000546044981
   target dn stat err =       0.004662948577
      target stat err =       0.003873956310
              std dev =       0.659971216251
             le_variance =       0.435562006280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435484815639
                                         uncertainty =       0.002458203746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435484815639
                                         uncertainty =       0.002458203746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466670404
  error estimate for blocks of size 2^( 2) =       0.000491718952
  error estimate for blocks of size 2^( 3) =       0.000515576658
  error estimate for blocks of size 2^( 4) =       0.000533873327
  error estimate for blocks of size 2^( 5) =       0.000544762804
  error estimate for blocks of size 2^( 6) =       0.000550829651
  error estimate for blocks of size 2^( 7) =       0.000554712691

      target function =      -0.742711592770
              le_mean =     -22.814434389795
             les_mean =     520.951602262409
             stat err =       0.000546044618
             autocorr =       1.369101806956
   target nu stat err =       0.000546044618
   target dn stat err =       0.004659023468
      target stat err =       0.003870812234
              std dev =       0.659971615142
             le_variance =       0.435562532793


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742712103592        initial  <--
     2.1684e+01     2.1684e+02             7.4592e-06        -0.742703480019
     8.6736e+01     8.6736e+02             1.8667e-06        -0.742707908722
     3.4694e+02     3.4694e+03             4.6679e-07        -0.742711592770

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1054
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_01                 1.310285e-01 3 1  ON 0
ci_02                -3.103276e-02 3 1  ON 1
ci_03                -3.092032e-02 3 1  ON 2
ci_04                 2.770740e-02 3 1  ON 3
ci_05                -2.298096e-02 3 1  ON 4
ci_06                -2.270946e-02 3 1  ON 5
ci_07                 2.694775e-02 3 1  ON 6
ci_08                -6.324298e-03 3 1  ON 7
ci_09                -9.205562e-03 3 1  ON 8
ci_10                -9.221740e-03 3 1  ON 9
ci_11                 1.300335e-02 3 1  ON 10
ci_12                 7.602537e-03 3 1  ON 11
ci_13                 1.265545e-02 3 1  ON 12
ci_14                 1.312081e-02 3 1  ON 13
ci_15                 7.048732e-03 3 1  ON 14
ci_16                 7.293710e-03 3 1  ON 15
ci_17                -7.451411e-03 3 1  ON 16
ci_18                -7.145792e-03 3 1  ON 17
ci_19                 9.301743e-03 3 1  ON 18
ci_20                 6.815340e-03 3 1  ON 19
ci_21                 8.776163e-03 3 1  ON 20
ci_22                 8.777118e-03 3 1  ON 21
ci_23                 4.974093e-03 3 1  ON 22
ci_24                 4.390384e-03 3 1  ON 23
ci_25                 3.103263e-03 3 1  ON 24
ci_26                 3.133310e-03 3 1  ON 25
ci_27                 3.316318e-03 3 1  ON 26
ci_28                 2.490317e-03 3 1  ON 27
ci_29                 2.134643e-03 3 1  ON 28
ci_30                -1.572321e-03 3 1  ON 29
ci_31                -1.612120e-03 3 1  ON 30
ci_32                -1.312254e-03 3 1  ON 31
ci_33                -1.029087e-03 3 1  ON 32
ci_34                 1.444765e-03 3 1  ON 33
ci_35                 1.225922e-03 3 1  ON 34
ci_36                -1.106441e-03 3 1  ON 35
ci_37                -1.123945e-03 3 1  ON 36
ci_38                -5.315380e-04 3 1  ON 37
ci_39                -6.366646e-04 3 1  ON 38
ci_40                -1.672947e-03 3 1  ON 39
ci_41                -1.424992e-03 3 1  ON 40
ci_42                -1.205473e-03 3 1  ON 41
ci_43                -2.695495e-03 3 1  ON 42
ci_44                -1.776247e-03 3 1  ON 43
ci_45                -6.233248e-04 3 1  ON 44
ci_46                -5.371196e-04 3 1  ON 45
ci_47                 1.315345e-03 3 1  ON 46
ci_48                 8.869261e-04 3 1  ON 47
ci_49                -9.568931e-04 3 1  ON 48
ci_50                -7.414594e-04 3 1  ON 49
ci_51                 3.565060e-04 3 1  ON 50
ci_52                 3.747155e-04 3 1  ON 51
ci_53                -6.460354e-04 3 1  ON 52
ci_54                -9.042478e-04 3 1  ON 53
ci_55                -6.695402e-04 3 1  ON 54
ci_56                 1.876900e-03 3 1  ON 55
ci_57                 1.810666e-03 3 1  ON 56
ci_58                -8.277698e-04 3 1  ON 57
ci_59                -9.550458e-04 3 1  ON 58
ci_60                 6.343027e-04 3 1  ON 59
ci_61                 5.486336e-04 3 1  ON 60
ci_62                -2.957097e-04 3 1  ON 61
ci_63                -5.196291e-04 3 1  ON 62
ci_64                -3.971272e-04 3 1  ON 63
ci_65                -3.181145e-04 3 1  ON 64
ci_66                -6.857669e-04 3 1  ON 65
ci_67                -5.950835e-04 3 1  ON 66
ci_68                -6.693901e-04 3 1  ON 67
ci_69                -2.150051e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1727e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.836
    reference variance = 0.283361
====================================================
  Execution time = 2.5194e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5314e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5284e-01
  Total weights = 1.964050587e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439340318541
                                         uncertainty =       0.003096833142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439340318541
                                         uncertainty =       0.003096833142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468834305
  error estimate for blocks of size 2^( 2) =       0.000493853557
  error estimate for blocks of size 2^( 3) =       0.000517401364
  error estimate for blocks of size 2^( 4) =       0.000535045365
  error estimate for blocks of size 2^( 5) =       0.000545527079
  error estimate for blocks of size 2^( 6) =       0.000551939469
  error estimate for blocks of size 2^( 7) =       0.000555638715

      target function =      -0.742999112188
              le_mean =     -22.814924563455
             les_mean =     520.973623144115
             stat err =       0.000547037657
             autocorr =       1.361431148903
   target nu stat err =       0.000547037657
   target dn stat err =       0.004024190621
      target stat err =       0.003362362849
              std dev =       0.663031832897
             le_variance =       0.439611211434


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281492456346e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+02, overlap shift 2.1684e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743013520810       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743013659074       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743013680292       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743013682478       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743013683369       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743013683975       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743013684041       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743013684037       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743013684045       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743013684058       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+02 is 1.784791e-06

solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743013520810       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743013555381       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743013560687       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743013561233       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743013561455       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743013561608       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743013561624       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743013561622       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743013561624       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743013561627       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+02 is 4.462611e-07

solving harmonic davidson linear method for identity shift 3.4694e+03, overlap shift 3.4694e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743013520810       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743013529453       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743013530779       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743013530916       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743013530971       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743013531007       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743013531016       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743013531019       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743013531022       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743013531019       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+03 is 1.115692e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.431184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9717e+01
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_01                 1.310282e-01 3 1  ON 0
ci_02                -3.103253e-02 3 1  ON 1
ci_03                -3.092020e-02 3 1  ON 2
ci_04                 2.770725e-02 3 1  ON 3
ci_05                -2.298079e-02 3 1  ON 4
ci_06                -2.270948e-02 3 1  ON 5
ci_07                 2.694771e-02 3 1  ON 6
ci_08                -6.324216e-03 3 1  ON 7
ci_09                -9.205470e-03 3 1  ON 8
ci_10                -9.221294e-03 3 1  ON 9
ci_11                 1.300330e-02 3 1  ON 10
ci_12                 7.602456e-03 3 1  ON 11
ci_13                 1.265548e-02 3 1  ON 12
ci_14                 1.312072e-02 3 1  ON 13
ci_15                 7.048692e-03 3 1  ON 14
ci_16                 7.293656e-03 3 1  ON 15
ci_17                -7.451237e-03 3 1  ON 16
ci_18                -7.145703e-03 3 1  ON 17
ci_19                 9.301717e-03 3 1  ON 18
ci_20                 6.815256e-03 3 1  ON 19
ci_21                 8.776147e-03 3 1  ON 20
ci_22                 8.777148e-03 3 1  ON 21
ci_23                 4.974177e-03 3 1  ON 22
ci_24                 4.390392e-03 3 1  ON 23
ci_25                 3.103166e-03 3 1  ON 24
ci_26                 3.133349e-03 3 1  ON 25
ci_27                 3.316322e-03 3 1  ON 26
ci_28                 2.490215e-03 3 1  ON 27
ci_29                 2.134647e-03 3 1  ON 28
ci_30                -1.572263e-03 3 1  ON 29
ci_31                -1.612042e-03 3 1  ON 30
ci_32                -1.312199e-03 3 1  ON 31
ci_33                -1.029073e-03 3 1  ON 32
ci_34                 1.444721e-03 3 1  ON 33
ci_35                 1.225929e-03 3 1  ON 34
ci_36                -1.106419e-03 3 1  ON 35
ci_37                -1.123939e-03 3 1  ON 36
ci_38                -5.315333e-04 3 1  ON 37
ci_39                -6.366607e-04 3 1  ON 38
ci_40                -1.672918e-03 3 1  ON 39
ci_41                -1.424986e-03 3 1  ON 40
ci_42                -1.205396e-03 3 1  ON 41
ci_43                -2.695454e-03 3 1  ON 42
ci_44                -1.776273e-03 3 1  ON 43
ci_45                -6.233746e-04 3 1  ON 44
ci_46                -5.371100e-04 3 1  ON 45
ci_47                 1.315365e-03 3 1  ON 46
ci_48                 8.870100e-04 3 1  ON 47
ci_49                -9.568574e-04 3 1  ON 48
ci_50                -7.414753e-04 3 1  ON 49
ci_51                 3.565170e-04 3 1  ON 50
ci_52                 3.747460e-04 3 1  ON 51
ci_53                -6.460477e-04 3 1  ON 52
ci_54                -9.042109e-04 3 1  ON 53
ci_55                -6.695469e-04 3 1  ON 54
ci_56                 1.876947e-03 3 1  ON 55
ci_57                 1.810669e-03 3 1  ON 56
ci_58                -8.277909e-04 3 1  ON 57
ci_59                -9.550361e-04 3 1  ON 58
ci_60                 6.342931e-04 3 1  ON 59
ci_61                 5.486212e-04 3 1  ON 60
ci_62                -2.957253e-04 3 1  ON 61
ci_63                -5.195800e-04 3 1  ON 62
ci_64                -3.971785e-04 3 1  ON 63
ci_65                -3.180485e-04 3 1  ON 64
ci_66                -6.857615e-04 3 1  ON 65
ci_67                -5.950689e-04 3 1  ON 66
ci_68                -6.693249e-04 3 1  ON 67
ci_69                -2.149886e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.7288
    reference variance = 0.291962
====================================================
  Execution time = 2.4750e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4871e-01
  Total weights = 1.9642e+06
  Execution time = 3.4967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436550681761
                                         uncertainty =       0.002488396417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436550681761
                                         uncertainty =       0.002488396417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467245856
  error estimate for blocks of size 2^( 2) =       0.000492862193
  error estimate for blocks of size 2^( 3) =       0.000516758641
  error estimate for blocks of size 2^( 4) =       0.000534245368
  error estimate for blocks of size 2^( 5) =       0.000545784936
  error estimate for blocks of size 2^( 6) =       0.000551473228
  error estimate for blocks of size 2^( 7) =       0.000553159783

      target function =      -0.746413998395
              le_mean =     -22.815106278425
             les_mean =     520.977786042999
             stat err =       0.000546165829
             autocorr =       1.366337956063
   target nu stat err =       0.000546165829
   target dn stat err =       0.003221619052
      target stat err =       0.002741009417
              std dev =       0.660785426627
             le_variance =       0.436637380043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436550607015
                                         uncertainty =       0.002488393304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436550607015
                                         uncertainty =       0.002488393304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467245816
  error estimate for blocks of size 2^( 2) =       0.000492862202
  error estimate for blocks of size 2^( 3) =       0.000516758701
  error estimate for blocks of size 2^( 4) =       0.000534245459
  error estimate for blocks of size 2^( 5) =       0.000545785055
  error estimate for blocks of size 2^( 6) =       0.000551473374
  error estimate for blocks of size 2^( 7) =       0.000553159968

      target function =      -0.746414720085
              le_mean =     -22.815106290068
             les_mean =     520.977785703626
             stat err =       0.000546165964
             autocorr =       1.366338867559
   target nu stat err =       0.000546165964
   target dn stat err =       0.003221734894
      target stat err =       0.002741108397
              std dev =       0.660785369460
             le_variance =       0.436637304492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436550644357
                                         uncertainty =       0.002488394860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436550644357
                                         uncertainty =       0.002488394860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467245836
  error estimate for blocks of size 2^( 2) =       0.000492862198
  error estimate for blocks of size 2^( 3) =       0.000516758671
  error estimate for blocks of size 2^( 4) =       0.000534245414
  error estimate for blocks of size 2^( 5) =       0.000545784996
  error estimate for blocks of size 2^( 6) =       0.000551473301
  error estimate for blocks of size 2^( 7) =       0.000553159876

      target function =      -0.746414361728
              le_mean =     -22.815106284245
             les_mean =     520.977785870246
             stat err =       0.000546165896
             autocorr =       1.366338411886
   target nu stat err =       0.000546165896
   target dn stat err =       0.003221676923
      target stat err =       0.002741058884
              std dev =       0.660785398021
             le_variance =       0.436637342237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436550677082
                                         uncertainty =       0.002488396222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436550677082
                                         uncertainty =       0.002488396222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467245854
  error estimate for blocks of size 2^( 2) =       0.000492862194
  error estimate for blocks of size 2^( 3) =       0.000516758645
  error estimate for blocks of size 2^( 4) =       0.000534245374
  error estimate for blocks of size 2^( 5) =       0.000545784944
  error estimate for blocks of size 2^( 6) =       0.000551473237
  error estimate for blocks of size 2^( 7) =       0.000553159795

      target function =      -0.746414044090
              le_mean =     -22.815106279153
             les_mean =     520.977786021059
             stat err =       0.000546165837
             autocorr =       1.366338013039
   target nu stat err =       0.000546165837
   target dn stat err =       0.003221626280
      target stat err =       0.002741015597
              std dev =       0.660785423049
             le_variance =       0.436637375314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746413998395        initial
     2.1684e+02     2.1684e+03             1.7848e-06        -0.746414720085  <--
     8.6736e+02     8.6736e+03             4.4626e-07        -0.746414361728
     3.4694e+03     3.4694e+04             1.1157e-07        -0.746414044090

*****************************************************************************
Applying the update for shift_i =   2.1684e+02     and shift_s =   2.1684e+03
*****************************************************************************

  Execution time = 4.2268e+01
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_01                 1.310274e-01 3 1  ON 0
ci_02                -3.103182e-02 3 1  ON 1
ci_03                -3.091986e-02 3 1  ON 2
ci_04                 2.770678e-02 3 1  ON 3
ci_05                -2.298028e-02 3 1  ON 4
ci_06                -2.270956e-02 3 1  ON 5
ci_07                 2.694759e-02 3 1  ON 6
ci_08                -6.323970e-03 3 1  ON 7
ci_09                -9.205197e-03 3 1  ON 8
ci_10                -9.219955e-03 3 1  ON 9
ci_11                 1.300315e-02 3 1  ON 10
ci_12                 7.602212e-03 3 1  ON 11
ci_13                 1.265557e-02 3 1  ON 12
ci_14                 1.312046e-02 3 1  ON 13
ci_15                 7.048573e-03 3 1  ON 14
ci_16                 7.293494e-03 3 1  ON 15
ci_17                -7.450715e-03 3 1  ON 16
ci_18                -7.145437e-03 3 1  ON 17
ci_19                 9.301639e-03 3 1  ON 18
ci_20                 6.815005e-03 3 1  ON 19
ci_21                 8.776098e-03 3 1  ON 20
ci_22                 8.777236e-03 3 1  ON 21
ci_23                 4.974430e-03 3 1  ON 22
ci_24                 4.390415e-03 3 1  ON 23
ci_25                 3.102877e-03 3 1  ON 24
ci_26                 3.133465e-03 3 1  ON 25
ci_27                 3.316334e-03 3 1  ON 26
ci_28                 2.489912e-03 3 1  ON 27
ci_29                 2.134659e-03 3 1  ON 28
ci_30                -1.572088e-03 3 1  ON 29
ci_31                -1.611807e-03 3 1  ON 30
ci_32                -1.312036e-03 3 1  ON 31
ci_33                -1.029034e-03 3 1  ON 32
ci_34                 1.444587e-03 3 1  ON 33
ci_35                 1.225949e-03 3 1  ON 34
ci_36                -1.106351e-03 3 1  ON 35
ci_37                -1.123920e-03 3 1  ON 36
ci_38                -5.315192e-04 3 1  ON 37
ci_39                -6.366487e-04 3 1  ON 38
ci_40                -1.672830e-03 3 1  ON 39
ci_41                -1.424967e-03 3 1  ON 40
ci_42                -1.205165e-03 3 1  ON 41
ci_43                -2.695331e-03 3 1  ON 42
ci_44                -1.776351e-03 3 1  ON 43
ci_45                -6.235238e-04 3 1  ON 44
ci_46                -5.370813e-04 3 1  ON 45
ci_47                 1.315426e-03 3 1  ON 46
ci_48                 8.872618e-04 3 1  ON 47
ci_49                -9.567503e-04 3 1  ON 48
ci_50                -7.415228e-04 3 1  ON 49
ci_51                 3.565501e-04 3 1  ON 50
ci_52                 3.748373e-04 3 1  ON 51
ci_53                -6.460846e-04 3 1  ON 52
ci_54                -9.041002e-04 3 1  ON 53
ci_55                -6.695671e-04 3 1  ON 54
ci_56                 1.877089e-03 3 1  ON 55
ci_57                 1.810678e-03 3 1  ON 56
ci_58                -8.278543e-04 3 1  ON 57
ci_59                -9.550072e-04 3 1  ON 58
ci_60                 6.342645e-04 3 1  ON 59
ci_61                 5.485841e-04 3 1  ON 60
ci_62                -2.957720e-04 3 1  ON 61
ci_63                -5.194327e-04 3 1  ON 62
ci_64                -3.973325e-04 3 1  ON 63
ci_65                -3.178507e-04 3 1  ON 64
ci_66                -6.857452e-04 3 1  ON 65
ci_67                -5.950252e-04 3 1  ON 66
ci_68                -6.691291e-04 3 1  ON 67
ci_69                -2.149389e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1990e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.7763
    reference variance = 0.404754
====================================================
  Execution time = 2.5112e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5324e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4872e-01
  Total weights = 1.964246256e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4945e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433041421163
                                         uncertainty =       0.001849485157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433041421163
                                         uncertainty =       0.001849485157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465308767
  error estimate for blocks of size 2^( 2) =       0.000490763502
  error estimate for blocks of size 2^( 3) =       0.000514598284
  error estimate for blocks of size 2^( 4) =       0.000531786660
  error estimate for blocks of size 2^( 5) =       0.000542183046
  error estimate for blocks of size 2^( 6) =       0.000548259574
  error estimate for blocks of size 2^( 7) =       0.000551845143

      target function =      -0.746395603792
              le_mean =     -22.814040178865
             les_mean =     520.929149688103
             stat err =       0.000543518606
             autocorr =       1.364414610426
   target nu stat err =       0.000543518606
   target dn stat err =       0.004277655469
      target stat err =       0.003594318411
              std dev =       0.658045968479
             le_variance =       0.433024496632


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281404017887e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+01, overlap shift 5.4210e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746411902451       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746412333857       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746412411655       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746412422996       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746412428429       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746412428285       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746412429826       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746412429959       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746412429801       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+01 is 5.199517e-06

solving harmonic davidson linear method for identity shift 2.1684e+02, overlap shift 2.1684e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746411902451       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746412010378       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746412029836       residual = 9.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746412032671       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746412034029       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746412033993       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746412034378       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746412034411       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746412034372       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+02 is 1.300330e-06

solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746411902451       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746411929438       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746411934303       residual = 9.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746411935012       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746411935352       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746411935340       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746411935439       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746411935445       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746411935437       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+02 is 3.251108e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.434183 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9615e+01
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_01                 1.310260e-01 3 1  ON 0
ci_02                -3.103115e-02 3 1  ON 1
ci_03                -3.091897e-02 3 1  ON 2
ci_04                 2.770595e-02 3 1  ON 3
ci_05                -2.298014e-02 3 1  ON 4
ci_06                -2.270938e-02 3 1  ON 5
ci_07                 2.694766e-02 3 1  ON 6
ci_08                -6.323366e-03 3 1  ON 7
ci_09                -9.205122e-03 3 1  ON 8
ci_10                -9.219562e-03 3 1  ON 9
ci_11                 1.300297e-02 3 1  ON 10
ci_12                 7.602277e-03 3 1  ON 11
ci_13                 1.265583e-02 3 1  ON 12
ci_14                 1.312049e-02 3 1  ON 13
ci_15                 7.048407e-03 3 1  ON 14
ci_16                 7.293755e-03 3 1  ON 15
ci_17                -7.450772e-03 3 1  ON 16
ci_18                -7.144939e-03 3 1  ON 17
ci_19                 9.301731e-03 3 1  ON 18
ci_20                 6.814737e-03 3 1  ON 19
ci_21                 8.776289e-03 3 1  ON 20
ci_22                 8.777687e-03 3 1  ON 21
ci_23                 4.974470e-03 3 1  ON 22
ci_24                 4.390558e-03 3 1  ON 23
ci_25                 3.102622e-03 3 1  ON 24
ci_26                 3.133595e-03 3 1  ON 25
ci_27                 3.316132e-03 3 1  ON 26
ci_28                 2.490290e-03 3 1  ON 27
ci_29                 2.134403e-03 3 1  ON 28
ci_30                -1.572143e-03 3 1  ON 29
ci_31                -1.611888e-03 3 1  ON 30
ci_32                -1.311896e-03 3 1  ON 31
ci_33                -1.029032e-03 3 1  ON 32
ci_34                 1.444245e-03 3 1  ON 33
ci_35                 1.226111e-03 3 1  ON 34
ci_36                -1.106516e-03 3 1  ON 35
ci_37                -1.123502e-03 3 1  ON 36
ci_38                -5.315413e-04 3 1  ON 37
ci_39                -6.368450e-04 3 1  ON 38
ci_40                -1.672855e-03 3 1  ON 39
ci_41                -1.425016e-03 3 1  ON 40
ci_42                -1.205250e-03 3 1  ON 41
ci_43                -2.694903e-03 3 1  ON 42
ci_44                -1.776713e-03 3 1  ON 43
ci_45                -6.235463e-04 3 1  ON 44
ci_46                -5.369856e-04 3 1  ON 45
ci_47                 1.315442e-03 3 1  ON 46
ci_48                 8.871288e-04 3 1  ON 47
ci_49                -9.567175e-04 3 1  ON 48
ci_50                -7.417819e-04 3 1  ON 49
ci_51                 3.565557e-04 3 1  ON 50
ci_52                 3.746253e-04 3 1  ON 51
ci_53                -6.462215e-04 3 1  ON 52
ci_54                -9.039471e-04 3 1  ON 53
ci_55                -6.698536e-04 3 1  ON 54
ci_56                 1.877144e-03 3 1  ON 55
ci_57                 1.810774e-03 3 1  ON 56
ci_58                -8.279369e-04 3 1  ON 57
ci_59                -9.550236e-04 3 1  ON 58
ci_60                 6.345839e-04 3 1  ON 59
ci_61                 5.484678e-04 3 1  ON 60
ci_62                -2.958722e-04 3 1  ON 61
ci_63                -5.193376e-04 3 1  ON 62
ci_64                -3.971427e-04 3 1  ON 63
ci_65                -3.178714e-04 3 1  ON 64
ci_66                -6.857125e-04 3 1  ON 65
ci_67                -5.951329e-04 3 1  ON 66
ci_68                -6.694318e-04 3 1  ON 67
ci_69                -2.150892e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.8103
    reference variance = 0.345163
====================================================
  Execution time = 2.6440e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4623e-01
  Total weights = 1.9641e+06
  Execution time = 3.5003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434970576669
                                         uncertainty =       0.001809638543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434970576669
                                         uncertainty =       0.001809638543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466309566
  error estimate for blocks of size 2^( 2) =       0.000492072858
  error estimate for blocks of size 2^( 3) =       0.000515997135
  error estimate for blocks of size 2^( 4) =       0.000533526949
  error estimate for blocks of size 2^( 5) =       0.000544481231
  error estimate for blocks of size 2^( 6) =       0.000551227610
  error estimate for blocks of size 2^( 7) =       0.000555576082

      target function =      -0.748469886050
              le_mean =     -22.813825885356
             les_mean =     520.916885570604
             stat err =       0.000546202968
             autocorr =       1.372016906496
   target nu stat err =       0.000546202968
   target dn stat err =       0.002578268781
      target stat err =       0.002231188805
              std dev =       0.659461311935
             le_variance =       0.434889221938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434969855392
                                         uncertainty =       0.001809621682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434969855392
                                         uncertainty =       0.001809621682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466309178
  error estimate for blocks of size 2^( 2) =       0.000492072649
  error estimate for blocks of size 2^( 3) =       0.000515997147
  error estimate for blocks of size 2^( 4) =       0.000533527117
  error estimate for blocks of size 2^( 5) =       0.000544481476
  error estimate for blocks of size 2^( 6) =       0.000551227894
  error estimate for blocks of size 2^( 7) =       0.000555576398

      target function =      -0.748469896572
              le_mean =     -22.813825919789
             les_mean =     520.916887128760
             stat err =       0.000546203221
             autocorr =       1.372020458884
   target nu stat err =       0.000546203221
   target dn stat err =       0.002578383210
      target stat err =       0.002231280739
              std dev =       0.659460763656
             le_variance =       0.434888498801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434970215572
                                         uncertainty =       0.001809630102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434970215572
                                         uncertainty =       0.001809630102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466309372
  error estimate for blocks of size 2^( 2) =       0.000492072753
  error estimate for blocks of size 2^( 3) =       0.000515997141
  error estimate for blocks of size 2^( 4) =       0.000533527033
  error estimate for blocks of size 2^( 5) =       0.000544481354
  error estimate for blocks of size 2^( 6) =       0.000551227752
  error estimate for blocks of size 2^( 7) =       0.000555576240

      target function =      -0.748469979771
              le_mean =     -22.813825902541
             les_mean =     520.916886241973
             stat err =       0.000546203095
             autocorr =       1.372018683871
   target nu stat err =       0.000546203095
   target dn stat err =       0.002578325718
      target stat err =       0.002231235057
              std dev =       0.659461037447
             le_variance =       0.434888859911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434970531499
                                         uncertainty =       0.001809637487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434970531499
                                         uncertainty =       0.001809637487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466309541
  error estimate for blocks of size 2^( 2) =       0.000492072845
  error estimate for blocks of size 2^( 3) =       0.000515997136
  error estimate for blocks of size 2^( 4) =       0.000533526960
  error estimate for blocks of size 2^( 5) =       0.000544481246
  error estimate for blocks of size 2^( 6) =       0.000551227628
  error estimate for blocks of size 2^( 7) =       0.000555576102

      target function =      -0.748469910045
              le_mean =     -22.813825887500
             les_mean =     520.916885639581
             stat err =       0.000546202984
             autocorr =       1.372017128712
   target nu stat err =       0.000546202984
   target dn stat err =       0.002578275858
      target stat err =       0.002231194625
              std dev =       0.659461277598
             le_variance =       0.434889176652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748469886050        initial
     5.4210e+01     5.4210e+02             5.1995e-06        -0.748469896572
     2.1684e+02     2.1684e+03             1.3003e-06        -0.748469979771  <--
     8.6736e+02     8.6736e+03             3.2511e-07        -0.748469910045

*****************************************************************************
Applying the update for shift_i =   2.1684e+02     and shift_s =   2.1684e+03
*****************************************************************************

  Execution time = 4.3991e+01
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_01                 1.310260e-01 3 1  ON 0
ci_02                -3.103115e-02 3 1  ON 1
ci_03                -3.091897e-02 3 1  ON 2
ci_04                 2.770595e-02 3 1  ON 3
ci_05                -2.298014e-02 3 1  ON 4
ci_06                -2.270938e-02 3 1  ON 5
ci_07                 2.694766e-02 3 1  ON 6
ci_08                -6.323366e-03 3 1  ON 7
ci_09                -9.205122e-03 3 1  ON 8
ci_10                -9.219562e-03 3 1  ON 9
ci_11                 1.300297e-02 3 1  ON 10
ci_12                 7.602277e-03 3 1  ON 11
ci_13                 1.265583e-02 3 1  ON 12
ci_14                 1.312049e-02 3 1  ON 13
ci_15                 7.048407e-03 3 1  ON 14
ci_16                 7.293755e-03 3 1  ON 15
ci_17                -7.450772e-03 3 1  ON 16
ci_18                -7.144939e-03 3 1  ON 17
ci_19                 9.301731e-03 3 1  ON 18
ci_20                 6.814737e-03 3 1  ON 19
ci_21                 8.776289e-03 3 1  ON 20
ci_22                 8.777687e-03 3 1  ON 21
ci_23                 4.974470e-03 3 1  ON 22
ci_24                 4.390558e-03 3 1  ON 23
ci_25                 3.102622e-03 3 1  ON 24
ci_26                 3.133595e-03 3 1  ON 25
ci_27                 3.316132e-03 3 1  ON 26
ci_28                 2.490290e-03 3 1  ON 27
ci_29                 2.134403e-03 3 1  ON 28
ci_30                -1.572143e-03 3 1  ON 29
ci_31                -1.611888e-03 3 1  ON 30
ci_32                -1.311896e-03 3 1  ON 31
ci_33                -1.029032e-03 3 1  ON 32
ci_34                 1.444245e-03 3 1  ON 33
ci_35                 1.226111e-03 3 1  ON 34
ci_36                -1.106516e-03 3 1  ON 35
ci_37                -1.123502e-03 3 1  ON 36
ci_38                -5.315413e-04 3 1  ON 37
ci_39                -6.368450e-04 3 1  ON 38
ci_40                -1.672855e-03 3 1  ON 39
ci_41                -1.425016e-03 3 1  ON 40
ci_42                -1.205250e-03 3 1  ON 41
ci_43                -2.694903e-03 3 1  ON 42
ci_44                -1.776713e-03 3 1  ON 43
ci_45                -6.235463e-04 3 1  ON 44
ci_46                -5.369856e-04 3 1  ON 45
ci_47                 1.315442e-03 3 1  ON 46
ci_48                 8.871288e-04 3 1  ON 47
ci_49                -9.567175e-04 3 1  ON 48
ci_50                -7.417819e-04 3 1  ON 49
ci_51                 3.565557e-04 3 1  ON 50
ci_52                 3.746253e-04 3 1  ON 51
ci_53                -6.462215e-04 3 1  ON 52
ci_54                -9.039471e-04 3 1  ON 53
ci_55                -6.698536e-04 3 1  ON 54
ci_56                 1.877144e-03 3 1  ON 55
ci_57                 1.810774e-03 3 1  ON 56
ci_58                -8.279369e-04 3 1  ON 57
ci_59                -9.550236e-04 3 1  ON 58
ci_60                 6.345839e-04 3 1  ON 59
ci_61                 5.484678e-04 3 1  ON 60
ci_62                -2.958722e-04 3 1  ON 61
ci_63                -5.193376e-04 3 1  ON 62
ci_64                -3.971427e-04 3 1  ON 63
ci_65                -3.178714e-04 3 1  ON 64
ci_66                -6.857125e-04 3 1  ON 65
ci_67                -5.951329e-04 3 1  ON 66
ci_68                -6.694318e-04 3 1  ON 67
ci_69                -2.150892e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3611e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.7625
    reference variance = 0.348607
====================================================
  Execution time = 2.5071e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4794e-01
  Total weights = 1.963985497e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433994803072
                                         uncertainty =       0.001537929297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433994803072
                                         uncertainty =       0.001537929297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465786907
  error estimate for blocks of size 2^( 2) =       0.000491084408
  error estimate for blocks of size 2^( 3) =       0.000514994531
  error estimate for blocks of size 2^( 4) =       0.000533041057
  error estimate for blocks of size 2^( 5) =       0.000544814515
  error estimate for blocks of size 2^( 6) =       0.000551335960
  error estimate for blocks of size 2^( 7) =       0.000552367543

      target function =      -0.747053027381
              le_mean =     -22.814371921132
             les_mean =     520.943503546721
             stat err =       0.000545389769
             autocorr =       1.371006201855
   target nu stat err =       0.000545389769
   target dn stat err =       0.003339594143
      target stat err =       0.002838005594
              std dev =       0.658722161244
             le_variance =       0.433914885715


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281437192113e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+01, overlap shift 5.4210e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747062799931       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747063155635       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747063198387       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747063210260       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747063214766       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747063216775       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747063217975       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747063217874       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747063218096       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747063218124       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+01 is 4.317421e-06

solving harmonic davidson linear method for identity shift 2.1684e+02, overlap shift 2.1684e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747062799931       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747062888918       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747062899610       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747062902579       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747062903705       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747062904207       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747062904507       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747062904481       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747062904537       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747062904544       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+02 is 1.079773e-06

solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747062799931       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747062822182       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747062824855       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747062825597       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747062825879       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747062826004       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747062826079       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747062826073       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747062826087       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747062826087       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+02 is 2.699694e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.437667 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9583e+01
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_01                 1.310250e-01 3 1  ON 0
ci_02                -3.103024e-02 3 1  ON 1
ci_03                -3.091851e-02 3 1  ON 2
ci_04                 2.770524e-02 3 1  ON 3
ci_05                -2.297976e-02 3 1  ON 4
ci_06                -2.270838e-02 3 1  ON 5
ci_07                 2.694739e-02 3 1  ON 6
ci_08                -6.323262e-03 3 1  ON 7
ci_09                -9.204553e-03 3 1  ON 8
ci_10                -9.219301e-03 3 1  ON 9
ci_11                 1.300297e-02 3 1  ON 10
ci_12                 7.602207e-03 3 1  ON 11
ci_13                 1.265572e-02 3 1  ON 12
ci_14                 1.312054e-02 3 1  ON 13
ci_15                 7.048689e-03 3 1  ON 14
ci_16                 7.293518e-03 3 1  ON 15
ci_17                -7.450741e-03 3 1  ON 16
ci_18                -7.144860e-03 3 1  ON 17
ci_19                 9.301821e-03 3 1  ON 18
ci_20                 6.814595e-03 3 1  ON 19
ci_21                 8.776374e-03 3 1  ON 20
ci_22                 8.777693e-03 3 1  ON 21
ci_23                 4.974654e-03 3 1  ON 22
ci_24                 4.390514e-03 3 1  ON 23
ci_25                 3.102737e-03 3 1  ON 24
ci_26                 3.133593e-03 3 1  ON 25
ci_27                 3.315941e-03 3 1  ON 26
ci_28                 2.490275e-03 3 1  ON 27
ci_29                 2.134221e-03 3 1  ON 28
ci_30                -1.572090e-03 3 1  ON 29
ci_31                -1.611654e-03 3 1  ON 30
ci_32                -1.311946e-03 3 1  ON 31
ci_33                -1.029369e-03 3 1  ON 32
ci_34                 1.444368e-03 3 1  ON 33
ci_35                 1.226356e-03 3 1  ON 34
ci_36                -1.106449e-03 3 1  ON 35
ci_37                -1.123565e-03 3 1  ON 36
ci_38                -5.316961e-04 3 1  ON 37
ci_39                -6.368469e-04 3 1  ON 38
ci_40                -1.672895e-03 3 1  ON 39
ci_41                -1.424827e-03 3 1  ON 40
ci_42                -1.205259e-03 3 1  ON 41
ci_43                -2.694589e-03 3 1  ON 42
ci_44                -1.776442e-03 3 1  ON 43
ci_45                -6.235894e-04 3 1  ON 44
ci_46                -5.369577e-04 3 1  ON 45
ci_47                 1.315664e-03 3 1  ON 46
ci_48                 8.874405e-04 3 1  ON 47
ci_49                -9.565805e-04 3 1  ON 48
ci_50                -7.418334e-04 3 1  ON 49
ci_51                 3.564726e-04 3 1  ON 50
ci_52                 3.744538e-04 3 1  ON 51
ci_53                -6.463760e-04 3 1  ON 52
ci_54                -9.040332e-04 3 1  ON 53
ci_55                -6.699039e-04 3 1  ON 54
ci_56                 1.877396e-03 3 1  ON 55
ci_57                 1.810427e-03 3 1  ON 56
ci_58                -8.282530e-04 3 1  ON 57
ci_59                -9.549712e-04 3 1  ON 58
ci_60                 6.350935e-04 3 1  ON 59
ci_61                 5.482309e-04 3 1  ON 60
ci_62                -2.958167e-04 3 1  ON 61
ci_63                -5.194129e-04 3 1  ON 62
ci_64                -3.971884e-04 3 1  ON 63
ci_65                -3.177373e-04 3 1  ON 64
ci_66                -6.857434e-04 3 1  ON 65
ci_67                -5.951911e-04 3 1  ON 66
ci_68                -6.695460e-04 3 1  ON 67
ci_69                -2.150632e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.8456
    reference variance = 0.479688
====================================================
  Execution time = 2.4565e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4576e-01
  Total weights = 1.9642e+06
  Execution time = 3.5080e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433448396012
                                         uncertainty =       0.002094849789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433448396012
                                         uncertainty =       0.002094849789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465505966
  error estimate for blocks of size 2^( 2) =       0.000491028660
  error estimate for blocks of size 2^( 3) =       0.000514729646
  error estimate for blocks of size 2^( 4) =       0.000532466820
  error estimate for blocks of size 2^( 5) =       0.000543831806
  error estimate for blocks of size 2^( 6) =       0.000550585683
  error estimate for blocks of size 2^( 7) =       0.000554414729

      target function =      -0.748859173832
              le_mean =     -22.813712899075
             les_mean =     520.911259814224
             stat err =       0.000545324760
             autocorr =       1.372334336722
   target nu stat err =       0.000545324760
   target dn stat err =       0.002919705516
      target stat err =       0.002507821625
              std dev =       0.658324851173
             le_variance =       0.433391609671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433447847449
                                         uncertainty =       0.002094862858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433447847449
                                         uncertainty =       0.002094862858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465505671
  error estimate for blocks of size 2^( 2) =       0.000491028561
  error estimate for blocks of size 2^( 3) =       0.000514729725
  error estimate for blocks of size 2^( 4) =       0.000532467073
  error estimate for blocks of size 2^( 5) =       0.000543832144
  error estimate for blocks of size 2^( 6) =       0.000550585957
  error estimate for blocks of size 2^( 7) =       0.000554414848

      target function =      -0.748859659413
              le_mean =     -22.813712895768
             les_mean =     520.911259080343
             stat err =       0.000545325005
             autocorr =       1.372337313928
   target nu stat err =       0.000545325005
   target dn stat err =       0.002919753964
      target stat err =       0.002507864014
              std dev =       0.658324433667
             le_variance =       0.433391059963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433448121356
                                         uncertainty =       0.002094856324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433448121356
                                         uncertainty =       0.002094856324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465505819
  error estimate for blocks of size 2^( 2) =       0.000491028611
  error estimate for blocks of size 2^( 3) =       0.000514729686
  error estimate for blocks of size 2^( 4) =       0.000532466947
  error estimate for blocks of size 2^( 5) =       0.000543831975
  error estimate for blocks of size 2^( 6) =       0.000550585820
  error estimate for blocks of size 2^( 7) =       0.000554414789

      target function =      -0.748859458135
              le_mean =     -22.813712897379
             les_mean =     520.911259395534
             stat err =       0.000545324883
             autocorr =       1.372335826370
   target nu stat err =       0.000545324883
   target dn stat err =       0.002919729384
      target stat err =       0.002507842802
              std dev =       0.658324642136
             le_variance =       0.433391334443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433448361653
                                         uncertainty =       0.002094850605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433448361653
                                         uncertainty =       0.002094850605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465505948
  error estimate for blocks of size 2^( 2) =       0.000491028654
  error estimate for blocks of size 2^( 3) =       0.000514729651
  error estimate for blocks of size 2^( 4) =       0.000532466836
  error estimate for blocks of size 2^( 5) =       0.000543831827
  error estimate for blocks of size 2^( 6) =       0.000550585700
  error estimate for blocks of size 2^( 7) =       0.000554414737

      target function =      -0.748859213669
              le_mean =     -22.813712898858
             les_mean =     520.911259756528
             stat err =       0.000545324775
             autocorr =       1.372334522958
   target nu stat err =       0.000545324775
   target dn stat err =       0.002919708460
      target stat err =       0.002507824268
              std dev =       0.658324825022
             le_variance =       0.433391575240


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748859173832        initial
     5.4210e+01     5.4210e+02             4.3174e-06        -0.748859659413  <--
     2.1684e+02     2.1684e+03             1.0798e-06        -0.748859458135
     8.6736e+02     8.6736e+03             2.6997e-07        -0.748859213669

*****************************************************************************
Applying the update for shift_i =   5.4210e+01     and shift_s =   5.4210e+02
*****************************************************************************

  Execution time = 4.2144e+01
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_01                 1.310217e-01 3 1  ON 0
ci_02                -3.102751e-02 3 1  ON 1
ci_03                -3.091713e-02 3 1  ON 2
ci_04                 2.770312e-02 3 1  ON 3
ci_05                -2.297864e-02 3 1  ON 4
ci_06                -2.270537e-02 3 1  ON 5
ci_07                 2.694661e-02 3 1  ON 6
ci_08                -6.322950e-03 3 1  ON 7
ci_09                -9.202849e-03 3 1  ON 8
ci_10                -9.218521e-03 3 1  ON 9
ci_11                 1.300297e-02 3 1  ON 10
ci_12                 7.601997e-03 3 1  ON 11
ci_13                 1.265540e-02 3 1  ON 12
ci_14                 1.312068e-02 3 1  ON 13
ci_15                 7.049535e-03 3 1  ON 14
ci_16                 7.292808e-03 3 1  ON 15
ci_17                -7.450647e-03 3 1  ON 16
ci_18                -7.144621e-03 3 1  ON 17
ci_19                 9.302090e-03 3 1  ON 18
ci_20                 6.814172e-03 3 1  ON 19
ci_21                 8.776629e-03 3 1  ON 20
ci_22                 8.777712e-03 3 1  ON 21
ci_23                 4.975203e-03 3 1  ON 22
ci_24                 4.390383e-03 3 1  ON 23
ci_25                 3.103084e-03 3 1  ON 24
ci_26                 3.133586e-03 3 1  ON 25
ci_27                 3.315370e-03 3 1  ON 26
ci_28                 2.490232e-03 3 1  ON 27
ci_29                 2.133675e-03 3 1  ON 28
ci_30                -1.571929e-03 3 1  ON 29
ci_31                -1.610953e-03 3 1  ON 30
ci_32                -1.312094e-03 3 1  ON 31
ci_33                -1.030379e-03 3 1  ON 32
ci_34                 1.444737e-03 3 1  ON 33
ci_35                 1.227089e-03 3 1  ON 34
ci_36                -1.106247e-03 3 1  ON 35
ci_37                -1.123753e-03 3 1  ON 36
ci_38                -5.321601e-04 3 1  ON 37
ci_39                -6.368528e-04 3 1  ON 38
ci_40                -1.673014e-03 3 1  ON 39
ci_41                -1.424261e-03 3 1  ON 40
ci_42                -1.205286e-03 3 1  ON 41
ci_43                -2.693649e-03 3 1  ON 42
ci_44                -1.775631e-03 3 1  ON 43
ci_45                -6.237184e-04 3 1  ON 44
ci_46                -5.368741e-04 3 1  ON 45
ci_47                 1.316330e-03 3 1  ON 46
ci_48                 8.883749e-04 3 1  ON 47
ci_49                -9.561700e-04 3 1  ON 48
ci_50                -7.419878e-04 3 1  ON 49
ci_51                 3.562237e-04 3 1  ON 50
ci_52                 3.739397e-04 3 1  ON 51
ci_53                -6.468391e-04 3 1  ON 52
ci_54                -9.042910e-04 3 1  ON 53
ci_55                -6.700547e-04 3 1  ON 54
ci_56                 1.878151e-03 3 1  ON 55
ci_57                 1.809387e-03 3 1  ON 56
ci_58                -8.292005e-04 3 1  ON 57
ci_59                -9.548141e-04 3 1  ON 58
ci_60                 6.366217e-04 3 1  ON 59
ci_61                 5.475205e-04 3 1  ON 60
ci_62                -2.956502e-04 3 1  ON 61
ci_63                -5.196385e-04 3 1  ON 62
ci_64                -3.973256e-04 3 1  ON 63
ci_65                -3.173353e-04 3 1  ON 64
ci_66                -6.858360e-04 3 1  ON 65
ci_67                -5.953658e-04 3 1  ON 66
ci_68                -6.698882e-04 3 1  ON 67
ci_69                -2.149852e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1732e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.7458
    reference variance = 0.422571
====================================================
  Execution time = 2.5180e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5289e-01
  Total weights = 1.964357867e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435386798397
                                         uncertainty =       0.002782648420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435386798397
                                         uncertainty =       0.002782648420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466585646
  error estimate for blocks of size 2^( 2) =       0.000491524574
  error estimate for blocks of size 2^( 3) =       0.000515117849
  error estimate for blocks of size 2^( 4) =       0.000532796273
  error estimate for blocks of size 2^( 5) =       0.000543568920
  error estimate for blocks of size 2^( 6) =       0.000549204985
  error estimate for blocks of size 2^( 7) =       0.000553388264

      target function =      -0.742953003528
              le_mean =     -22.815283829753
             les_mean =     520.990065690085
             stat err =       0.000544739610
             autocorr =       1.363060598389
   target nu stat err =       0.000544739610
   target dn stat err =       0.004641330010
      target stat err =       0.003863604416
              std dev =       0.659851748410
             le_variance =       0.435404329879


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281528382975e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+01, overlap shift 1.3553e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742972260468       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742973987825       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742974335045       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742974386976       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742974414977       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742974420431       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742974420243       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742974419680       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742974418955       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742974419162       residual = 8.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+01 is 1.887479e-05

solving harmonic davidson linear method for identity shift 5.4210e+01, overlap shift 5.4210e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742972260468       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742972693555       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742972780494       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742972793484       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742972800479       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742972801834       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742972801786       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742972801645       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742972801464       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742972801515       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+01 is 4.726065e-06

solving harmonic davidson linear method for identity shift 2.1684e+02, overlap shift 2.1684e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742972260468       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742972368818       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742972390561       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742972393809       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742972395557       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742972395896       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742972395884       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742972395848       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742972395803       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742972395816       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+02 is 1.181978e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.441123 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9691e+01
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_01                 1.310170e-01 3 1  ON 0
ci_02                -3.102525e-02 3 1  ON 1
ci_03                -3.091379e-02 3 1  ON 2
ci_04                 2.770240e-02 3 1  ON 3
ci_05                -2.297616e-02 3 1  ON 4
ci_06                -2.270277e-02 3 1  ON 5
ci_07                 2.694612e-02 3 1  ON 6
ci_08                -6.322213e-03 3 1  ON 7
ci_09                -9.202424e-03 3 1  ON 8
ci_10                -9.217317e-03 3 1  ON 9
ci_11                 1.300275e-02 3 1  ON 10
ci_12                 7.600021e-03 3 1  ON 11
ci_13                 1.265521e-02 3 1  ON 12
ci_14                 1.311857e-02 3 1  ON 13
ci_15                 7.050118e-03 3 1  ON 14
ci_16                 7.293180e-03 3 1  ON 15
ci_17                -7.448809e-03 3 1  ON 16
ci_18                -7.144382e-03 3 1  ON 17
ci_19                 9.301590e-03 3 1  ON 18
ci_20                 6.812780e-03 3 1  ON 19
ci_21                 8.776367e-03 3 1  ON 20
ci_22                 8.778201e-03 3 1  ON 21
ci_23                 4.975011e-03 3 1  ON 22
ci_24                 4.389266e-03 3 1  ON 23
ci_25                 3.103658e-03 3 1  ON 24
ci_26                 3.134437e-03 3 1  ON 25
ci_27                 3.315367e-03 3 1  ON 26
ci_28                 2.488753e-03 3 1  ON 27
ci_29                 2.133794e-03 3 1  ON 28
ci_30                -1.571971e-03 3 1  ON 29
ci_31                -1.612854e-03 3 1  ON 30
ci_32                -1.311989e-03 3 1  ON 31
ci_33                -1.030813e-03 3 1  ON 32
ci_34                 1.444217e-03 3 1  ON 33
ci_35                 1.225897e-03 3 1  ON 34
ci_36                -1.105795e-03 3 1  ON 35
ci_37                -1.123786e-03 3 1  ON 36
ci_38                -5.306284e-04 3 1  ON 37
ci_39                -6.366526e-04 3 1  ON 38
ci_40                -1.672990e-03 3 1  ON 39
ci_41                -1.424061e-03 3 1  ON 40
ci_42                -1.204699e-03 3 1  ON 41
ci_43                -2.692538e-03 3 1  ON 42
ci_44                -1.775616e-03 3 1  ON 43
ci_45                -6.225231e-04 3 1  ON 44
ci_46                -5.371452e-04 3 1  ON 45
ci_47                 1.314906e-03 3 1  ON 46
ci_48                 8.889557e-04 3 1  ON 47
ci_49                -9.573787e-04 3 1  ON 48
ci_50                -7.416869e-04 3 1  ON 49
ci_51                 3.561864e-04 3 1  ON 50
ci_52                 3.724326e-04 3 1  ON 51
ci_53                -6.466021e-04 3 1  ON 52
ci_54                -9.016088e-04 3 1  ON 53
ci_55                -6.689693e-04 3 1  ON 54
ci_56                 1.878811e-03 3 1  ON 55
ci_57                 1.810208e-03 3 1  ON 56
ci_58                -8.290264e-04 3 1  ON 57
ci_59                -9.543925e-04 3 1  ON 58
ci_60                 6.364430e-04 3 1  ON 59
ci_61                 5.450830e-04 3 1  ON 60
ci_62                -2.946622e-04 3 1  ON 61
ci_63                -5.184018e-04 3 1  ON 62
ci_64                -3.973417e-04 3 1  ON 63
ci_65                -3.171799e-04 3 1  ON 64
ci_66                -6.868747e-04 3 1  ON 65
ci_67                -5.956309e-04 3 1  ON 66
ci_68                -6.708019e-04 3 1  ON 67
ci_69                -2.159356e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.8923
    reference variance = 0.39578
====================================================
  Execution time = 2.4387e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4202e-01
  Total weights = 1.9641e+06
  Execution time = 3.5112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430779555122
                                         uncertainty =       0.001834749101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430779555122
                                         uncertainty =       0.001834749101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464099159
  error estimate for blocks of size 2^( 2) =       0.000489822201
  error estimate for blocks of size 2^( 3) =       0.000514173191
  error estimate for blocks of size 2^( 4) =       0.000532692843
  error estimate for blocks of size 2^( 5) =       0.000544186568
  error estimate for blocks of size 2^( 6) =       0.000549639979
  error estimate for blocks of size 2^( 7) =       0.000553681177

      target function =      -0.752009666637
              le_mean =     -22.815496628435
             les_mean =     520.988914293446
             stat err =       0.000545050142
             autocorr =       1.379276548218
   target nu stat err =       0.000545050142
   target dn stat err =       0.002321744005
      target stat err =       0.002049549018
              std dev =       0.656335324266
             le_variance =       0.430776057879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430776920482
                                         uncertainty =       0.001834646839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430776920482
                                         uncertainty =       0.001834646839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464097734
  error estimate for blocks of size 2^( 2) =       0.000489821523
  error estimate for blocks of size 2^( 3) =       0.000514173225
  error estimate for blocks of size 2^( 4) =       0.000532693429
  error estimate for blocks of size 2^( 5) =       0.000544187572
  error estimate for blocks of size 2^( 6) =       0.000549641125
  error estimate for blocks of size 2^( 7) =       0.000553682296

      target function =      -0.752018551485
              le_mean =     -22.815496615451
             les_mean =     520.988903157398
             stat err =       0.000545051105
             autocorr =       1.379289894091
   target nu stat err =       0.000545051105
   target dn stat err =       0.002321672988
      target stat err =       0.002049538454
              std dev =       0.656333309195
             le_variance =       0.430773412759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430778230318
                                         uncertainty =       0.001834697805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430778230318
                                         uncertainty =       0.001834697805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464098442
  error estimate for blocks of size 2^( 2) =       0.000489821859
  error estimate for blocks of size 2^( 3) =       0.000514173206
  error estimate for blocks of size 2^( 4) =       0.000532693134
  error estimate for blocks of size 2^( 5) =       0.000544187069
  error estimate for blocks of size 2^( 6) =       0.000549640551
  error estimate for blocks of size 2^( 7) =       0.000553681735

      target function =      -0.752014614594
              le_mean =     -22.815496621361
             les_mean =     520.988908098926
             stat err =       0.000545050622
             autocorr =       1.379283238086
   target nu stat err =       0.000545050622
   target dn stat err =       0.002321705266
      target stat err =       0.002049543769
              std dev =       0.656334311023
             le_variance =       0.430774727825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430779388945
                                         uncertainty =       0.001834742683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430779388945
                                         uncertainty =       0.001834742683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464099069
  error estimate for blocks of size 2^( 2) =       0.000489822157
  error estimate for blocks of size 2^( 3) =       0.000514173193
  error estimate for blocks of size 2^( 4) =       0.000532692879
  error estimate for blocks of size 2^( 5) =       0.000544186631
  error estimate for blocks of size 2^( 6) =       0.000549640050
  error estimate for blocks of size 2^( 7) =       0.000553681246

      target function =      -0.752010356567
              le_mean =     -22.815496627490
             les_mean =     520.988913431584
             stat err =       0.000545050202
             autocorr =       1.379277385051
   target nu stat err =       0.000545050202
   target dn stat err =       0.002321738726
      target stat err =       0.002049548382
              std dev =       0.656335197171
             le_variance =       0.430775891045


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.752009666637        initial
     1.3553e+01     1.3553e+02             1.8875e-05        -0.752018551485  <--
     5.4210e+01     5.4210e+02             4.7261e-06        -0.752014614594
     2.1684e+02     2.1684e+03             1.1820e-06        -0.752010356567

*****************************************************************************
Applying the update for shift_i =   1.3553e+01     and shift_s =   1.3553e+02
*****************************************************************************

  Execution time = 4.2040e+01
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_01                 1.310029e-01 3 1  ON 0
ci_02                -3.101848e-02 3 1  ON 1
ci_03                -3.090382e-02 3 1  ON 2
ci_04                 2.770023e-02 3 1  ON 3
ci_05                -2.296874e-02 3 1  ON 4
ci_06                -2.269503e-02 3 1  ON 5
ci_07                 2.694468e-02 3 1  ON 6
ci_08                -6.320008e-03 3 1  ON 7
ci_09                -9.201152e-03 3 1  ON 8
ci_10                -9.213718e-03 3 1  ON 9
ci_11                 1.300209e-02 3 1  ON 10
ci_12                 7.594111e-03 3 1  ON 11
ci_13                 1.265464e-02 3 1  ON 12
ci_14                 1.311228e-02 3 1  ON 13
ci_15                 7.051862e-03 3 1  ON 14
ci_16                 7.294293e-03 3 1  ON 15
ci_17                -7.443312e-03 3 1  ON 16
ci_18                -7.143665e-03 3 1  ON 17
ci_19                 9.300095e-03 3 1  ON 18
ci_20                 6.808618e-03 3 1  ON 19
ci_21                 8.775584e-03 3 1  ON 20
ci_22                 8.779665e-03 3 1  ON 21
ci_23                 4.974435e-03 3 1  ON 22
ci_24                 4.385924e-03 3 1  ON 23
ci_25                 3.105374e-03 3 1  ON 24
ci_26                 3.136980e-03 3 1  ON 25
ci_27                 3.315355e-03 3 1  ON 26
ci_28                 2.484330e-03 3 1  ON 27
ci_29                 2.134149e-03 3 1  ON 28
ci_30                -1.572095e-03 3 1  ON 29
ci_31                -1.618546e-03 3 1  ON 30
ci_32                -1.311676e-03 3 1  ON 31
ci_33                -1.032110e-03 3 1  ON 32
ci_34                 1.442663e-03 3 1  ON 33
ci_35                 1.222334e-03 3 1  ON 34
ci_36                -1.104443e-03 3 1  ON 35
ci_37                -1.123884e-03 3 1  ON 36
ci_38                -5.260526e-04 3 1  ON 37
ci_39                -6.360543e-04 3 1  ON 38
ci_40                -1.672917e-03 3 1  ON 39
ci_41                -1.423462e-03 3 1  ON 40
ci_42                -1.202943e-03 3 1  ON 41
ci_43                -2.689214e-03 3 1  ON 42
ci_44                -1.775571e-03 3 1  ON 43
ci_45                -6.189502e-04 3 1  ON 44
ci_46                -5.379552e-04 3 1  ON 45
ci_47                 1.310644e-03 3 1  ON 46
ci_48                 8.906954e-04 3 1  ON 47
ci_49                -9.609896e-04 3 1  ON 48
ci_50                -7.407879e-04 3 1  ON 49
ci_51                 3.560746e-04 3 1  ON 50
ci_52                 3.679275e-04 3 1  ON 51
ci_53                -6.458936e-04 3 1  ON 52
ci_54                -8.935957e-04 3 1  ON 53
ci_55                -6.657247e-04 3 1  ON 54
ci_56                 1.880783e-03 3 1  ON 55
ci_57                 1.812660e-03 3 1  ON 56
ci_58                -8.285061e-04 3 1  ON 57
ci_59                -9.531328e-04 3 1  ON 58
ci_60                 6.359066e-04 3 1  ON 59
ci_61                 5.377852e-04 3 1  ON 60
ci_62                -2.917102e-04 3 1  ON 61
ci_63                -5.147064e-04 3 1  ON 62
ci_64                -3.973887e-04 3 1  ON 63
ci_65                -3.167157e-04 3 1  ON 64
ci_66                -6.899794e-04 3 1  ON 65
ci_67                -5.964216e-04 3 1  ON 66
ci_68                -6.735320e-04 3 1  ON 67
ci_69                -2.187776e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1751e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.7152
    reference variance = 0.397694
====================================================
  Execution time = 2.5302e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4598e-01
  Total weights = 1.964320277e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5121e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433195533122
                                         uncertainty =       0.001916163742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433195533122
                                         uncertainty =       0.001916163742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465364428
  error estimate for blocks of size 2^( 2) =       0.000490453263
  error estimate for blocks of size 2^( 3) =       0.000513976244
  error estimate for blocks of size 2^( 4) =       0.000532145846
  error estimate for blocks of size 2^( 5) =       0.000543913456
  error estimate for blocks of size 2^( 6) =       0.000552016417
  error estimate for blocks of size 2^( 7) =       0.000558653529

      target function =      -0.748686150146
              le_mean =     -22.814561777890
             les_mean =     520.950209701312
             stat err =       0.000546682312
             autocorr =       1.380014594430
   target nu stat err =       0.000546682312
   target dn stat err =       0.002673931898
      target stat err =       0.002311894012
              std dev =       0.658124684964
             le_variance =       0.433128100959


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281456177789e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+00, overlap shift 3.3881e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748692270641       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748701876664       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748702738986       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748702902156       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748702922187       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748702927065       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748702931634       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748702937638       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748702934633       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+00 is 6.934083e-05

solving harmonic davidson linear method for identity shift 1.3553e+01, overlap shift 1.3553e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748692270641       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748694699488       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748694916046       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748694957025       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748694961941       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748694963102       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748694964223       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748694965711       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748694964959       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+01 is 1.751153e-05

solving harmonic davidson linear method for identity shift 5.4210e+01, overlap shift 5.4210e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748692270641       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748692879586       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748692933787       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748692944043       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748692945266       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748692945553       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748692945831       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748692946203       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748692946015       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+01 is 4.389042e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.444183 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9822e+01
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_01                 1.309916e-01 3 1  ON 0
ci_02                -3.100937e-02 3 1  ON 1
ci_03                -3.088631e-02 3 1  ON 2
ci_04                 2.769099e-02 3 1  ON 3
ci_05                -2.296007e-02 3 1  ON 4
ci_06                -2.269189e-02 3 1  ON 5
ci_07                 2.694645e-02 3 1  ON 6
ci_08                -6.316622e-03 3 1  ON 7
ci_09                -9.199885e-03 3 1  ON 8
ci_10                -9.203856e-03 3 1  ON 9
ci_11                 1.300376e-02 3 1  ON 10
ci_12                 7.596224e-03 3 1  ON 11
ci_13                 1.264937e-02 3 1  ON 12
ci_14                 1.311357e-02 3 1  ON 13
ci_15                 7.048529e-03 3 1  ON 14
ci_16                 7.293327e-03 3 1  ON 15
ci_17                -7.442770e-03 3 1  ON 16
ci_18                -7.142769e-03 3 1  ON 17
ci_19                 9.305574e-03 3 1  ON 18
ci_20                 6.817311e-03 3 1  ON 19
ci_21                 8.777670e-03 3 1  ON 20
ci_22                 8.775579e-03 3 1  ON 21
ci_23                 4.973321e-03 3 1  ON 22
ci_24                 4.389405e-03 3 1  ON 23
ci_25                 3.100531e-03 3 1  ON 24
ci_26                 3.138183e-03 3 1  ON 25
ci_27                 3.320937e-03 3 1  ON 26
ci_28                 2.475879e-03 3 1  ON 27
ci_29                 2.132037e-03 3 1  ON 28
ci_30                -1.572975e-03 3 1  ON 29
ci_31                -1.615526e-03 3 1  ON 30
ci_32                -1.309566e-03 3 1  ON 31
ci_33                -1.035600e-03 3 1  ON 32
ci_34                 1.436525e-03 3 1  ON 33
ci_35                 1.225240e-03 3 1  ON 34
ci_36                -1.102313e-03 3 1  ON 35
ci_37                -1.122561e-03 3 1  ON 36
ci_38                -5.272811e-04 3 1  ON 37
ci_39                -6.344755e-04 3 1  ON 38
ci_40                -1.666740e-03 3 1  ON 39
ci_41                -1.421768e-03 3 1  ON 40
ci_42                -1.203049e-03 3 1  ON 41
ci_43                -2.695696e-03 3 1  ON 42
ci_44                -1.774753e-03 3 1  ON 43
ci_45                -6.162719e-04 3 1  ON 44
ci_46                -5.342477e-04 3 1  ON 45
ci_47                 1.316258e-03 3 1  ON 46
ci_48                 8.932863e-04 3 1  ON 47
ci_49                -9.552391e-04 3 1  ON 48
ci_50                -7.401288e-04 3 1  ON 49
ci_51                 3.574054e-04 3 1  ON 50
ci_52                 3.692523e-04 3 1  ON 51
ci_53                -6.417909e-04 3 1  ON 52
ci_54                -8.935645e-04 3 1  ON 53
ci_55                -6.659386e-04 3 1  ON 54
ci_56                 1.881992e-03 3 1  ON 55
ci_57                 1.813816e-03 3 1  ON 56
ci_58                -8.334792e-04 3 1  ON 57
ci_59                -9.522335e-04 3 1  ON 58
ci_60                 6.352293e-04 3 1  ON 59
ci_61                 5.350464e-04 3 1  ON 60
ci_62                -2.951113e-04 3 1  ON 61
ci_63                -5.138167e-04 3 1  ON 62
ci_64                -3.914717e-04 3 1  ON 63
ci_65                -3.080070e-04 3 1  ON 64
ci_66                -6.882528e-04 3 1  ON 65
ci_67                -5.938255e-04 3 1  ON 66
ci_68                -6.757298e-04 3 1  ON 67
ci_69                -2.209044e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.8297
    reference variance = 0.399981
====================================================
  Execution time = 2.4405e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5121e-01
  Total weights = 1.9643e+06
  Execution time = 3.5041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437318634680
                                         uncertainty =       0.002401994311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437318634680
                                         uncertainty =       0.002401994311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467611288
  error estimate for blocks of size 2^( 2) =       0.000492537106
  error estimate for blocks of size 2^( 3) =       0.000516076349
  error estimate for blocks of size 2^( 4) =       0.000532721191
  error estimate for blocks of size 2^( 5) =       0.000543779095
  error estimate for blocks of size 2^( 6) =       0.000550590013
  error estimate for blocks of size 2^( 7) =       0.000554978572

      target function =      -0.744347567275
              le_mean =     -22.814650722008
             les_mean =     520.959497527608
             stat err =       0.000545517218
             autocorr =       1.360964986843
   target nu stat err =       0.000545517218
   target dn stat err =       0.003115499851
      target stat err =       0.002638966793
              std dev =       0.661302225218
             le_variance =       0.437320633078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437305321890
                                         uncertainty =       0.002402346130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437305321890
                                         uncertainty =       0.002402346130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467604108
  error estimate for blocks of size 2^( 2) =       0.000492532678
  error estimate for blocks of size 2^( 3) =       0.000516074349
  error estimate for blocks of size 2^( 4) =       0.000532721495
  error estimate for blocks of size 2^( 5) =       0.000543780027
  error estimate for blocks of size 2^( 6) =       0.000550591632
  error estimate for blocks of size 2^( 7) =       0.000554980884

      target function =      -0.744309526251
              le_mean =     -22.814650323818
             les_mean =     520.959525466331
             stat err =       0.000545518509
             autocorr =       1.361013224895
   target nu stat err =       0.000545518509
   target dn stat err =       0.003120071082
      target stat err =       0.002642371747
              std dev =       0.661292071745
             le_variance =       0.437307204153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437311833694
                                         uncertainty =       0.002402170978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437311833694
                                         uncertainty =       0.002402170978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467607620
  error estimate for blocks of size 2^( 2) =       0.000492534832
  error estimate for blocks of size 2^( 3) =       0.000516075300
  error estimate for blocks of size 2^( 4) =       0.000532721306
  error estimate for blocks of size 2^( 5) =       0.000543779528
  error estimate for blocks of size 2^( 6) =       0.000550590782
  error estimate for blocks of size 2^( 7) =       0.000554979698

      target function =      -0.744339038216
              le_mean =     -22.814650505842
             les_mean =     520.959497993382
             stat err =       0.000545517828
             autocorr =       1.360989382355
   target nu stat err =       0.000545517828
   target dn stat err =       0.003117682250
      target stat err =       0.002640658900
              std dev =       0.661297038739
             le_variance =       0.437313773445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437317773976
                                         uncertainty =       0.002402016333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437317773976
                                         uncertainty =       0.002402016333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467610824
  error estimate for blocks of size 2^( 2) =       0.000492536817
  error estimate for blocks of size 2^( 3) =       0.000516076213
  error estimate for blocks of size 2^( 4) =       0.000532721202
  error estimate for blocks of size 2^( 5) =       0.000543779145
  error estimate for blocks of size 2^( 6) =       0.000550590105
  error estimate for blocks of size 2^( 7) =       0.000554978709

      target function =      -0.744347306289
              le_mean =     -22.814650693612
             les_mean =     520.959496546616
             stat err =       0.000545517290
             autocorr =       1.360968048901
   target nu stat err =       0.000545517290
   target dn stat err =       0.003115763196
      target stat err =       0.002639176272
              std dev =       0.661301568896
             le_variance =       0.437319765024


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744347567275        initial  <--
     3.3881e+00     3.3881e+01             6.9341e-05        -0.744309526251
     1.3553e+01     1.3553e+02             1.7512e-05        -0.744339038216
     5.4210e+01     5.4210e+02             4.3890e-06        -0.744347306289

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.9833
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_01                 1.310029e-01 3 1  ON 0
ci_02                -3.101848e-02 3 1  ON 1
ci_03                -3.090382e-02 3 1  ON 2
ci_04                 2.770023e-02 3 1  ON 3
ci_05                -2.296874e-02 3 1  ON 4
ci_06                -2.269503e-02 3 1  ON 5
ci_07                 2.694468e-02 3 1  ON 6
ci_08                -6.320008e-03 3 1  ON 7
ci_09                -9.201152e-03 3 1  ON 8
ci_10                -9.213718e-03 3 1  ON 9
ci_11                 1.300209e-02 3 1  ON 10
ci_12                 7.594111e-03 3 1  ON 11
ci_13                 1.265464e-02 3 1  ON 12
ci_14                 1.311228e-02 3 1  ON 13
ci_15                 7.051862e-03 3 1  ON 14
ci_16                 7.294293e-03 3 1  ON 15
ci_17                -7.443312e-03 3 1  ON 16
ci_18                -7.143665e-03 3 1  ON 17
ci_19                 9.300095e-03 3 1  ON 18
ci_20                 6.808618e-03 3 1  ON 19
ci_21                 8.775584e-03 3 1  ON 20
ci_22                 8.779665e-03 3 1  ON 21
ci_23                 4.974435e-03 3 1  ON 22
ci_24                 4.385924e-03 3 1  ON 23
ci_25                 3.105374e-03 3 1  ON 24
ci_26                 3.136980e-03 3 1  ON 25
ci_27                 3.315355e-03 3 1  ON 26
ci_28                 2.484330e-03 3 1  ON 27
ci_29                 2.134149e-03 3 1  ON 28
ci_30                -1.572095e-03 3 1  ON 29
ci_31                -1.618546e-03 3 1  ON 30
ci_32                -1.311676e-03 3 1  ON 31
ci_33                -1.032110e-03 3 1  ON 32
ci_34                 1.442663e-03 3 1  ON 33
ci_35                 1.222334e-03 3 1  ON 34
ci_36                -1.104443e-03 3 1  ON 35
ci_37                -1.123884e-03 3 1  ON 36
ci_38                -5.260526e-04 3 1  ON 37
ci_39                -6.360543e-04 3 1  ON 38
ci_40                -1.672917e-03 3 1  ON 39
ci_41                -1.423462e-03 3 1  ON 40
ci_42                -1.202943e-03 3 1  ON 41
ci_43                -2.689214e-03 3 1  ON 42
ci_44                -1.775571e-03 3 1  ON 43
ci_45                -6.189502e-04 3 1  ON 44
ci_46                -5.379552e-04 3 1  ON 45
ci_47                 1.310644e-03 3 1  ON 46
ci_48                 8.906954e-04 3 1  ON 47
ci_49                -9.609896e-04 3 1  ON 48
ci_50                -7.407879e-04 3 1  ON 49
ci_51                 3.560746e-04 3 1  ON 50
ci_52                 3.679275e-04 3 1  ON 51
ci_53                -6.458936e-04 3 1  ON 52
ci_54                -8.935957e-04 3 1  ON 53
ci_55                -6.657247e-04 3 1  ON 54
ci_56                 1.880783e-03 3 1  ON 55
ci_57                 1.812660e-03 3 1  ON 56
ci_58                -8.285061e-04 3 1  ON 57
ci_59                -9.531328e-04 3 1  ON 58
ci_60                 6.359066e-04 3 1  ON 59
ci_61                 5.377852e-04 3 1  ON 60
ci_62                -2.917102e-04 3 1  ON 61
ci_63                -5.147064e-04 3 1  ON 62
ci_64                -3.973887e-04 3 1  ON 63
ci_65                -3.167157e-04 3 1  ON 64
ci_66                -6.899794e-04 3 1  ON 65
ci_67                -5.964216e-04 3 1  ON 66
ci_68                -6.735320e-04 3 1  ON 67
ci_69                -2.187776e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1811e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.7613
    reference variance = 0.273525
====================================================
  Execution time = 2.5259e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4593e-01
  Total weights = 1.964435942e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5479e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434424354101
                                         uncertainty =       0.001673701296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434424354101
                                         uncertainty =       0.001673701296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466029880
  error estimate for blocks of size 2^( 2) =       0.000491082902
  error estimate for blocks of size 2^( 3) =       0.000514603428
  error estimate for blocks of size 2^( 4) =       0.000531832241
  error estimate for blocks of size 2^( 5) =       0.000543711514
  error estimate for blocks of size 2^( 6) =       0.000548506137
  error estimate for blocks of size 2^( 7) =       0.000551323115

      target function =      -0.748736464121
              le_mean =     -22.815157136887
             les_mean =     520.977322717538
             stat err =       0.000543843252
             autocorr =       1.361820796102
   target nu stat err =       0.000543843252
   target dn stat err =       0.002191933236
      target stat err =       0.001927939390
              std dev =       0.659065777011
             le_variance =       0.434367698427


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281515713689e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+01, overlap shift 3.3881e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748740458717       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748740879906       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748740953194       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748740986645       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748740995555       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748740995583       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748740995922       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748740995620       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748740995256       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+01 is 9.782872e-06

solving harmonic davidson linear method for identity shift 1.3553e+02, overlap shift 1.3553e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748740458717       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748740564129       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748740582461       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748740590826       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748740593052       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748740593058       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748740593142       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748740593067       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748740592976       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+02 is 2.447178e-06

solving harmonic davidson linear method for identity shift 5.4210e+02, overlap shift 5.4210e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748740458717       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748740485077       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748740489661       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748740491752       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748740492309       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748740492310       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748740492331       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748740492313       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748740492290       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+02 is 6.118857e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.447223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9825e+01
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_01                 1.310004e-01 3 1  ON 0
ci_02                -3.101736e-02 3 1  ON 1
ci_03                -3.090335e-02 3 1  ON 2
ci_04                 2.769965e-02 3 1  ON 3
ci_05                -2.296741e-02 3 1  ON 4
ci_06                -2.269433e-02 3 1  ON 5
ci_07                 2.694460e-02 3 1  ON 6
ci_08                -6.319957e-03 3 1  ON 7
ci_09                -9.200513e-03 3 1  ON 8
ci_10                -9.213418e-03 3 1  ON 9
ci_11                 1.300192e-02 3 1  ON 10
ci_12                 7.594067e-03 3 1  ON 11
ci_13                 1.265473e-02 3 1  ON 12
ci_14                 1.311226e-02 3 1  ON 13
ci_15                 7.051892e-03 3 1  ON 14
ci_16                 7.294213e-03 3 1  ON 15
ci_17                -7.443169e-03 3 1  ON 16
ci_18                -7.143412e-03 3 1  ON 17
ci_19                 9.300399e-03 3 1  ON 18
ci_20                 6.808478e-03 3 1  ON 19
ci_21                 8.775516e-03 3 1  ON 20
ci_22                 8.780120e-03 3 1  ON 21
ci_23                 4.974478e-03 3 1  ON 22
ci_24                 4.385871e-03 3 1  ON 23
ci_25                 3.105368e-03 3 1  ON 24
ci_26                 3.137247e-03 3 1  ON 25
ci_27                 3.314772e-03 3 1  ON 26
ci_28                 2.483937e-03 3 1  ON 27
ci_29                 2.134253e-03 3 1  ON 28
ci_30                -1.571869e-03 3 1  ON 29
ci_31                -1.618372e-03 3 1  ON 30
ci_32                -1.311779e-03 3 1  ON 31
ci_33                -1.032060e-03 3 1  ON 32
ci_34                 1.442917e-03 3 1  ON 33
ci_35                 1.223419e-03 3 1  ON 34
ci_36                -1.104356e-03 3 1  ON 35
ci_37                -1.123698e-03 3 1  ON 36
ci_38                -5.260140e-04 3 1  ON 37
ci_39                -6.357698e-04 3 1  ON 38
ci_40                -1.672494e-03 3 1  ON 39
ci_41                -1.423730e-03 3 1  ON 40
ci_42                -1.202965e-03 3 1  ON 41
ci_43                -2.688627e-03 3 1  ON 42
ci_44                -1.775990e-03 3 1  ON 43
ci_45                -6.187512e-04 3 1  ON 44
ci_46                -5.379359e-04 3 1  ON 45
ci_47                 1.311004e-03 3 1  ON 46
ci_48                 8.912938e-04 3 1  ON 47
ci_49                -9.610146e-04 3 1  ON 48
ci_50                -7.410204e-04 3 1  ON 49
ci_51                 3.561617e-04 3 1  ON 50
ci_52                 3.678720e-04 3 1  ON 51
ci_53                -6.458303e-04 3 1  ON 52
ci_54                -8.931526e-04 3 1  ON 53
ci_55                -6.656825e-04 3 1  ON 54
ci_56                 1.880715e-03 3 1  ON 55
ci_57                 1.812487e-03 3 1  ON 56
ci_58                -8.287625e-04 3 1  ON 57
ci_59                -9.532012e-04 3 1  ON 58
ci_60                 6.357867e-04 3 1  ON 59
ci_61                 5.382619e-04 3 1  ON 60
ci_62                -2.916897e-04 3 1  ON 61
ci_63                -5.148398e-04 3 1  ON 62
ci_64                -3.968283e-04 3 1  ON 63
ci_65                -3.167646e-04 3 1  ON 64
ci_66                -6.897086e-04 3 1  ON 65
ci_67                -5.961559e-04 3 1  ON 66
ci_68                -6.736036e-04 3 1  ON 67
ci_69                -2.188307e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.8479
    reference variance = 0.252475
====================================================
  Execution time = 2.6336e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4735e-01
  Total weights = 1.9644e+06
  Execution time = 3.5215e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435731847998
                                         uncertainty =       0.002456543326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435731847998
                                         uncertainty =       0.002456543326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466717148
  error estimate for blocks of size 2^( 2) =       0.000492138381
  error estimate for blocks of size 2^( 3) =       0.000515557313
  error estimate for blocks of size 2^( 4) =       0.000532885138
  error estimate for blocks of size 2^( 5) =       0.000543498921
  error estimate for blocks of size 2^( 6) =       0.000550033515
  error estimate for blocks of size 2^( 7) =       0.000553498589

      target function =      -0.747551010333
              le_mean =     -22.814547150409
             les_mean =     520.950903596009
             stat err =       0.000544979041
             autocorr =       1.363490398688
   target nu stat err =       0.000544979041
   target dn stat err =       0.002945173768
      target stat err =       0.002522885385
              std dev =       0.660037720693
             le_variance =       0.435649792738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435731274713
                                         uncertainty =       0.002456673281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435731274713
                                         uncertainty =       0.002456673281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466716842
  error estimate for blocks of size 2^( 2) =       0.000492138301
  error estimate for blocks of size 2^( 3) =       0.000515557475
  error estimate for blocks of size 2^( 4) =       0.000532885500
  error estimate for blocks of size 2^( 5) =       0.000543499371
  error estimate for blocks of size 2^( 6) =       0.000550033953
  error estimate for blocks of size 2^( 7) =       0.000553498975

      target function =      -0.747513410894
              le_mean =     -22.814547141483
             les_mean =     520.950948384567
             stat err =       0.000544979450
             autocorr =       1.363494233738
   target nu stat err =       0.000544979450
   target dn stat err =       0.002948921395
      target stat err =       0.002525663810
              std dev =       0.660037287938
             le_variance =       0.435649221468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435731560597
                                         uncertainty =       0.002456608322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435731560597
                                         uncertainty =       0.002456608322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466716995
  error estimate for blocks of size 2^( 2) =       0.000492138341
  error estimate for blocks of size 2^( 3) =       0.000515557394
  error estimate for blocks of size 2^( 4) =       0.000532885319
  error estimate for blocks of size 2^( 5) =       0.000543499146
  error estimate for blocks of size 2^( 6) =       0.000550033734
  error estimate for blocks of size 2^( 7) =       0.000553498782

      target function =      -0.747534423026
              le_mean =     -22.814547145898
             les_mean =     520.950923328414
             stat err =       0.000544979245
             autocorr =       1.363492318221
   target nu stat err =       0.000544979245
   target dn stat err =       0.002946779668
      target stat err =       0.002524072906
              std dev =       0.660037503741
             le_variance =       0.435649506344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435731812008
                                         uncertainty =       0.002456551450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435731812008
                                         uncertainty =       0.002456551450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466717129
  error estimate for blocks of size 2^( 2) =       0.000492138376
  error estimate for blocks of size 2^( 3) =       0.000515557323
  error estimate for blocks of size 2^( 4) =       0.000532885160
  error estimate for blocks of size 2^( 5) =       0.000543498949
  error estimate for blocks of size 2^( 6) =       0.000550033542
  error estimate for blocks of size 2^( 7) =       0.000553498613

      target function =      -0.747549233142
              le_mean =     -22.814547149841
             les_mean =     520.950905706231
             stat err =       0.000544979066
             autocorr =       1.363490638696
   target nu stat err =       0.000544979066
   target dn stat err =       0.002945350292
      target stat err =       0.002523016227
              std dev =       0.660037693526
             le_variance =       0.435649756875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747551010333        initial  <--
     3.3881e+01     3.3881e+02             9.7829e-06        -0.747513410894
     1.3553e+02     1.3553e+03             2.4472e-06        -0.747534423026
     5.4210e+02     5.4210e+03             6.1189e-07        -0.747549233142

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9916
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_01                 1.310029e-01 3 1  ON 0
ci_02                -3.101848e-02 3 1  ON 1
ci_03                -3.090382e-02 3 1  ON 2
ci_04                 2.770023e-02 3 1  ON 3
ci_05                -2.296874e-02 3 1  ON 4
ci_06                -2.269503e-02 3 1  ON 5
ci_07                 2.694468e-02 3 1  ON 6
ci_08                -6.320008e-03 3 1  ON 7
ci_09                -9.201152e-03 3 1  ON 8
ci_10                -9.213718e-03 3 1  ON 9
ci_11                 1.300209e-02 3 1  ON 10
ci_12                 7.594111e-03 3 1  ON 11
ci_13                 1.265464e-02 3 1  ON 12
ci_14                 1.311228e-02 3 1  ON 13
ci_15                 7.051862e-03 3 1  ON 14
ci_16                 7.294293e-03 3 1  ON 15
ci_17                -7.443312e-03 3 1  ON 16
ci_18                -7.143665e-03 3 1  ON 17
ci_19                 9.300095e-03 3 1  ON 18
ci_20                 6.808618e-03 3 1  ON 19
ci_21                 8.775584e-03 3 1  ON 20
ci_22                 8.779665e-03 3 1  ON 21
ci_23                 4.974435e-03 3 1  ON 22
ci_24                 4.385924e-03 3 1  ON 23
ci_25                 3.105374e-03 3 1  ON 24
ci_26                 3.136980e-03 3 1  ON 25
ci_27                 3.315355e-03 3 1  ON 26
ci_28                 2.484330e-03 3 1  ON 27
ci_29                 2.134149e-03 3 1  ON 28
ci_30                -1.572095e-03 3 1  ON 29
ci_31                -1.618546e-03 3 1  ON 30
ci_32                -1.311676e-03 3 1  ON 31
ci_33                -1.032110e-03 3 1  ON 32
ci_34                 1.442663e-03 3 1  ON 33
ci_35                 1.222334e-03 3 1  ON 34
ci_36                -1.104443e-03 3 1  ON 35
ci_37                -1.123884e-03 3 1  ON 36
ci_38                -5.260526e-04 3 1  ON 37
ci_39                -6.360543e-04 3 1  ON 38
ci_40                -1.672917e-03 3 1  ON 39
ci_41                -1.423462e-03 3 1  ON 40
ci_42                -1.202943e-03 3 1  ON 41
ci_43                -2.689214e-03 3 1  ON 42
ci_44                -1.775571e-03 3 1  ON 43
ci_45                -6.189502e-04 3 1  ON 44
ci_46                -5.379552e-04 3 1  ON 45
ci_47                 1.310644e-03 3 1  ON 46
ci_48                 8.906954e-04 3 1  ON 47
ci_49                -9.609896e-04 3 1  ON 48
ci_50                -7.407879e-04 3 1  ON 49
ci_51                 3.560746e-04 3 1  ON 50
ci_52                 3.679275e-04 3 1  ON 51
ci_53                -6.458936e-04 3 1  ON 52
ci_54                -8.935957e-04 3 1  ON 53
ci_55                -6.657247e-04 3 1  ON 54
ci_56                 1.880783e-03 3 1  ON 55
ci_57                 1.812660e-03 3 1  ON 56
ci_58                -8.285061e-04 3 1  ON 57
ci_59                -9.531328e-04 3 1  ON 58
ci_60                 6.359066e-04 3 1  ON 59
ci_61                 5.377852e-04 3 1  ON 60
ci_62                -2.917102e-04 3 1  ON 61
ci_63                -5.147064e-04 3 1  ON 62
ci_64                -3.973887e-04 3 1  ON 63
ci_65                -3.167157e-04 3 1  ON 64
ci_66                -6.899794e-04 3 1  ON 65
ci_67                -5.964216e-04 3 1  ON 66
ci_68                -6.735320e-04 3 1  ON 67
ci_69                -2.187776e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3822e+01 secs
  Total Execution time = 7.3223e+03 secs

=========================================================
  A new xml input file : FORM.s099.cont.xml
