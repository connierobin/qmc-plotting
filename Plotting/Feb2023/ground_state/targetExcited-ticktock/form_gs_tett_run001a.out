Rank =    0  Free Memory = 90159 MB
Rank =    1  Free Memory = 90159 MB
Rank =    2  Free Memory = 90158 MB
Rank =    3  Free Memory = 90158 MB
Rank =    4  Free Memory = 90158 MB
Rank =    5  Free Memory = 90158 MB
Rank =    6  Free Memory = 90158 MB
Rank =    7  Free Memory = 90158 MB
Rank =    8  Free Memory = 90158 MB
Rank =    9  Free Memory = 90157 MB
Rank =   10  Free Memory = 90157 MB
Rank =   11  Free Memory = 90157 MB
Rank =   12  Free Memory = 90157 MB
Rank =   13  Free Memory = 90157 MB
Rank =   14  Free Memory = 90156 MB
Rank =   15  Free Memory = 90143 MB
Rank =   16  Free Memory = 90143 MB
Rank =   17  Free Memory = 90143 MB
Rank =   18  Free Memory = 90143 MB
Rank =   19  Free Memory = 90143 MB
Rank =   20  Free Memory = 90143 MB
Rank =   21  Free Memory = 90143 MB
Rank =   22  Free Memory = 90143 MB
Rank =   23  Free Memory = 90143 MB
Rank =   24  Free Memory = 90143 MB
Rank =   25  Free Memory = 90143 MB
Rank =   26  Free Memory = 90143 MB
Rank =   27  Free Memory = 90143 MB
Rank =   28  Free Memory = 90143 MB
Rank =   29  Free Memory = 90143 MB
Rank =   30  Free Memory = 90143 MB
Rank =   31  Free Memory = 90143 MB
Rank =   32  Free Memory = 88838 MB
Rank =   33  Free Memory = 88838 MB
Rank =   34  Free Memory = 88838 MB
Rank =   35  Free Memory = 88838 MB
Rank =   36  Free Memory = 88838 MB
Rank =   37  Free Memory = 88838 MB
Rank =   38  Free Memory = 88838 MB
Rank =   39  Free Memory = 88838 MB
Rank =   40  Free Memory = 88838 MB
Rank =   41  Free Memory = 88838 MB
Rank =   42  Free Memory = 88838 MB
Rank =   43  Free Memory = 88838 MB
Rank =   44  Free Memory = 88838 MB
Rank =   45  Free Memory = 88838 MB
Rank =   46  Free Memory = 88838 MB
Rank =   47  Free Memory = 88838 MB
Rank =   48  Free Memory = 88838 MB
Rank =   49  Free Memory = 88838 MB
Rank =   50  Free Memory = 88838 MB
Rank =   51  Free Memory = 88838 MB
Rank =   52  Free Memory = 88838 MB
Rank =   53  Free Memory = 88838 MB
Rank =   54  Free Memory = 88838 MB
Rank =   55  Free Memory = 88838 MB
Rank =   56  Free Memory = 88838 MB
Rank =   57  Free Memory = 88838 MB
Rank =   58  Free Memory = 88838 MB
Rank =   59  Free Memory = 88837 MB
Rank =   60  Free Memory = 88837 MB
Rank =   61  Free Memory = 88837 MB
Rank =   62  Free Memory = 88837 MB
Rank =   63  Free Memory = 88837 MB
Rank =   64  Free Memory = 89832 MB
Rank =   65  Free Memory = 89832 MB
Rank =   66  Free Memory = 89832 MB
Rank =   67  Free Memory = 89832 MB
Rank =   68  Free Memory = 89832 MB
Rank =   69  Free Memory = 89832 MB
Rank =   70  Free Memory = 89832 MB
Rank =   71  Free Memory = 89832 MB
Rank =   72  Free Memory = 89832 MB
Rank =   73  Free Memory = 89832 MB
Rank =   74  Free Memory = 89832 MB
Rank =   75  Free Memory = 89832 MB
Rank =   76  Free Memory = 89832 MB
Rank =   77  Free Memory = 89832 MB
Rank =   78  Free Memory = 89832 MB
Rank =   79  Free Memory = 89832 MB
Rank =   80  Free Memory = 89832 MB
Rank =   81  Free Memory = 89832 MB
Rank =   82  Free Memory = 89832 MB
Rank =   83  Free Memory = 89832 MB
Rank =   84  Free Memory = 89832 MB
Rank =   85  Free Memory = 89832 MB
Rank =   86  Free Memory = 89832 MB
Rank =   87  Free Memory = 89832 MB
Rank =   88  Free Memory = 89832 MB
Rank =   89  Free Memory = 89832 MB
Rank =   90  Free Memory = 89832 MB
Rank =   91  Free Memory = 89832 MB
Rank =   92  Free Memory = 89832 MB
Rank =   93  Free Memory = 89832 MB
Rank =   94  Free Memory = 89832 MB
Rank =   95  Free Memory = 89832 MB
Rank =   96  Free Memory = 88779 MB
Rank =   97  Free Memory = 88779 MB
Rank =   98  Free Memory = 88779 MB
Rank =   99  Free Memory = 88779 MB
Rank =  100  Free Memory = 88779 MB
Rank =  101  Free Memory = 88779 MB
Rank =  102  Free Memory = 88779 MB
Rank =  103  Free Memory = 88779 MB
Rank =  104  Free Memory = 88779 MB
Rank =  105  Free Memory = 88779 MB
Rank =  106  Free Memory = 88779 MB
Rank =  107  Free Memory = 88779 MB
Rank =  108  Free Memory = 88779 MB
Rank =  109  Free Memory = 88779 MB
Rank =  110  Free Memory = 88779 MB
Rank =  111  Free Memory = 88779 MB
Rank =  112  Free Memory = 88779 MB
Rank =  113  Free Memory = 88779 MB
Rank =  114  Free Memory = 88779 MB
Rank =  115  Free Memory = 88779 MB
Rank =  116  Free Memory = 88779 MB
Rank =  117  Free Memory = 88779 MB
Rank =  118  Free Memory = 88779 MB
Rank =  119  Free Memory = 88779 MB
Rank =  120  Free Memory = 88779 MB
Rank =  121  Free Memory = 88779 MB
Rank =  122  Free Memory = 88779 MB
Rank =  123  Free Memory = 88779 MB
Rank =  124  Free Memory = 88779 MB
Rank =  125  Free Memory = 88779 MB
Rank =  126  Free Memory = 88779 MB
Rank =  127  Free Memory = 88779 MB
  Input file(s): opt_form_gs_tett_run001a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_tett_run001a.xml

  Project = FORM
  date    = 2023-02-22 11:33:47 PST
  host    = n0047.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 539

  Range of prime numbers to use as seeds over processors and threads = 3911-4999


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.536032e-01    1         1 OFF
     uu_1                 8.197417e-02    1         1 OFF
     uu_2                -2.279515e-02    1         1 OFF
     uu_3                -7.836857e-02    1         1 OFF
     uu_4                -1.013427e-01    1         1 OFF
     uu_5                -1.044477e-01    1         1 OFF
     uu_6                -9.224414e-02    1         1 OFF
     uu_7                -6.062712e-02    1         1 OFF
     uu_8                -1.023404e-02    1         1 OFF
     uu_9                 4.851606e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.792217e-01    1         1 OFF
     ud_1                 1.041447e-01    1         1 OFF
     ud_2                -2.759756e-02    1         1 OFF
     ud_3                -9.201142e-02    1         1 OFF
     ud_4                -1.207933e-01    1         1 OFF
     ud_5                -1.273508e-01    1         1 OFF
     ud_6                -1.163455e-01    1         1 OFF
     ud_7                -8.399626e-02    1         1 OFF
     ud_8                -3.198393e-02    1         1 OFF
     ud_9                 3.386961e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -3.996214e-01    1         1 OFF
     eC_1                -2.494767e-01    1         1 OFF
     eC_2                 3.700011e-03    1         1 OFF
     eC_3                 1.573024e-01    1         1 OFF
     eC_4                 1.937498e-01    1         1 OFF
     eC_5                 1.904877e-01    1         1 OFF
     eC_6                 7.711846e-02    1         1 OFF
     eC_7                 2.034542e-02    1         1 OFF
     eC_8                 3.700966e-03    1         1 OFF
     eC_9                 1.944711e-03    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.797092e-01    1         1 OFF
     eO_1                -4.355440e-01    1         1 OFF
     eO_2                -2.455303e-02    1         1 OFF
     eO_3                 2.277127e-01    1         1 OFF
     eO_4                 3.261577e-01    1         1 OFF
     eO_5                 3.430617e-01    1         1 OFF
     eO_6                 2.378897e-01    1         1 OFF
     eO_7                 8.612036e-02    1         1 OFF
     eO_8                 2.385595e-03    1         1 OFF
     eO_9                 8.162181e-03    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -9.737895e-02    1         1 OFF
     eH1_1                -1.599916e-02    1         1 OFF
     eH1_2                 3.445961e-03    1         1 OFF
     eH1_3                -1.247711e-02    1         1 OFF
     eH1_4                 6.338141e-03    1         1 OFF
     eH1_5                 1.464916e-02    1         1 OFF
     eH1_6                 3.536630e-02    1         1 OFF
     eH1_7                 3.910225e-02    1         1 OFF
     eH1_8                 2.028485e-02    1         1 OFF
     eH1_9                 5.094825e-03    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -9.796051e-02    1         1 OFF
     eH2_1                -1.537428e-02    1         1 OFF
     eH2_2                 4.200477e-03    1         1 OFF
     eH2_3                -1.217164e-02    1         1 OFF
     eH2_4                 6.944154e-03    1         1 OFF
     eH2_5                 1.575404e-02    1         1 OFF
     eH2_6                 3.502549e-02    1         1 OFF
     eH2_7                 3.688055e-02    1         1 OFF
     eH2_8                 2.096512e-02    1         1 OFF
     eH2_9                 4.252178e-03    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.999797e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.6721e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8562
    reference variance = 0.32457
====================================================
  Execution time = 2.6832e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2808e+01
  VMC Evar = 5.2076e-01
  Total weights = 1.962955697e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503758969920
                                         uncertainty =       0.002192919847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503758969920
                                         uncertainty =       0.002192919847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501843417
  error estimate for blocks of size 2^( 2) =       0.000523576335
  error estimate for blocks of size 2^( 3) =       0.000543219418
  error estimate for blocks of size 2^( 4) =       0.000557795829
  error estimate for blocks of size 2^( 5) =       0.000567242818
  error estimate for blocks of size 2^( 6) =       0.000572306104
  error estimate for blocks of size 2^( 7) =       0.000575705871

      target function =      -0.692854580488
              le_mean =     -22.808313723411
             les_mean =     520.739935126850
             stat err =       0.000568262655
             autocorr =       1.282217703527
   target nu stat err =       0.000568262655
   target dn stat err =       0.003482601784
      target stat err =       0.002369364205
              std dev =       0.709713767190
             le_variance =       0.503693631339


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.280831372341e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.692861868566       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696105778460       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696645240768       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696726141859       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696747288444       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696758956335       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696762489876       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696762683381       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696762732191       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696762786115       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696762756988       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.696762784883       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 6.523037e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.692861868566       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.693775718107       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.693921367288       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.693942252442       residual = 5.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.693947481972       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.693950091814       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.693950812097       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.693950845835       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.693950854545       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.693950866172       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.693950860490       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.851638e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.692861868566       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.693097763318       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.693134883722       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.693140136755       residual = 4.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.693141435309       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.693142064210       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.693142233264       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.693142240837       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.693142242807       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.693142245587       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.693142244274       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.790133e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.345161 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1803e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01 1.624943e-01                 3 1 ON  0
ci_02 -5.760972e-02                3 1 ON  1
ci_03 -5.761991e-02                3 1 ON  2
ci_04 5.703086e-02                 3 1 ON  3
ci_05 -4.035782e-02                3 1 ON  4
ci_06 -4.035082e-02                3 1 ON  5
ci_07 3.056942e-02                 3 1 ON  6
ci_08 -1.851783e-02                3 1 ON  7
ci_09 -1.733186e-02                3 1 ON  8
ci_10 -1.730128e-02                3 1 ON  9
ci_11 1.623558e-02                 3 1 ON  10
ci_12 1.336672e-02                 3 1 ON  11
ci_13 1.271305e-02                 3 1 ON  12
ci_14 1.269927e-02                 3 1 ON  13
ci_15 1.235601e-02                 3 1 ON  14
ci_16 1.229161e-02                 3 1 ON  15
ci_17 -1.184763e-02                3 1 ON  16
ci_18 -1.192901e-02                3 1 ON  17
ci_19 1.167356e-02                 3 1 ON  18
ci_20 1.045321e-02                 3 1 ON  19
ci_21 9.903327e-03                 3 1 ON  20
ci_22 9.913018e-03                 3 1 ON  21
ci_23 6.751711e-03                 3 1 ON  22
ci_24 5.349721e-03                 3 1 ON  23
ci_25 5.137269e-03                 3 1 ON  24
ci_26 4.762720e-03                 3 1 ON  25
ci_27 4.797685e-03                 3 1 ON  26
ci_28 4.089787e-03                 3 1 ON  27
ci_29 4.192941e-03                 3 1 ON  28
ci_30 -3.686459e-03                3 1 ON  29
ci_31 -3.578151e-03                3 1 ON  30
ci_32 -3.449347e-03                3 1 ON  31
ci_33 -3.416097e-03                3 1 ON  32
ci_34 2.831402e-03                 3 1 ON  33
ci_35 2.797661e-03                 3 1 ON  34
ci_36 -2.579853e-03                3 1 ON  35
ci_37 -2.563297e-03                3 1 ON  36
ci_38 -2.117592e-03                3 1 ON  37
ci_39 -2.090543e-03                3 1 ON  38
ci_40 -2.037166e-03                3 1 ON  39
ci_41 -1.981223e-03                3 1 ON  40
ci_42 -2.059549e-03                3 1 ON  41
ci_43 -2.011370e-03                3 1 ON  42
ci_44 -2.004860e-03                3 1 ON  43
ci_45 -1.840710e-03                3 1 ON  44
ci_46 -1.839062e-03                3 1 ON  45
ci_47 -1.749895e-03                3 1 ON  46
ci_48 -1.800594e-03                3 1 ON  47
ci_49 -1.746621e-03                3 1 ON  48
ci_50 -1.698033e-03                3 1 ON  49
ci_51 1.670474e-03                 3 1 ON  50
ci_52 1.625519e-03                 3 1 ON  51
ci_53 -1.486242e-03                3 1 ON  52
ci_54 -1.453781e-03                3 1 ON  53
ci_55 -1.487589e-03                3 1 ON  54
ci_56 1.424551e-03                 3 1 ON  55
ci_57 1.362600e-03                 3 1 ON  56
ci_58 -1.255550e-03                3 1 ON  57
ci_59 -1.260645e-03                3 1 ON  58
ci_60 1.139060e-03                 3 1 ON  59
ci_61 1.158609e-03                 3 1 ON  60
ci_62 -1.123350e-03                3 1 ON  61
ci_63 -1.099131e-03                3 1 ON  62
ci_64 -1.051051e-03                3 1 ON  63
ci_65 -1.068041e-03                3 1 ON  64
ci_66 -9.932081e-04                3 1 ON  65
ci_67 -1.018443e-03                3 1 ON  66
ci_68 9.344482e-04                 3 1 ON  67
ci_69 9.463974e-04                 3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8014
    reference variance = 0.316659
====================================================
  Execution time = 2.7651e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2810e+01
  VMC Evar = 5.1627e-01
  Total weights = 1.9630e+06
  Execution time = 3.5922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504761321619
                                         uncertainty =       0.002947632275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504761321619
                                         uncertainty =       0.002947632275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502329762
  error estimate for blocks of size 2^( 2) =       0.000523747538
  error estimate for blocks of size 2^( 3) =       0.000543537561
  error estimate for blocks of size 2^( 4) =       0.000558772415
  error estimate for blocks of size 2^( 5) =       0.000569064951
  error estimate for blocks of size 2^( 6) =       0.000577248968
  error estimate for blocks of size 2^( 7) =       0.000581577979

      target function =      -0.683818128397
              le_mean =     -22.810009631476
             les_mean =     520.830983858766
             stat err =       0.000571666078
             autocorr =       1.295111098706
   target nu stat err =       0.000571666078
   target dn stat err =       0.011683197835
      target stat err =       0.007574249319
              std dev =       0.710401562400
             le_variance =       0.504670379860

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.284051
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495217177620
                                         uncertainty =       0.003046292479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495217177620
                                         uncertainty =       0.003046292479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497555805
  error estimate for blocks of size 2^( 2) =       0.000518659528
  error estimate for blocks of size 2^( 3) =       0.000538232454
  error estimate for blocks of size 2^( 4) =       0.000553394732
  error estimate for blocks of size 2^( 5) =       0.000563541330
  error estimate for blocks of size 2^( 6) =       0.000571736966
  error estimate for blocks of size 2^( 7) =       0.000576198076

      target function =      -0.636368134906
              le_mean =     -22.810189448814
             les_mean =     520.911700213677
             stat err =       0.000566217776
             autocorr =       1.295040660540
   target nu stat err =       0.000566217776
   target dn stat err =       0.085397009977
      target stat err =       0.048105999394
              std dev =       0.703650167283
             le_variance =       0.495123557917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497905700221
                                         uncertainty =       0.002684056668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497905700221
                                         uncertainty =       0.002684056668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498907386
  error estimate for blocks of size 2^( 2) =       0.000520148417
  error estimate for blocks of size 2^( 3) =       0.000539824333
  error estimate for blocks of size 2^( 4) =       0.000555026751
  error estimate for blocks of size 2^( 5) =       0.000565301734
  error estimate for blocks of size 2^( 6) =       0.000573507692
  error estimate for blocks of size 2^( 7) =       0.000577813754

      target function =      -0.696978483458
              le_mean =     -22.810017300597
             les_mean =     520.811483441604
             stat err =       0.000567912483
             autocorr =       1.295755206102
   target nu stat err =       0.000567912483
   target dn stat err =       0.003185745793
      target stat err =       0.002208784604
              std dev =       0.705561591394
             le_variance =       0.497817159250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503769220447
                                         uncertainty =       0.002903161252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503769220447
                                         uncertainty =       0.002903161252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501835990
  error estimate for blocks of size 2^( 2) =       0.000523228016
  error estimate for blocks of size 2^( 3) =       0.000542991956
  error estimate for blocks of size 2^( 4) =       0.000558221407
  error estimate for blocks of size 2^( 5) =       0.000568506669
  error estimate for blocks of size 2^( 6) =       0.000576692950
  error estimate for blocks of size 2^( 7) =       0.000581003790

      target function =      -0.685105396044
              le_mean =     -22.809997790076
             les_mean =     520.828534693061
             stat err =       0.000571106204
             autocorr =       1.295120408338
   target nu stat err =       0.000571106204
   target dn stat err =       0.007342105954
      target stat err =       0.004795846367
              std dev =       0.709703263248
             le_variance =       0.503678721865


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.683818128397        initial
     2.5000e-01     2.5000e+00             6.5230e-03        -0.636368134906
     1.0000e+00     1.0000e+01             1.8516e-03        -0.696978483458  <--
     4.0000e+00     4.0000e+01             4.7901e-04        -0.685105396044

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.5663e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01                 1.624943e-01 3 1  ON 0
ci_02                -5.760972e-02 3 1  ON 1
ci_03                -5.761991e-02 3 1  ON 2
ci_04                 5.703086e-02 3 1  ON 3
ci_05                -4.035782e-02 3 1  ON 4
ci_06                -4.035082e-02 3 1  ON 5
ci_07                 3.056942e-02 3 1  ON 6
ci_08                -1.851783e-02 3 1  ON 7
ci_09                -1.733186e-02 3 1  ON 8
ci_10                -1.730128e-02 3 1  ON 9
ci_11                 1.623558e-02 3 1  ON 10
ci_12                 1.336672e-02 3 1  ON 11
ci_13                 1.271305e-02 3 1  ON 12
ci_14                 1.269927e-02 3 1  ON 13
ci_15                 1.235601e-02 3 1  ON 14
ci_16                 1.229161e-02 3 1  ON 15
ci_17                -1.184763e-02 3 1  ON 16
ci_18                -1.192901e-02 3 1  ON 17
ci_19                 1.167356e-02 3 1  ON 18
ci_20                 1.045321e-02 3 1  ON 19
ci_21                 9.903327e-03 3 1  ON 20
ci_22                 9.913018e-03 3 1  ON 21
ci_23                 6.751711e-03 3 1  ON 22
ci_24                 5.349721e-03 3 1  ON 23
ci_25                 5.137269e-03 3 1  ON 24
ci_26                 4.762720e-03 3 1  ON 25
ci_27                 4.797685e-03 3 1  ON 26
ci_28                 4.089787e-03 3 1  ON 27
ci_29                 4.192941e-03 3 1  ON 28
ci_30                -3.686459e-03 3 1  ON 29
ci_31                -3.578151e-03 3 1  ON 30
ci_32                -3.449347e-03 3 1  ON 31
ci_33                -3.416097e-03 3 1  ON 32
ci_34                 2.831402e-03 3 1  ON 33
ci_35                 2.797661e-03 3 1  ON 34
ci_36                -2.579853e-03 3 1  ON 35
ci_37                -2.563297e-03 3 1  ON 36
ci_38                -2.117592e-03 3 1  ON 37
ci_39                -2.090543e-03 3 1  ON 38
ci_40                -2.037166e-03 3 1  ON 39
ci_41                -1.981223e-03 3 1  ON 40
ci_42                -2.059549e-03 3 1  ON 41
ci_43                -2.011370e-03 3 1  ON 42
ci_44                -2.004860e-03 3 1  ON 43
ci_45                -1.840710e-03 3 1  ON 44
ci_46                -1.839062e-03 3 1  ON 45
ci_47                -1.749895e-03 3 1  ON 46
ci_48                -1.800594e-03 3 1  ON 47
ci_49                -1.746621e-03 3 1  ON 48
ci_50                -1.698033e-03 3 1  ON 49
ci_51                 1.670474e-03 3 1  ON 50
ci_52                 1.625519e-03 3 1  ON 51
ci_53                -1.486242e-03 3 1  ON 52
ci_54                -1.453781e-03 3 1  ON 53
ci_55                -1.487589e-03 3 1  ON 54
ci_56                 1.424551e-03 3 1  ON 55
ci_57                 1.362600e-03 3 1  ON 56
ci_58                -1.255550e-03 3 1  ON 57
ci_59                -1.260645e-03 3 1  ON 58
ci_60                 1.139060e-03 3 1  ON 59
ci_61                 1.158609e-03 3 1  ON 60
ci_62                -1.123350e-03 3 1  ON 61
ci_63                -1.099131e-03 3 1  ON 62
ci_64                -1.051051e-03 3 1  ON 63
ci_65                -1.068041e-03 3 1  ON 64
ci_66                -9.932081e-04 3 1  ON 65
ci_67                -1.018443e-03 3 1  ON 66
ci_68                 9.344482e-04 3 1  ON 67
ci_69                 9.463974e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7474e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2829e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6518
    reference variance = 0.497063
====================================================
  Execution time = 2.5967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1986e-01
  Total weights = 1.963197765e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503707129429
                                         uncertainty =       0.003752888824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503707129429
                                         uncertainty =       0.003752888824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501827152
  error estimate for blocks of size 2^( 2) =       0.000522924704
  error estimate for blocks of size 2^( 3) =       0.000542707394
  error estimate for blocks of size 2^( 4) =       0.000557379192
  error estimate for blocks of size 2^( 5) =       0.000566387365
  error estimate for blocks of size 2^( 6) =       0.000571068173
  error estimate for blocks of size 2^( 7) =       0.000572681362

      target function =      -0.693453809577
              le_mean =     -22.810681254469
             les_mean =     520.847038427538
             stat err =       0.000566879023
             autocorr =       1.276064016122
   target nu stat err =       0.000566879023
   target dn stat err =       0.004724746581
      target stat err =       0.003191285532
              std dev =       0.709690763807
             le_variance =       0.503660980232


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281068125447e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.693467621719       residual = 9.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696093419919       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696622909710       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696705199136       residual = 5.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696727358142       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696734380500       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696737240333       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696737621028       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696737816327       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696737797785       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696737802331       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.716690e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.693467621719       residual = 9.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.694208727565       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.694351672950       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.694372968140       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.694378328902       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.694379870317       residual = 8.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.694380466233       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.694380538737       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.694380580378       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.694380575747       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.694380576594       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.623207e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.693467621719       residual = 9.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.693659037720       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.693695470491       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.693700831030       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.693702153466       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.693702523034       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.693702664023       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.693702680722       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.693702690644       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.693702689498       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.693702689692       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.199678e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.349288 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0590e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.609779e-01 3 1  ON 0
ci_02                -5.619062e-02 3 1  ON 1
ci_03                -5.623001e-02 3 1  ON 2
ci_04                 5.540766e-02 3 1  ON 3
ci_05                -3.943393e-02 3 1  ON 4
ci_06                -3.934903e-02 3 1  ON 5
ci_07                 3.039096e-02 3 1  ON 6
ci_08                -1.787948e-02 3 1  ON 7
ci_09                -1.687958e-02 3 1  ON 8
ci_10                -1.691755e-02 3 1  ON 9
ci_11                 1.605857e-02 3 1  ON 10
ci_12                 1.304674e-02 3 1  ON 11
ci_13                 1.274624e-02 3 1  ON 12
ci_14                 1.273881e-02 3 1  ON 13
ci_15                 1.206634e-02 3 1  ON 14
ci_16                 1.202460e-02 3 1  ON 15
ci_17                -1.163013e-02 3 1  ON 16
ci_18                -1.180619e-02 3 1  ON 17
ci_19                 1.151376e-02 3 1  ON 18
ci_20                 1.023124e-02 3 1  ON 19
ci_21                 9.918502e-03 3 1  ON 20
ci_22                 9.842113e-03 3 1  ON 21
ci_23                 6.693833e-03 3 1  ON 22
ci_24                 5.313152e-03 3 1  ON 23
ci_25                 5.052586e-03 3 1  ON 24
ci_26                 4.652861e-03 3 1  ON 25
ci_27                 4.748838e-03 3 1  ON 26
ci_28                 4.033698e-03 3 1  ON 27
ci_29                 4.013394e-03 3 1  ON 28
ci_30                -3.552808e-03 3 1  ON 29
ci_31                -3.501047e-03 3 1  ON 30
ci_32                -3.357033e-03 3 1  ON 31
ci_33                -3.264575e-03 3 1  ON 32
ci_34                 2.741138e-03 3 1  ON 33
ci_35                 2.712180e-03 3 1  ON 34
ci_36                -2.499300e-03 3 1  ON 35
ci_37                -2.444316e-03 3 1  ON 36
ci_38                -2.059753e-03 3 1  ON 37
ci_39                -2.002919e-03 3 1  ON 38
ci_40                -1.990573e-03 3 1  ON 39
ci_41                -1.917720e-03 3 1  ON 40
ci_42                -2.038374e-03 3 1  ON 41
ci_43                -2.047251e-03 3 1  ON 42
ci_44                -1.984727e-03 3 1  ON 43
ci_45                -1.810941e-03 3 1  ON 44
ci_46                -1.792000e-03 3 1  ON 45
ci_47                -1.693952e-03 3 1  ON 46
ci_48                -1.710133e-03 3 1  ON 47
ci_49                -1.723255e-03 3 1  ON 48
ci_50                -1.638265e-03 3 1  ON 49
ci_51                 1.609715e-03 3 1  ON 50
ci_52                 1.603340e-03 3 1  ON 51
ci_53                -1.441137e-03 3 1  ON 52
ci_54                -1.412726e-03 3 1  ON 53
ci_55                -1.446708e-03 3 1  ON 54
ci_56                 1.405298e-03 3 1  ON 55
ci_57                 1.379540e-03 3 1  ON 56
ci_58                -1.243729e-03 3 1  ON 57
ci_59                -1.318805e-03 3 1  ON 58
ci_60                 1.086738e-03 3 1  ON 59
ci_61                 1.173309e-03 3 1  ON 60
ci_62                -1.140478e-03 3 1  ON 61
ci_63                -1.066095e-03 3 1  ON 62
ci_64                -1.025396e-03 3 1  ON 63
ci_65                -1.061459e-03 3 1  ON 64
ci_66                -1.024632e-03 3 1  ON 65
ci_67                -9.666261e-04 3 1  ON 66
ci_68                 8.281155e-04 3 1  ON 67
ci_69                 8.350033e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8286
    reference variance = 0.513589
====================================================
  Execution time = 2.5334e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2810e+01
  VMC Evar = 5.2291e-01
  Total weights = 1.9632e+06
  Execution time = 3.5987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504380801405
                                         uncertainty =       0.003849255671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504380801405
                                         uncertainty =       0.003849255671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502209764
  error estimate for blocks of size 2^( 2) =       0.000523033475
  error estimate for blocks of size 2^( 3) =       0.000543605022
  error estimate for blocks of size 2^( 4) =       0.000558195326
  error estimate for blocks of size 2^( 5) =       0.000566793525
  error estimate for blocks of size 2^( 6) =       0.000570715972
  error estimate for blocks of size 2^( 7) =       0.000573157518

      target function =      -0.681620209410
              le_mean =     -22.810166308962
             les_mean =     520.841564256280
             stat err =       0.000567215585
             autocorr =       1.275633766723
   target nu stat err =       0.000567215585
   target dn stat err =       0.010492480713
      target stat err =       0.006763878100
              std dev =       0.710231859493
             le_variance =       0.504429294239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497405962620
                                         uncertainty =       0.006319933190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497405962620
                                         uncertainty =       0.006319933190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498716148
  error estimate for blocks of size 2^( 2) =       0.000519246759
  error estimate for blocks of size 2^( 3) =       0.000539556852
  error estimate for blocks of size 2^( 4) =       0.000554072491
  error estimate for blocks of size 2^( 5) =       0.000562555835
  error estimate for blocks of size 2^( 6) =       0.000566419387
  error estimate for blocks of size 2^( 7) =       0.000568497518

      target function =      -0.686732321289
              le_mean =     -22.810312204640
             les_mean =     520.840276096879
             stat err =       0.000562886308
             autocorr =       1.273897564718
   target nu stat err =       0.000562886308
   target dn stat err =       0.012572682137
      target stat err =       0.008220568645
              std dev =       0.705291140695
             le_variance =       0.497435593143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499471465388
                                         uncertainty =       0.004772778734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499471465388
                                         uncertainty =       0.004772778734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499755006
  error estimate for blocks of size 2^( 2) =       0.000520415965
  error estimate for blocks of size 2^( 3) =       0.000540839522
  error estimate for blocks of size 2^( 4) =       0.000555382988
  error estimate for blocks of size 2^( 5) =       0.000563915932
  error estimate for blocks of size 2^( 6) =       0.000567805867
  error estimate for blocks of size 2^( 7) =       0.000570072751

      target function =      -0.685681663504
              le_mean =     -22.810174291177
             les_mean =     520.835643443108
             stat err =       0.000564294384
             autocorr =       1.274961734205
   target nu stat err =       0.000564294384
   target dn stat err =       0.010549518345
      target stat err =       0.006881322995
              std dev =       0.706760307434
             le_variance =       0.499510132164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503622892483
                                         uncertainty =       0.003928861303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503622892483
                                         uncertainty =       0.003928861303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501831737
  error estimate for blocks of size 2^( 2) =       0.000522634741
  error estimate for blocks of size 2^( 3) =       0.000543187029
  error estimate for blocks of size 2^( 4) =       0.000557770887
  error estimate for blocks of size 2^( 5) =       0.000566362202
  error estimate for blocks of size 2^( 6) =       0.000570283728
  error estimate for blocks of size 2^( 7) =       0.000572702185

      target function =      -0.688983405082
              le_mean =     -22.810156114993
             les_mean =     520.829819632599
             stat err =       0.000566779750
             autocorr =       1.275593813126
   target nu stat err =       0.000566779750
   target dn stat err =       0.007002656283
      target stat err =       0.004629118818
              std dev =       0.709697248259
             le_variance =       0.503670184186


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.681620209410        initial
     2.5000e-01     2.5000e+00             5.7167e-03        -0.686732321289
     1.0000e+00     1.0000e+01             1.6232e-03        -0.685681663504
     4.0000e+00     4.0000e+01             4.1997e-04        -0.688983405082  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.3402e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.621079e-01 3 1  ON 0
ci_02                -5.724420e-02 3 1  ON 1
ci_03                -5.726185e-02 3 1  ON 2
ci_04                 5.661089e-02 3 1  ON 3
ci_05                -4.011931e-02 3 1  ON 4
ci_06                -4.009229e-02 3 1  ON 5
ci_07                 3.052359e-02 3 1  ON 6
ci_08                -1.835279e-02 3 1  ON 7
ci_09                -1.721577e-02 3 1  ON 8
ci_10                -1.720276e-02 3 1  ON 9
ci_11                 1.618996e-02 3 1  ON 10
ci_12                 1.328413e-02 3 1  ON 11
ci_13                 1.272147e-02 3 1  ON 12
ci_14                 1.270922e-02 3 1  ON 13
ci_15                 1.228145e-02 3 1  ON 14
ci_16                 1.222289e-02 3 1  ON 15
ci_17                -1.179191e-02 3 1  ON 16
ci_18                -1.189768e-02 3 1  ON 17
ci_19                 1.163204e-02 3 1  ON 18
ci_20                 1.039582e-02 3 1  ON 19
ci_21                 9.907361e-03 3 1  ON 20
ci_22                 9.894931e-03 3 1  ON 21
ci_23                 6.736671e-03 3 1  ON 22
ci_24                 5.340346e-03 3 1  ON 23
ci_25                 5.115366e-03 3 1  ON 24
ci_26                 4.734362e-03 3 1  ON 25
ci_27                 4.785036e-03 3 1  ON 26
ci_28                 4.075545e-03 3 1  ON 27
ci_29                 4.146894e-03 3 1  ON 28
ci_30                -3.652361e-03 3 1  ON 29
ci_31                -3.558623e-03 3 1  ON 30
ci_32                -3.425254e-03 3 1  ON 31
ci_33                -3.376613e-03 3 1  ON 32
ci_34                 2.807756e-03 3 1  ON 33
ci_35                 2.775260e-03 3 1  ON 34
ci_36                -2.559069e-03 3 1  ON 35
ci_37                -2.532594e-03 3 1  ON 36
ci_38                -2.102679e-03 3 1  ON 37
ci_39                -2.067856e-03 3 1  ON 38
ci_40                -2.025139e-03 3 1  ON 39
ci_41                -1.964576e-03 3 1  ON 40
ci_42                -2.053804e-03 3 1  ON 41
ci_43                -2.020881e-03 3 1  ON 42
ci_44                -1.999883e-03 3 1  ON 43
ci_45                -1.833052e-03 3 1  ON 44
ci_46                -1.826966e-03 3 1  ON 45
ci_47                -1.735764e-03 3 1  ON 46
ci_48                -1.777559e-03 3 1  ON 47
ci_49                -1.740579e-03 3 1  ON 48
ci_50                -1.682567e-03 3 1  ON 49
ci_51                 1.654811e-03 3 1  ON 50
ci_52                 1.619833e-03 3 1  ON 51
ci_53                -1.474550e-03 3 1  ON 52
ci_54                -1.443188e-03 3 1  ON 53
ci_55                -1.477076e-03 3 1  ON 54
ci_56                 1.419505e-03 3 1  ON 55
ci_57                 1.366922e-03 3 1  ON 56
ci_58                -1.252476e-03 3 1  ON 57
ci_59                -1.275696e-03 3 1  ON 58
ci_60                 1.125846e-03 3 1  ON 59
ci_61                 1.162382e-03 3 1  ON 60
ci_62                -1.127876e-03 3 1  ON 61
ci_63                -1.090648e-03 3 1  ON 62
ci_64                -1.044484e-03 3 1  ON 63
ci_65                -1.066397e-03 3 1  ON 64
ci_66                -1.001350e-03 3 1  ON 65
ci_67                -1.005083e-03 3 1  ON 66
ci_68                 9.071043e-04 3 1  ON 67
ci_69                 9.176946e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4002e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2784e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.9215
    reference variance = 0.560408
====================================================
  Execution time = 2.5891e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -2.2809e+01
  VMC Evar = 5.2527e-01
  Total weights = 1.962870596e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503272046690
                                         uncertainty =       0.002442081122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503272046690
                                         uncertainty =       0.002442081122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501601479
  error estimate for blocks of size 2^( 2) =       0.000522900466
  error estimate for blocks of size 2^( 3) =       0.000543163621
  error estimate for blocks of size 2^( 4) =       0.000558984444
  error estimate for blocks of size 2^( 5) =       0.000568723060
  error estimate for blocks of size 2^( 6) =       0.000575753412
  error estimate for blocks of size 2^( 7) =       0.000578599224

      target function =      -0.689872311058
              le_mean =     -22.809120222566
             les_mean =     520.781237079446
             stat err =       0.000570515035
             autocorr =       1.293649338494
   target nu stat err =       0.000570515035
   target dn stat err =       0.004879547103
      target stat err =       0.003252943050
              std dev =       0.709371614997
             le_variance =       0.503208088164


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.280912022257e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.689886739345       residual = 9.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.690674482527       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.690796975221       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.690815395552       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.690820855993       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.690822496661       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.690822734491       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.690822716098       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.690822741330       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.690822733679       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.690822736606       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.696419e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.689886739345       residual = 9.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.690090070329       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.690121301345       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.690125931634       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.690127286784       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.690127680057       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.690127731512       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.690127726814       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.690127732885       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.690127731035       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.690127731758       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.387553e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.689886739345       residual = 9.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.689937987455       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.689945833654       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.689946992621       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.689947330684       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.689947427903       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.689947440266       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.689947439088       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.689947440590       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.689947440132       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.689947440312       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.106425e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.353405 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0495e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.617559e-01 3 1  ON 0
ci_02                -5.690408e-02 3 1  ON 1
ci_03                -5.690708e-02 3 1  ON 2
ci_04                 5.617214e-02 3 1  ON 3
ci_05                -3.986146e-02 3 1  ON 4
ci_06                -3.984919e-02 3 1  ON 5
ci_07                 3.049280e-02 3 1  ON 6
ci_08                -1.818358e-02 3 1  ON 7
ci_09                -1.710578e-02 3 1  ON 8
ci_10                -1.709926e-02 3 1  ON 9
ci_11                 1.615057e-02 3 1  ON 10
ci_12                 1.319090e-02 3 1  ON 11
ci_13                 1.273625e-02 3 1  ON 12
ci_14                 1.272054e-02 3 1  ON 13
ci_15                 1.221067e-02 3 1  ON 14
ci_16                 1.215056e-02 3 1  ON 15
ci_17                -1.172186e-02 3 1  ON 16
ci_18                -1.183365e-02 3 1  ON 17
ci_19                 1.158935e-02 3 1  ON 18
ci_20                 1.036423e-02 3 1  ON 19
ci_21                 9.892293e-03 3 1  ON 20
ci_22                 9.886445e-03 3 1  ON 21
ci_23                 6.710872e-03 3 1  ON 22
ci_24                 5.317557e-03 3 1  ON 23
ci_25                 5.095840e-03 3 1  ON 24
ci_26                 4.709819e-03 3 1  ON 25
ci_27                 4.769476e-03 3 1  ON 26
ci_28                 4.047091e-03 3 1  ON 27
ci_29                 4.128609e-03 3 1  ON 28
ci_30                -3.631145e-03 3 1  ON 29
ci_31                -3.542520e-03 3 1  ON 30
ci_32                -3.386045e-03 3 1  ON 31
ci_33                -3.350764e-03 3 1  ON 32
ci_34                 2.769171e-03 3 1  ON 33
ci_35                 2.740553e-03 3 1  ON 34
ci_36                -2.553882e-03 3 1  ON 35
ci_37                -2.496573e-03 3 1  ON 36
ci_38                -2.085367e-03 3 1  ON 37
ci_39                -2.051226e-03 3 1  ON 38
ci_40                -2.020237e-03 3 1  ON 39
ci_41                -1.946473e-03 3 1  ON 40
ci_42                -2.036043e-03 3 1  ON 41
ci_43                -2.024566e-03 3 1  ON 42
ci_44                -2.002382e-03 3 1  ON 43
ci_45                -1.821400e-03 3 1  ON 44
ci_46                -1.815297e-03 3 1  ON 45
ci_47                -1.720659e-03 3 1  ON 46
ci_48                -1.733091e-03 3 1  ON 47
ci_49                -1.736506e-03 3 1  ON 48
ci_50                -1.671149e-03 3 1  ON 49
ci_51                 1.639408e-03 3 1  ON 50
ci_52                 1.597332e-03 3 1  ON 51
ci_53                -1.476645e-03 3 1  ON 52
ci_54                -1.428844e-03 3 1  ON 53
ci_55                -1.461114e-03 3 1  ON 54
ci_56                 1.419401e-03 3 1  ON 55
ci_57                 1.365686e-03 3 1  ON 56
ci_58                -1.255547e-03 3 1  ON 57
ci_59                -1.279305e-03 3 1  ON 58
ci_60                 1.166245e-03 3 1  ON 59
ci_61                 1.171178e-03 3 1  ON 60
ci_62                -1.124745e-03 3 1  ON 61
ci_63                -1.094725e-03 3 1  ON 62
ci_64                -1.036233e-03 3 1  ON 63
ci_65                -1.059060e-03 3 1  ON 64
ci_66                -9.953006e-04 3 1  ON 65
ci_67                -1.003666e-03 3 1  ON 66
ci_68                 8.858267e-04 3 1  ON 67
ci_69                 8.827101e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8493
    reference variance = 0.524047
====================================================
  Execution time = 2.5301e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.2452e-01
  Total weights = 1.9632e+06
  Execution time = 3.6020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504228598318
                                         uncertainty =       0.002425124686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504228598318
                                         uncertainty =       0.002425124686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502079439
  error estimate for blocks of size 2^( 2) =       0.000523123584
  error estimate for blocks of size 2^( 3) =       0.000543237843
  error estimate for blocks of size 2^( 4) =       0.000558224615
  error estimate for blocks of size 2^( 5) =       0.000567753120
  error estimate for blocks of size 2^( 6) =       0.000572665567
  error estimate for blocks of size 2^( 7) =       0.000575667277

      target function =      -0.688933989107
              le_mean =     -22.810676782358
             les_mean =     520.853670240771
             stat err =       0.000568577645
             autocorr =       1.282433007805
   target nu stat err =       0.000568577645
   target dn stat err =       0.004731028277
      target stat err =       0.003154746307
              std dev =       0.710047551952
             le_variance =       0.504167526033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501348341172
                                         uncertainty =       0.002424013229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501348341172
                                         uncertainty =       0.002424013229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500641876
  error estimate for blocks of size 2^( 2) =       0.000521600784
  error estimate for blocks of size 2^( 3) =       0.000541641474
  error estimate for blocks of size 2^( 4) =       0.000556612977
  error estimate for blocks of size 2^( 5) =       0.000566110996
  error estimate for blocks of size 2^( 6) =       0.000571035566
  error estimate for blocks of size 2^( 7) =       0.000574079072

      target function =      -0.689191358775
              le_mean =     -22.810674337694
             les_mean =     520.853152815090
             stat err =       0.000566959653
             autocorr =       1.282478107289
   target nu stat err =       0.000566959653
   target dn stat err =       0.006112594606
      target stat err =       0.004054635110
              std dev =       0.708014531469
             le_variance =       0.501284576772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502692084715
                                         uncertainty =       0.002423250013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502692084715
                                         uncertainty =       0.002423250013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501313098
  error estimate for blocks of size 2^( 2) =       0.000522312492
  error estimate for blocks of size 2^( 3) =       0.000542388285
  error estimate for blocks of size 2^( 4) =       0.000557367039
  error estimate for blocks of size 2^( 5) =       0.000566880182
  error estimate for blocks of size 2^( 6) =       0.000571798763
  error estimate for blocks of size 2^( 7) =       0.000574821213

      target function =      -0.690627348972
              le_mean =     -22.810670769256
             les_mean =     520.850820127044
             stat err =       0.000567716799
             autocorr =       1.282464602847
   target nu stat err =       0.000567716799
   target dn stat err =       0.005178397186
      target stat err =       0.003461221975
              std dev =       0.708963782585
             le_variance =       0.502629645017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504029036017
                                         uncertainty =       0.002424749046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504029036017
                                         uncertainty =       0.002424749046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501979977
  error estimate for blocks of size 2^( 2) =       0.000523018412
  error estimate for blocks of size 2^( 3) =       0.000543127819
  error estimate for blocks of size 2^( 4) =       0.000558113913
  error estimate for blocks of size 2^( 5) =       0.000567640520
  error estimate for blocks of size 2^( 6) =       0.000572553520
  error estimate for blocks of size 2^( 7) =       0.000575558054

      target function =      -0.689796130117
              le_mean =     -22.810675390555
             les_mean =     520.852295999366
             stat err =       0.000568466502
             autocorr =       1.282439740886
   target nu stat err =       0.000568466502
   target dn stat err =       0.004719762678
      target stat err =       0.003155197346
              std dev =       0.709906890898
             le_variance =       0.503967793744


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.688933989107        initial
     1.0000e+00     1.0000e+01             1.6964e-03        -0.689191358775
     4.0000e+00     4.0000e+01             4.3876e-04        -0.690627348972  <--
     1.6000e+01     1.6000e+02             1.1064e-04        -0.689796130117

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.3392e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.617559e-01 3 1  ON 0
ci_02                -5.690408e-02 3 1  ON 1
ci_03                -5.690708e-02 3 1  ON 2
ci_04                 5.617214e-02 3 1  ON 3
ci_05                -3.986146e-02 3 1  ON 4
ci_06                -3.984919e-02 3 1  ON 5
ci_07                 3.049280e-02 3 1  ON 6
ci_08                -1.818358e-02 3 1  ON 7
ci_09                -1.710578e-02 3 1  ON 8
ci_10                -1.709926e-02 3 1  ON 9
ci_11                 1.615057e-02 3 1  ON 10
ci_12                 1.319090e-02 3 1  ON 11
ci_13                 1.273625e-02 3 1  ON 12
ci_14                 1.272054e-02 3 1  ON 13
ci_15                 1.221067e-02 3 1  ON 14
ci_16                 1.215056e-02 3 1  ON 15
ci_17                -1.172186e-02 3 1  ON 16
ci_18                -1.183365e-02 3 1  ON 17
ci_19                 1.158935e-02 3 1  ON 18
ci_20                 1.036423e-02 3 1  ON 19
ci_21                 9.892293e-03 3 1  ON 20
ci_22                 9.886445e-03 3 1  ON 21
ci_23                 6.710872e-03 3 1  ON 22
ci_24                 5.317557e-03 3 1  ON 23
ci_25                 5.095840e-03 3 1  ON 24
ci_26                 4.709819e-03 3 1  ON 25
ci_27                 4.769476e-03 3 1  ON 26
ci_28                 4.047091e-03 3 1  ON 27
ci_29                 4.128609e-03 3 1  ON 28
ci_30                -3.631145e-03 3 1  ON 29
ci_31                -3.542520e-03 3 1  ON 30
ci_32                -3.386045e-03 3 1  ON 31
ci_33                -3.350764e-03 3 1  ON 32
ci_34                 2.769171e-03 3 1  ON 33
ci_35                 2.740553e-03 3 1  ON 34
ci_36                -2.553882e-03 3 1  ON 35
ci_37                -2.496573e-03 3 1  ON 36
ci_38                -2.085367e-03 3 1  ON 37
ci_39                -2.051226e-03 3 1  ON 38
ci_40                -2.020237e-03 3 1  ON 39
ci_41                -1.946473e-03 3 1  ON 40
ci_42                -2.036043e-03 3 1  ON 41
ci_43                -2.024566e-03 3 1  ON 42
ci_44                -2.002382e-03 3 1  ON 43
ci_45                -1.821400e-03 3 1  ON 44
ci_46                -1.815297e-03 3 1  ON 45
ci_47                -1.720659e-03 3 1  ON 46
ci_48                -1.733091e-03 3 1  ON 47
ci_49                -1.736506e-03 3 1  ON 48
ci_50                -1.671149e-03 3 1  ON 49
ci_51                 1.639408e-03 3 1  ON 50
ci_52                 1.597332e-03 3 1  ON 51
ci_53                -1.476645e-03 3 1  ON 52
ci_54                -1.428844e-03 3 1  ON 53
ci_55                -1.461114e-03 3 1  ON 54
ci_56                 1.419401e-03 3 1  ON 55
ci_57                 1.365686e-03 3 1  ON 56
ci_58                -1.255547e-03 3 1  ON 57
ci_59                -1.279305e-03 3 1  ON 58
ci_60                 1.166245e-03 3 1  ON 59
ci_61                 1.171178e-03 3 1  ON 60
ci_62                -1.124745e-03 3 1  ON 61
ci_63                -1.094725e-03 3 1  ON 62
ci_64                -1.036233e-03 3 1  ON 63
ci_65                -1.059060e-03 3 1  ON 64
ci_66                -9.953006e-04 3 1  ON 65
ci_67                -1.003666e-03 3 1  ON 66
ci_68                 8.858267e-04 3 1  ON 67
ci_69                 8.827101e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3893e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7621
    reference variance = 0.635094
====================================================
  Execution time = 2.5925e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5359e+04
  VMC Eavg = -2.2810e+01
  VMC Evar = 5.1585e-01
  Total weights = 1.963253159e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498449300249
                                         uncertainty =       0.002119528922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498449300249
                                         uncertainty =       0.002119528922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499270385
  error estimate for blocks of size 2^( 2) =       0.000520474868
  error estimate for blocks of size 2^( 3) =       0.000540173003
  error estimate for blocks of size 2^( 4) =       0.000555274431
  error estimate for blocks of size 2^( 5) =       0.000565519913
  error estimate for blocks of size 2^( 6) =       0.000569755337
  error estimate for blocks of size 2^( 7) =       0.000570980149

      target function =      -0.696135119759
              le_mean =     -22.810203998184
             les_mean =     520.821260537452
             stat err =       0.000565382457
             autocorr =       1.282369102320
   target nu stat err =       0.000565382457
   target dn stat err =       0.003023076566
      target stat err =       0.002098092106
              std dev =       0.706074950409
             le_variance =       0.498541835595


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281020399818e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696140620692       residual = 9.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696944111215       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.697071184090       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.697089352474       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.697094404535       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.697097056137       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.697097575002       residual = 9.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.697097670897       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.697097725790       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.697097745404       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.697097751506       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.659927e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696140620692       residual = 9.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696348110575       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696380511662       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696385085071       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696386342915       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696386985821       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696387106943       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696387129547       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696387142718       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696387147413       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696387148806       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.295324e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696140620692       residual = 9.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696192923192       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696201063469       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696202208616       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696202522668       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696202682073       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696202711808       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696202717373       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696202720631       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696202721791       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696202722131       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.083308e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.357699 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0510e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.614140e-01 3 1  ON 0
ci_02                -5.653569e-02 3 1  ON 1
ci_03                -5.654826e-02 3 1  ON 2
ci_04                 5.574261e-02 3 1  ON 3
ci_05                -3.960806e-02 3 1  ON 4
ci_06                -3.961399e-02 3 1  ON 5
ci_07                 3.043628e-02 3 1  ON 6
ci_08                -1.801400e-02 3 1  ON 7
ci_09                -1.701288e-02 3 1  ON 8
ci_10                -1.698598e-02 3 1  ON 9
ci_11                 1.610021e-02 3 1  ON 10
ci_12                 1.309740e-02 3 1  ON 11
ci_13                 1.271907e-02 3 1  ON 12
ci_14                 1.273496e-02 3 1  ON 13
ci_15                 1.212676e-02 3 1  ON 14
ci_16                 1.206917e-02 3 1  ON 15
ci_17                -1.165831e-02 3 1  ON 16
ci_18                -1.178247e-02 3 1  ON 17
ci_19                 1.156104e-02 3 1  ON 18
ci_20                 1.033544e-02 3 1  ON 19
ci_21                 9.884933e-03 3 1  ON 20
ci_22                 9.869941e-03 3 1  ON 21
ci_23                 6.698466e-03 3 1  ON 22
ci_24                 5.296723e-03 3 1  ON 23
ci_25                 5.089448e-03 3 1  ON 24
ci_26                 4.696017e-03 3 1  ON 25
ci_27                 4.747320e-03 3 1  ON 26
ci_28                 4.028293e-03 3 1  ON 27
ci_29                 4.111631e-03 3 1  ON 28
ci_30                -3.616767e-03 3 1  ON 29
ci_31                -3.523123e-03 3 1  ON 30
ci_32                -3.344918e-03 3 1  ON 31
ci_33                -3.317089e-03 3 1  ON 32
ci_34                 2.753606e-03 3 1  ON 33
ci_35                 2.712622e-03 3 1  ON 34
ci_36                -2.540231e-03 3 1  ON 35
ci_37                -2.479761e-03 3 1  ON 36
ci_38                -2.057389e-03 3 1  ON 37
ci_39                -2.033142e-03 3 1  ON 38
ci_40                -2.011421e-03 3 1  ON 39
ci_41                -1.936469e-03 3 1  ON 40
ci_42                -2.014776e-03 3 1  ON 41
ci_43                -2.022938e-03 3 1  ON 42
ci_44                -2.012103e-03 3 1  ON 43
ci_45                -1.806727e-03 3 1  ON 44
ci_46                -1.804716e-03 3 1  ON 45
ci_47                -1.693741e-03 3 1  ON 46
ci_48                -1.715943e-03 3 1  ON 47
ci_49                -1.718887e-03 3 1  ON 48
ci_50                -1.657547e-03 3 1  ON 49
ci_51                 1.626369e-03 3 1  ON 50
ci_52                 1.578113e-03 3 1  ON 51
ci_53                -1.468976e-03 3 1  ON 52
ci_54                -1.422433e-03 3 1  ON 53
ci_55                -1.438584e-03 3 1  ON 54
ci_56                 1.422780e-03 3 1  ON 55
ci_57                 1.362707e-03 3 1  ON 56
ci_58                -1.219950e-03 3 1  ON 57
ci_59                -1.273011e-03 3 1  ON 58
ci_60                 1.151774e-03 3 1  ON 59
ci_61                 1.165799e-03 3 1  ON 60
ci_62                -1.130265e-03 3 1  ON 61
ci_63                -1.086097e-03 3 1  ON 62
ci_64                -1.033152e-03 3 1  ON 63
ci_65                -1.048143e-03 3 1  ON 64
ci_66                -1.001089e-03 3 1  ON 65
ci_67                -1.004131e-03 3 1  ON 66
ci_68                 8.634366e-04 3 1  ON 67
ci_69                 8.577850e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8399
    reference variance = 0.382022
====================================================
  Execution time = 2.5210e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2810e+01
  VMC Evar = 5.1922e-01
  Total weights = 1.9628e+06
  Execution time = 3.6142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502474684676
                                         uncertainty =       0.002398350267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502474684676
                                         uncertainty =       0.002398350267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501190057
  error estimate for blocks of size 2^( 2) =       0.000522715499
  error estimate for blocks of size 2^( 3) =       0.000542696171
  error estimate for blocks of size 2^( 4) =       0.000558466559
  error estimate for blocks of size 2^( 5) =       0.000567584083
  error estimate for blocks of size 2^( 6) =       0.000571953125
  error estimate for blocks of size 2^( 7) =       0.000573155374

      target function =      -0.693063370478
              le_mean =     -22.810308781203
             les_mean =     520.830641270069
             stat err =       0.000567789785
             autocorr =       1.283424296883
   target nu stat err =       0.000567789785
   target dn stat err =       0.003529418458
      target stat err =       0.002407486078
              std dev =       0.708789776368
             le_variance =       0.502382947084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499542413019
                                         uncertainty =       0.002379556116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499542413019
                                         uncertainty =       0.002379556116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499725159
  error estimate for blocks of size 2^( 2) =       0.000521177349
  error estimate for blocks of size 2^( 3) =       0.000541102105
  error estimate for blocks of size 2^( 4) =       0.000556847229
  error estimate for blocks of size 2^( 5) =       0.000565975771
  error estimate for blocks of size 2^( 6) =       0.000570355904
  error estimate for blocks of size 2^( 7) =       0.000571553334

      target function =      -0.692540560411
              le_mean =     -22.810303864594
             les_mean =     520.831198565466
             stat err =       0.000566183059
             autocorr =       1.283663853994
   target nu stat err =       0.000566183059
   target dn stat err =       0.004307807897
      target stat err =       0.002909035271
              std dev =       0.706718097000
             le_variance =       0.499450468628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500914994334
                                         uncertainty =       0.002387668201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500914994334
                                         uncertainty =       0.002387668201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500411423
  error estimate for blocks of size 2^( 2) =       0.000521898582
  error estimate for blocks of size 2^( 3) =       0.000541850464
  error estimate for blocks of size 2^( 4) =       0.000557605735
  error estimate for blocks of size 2^( 5) =       0.000566727891
  error estimate for blocks of size 2^( 6) =       0.000571105252
  error estimate for blocks of size 2^( 7) =       0.000572307602

      target function =      -0.694293380230
              le_mean =     -22.810299977022
             les_mean =     520.828391621102
             stat err =       0.000566936620
             autocorr =       1.283555317668
   target nu stat err =       0.000566936620
   target dn stat err =       0.003534755975
      target stat err =       0.002419073911
              std dev =       0.707688621239
             le_variance =       0.500823184632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502272702696
                                         uncertainty =       0.002396850724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502272702696
                                         uncertainty =       0.002396850724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501089293
  error estimate for blocks of size 2^( 2) =       0.000522609715
  error estimate for blocks of size 2^( 3) =       0.000542586661
  error estimate for blocks of size 2^( 4) =       0.000558355161
  error estimate for blocks of size 2^( 5) =       0.000567473325
  error estimate for blocks of size 2^( 6) =       0.000571843649
  error estimate for blocks of size 2^( 7) =       0.000573046070

      target function =      -0.693417879447
              le_mean =     -22.810306963897
             les_mean =     520.830025130646
             stat err =       0.000567679551
             autocorr =       1.283442021397
   target nu stat err =       0.000567679551
   target dn stat err =       0.003522563231
      target stat err =       0.002405415118
              std dev =       0.708647274698
             le_variance =       0.502180959937


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.693063370478        initial
     1.0000e+00     1.0000e+01             1.6599e-03        -0.692540560411
     4.0000e+00     4.0000e+01             4.2953e-04        -0.694293380230  <--
     1.6000e+01     1.6000e+02             1.0833e-04        -0.693417879447

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.3349e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.614140e-01 3 1  ON 0
ci_02                -5.653569e-02 3 1  ON 1
ci_03                -5.654826e-02 3 1  ON 2
ci_04                 5.574261e-02 3 1  ON 3
ci_05                -3.960806e-02 3 1  ON 4
ci_06                -3.961399e-02 3 1  ON 5
ci_07                 3.043628e-02 3 1  ON 6
ci_08                -1.801400e-02 3 1  ON 7
ci_09                -1.701288e-02 3 1  ON 8
ci_10                -1.698598e-02 3 1  ON 9
ci_11                 1.610021e-02 3 1  ON 10
ci_12                 1.309740e-02 3 1  ON 11
ci_13                 1.271907e-02 3 1  ON 12
ci_14                 1.273496e-02 3 1  ON 13
ci_15                 1.212676e-02 3 1  ON 14
ci_16                 1.206917e-02 3 1  ON 15
ci_17                -1.165831e-02 3 1  ON 16
ci_18                -1.178247e-02 3 1  ON 17
ci_19                 1.156104e-02 3 1  ON 18
ci_20                 1.033544e-02 3 1  ON 19
ci_21                 9.884933e-03 3 1  ON 20
ci_22                 9.869941e-03 3 1  ON 21
ci_23                 6.698466e-03 3 1  ON 22
ci_24                 5.296723e-03 3 1  ON 23
ci_25                 5.089448e-03 3 1  ON 24
ci_26                 4.696017e-03 3 1  ON 25
ci_27                 4.747320e-03 3 1  ON 26
ci_28                 4.028293e-03 3 1  ON 27
ci_29                 4.111631e-03 3 1  ON 28
ci_30                -3.616767e-03 3 1  ON 29
ci_31                -3.523123e-03 3 1  ON 30
ci_32                -3.344918e-03 3 1  ON 31
ci_33                -3.317089e-03 3 1  ON 32
ci_34                 2.753606e-03 3 1  ON 33
ci_35                 2.712622e-03 3 1  ON 34
ci_36                -2.540231e-03 3 1  ON 35
ci_37                -2.479761e-03 3 1  ON 36
ci_38                -2.057389e-03 3 1  ON 37
ci_39                -2.033142e-03 3 1  ON 38
ci_40                -2.011421e-03 3 1  ON 39
ci_41                -1.936469e-03 3 1  ON 40
ci_42                -2.014776e-03 3 1  ON 41
ci_43                -2.022938e-03 3 1  ON 42
ci_44                -2.012103e-03 3 1  ON 43
ci_45                -1.806727e-03 3 1  ON 44
ci_46                -1.804716e-03 3 1  ON 45
ci_47                -1.693741e-03 3 1  ON 46
ci_48                -1.715943e-03 3 1  ON 47
ci_49                -1.718887e-03 3 1  ON 48
ci_50                -1.657547e-03 3 1  ON 49
ci_51                 1.626369e-03 3 1  ON 50
ci_52                 1.578113e-03 3 1  ON 51
ci_53                -1.468976e-03 3 1  ON 52
ci_54                -1.422433e-03 3 1  ON 53
ci_55                -1.438584e-03 3 1  ON 54
ci_56                 1.422780e-03 3 1  ON 55
ci_57                 1.362707e-03 3 1  ON 56
ci_58                -1.219950e-03 3 1  ON 57
ci_59                -1.273011e-03 3 1  ON 58
ci_60                 1.151774e-03 3 1  ON 59
ci_61                 1.165799e-03 3 1  ON 60
ci_62                -1.130265e-03 3 1  ON 61
ci_63                -1.086097e-03 3 1  ON 62
ci_64                -1.033152e-03 3 1  ON 63
ci_65                -1.048143e-03 3 1  ON 64
ci_66                -1.001089e-03 3 1  ON 65
ci_67                -1.004131e-03 3 1  ON 66
ci_68                 8.634366e-04 3 1  ON 67
ci_69                 8.577850e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3865e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.9225
    reference variance = 0.500791
====================================================
  Execution time = 2.5901e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5322e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.2041e-01
  Total weights = 1.962983047e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499514213018
                                         uncertainty =       0.003120921051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499514213018
                                         uncertainty =       0.003120921051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499735410
  error estimate for blocks of size 2^( 2) =       0.000520889407
  error estimate for blocks of size 2^( 3) =       0.000541038425
  error estimate for blocks of size 2^( 4) =       0.000556203458
  error estimate for blocks of size 2^( 5) =       0.000566553053
  error estimate for blocks of size 2^( 6) =       0.000571369012
  error estimate for blocks of size 2^( 7) =       0.000574058750

      target function =      -0.693091271220
              le_mean =     -22.811221417080
             les_mean =     520.872231831311
             stat err =       0.000567046068
             autocorr =       1.287527280847
   target nu stat err =       0.000567046068
   target dn stat err =       0.004214963014
      target stat err =       0.002856772400
              std dev =       0.706732594452
             le_variance =       0.499470960061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281122141708e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.693102275574       residual = 9.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.693865452627       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.693990135162       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.694007288559       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.694011668916       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.694012776377       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.694013534983       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.694013565766       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.694013584248       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.694013589435       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.694013588777       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.579812e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.693102275574       residual = 9.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.693299288899       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.693331064754       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.693335378975       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.693336462251       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.693336728654       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.693336909087       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.693336916135       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.693336920421       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.693336921619       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.693336921464       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.086829e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.693102275574       residual = 9.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.693151932914       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.693159915108       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.693160995124       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.693161265111       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.693161331037       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.693161375555       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.693161377276       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.693161378327       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.693161378620       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.693161378582       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.030648e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.361801 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0532e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.610824e-01 3 1  ON 0
ci_02                -5.617723e-02 3 1  ON 1
ci_03                -5.619793e-02 3 1  ON 2
ci_04                 5.533392e-02 3 1  ON 3
ci_05                -3.936531e-02 3 1  ON 4
ci_06                -3.935529e-02 3 1  ON 5
ci_07                 3.040806e-02 3 1  ON 6
ci_08                -1.784989e-02 3 1  ON 7
ci_09                -1.692863e-02 3 1  ON 8
ci_10                -1.688790e-02 3 1  ON 9
ci_11                 1.603580e-02 3 1  ON 10
ci_12                 1.302956e-02 3 1  ON 11
ci_13                 1.270351e-02 3 1  ON 12
ci_14                 1.274887e-02 3 1  ON 13
ci_15                 1.206981e-02 3 1  ON 14
ci_16                 1.200061e-02 3 1  ON 15
ci_17                -1.159518e-02 3 1  ON 16
ci_18                -1.170533e-02 3 1  ON 17
ci_19                 1.153791e-02 3 1  ON 18
ci_20                 1.027732e-02 3 1  ON 19
ci_21                 9.875137e-03 3 1  ON 20
ci_22                 9.847739e-03 3 1  ON 21
ci_23                 6.674892e-03 3 1  ON 22
ci_24                 5.290667e-03 3 1  ON 23
ci_25                 5.075377e-03 3 1  ON 24
ci_26                 4.684577e-03 3 1  ON 25
ci_27                 4.729014e-03 3 1  ON 26
ci_28                 4.002020e-03 3 1  ON 27
ci_29                 4.090395e-03 3 1  ON 28
ci_30                -3.599315e-03 3 1  ON 29
ci_31                -3.489464e-03 3 1  ON 30
ci_32                -3.305252e-03 3 1  ON 31
ci_33                -3.296490e-03 3 1  ON 32
ci_34                 2.733497e-03 3 1  ON 33
ci_35                 2.699721e-03 3 1  ON 34
ci_36                -2.510555e-03 3 1  ON 35
ci_37                -2.463562e-03 3 1  ON 36
ci_38                -2.037644e-03 3 1  ON 37
ci_39                -2.013279e-03 3 1  ON 38
ci_40                -2.004997e-03 3 1  ON 39
ci_41                -1.908704e-03 3 1  ON 40
ci_42                -1.984110e-03 3 1  ON 41
ci_43                -2.042932e-03 3 1  ON 42
ci_44                -1.980472e-03 3 1  ON 43
ci_45                -1.783363e-03 3 1  ON 44
ci_46                -1.788144e-03 3 1  ON 45
ci_47                -1.663477e-03 3 1  ON 46
ci_48                -1.699550e-03 3 1  ON 47
ci_49                -1.713452e-03 3 1  ON 48
ci_50                -1.641211e-03 3 1  ON 49
ci_51                 1.603868e-03 3 1  ON 50
ci_52                 1.567210e-03 3 1  ON 51
ci_53                -1.457689e-03 3 1  ON 52
ci_54                -1.429896e-03 3 1  ON 53
ci_55                -1.434146e-03 3 1  ON 54
ci_56                 1.432608e-03 3 1  ON 55
ci_57                 1.371176e-03 3 1  ON 56
ci_58                -1.213881e-03 3 1  ON 57
ci_59                -1.268703e-03 3 1  ON 58
ci_60                 1.112790e-03 3 1  ON 59
ci_61                 1.156211e-03 3 1  ON 60
ci_62                -1.122989e-03 3 1  ON 61
ci_63                -1.087592e-03 3 1  ON 62
ci_64                -1.031013e-03 3 1  ON 63
ci_65                -1.038819e-03 3 1  ON 64
ci_66                -9.929155e-04 3 1  ON 65
ci_67                -9.735327e-04 3 1  ON 66
ci_68                 8.278406e-04 3 1  ON 67
ci_69                 8.356061e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8816
    reference variance = 0.94521
====================================================
  Execution time = 2.7270e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1646e-01
  Total weights = 1.9632e+06
  Execution time = 3.5746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498786529923
                                         uncertainty =       0.003406360928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498786529923
                                         uncertainty =       0.003406360928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499398142
  error estimate for blocks of size 2^( 2) =       0.000520139267
  error estimate for blocks of size 2^( 3) =       0.000539823726
  error estimate for blocks of size 2^( 4) =       0.000554388284
  error estimate for blocks of size 2^( 5) =       0.000564911161
  error estimate for blocks of size 2^( 6) =       0.000570182369
  error estimate for blocks of size 2^( 7) =       0.000572076167

      target function =      -0.695213604379
              le_mean =     -22.810737135216
             les_mean =     520.846953076442
             stat err =       0.000565389495
             autocorr =       1.281744984230
   target nu stat err =       0.000565389495
   target dn stat err =       0.004420214535
      target stat err =       0.003006688912
              std dev =       0.706255624748
             le_variance =       0.498797007488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505012761680
                                         uncertainty =       0.009602311503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505012761680
                                         uncertainty =       0.009602311503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502496482
  error estimate for blocks of size 2^( 2) =       0.000522975634
  error estimate for blocks of size 2^( 3) =       0.000542384494
  error estimate for blocks of size 2^( 4) =       0.000556746690
  error estimate for blocks of size 2^( 5) =       0.000567309955
  error estimate for blocks of size 2^( 6) =       0.000572630264
  error estimate for blocks of size 2^( 7) =       0.000574591937

      target function =      -0.136650367116
              le_mean =     -22.810681595597
             les_mean =     523.337569338541
             stat err =       0.000567819711
             autocorr =       1.276894092745
   target nu stat err =       0.000567819711
   target dn stat err =       2.491191886051
      target stat err =       0.096370442211
              std dev =       0.710637340120
             le_variance =       0.505005429173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497328111707
                                         uncertainty =       0.003383093898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497328111707
                                         uncertainty =       0.003383093898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498667326
  error estimate for blocks of size 2^( 2) =       0.000519374950
  error estimate for blocks of size 2^( 3) =       0.000539032808
  error estimate for blocks of size 2^( 4) =       0.000553578514
  error estimate for blocks of size 2^( 5) =       0.000564090381
  error estimate for blocks of size 2^( 6) =       0.000569345458
  error estimate for blocks of size 2^( 7) =       0.000571214915

      target function =      -0.695436534123
              le_mean =     -22.810737449227
             les_mean =     520.846633592752
             stat err =       0.000564557317
             autocorr =       1.281723226681
   target nu stat err =       0.000564557317
   target dn stat err =       0.004498812348
      target stat err =       0.003060208175
              std dev =       0.705222095825
             le_variance =       0.497338204440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498597525567
                                         uncertainty =       0.003403332347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498597525567
                                         uncertainty =       0.003403332347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499303494
  error estimate for blocks of size 2^( 2) =       0.000520040305
  error estimate for blocks of size 2^( 3) =       0.000539721430
  error estimate for blocks of size 2^( 4) =       0.000554283704
  error estimate for blocks of size 2^( 5) =       0.000564805301
  error estimate for blocks of size 2^( 6) =       0.000570074815
  error estimate for blocks of size 2^( 7) =       0.000571965548

      target function =      -0.695388977907
              le_mean =     -22.810736579626
             les_mean =     520.846665642028
             stat err =       0.000565282342
             autocorr =       1.281744990989
   target nu stat err =       0.000565282342
   target dn stat err =       0.004419316643
      target stat err =       0.003007569162
              std dev =       0.706121772545
             le_variance =       0.498607957662


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.695213604379        initial
     1.0000e+00     1.0000e+01             1.5798e-03        -0.136650367116
     4.0000e+00     4.0000e+01             4.0868e-04        -0.695436534123  <--
     1.6000e+01     1.6000e+02             1.0306e-04        -0.695388977907

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.5186e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.610824e-01 3 1  ON 0
ci_02                -5.617723e-02 3 1  ON 1
ci_03                -5.619793e-02 3 1  ON 2
ci_04                 5.533392e-02 3 1  ON 3
ci_05                -3.936531e-02 3 1  ON 4
ci_06                -3.935529e-02 3 1  ON 5
ci_07                 3.040806e-02 3 1  ON 6
ci_08                -1.784989e-02 3 1  ON 7
ci_09                -1.692863e-02 3 1  ON 8
ci_10                -1.688790e-02 3 1  ON 9
ci_11                 1.603580e-02 3 1  ON 10
ci_12                 1.302956e-02 3 1  ON 11
ci_13                 1.270351e-02 3 1  ON 12
ci_14                 1.274887e-02 3 1  ON 13
ci_15                 1.206981e-02 3 1  ON 14
ci_16                 1.200061e-02 3 1  ON 15
ci_17                -1.159518e-02 3 1  ON 16
ci_18                -1.170533e-02 3 1  ON 17
ci_19                 1.153791e-02 3 1  ON 18
ci_20                 1.027732e-02 3 1  ON 19
ci_21                 9.875137e-03 3 1  ON 20
ci_22                 9.847739e-03 3 1  ON 21
ci_23                 6.674892e-03 3 1  ON 22
ci_24                 5.290667e-03 3 1  ON 23
ci_25                 5.075377e-03 3 1  ON 24
ci_26                 4.684577e-03 3 1  ON 25
ci_27                 4.729014e-03 3 1  ON 26
ci_28                 4.002020e-03 3 1  ON 27
ci_29                 4.090395e-03 3 1  ON 28
ci_30                -3.599315e-03 3 1  ON 29
ci_31                -3.489464e-03 3 1  ON 30
ci_32                -3.305252e-03 3 1  ON 31
ci_33                -3.296490e-03 3 1  ON 32
ci_34                 2.733497e-03 3 1  ON 33
ci_35                 2.699721e-03 3 1  ON 34
ci_36                -2.510555e-03 3 1  ON 35
ci_37                -2.463562e-03 3 1  ON 36
ci_38                -2.037644e-03 3 1  ON 37
ci_39                -2.013279e-03 3 1  ON 38
ci_40                -2.004997e-03 3 1  ON 39
ci_41                -1.908704e-03 3 1  ON 40
ci_42                -1.984110e-03 3 1  ON 41
ci_43                -2.042932e-03 3 1  ON 42
ci_44                -1.980472e-03 3 1  ON 43
ci_45                -1.783363e-03 3 1  ON 44
ci_46                -1.788144e-03 3 1  ON 45
ci_47                -1.663477e-03 3 1  ON 46
ci_48                -1.699550e-03 3 1  ON 47
ci_49                -1.713452e-03 3 1  ON 48
ci_50                -1.641211e-03 3 1  ON 49
ci_51                 1.603868e-03 3 1  ON 50
ci_52                 1.567210e-03 3 1  ON 51
ci_53                -1.457689e-03 3 1  ON 52
ci_54                -1.429896e-03 3 1  ON 53
ci_55                -1.434146e-03 3 1  ON 54
ci_56                 1.432608e-03 3 1  ON 55
ci_57                 1.371176e-03 3 1  ON 56
ci_58                -1.213881e-03 3 1  ON 57
ci_59                -1.268703e-03 3 1  ON 58
ci_60                 1.112790e-03 3 1  ON 59
ci_61                 1.156211e-03 3 1  ON 60
ci_62                -1.122989e-03 3 1  ON 61
ci_63                -1.087592e-03 3 1  ON 62
ci_64                -1.031013e-03 3 1  ON 63
ci_65                -1.038819e-03 3 1  ON 64
ci_66                -9.929155e-04 3 1  ON 65
ci_67                -9.735327e-04 3 1  ON 66
ci_68                 8.278406e-04 3 1  ON 67
ci_69                 8.356061e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5723e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2831e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8351
    reference variance = 0.381084
====================================================
  Execution time = 2.5911e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1251e-01
  Total weights = 1.962963013e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6067e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496881358749
                                         uncertainty =       0.002130065540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496881358749
                                         uncertainty =       0.002130065540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498454507
  error estimate for blocks of size 2^( 2) =       0.000519339486
  error estimate for blocks of size 2^( 3) =       0.000538718338
  error estimate for blocks of size 2^( 4) =       0.000553841317
  error estimate for blocks of size 2^( 5) =       0.000563347296
  error estimate for blocks of size 2^( 6) =       0.000569802514
  error estimate for blocks of size 2^( 7) =       0.000576327750

      target function =      -0.698392436725
              le_mean =     -22.810857030941
             les_mean =     520.847704329596
             stat err =       0.000565829719
             autocorr =       1.288606906546
   target nu stat err =       0.000565829719
   target dn stat err =       0.003039305768
      target stat err =       0.002123869606
              std dev =       0.704921123756
             le_variance =       0.496913790717


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281085703094e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.698398055217       residual = 9.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699163749170       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.699284788243       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.699301537623       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.699306402397       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.699308756069       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.699309358177       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.699309391053       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.699309382405       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.699309399174       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.699309402413       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.625275e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.698398055217       residual = 9.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.698595795950       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.698626656610       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.698630873163       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.698632081439       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.698632648854       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.698632790618       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.698632797703       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.698632795527       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.698632799567       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.698632800302       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.205458e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.698398055217       residual = 9.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.698447900997       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.698455654151       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.698456709965       residual = 5.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.698457011447       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.698457151918       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.698457186801       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.698457188502       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.698457187958       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.698457188959       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.698457189137       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.060632e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.365904 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0528e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.607319e-01 3 1  ON 0
ci_02                -5.583978e-02 3 1  ON 1
ci_03                -5.584337e-02 3 1  ON 2
ci_04                 5.491338e-02 3 1  ON 3
ci_05                -3.910763e-02 3 1  ON 4
ci_06                -3.911926e-02 3 1  ON 5
ci_07                 3.037057e-02 3 1  ON 6
ci_08                -1.769326e-02 3 1  ON 7
ci_09                -1.682946e-02 3 1  ON 8
ci_10                -1.677688e-02 3 1  ON 9
ci_11                 1.599100e-02 3 1  ON 10
ci_12                 1.294286e-02 3 1  ON 11
ci_13                 1.270635e-02 3 1  ON 12
ci_14                 1.276867e-02 3 1  ON 13
ci_15                 1.199581e-02 3 1  ON 14
ci_16                 1.194567e-02 3 1  ON 15
ci_17                -1.152938e-02 3 1  ON 16
ci_18                -1.165017e-02 3 1  ON 17
ci_19                 1.150769e-02 3 1  ON 18
ci_20                 1.024407e-02 3 1  ON 19
ci_21                 9.858646e-03 3 1  ON 20
ci_22                 9.830693e-03 3 1  ON 21
ci_23                 6.643686e-03 3 1  ON 22
ci_24                 5.272578e-03 3 1  ON 23
ci_25                 5.035078e-03 3 1  ON 24
ci_26                 4.674761e-03 3 1  ON 25
ci_27                 4.712034e-03 3 1  ON 26
ci_28                 3.985518e-03 3 1  ON 27
ci_29                 4.066523e-03 3 1  ON 28
ci_30                -3.568183e-03 3 1  ON 29
ci_31                -3.474116e-03 3 1  ON 30
ci_32                -3.265016e-03 3 1  ON 31
ci_33                -3.253451e-03 3 1  ON 32
ci_34                 2.702437e-03 3 1  ON 33
ci_35                 2.682594e-03 3 1  ON 34
ci_36                -2.492876e-03 3 1  ON 35
ci_37                -2.447578e-03 3 1  ON 36
ci_38                -2.012389e-03 3 1  ON 37
ci_39                -1.990322e-03 3 1  ON 38
ci_40                -1.989441e-03 3 1  ON 39
ci_41                -1.890078e-03 3 1  ON 40
ci_42                -1.965395e-03 3 1  ON 41
ci_43                -2.035698e-03 3 1  ON 42
ci_44                -1.985144e-03 3 1  ON 43
ci_45                -1.761578e-03 3 1  ON 44
ci_46                -1.775478e-03 3 1  ON 45
ci_47                -1.648322e-03 3 1  ON 46
ci_48                -1.664250e-03 3 1  ON 47
ci_49                -1.704890e-03 3 1  ON 48
ci_50                -1.624632e-03 3 1  ON 49
ci_51                 1.594563e-03 3 1  ON 50
ci_52                 1.549308e-03 3 1  ON 51
ci_53                -1.445982e-03 3 1  ON 52
ci_54                -1.418958e-03 3 1  ON 53
ci_55                -1.424347e-03 3 1  ON 54
ci_56                 1.437666e-03 3 1  ON 55
ci_57                 1.377228e-03 3 1  ON 56
ci_58                -1.218149e-03 3 1  ON 57
ci_59                -1.262372e-03 3 1  ON 58
ci_60                 1.108561e-03 3 1  ON 59
ci_61                 1.180252e-03 3 1  ON 60
ci_62                -1.106956e-03 3 1  ON 61
ci_63                -1.072674e-03 3 1  ON 62
ci_64                -1.024705e-03 3 1  ON 63
ci_65                -1.044829e-03 3 1  ON 64
ci_66                -9.864407e-04 3 1  ON 65
ci_67                -9.773863e-04 3 1  ON 66
ci_68                 8.053712e-04 3 1  ON 67
ci_69                 8.161243e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8767
    reference variance = 0.504622
====================================================
  Execution time = 2.5044e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1278e-01
  Total weights = 1.9628e+06
  Execution time = 3.5720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497432017631
                                         uncertainty =       0.002419300352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497432017631
                                         uncertainty =       0.002419300352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498889696
  error estimate for blocks of size 2^( 2) =       0.000520112233
  error estimate for blocks of size 2^( 3) =       0.000540037907
  error estimate for blocks of size 2^( 4) =       0.000554263528
  error estimate for blocks of size 2^( 5) =       0.000563029367
  error estimate for blocks of size 2^( 6) =       0.000566254091
  error estimate for blocks of size 2^( 7) =       0.000569750574

      target function =      -0.697205069420
              le_mean =     -22.810794227648
             les_mean =     520.846595426984
             stat err =       0.000563324390
             autocorr =       1.274993710675
   target nu stat err =       0.000563324390
   target dn stat err =       0.003720223793
      target stat err =       0.002561593650
              std dev =       0.705536573811
             le_variance =       0.497781856985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494609704901
                                         uncertainty =       0.002396617248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494609704901
                                         uncertainty =       0.002396617248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497473316
  error estimate for blocks of size 2^( 2) =       0.000518631183
  error estimate for blocks of size 2^( 3) =       0.000538508661
  error estimate for blocks of size 2^( 4) =       0.000552729320
  error estimate for blocks of size 2^( 5) =       0.000561507072
  error estimate for blocks of size 2^( 6) =       0.000564681309
  error estimate for blocks of size 2^( 7) =       0.000568144829

      target function =      -0.675008894255
              le_mean =     -22.810796626496
             les_mean =     520.879921046370
             stat err =       0.000561765632
             autocorr =       1.275177825294
   target nu stat err =       0.000561765632
   target dn stat err =       0.030499247035
      target stat err =       0.019258842591
              std dev =       0.703533510433
             le_variance =       0.494959400302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495926034190
                                         uncertainty =       0.002406565541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495926034190
                                         uncertainty =       0.002406565541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498134450
  error estimate for blocks of size 2^( 2) =       0.000519323865
  error estimate for blocks of size 2^( 3) =       0.000539222065
  error estimate for blocks of size 2^( 4) =       0.000553444444
  error estimate for blocks of size 2^( 5) =       0.000562213618
  error estimate for blocks of size 2^( 6) =       0.000565414135
  error estimate for blocks of size 2^( 7) =       0.000568895821

      target function =      -0.698677713397
              le_mean =     -22.810790217072
             les_mean =     520.844230133463
             stat err =       0.000562492004
             autocorr =       1.275086216767
   target nu stat err =       0.000562492004
   target dn stat err =       0.003465966075
      target stat err =       0.002404349761
              std dev =       0.704468495372
             le_variance =       0.496275860971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497237182581
                                         uncertainty =       0.002417641422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497237182581
                                         uncertainty =       0.002417641422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498792054
  error estimate for blocks of size 2^( 2) =       0.000520010385
  error estimate for blocks of size 2^( 3) =       0.000539932489
  error estimate for blocks of size 2^( 4) =       0.000554157686
  error estimate for blocks of size 2^( 5) =       0.000562923873
  error estimate for blocks of size 2^( 6) =       0.000566145655
  error estimate for blocks of size 2^( 7) =       0.000569640120

      target function =      -0.697529597824
              le_mean =     -22.810793083291
             les_mean =     520.846061660103
             stat err =       0.000563216834
             autocorr =       1.275005920340
   target nu stat err =       0.000563216834
   target dn stat err =       0.003643573793
      target stat err =       0.002513472617
              std dev =       0.705398487036
             le_variance =       0.497587025513


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.697205069420        initial
     1.0000e+00     1.0000e+01             1.6253e-03        -0.675008894255
     4.0000e+00     4.0000e+01             4.2055e-04        -0.698677713397  <--
     1.6000e+01     1.6000e+02             1.0606e-04        -0.697529597824

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.2968e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.607319e-01 3 1  ON 0
ci_02                -5.583978e-02 3 1  ON 1
ci_03                -5.584337e-02 3 1  ON 2
ci_04                 5.491338e-02 3 1  ON 3
ci_05                -3.910763e-02 3 1  ON 4
ci_06                -3.911926e-02 3 1  ON 5
ci_07                 3.037057e-02 3 1  ON 6
ci_08                -1.769326e-02 3 1  ON 7
ci_09                -1.682946e-02 3 1  ON 8
ci_10                -1.677688e-02 3 1  ON 9
ci_11                 1.599100e-02 3 1  ON 10
ci_12                 1.294286e-02 3 1  ON 11
ci_13                 1.270635e-02 3 1  ON 12
ci_14                 1.276867e-02 3 1  ON 13
ci_15                 1.199581e-02 3 1  ON 14
ci_16                 1.194567e-02 3 1  ON 15
ci_17                -1.152938e-02 3 1  ON 16
ci_18                -1.165017e-02 3 1  ON 17
ci_19                 1.150769e-02 3 1  ON 18
ci_20                 1.024407e-02 3 1  ON 19
ci_21                 9.858646e-03 3 1  ON 20
ci_22                 9.830693e-03 3 1  ON 21
ci_23                 6.643686e-03 3 1  ON 22
ci_24                 5.272578e-03 3 1  ON 23
ci_25                 5.035078e-03 3 1  ON 24
ci_26                 4.674761e-03 3 1  ON 25
ci_27                 4.712034e-03 3 1  ON 26
ci_28                 3.985518e-03 3 1  ON 27
ci_29                 4.066523e-03 3 1  ON 28
ci_30                -3.568183e-03 3 1  ON 29
ci_31                -3.474116e-03 3 1  ON 30
ci_32                -3.265016e-03 3 1  ON 31
ci_33                -3.253451e-03 3 1  ON 32
ci_34                 2.702437e-03 3 1  ON 33
ci_35                 2.682594e-03 3 1  ON 34
ci_36                -2.492876e-03 3 1  ON 35
ci_37                -2.447578e-03 3 1  ON 36
ci_38                -2.012389e-03 3 1  ON 37
ci_39                -1.990322e-03 3 1  ON 38
ci_40                -1.989441e-03 3 1  ON 39
ci_41                -1.890078e-03 3 1  ON 40
ci_42                -1.965395e-03 3 1  ON 41
ci_43                -2.035698e-03 3 1  ON 42
ci_44                -1.985144e-03 3 1  ON 43
ci_45                -1.761578e-03 3 1  ON 44
ci_46                -1.775478e-03 3 1  ON 45
ci_47                -1.648322e-03 3 1  ON 46
ci_48                -1.664250e-03 3 1  ON 47
ci_49                -1.704890e-03 3 1  ON 48
ci_50                -1.624632e-03 3 1  ON 49
ci_51                 1.594563e-03 3 1  ON 50
ci_52                 1.549308e-03 3 1  ON 51
ci_53                -1.445982e-03 3 1  ON 52
ci_54                -1.418958e-03 3 1  ON 53
ci_55                -1.424347e-03 3 1  ON 54
ci_56                 1.437666e-03 3 1  ON 55
ci_57                 1.377228e-03 3 1  ON 56
ci_58                -1.218149e-03 3 1  ON 57
ci_59                -1.262372e-03 3 1  ON 58
ci_60                 1.108561e-03 3 1  ON 59
ci_61                 1.180252e-03 3 1  ON 60
ci_62                -1.106956e-03 3 1  ON 61
ci_63                -1.072674e-03 3 1  ON 62
ci_64                -1.024705e-03 3 1  ON 63
ci_65                -1.044829e-03 3 1  ON 64
ci_66                -9.864407e-04 3 1  ON 65
ci_67                -9.773863e-04 3 1  ON 66
ci_68                 8.053712e-04 3 1  ON 67
ci_69                 8.161243e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3502e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7722
    reference variance = 0.347842
====================================================
  Execution time = 2.5737e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1580e-01
  Total weights = 1.963046795e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499723796303
                                         uncertainty =       0.002308209591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499723796303
                                         uncertainty =       0.002308209591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499855038
  error estimate for blocks of size 2^( 2) =       0.000521100770
  error estimate for blocks of size 2^( 3) =       0.000541181625
  error estimate for blocks of size 2^( 4) =       0.000555527280
  error estimate for blocks of size 2^( 5) =       0.000565103637
  error estimate for blocks of size 2^( 6) =       0.000570123923
  error estimate for blocks of size 2^( 7) =       0.000575481123

      target function =      -0.696170584422
              le_mean =     -22.810592383989
             les_mean =     520.838929533656
             stat err =       0.000566558991
             autocorr =       1.284701184597
   target nu stat err =       0.000566558991
   target dn stat err =       0.003042815968
      target stat err =       0.002112507732
              std dev =       0.706901773776
             le_variance =       0.499710117768


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281059238399e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696176185049       residual = 9.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696940093278       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.697057849649       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.697076299948       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.697081783827       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.697083067722       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.697083308683       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.697083355132       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.697083354622       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.697083365675       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.697083367153       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.630181e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696176185049       residual = 9.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696373470459       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696403512348       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696408156977       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696409514617       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696409821681       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696409876880       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696409887959       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696409887775       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696409890442       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696409890766       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.219233e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696176185049       residual = 9.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696225916437       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696233465090       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696234628093       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696234966562       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696235042427       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696235055910       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696235058646       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696235058597       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696235059257       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696235059336       residual = 1.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.064177e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.370010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0376e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.603902e-01 3 1  ON 0
ci_02                -5.549809e-02 3 1  ON 1
ci_03                -5.549933e-02 3 1  ON 2
ci_04                 5.449145e-02 3 1  ON 3
ci_05                -3.886272e-02 3 1  ON 4
ci_06                -3.888467e-02 3 1  ON 5
ci_07                 3.032637e-02 3 1  ON 6
ci_08                -1.753180e-02 3 1  ON 7
ci_09                -1.673032e-02 3 1  ON 8
ci_10                -1.666786e-02 3 1  ON 9
ci_11                 1.595304e-02 3 1  ON 10
ci_12                 1.288105e-02 3 1  ON 11
ci_13                 1.270770e-02 3 1  ON 12
ci_14                 1.275920e-02 3 1  ON 13
ci_15                 1.192379e-02 3 1  ON 14
ci_16                 1.186956e-02 3 1  ON 15
ci_17                -1.147715e-02 3 1  ON 16
ci_18                -1.159328e-02 3 1  ON 17
ci_19                 1.148216e-02 3 1  ON 18
ci_20                 1.019355e-02 3 1  ON 19
ci_21                 9.841319e-03 3 1  ON 20
ci_22                 9.815523e-03 3 1  ON 21
ci_23                 6.620540e-03 3 1  ON 22
ci_24                 5.277457e-03 3 1  ON 23
ci_25                 5.000735e-03 3 1  ON 24
ci_26                 4.650442e-03 3 1  ON 25
ci_27                 4.695573e-03 3 1  ON 26
ci_28                 3.940913e-03 3 1  ON 27
ci_29                 4.037088e-03 3 1  ON 28
ci_30                -3.541562e-03 3 1  ON 29
ci_31                -3.450709e-03 3 1  ON 30
ci_32                -3.224074e-03 3 1  ON 31
ci_33                -3.215995e-03 3 1  ON 32
ci_34                 2.687166e-03 3 1  ON 33
ci_35                 2.656194e-03 3 1  ON 34
ci_36                -2.471563e-03 3 1  ON 35
ci_37                -2.429225e-03 3 1  ON 36
ci_38                -1.986070e-03 3 1  ON 37
ci_39                -1.975599e-03 3 1  ON 38
ci_40                -1.980237e-03 3 1  ON 39
ci_41                -1.873048e-03 3 1  ON 40
ci_42                -1.952805e-03 3 1  ON 41
ci_43                -2.057035e-03 3 1  ON 42
ci_44                -1.978933e-03 3 1  ON 43
ci_45                -1.742987e-03 3 1  ON 44
ci_46                -1.752907e-03 3 1  ON 45
ci_47                -1.625023e-03 3 1  ON 46
ci_48                -1.645654e-03 3 1  ON 47
ci_49                -1.707375e-03 3 1  ON 48
ci_50                -1.619641e-03 3 1  ON 49
ci_51                 1.577367e-03 3 1  ON 50
ci_52                 1.532816e-03 3 1  ON 51
ci_53                -1.435904e-03 3 1  ON 52
ci_54                -1.402774e-03 3 1  ON 53
ci_55                -1.422931e-03 3 1  ON 54
ci_56                 1.444189e-03 3 1  ON 55
ci_57                 1.386943e-03 3 1  ON 56
ci_58                -1.195323e-03 3 1  ON 57
ci_59                -1.253604e-03 3 1  ON 58
ci_60                 1.116600e-03 3 1  ON 59
ci_61                 1.157011e-03 3 1  ON 60
ci_62                -1.108636e-03 3 1  ON 61
ci_63                -1.067786e-03 3 1  ON 62
ci_64                -1.017839e-03 3 1  ON 63
ci_65                -1.034605e-03 3 1  ON 64
ci_66                -9.840242e-04 3 1  ON 65
ci_67                -9.733634e-04 3 1  ON 66
ci_68                 7.864927e-04 3 1  ON 67
ci_69                 7.854679e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8287
    reference variance = 0.479961
====================================================
  Execution time = 2.5111e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1528e-01
  Total weights = 1.9628e+06
  Execution time = 3.5974e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500781678497
                                         uncertainty =       0.002616079688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500781678497
                                         uncertainty =       0.002616079688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500408180
  error estimate for blocks of size 2^( 2) =       0.000521748577
  error estimate for blocks of size 2^( 3) =       0.000541185669
  error estimate for blocks of size 2^( 4) =       0.000556536064
  error estimate for blocks of size 2^( 5) =       0.000566328421
  error estimate for blocks of size 2^( 6) =       0.000571585427
  error estimate for blocks of size 2^( 7) =       0.000576539938

      target function =      -0.693249706077
              le_mean =     -22.810874275870
             les_mean =     520.856152687920
             stat err =       0.000567747462
             autocorr =       1.287246151396
   target nu stat err =       0.000567747462
   target dn stat err =       0.004573781613
      target stat err =       0.003091506334
              std dev =       0.707684035306
             le_variance =       0.500816693828

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0236885
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498159093393
                                         uncertainty =       0.002592536952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498159093393
                                         uncertainty =       0.002592536952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499096566
  error estimate for blocks of size 2^( 2) =       0.000520360492
  error estimate for blocks of size 2^( 3) =       0.000539757178
  error estimate for blocks of size 2^( 4) =       0.000555081118
  error estimate for blocks of size 2^( 5) =       0.000564842861
  error estimate for blocks of size 2^( 6) =       0.000570138086
  error estimate for blocks of size 2^( 7) =       0.000575061904

      target function =      -0.686373412707
              le_mean =     -22.810886635909
             les_mean =     520.866891036059
             stat err =       0.000566280992
             autocorr =       1.287344570648
   target nu stat err =       0.000566280992
   target dn stat err =       0.017307214740
      target stat err =       0.011303682275
              std dev =       0.705829132188
             le_variance =       0.498194763845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499379929681
                                         uncertainty =       0.002604106636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499379929681
                                         uncertainty =       0.002604106636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499707567
  error estimate for blocks of size 2^( 2) =       0.000521007747
  error estimate for blocks of size 2^( 3) =       0.000540424269
  error estimate for blocks of size 2^( 4) =       0.000555766938
  error estimate for blocks of size 2^( 5) =       0.000565538705
  error estimate for blocks of size 2^( 6) =       0.000570817679
  error estimate for blocks of size 2^( 7) =       0.000575775016

      target function =      -0.684250087677
              le_mean =     -22.810873692891
             les_mean =     520.869512154709
             stat err =       0.000566974584
             autocorr =       1.287346126735
   target nu stat err =       0.000566974584
   target dn stat err =       0.018913602874
      target stat err =       0.012274775109
              std dev =       0.706693218632
             le_variance =       0.499415305261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500597872802
                                         uncertainty =       0.002614586472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500597872802
                                         uncertainty =       0.002614586472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500316367
  error estimate for blocks of size 2^( 2) =       0.000521651357
  error estimate for blocks of size 2^( 3) =       0.000541085679
  error estimate for blocks of size 2^( 4) =       0.000556435902
  error estimate for blocks of size 2^( 5) =       0.000566225163
  error estimate for blocks of size 2^( 6) =       0.000571483129
  error estimate for blocks of size 2^( 7) =       0.000576435020

      target function =      -0.693600283098
              le_mean =     -22.810872684344
             les_mean =     520.855555353391
             stat err =       0.000567644803
             autocorr =       1.287252997292
   target nu stat err =       0.000567644803
   target dn stat err =       0.004349498088
      target stat err =       0.002947633584
              std dev =       0.707554191853
             le_variance =       0.500632934409


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.693249706077        initial
     1.0000e+00     1.0000e+01             1.6302e-03        -0.686373412707
     4.0000e+00     4.0000e+01             4.2192e-04        -0.684250087677
     1.6000e+01     1.6000e+02             1.0642e-04        -0.693600283098  <--

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.3164e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.606461e-01 3 1  ON 0
ci_02                -5.575369e-02 3 1  ON 1
ci_03                -5.575669e-02 3 1  ON 2
ci_04                 5.480696e-02 3 1  ON 3
ci_05                -3.904589e-02 3 1  ON 4
ci_06                -3.906013e-02 3 1  ON 5
ci_07                 3.035945e-02 3 1  ON 6
ci_08                -1.765256e-02 3 1  ON 7
ci_09                -1.680450e-02 3 1  ON 8
ci_10                -1.674943e-02 3 1  ON 9
ci_11                 1.598143e-02 3 1  ON 10
ci_12                 1.292728e-02 3 1  ON 11
ci_13                 1.270669e-02 3 1  ON 12
ci_14                 1.276628e-02 3 1  ON 13
ci_15                 1.197766e-02 3 1  ON 14
ci_16                 1.192649e-02 3 1  ON 15
ci_17                -1.151624e-02 3 1  ON 16
ci_18                -1.163586e-02 3 1  ON 17
ci_19                 1.150124e-02 3 1  ON 18
ci_20                 1.023133e-02 3 1  ON 19
ci_21                 9.854293e-03 3 1  ON 20
ci_22                 9.826878e-03 3 1  ON 21
ci_23                 6.637845e-03 3 1  ON 22
ci_24                 5.273802e-03 3 1  ON 23
ci_25                 5.026418e-03 3 1  ON 24
ci_26                 4.668625e-03 3 1  ON 25
ci_27                 4.707882e-03 3 1  ON 26
ci_28                 3.974289e-03 3 1  ON 27
ci_29                 4.059118e-03 3 1  ON 28
ci_30                -3.561494e-03 3 1  ON 29
ci_31                -3.468244e-03 3 1  ON 30
ci_32                -3.254672e-03 3 1  ON 31
ci_33                -3.243994e-03 3 1  ON 32
ci_34                 2.698564e-03 3 1  ON 33
ci_35                 2.675924e-03 3 1  ON 34
ci_36                -2.487505e-03 3 1  ON 35
ci_37                -2.442953e-03 3 1  ON 36
ci_38                -2.005751e-03 3 1  ON 37
ci_39                -1.986611e-03 3 1  ON 38
ci_40                -1.987121e-03 3 1  ON 39
ci_41                -1.885770e-03 3 1  ON 40
ci_42                -1.962207e-03 3 1  ON 41
ci_43                -2.041083e-03 3 1  ON 42
ci_44                -1.983594e-03 3 1  ON 43
ci_45                -1.756893e-03 3 1  ON 44
ci_46                -1.769786e-03 3 1  ON 45
ci_47                -1.642471e-03 3 1  ON 46
ci_48                -1.659581e-03 3 1  ON 47
ci_49                -1.705518e-03 3 1  ON 48
ci_50                -1.623374e-03 3 1  ON 49
ci_51                 1.590227e-03 3 1  ON 50
ci_52                 1.545153e-03 3 1  ON 51
ci_53                -1.443440e-03 3 1  ON 52
ci_54                -1.414881e-03 3 1  ON 53
ci_55                -1.423988e-03 3 1  ON 54
ci_56                 1.439307e-03 3 1  ON 55
ci_57                 1.379674e-03 3 1  ON 56
ci_58                -1.212390e-03 3 1  ON 57
ci_59                -1.260161e-03 3 1  ON 58
ci_60                 1.110587e-03 3 1  ON 59
ci_61                 1.174426e-03 3 1  ON 60
ci_62                -1.107384e-03 3 1  ON 61
ci_63                -1.071445e-03 3 1  ON 62
ci_64                -1.022981e-03 3 1  ON 63
ci_65                -1.042258e-03 3 1  ON 64
ci_66                -9.858339e-04 3 1  ON 65
ci_67                -9.763768e-04 3 1  ON 66
ci_68                 8.006169e-04 3 1  ON 67
ci_69                 8.084026e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3551e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2831e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8556
    reference variance = 0.625807
====================================================
  Execution time = 2.5775e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1619e-01
  Total weights = 1.962866321e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499469742050
                                         uncertainty =       0.002885878823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499469742050
                                         uncertainty =       0.002885878823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499721482
  error estimate for blocks of size 2^( 2) =       0.000520899036
  error estimate for blocks of size 2^( 3) =       0.000540666969
  error estimate for blocks of size 2^( 4) =       0.000555108930
  error estimate for blocks of size 2^( 5) =       0.000564721475
  error estimate for blocks of size 2^( 6) =       0.000570133260
  error estimate for blocks of size 2^( 7) =       0.000572558170

      target function =      -0.695910887915
              le_mean =     -22.810954300702
             les_mean =     520.855828238596
             stat err =       0.000565630459
             autocorr =       1.281178188714
   target nu stat err =       0.000565630459
   target dn stat err =       0.003467445806
      target stat err =       0.002388027368
              std dev =       0.706712897847
             le_variance =       0.499443119984


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281095430070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.695918312073       residual = 9.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696106223049       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696137051235       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696141635059       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696143209916       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696143549362       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696143682966       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696143695843       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696143698529       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696143702298       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696143703269       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.136413e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.695918312073       residual = 9.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.695965680082       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.695973426167       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.695974573868       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.695974966543       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.695975050489       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.695975083440       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.695975086594       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.695975087255       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.695975088187       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.695975088424       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.043214e-04

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.695918312073       residual = 9.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.695930178711       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.695932117680       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.695932404712       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.695932502813       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.695932523742       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.695932531952       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.695932532736       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.695932532901       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.695932533133       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.695932533192       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+01 is 2.613789e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.378972 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0410e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.605551e-01 3 1  ON 0
ci_02                -5.566898e-02 3 1  ON 1
ci_03                -5.566882e-02 3 1  ON 2
ci_04                 5.470264e-02 3 1  ON 3
ci_05                -3.898892e-02 3 1  ON 4
ci_06                -3.900208e-02 3 1  ON 5
ci_07                 3.034736e-02 3 1  ON 6
ci_08                -1.761526e-02 3 1  ON 7
ci_09                -1.677960e-02 3 1  ON 8
ci_10                -1.672214e-02 3 1  ON 9
ci_11                 1.597209e-02 3 1  ON 10
ci_12                 1.290870e-02 3 1  ON 11
ci_13                 1.270391e-02 3 1  ON 12
ci_14                 1.277326e-02 3 1  ON 13
ci_15                 1.196297e-02 3 1  ON 14
ci_16                 1.191108e-02 3 1  ON 15
ci_17                -1.150292e-02 3 1  ON 16
ci_18                -1.161784e-02 3 1  ON 17
ci_19                 1.149073e-02 3 1  ON 18
ci_20                 1.022134e-02 3 1  ON 19
ci_21                 9.850329e-03 3 1  ON 20
ci_22                 9.826402e-03 3 1  ON 21
ci_23                 6.634037e-03 3 1  ON 22
ci_24                 5.264761e-03 3 1  ON 23
ci_25                 5.020796e-03 3 1  ON 24
ci_26                 4.665813e-03 3 1  ON 25
ci_27                 4.700930e-03 3 1  ON 26
ci_28                 3.969295e-03 3 1  ON 27
ci_29                 4.053134e-03 3 1  ON 28
ci_30                -3.551468e-03 3 1  ON 29
ci_31                -3.463687e-03 3 1  ON 30
ci_32                -3.246209e-03 3 1  ON 31
ci_33                -3.232945e-03 3 1  ON 32
ci_34                 2.688888e-03 3 1  ON 33
ci_35                 2.669013e-03 3 1  ON 34
ci_36                -2.483690e-03 3 1  ON 35
ci_37                -2.437640e-03 3 1  ON 36
ci_38                -2.000766e-03 3 1  ON 37
ci_39                -1.980590e-03 3 1  ON 38
ci_40                -1.986404e-03 3 1  ON 39
ci_41                -1.881477e-03 3 1  ON 40
ci_42                -1.957880e-03 3 1  ON 41
ci_43                -2.035651e-03 3 1  ON 42
ci_44                -1.988582e-03 3 1  ON 43
ci_45                -1.754577e-03 3 1  ON 44
ci_46                -1.765703e-03 3 1  ON 45
ci_47                -1.636656e-03 3 1  ON 46
ci_48                -1.652444e-03 3 1  ON 47
ci_49                -1.703755e-03 3 1  ON 48
ci_50                -1.621558e-03 3 1  ON 49
ci_51                 1.586414e-03 3 1  ON 50
ci_52                 1.542197e-03 3 1  ON 51
ci_53                -1.441460e-03 3 1  ON 52
ci_54                -1.415128e-03 3 1  ON 53
ci_55                -1.424065e-03 3 1  ON 54
ci_56                 1.438924e-03 3 1  ON 55
ci_57                 1.378899e-03 3 1  ON 56
ci_58                -1.212000e-03 3 1  ON 57
ci_59                -1.256852e-03 3 1  ON 58
ci_60                 1.106614e-03 3 1  ON 59
ci_61                 1.175002e-03 3 1  ON 60
ci_62                -1.107960e-03 3 1  ON 61
ci_63                -1.066779e-03 3 1  ON 62
ci_64                -1.022018e-03 3 1  ON 63
ci_65                -1.039419e-03 3 1  ON 64
ci_66                -9.849202e-04 3 1  ON 65
ci_67                -9.737656e-04 3 1  ON 66
ci_68                 7.919272e-04 3 1  ON 67
ci_69                 8.035275e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.845
    reference variance = 0.425442
====================================================
  Execution time = 2.5057e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1543e-01
  Total weights = 1.9632e+06
  Execution time = 3.6040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496690602851
                                         uncertainty =       0.002959076682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496690602851
                                         uncertainty =       0.002959076682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498315886
  error estimate for blocks of size 2^( 2) =       0.000519655753
  error estimate for blocks of size 2^( 3) =       0.000539141295
  error estimate for blocks of size 2^( 4) =       0.000554206853
  error estimate for blocks of size 2^( 5) =       0.000563282578
  error estimate for blocks of size 2^( 6) =       0.000568911038
  error estimate for blocks of size 2^( 7) =       0.000570690856

      target function =      -0.696303378356
              le_mean =     -22.810652420939
             les_mean =     520.841468198200
             stat err =       0.000564272831
             autocorr =       1.282238508761
   target nu stat err =       0.000564272831
   target dn stat err =       0.003502600550
      target stat err =       0.002412330981
              std dev =       0.704725084252
             le_variance =       0.496637444374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496017644537
                                         uncertainty =       0.002958731588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496017644537
                                         uncertainty =       0.002958731588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497978360
  error estimate for blocks of size 2^( 2) =       0.000519298020
  error estimate for blocks of size 2^( 3) =       0.000538767403
  error estimate for blocks of size 2^( 4) =       0.000553827912
  error estimate for blocks of size 2^( 5) =       0.000562905192
  error estimate for blocks of size 2^( 6) =       0.000568527004
  error estimate for blocks of size 2^( 7) =       0.000570309754

      target function =      -0.695921228641
              le_mean =     -22.810656606087
             les_mean =     520.842226753330
             stat err =       0.000563892466
             autocorr =       1.282246855405
   target nu stat err =       0.000563892466
   target dn stat err =       0.003822250485
      target stat err =       0.002618871672
              std dev =       0.704247750452
             le_variance =       0.495964894017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496348612147
                                         uncertainty =       0.002958827391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496348612147
                                         uncertainty =       0.002958827391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498144387
  error estimate for blocks of size 2^( 2) =       0.000519473964
  error estimate for blocks of size 2^( 3) =       0.000538951238
  error estimate for blocks of size 2^( 4) =       0.000554014204
  error estimate for blocks of size 2^( 5) =       0.000563089813
  error estimate for blocks of size 2^( 6) =       0.000568714761
  error estimate for blocks of size 2^( 7) =       0.000570497700

      target function =      -0.696406074078
              le_mean =     -22.810653901618
             les_mean =     520.841382223395
             stat err =       0.000564079119
             autocorr =       1.282240722403
   target nu stat err =       0.000564079119
   target dn stat err =       0.003577409216
      target stat err =       0.002461935114
              std dev =       0.704482547843
             le_variance =       0.496295660215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496647456113
                                         uncertainty =       0.002959036840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496647456113
                                         uncertainty =       0.002959036840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498294252
  error estimate for blocks of size 2^( 2) =       0.000519632830
  error estimate for blocks of size 2^( 3) =       0.000539117333
  error estimate for blocks of size 2^( 4) =       0.000554182562
  error estimate for blocks of size 2^( 5) =       0.000563258283
  error estimate for blocks of size 2^( 6) =       0.000568886292
  error estimate for blocks of size 2^( 7) =       0.000570666471

      target function =      -0.696340687638
              le_mean =     -22.810652573526
             les_mean =     520.841419518550
             stat err =       0.000564248402
             autocorr =       1.282238817921
   target nu stat err =       0.000564248402
   target dn stat err =       0.003508804638
      target stat err =       0.002416634681
              std dev =       0.704694489598
             le_variance =       0.496594323670


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.696303378356        initial
     4.0000e+00     4.0000e+01             4.1364e-04        -0.695921228641
     1.6000e+01     1.6000e+02             1.0432e-04        -0.696406074078  <--
     6.4000e+01     6.4000e+02             2.6138e-05        -0.696340687638

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.3135e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.605551e-01 3 1  ON 0
ci_02                -5.566898e-02 3 1  ON 1
ci_03                -5.566882e-02 3 1  ON 2
ci_04                 5.470264e-02 3 1  ON 3
ci_05                -3.898892e-02 3 1  ON 4
ci_06                -3.900208e-02 3 1  ON 5
ci_07                 3.034736e-02 3 1  ON 6
ci_08                -1.761526e-02 3 1  ON 7
ci_09                -1.677960e-02 3 1  ON 8
ci_10                -1.672214e-02 3 1  ON 9
ci_11                 1.597209e-02 3 1  ON 10
ci_12                 1.290870e-02 3 1  ON 11
ci_13                 1.270391e-02 3 1  ON 12
ci_14                 1.277326e-02 3 1  ON 13
ci_15                 1.196297e-02 3 1  ON 14
ci_16                 1.191108e-02 3 1  ON 15
ci_17                -1.150292e-02 3 1  ON 16
ci_18                -1.161784e-02 3 1  ON 17
ci_19                 1.149073e-02 3 1  ON 18
ci_20                 1.022134e-02 3 1  ON 19
ci_21                 9.850329e-03 3 1  ON 20
ci_22                 9.826402e-03 3 1  ON 21
ci_23                 6.634037e-03 3 1  ON 22
ci_24                 5.264761e-03 3 1  ON 23
ci_25                 5.020796e-03 3 1  ON 24
ci_26                 4.665813e-03 3 1  ON 25
ci_27                 4.700930e-03 3 1  ON 26
ci_28                 3.969295e-03 3 1  ON 27
ci_29                 4.053134e-03 3 1  ON 28
ci_30                -3.551468e-03 3 1  ON 29
ci_31                -3.463687e-03 3 1  ON 30
ci_32                -3.246209e-03 3 1  ON 31
ci_33                -3.232945e-03 3 1  ON 32
ci_34                 2.688888e-03 3 1  ON 33
ci_35                 2.669013e-03 3 1  ON 34
ci_36                -2.483690e-03 3 1  ON 35
ci_37                -2.437640e-03 3 1  ON 36
ci_38                -2.000766e-03 3 1  ON 37
ci_39                -1.980590e-03 3 1  ON 38
ci_40                -1.986404e-03 3 1  ON 39
ci_41                -1.881477e-03 3 1  ON 40
ci_42                -1.957880e-03 3 1  ON 41
ci_43                -2.035651e-03 3 1  ON 42
ci_44                -1.988582e-03 3 1  ON 43
ci_45                -1.754577e-03 3 1  ON 44
ci_46                -1.765703e-03 3 1  ON 45
ci_47                -1.636656e-03 3 1  ON 46
ci_48                -1.652444e-03 3 1  ON 47
ci_49                -1.703755e-03 3 1  ON 48
ci_50                -1.621558e-03 3 1  ON 49
ci_51                 1.586414e-03 3 1  ON 50
ci_52                 1.542197e-03 3 1  ON 51
ci_53                -1.441460e-03 3 1  ON 52
ci_54                -1.415128e-03 3 1  ON 53
ci_55                -1.424065e-03 3 1  ON 54
ci_56                 1.438924e-03 3 1  ON 55
ci_57                 1.378899e-03 3 1  ON 56
ci_58                -1.212000e-03 3 1  ON 57
ci_59                -1.256852e-03 3 1  ON 58
ci_60                 1.106614e-03 3 1  ON 59
ci_61                 1.175002e-03 3 1  ON 60
ci_62                -1.107960e-03 3 1  ON 61
ci_63                -1.066779e-03 3 1  ON 62
ci_64                -1.022018e-03 3 1  ON 63
ci_65                -1.039419e-03 3 1  ON 64
ci_66                -9.849202e-04 3 1  ON 65
ci_67                -9.737656e-04 3 1  ON 66
ci_68                 7.919272e-04 3 1  ON 67
ci_69                 8.035275e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3556e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7928
    reference variance = 0.352858
====================================================
  Execution time = 2.5801e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2810e+01
  VMC Evar = 5.1409e-01
  Total weights = 1.963029852e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498834694991
                                         uncertainty =       0.002567950478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498834694991
                                         uncertainty =       0.002567950478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499377273
  error estimate for blocks of size 2^( 2) =       0.000520524930
  error estimate for blocks of size 2^( 3) =       0.000539911291
  error estimate for blocks of size 2^( 4) =       0.000554358056
  error estimate for blocks of size 2^( 5) =       0.000564053371
  error estimate for blocks of size 2^( 6) =       0.000568888039
  error estimate for blocks of size 2^( 7) =       0.000572004941

      target function =      -0.697320694589
              le_mean =     -22.810274043400
             les_mean =     520.822689720430
             stat err =       0.000564826101
             autocorr =       1.279298728977
   target nu stat err =       0.000564826101
   target dn stat err =       0.003243551697
      target stat err =       0.002248640144
              std dev =       0.706226112653
             le_variance =       0.498755322193


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281027404340e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.697327095438       residual = 8.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.697515221695       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.697544182898       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.697547948636       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.697549089784       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.697549563773       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.697549707124       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.697549719708       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.697549719170       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.697549721259       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.697549721583       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.006161e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.697327095438       residual = 8.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.697374515648       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.697381792368       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.697382735391       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.697383020414       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.697383137848       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.697383173186       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.697383176238       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.697383176098       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.697383176613       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.697383176691       residual = 1.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.010403e-04

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.697327095438       residual = 8.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.697338975023       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.697340796486       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.697341032339       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.697341103577       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.697341132868       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.697341141672       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.697341142429       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.697341142393       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.697341142522       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.697341142541       residual = 1.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+01 is 2.531605e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.383003 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0394e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.604738e-01 3 1  ON 0
ci_02                -5.557790e-02 3 1  ON 1
ci_03                -5.558149e-02 3 1  ON 2
ci_04                 5.460160e-02 3 1  ON 3
ci_05                -3.892725e-02 3 1  ON 4
ci_06                -3.894122e-02 3 1  ON 5
ci_07                 3.033676e-02 3 1  ON 6
ci_08                -1.757986e-02 3 1  ON 7
ci_09                -1.675164e-02 3 1  ON 8
ci_10                -1.669808e-02 3 1  ON 9
ci_11                 1.596314e-02 3 1  ON 10
ci_12                 1.289194e-02 3 1  ON 11
ci_13                 1.270113e-02 3 1  ON 12
ci_14                 1.277271e-02 3 1  ON 13
ci_15                 1.194661e-02 3 1  ON 14
ci_16                 1.189468e-02 3 1  ON 15
ci_17                -1.149186e-02 3 1  ON 16
ci_18                -1.159933e-02 3 1  ON 17
ci_19                 1.147750e-02 3 1  ON 18
ci_20                 1.021119e-02 3 1  ON 19
ci_21                 9.853109e-03 3 1  ON 20
ci_22                 9.823450e-03 3 1  ON 21
ci_23                 6.627572e-03 3 1  ON 22
ci_24                 5.260761e-03 3 1  ON 23
ci_25                 5.017269e-03 3 1  ON 24
ci_26                 4.657984e-03 3 1  ON 25
ci_27                 4.693992e-03 3 1  ON 26
ci_28                 3.961552e-03 3 1  ON 27
ci_29                 4.049115e-03 3 1  ON 28
ci_30                -3.543464e-03 3 1  ON 29
ci_31                -3.457193e-03 3 1  ON 30
ci_32                -3.238930e-03 3 1  ON 31
ci_33                -3.223209e-03 3 1  ON 32
ci_34                 2.685249e-03 3 1  ON 33
ci_35                 2.661717e-03 3 1  ON 34
ci_36                -2.479524e-03 3 1  ON 35
ci_37                -2.433879e-03 3 1  ON 36
ci_38                -1.997127e-03 3 1  ON 37
ci_39                -1.977074e-03 3 1  ON 38
ci_40                -1.983696e-03 3 1  ON 39
ci_41                -1.876103e-03 3 1  ON 40
ci_42                -1.953128e-03 3 1  ON 41
ci_43                -2.032631e-03 3 1  ON 42
ci_44                -1.990852e-03 3 1  ON 43
ci_45                -1.752722e-03 3 1  ON 44
ci_46                -1.762832e-03 3 1  ON 45
ci_47                -1.631793e-03 3 1  ON 46
ci_48                -1.646570e-03 3 1  ON 47
ci_49                -1.697157e-03 3 1  ON 48
ci_50                -1.619243e-03 3 1  ON 49
ci_51                 1.584901e-03 3 1  ON 50
ci_52                 1.536302e-03 3 1  ON 51
ci_53                -1.441311e-03 3 1  ON 52
ci_54                -1.412540e-03 3 1  ON 53
ci_55                -1.420509e-03 3 1  ON 54
ci_56                 1.440967e-03 3 1  ON 55
ci_57                 1.380600e-03 3 1  ON 56
ci_58                -1.207936e-03 3 1  ON 57
ci_59                -1.257524e-03 3 1  ON 58
ci_60                 1.106479e-03 3 1  ON 59
ci_61                 1.170878e-03 3 1  ON 60
ci_62                -1.105543e-03 3 1  ON 61
ci_63                -1.064430e-03 3 1  ON 62
ci_64                -1.020893e-03 3 1  ON 63
ci_65                -1.038639e-03 3 1  ON 64
ci_66                -9.856425e-04 3 1  ON 65
ci_67                -9.733305e-04 3 1  ON 66
ci_68                 7.871493e-04 3 1  ON 67
ci_69                 7.995188e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8373
    reference variance = 0.540456
====================================================
  Execution time = 2.7064e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.2098e-01
  Total weights = 1.9630e+06
  Execution time = 3.5919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501547747363
                                         uncertainty =       0.002698856832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501547747363
                                         uncertainty =       0.002698856832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500724769
  error estimate for blocks of size 2^( 2) =       0.000522144692
  error estimate for blocks of size 2^( 3) =       0.000542215049
  error estimate for blocks of size 2^( 4) =       0.000557743993
  error estimate for blocks of size 2^( 5) =       0.000567781408
  error estimate for blocks of size 2^( 6) =       0.000571851882
  error estimate for blocks of size 2^( 7) =       0.000576245279

      target function =      -0.692543416661
              le_mean =     -22.810927036060
             les_mean =     520.859628832453
             stat err =       0.000568405641
             autocorr =       1.288601428019
   target nu stat err =       0.000568405641
   target dn stat err =       0.003777276718
      target stat err =       0.002566740951
              std dev =       0.708131759403
             le_variance =       0.501450588675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500788864957
                                         uncertainty =       0.002691027245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500788864957
                                         uncertainty =       0.002691027245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500345830
  error estimate for blocks of size 2^( 2) =       0.000521750749
  error estimate for blocks of size 2^( 3) =       0.000541808650
  error estimate for blocks of size 2^( 4) =       0.000557339085
  error estimate for blocks of size 2^( 5) =       0.000567379395
  error estimate for blocks of size 2^( 6) =       0.000571448861
  error estimate for blocks of size 2^( 7) =       0.000575828086

      target function =      -0.692827358235
              le_mean =     -22.810925823934
             les_mean =     520.859145444079
             stat err =       0.000567998857
             autocorr =       1.288707493571
   target nu stat err =       0.000567998857
   target dn stat err =       0.003866846327
      target stat err =       0.002626914479
              std dev =       0.707595858878
             le_variance =       0.500691899501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501161335439
                                         uncertainty =       0.002694828129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501161335439
                                         uncertainty =       0.002694828129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500531855
  error estimate for blocks of size 2^( 2) =       0.000521944199
  error estimate for blocks of size 2^( 3) =       0.000542008311
  error estimate for blocks of size 2^( 4) =       0.000557538003
  error estimate for blocks of size 2^( 5) =       0.000567576869
  error estimate for blocks of size 2^( 6) =       0.000571646776
  error estimate for blocks of size 2^( 7) =       0.000576032850

      target function =      -0.692841019401
              le_mean =     -22.810926073156
             les_mean =     520.859136688403
             stat err =       0.000568198624
             autocorr =       1.288655734435
   target nu stat err =       0.000568198624
   target dn stat err =       0.003807746846
      target stat err =       0.002588645535
              std dev =       0.707858938405
             le_variance =       0.501064276680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501498912706
                                         uncertainty =       0.002698342373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501498912706
                                         uncertainty =       0.002698342373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500700393
  error estimate for blocks of size 2^( 2) =       0.000522119368
  error estimate for blocks of size 2^( 3) =       0.000542188945
  error estimate for blocks of size 2^( 4) =       0.000557717983
  error estimate for blocks of size 2^( 5) =       0.000567755577
  error estimate for blocks of size 2^( 6) =       0.000571825966
  error estimate for blocks of size 2^( 7) =       0.000576218422

      target function =      -0.692603460069
              le_mean =     -22.810926874819
             les_mean =     520.859531041374
             stat err =       0.000568379487
             autocorr =       1.288608308304
   target nu stat err =       0.000568379487
   target dn stat err =       0.003779773845
      target stat err =       0.002568790824
              std dev =       0.708097286256
             le_variance =       0.501401766803


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.692543416661        initial
     4.0000e+00     4.0000e+01             4.0062e-04        -0.692827358235
     1.6000e+01     1.6000e+02             1.0104e-04        -0.692841019401  <--
     6.4000e+01     6.4000e+02             2.5316e-05        -0.692603460069

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.5074e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.604738e-01 3 1  ON 0
ci_02                -5.557790e-02 3 1  ON 1
ci_03                -5.558149e-02 3 1  ON 2
ci_04                 5.460160e-02 3 1  ON 3
ci_05                -3.892725e-02 3 1  ON 4
ci_06                -3.894122e-02 3 1  ON 5
ci_07                 3.033676e-02 3 1  ON 6
ci_08                -1.757986e-02 3 1  ON 7
ci_09                -1.675164e-02 3 1  ON 8
ci_10                -1.669808e-02 3 1  ON 9
ci_11                 1.596314e-02 3 1  ON 10
ci_12                 1.289194e-02 3 1  ON 11
ci_13                 1.270113e-02 3 1  ON 12
ci_14                 1.277271e-02 3 1  ON 13
ci_15                 1.194661e-02 3 1  ON 14
ci_16                 1.189468e-02 3 1  ON 15
ci_17                -1.149186e-02 3 1  ON 16
ci_18                -1.159933e-02 3 1  ON 17
ci_19                 1.147750e-02 3 1  ON 18
ci_20                 1.021119e-02 3 1  ON 19
ci_21                 9.853109e-03 3 1  ON 20
ci_22                 9.823450e-03 3 1  ON 21
ci_23                 6.627572e-03 3 1  ON 22
ci_24                 5.260761e-03 3 1  ON 23
ci_25                 5.017269e-03 3 1  ON 24
ci_26                 4.657984e-03 3 1  ON 25
ci_27                 4.693992e-03 3 1  ON 26
ci_28                 3.961552e-03 3 1  ON 27
ci_29                 4.049115e-03 3 1  ON 28
ci_30                -3.543464e-03 3 1  ON 29
ci_31                -3.457193e-03 3 1  ON 30
ci_32                -3.238930e-03 3 1  ON 31
ci_33                -3.223209e-03 3 1  ON 32
ci_34                 2.685249e-03 3 1  ON 33
ci_35                 2.661717e-03 3 1  ON 34
ci_36                -2.479524e-03 3 1  ON 35
ci_37                -2.433879e-03 3 1  ON 36
ci_38                -1.997127e-03 3 1  ON 37
ci_39                -1.977074e-03 3 1  ON 38
ci_40                -1.983696e-03 3 1  ON 39
ci_41                -1.876103e-03 3 1  ON 40
ci_42                -1.953128e-03 3 1  ON 41
ci_43                -2.032631e-03 3 1  ON 42
ci_44                -1.990852e-03 3 1  ON 43
ci_45                -1.752722e-03 3 1  ON 44
ci_46                -1.762832e-03 3 1  ON 45
ci_47                -1.631793e-03 3 1  ON 46
ci_48                -1.646570e-03 3 1  ON 47
ci_49                -1.697157e-03 3 1  ON 48
ci_50                -1.619243e-03 3 1  ON 49
ci_51                 1.584901e-03 3 1  ON 50
ci_52                 1.536302e-03 3 1  ON 51
ci_53                -1.441311e-03 3 1  ON 52
ci_54                -1.412540e-03 3 1  ON 53
ci_55                -1.420509e-03 3 1  ON 54
ci_56                 1.440967e-03 3 1  ON 55
ci_57                 1.380600e-03 3 1  ON 56
ci_58                -1.207936e-03 3 1  ON 57
ci_59                -1.257524e-03 3 1  ON 58
ci_60                 1.106479e-03 3 1  ON 59
ci_61                 1.170878e-03 3 1  ON 60
ci_62                -1.105543e-03 3 1  ON 61
ci_63                -1.064430e-03 3 1  ON 62
ci_64                -1.020893e-03 3 1  ON 63
ci_65                -1.038639e-03 3 1  ON 64
ci_66                -9.856425e-04 3 1  ON 65
ci_67                -9.733305e-04 3 1  ON 66
ci_68                 7.871493e-04 3 1  ON 67
ci_69                 7.995188e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5474e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2831e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7824
    reference variance = 0.289184
====================================================
  Execution time = 2.5795e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1595e-01
  Total weights = 1.962796666e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499208946745
                                         uncertainty =       0.002383619915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499208946745
                                         uncertainty =       0.002383619915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499554159
  error estimate for blocks of size 2^( 2) =       0.000520722289
  error estimate for blocks of size 2^( 3) =       0.000540803979
  error estimate for blocks of size 2^( 4) =       0.000556790464
  error estimate for blocks of size 2^( 5) =       0.000566226336
  error estimate for blocks of size 2^( 6) =       0.000571900313
  error estimate for blocks of size 2^( 7) =       0.000573037826

      target function =      -0.696075439201
              le_mean =     -22.811152230522
             les_mean =     520.864617967928
             stat err =       0.000566988735
             autocorr =       1.288201208423
   target nu stat err =       0.000566988735
   target dn stat err =       0.002897726969
      target stat err =       0.002019802781
              std dev =       0.706476266754
             le_variance =       0.499108715486


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281115223052e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696080466788       residual = 9.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696267301174       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696298553138       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696302894366       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696304075229       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696304474283       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696304599689       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696304612193       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696304616531       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696304617074       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696304616051       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.146039e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696080466788       residual = 9.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696127563516       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696135416046       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696136502986       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696136797298       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696136896058       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696136926896       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696136929968       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696136931036       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696136931167       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696136930914       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.045622e-04

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696080466788       residual = 9.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696092265471       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696094231082       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696094502917       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696094576437       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696094601063       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696094608741       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696094609505       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696094609771       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696094609804       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696094609741       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+01 is 2.619809e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.387111 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0420e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.603865e-01 3 1  ON 0
ci_02                -5.548753e-02 3 1  ON 1
ci_03                -5.549753e-02 3 1  ON 2
ci_04                 5.449704e-02 3 1  ON 3
ci_05                -3.887103e-02 3 1  ON 4
ci_06                -3.888199e-02 3 1  ON 5
ci_07                 3.032806e-02 3 1  ON 6
ci_08                -1.753948e-02 3 1  ON 7
ci_09                -1.672663e-02 3 1  ON 8
ci_10                -1.667302e-02 3 1  ON 9
ci_11                 1.595669e-02 3 1  ON 10
ci_12                 1.287736e-02 3 1  ON 11
ci_13                 1.269704e-02 3 1  ON 12
ci_14                 1.278027e-02 3 1  ON 13
ci_15                 1.192614e-02 3 1  ON 14
ci_16                 1.188029e-02 3 1  ON 15
ci_17                -1.147802e-02 3 1  ON 16
ci_18                -1.158041e-02 3 1  ON 17
ci_19                 1.147298e-02 3 1  ON 18
ci_20                 1.019777e-02 3 1  ON 19
ci_21                 9.853926e-03 3 1  ON 20
ci_22                 9.816651e-03 3 1  ON 21
ci_23                 6.619804e-03 3 1  ON 22
ci_24                 5.257351e-03 3 1  ON 23
ci_25                 5.010688e-03 3 1  ON 24
ci_26                 4.652761e-03 3 1  ON 25
ci_27                 4.686041e-03 3 1  ON 26
ci_28                 3.958285e-03 3 1  ON 27
ci_29                 4.043595e-03 3 1  ON 28
ci_30                -3.540141e-03 3 1  ON 29
ci_31                -3.449452e-03 3 1  ON 30
ci_32                -3.229575e-03 3 1  ON 31
ci_33                -3.216005e-03 3 1  ON 32
ci_34                 2.681543e-03 3 1  ON 33
ci_35                 2.658373e-03 3 1  ON 34
ci_36                -2.475278e-03 3 1  ON 35
ci_37                -2.430255e-03 3 1  ON 36
ci_38                -1.993499e-03 3 1  ON 37
ci_39                -1.971270e-03 3 1  ON 38
ci_40                -1.981998e-03 3 1  ON 39
ci_41                -1.870781e-03 3 1  ON 40
ci_42                -1.950142e-03 3 1  ON 41
ci_43                -2.033874e-03 3 1  ON 42
ci_44                -1.991940e-03 3 1  ON 43
ci_45                -1.747623e-03 3 1  ON 44
ci_46                -1.757328e-03 3 1  ON 45
ci_47                -1.624806e-03 3 1  ON 46
ci_48                -1.640895e-03 3 1  ON 47
ci_49                -1.695815e-03 3 1  ON 48
ci_50                -1.615465e-03 3 1  ON 49
ci_51                 1.581183e-03 3 1  ON 50
ci_52                 1.534733e-03 3 1  ON 51
ci_53                -1.439719e-03 3 1  ON 52
ci_54                -1.408851e-03 3 1  ON 53
ci_55                -1.418693e-03 3 1  ON 54
ci_56                 1.441721e-03 3 1  ON 55
ci_57                 1.379313e-03 3 1  ON 56
ci_58                -1.209043e-03 3 1  ON 57
ci_59                -1.257406e-03 3 1  ON 58
ci_60                 1.103622e-03 3 1  ON 59
ci_61                 1.177695e-03 3 1  ON 60
ci_62                -1.103886e-03 3 1  ON 61
ci_63                -1.061397e-03 3 1  ON 62
ci_64                -1.016247e-03 3 1  ON 63
ci_65                -1.039735e-03 3 1  ON 64
ci_66                -9.877761e-04 3 1  ON 65
ci_67                -9.720770e-04 3 1  ON 66
ci_68                 7.852418e-04 3 1  ON 67
ci_69                 7.960023e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6799
    reference variance = 0.581269
====================================================
  Execution time = 2.5090e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2810e+01
  VMC Evar = 5.1631e-01
  Total weights = 1.9628e+06
  Execution time = 3.6101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500688019469
                                         uncertainty =       0.002928562739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500688019469
                                         uncertainty =       0.002928562739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500296657
  error estimate for blocks of size 2^( 2) =       0.000521536636
  error estimate for blocks of size 2^( 3) =       0.000541945538
  error estimate for blocks of size 2^( 4) =       0.000557382363
  error estimate for blocks of size 2^( 5) =       0.000567028238
  error estimate for blocks of size 2^( 6) =       0.000572254170
  error estimate for blocks of size 2^( 7) =       0.000578204171

      target function =      -0.695580742104
              le_mean =     -22.810043116293
             les_mean =     520.814744800725
             stat err =       0.000568717235
             autocorr =       1.292223334691
   target nu stat err =       0.000568717235
   target dn stat err =       0.003445444482
      target stat err =       0.002369169630
              std dev =       0.707526316914
             le_variance =       0.500593489126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499992493091
                                         uncertainty =       0.002923442494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499992493091
                                         uncertainty =       0.002923442494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499948985
  error estimate for blocks of size 2^( 2) =       0.000521170231
  error estimate for blocks of size 2^( 3) =       0.000541562283
  error estimate for blocks of size 2^( 4) =       0.000556990040
  error estimate for blocks of size 2^( 5) =       0.000566640968
  error estimate for blocks of size 2^( 6) =       0.000571868331
  error estimate for blocks of size 2^( 7) =       0.000577813148

      target function =      -0.696131083521
              le_mean =     -22.810044788668
             les_mean =     520.813999268983
             stat err =       0.000568328122
             autocorr =       1.292251102558
   target nu stat err =       0.000568328122
   target dn stat err =       0.003430398110
      target stat err =       0.002362929173
              std dev =       0.707034634465
             le_variance =       0.499897974333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500334752906
                                         uncertainty =       0.002925884578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500334752906
                                         uncertainty =       0.002925884578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500120101
  error estimate for blocks of size 2^( 2) =       0.000521350580
  error estimate for blocks of size 2^( 3) =       0.000541751012
  error estimate for blocks of size 2^( 4) =       0.000557183215
  error estimate for blocks of size 2^( 5) =       0.000566831641
  error estimate for blocks of size 2^( 6) =       0.000572058327
  error estimate for blocks of size 2^( 7) =       0.000578005840

      target function =      -0.695943826747
              le_mean =     -22.810043695670
             les_mean =     520.814228897067
             stat err =       0.000568519756
             autocorr =       1.292237982894
   target nu stat err =       0.000568519756
   target dn stat err =       0.003433956026
      target stat err =       0.002364049490
              std dev =       0.707276629114
             le_variance =       0.500240230091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500644615568
                                         uncertainty =       0.002928102791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500644615568
                                         uncertainty =       0.002928102791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500274969
  error estimate for blocks of size 2^( 2) =       0.000521513599
  error estimate for blocks of size 2^( 3) =       0.000541920906
  error estimate for blocks of size 2^( 4) =       0.000557356891
  error estimate for blocks of size 2^( 5) =       0.000567002259
  error estimate for blocks of size 2^( 6) =       0.000572226852
  error estimate for blocks of size 2^( 7) =       0.000578175309

      target function =      -0.648930410689
              le_mean =     -22.810042440187
             les_mean =     520.884973948693
             stat err =       0.000568690328
             autocorr =       1.292213088723
   target nu stat err =       0.000568690328
   target dn stat err =       0.070633244817
      target stat err =       0.041299721614
              std dev =       0.707495646443
             le_variance =       0.500550089735


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.695580742104        initial
     4.0000e+00     4.0000e+01             4.1460e-04        -0.696131083521  <--
     1.6000e+01     1.6000e+02             1.0456e-04        -0.695943826747
     6.4000e+01     6.4000e+02             2.6198e-05        -0.648930410689

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.3199e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.601262e-01 3 1  ON 0
ci_02                -5.521921e-02 3 1  ON 1
ci_03                -5.524821e-02 3 1  ON 2
ci_04                 5.418699e-02 3 1  ON 3
ci_05                -3.870422e-02 3 1  ON 4
ci_06                -3.870623e-02 3 1  ON 5
ci_07                 3.030217e-02 3 1  ON 6
ci_08                -1.741968e-02 3 1  ON 7
ci_09                -1.665230e-02 3 1  ON 8
ci_10                -1.659852e-02 3 1  ON 9
ci_11                 1.593754e-02 3 1  ON 10
ci_12                 1.283409e-02 3 1  ON 11
ci_13                 1.268487e-02 3 1  ON 12
ci_14                 1.280285e-02 3 1  ON 13
ci_15                 1.186539e-02 3 1  ON 14
ci_16                 1.183756e-02 3 1  ON 15
ci_17                -1.143683e-02 3 1  ON 16
ci_18                -1.152419e-02 3 1  ON 17
ci_19                 1.145962e-02 3 1  ON 18
ci_20                 1.015796e-02 3 1  ON 19
ci_21                 9.856367e-03 3 1  ON 20
ci_22                 9.796413e-03 3 1  ON 21
ci_23                 6.596802e-03 3 1  ON 22
ci_24                 5.247228e-03 3 1  ON 23
ci_25                 4.991189e-03 3 1  ON 24
ci_26                 4.637292e-03 3 1  ON 25
ci_27                 4.662449e-03 3 1  ON 26
ci_28                 3.948543e-03 3 1  ON 27
ci_29                 4.027176e-03 3 1  ON 28
ci_30                -3.530225e-03 3 1  ON 29
ci_31                -3.426379e-03 3 1  ON 30
ci_32                -3.201898e-03 3 1  ON 31
ci_33                -3.194696e-03 3 1  ON 32
ci_34                 2.670618e-03 3 1  ON 33
ci_35                 2.648520e-03 3 1  ON 34
ci_36                -2.462665e-03 3 1  ON 35
ci_37                -2.419494e-03 3 1  ON 36
ci_38                -1.982735e-03 3 1  ON 37
ci_39                -1.954047e-03 3 1  ON 38
ci_40                -1.976962e-03 3 1  ON 39
ci_41                -1.855061e-03 3 1  ON 40
ci_42                -1.941351e-03 3 1  ON 41
ci_43                -2.037511e-03 3 1  ON 42
ci_44                -1.995111e-03 3 1  ON 43
ci_45                -1.732496e-03 3 1  ON 44
ci_46                -1.741005e-03 3 1  ON 45
ci_47                -1.603964e-03 3 1  ON 46
ci_48                -1.623988e-03 3 1  ON 47
ci_49                -1.691826e-03 3 1  ON 48
ci_50                -1.604269e-03 3 1  ON 49
ci_51                 1.570151e-03 3 1  ON 50
ci_52                 1.530058e-03 3 1  ON 51
ci_53                -1.434996e-03 3 1  ON 52
ci_54                -1.397890e-03 3 1  ON 53
ci_55                -1.413295e-03 3 1  ON 54
ci_56                 1.443966e-03 3 1  ON 55
ci_57                 1.375501e-03 3 1  ON 56
ci_58                -1.212345e-03 3 1  ON 57
ci_59                -1.257073e-03 3 1  ON 58
ci_60                 1.095091e-03 3 1  ON 59
ci_61                 1.198039e-03 3 1  ON 60
ci_62                -1.098958e-03 3 1  ON 61
ci_63                -1.052399e-03 3 1  ON 62
ci_64                -1.002454e-03 3 1  ON 63
ci_65                -1.042985e-03 3 1  ON 64
ci_66                -9.940979e-04 3 1  ON 65
ci_67                -9.683474e-04 3 1  ON 66
ci_68                 7.795712e-04 3 1  ON 67
ci_69                 7.855674e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3625e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8294
    reference variance = 0.322946
====================================================
  Execution time = 2.5652e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.0974e-01
  Total weights = 1.962880403e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495843081653
                                         uncertainty =       0.002519331579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495843081653
                                         uncertainty =       0.002519331579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497895710
  error estimate for blocks of size 2^( 2) =       0.000519176126
  error estimate for blocks of size 2^( 3) =       0.000539725472
  error estimate for blocks of size 2^( 4) =       0.000554912476
  error estimate for blocks of size 2^( 5) =       0.000565455524
  error estimate for blocks of size 2^( 6) =       0.000571207323
  error estimate for blocks of size 2^( 7) =       0.000576663148

      target function =      -0.700268034125
              le_mean =     -22.810799748492
             les_mean =     520.842320441211
             stat err =       0.000567059618
             autocorr =       1.297121542213
   target nu stat err =       0.000567059618
   target dn stat err =       0.002919880607
      target stat err =       0.002056822388
              std dev =       0.704130866410
             le_variance =       0.495800277031


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281079974849e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.700273192938       residual = 8.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701001059815       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.701113525105       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.701129022641       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.701133789036       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.701135267370       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.701135357800       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.701135380607       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.701135377914       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.701135372202       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.701135374203       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.572164e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.700273192938       residual = 8.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.700461197481       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.700489884853       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.700493783804       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.700494961939       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.700495317363       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.700495336660       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.700495341575       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.700495340881       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.700495339499       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.700495339989       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.068379e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.700273192938       residual = 8.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.700320586629       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.700327794629       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.700328770758       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.700329064349       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.700329152285       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.700329156904       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.700329158083       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.700329157909       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.700329157567       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.700329157688       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.026084e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.391228 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0239e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.597970e-01 3 1  ON 0
ci_02                -5.487853e-02 3 1  ON 1
ci_03                -5.490847e-02 3 1  ON 2
ci_04                 5.378016e-02 3 1  ON 3
ci_05                -3.848426e-02 3 1  ON 4
ci_06                -3.846094e-02 3 1  ON 5
ci_07                 3.026416e-02 3 1  ON 6
ci_08                -1.726309e-02 3 1  ON 7
ci_09                -1.657030e-02 3 1  ON 8
ci_10                -1.649559e-02 3 1  ON 9
ci_11                 1.590605e-02 3 1  ON 10
ci_12                 1.277428e-02 3 1  ON 11
ci_13                 1.268618e-02 3 1  ON 12
ci_14                 1.281484e-02 3 1  ON 13
ci_15                 1.178245e-02 3 1  ON 14
ci_16                 1.179552e-02 3 1  ON 15
ci_17                -1.139175e-02 3 1  ON 16
ci_18                -1.145368e-02 3 1  ON 17
ci_19                 1.143507e-02 3 1  ON 18
ci_20                 1.011187e-02 3 1  ON 19
ci_21                 9.851745e-03 3 1  ON 20
ci_22                 9.787041e-03 3 1  ON 21
ci_23                 6.566075e-03 3 1  ON 22
ci_24                 5.238971e-03 3 1  ON 23
ci_25                 4.963597e-03 3 1  ON 24
ci_26                 4.604329e-03 3 1  ON 25
ci_27                 4.638321e-03 3 1  ON 26
ci_28                 3.919374e-03 3 1  ON 27
ci_29                 3.999902e-03 3 1  ON 28
ci_30                -3.497527e-03 3 1  ON 29
ci_31                -3.412413e-03 3 1  ON 30
ci_32                -3.175868e-03 3 1  ON 31
ci_33                -3.168886e-03 3 1  ON 32
ci_34                 2.645084e-03 3 1  ON 33
ci_35                 2.609820e-03 3 1  ON 34
ci_36                -2.441745e-03 3 1  ON 35
ci_37                -2.406399e-03 3 1  ON 36
ci_38                -1.960072e-03 3 1  ON 37
ci_39                -1.937922e-03 3 1  ON 38
ci_40                -1.975151e-03 3 1  ON 39
ci_41                -1.845037e-03 3 1  ON 40
ci_42                -1.923487e-03 3 1  ON 41
ci_43                -2.057169e-03 3 1  ON 42
ci_44                -1.993915e-03 3 1  ON 43
ci_45                -1.710529e-03 3 1  ON 44
ci_46                -1.729692e-03 3 1  ON 45
ci_47                -1.587532e-03 3 1  ON 46
ci_48                -1.589127e-03 3 1  ON 47
ci_49                -1.675913e-03 3 1  ON 48
ci_50                -1.592063e-03 3 1  ON 49
ci_51                 1.553805e-03 3 1  ON 50
ci_52                 1.522292e-03 3 1  ON 51
ci_53                -1.423747e-03 3 1  ON 52
ci_54                -1.387013e-03 3 1  ON 53
ci_55                -1.410700e-03 3 1  ON 54
ci_56                 1.441267e-03 3 1  ON 55
ci_57                 1.381326e-03 3 1  ON 56
ci_58                -1.207566e-03 3 1  ON 57
ci_59                -1.257749e-03 3 1  ON 58
ci_60                 1.099124e-03 3 1  ON 59
ci_61                 1.174082e-03 3 1  ON 60
ci_62                -1.078547e-03 3 1  ON 61
ci_63                -1.048062e-03 3 1  ON 62
ci_64                -1.005095e-03 3 1  ON 63
ci_65                -1.031520e-03 3 1  ON 64
ci_66                -9.967808e-04 3 1  ON 65
ci_67                -9.668525e-04 3 1  ON 66
ci_68                 7.563040e-04 3 1  ON 67
ci_69                 7.645899e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7203
    reference variance = 0.41337
====================================================
  Execution time = 2.4953e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.2518e-01
  Total weights = 1.9631e+06
  Execution time = 3.5772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501674856315
                                         uncertainty =       0.003293471795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501674856315
                                         uncertainty =       0.003293471795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500805550
  error estimate for blocks of size 2^( 2) =       0.000521432118
  error estimate for blocks of size 2^( 3) =       0.000541426246
  error estimate for blocks of size 2^( 4) =       0.000555857246
  error estimate for blocks of size 2^( 5) =       0.000565073414
  error estimate for blocks of size 2^( 6) =       0.000568203405
  error estimate for blocks of size 2^( 7) =       0.000571143114

      target function =      -0.688648004684
              le_mean =     -22.812256016424
             les_mean =     520.926117541458
             stat err =       0.000565069295
             autocorr =       1.273107719958
   target nu stat err =       0.000565069295
   target dn stat err =       0.006888682163
      target stat err =       0.004563462971
              std dev =       0.708246000963
             le_variance =       0.501612397880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498824845633
                                         uncertainty =       0.003214035517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498824845633
                                         uncertainty =       0.003214035517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499381308
  error estimate for blocks of size 2^( 2) =       0.000519947425
  error estimate for blocks of size 2^( 3) =       0.000539898412
  error estimate for blocks of size 2^( 4) =       0.000554317900
  error estimate for blocks of size 2^( 5) =       0.000563527139
  error estimate for blocks of size 2^( 6) =       0.000566664226
  error estimate for blocks of size 2^( 7) =       0.000569598623

      target function =      -0.684830230149
              le_mean =     -22.812266631239
             les_mean =     520.932360428340
             stat err =       0.000563526972
             autocorr =       1.273400014037
   target nu stat err =       0.000563526972
   target dn stat err =       0.011375948757
      target stat err =       0.007420436241
              std dev =       0.706231818104
             le_variance =       0.498763380903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500135612887
                                         uncertainty =       0.003241797640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500135612887
                                         uncertainty =       0.003241797640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500036889
  error estimate for blocks of size 2^( 2) =       0.000520631856
  error estimate for blocks of size 2^( 3) =       0.000540604647
  error estimate for blocks of size 2^( 4) =       0.000555028027
  error estimate for blocks of size 2^( 5) =       0.000564239681
  error estimate for blocks of size 2^( 6) =       0.000567369042
  error estimate for blocks of size 2^( 7) =       0.000570303608

      target function =      -0.688315943872
              le_mean =     -22.812256900394
             les_mean =     520.926658209552
             stat err =       0.000564235089
             autocorr =       1.273257060982
   target nu stat err =       0.000564235089
   target dn stat err =       0.007246248430
      target stat err =       0.004792444359
              std dev =       0.707158950020
             le_variance =       0.500073780593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501471756505
                                         uncertainty =       0.003285095330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501471756505
                                         uncertainty =       0.003285095330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500704201
  error estimate for blocks of size 2^( 2) =       0.000521327003
  error estimate for blocks of size 2^( 3) =       0.000541318390
  error estimate for blocks of size 2^( 4) =       0.000555748770
  error estimate for blocks of size 2^( 5) =       0.000564964902
  error estimate for blocks of size 2^( 6) =       0.000568095265
  error estimate for blocks of size 2^( 7) =       0.000571034058

      target function =      -0.689060699079
              le_mean =     -22.812255624662
             les_mean =     520.925473970197
             stat err =       0.000564960749
             autocorr =       1.273133896574
   target nu stat err =       0.000564960749
   target dn stat err =       0.006785525067
      target stat err =       0.004501420058
              std dev =       0.708102671818
             le_variance =       0.501409393835


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.688648004684        initial
     1.0000e+00     1.0000e+01             1.5722e-03        -0.684830230149
     4.0000e+00     4.0000e+01             4.0684e-04        -0.688315943872
     1.6000e+01     1.6000e+02             1.0261e-04        -0.689060699079  <--

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.2894e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.600435e-01 3 1  ON 0
ci_02                -5.513338e-02 3 1  ON 1
ci_03                -5.516261e-02 3 1  ON 2
ci_04                 5.408439e-02 3 1  ON 3
ci_05                -3.864877e-02 3 1  ON 4
ci_06                -3.864441e-02 3 1  ON 5
ci_07                 3.029261e-02 3 1  ON 6
ci_08                -1.738020e-02 3 1  ON 7
ci_09                -1.663166e-02 3 1  ON 8
ci_10                -1.657261e-02 3 1  ON 9
ci_11                 1.592961e-02 3 1  ON 10
ci_12                 1.281901e-02 3 1  ON 11
ci_13                 1.268520e-02 3 1  ON 12
ci_14                 1.280585e-02 3 1  ON 13
ci_15                 1.184450e-02 3 1  ON 14
ci_16                 1.182696e-02 3 1  ON 15
ci_17                -1.142549e-02 3 1  ON 16
ci_18                -1.150644e-02 3 1  ON 17
ci_19                 1.145342e-02 3 1  ON 18
ci_20                 1.014634e-02 3 1  ON 19
ci_21                 9.855206e-03 3 1  ON 20
ci_22                 9.794058e-03 3 1  ON 21
ci_23                 6.589046e-03 3 1  ON 22
ci_24                 5.245153e-03 3 1  ON 23
ci_25                 4.984230e-03 3 1  ON 24
ci_26                 4.628986e-03 3 1  ON 25
ci_27                 4.656363e-03 3 1  ON 26
ci_28                 3.941203e-03 3 1  ON 27
ci_29                 4.020319e-03 3 1  ON 28
ci_30                -3.522010e-03 3 1  ON 29
ci_31                -3.422874e-03 3 1  ON 30
ci_32                -3.195318e-03 3 1  ON 31
ci_33                -3.188171e-03 3 1  ON 32
ci_34                 2.664163e-03 3 1  ON 33
ci_35                 2.638746e-03 3 1  ON 34
ci_36                -2.457393e-03 3 1  ON 35
ci_37                -2.416195e-03 3 1  ON 36
ci_38                -1.977022e-03 3 1  ON 37
ci_39                -1.949984e-03 3 1  ON 38
ci_40                -1.976506e-03 3 1  ON 39
ci_41                -1.852515e-03 3 1  ON 40
ci_42                -1.936830e-03 3 1  ON 41
ci_43                -2.042479e-03 3 1  ON 42
ci_44                -1.994824e-03 3 1  ON 43
ci_45                -1.726959e-03 3 1  ON 44
ci_46                -1.738155e-03 3 1  ON 45
ci_47                -1.599837e-03 3 1  ON 46
ci_48                -1.615229e-03 3 1  ON 47
ci_49                -1.687814e-03 3 1  ON 48
ci_50                -1.601191e-03 3 1  ON 49
ci_51                 1.566031e-03 3 1  ON 50
ci_52                 1.528106e-03 3 1  ON 51
ci_53                -1.432157e-03 3 1  ON 52
ci_54                -1.395149e-03 3 1  ON 53
ci_55                -1.412645e-03 3 1  ON 54
ci_56                 1.443283e-03 3 1  ON 55
ci_57                 1.376968e-03 3 1  ON 56
ci_58                -1.211140e-03 3 1  ON 57
ci_59                -1.257242e-03 3 1  ON 58
ci_60                 1.096104e-03 3 1  ON 59
ci_61                 1.192027e-03 3 1  ON 60
ci_62                -1.093813e-03 3 1  ON 61
ci_63                -1.051308e-03 3 1  ON 62
ci_64                -1.003123e-03 3 1  ON 63
ci_65                -1.040098e-03 3 1  ON 64
ci_66                -9.947768e-04 3 1  ON 65
ci_67                -9.679730e-04 3 1  ON 66
ci_68                 7.737112e-04 3 1  ON 67
ci_69                 7.802804e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3139e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.7577
    reference variance = 0.432991
====================================================
  Execution time = 2.5673e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5339e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1808e-01
  Total weights = 1.962995756e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499461647976
                                         uncertainty =       0.003315076372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499461647976
                                         uncertainty =       0.003315076372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499662567
  error estimate for blocks of size 2^( 2) =       0.000520656684
  error estimate for blocks of size 2^( 3) =       0.000540921725
  error estimate for blocks of size 2^( 4) =       0.000556596673
  error estimate for blocks of size 2^( 5) =       0.000567037343
  error estimate for blocks of size 2^( 6) =       0.000570161799
  error estimate for blocks of size 2^( 7) =       0.000570022848

      target function =      -0.694633783977
              le_mean =     -22.810536108476
             les_mean =     520.838635422391
             stat err =       0.000565954666
             autocorr =       1.282949790359
   target nu stat err =       0.000565954666
   target dn stat err =       0.005740430750
      target stat err =       0.003871251369
              std dev =       0.706629578375
             le_variance =       0.499325361035


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281053610848e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.694654653810       residual = 9.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.694841652186       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.694869131277       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.694873077945       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.694874205586       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.694874835508       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.694874985994       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.694875021792       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.694875016486       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.694875018876       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.694875018806       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.075420e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.694654653810       residual = 9.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.694701791765       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.694708695855       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.694709684225       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.694709965805       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.694710122185       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.694710159257       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.694710168090       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.694710166765       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.694710167356       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.694710167338       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.027826e-04

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.694654653810       residual = 9.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.694666462815       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.694668190988       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.694668438185       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.694668508558       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.694668547584       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.694668556817       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.694668559018       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.694668558687       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.694668558834       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.694668558829       residual = 1.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+01 is 2.575231e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.395362 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0263e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.599652e-01 3 1  ON 0
ci_02                -5.504598e-02 3 1  ON 1
ci_03                -5.508394e-02 3 1  ON 2
ci_04                 5.398160e-02 3 1  ON 3
ci_05                -3.859262e-02 3 1  ON 4
ci_06                -3.858531e-02 3 1  ON 5
ci_07                 3.028356e-02 3 1  ON 6
ci_08                -1.733887e-02 3 1  ON 7
ci_09                -1.660083e-02 3 1  ON 8
ci_10                -1.654669e-02 3 1  ON 9
ci_11                 1.591523e-02 3 1  ON 10
ci_12                 1.280581e-02 3 1  ON 11
ci_13                 1.268470e-02 3 1  ON 12
ci_14                 1.280443e-02 3 1  ON 13
ci_15                 1.182778e-02 3 1  ON 14
ci_16                 1.180917e-02 3 1  ON 15
ci_17                -1.141397e-02 3 1  ON 16
ci_18                -1.149383e-02 3 1  ON 17
ci_19                 1.144718e-02 3 1  ON 18
ci_20                 1.013792e-02 3 1  ON 19
ci_21                 9.853229e-03 3 1  ON 20
ci_22                 9.792366e-03 3 1  ON 21
ci_23                 6.583501e-03 3 1  ON 22
ci_24                 5.244314e-03 3 1  ON 23
ci_25                 4.975920e-03 3 1  ON 24
ci_26                 4.625180e-03 3 1  ON 25
ci_27                 4.652269e-03 3 1  ON 26
ci_28                 3.936255e-03 3 1  ON 27
ci_29                 4.004057e-03 3 1  ON 28
ci_30                -3.517648e-03 3 1  ON 29
ci_31                -3.418135e-03 3 1  ON 30
ci_32                -3.184869e-03 3 1  ON 31
ci_33                -3.177314e-03 3 1  ON 32
ci_34                 2.658022e-03 3 1  ON 33
ci_35                 2.626392e-03 3 1  ON 34
ci_36                -2.452963e-03 3 1  ON 35
ci_37                -2.413747e-03 3 1  ON 36
ci_38                -1.973796e-03 3 1  ON 37
ci_39                -1.947419e-03 3 1  ON 38
ci_40                -1.974455e-03 3 1  ON 39
ci_41                -1.846106e-03 3 1  ON 40
ci_42                -1.931559e-03 3 1  ON 41
ci_43                -2.044473e-03 3 1  ON 42
ci_44                -1.994392e-03 3 1  ON 43
ci_45                -1.720961e-03 3 1  ON 44
ci_46                -1.735697e-03 3 1  ON 45
ci_47                -1.591783e-03 3 1  ON 46
ci_48                -1.607540e-03 3 1  ON 47
ci_49                -1.689237e-03 3 1  ON 48
ci_50                -1.596877e-03 3 1  ON 49
ci_51                 1.563272e-03 3 1  ON 50
ci_52                 1.523856e-03 3 1  ON 51
ci_53                -1.429124e-03 3 1  ON 52
ci_54                -1.394064e-03 3 1  ON 53
ci_55                -1.409880e-03 3 1  ON 54
ci_56                 1.444808e-03 3 1  ON 55
ci_57                 1.377905e-03 3 1  ON 56
ci_58                -1.211818e-03 3 1  ON 57
ci_59                -1.257917e-03 3 1  ON 58
ci_60                 1.095714e-03 3 1  ON 59
ci_61                 1.191888e-03 3 1  ON 60
ci_62                -1.090691e-03 3 1  ON 61
ci_63                -1.049677e-03 3 1  ON 62
ci_64                -1.003251e-03 3 1  ON 63
ci_65                -1.037437e-03 3 1  ON 64
ci_66                -9.945745e-04 3 1  ON 65
ci_67                -9.664475e-04 3 1  ON 66
ci_68                 7.726473e-04 3 1  ON 67
ci_69                 7.723939e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8065
    reference variance = 0.583973
====================================================
  Execution time = 2.5070e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1927e-01
  Total weights = 1.9630e+06
  Execution time = 3.5841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502250918026
                                         uncertainty =       0.002896223061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502250918026
                                         uncertainty =       0.002896223061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501207588
  error estimate for blocks of size 2^( 2) =       0.000522693723
  error estimate for blocks of size 2^( 3) =       0.000542708559
  error estimate for blocks of size 2^( 4) =       0.000557770142
  error estimate for blocks of size 2^( 5) =       0.000568184853
  error estimate for blocks of size 2^( 6) =       0.000571114449
  error estimate for blocks of size 2^( 7) =       0.000574985503

      target function =      -0.693704005903
              le_mean =     -22.810550193426
             les_mean =     520.840687321732
             stat err =       0.000568013737
             autocorr =       1.284347079130
   target nu stat err =       0.000568013737
   target dn stat err =       0.004194165534
      target stat err =       0.002845658795
              std dev =       0.708814569161
             le_variance =       0.502418093454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501567443384
                                         uncertainty =       0.002889222794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501567443384
                                         uncertainty =       0.002889222794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500866522
  error estimate for blocks of size 2^( 2) =       0.000522333757
  error estimate for blocks of size 2^( 3) =       0.000542336979
  error estimate for blocks of size 2^( 4) =       0.000557393214
  error estimate for blocks of size 2^( 5) =       0.000567808956
  error estimate for blocks of size 2^( 6) =       0.000570741498
  error estimate for blocks of size 2^( 7) =       0.000574613965

      target function =      -0.693370783815
              le_mean =     -22.810551502678
             les_mean =     520.841246530097
             stat err =       0.000567639408
             autocorr =       1.284402283910
   target nu stat err =       0.000567639408
   target dn stat err =       0.004339431290
      target stat err =       0.002937824755
              std dev =       0.708332227957
             le_variance =       0.501734545162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501903488191
                                         uncertainty =       0.002892630154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501903488191
                                         uncertainty =       0.002892630154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501034245
  error estimate for blocks of size 2^( 2) =       0.000522511053
  error estimate for blocks of size 2^( 3) =       0.000542520042
  error estimate for blocks of size 2^( 4) =       0.000557578653
  error estimate for blocks of size 2^( 5) =       0.000567994071
  error estimate for blocks of size 2^( 6) =       0.000570925045
  error estimate for blocks of size 2^( 7) =       0.000574797956

      target function =      -0.693775603891
              le_mean =     -22.810550647089
             les_mean =     520.840600436762
             stat err =       0.000567823931
             autocorr =       1.284377132717
   target nu stat err =       0.000567823931
   target dn stat err =       0.004203123876
      target stat err =       0.002852058980
              std dev =       0.708569423937
             le_variance =       0.502070628538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502207118035
                                         uncertainty =       0.002895764719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502207118035
                                         uncertainty =       0.002895764719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501185739
  error estimate for blocks of size 2^( 2) =       0.000522670701
  error estimate for blocks of size 2^( 3) =       0.000542684795
  error estimate for blocks of size 2^( 4) =       0.000557746006
  error estimate for blocks of size 2^( 5) =       0.000568160829
  error estimate for blocks of size 2^( 6) =       0.000571090584
  error estimate for blocks of size 2^( 7) =       0.000574961970

      target function =      -0.693762929537
              le_mean =     -22.810550215028
             les_mean =     520.840599830324
             stat err =       0.000567989847
             autocorr =       1.284351025422
   target nu stat err =       0.000567989847
   target dn stat err =       0.004193650869
      target stat err =       0.002845792624
              std dev =       0.708783668893
             le_variance =       0.502374289290


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.693704005903        initial
     4.0000e+00     4.0000e+01             4.0754e-04        -0.693370783815
     1.6000e+01     1.6000e+02             1.0278e-04        -0.693775603891  <--
     6.4000e+01     6.4000e+02             2.5752e-05        -0.693762929537

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.3078e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.599652e-01 3 1  ON 0
ci_02                -5.504598e-02 3 1  ON 1
ci_03                -5.508394e-02 3 1  ON 2
ci_04                 5.398160e-02 3 1  ON 3
ci_05                -3.859262e-02 3 1  ON 4
ci_06                -3.858531e-02 3 1  ON 5
ci_07                 3.028356e-02 3 1  ON 6
ci_08                -1.733887e-02 3 1  ON 7
ci_09                -1.660083e-02 3 1  ON 8
ci_10                -1.654669e-02 3 1  ON 9
ci_11                 1.591523e-02 3 1  ON 10
ci_12                 1.280581e-02 3 1  ON 11
ci_13                 1.268470e-02 3 1  ON 12
ci_14                 1.280443e-02 3 1  ON 13
ci_15                 1.182778e-02 3 1  ON 14
ci_16                 1.180917e-02 3 1  ON 15
ci_17                -1.141397e-02 3 1  ON 16
ci_18                -1.149383e-02 3 1  ON 17
ci_19                 1.144718e-02 3 1  ON 18
ci_20                 1.013792e-02 3 1  ON 19
ci_21                 9.853229e-03 3 1  ON 20
ci_22                 9.792366e-03 3 1  ON 21
ci_23                 6.583501e-03 3 1  ON 22
ci_24                 5.244314e-03 3 1  ON 23
ci_25                 4.975920e-03 3 1  ON 24
ci_26                 4.625180e-03 3 1  ON 25
ci_27                 4.652269e-03 3 1  ON 26
ci_28                 3.936255e-03 3 1  ON 27
ci_29                 4.004057e-03 3 1  ON 28
ci_30                -3.517648e-03 3 1  ON 29
ci_31                -3.418135e-03 3 1  ON 30
ci_32                -3.184869e-03 3 1  ON 31
ci_33                -3.177314e-03 3 1  ON 32
ci_34                 2.658022e-03 3 1  ON 33
ci_35                 2.626392e-03 3 1  ON 34
ci_36                -2.452963e-03 3 1  ON 35
ci_37                -2.413747e-03 3 1  ON 36
ci_38                -1.973796e-03 3 1  ON 37
ci_39                -1.947419e-03 3 1  ON 38
ci_40                -1.974455e-03 3 1  ON 39
ci_41                -1.846106e-03 3 1  ON 40
ci_42                -1.931559e-03 3 1  ON 41
ci_43                -2.044473e-03 3 1  ON 42
ci_44                -1.994392e-03 3 1  ON 43
ci_45                -1.720961e-03 3 1  ON 44
ci_46                -1.735697e-03 3 1  ON 45
ci_47                -1.591783e-03 3 1  ON 46
ci_48                -1.607540e-03 3 1  ON 47
ci_49                -1.689237e-03 3 1  ON 48
ci_50                -1.596877e-03 3 1  ON 49
ci_51                 1.563272e-03 3 1  ON 50
ci_52                 1.523856e-03 3 1  ON 51
ci_53                -1.429124e-03 3 1  ON 52
ci_54                -1.394064e-03 3 1  ON 53
ci_55                -1.409880e-03 3 1  ON 54
ci_56                 1.444808e-03 3 1  ON 55
ci_57                 1.377905e-03 3 1  ON 56
ci_58                -1.211818e-03 3 1  ON 57
ci_59                -1.257917e-03 3 1  ON 58
ci_60                 1.095714e-03 3 1  ON 59
ci_61                 1.191888e-03 3 1  ON 60
ci_62                -1.090691e-03 3 1  ON 61
ci_63                -1.049677e-03 3 1  ON 62
ci_64                -1.003251e-03 3 1  ON 63
ci_65                -1.037437e-03 3 1  ON 64
ci_66                -9.945745e-04 3 1  ON 65
ci_67                -9.664475e-04 3 1  ON 66
ci_68                 7.726473e-04 3 1  ON 67
ci_69                 7.723939e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3347e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.7987
    reference variance = 1.12776
====================================================
  Execution time = 2.5678e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5322e+04
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.2144e-01
  Total weights = 1.962944199e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501432539215
                                         uncertainty =       0.002351671974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501432539215
                                         uncertainty =       0.002351671974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500720822
  error estimate for blocks of size 2^( 2) =       0.000521933078
  error estimate for blocks of size 2^( 3) =       0.000541228286
  error estimate for blocks of size 2^( 4) =       0.000556039479
  error estimate for blocks of size 2^( 5) =       0.000566330159
  error estimate for blocks of size 2^( 6) =       0.000572388831
  error estimate for blocks of size 2^( 7) =       0.000580296379

      target function =      -0.692405313913
              le_mean =     -22.811619511165
             les_mean =     520.891429679652
             stat err =       0.000568763712
             autocorr =       1.290245806774
   target nu stat err =       0.000568763712
   target dn stat err =       0.003707623955
      target stat err =       0.002523073082
              std dev =       0.708126177881
             le_variance =       0.501442683800


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281161951116e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.692413703094       residual = 9.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.692600785024       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.692631673037       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.692636262929       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.692637368346       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.692637901587       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.692638028594       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.692638041776       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.692638035207       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.692638034130       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.692638034163       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.102912e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.692413703094       residual = 9.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.692460864148       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.692468624506       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.692469773499       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.692470049060       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.692470181146       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.692470212338       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.692470215531       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.692470213891       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.692470213625       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.692470213633       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.034739e-04

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.692413703094       residual = 9.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.692425518014       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.692427460507       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.692427747847       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.692427816686       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.692427849630       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.692427857393       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.692427858185       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.692427857776       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.692427857709       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.692427857711       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+01 is 2.592540e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.399435 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0281e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.598767e-01 3 1  ON 0
ci_02                -5.496330e-02 3 1  ON 1
ci_03                -5.499740e-02 3 1  ON 2
ci_04                 5.387813e-02 3 1  ON 3
ci_05                -3.853653e-02 3 1  ON 4
ci_06                -3.851966e-02 3 1  ON 5
ci_07                 3.027048e-02 3 1  ON 6
ci_08                -1.730262e-02 3 1  ON 7
ci_09                -1.657654e-02 3 1  ON 8
ci_10                -1.652378e-02 3 1  ON 9
ci_11                 1.590465e-02 3 1  ON 10
ci_12                 1.278703e-02 3 1  ON 11
ci_13                 1.267954e-02 3 1  ON 12
ci_14                 1.279817e-02 3 1  ON 13
ci_15                 1.181578e-02 3 1  ON 14
ci_16                 1.179354e-02 3 1  ON 15
ci_17                -1.139817e-02 3 1  ON 16
ci_18                -1.148144e-02 3 1  ON 17
ci_19                 1.143362e-02 3 1  ON 18
ci_20                 1.013253e-02 3 1  ON 19
ci_21                 9.851518e-03 3 1  ON 20
ci_22                 9.788890e-03 3 1  ON 21
ci_23                 6.573336e-03 3 1  ON 22
ci_24                 5.241573e-03 3 1  ON 23
ci_25                 4.969382e-03 3 1  ON 24
ci_26                 4.615595e-03 3 1  ON 25
ci_27                 4.650586e-03 3 1  ON 26
ci_28                 3.929711e-03 3 1  ON 27
ci_29                 3.998227e-03 3 1  ON 28
ci_30                -3.515833e-03 3 1  ON 29
ci_31                -3.412942e-03 3 1  ON 30
ci_32                -3.169650e-03 3 1  ON 31
ci_33                -3.169068e-03 3 1  ON 32
ci_34                 2.655755e-03 3 1  ON 33
ci_35                 2.618827e-03 3 1  ON 34
ci_36                -2.449464e-03 3 1  ON 35
ci_37                -2.408731e-03 3 1  ON 36
ci_38                -1.973112e-03 3 1  ON 37
ci_39                -1.942516e-03 3 1  ON 38
ci_40                -1.974733e-03 3 1  ON 39
ci_41                -1.838737e-03 3 1  ON 40
ci_42                -1.930213e-03 3 1  ON 41
ci_43                -2.048966e-03 3 1  ON 42
ci_44                -1.991273e-03 3 1  ON 43
ci_45                -1.715706e-03 3 1  ON 44
ci_46                -1.732569e-03 3 1  ON 45
ci_47                -1.587857e-03 3 1  ON 46
ci_48                -1.600675e-03 3 1  ON 47
ci_49                -1.686785e-03 3 1  ON 48
ci_50                -1.596660e-03 3 1  ON 49
ci_51                 1.561501e-03 3 1  ON 50
ci_52                 1.521244e-03 3 1  ON 51
ci_53                -1.428617e-03 3 1  ON 52
ci_54                -1.390162e-03 3 1  ON 53
ci_55                -1.408813e-03 3 1  ON 54
ci_56                 1.444760e-03 3 1  ON 55
ci_57                 1.379535e-03 3 1  ON 56
ci_58                -1.211386e-03 3 1  ON 57
ci_59                -1.257227e-03 3 1  ON 58
ci_60                 1.092887e-03 3 1  ON 59
ci_61                 1.186794e-03 3 1  ON 60
ci_62                -1.087021e-03 3 1  ON 61
ci_63                -1.048182e-03 3 1  ON 62
ci_64                -1.004515e-03 3 1  ON 63
ci_65                -1.035446e-03 3 1  ON 64
ci_66                -9.925005e-04 3 1  ON 65
ci_67                -9.670385e-04 3 1  ON 66
ci_68                 7.642420e-04 3 1  ON 67
ci_69                 7.631718e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8273
    reference variance = 0.466516
====================================================
  Execution time = 2.6862e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1995e-01
  Total weights = 1.9630e+06
  Execution time = 3.5992e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499331272439
                                         uncertainty =       0.003025761136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499331272439
                                         uncertainty =       0.003025761136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499632834
  error estimate for blocks of size 2^( 2) =       0.000521175318
  error estimate for blocks of size 2^( 3) =       0.000540681073
  error estimate for blocks of size 2^( 4) =       0.000556415463
  error estimate for blocks of size 2^( 5) =       0.000565214497
  error estimate for blocks of size 2^( 6) =       0.000568370544
  error estimate for blocks of size 2^( 7) =       0.000572392884

      target function =      -0.691656155432
              le_mean =     -22.810818066780
             les_mean =     520.855959842417
             stat err =       0.000565598347
             autocorr =       1.281487345567
   target nu stat err =       0.000565598347
   target dn stat err =       0.007208082928
      target stat err =       0.004804167730
              std dev =       0.706587529506
             le_variance =       0.499265936853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498673357459
                                         uncertainty =       0.003037656490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498673357459
                                         uncertainty =       0.003037656490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499303883
  error estimate for blocks of size 2^( 2) =       0.000520826239
  error estimate for blocks of size 2^( 3) =       0.000540316379
  error estimate for blocks of size 2^( 4) =       0.000556039116
  error estimate for blocks of size 2^( 5) =       0.000564838270
  error estimate for blocks of size 2^( 6) =       0.000567992228
  error estimate for blocks of size 2^( 7) =       0.000572007453

      target function =      -0.693704657180
              le_mean =     -22.810816034899
             les_mean =     520.852787227452
             stat err =       0.000565219267
             autocorr =       1.281456969496
   target nu stat err =       0.000565219267
   target dn stat err =       0.006876342847
      target stat err =       0.004612881077
              std dev =       0.706122323381
             le_variance =       0.498608735577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498996784254
                                         uncertainty =       0.003031671798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498996784254
                                         uncertainty =       0.003031671798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499465620
  error estimate for blocks of size 2^( 2) =       0.000520997843
  error estimate for blocks of size 2^( 3) =       0.000540495853
  error estimate for blocks of size 2^( 4) =       0.000556224307
  error estimate for blocks of size 2^( 5) =       0.000565023562
  error estimate for blocks of size 2^( 6) =       0.000568178453
  error estimate for blocks of size 2^( 7) =       0.000572197639

      target function =      -0.692142851568
              le_mean =     -22.810816514659
             les_mean =     520.855155919353
             stat err =       0.000565405990
             autocorr =       1.281473446500
   target nu stat err =       0.000565405990
   target dn stat err =       0.007109316342
      target stat err =       0.004745773605
              std dev =       0.706351053446
             le_variance =       0.498931810704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499289044404
                                         uncertainty =       0.003026494168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499289044404
                                         uncertainty =       0.003026494168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499611726
  error estimate for blocks of size 2^( 2) =       0.000521152940
  error estimate for blocks of size 2^( 3) =       0.000540657699
  error estimate for blocks of size 2^( 4) =       0.000556391328
  error estimate for blocks of size 2^( 5) =       0.000565190349
  error estimate for blocks of size 2^( 6) =       0.000568346257
  error estimate for blocks of size 2^( 7) =       0.000572368132

      target function =      -0.693262611605
              le_mean =     -22.810817880851
             les_mean =     520.853536217526
             stat err =       0.000565574017
             autocorr =       1.281485367261
   target nu stat err =       0.000565574017
   target dn stat err =       0.006820221862
      target stat err =       0.004570016563
              std dev =       0.706557679521
             le_variance =       0.499223754490


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.691656155432        initial
     4.0000e+00     4.0000e+01             4.1029e-04        -0.693704657180  <--
     1.6000e+01     1.6000e+02             1.0347e-04        -0.692142851568
     6.4000e+01     6.4000e+02             2.5925e-05        -0.693262611605

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.4911e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.596126e-01 3 1  ON 0
ci_02                -5.471784e-02 3 1  ON 1
ci_03                -5.474036e-02 3 1  ON 2
ci_04                 5.357131e-02 3 1  ON 3
ci_05                -3.837007e-02 3 1  ON 4
ci_06                -3.832482e-02 3 1  ON 5
ci_07                 3.023161e-02 3 1  ON 6
ci_08                -1.719506e-02 3 1  ON 7
ci_09                -1.650429e-02 3 1  ON 8
ci_10                -1.645565e-02 3 1  ON 9
ci_11                 1.587323e-02 3 1  ON 10
ci_12                 1.273130e-02 3 1  ON 11
ci_13                 1.266420e-02 3 1  ON 12
ci_14                 1.277949e-02 3 1  ON 13
ci_15                 1.178013e-02 3 1  ON 14
ci_16                 1.174712e-02 3 1  ON 15
ci_17                -1.135117e-02 3 1  ON 16
ci_18                -1.144455e-02 3 1  ON 17
ci_19                 1.139346e-02 3 1  ON 18
ci_20                 1.011657e-02 3 1  ON 19
ci_21                 9.846422e-03 3 1  ON 20
ci_22                 9.778533e-03 3 1  ON 21
ci_23                 6.543217e-03 3 1  ON 22
ci_24                 5.233437e-03 3 1  ON 23
ci_25                 4.949999e-03 3 1  ON 24
ci_26                 4.587145e-03 3 1  ON 25
ci_27                 4.645620e-03 3 1  ON 26
ci_28                 3.910231e-03 3 1  ON 27
ci_29                 3.980851e-03 3 1  ON 28
ci_30                -3.510416e-03 3 1  ON 29
ci_31                -3.397475e-03 3 1  ON 30
ci_32                -3.124591e-03 3 1  ON 31
ci_33                -3.144696e-03 3 1  ON 32
ci_34                 2.649120e-03 3 1  ON 33
ci_35                 2.596484e-03 3 1  ON 34
ci_36                -2.439076e-03 3 1  ON 35
ci_37                -2.393839e-03 3 1  ON 36
ci_38                -1.971064e-03 3 1  ON 37
ci_39                -1.927967e-03 3 1  ON 38
ci_40                -1.975531e-03 3 1  ON 39
ci_41                -1.816955e-03 3 1  ON 40
ci_42                -1.926295e-03 3 1  ON 41
ci_43                -2.062269e-03 3 1  ON 42
ci_44                -1.981920e-03 3 1  ON 43
ci_45                -1.700111e-03 3 1  ON 44
ci_46                -1.723272e-03 3 1  ON 45
ci_47                -1.576130e-03 3 1  ON 46
ci_48                -1.580204e-03 3 1  ON 47
ci_49                -1.679522e-03 3 1  ON 48
ci_50                -1.595993e-03 3 1  ON 49
ci_51                 1.556240e-03 3 1  ON 50
ci_52                 1.513473e-03 3 1  ON 51
ci_53                -1.427094e-03 3 1  ON 52
ci_54                -1.378567e-03 3 1  ON 53
ci_55                -1.405642e-03 3 1  ON 54
ci_56                 1.444635e-03 3 1  ON 55
ci_57                 1.384382e-03 3 1  ON 56
ci_58                -1.210104e-03 3 1  ON 57
ci_59                -1.255188e-03 3 1  ON 58
ci_60                 1.084468e-03 3 1  ON 59
ci_61                 1.171592e-03 3 1  ON 60
ci_62                -1.076101e-03 3 1  ON 61
ci_63                -1.043720e-03 3 1  ON 62
ci_64                -1.008258e-03 3 1  ON 63
ci_65                -1.029541e-03 3 1  ON 64
ci_66                -9.863285e-04 3 1  ON 65
ci_67                -9.687766e-04 3 1  ON 66
ci_68                 7.392886e-04 3 1  ON 67
ci_69                 7.357936e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5198e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8758
    reference variance = 0.616456
====================================================
  Execution time = 2.5842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1841e-01
  Total weights = 1.963000174e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497504807793
                                         uncertainty =       0.003314362952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497504807793
                                         uncertainty =       0.003314362952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498853374
  error estimate for blocks of size 2^( 2) =       0.000520061321
  error estimate for blocks of size 2^( 3) =       0.000540338746
  error estimate for blocks of size 2^( 4) =       0.000555233773
  error estimate for blocks of size 2^( 5) =       0.000564156117
  error estimate for blocks of size 2^( 6) =       0.000570221339
  error estimate for blocks of size 2^( 7) =       0.000573572688

      target function =      -0.694418679053
              le_mean =     -22.811129422814
             les_mean =     520.866040095849
             stat err =       0.000565795979
             autocorr =       1.286393646063
   target nu stat err =       0.000565795979
   target dn stat err =       0.004574955895
      target stat err =       0.003103317438
              std dev =       0.705485206879
             le_variance =       0.497709377126


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281112942281e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.694431797265       residual = 9.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.695201289587       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.695309865220       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.695326079976       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.695330904401       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.695332153527       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.695332425925       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.695332450890       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.695332442429       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.695332452288       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.695332455623       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.617515e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.694431797265       residual = 9.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.694630540986       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.694658244365       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.694662327860       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.694663526046       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.694663826525       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.694663890409       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.694663896011       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.694663894050       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.694663896414       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.694663897188       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.186578e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.694431797265       residual = 9.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.694481897319       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.694488858621       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.694489881227       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.694490180192       residual = 9.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.694490254544       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.694490270248       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.694490271610       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.694490271130       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.694490271714       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.694490271904       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.055949e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.403548 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0455e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.593055e-01 3 1  ON 0
ci_02                -5.438983e-02 3 1  ON 1
ci_03                -5.440716e-02 3 1  ON 2
ci_04                 5.315266e-02 3 1  ON 3
ci_05                -3.810578e-02 3 1  ON 4
ci_06                -3.810495e-02 3 1  ON 5
ci_07                 3.019779e-02 3 1  ON 6
ci_08                -1.703919e-02 3 1  ON 7
ci_09                -1.643027e-02 3 1  ON 8
ci_10                -1.635050e-02 3 1  ON 9
ci_11                 1.582369e-02 3 1  ON 10
ci_12                 1.263753e-02 3 1  ON 11
ci_13                 1.265659e-02 3 1  ON 12
ci_14                 1.278907e-02 3 1  ON 13
ci_15                 1.170754e-02 3 1  ON 14
ci_16                 1.170523e-02 3 1  ON 15
ci_17                -1.128355e-02 3 1  ON 16
ci_18                -1.140459e-02 3 1  ON 17
ci_19                 1.136898e-02 3 1  ON 18
ci_20                 1.007978e-02 3 1  ON 19
ci_21                 9.859268e-03 3 1  ON 20
ci_22                 9.782120e-03 3 1  ON 21
ci_23                 6.510290e-03 3 1  ON 22
ci_24                 5.213904e-03 3 1  ON 23
ci_25                 4.922132e-03 3 1  ON 24
ci_26                 4.590720e-03 3 1  ON 25
ci_27                 4.625955e-03 3 1  ON 26
ci_28                 3.902229e-03 3 1  ON 27
ci_29                 3.953393e-03 3 1  ON 28
ci_30                -3.482195e-03 3 1  ON 29
ci_31                -3.377399e-03 3 1  ON 30
ci_32                -3.093684e-03 3 1  ON 31
ci_33                -3.101029e-03 3 1  ON 32
ci_34                 2.600704e-03 3 1  ON 33
ci_35                 2.558925e-03 3 1  ON 34
ci_36                -2.416804e-03 3 1  ON 35
ci_37                -2.373512e-03 3 1  ON 36
ci_38                -1.941157e-03 3 1  ON 37
ci_39                -1.912261e-03 3 1  ON 38
ci_40                -1.963881e-03 3 1  ON 39
ci_41                -1.799988e-03 3 1  ON 40
ci_42                -1.904421e-03 3 1  ON 41
ci_43                -2.066005e-03 3 1  ON 42
ci_44                -1.997803e-03 3 1  ON 43
ci_45                -1.689709e-03 3 1  ON 44
ci_46                -1.710738e-03 3 1  ON 45
ci_47                -1.549317e-03 3 1  ON 46
ci_48                -1.550359e-03 3 1  ON 47
ci_49                -1.672404e-03 3 1  ON 48
ci_50                -1.595001e-03 3 1  ON 49
ci_51                 1.546292e-03 3 1  ON 50
ci_52                 1.491740e-03 3 1  ON 51
ci_53                -1.395770e-03 3 1  ON 52
ci_54                -1.367015e-03 3 1  ON 53
ci_55                -1.411911e-03 3 1  ON 54
ci_56                 1.461365e-03 3 1  ON 55
ci_57                 1.392797e-03 3 1  ON 56
ci_58                -1.197978e-03 3 1  ON 57
ci_59                -1.269831e-03 3 1  ON 58
ci_60                 1.096373e-03 3 1  ON 59
ci_61                 1.188474e-03 3 1  ON 60
ci_62                -1.078180e-03 3 1  ON 61
ci_63                -1.043075e-03 3 1  ON 62
ci_64                -1.013905e-03 3 1  ON 63
ci_65                -1.015895e-03 3 1  ON 64
ci_66                -9.715980e-04 3 1  ON 65
ci_67                -9.608486e-04 3 1  ON 66
ci_68                 7.112370e-04 3 1  ON 67
ci_69                 7.174405e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7862
    reference variance = 0.514077
====================================================
  Execution time = 2.5400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.1986e-01
  Total weights = 1.9627e+06
  Execution time = 3.6008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496517697887
                                         uncertainty =       0.003525594153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496517697887
                                         uncertainty =       0.003525594153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498212394
  error estimate for blocks of size 2^( 2) =       0.000519278148
  error estimate for blocks of size 2^( 3) =       0.000539240519
  error estimate for blocks of size 2^( 4) =       0.000554475042
  error estimate for blocks of size 2^( 5) =       0.000564475771
  error estimate for blocks of size 2^( 6) =       0.000569275194
  error estimate for blocks of size 2^( 7) =       0.000571675003

      target function =      -0.693463787117
              le_mean =     -22.811915830689
             les_mean =     520.903325699884
             stat err =       0.000564975252
             autocorr =       1.285966916870
   target nu stat err =       0.000564975252
   target dn stat err =       0.006887316253
      target stat err =       0.004623970482
              std dev =       0.704578723878
             le_variance =       0.496431178141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493210838513
                                         uncertainty =       0.002922994906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493210838513
                                         uncertainty =       0.002922994906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496551287
  error estimate for blocks of size 2^( 2) =       0.000517561416
  error estimate for blocks of size 2^( 3) =       0.000537491544
  error estimate for blocks of size 2^( 4) =       0.000552708523
  error estimate for blocks of size 2^( 5) =       0.000562690962
  error estimate for blocks of size 2^( 6) =       0.000567479054
  error estimate for blocks of size 2^( 7) =       0.000569883147

      target function =      -0.681958284363
              le_mean =     -22.811929907034
             les_mean =     520.921313276855
             stat err =       0.000563190422
             autocorr =       1.286418557683
   target nu stat err =       0.000563190422
   target dn stat err =       0.016217549892
      target stat err =       0.010472604108
              std dev =       0.702229564173
             le_variance =       0.493126360798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494763488857
                                         uncertainty =       0.003156822639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494763488857
                                         uncertainty =       0.003156822639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497331923
  error estimate for blocks of size 2^( 2) =       0.000518368600
  error estimate for blocks of size 2^( 3) =       0.000538318645
  error estimate for blocks of size 2^( 4) =       0.000553544901
  error estimate for blocks of size 2^( 5) =       0.000563533258
  error estimate for blocks of size 2^( 6) =       0.000568343267
  error estimate for blocks of size 2^( 7) =       0.000570736257

      target function =      -0.684130001202
              le_mean =     -22.811910943942
             les_mean =     520.917054968163
             stat err =       0.000564039421
             autocorr =       1.286252529958
   target nu stat err =       0.000564039421
   target dn stat err =       0.017329871928
      target stat err =       0.011260527752
              std dev =       0.703333550400
             le_variance =       0.494678083118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496275065091
                                         uncertainty =       0.003470820808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496275065091
                                         uncertainty =       0.003470820808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498090707
  error estimate for blocks of size 2^( 2) =       0.000519152958
  error estimate for blocks of size 2^( 3) =       0.000539113732
  error estimate for blocks of size 2^( 4) =       0.000554347437
  error estimate for blocks of size 2^( 5) =       0.000564346784
  error estimate for blocks of size 2^( 6) =       0.000569146658
  error estimate for blocks of size 2^( 7) =       0.000571546111

      target function =      -0.693963147798
              le_mean =     -22.811914805889
             les_mean =     520.902532174612
             stat err =       0.000564846747
             autocorr =       1.286010121501
   target nu stat err =       0.000564846747
   target dn stat err =       0.006756289666
      target stat err =       0.004543689553
              std dev =       0.704406632929
             le_variance =       0.496188704515


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.693463787117        initial
     1.0000e+00     1.0000e+01             1.6175e-03        -0.681958284363
     4.0000e+00     4.0000e+01             4.1866e-04        -0.684130001202
     1.6000e+01     1.6000e+02             1.0559e-04        -0.693963147798  <--

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.3444e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.595354e-01 3 1  ON 0
ci_02                -5.463520e-02 3 1  ON 1
ci_03                -5.465641e-02 3 1  ON 2
ci_04                 5.346572e-02 3 1  ON 3
ci_05                -3.830345e-02 3 1  ON 4
ci_06                -3.826940e-02 3 1  ON 5
ci_07                 3.022309e-02 3 1  ON 6
ci_08                -1.715577e-02 3 1  ON 7
ci_09                -1.648566e-02 3 1  ON 8
ci_10                -1.642918e-02 3 1  ON 9
ci_11                 1.586075e-02 3 1  ON 10
ci_12                 1.270766e-02 3 1  ON 11
ci_13                 1.266227e-02 3 1  ON 12
ci_14                 1.278188e-02 3 1  ON 13
ci_15                 1.176184e-02 3 1  ON 14
ci_16                 1.173657e-02 3 1  ON 15
ci_17                -1.133415e-02 3 1  ON 16
ci_18                -1.143450e-02 3 1  ON 17
ci_19                 1.138728e-02 3 1  ON 18
ci_20                 1.010729e-02 3 1  ON 19
ci_21                 9.849653e-03 3 1  ON 20
ci_22                 9.779436e-03 3 1  ON 21
ci_23                 6.534903e-03 3 1  ON 22
ci_24                 5.228523e-03 3 1  ON 23
ci_25                 4.942966e-03 3 1  ON 24
ci_26                 4.588039e-03 3 1  ON 25
ci_27                 4.640661e-03 3 1  ON 26
ci_28                 3.908240e-03 3 1  ON 27
ci_29                 3.973945e-03 3 1  ON 28
ci_30                -3.503328e-03 3 1  ON 29
ci_31                -3.392431e-03 3 1  ON 30
ci_32                -3.116782e-03 3 1  ON 31
ci_33                -3.133666e-03 3 1  ON 32
ci_34                 2.636904e-03 3 1  ON 33
ci_35                 2.586999e-03 3 1  ON 34
ci_36                -2.433464e-03 3 1  ON 35
ci_37                -2.388719e-03 3 1  ON 36
ci_38                -1.963522e-03 3 1  ON 37
ci_39                -1.924011e-03 3 1  ON 38
ci_40                -1.972592e-03 3 1  ON 39
ci_41                -1.812664e-03 3 1  ON 40
ci_42                -1.920763e-03 3 1  ON 41
ci_43                -2.063230e-03 3 1  ON 42
ci_44                -1.985933e-03 3 1  ON 43
ci_45                -1.697492e-03 3 1  ON 44
ci_46                -1.720115e-03 3 1  ON 45
ci_47                -1.569392e-03 3 1  ON 46
ci_48                -1.572705e-03 3 1  ON 47
ci_49                -1.677737e-03 3 1  ON 48
ci_50                -1.595743e-03 3 1  ON 49
ci_51                 1.553733e-03 3 1  ON 50
ci_52                 1.507994e-03 3 1  ON 51
ci_53                -1.419188e-03 3 1  ON 52
ci_54                -1.375657e-03 3 1  ON 53
ci_55                -1.407229e-03 3 1  ON 54
ci_56                 1.448853e-03 3 1  ON 55
ci_57                 1.386500e-03 3 1  ON 56
ci_58                -1.207043e-03 3 1  ON 57
ci_59                -1.258882e-03 3 1  ON 58
ci_60                 1.087455e-03 3 1  ON 59
ci_61                 1.175839e-03 3 1  ON 60
ci_62                -1.076633e-03 3 1  ON 61
ci_63                -1.043563e-03 3 1  ON 62
ci_64                -1.009692e-03 3 1  ON 63
ci_65                -1.026099e-03 3 1  ON 64
ci_66                -9.826161e-04 3 1  ON 65
ci_67                -9.667827e-04 3 1  ON 66
ci_68                 7.322220e-04 3 1  ON 67
ci_69                 7.311656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3905e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7696
    reference variance = 0.430244
====================================================
  Execution time = 2.5794e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5312e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.3690e-01
  Total weights = 1.963148933e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505552218153
                                         uncertainty =       0.005989995910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505552218153
                                         uncertainty =       0.005989995910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502747888
  error estimate for blocks of size 2^( 2) =       0.000523695637
  error estimate for blocks of size 2^( 3) =       0.000543514323
  error estimate for blocks of size 2^( 4) =       0.000558608207
  error estimate for blocks of size 2^( 5) =       0.000567720309
  error estimate for blocks of size 2^( 6) =       0.000572722587
  error estimate for blocks of size 2^( 7) =       0.000573348274

      target function =      -0.682136622360
              le_mean =     -22.810540946194
             les_mean =     520.857682423788
             stat err =       0.000568099844
             autocorr =       1.276876312366
   target nu stat err =       0.000568099844
   target dn stat err =       0.016763289521
      target stat err =       0.010809362568
              std dev =       0.710992882173
             le_variance =       0.505510878501


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281054094619e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.682307472258       residual = 8.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.682491565676       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.682523517468       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.682529255400       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.682530677918       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.682531920074       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.682532083575       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.682532109734       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.682532121059       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.682532131587       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.682532137073       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.682532139108       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.362007e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.682307472258       residual = 8.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.682353867938       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.682361893171       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.682363329575       residual = 8.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.682363683494       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.682363992017       residual = 6.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.682364032176       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.682364038642       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.682364041472       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.682364044091       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.682364045445       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.682364045946       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.095428e-04

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.682307472258       residual = 8.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.682319094675       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.682321103319       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.682321462536       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.682321550907       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.682321627910       residual = 6.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.682321637905       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.682321639517       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.682321640224       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.682321640878       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.682321641216       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.682321641340       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+01 is 2.741666e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.408329 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0362e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.594259e-01 3 1  ON 0
ci_02                -5.456862e-02 3 1  ON 1
ci_03                -5.455614e-02 3 1  ON 2
ci_04                 5.336822e-02 3 1  ON 3
ci_05                -3.825194e-02 3 1  ON 4
ci_06                -3.821524e-02 3 1  ON 5
ci_07                 3.021940e-02 3 1  ON 6
ci_08                -1.712109e-02 3 1  ON 7
ci_09                -1.646318e-02 3 1  ON 8
ci_10                -1.640392e-02 3 1  ON 9
ci_11                 1.583051e-02 3 1  ON 10
ci_12                 1.269149e-02 3 1  ON 11
ci_13                 1.265079e-02 3 1  ON 12
ci_14                 1.278477e-02 3 1  ON 13
ci_15                 1.174968e-02 3 1  ON 14
ci_16                 1.171773e-02 3 1  ON 15
ci_17                -1.131770e-02 3 1  ON 16
ci_18                -1.141870e-02 3 1  ON 17
ci_19                 1.137694e-02 3 1  ON 18
ci_20                 1.010075e-02 3 1  ON 19
ci_21                 9.859804e-03 3 1  ON 20
ci_22                 9.782859e-03 3 1  ON 21
ci_23                 6.525412e-03 3 1  ON 22
ci_24                 5.222934e-03 3 1  ON 23
ci_25                 4.936590e-03 3 1  ON 24
ci_26                 4.587748e-03 3 1  ON 25
ci_27                 4.637301e-03 3 1  ON 26
ci_28                 3.880047e-03 3 1  ON 27
ci_29                 3.974461e-03 3 1  ON 28
ci_30                -3.516822e-03 3 1  ON 29
ci_31                -3.408659e-03 3 1  ON 30
ci_32                -3.106971e-03 3 1  ON 31
ci_33                -3.123200e-03 3 1  ON 32
ci_34                 2.634961e-03 3 1  ON 33
ci_35                 2.570853e-03 3 1  ON 34
ci_36                -2.425975e-03 3 1  ON 35
ci_37                -2.394172e-03 3 1  ON 36
ci_38                -1.965347e-03 3 1  ON 37
ci_39                -1.912018e-03 3 1  ON 38
ci_40                -1.971855e-03 3 1  ON 39
ci_41                -1.812520e-03 3 1  ON 40
ci_42                -1.916498e-03 3 1  ON 41
ci_43                -2.056283e-03 3 1  ON 42
ci_44                -1.979356e-03 3 1  ON 43
ci_45                -1.684006e-03 3 1  ON 44
ci_46                -1.716491e-03 3 1  ON 45
ci_47                -1.560270e-03 3 1  ON 46
ci_48                -1.560507e-03 3 1  ON 47
ci_49                -1.677170e-03 3 1  ON 48
ci_50                -1.588470e-03 3 1  ON 49
ci_51                 1.562670e-03 3 1  ON 50
ci_52                 1.498148e-03 3 1  ON 51
ci_53                -1.418125e-03 3 1  ON 52
ci_54                -1.372726e-03 3 1  ON 53
ci_55                -1.402172e-03 3 1  ON 54
ci_56                 1.448513e-03 3 1  ON 55
ci_57                 1.387051e-03 3 1  ON 56
ci_58                -1.204242e-03 3 1  ON 57
ci_59                -1.251904e-03 3 1  ON 58
ci_60                 1.094060e-03 3 1  ON 59
ci_61                 1.172784e-03 3 1  ON 60
ci_62                -1.073620e-03 3 1  ON 61
ci_63                -1.041016e-03 3 1  ON 62
ci_64                -1.008217e-03 3 1  ON 63
ci_65                -1.023819e-03 3 1  ON 64
ci_66                -9.863141e-04 3 1  ON 65
ci_67                -9.650811e-04 3 1  ON 66
ci_68                 7.249016e-04 3 1  ON 67
ci_69                 7.226754e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8969
    reference variance = 0.746673
====================================================
  Execution time = 2.5143e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.1387e-01
  Total weights = 1.9632e+06
  Execution time = 3.5856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497266948761
                                         uncertainty =       0.003197520249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497266948761
                                         uncertainty =       0.003197520249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498648412
  error estimate for blocks of size 2^( 2) =       0.000519978201
  error estimate for blocks of size 2^( 3) =       0.000539746678
  error estimate for blocks of size 2^( 4) =       0.000555560897
  error estimate for blocks of size 2^( 5) =       0.000565216996
  error estimate for blocks of size 2^( 6) =       0.000569960054
  error estimate for blocks of size 2^( 7) =       0.000572227144

      target function =      -0.697420801718
              le_mean =     -22.811792598069
             les_mean =     520.891831387707
             stat err =       0.000565741273
             autocorr =       1.287202412461
   target nu stat err =       0.000565741273
   target dn stat err =       0.003943331255
      target stat err =       0.002714351411
              std dev =       0.705195347462
             le_variance =       0.497300478082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496594016671
                                         uncertainty =       0.003179323375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496594016671
                                         uncertainty =       0.003179323375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498310528
  error estimate for blocks of size 2^( 2) =       0.000519622746
  error estimate for blocks of size 2^( 3) =       0.000539381217
  error estimate for blocks of size 2^( 4) =       0.000555177504
  error estimate for blocks of size 2^( 5) =       0.000564827860
  error estimate for blocks of size 2^( 6) =       0.000569575767
  error estimate for blocks of size 2^( 7) =       0.000571825055

      target function =      -0.673669658294
              le_mean =     -22.811793740204
             les_mean =     520.927153327823
             stat err =       0.000565351547
             autocorr =       1.287173361286
   target nu stat err =       0.000565351547
   target dn stat err =       0.036073939382
      target stat err =       0.022725083340
              std dev =       0.704717507245
             le_variance =       0.496626765018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496920177366
                                         uncertainty =       0.003188525702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496920177366
                                         uncertainty =       0.003188525702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498474332
  error estimate for blocks of size 2^( 2) =       0.000519795496
  error estimate for blocks of size 2^( 3) =       0.000539557895
  error estimate for blocks of size 2^( 4) =       0.000555367643
  error estimate for blocks of size 2^( 5) =       0.000565021380
  error estimate for blocks of size 2^( 6) =       0.000569764848
  error estimate for blocks of size 2^( 7) =       0.000572027361

      target function =      -0.697500650472
              le_mean =     -22.811793857846
             les_mean =     520.891770643570
             stat err =       0.000565545308
             autocorr =       1.287209415463
   target nu stat err =       0.000565545308
   target dn stat err =       0.003918836337
      target stat err =       0.002698748192
              std dev =       0.704949160325
             le_variance =       0.496953318643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497223202553
                                         uncertainty =       0.003196365091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497223202553
                                         uncertainty =       0.003196365091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498626455
  error estimate for blocks of size 2^( 2) =       0.000519955150
  error estimate for blocks of size 2^( 3) =       0.000539722858
  error estimate for blocks of size 2^( 4) =       0.000555536531
  error estimate for blocks of size 2^( 5) =       0.000565192336
  error estimate for blocks of size 2^( 6) =       0.000569935440
  error estimate for blocks of size 2^( 7) =       0.000572201947

      target function =      -0.697447245919
              le_mean =     -22.811792716782
             les_mean =     520.891797611479
             stat err =       0.000565716563
             autocorr =       1.287203333889
   target nu stat err =       0.000565716563
   target dn stat err =       0.003939705695
      target stat err =       0.002712154200
              std dev =       0.705164295194
             le_variance =       0.497256683216


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.697420801718        initial
     4.0000e+00     4.0000e+01             4.3620e-04        -0.673669658294
     1.6000e+01     1.6000e+02             1.0954e-04        -0.697500650472  <--
     6.4000e+01     6.4000e+02             2.7417e-05        -0.697447245919

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.3165e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.594259e-01 3 1  ON 0
ci_02                -5.456862e-02 3 1  ON 1
ci_03                -5.455614e-02 3 1  ON 2
ci_04                 5.336822e-02 3 1  ON 3
ci_05                -3.825194e-02 3 1  ON 4
ci_06                -3.821524e-02 3 1  ON 5
ci_07                 3.021940e-02 3 1  ON 6
ci_08                -1.712109e-02 3 1  ON 7
ci_09                -1.646318e-02 3 1  ON 8
ci_10                -1.640392e-02 3 1  ON 9
ci_11                 1.583051e-02 3 1  ON 10
ci_12                 1.269149e-02 3 1  ON 11
ci_13                 1.265079e-02 3 1  ON 12
ci_14                 1.278477e-02 3 1  ON 13
ci_15                 1.174968e-02 3 1  ON 14
ci_16                 1.171773e-02 3 1  ON 15
ci_17                -1.131770e-02 3 1  ON 16
ci_18                -1.141870e-02 3 1  ON 17
ci_19                 1.137694e-02 3 1  ON 18
ci_20                 1.010075e-02 3 1  ON 19
ci_21                 9.859804e-03 3 1  ON 20
ci_22                 9.782859e-03 3 1  ON 21
ci_23                 6.525412e-03 3 1  ON 22
ci_24                 5.222934e-03 3 1  ON 23
ci_25                 4.936590e-03 3 1  ON 24
ci_26                 4.587748e-03 3 1  ON 25
ci_27                 4.637301e-03 3 1  ON 26
ci_28                 3.880047e-03 3 1  ON 27
ci_29                 3.974461e-03 3 1  ON 28
ci_30                -3.516822e-03 3 1  ON 29
ci_31                -3.408659e-03 3 1  ON 30
ci_32                -3.106971e-03 3 1  ON 31
ci_33                -3.123200e-03 3 1  ON 32
ci_34                 2.634961e-03 3 1  ON 33
ci_35                 2.570853e-03 3 1  ON 34
ci_36                -2.425975e-03 3 1  ON 35
ci_37                -2.394172e-03 3 1  ON 36
ci_38                -1.965347e-03 3 1  ON 37
ci_39                -1.912018e-03 3 1  ON 38
ci_40                -1.971855e-03 3 1  ON 39
ci_41                -1.812520e-03 3 1  ON 40
ci_42                -1.916498e-03 3 1  ON 41
ci_43                -2.056283e-03 3 1  ON 42
ci_44                -1.979356e-03 3 1  ON 43
ci_45                -1.684006e-03 3 1  ON 44
ci_46                -1.716491e-03 3 1  ON 45
ci_47                -1.560270e-03 3 1  ON 46
ci_48                -1.560507e-03 3 1  ON 47
ci_49                -1.677170e-03 3 1  ON 48
ci_50                -1.588470e-03 3 1  ON 49
ci_51                 1.562670e-03 3 1  ON 50
ci_52                 1.498148e-03 3 1  ON 51
ci_53                -1.418125e-03 3 1  ON 52
ci_54                -1.372726e-03 3 1  ON 53
ci_55                -1.402172e-03 3 1  ON 54
ci_56                 1.448513e-03 3 1  ON 55
ci_57                 1.387051e-03 3 1  ON 56
ci_58                -1.204242e-03 3 1  ON 57
ci_59                -1.251904e-03 3 1  ON 58
ci_60                 1.094060e-03 3 1  ON 59
ci_61                 1.172784e-03 3 1  ON 60
ci_62                -1.073620e-03 3 1  ON 61
ci_63                -1.041016e-03 3 1  ON 62
ci_64                -1.008217e-03 3 1  ON 63
ci_65                -1.023819e-03 3 1  ON 64
ci_66                -9.863141e-04 3 1  ON 65
ci_67                -9.650811e-04 3 1  ON 66
ci_68                 7.249016e-04 3 1  ON 67
ci_69                 7.226754e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3533e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8754
    reference variance = 0.384524
====================================================
  Execution time = 2.5864e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1550e-01
  Total weights = 1.962952424e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6223e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495368342916
                                         uncertainty =       0.002492836041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495368342916
                                         uncertainty =       0.002492836041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497722426
  error estimate for blocks of size 2^( 2) =       0.000519384032
  error estimate for blocks of size 2^( 3) =       0.000539972903
  error estimate for blocks of size 2^( 4) =       0.000555459312
  error estimate for blocks of size 2^( 5) =       0.000564141709
  error estimate for blocks of size 2^( 6) =       0.000569481445
  error estimate for blocks of size 2^( 7) =       0.000572008716

      target function =      -0.696376473140
              le_mean =     -22.811067941568
             les_mean =     520.860318064732
             stat err =       0.000565272796
             autocorr =       1.289857553878
   target nu stat err =       0.000565272796
   target dn stat err =       0.003733575232
      target stat err =       0.002565774535
              std dev =       0.703885805221
             le_variance =       0.495455226791


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281106794157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696385084655       residual = 9.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696568341510       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696595887401       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696600022505       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696601052848       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696601490757       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696601628121       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696601624595       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696601629170       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696601630552       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696601630507       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.988763e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696385084655       residual = 9.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696431282923       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696438204750       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696439240349       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696439497500       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696439605909       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696439639746       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696439638828       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696439639960       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696439640297       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696439640286       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.005953e-04

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696385084655       residual = 9.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696396658468       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696398391142       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696398650153       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696398714412       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696398741447       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696398749875       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696398749643       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696398749925       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696398750009       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696398750006       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+01 is 2.520416e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.412408 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0495e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.593438e-01 3 1  ON 0
ci_02                -5.448808e-02 3 1  ON 1
ci_03                -5.447233e-02 3 1  ON 2
ci_04                 5.326762e-02 3 1  ON 3
ci_05                -3.818758e-02 3 1  ON 4
ci_06                -3.816019e-02 3 1  ON 5
ci_07                 3.021111e-02 3 1  ON 6
ci_08                -1.708091e-02 3 1  ON 7
ci_09                -1.644372e-02 3 1  ON 8
ci_10                -1.637620e-02 3 1  ON 9
ci_11                 1.582224e-02 3 1  ON 10
ci_12                 1.266890e-02 3 1  ON 11
ci_13                 1.264867e-02 3 1  ON 12
ci_14                 1.278805e-02 3 1  ON 13
ci_15                 1.173638e-02 3 1  ON 14
ci_16                 1.170832e-02 3 1  ON 15
ci_17                -1.130617e-02 3 1  ON 16
ci_18                -1.140726e-02 3 1  ON 17
ci_19                 1.137044e-02 3 1  ON 18
ci_20                 1.009211e-02 3 1  ON 19
ci_21                 9.856028e-03 3 1  ON 20
ci_22                 9.777521e-03 3 1  ON 21
ci_23                 6.517181e-03 3 1  ON 22
ci_24                 5.219390e-03 3 1  ON 23
ci_25                 4.929032e-03 3 1  ON 24
ci_26                 4.579641e-03 3 1  ON 25
ci_27                 4.630108e-03 3 1  ON 26
ci_28                 3.884348e-03 3 1  ON 27
ci_29                 3.968205e-03 3 1  ON 28
ci_30                -3.512833e-03 3 1  ON 29
ci_31                -3.405028e-03 3 1  ON 30
ci_32                -3.100919e-03 3 1  ON 31
ci_33                -3.114959e-03 3 1  ON 32
ci_34                 2.626413e-03 3 1  ON 33
ci_35                 2.564769e-03 3 1  ON 34
ci_36                -2.418235e-03 3 1  ON 35
ci_37                -2.389851e-03 3 1  ON 36
ci_38                -1.960060e-03 3 1  ON 37
ci_39                -1.903287e-03 3 1  ON 38
ci_40                -1.973424e-03 3 1  ON 39
ci_41                -1.809391e-03 3 1  ON 40
ci_42                -1.911493e-03 3 1  ON 41
ci_43                -2.062249e-03 3 1  ON 42
ci_44                -1.981120e-03 3 1  ON 43
ci_45                -1.679555e-03 3 1  ON 44
ci_46                -1.712840e-03 3 1  ON 45
ci_47                -1.552735e-03 3 1  ON 46
ci_48                -1.556755e-03 3 1  ON 47
ci_49                -1.678648e-03 3 1  ON 48
ci_50                -1.585171e-03 3 1  ON 49
ci_51                 1.559003e-03 3 1  ON 50
ci_52                 1.500219e-03 3 1  ON 51
ci_53                -1.415297e-03 3 1  ON 52
ci_54                -1.371858e-03 3 1  ON 53
ci_55                -1.398578e-03 3 1  ON 54
ci_56                 1.449167e-03 3 1  ON 55
ci_57                 1.382760e-03 3 1  ON 56
ci_58                -1.206055e-03 3 1  ON 57
ci_59                -1.246858e-03 3 1  ON 58
ci_60                 1.092752e-03 3 1  ON 59
ci_61                 1.171836e-03 3 1  ON 60
ci_62                -1.073255e-03 3 1  ON 61
ci_63                -1.042460e-03 3 1  ON 62
ci_64                -1.006675e-03 3 1  ON 63
ci_65                -1.021678e-03 3 1  ON 64
ci_66                -9.882472e-04 3 1  ON 65
ci_67                -9.631476e-04 3 1  ON 66
ci_68                 7.197051e-04 3 1  ON 67
ci_69                 7.174726e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8323
    reference variance = 0.490402
====================================================
  Execution time = 2.5106e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.1471e-01
  Total weights = 1.9629e+06
  Execution time = 3.5932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497416703837
                                         uncertainty =       0.003317815635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497416703837
                                         uncertainty =       0.003317815635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498767036
  error estimate for blocks of size 2^( 2) =       0.000520198928
  error estimate for blocks of size 2^( 3) =       0.000540154548
  error estimate for blocks of size 2^( 4) =       0.000554825145
  error estimate for blocks of size 2^( 5) =       0.000564120350
  error estimate for blocks of size 2^( 6) =       0.000568926771
  error estimate for blocks of size 2^( 7) =       0.000574528657

      target function =      -0.696826433862
              le_mean =     -22.812070530030
             les_mean =     520.905395361079
             stat err =       0.000565600231
             autocorr =       1.285948777001
   target nu stat err =       0.000565600231
   target dn stat err =       0.004079873234
      target stat err =       0.002800951308
              std dev =       0.705363107406
             le_variance =       0.497537113289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496762405097
                                         uncertainty =       0.003316119610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496762405097
                                         uncertainty =       0.003316119610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498438894
  error estimate for blocks of size 2^( 2) =       0.000519854421
  error estimate for blocks of size 2^( 3) =       0.000539799684
  error estimate for blocks of size 2^( 4) =       0.000554466748
  error estimate for blocks of size 2^( 5) =       0.000563758519
  error estimate for blocks of size 2^( 6) =       0.000568566213
  error estimate for blocks of size 2^( 7) =       0.000574159647

      target function =      -0.697223827473
              le_mean =     -22.812069822379
             les_mean =     520.904773067453
             stat err =       0.000565237782
             autocorr =       1.285992748377
   target nu stat err =       0.000565237782
   target dn stat err =       0.004097092193
      target stat err =       0.002815401073
              std dev =       0.704899044011
             le_variance =       0.496882662248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497084432070
                                         uncertainty =       0.003316929400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497084432070
                                         uncertainty =       0.003316929400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498600424
  error estimate for blocks of size 2^( 2) =       0.000520023918
  error estimate for blocks of size 2^( 3) =       0.000539974064
  error estimate for blocks of size 2^( 4) =       0.000554642943
  error estimate for blocks of size 2^( 5) =       0.000563936120
  error estimate for blocks of size 2^( 6) =       0.000568743267
  error estimate for blocks of size 2^( 7) =       0.000574340335

      target function =      -0.694497154093
              le_mean =     -22.812070053431
             les_mean =     520.908830742196
             stat err =       0.000565415666
             autocorr =       1.285968669012
   target nu stat err =       0.000565415666
   target dn stat err =       0.005576440982
      target stat err =       0.003769328730
              std dev =       0.705127482332
             le_variance =       0.497204766340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497374792287
                                         uncertainty =       0.003317701704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497374792287
                                         uncertainty =       0.003317701704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498746024
  error estimate for blocks of size 2^( 2) =       0.000520176873
  error estimate for blocks of size 2^( 3) =       0.000540131836
  error estimate for blocks of size 2^( 4) =       0.000554802218
  error estimate for blocks of size 2^( 5) =       0.000564097210
  error estimate for blocks of size 2^( 6) =       0.000568903712
  error estimate for blocks of size 2^( 7) =       0.000574505088

      target function =      -0.696852108076
              le_mean =     -22.812070407084
             les_mean =     520.905351614342
             stat err =       0.000565577057
             autocorr =       1.285951753184
   target nu stat err =       0.000565577057
   target dn stat err =       0.004080757596
      target stat err =       0.002801733029
              std dev =       0.705333391012
             le_variance =       0.497495192477


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.696826433862        initial
     4.0000e+00     4.0000e+01             3.9888e-04        -0.697223827473  <--
     1.6000e+01     1.6000e+02             1.0060e-04        -0.694497154093
     6.4000e+01     6.4000e+02             2.5204e-05        -0.696852108076

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.3100e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.590992e-01 3 1  ON 0
ci_02                -5.424895e-02 3 1  ON 1
ci_03                -5.422349e-02 3 1  ON 2
ci_04                 5.296934e-02 3 1  ON 3
ci_05                -3.799664e-02 3 1  ON 4
ci_06                -3.799683e-02 3 1  ON 5
ci_07                 3.018648e-02 3 1  ON 6
ci_08                -1.696172e-02 3 1  ON 7
ci_09                -1.638589e-02 3 1  ON 8
ci_10                -1.629378e-02 3 1  ON 9
ci_11                 1.579768e-02 3 1  ON 10
ci_12                 1.260191e-02 3 1  ON 11
ci_13                 1.264237e-02 3 1  ON 12
ci_14                 1.279787e-02 3 1  ON 13
ci_15                 1.169685e-02 3 1  ON 14
ci_16                 1.168036e-02 3 1  ON 15
ci_17                -1.127185e-02 3 1  ON 16
ci_18                -1.137323e-02 3 1  ON 17
ci_19                 1.135121e-02 3 1  ON 18
ci_20                 1.006648e-02 3 1  ON 19
ci_21                 9.844790e-03 3 1  ON 20
ci_22                 9.761621e-03 3 1  ON 21
ci_23                 6.492806e-03 3 1  ON 22
ci_24                 5.208857e-03 3 1  ON 23
ci_25                 4.906634e-03 3 1  ON 24
ci_26                 4.555614e-03 3 1  ON 25
ci_27                 4.608764e-03 3 1  ON 26
ci_28                 3.897033e-03 3 1  ON 27
ci_29                 3.949582e-03 3 1  ON 28
ci_30                -3.500933e-03 3 1  ON 29
ci_31                -3.394177e-03 3 1  ON 30
ci_32                -3.083028e-03 3 1  ON 31
ci_33                -3.090591e-03 3 1  ON 32
ci_34                 2.601172e-03 3 1  ON 33
ci_35                 2.546779e-03 3 1  ON 34
ci_36                -2.395275e-03 3 1  ON 35
ci_37                -2.377016e-03 3 1  ON 36
ci_38                -1.944362e-03 3 1  ON 37
ci_39                -1.877394e-03 3 1  ON 38
ci_40                -1.978050e-03 3 1  ON 39
ci_41                -1.800157e-03 3 1  ON 40
ci_42                -1.896724e-03 3 1  ON 41
ci_43                -2.079920e-03 3 1  ON 42
ci_44                -1.986304e-03 3 1  ON 43
ci_45                -1.666337e-03 3 1  ON 44
ci_46                -1.702007e-03 3 1  ON 45
ci_47                -1.530284e-03 3 1  ON 46
ci_48                -1.545576e-03 3 1  ON 47
ci_49                -1.683012e-03 3 1  ON 48
ci_50                -1.575410e-03 3 1  ON 49
ci_51                 1.548104e-03 3 1  ON 50
ci_52                 1.506338e-03 3 1  ON 51
ci_53                -1.406908e-03 3 1  ON 52
ci_54                -1.369281e-03 3 1  ON 53
ci_55                -1.387925e-03 3 1  ON 54
ci_56                 1.451118e-03 3 1  ON 55
ci_57                 1.370079e-03 3 1  ON 56
ci_58                -1.211442e-03 3 1  ON 57
ci_59                -1.231870e-03 3 1  ON 58
ci_60                 1.088871e-03 3 1  ON 59
ci_61                 1.169000e-03 3 1  ON 60
ci_62                -1.072139e-03 3 1  ON 61
ci_63                -1.046722e-03 3 1  ON 62
ci_64                -1.002071e-03 3 1  ON 63
ci_65                -1.015326e-03 3 1  ON 64
ci_66                -9.939625e-04 3 1  ON 65
ci_67                -9.573920e-04 3 1  ON 66
ci_68                 7.042749e-04 3 1  ON 67
ci_69                 7.020446e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3601e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7317
    reference variance = 2.11293
====================================================
  Execution time = 2.5758e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5310e+04
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.1648e-01
  Total weights = 1.962766600e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499121708114
                                         uncertainty =       0.002538922544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499121708114
                                         uncertainty =       0.002538922544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499562640
  error estimate for blocks of size 2^( 2) =       0.000520171343
  error estimate for blocks of size 2^( 3) =       0.000540414196
  error estimate for blocks of size 2^( 4) =       0.000554855111
  error estimate for blocks of size 2^( 5) =       0.000562816471
  error estimate for blocks of size 2^( 6) =       0.000566799616
  error estimate for blocks of size 2^( 7) =       0.000567263706

      target function =      -0.695719222128
              le_mean =     -22.812018546210
             les_mean =     520.904672890715
             stat err =       0.000562933726
             autocorr =       1.269797984512
   target nu stat err =       0.000562933726
   target dn stat err =       0.003714627003
      target stat err =       0.002551512719
              std dev =       0.706488260416
             le_variance =       0.499125662106


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281201854621e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.695727872401       residual = 8.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696431929569       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696539356714       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696552872207       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696556507707       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696557808467       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696558125336       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696558101377       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696558095712       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696558098129       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696558099254       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.518724e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.695727872401       residual = 8.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.695909707323       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.695937119847       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.695940519358       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.695941421270       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.695941737050       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.695941810605       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.695941804289       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.695941802990       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.695941803616       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.695941803876       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.930156e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.695727872401       residual = 8.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.695773709531       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.695780597898       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.695781448938       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.695781673912       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.695781752240       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.695781770269       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.695781768671       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.695781768354       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.695781768512       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.695781768575       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 9.912272e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.416493 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0344e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.588087e-01 3 1  ON 0
ci_02                -5.391510e-02 3 1  ON 1
ci_03                -5.389551e-02 3 1  ON 2
ci_04                 5.257633e-02 3 1  ON 3
ci_05                -3.776162e-02 3 1  ON 4
ci_06                -3.775870e-02 3 1  ON 5
ci_07                 3.014621e-02 3 1  ON 6
ci_08                -1.680274e-02 3 1  ON 7
ci_09                -1.630489e-02 3 1  ON 8
ci_10                -1.618780e-02 3 1  ON 9
ci_11                 1.575499e-02 3 1  ON 10
ci_12                 1.252516e-02 3 1  ON 11
ci_13                 1.261884e-02 3 1  ON 12
ci_14                 1.282756e-02 3 1  ON 13
ci_15                 1.162807e-02 3 1  ON 14
ci_16                 1.163246e-02 3 1  ON 15
ci_17                -1.124185e-02 3 1  ON 16
ci_18                -1.133856e-02 3 1  ON 17
ci_19                 1.131587e-02 3 1  ON 18
ci_20                 1.001769e-02 3 1  ON 19
ci_21                 9.828178e-03 3 1  ON 20
ci_22                 9.760653e-03 3 1  ON 21
ci_23                 6.466408e-03 3 1  ON 22
ci_24                 5.176986e-03 3 1  ON 23
ci_25                 4.869145e-03 3 1  ON 24
ci_26                 4.535082e-03 3 1  ON 25
ci_27                 4.585052e-03 3 1  ON 26
ci_28                 3.886781e-03 3 1  ON 27
ci_29                 3.920116e-03 3 1  ON 28
ci_30                -3.483505e-03 3 1  ON 29
ci_31                -3.407483e-03 3 1  ON 30
ci_32                -3.033063e-03 3 1  ON 31
ci_33                -3.058591e-03 3 1  ON 32
ci_34                 2.585910e-03 3 1  ON 33
ci_35                 2.498996e-03 3 1  ON 34
ci_36                -2.373728e-03 3 1  ON 35
ci_37                -2.371188e-03 3 1  ON 36
ci_38                -1.934886e-03 3 1  ON 37
ci_39                -1.859588e-03 3 1  ON 38
ci_40                -1.972697e-03 3 1  ON 39
ci_41                -1.779689e-03 3 1  ON 40
ci_42                -1.892348e-03 3 1  ON 41
ci_43                -2.054766e-03 3 1  ON 42
ci_44                -1.983697e-03 3 1  ON 43
ci_45                -1.654954e-03 3 1  ON 44
ci_46                -1.696235e-03 3 1  ON 45
ci_47                -1.511768e-03 3 1  ON 46
ci_48                -1.514104e-03 3 1  ON 47
ci_49                -1.681386e-03 3 1  ON 48
ci_50                -1.574846e-03 3 1  ON 49
ci_51                 1.522236e-03 3 1  ON 50
ci_52                 1.492270e-03 3 1  ON 51
ci_53                -1.387872e-03 3 1  ON 52
ci_54                -1.356993e-03 3 1  ON 53
ci_55                -1.391927e-03 3 1  ON 54
ci_56                 1.459263e-03 3 1  ON 55
ci_57                 1.379540e-03 3 1  ON 56
ci_58                -1.202314e-03 3 1  ON 57
ci_59                -1.220310e-03 3 1  ON 58
ci_60                 1.088529e-03 3 1  ON 59
ci_61                 1.175780e-03 3 1  ON 60
ci_62                -1.060520e-03 3 1  ON 61
ci_63                -1.045668e-03 3 1  ON 62
ci_64                -9.828092e-04 3 1  ON 63
ci_65                -1.013563e-03 3 1  ON 64
ci_66                -1.001568e-03 3 1  ON 65
ci_67                -9.445563e-04 3 1  ON 66
ci_68                 6.841824e-04 3 1  ON 67
ci_69                 6.794744e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7381
    reference variance = 0.65576
====================================================
  Execution time = 2.7299e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.0916e-01
  Total weights = 1.9633e+06
  Execution time = 3.6167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.213198
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494316474469
                                         uncertainty =       0.002125883185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494316474469
                                         uncertainty =       0.002125883185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497148968
  error estimate for blocks of size 2^( 2) =       0.000518244061
  error estimate for blocks of size 2^( 3) =       0.000538604284
  error estimate for blocks of size 2^( 4) =       0.000553634291
  error estimate for blocks of size 2^( 5) =       0.000564476780
  error estimate for blocks of size 2^( 6) =       0.000570101163
  error estimate for blocks of size 2^( 7) =       0.000572053854

      target function =      -0.691464631281
              le_mean =     -22.811548536489
             les_mean =     520.889450472165
             stat err =       0.000565066522
             autocorr =       1.291891592749
   target nu stat err =       0.000565066522
   target dn stat err =       0.013414704071
      target stat err =       0.008905469630
              std dev =       0.703074812466
             le_variance =       0.494314191924

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00408728
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491914333587
                                         uncertainty =       0.002111115217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491914333587
                                         uncertainty =       0.002111115217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495939616
  error estimate for blocks of size 2^( 2) =       0.000516972991
  error estimate for blocks of size 2^( 3) =       0.000537278312
  error estimate for blocks of size 2^( 4) =       0.000552302642
  error estimate for blocks of size 2^( 5) =       0.000563127291
  error estimate for blocks of size 2^( 6) =       0.000568753199
  error estimate for blocks of size 2^( 7) =       0.000570753307

      target function =      -0.696309035127
              le_mean =     -22.811557455861
             les_mean =     520.882690743534
             stat err =       0.000563734110
             autocorr =       1.292084816530
   target nu stat err =       0.000563734110
   target dn stat err =       0.008976174161
      target stat err =       0.006055533507
              std dev =       0.701364531548
             le_variance =       0.491912206113

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.221981
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493043311866
                                         uncertainty =       0.002117714302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493043311866
                                         uncertainty =       0.002117714302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496508370
  error estimate for blocks of size 2^( 2) =       0.000517570341
  error estimate for blocks of size 2^( 3) =       0.000537902202
  error estimate for blocks of size 2^( 4) =       0.000552929538
  error estimate for blocks of size 2^( 5) =       0.000563764169
  error estimate for blocks of size 2^( 6) =       0.000569388151
  error estimate for blocks of size 2^( 7) =       0.000571366174

      target function =      -0.700004908161
              le_mean =     -22.811548907451
             les_mean =     520.876896602812
             stat err =       0.000564362008
             autocorr =       1.291999635184
   target nu stat err =       0.000564362008
   target dn stat err =       0.003163392985
      target stat err =       0.002216587550
              std dev =       0.702168871322
             le_variance =       0.493041123853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494152023884
                                         uncertainty =       0.002124791352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494152023884
                                         uncertainty =       0.002124791352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497066271
  error estimate for blocks of size 2^( 2) =       0.000518157075
  error estimate for blocks of size 2^( 3) =       0.000538513947
  error estimate for blocks of size 2^( 4) =       0.000553543344
  error estimate for blocks of size 2^( 5) =       0.000564384339
  error estimate for blocks of size 2^( 6) =       0.000570007970
  error estimate for blocks of size 2^( 7) =       0.000571966100

      target function =      -0.700526567715
              le_mean =     -22.811548276920
             les_mean =     520.876101809817
             stat err =       0.000564975438
             autocorr =       1.291904899855
   target nu stat err =       0.000564975438
   target dn stat err =       0.002872361832
      target stat err =       0.002028753884
              std dev =       0.702957862258
             le_variance =       0.494149756111


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.691464631281        initial
     1.0000e+00     1.0000e+01             1.5187e-03        -0.696309035127
     4.0000e+00     4.0000e+01             3.9302e-04        -0.700004908161
     1.6000e+01     1.6000e+02             9.9123e-05        -0.700526567715  <--

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.5443e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.590262e-01 3 1  ON 0
ci_02                -5.416484e-02 3 1  ON 1
ci_03                -5.414086e-02 3 1  ON 2
ci_04                 5.287022e-02 3 1  ON 3
ci_05                -3.793740e-02 3 1  ON 4
ci_06                -3.793681e-02 3 1  ON 5
ci_07                 3.017635e-02 3 1  ON 6
ci_08                -1.692164e-02 3 1  ON 7
ci_09                -1.636550e-02 3 1  ON 8
ci_10                -1.626710e-02 3 1  ON 9
ci_11                 1.578693e-02 3 1  ON 10
ci_12                 1.258257e-02 3 1  ON 11
ci_13                 1.263646e-02 3 1  ON 12
ci_14                 1.280531e-02 3 1  ON 13
ci_15                 1.167953e-02 3 1  ON 14
ci_16                 1.166829e-02 3 1  ON 15
ci_17                -1.126431e-02 3 1  ON 16
ci_18                -1.136451e-02 3 1  ON 17
ci_19                 1.134229e-02 3 1  ON 18
ci_20                 1.005418e-02 3 1  ON 19
ci_21                 9.840618e-03 3 1  ON 20
ci_22                 9.761377e-03 3 1  ON 21
ci_23                 6.486146e-03 3 1  ON 22
ci_24                 5.200836e-03 3 1  ON 23
ci_25                 4.897175e-03 3 1  ON 24
ci_26                 4.550431e-03 3 1  ON 25
ci_27                 4.602782e-03 3 1  ON 26
ci_28                 3.894467e-03 3 1  ON 27
ci_29                 3.942169e-03 3 1  ON 28
ci_30                -3.496558e-03 3 1  ON 29
ci_31                -3.397520e-03 3 1  ON 30
ci_32                -3.070414e-03 3 1  ON 31
ci_33                -3.082504e-03 3 1  ON 32
ci_34                 2.597311e-03 3 1  ON 33
ci_35                 2.534721e-03 3 1  ON 34
ci_36                -2.389846e-03 3 1  ON 35
ci_37                -2.375547e-03 3 1  ON 36
ci_38                -1.941977e-03 3 1  ON 37
ci_39                -1.872908e-03 3 1  ON 38
ci_40                -1.976702e-03 3 1  ON 39
ci_41                -1.794980e-03 3 1  ON 40
ci_42                -1.895611e-03 3 1  ON 41
ci_43                -2.073601e-03 3 1  ON 42
ci_44                -1.985663e-03 3 1  ON 43
ci_45                -1.663473e-03 3 1  ON 44
ci_46                -1.700557e-03 3 1  ON 45
ci_47                -1.525627e-03 3 1  ON 46
ci_48                -1.537668e-03 3 1  ON 47
ci_49                -1.682606e-03 3 1  ON 48
ci_50                -1.575271e-03 3 1  ON 49
ci_51                 1.541584e-03 3 1  ON 50
ci_52                 1.502792e-03 3 1  ON 51
ci_53                -1.402105e-03 3 1  ON 52
ci_54                -1.366183e-03 3 1  ON 53
ci_55                -1.388933e-03 3 1  ON 54
ci_56                 1.453168e-03 3 1  ON 55
ci_57                 1.372464e-03 3 1  ON 56
ci_58                -1.209136e-03 3 1  ON 57
ci_59                -1.228957e-03 3 1  ON 58
ci_60                 1.088776e-03 3 1  ON 59
ci_61                 1.170702e-03 3 1  ON 60
ci_62                -1.069212e-03 3 1  ON 61
ci_63                -1.046459e-03 3 1  ON 62
ci_64                -9.972196e-04 3 1  ON 63
ci_65                -1.014887e-03 3 1  ON 64
ci_66                -9.958825e-04 3 1  ON 65
ci_67                -9.541575e-04 3 1  ON 66
ci_68                 6.992132e-04 3 1  ON 67
ci_69                 6.963575e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5797e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.825
    reference variance = 0.446413
====================================================
  Execution time = 2.5673e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.2151e-01
  Total weights = 1.963042800e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502311229572
                                         uncertainty =       0.003153900537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502311229572
                                         uncertainty =       0.003153900537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501176621
  error estimate for blocks of size 2^( 2) =       0.000521729216
  error estimate for blocks of size 2^( 3) =       0.000541324326
  error estimate for blocks of size 2^( 4) =       0.000556289336
  error estimate for blocks of size 2^( 5) =       0.000565193131
  error estimate for blocks of size 2^( 6) =       0.000568474502
  error estimate for blocks of size 2^( 7) =       0.000570785260

      target function =      -0.692359211066
              le_mean =     -22.810705247084
             les_mean =     520.849783187240
             stat err =       0.000565185558
             autocorr =       1.271746361247
   target nu stat err =       0.000565185558
   target dn stat err =       0.004380996108
      target stat err =       0.002956700693
              std dev =       0.708770774533
             le_variance =       0.502356010832


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281070524708e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.692371063698       residual = 8.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.692549006640       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.692581047045       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.692584680041       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.692585610128       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.692586001874       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.692586083194       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.692586084576       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.692586083608       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.692586083244       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.692586083436       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.770074e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.692371063698       residual = 8.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.692415921460       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.692423970413       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.692424879691       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.692425111629       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.692425208540       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.692425228460       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.692425228774       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.692425228531       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.692425228440       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.692425228486       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 9.508294e-05

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.692371063698       residual = 8.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.692382301625       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.692384316298       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.692384543679       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.692384601626       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.692384625788       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.692384630743       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.692384630820       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.692384630759       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.692384630736       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.692384630747       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+01 is 2.382323e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.425490 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0288e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.589453e-01 3 1  ON 0
ci_02                -5.408091e-02 3 1  ON 1
ci_03                -5.405791e-02 3 1  ON 2
ci_04                 5.277514e-02 3 1  ON 3
ci_05                -3.787915e-02 3 1  ON 4
ci_06                -3.787447e-02 3 1  ON 5
ci_07                 3.016974e-02 3 1  ON 6
ci_08                -1.687945e-02 3 1  ON 7
ci_09                -1.634167e-02 3 1  ON 8
ci_10                -1.623896e-02 3 1  ON 9
ci_11                 1.577390e-02 3 1  ON 10
ci_12                 1.257364e-02 3 1  ON 11
ci_13                 1.263386e-02 3 1  ON 12
ci_14                 1.279656e-02 3 1  ON 13
ci_15                 1.166515e-02 3 1  ON 14
ci_16                 1.165146e-02 3 1  ON 15
ci_17                -1.124440e-02 3 1  ON 16
ci_18                -1.135036e-02 3 1  ON 17
ci_19                 1.133478e-02 3 1  ON 18
ci_20                 1.004860e-02 3 1  ON 19
ci_21                 9.841391e-03 3 1  ON 20
ci_22                 9.760471e-03 3 1  ON 21
ci_23                 6.480932e-03 3 1  ON 22
ci_24                 5.197296e-03 3 1  ON 23
ci_25                 4.889769e-03 3 1  ON 24
ci_26                 4.544605e-03 3 1  ON 25
ci_27                 4.597216e-03 3 1  ON 26
ci_28                 3.889495e-03 3 1  ON 27
ci_29                 3.933298e-03 3 1  ON 28
ci_30                -3.491475e-03 3 1  ON 29
ci_31                -3.390942e-03 3 1  ON 30
ci_32                -3.058907e-03 3 1  ON 31
ci_33                -3.074875e-03 3 1  ON 32
ci_34                 2.593870e-03 3 1  ON 33
ci_35                 2.530290e-03 3 1  ON 34
ci_36                -2.387604e-03 3 1  ON 35
ci_37                -2.369435e-03 3 1  ON 36
ci_38                -1.935105e-03 3 1  ON 37
ci_39                -1.867039e-03 3 1  ON 38
ci_40                -1.975123e-03 3 1  ON 39
ci_41                -1.782841e-03 3 1  ON 40
ci_42                -1.889861e-03 3 1  ON 41
ci_43                -2.075382e-03 3 1  ON 42
ci_44                -1.988951e-03 3 1  ON 43
ci_45                -1.660060e-03 3 1  ON 44
ci_46                -1.700879e-03 3 1  ON 45
ci_47                -1.520489e-03 3 1  ON 46
ci_48                -1.531080e-03 3 1  ON 47
ci_49                -1.681217e-03 3 1  ON 48
ci_50                -1.572711e-03 3 1  ON 49
ci_51                 1.538676e-03 3 1  ON 50
ci_52                 1.498370e-03 3 1  ON 51
ci_53                -1.400497e-03 3 1  ON 52
ci_54                -1.364281e-03 3 1  ON 53
ci_55                -1.382710e-03 3 1  ON 54
ci_56                 1.450966e-03 3 1  ON 55
ci_57                 1.371074e-03 3 1  ON 56
ci_58                -1.206216e-03 3 1  ON 57
ci_59                -1.224909e-03 3 1  ON 58
ci_60                 1.083868e-03 3 1  ON 59
ci_61                 1.169901e-03 3 1  ON 60
ci_62                -1.067166e-03 3 1  ON 61
ci_63                -1.043786e-03 3 1  ON 62
ci_64                -9.964827e-04 3 1  ON 63
ci_65                -1.014989e-03 3 1  ON 64
ci_66                -9.930114e-04 3 1  ON 65
ci_67                -9.528477e-04 3 1  ON 66
ci_68                 6.893468e-04 3 1  ON 67
ci_69                 6.910773e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8722
    reference variance = 0.463917
====================================================
  Execution time = 2.5085e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.1255e-01
  Total weights = 1.9628e+06
  Execution time = 3.6064e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495345873958
                                         uncertainty =       0.002831494978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495345873958
                                         uncertainty =       0.002831494978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497656255
  error estimate for blocks of size 2^( 2) =       0.000518670922
  error estimate for blocks of size 2^( 3) =       0.000538315587
  error estimate for blocks of size 2^( 4) =       0.000552602102
  error estimate for blocks of size 2^( 5) =       0.000559992604
  error estimate for blocks of size 2^( 6) =       0.000564438390
  error estimate for blocks of size 2^( 7) =       0.000563691733

      target function =      -0.698253621430
              le_mean =     -22.812996482918
             les_mean =     520.945537291470
             stat err =       0.000560181208
             autocorr =       1.267062788239
   target nu stat err =       0.000560181208
   target dn stat err =       0.003783402388
      target stat err =       0.002618167691
              std dev =       0.703792225352
             le_variance =       0.495323496467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494724249927
                                         uncertainty =       0.002835839112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494724249927
                                         uncertainty =       0.002835839112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497343936
  error estimate for blocks of size 2^( 2) =       0.000518342026
  error estimate for blocks of size 2^( 3) =       0.000537975402
  error estimate for blocks of size 2^( 4) =       0.000552259603
  error estimate for blocks of size 2^( 5) =       0.000559649658
  error estimate for blocks of size 2^( 6) =       0.000564097388
  error estimate for blocks of size 2^( 7) =       0.000563354152

      target function =      -0.698645711236
              le_mean =     -22.812994448516
             les_mean =     520.944865492716
             stat err =       0.000559840200
             autocorr =       1.267110547985
   target nu stat err =       0.000559840200
   target dn stat err =       0.003794403907
      target stat err =       0.002628264468
              std dev =       0.703350539543
             le_variance =       0.494701981475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495030230178
                                         uncertainty =       0.002833583773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495030230178
                                         uncertainty =       0.002833583773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497497693
  error estimate for blocks of size 2^( 2) =       0.000518503970
  error estimate for blocks of size 2^( 3) =       0.000538142899
  error estimate for blocks of size 2^( 4) =       0.000552428223
  error estimate for blocks of size 2^( 5) =       0.000559818498
  error estimate for blocks of size 2^( 6) =       0.000564265237
  error estimate for blocks of size 2^( 7) =       0.000563520265

      target function =      -0.698491884140
              le_mean =     -22.812995132086
             les_mean =     520.945123764227
             stat err =       0.000560008056
             autocorr =       1.267086917949
   target nu stat err =       0.000560008056
   target dn stat err =       0.003788288888
      target stat err =       0.002623115110
              std dev =       0.703567984354
             le_variance =       0.495007908607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495306076584
                                         uncertainty =       0.002831745473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495306076584
                                         uncertainty =       0.002831745473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497636266
  error estimate for blocks of size 2^( 2) =       0.000518649879
  error estimate for blocks of size 2^( 3) =       0.000538293821
  error estimate for blocks of size 2^( 4) =       0.000552580183
  error estimate for blocks of size 2^( 5) =       0.000559970657
  error estimate for blocks of size 2^( 6) =       0.000564416560
  error estimate for blocks of size 2^( 7) =       0.000563670107

      target function =      -0.698285890637
              le_mean =     -22.812996276556
             les_mean =     520.945480203702
             stat err =       0.000560159377
             autocorr =       1.267065818111
   target nu stat err =       0.000560159377
   target dn stat err =       0.003783950535
      target stat err =       0.002618762395
              std dev =       0.703763956309
             le_variance =       0.495283706199


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.698253621430        initial
     4.0000e+00     4.0000e+01             3.7701e-04        -0.698645711236  <--
     1.6000e+01     1.6000e+02             9.5083e-05        -0.698491884140
     6.4000e+01     6.4000e+02             2.3823e-05        -0.698285890637

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.3163e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.587042e-01 3 1  ON 0
ci_02                -5.383165e-02 3 1  ON 1
ci_03                -5.381158e-02 3 1  ON 2
ci_04                 5.249321e-02 3 1  ON 3
ci_05                -3.770626e-02 3 1  ON 4
ci_06                -3.768950e-02 3 1  ON 5
ci_07                 3.015010e-02 3 1  ON 6
ci_08                -1.675431e-02 3 1  ON 7
ci_09                -1.627082e-02 3 1  ON 8
ci_10                -1.615530e-02 3 1  ON 9
ci_11                 1.573518e-02 3 1  ON 10
ci_12                 1.254711e-02 3 1  ON 11
ci_13                 1.262610e-02 3 1  ON 12
ci_14                 1.277049e-02 3 1  ON 13
ci_15                 1.162245e-02 3 1  ON 14
ci_16                 1.160148e-02 3 1  ON 15
ci_17                -1.118520e-02 3 1  ON 16
ci_18                -1.130825e-02 3 1  ON 17
ci_19                 1.131255e-02 3 1  ON 18
ci_20                 1.003204e-02 3 1  ON 19
ci_21                 9.843672e-03 3 1  ON 20
ci_22                 9.757759e-03 3 1  ON 21
ci_23                 6.465498e-03 3 1  ON 22
ci_24                 5.186791e-03 3 1  ON 23
ci_25                 4.867803e-03 3 1  ON 24
ci_26                 4.527329e-03 3 1  ON 25
ci_27                 4.580707e-03 3 1  ON 26
ci_28                 3.874686e-03 3 1  ON 27
ci_29                 3.906908e-03 3 1  ON 28
ci_30                -3.476338e-03 3 1  ON 29
ci_31                -3.371362e-03 3 1  ON 30
ci_32                -3.024820e-03 3 1  ON 31
ci_33                -3.052301e-03 3 1  ON 32
ci_34                 2.583741e-03 3 1  ON 33
ci_35                 2.517207e-03 3 1  ON 34
ci_36                -2.380941e-03 3 1  ON 35
ci_37                -2.351299e-03 3 1  ON 36
ci_38                -1.914708e-03 3 1  ON 37
ci_39                -1.849627e-03 3 1  ON 38
ci_40                -1.970445e-03 3 1  ON 39
ci_41                -1.746923e-03 3 1  ON 40
ci_42                -1.872882e-03 3 1  ON 41
ci_43                -2.080613e-03 3 1  ON 42
ci_44                -1.998659e-03 3 1  ON 43
ci_45                -1.649928e-03 3 1  ON 44
ci_46                -1.701822e-03 3 1  ON 45
ci_47                -1.505169e-03 3 1  ON 46
ci_48                -1.511447e-03 3 1  ON 47
ci_49                -1.677089e-03 3 1  ON 48
ci_50                -1.565127e-03 3 1  ON 49
ci_51                 1.530038e-03 3 1  ON 50
ci_52                 1.485239e-03 3 1  ON 51
ci_53                -1.395728e-03 3 1  ON 52
ci_54                -1.358625e-03 3 1  ON 53
ci_55                -1.364237e-03 3 1  ON 54
ci_56                 1.444461e-03 3 1  ON 55
ci_57                 1.366964e-03 3 1  ON 56
ci_58                -1.197562e-03 3 1  ON 57
ci_59                -1.212902e-03 3 1  ON 58
ci_60                 1.069236e-03 3 1  ON 59
ci_61                 1.167495e-03 3 1  ON 60
ci_62                -1.061096e-03 3 1  ON 61
ci_63                -1.035850e-03 3 1  ON 62
ci_64                -9.942919e-04 3 1  ON 63
ci_65                -1.015277e-03 3 1  ON 64
ci_66                -9.844869e-04 3 1  ON 65
ci_67                -9.489533e-04 3 1  ON 66
ci_68                 6.600535e-04 3 1  ON 67
ci_69                 6.753930e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3466e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8712
    reference variance = 0.368352
====================================================
  Execution time = 2.5585e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1995e-01
  Total weights = 1.962798095e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5977e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501469479757
                                         uncertainty =       0.002980451726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501469479757
                                         uncertainty =       0.002980451726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500696384
  error estimate for blocks of size 2^( 2) =       0.000521638730
  error estimate for blocks of size 2^( 3) =       0.000541691435
  error estimate for blocks of size 2^( 4) =       0.000556544075
  error estimate for blocks of size 2^( 5) =       0.000564952136
  error estimate for blocks of size 2^( 6) =       0.000571445174
  error estimate for blocks of size 2^( 7) =       0.000574291979

      target function =      -0.693400478192
              le_mean =     -22.811194087337
             les_mean =     520.870521670528
             stat err =       0.000566808341
             autocorr =       1.281514588312
   target nu stat err =       0.000566808341
   target dn stat err =       0.004056021859
      target stat err =       0.002755288239
              std dev =       0.708091617532
             le_variance =       0.501393738819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281119408734e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.693410649519       residual = 8.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.694099024644       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.694213789320       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.694229557411       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.694233064807       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.694234693879       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.694234870493       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.694234859922       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.694234855311       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.694234867181       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.694234862045       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.497149e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.693410649519       residual = 8.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.693588431204       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.693617697254       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.693621666942       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.693622527280       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.693622922939       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.693622966414       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.693622962856       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.693622961762       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.693622964585       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.693622963349       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.873476e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.693410649519       residual = 8.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.693455464714       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.693462817613       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.693463811633       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.693464025599       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.693464123761       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.693464134585       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.693464133639       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.693464133370       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.693464134066       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.693464133761       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 9.768761e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.434511 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0201e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.583831e-01 3 1  ON 0
ci_02                -5.348278e-02 3 1  ON 1
ci_03                -5.350484e-02 3 1  ON 2
ci_04                 5.210587e-02 3 1  ON 3
ci_05                -3.747650e-02 3 1  ON 4
ci_06                -3.747225e-02 3 1  ON 5
ci_07                 3.010987e-02 3 1  ON 6
ci_08                -1.659158e-02 3 1  ON 7
ci_09                -1.617581e-02 3 1  ON 8
ci_10                -1.606050e-02 3 1  ON 9
ci_11                 1.568125e-02 3 1  ON 10
ci_12                 1.246599e-02 3 1  ON 11
ci_13                 1.263948e-02 3 1  ON 12
ci_14                 1.277735e-02 3 1  ON 13
ci_15                 1.155489e-02 3 1  ON 14
ci_16                 1.153041e-02 3 1  ON 15
ci_17                -1.112473e-02 3 1  ON 16
ci_18                -1.125136e-02 3 1  ON 17
ci_19                 1.128136e-02 3 1  ON 18
ci_20                 9.989396e-03 3 1  ON 19
ci_21                 9.842990e-03 3 1  ON 20
ci_22                 9.748736e-03 3 1  ON 21
ci_23                 6.447325e-03 3 1  ON 22
ci_24                 5.163110e-03 3 1  ON 23
ci_25                 4.832850e-03 3 1  ON 24
ci_26                 4.508556e-03 3 1  ON 25
ci_27                 4.567284e-03 3 1  ON 26
ci_28                 3.853130e-03 3 1  ON 27
ci_29                 3.878113e-03 3 1  ON 28
ci_30                -3.462235e-03 3 1  ON 29
ci_31                -3.356774e-03 3 1  ON 30
ci_32                -2.991962e-03 3 1  ON 31
ci_33                -3.018033e-03 3 1  ON 32
ci_34                 2.529357e-03 3 1  ON 33
ci_35                 2.506432e-03 3 1  ON 34
ci_36                -2.369110e-03 3 1  ON 35
ci_37                -2.341391e-03 3 1  ON 36
ci_38                -1.898478e-03 3 1  ON 37
ci_39                -1.839262e-03 3 1  ON 38
ci_40                -1.971747e-03 3 1  ON 39
ci_41                -1.742673e-03 3 1  ON 40
ci_42                -1.850158e-03 3 1  ON 41
ci_43                -2.093197e-03 3 1  ON 42
ci_44                -1.973972e-03 3 1  ON 43
ci_45                -1.637748e-03 3 1  ON 44
ci_46                -1.679730e-03 3 1  ON 45
ci_47                -1.485847e-03 3 1  ON 46
ci_48                -1.494029e-03 3 1  ON 47
ci_49                -1.666125e-03 3 1  ON 48
ci_50                -1.561495e-03 3 1  ON 49
ci_51                 1.518860e-03 3 1  ON 50
ci_52                 1.467546e-03 3 1  ON 51
ci_53                -1.390450e-03 3 1  ON 52
ci_54                -1.361431e-03 3 1  ON 53
ci_55                -1.351033e-03 3 1  ON 54
ci_56                 1.462146e-03 3 1  ON 55
ci_57                 1.358579e-03 3 1  ON 56
ci_58                -1.205783e-03 3 1  ON 57
ci_59                -1.210583e-03 3 1  ON 58
ci_60                 1.074957e-03 3 1  ON 59
ci_61                 1.171568e-03 3 1  ON 60
ci_62                -1.039863e-03 3 1  ON 61
ci_63                -1.030495e-03 3 1  ON 62
ci_64                -9.998162e-04 3 1  ON 63
ci_65                -1.008227e-03 3 1  ON 64
ci_66                -9.927338e-04 3 1  ON 65
ci_67                -9.557624e-04 3 1  ON 66
ci_68                 6.295098e-04 3 1  ON 67
ci_69                 6.729648e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8193
    reference variance = 0.426081
====================================================
  Execution time = 2.4949e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.1450e-01
  Total weights = 1.9633e+06
  Execution time = 3.5968e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498257816754
                                         uncertainty =       0.003118357422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498257816754
                                         uncertainty =       0.003118357422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499111183
  error estimate for blocks of size 2^( 2) =       0.000520111190
  error estimate for blocks of size 2^( 3) =       0.000539909052
  error estimate for blocks of size 2^( 4) =       0.000554737883
  error estimate for blocks of size 2^( 5) =       0.000564091162
  error estimate for blocks of size 2^( 6) =       0.000568290774
  error estimate for blocks of size 2^( 7) =       0.000572185169

      target function =      -0.625997526398
              le_mean =     -22.811824721521
             les_mean =     521.001580539243
             stat err =       0.000564826247
             autocorr =       1.280663814245
   target nu stat err =       0.000564826247
   target dn stat err =       0.105587382537
      target stat err =       0.057848067317
              std dev =       0.705849803877
             le_variance =       0.498223945633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495628878935
                                         uncertainty =       0.003058177173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495628878935
                                         uncertainty =       0.003058177173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497791951
  error estimate for blocks of size 2^( 2) =       0.000518742679
  error estimate for blocks of size 2^( 3) =       0.000538515402
  error estimate for blocks of size 2^( 4) =       0.000553338596
  error estimate for blocks of size 2^( 5) =       0.000562681502
  error estimate for blocks of size 2^( 6) =       0.000566855108
  error estimate for blocks of size 2^( 7) =       0.000570725949

      target function =      -0.697349427501
              le_mean =     -22.811823407460
             les_mean =     520.893342230177
             stat err =       0.000563400289
             autocorr =       1.280968323147
   target nu stat err =       0.000563400289
   target dn stat err =       0.004098475859
      target stat err =       0.002816005409
              std dev =       0.703984128649
             le_variance =       0.495593653390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496841224480
                                         uncertainty =       0.003079939778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496841224480
                                         uncertainty =       0.003079939778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498400744
  error estimate for blocks of size 2^( 2) =       0.000519374417
  error estimate for blocks of size 2^( 3) =       0.000539159918
  error estimate for blocks of size 2^( 4) =       0.000553987369
  error estimate for blocks of size 2^( 5) =       0.000563337126
  error estimate for blocks of size 2^( 6) =       0.000567522171
  error estimate for blocks of size 2^( 7) =       0.000571406048

      target function =      -0.696421472903
              le_mean =     -22.811820866382
             les_mean =     520.894602026369
             stat err =       0.000564063179
             autocorr =       1.280849602692
   target nu stat err =       0.000564063179
   target dn stat err =       0.004423108045
      target stat err =       0.003023189011
              std dev =       0.704845091146
             le_variance =       0.496806602512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498072922003
                                         uncertainty =       0.003112122449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498072922003
                                         uncertainty =       0.003112122449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499018508
  error estimate for blocks of size 2^( 2) =       0.000520014134
  error estimate for blocks of size 2^( 3) =       0.000539808044
  error estimate for blocks of size 2^( 4) =       0.000554639445
  error estimate for blocks of size 2^( 5) =       0.000563993250
  error estimate for blocks of size 2^( 6) =       0.000568193083
  error estimate for blocks of size 2^( 7) =       0.000572084840

      target function =      -0.479442059256
              le_mean =     -22.811825215405
             les_mean =     521.265820991563
             stat err =       0.000564727654
             autocorr =       1.280692315162
   target nu stat err =       0.000564727654
   target dn stat err =       0.371089301744
      target stat err =       0.126463404950
              std dev =       0.705718742219
             le_variance =       0.498038943119


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.625997526398        initial
     1.0000e+00     1.0000e+01             1.4971e-03        -0.697349427501  <--
     4.0000e+00     4.0000e+01             3.8735e-04        -0.696421472903
     1.6000e+01     1.6000e+02             9.7688e-05        -0.479442059256

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.2943e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.574442e-01 3 1  ON 0
ci_02                -5.247766e-02 3 1  ON 1
ci_03                -5.262090e-02 3 1  ON 2
ci_04                 5.099606e-02 3 1  ON 3
ci_05                -3.681590e-02 3 1  ON 4
ci_06                -3.684752e-02 3 1  ON 5
ci_07                 2.999351e-02 3 1  ON 6
ci_08                -1.612512e-02 3 1  ON 7
ci_09                -1.590080e-02 3 1  ON 8
ci_10                -1.578596e-02 3 1  ON 9
ci_11                 1.552552e-02 3 1  ON 10
ci_12                 1.223298e-02 3 1  ON 11
ci_13                 1.267885e-02 3 1  ON 12
ci_14                 1.279803e-02 3 1  ON 13
ci_15                 1.136017e-02 3 1  ON 14
ci_16                 1.132546e-02 3 1  ON 15
ci_17                -1.094958e-02 3 1  ON 16
ci_18                -1.108713e-02 3 1  ON 17
ci_19                 1.119247e-02 3 1  ON 18
ci_20                 9.867177e-03 3 1  ON 19
ci_21                 9.841035e-03 3 1  ON 20
ci_22                 9.722454e-03 3 1  ON 21
ci_23                 6.395375e-03 3 1  ON 22
ci_24                 5.094467e-03 3 1  ON 23
ci_25                 4.732300e-03 3 1  ON 24
ci_26                 4.454944e-03 3 1  ON 25
ci_27                 4.528691e-03 3 1  ON 26
ci_28                 3.790282e-03 3 1  ON 27
ci_29                 3.794689e-03 3 1  ON 28
ci_30                -3.420569e-03 3 1  ON 29
ci_31                -3.313951e-03 3 1  ON 30
ci_32                -2.898671e-03 3 1  ON 31
ci_33                -2.920548e-03 3 1  ON 32
ci_34                 2.373724e-03 3 1  ON 33
ci_35                 2.476300e-03 3 1  ON 34
ci_36                -2.335028e-03 3 1  ON 35
ci_37                -2.312593e-03 3 1  ON 36
ci_38                -1.851744e-03 3 1  ON 37
ci_39                -1.809267e-03 3 1  ON 38
ci_40                -1.975064e-03 3 1  ON 39
ci_41                -1.731299e-03 3 1  ON 40
ci_42                -1.785903e-03 3 1  ON 41
ci_43                -2.128568e-03 3 1  ON 42
ci_44                -1.901677e-03 3 1  ON 43
ci_45                -1.602603e-03 3 1  ON 44
ci_46                -1.616157e-03 3 1  ON 45
ci_47                -1.429189e-03 3 1  ON 46
ci_48                -1.442990e-03 3 1  ON 47
ci_49                -1.634709e-03 3 1  ON 48
ci_50                -1.551168e-03 3 1  ON 49
ci_51                 1.486664e-03 3 1  ON 50
ci_52                 1.416494e-03 3 1  ON 51
ci_53                -1.375136e-03 3 1  ON 52
ci_54                -1.369335e-03 3 1  ON 53
ci_55                -1.313005e-03 3 1  ON 54
ci_56                 1.513056e-03 3 1  ON 55
ci_57                 1.334771e-03 3 1  ON 56
ci_58                -1.229370e-03 3 1  ON 57
ci_59                -1.204106e-03 3 1  ON 58
ci_60                 1.091746e-03 3 1  ON 59
ci_61                 1.183591e-03 3 1  ON 60
ci_62                -9.789269e-04 3 1  ON 61
ci_63                -1.014934e-03 3 1  ON 62
ci_64                -1.015514e-03 3 1  ON 63
ci_65                -9.880702e-04 3 1  ON 64
ci_66                -1.016279e-03 3 1  ON 65
ci_67                -9.751703e-04 3 1  ON 66
ci_68                 5.419184e-04 3 1  ON 67
ci_69                 6.659262e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3160e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7445
    reference variance = 0.354949
====================================================
  Execution time = 2.5703e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.0692e-01
  Total weights = 1.962935575e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5580e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492786213991
                                         uncertainty =       0.002635715564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492786213991
                                         uncertainty =       0.002635715564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496360359
  error estimate for blocks of size 2^( 2) =       0.000517756618
  error estimate for blocks of size 2^( 3) =       0.000538209328
  error estimate for blocks of size 2^( 4) =       0.000552584624
  error estimate for blocks of size 2^( 5) =       0.000562900279
  error estimate for blocks of size 2^( 6) =       0.000568747438
  error estimate for blocks of size 2^( 7) =       0.000574725768

      target function =      -0.702192553454
              le_mean =     -22.811462655557
             les_mean =     520.869748766616
             stat err =       0.000564739527
             autocorr =       1.294500411530
   target nu stat err =       0.000564739527
   target dn stat err =       0.003059147312
      target stat err =       0.002160913036
              std dev =       0.701959550821
             le_variance =       0.492747210989


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281146265556e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702198337883       residual = 7.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.704411674734       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.704781574669       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.704838697243       residual = 6.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.704857226278       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.704867498208       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.704869508519       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.704870020720       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.704870076342       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.704870122406       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.704870144562       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.060786e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702198337883       residual = 7.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702823938105       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.702924353494       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.702939203715       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.702943770322       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.702946090083       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.702946482364       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.702946589704       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.702946600697       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.702946610943       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.702946615281       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.438917e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702198337883       residual = 7.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702359993464       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.702385629304       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.702389372211       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.702390505025       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.702391065688       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.702391156393       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.702391181884       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.702391184451       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.702391186922       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.702391187927       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.724471e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.443585 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0279e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.561191e-01 3 1  ON 0
ci_02                -5.129716e-02 3 1  ON 1
ci_03                -5.143986e-02 3 1  ON 2
ci_04                 4.955715e-02 3 1  ON 3
ci_05                -3.595847e-02 3 1  ON 4
ci_06                -3.602337e-02 3 1  ON 5
ci_07                 2.984753e-02 3 1  ON 6
ci_08                -1.554978e-02 3 1  ON 7
ci_09                -1.552213e-02 3 1  ON 8
ci_10                -1.537393e-02 3 1  ON 9
ci_11                 1.537501e-02 3 1  ON 10
ci_12                 1.195963e-02 3 1  ON 11
ci_13                 1.270970e-02 3 1  ON 12
ci_14                 1.278582e-02 3 1  ON 13
ci_15                 1.114664e-02 3 1  ON 14
ci_16                 1.101486e-02 3 1  ON 15
ci_17                -1.078288e-02 3 1  ON 16
ci_18                -1.091541e-02 3 1  ON 17
ci_19                 1.107278e-02 3 1  ON 18
ci_20                 9.676884e-03 3 1  ON 19
ci_21                 9.808505e-03 3 1  ON 20
ci_22                 9.669334e-03 3 1  ON 21
ci_23                 6.265764e-03 3 1  ON 22
ci_24                 5.108866e-03 3 1  ON 23
ci_25                 4.583510e-03 3 1  ON 24
ci_26                 4.444588e-03 3 1  ON 25
ci_27                 4.434098e-03 3 1  ON 26
ci_28                 3.715497e-03 3 1  ON 27
ci_29                 3.720123e-03 3 1  ON 28
ci_30                -3.346012e-03 3 1  ON 29
ci_31                -3.203187e-03 3 1  ON 30
ci_32                -2.796154e-03 3 1  ON 31
ci_33                -2.809036e-03 3 1  ON 32
ci_34                 2.199736e-03 3 1  ON 33
ci_35                 2.255162e-03 3 1  ON 34
ci_36                -2.269843e-03 3 1  ON 35
ci_37                -2.283077e-03 3 1  ON 36
ci_38                -1.797188e-03 3 1  ON 37
ci_39                -1.706444e-03 3 1  ON 38
ci_40                -1.960041e-03 3 1  ON 39
ci_41                -1.697652e-03 3 1  ON 40
ci_42                -1.781582e-03 3 1  ON 41
ci_43                -2.153754e-03 3 1  ON 42
ci_44                -1.901375e-03 3 1  ON 43
ci_45                -1.541667e-03 3 1  ON 44
ci_46                -1.623677e-03 3 1  ON 45
ci_47                -1.346894e-03 3 1  ON 46
ci_48                -1.324505e-03 3 1  ON 47
ci_49                -1.596383e-03 3 1  ON 48
ci_50                -1.486989e-03 3 1  ON 49
ci_51                 1.437129e-03 3 1  ON 50
ci_52                 1.322801e-03 3 1  ON 51
ci_53                -1.343934e-03 3 1  ON 52
ci_54                -1.303514e-03 3 1  ON 53
ci_55                -1.276658e-03 3 1  ON 54
ci_56                 1.543867e-03 3 1  ON 55
ci_57                 1.410162e-03 3 1  ON 56
ci_58                -1.220137e-03 3 1  ON 57
ci_59                -1.217536e-03 3 1  ON 58
ci_60                 1.080427e-03 3 1  ON 59
ci_61                 1.193059e-03 3 1  ON 60
ci_62                -1.013409e-03 3 1  ON 61
ci_63                -9.518755e-04 3 1  ON 62
ci_64                -9.721822e-04 3 1  ON 63
ci_65                -9.733256e-04 3 1  ON 64
ci_66                -9.802274e-04 3 1  ON 65
ci_67                -9.671318e-04 3 1  ON 66
ci_68                 4.436166e-04 3 1  ON 67
ci_69                 5.184447e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7533
    reference variance = 0.221459
====================================================
  Execution time = 2.5317e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.1580e-01
  Total weights = 1.9628e+06
  Execution time = 3.5975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509439633310
                                         uncertainty =       0.012048516358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509439633310
                                         uncertainty =       0.012048516358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504672754
  error estimate for blocks of size 2^( 2) =       0.000525612709
  error estimate for blocks of size 2^( 3) =       0.000544807021
  error estimate for blocks of size 2^( 4) =       0.000558938068
  error estimate for blocks of size 2^( 5) =       0.000568198992
  error estimate for blocks of size 2^( 6) =       0.000572377048
  error estimate for blocks of size 2^( 7) =       0.000575881269

      target function =      -0.090412193131
              le_mean =     -22.813034360690
             les_mean =     524.842502971368
             stat err =       0.000568848844
             autocorr =       1.270498162815
   target nu stat err =       0.000568848844
   target dn stat err =       3.870844662982
      target stat err =       0.071036679544
              std dev =       0.713715053914
             le_variance =       0.509389178184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490838364835
                                         uncertainty =       0.003735079574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490838364835
                                         uncertainty =       0.003735079574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495367481
  error estimate for blocks of size 2^( 2) =       0.000516574533
  error estimate for blocks of size 2^( 3) =       0.000535838126
  error estimate for blocks of size 2^( 4) =       0.000550010648
  error estimate for blocks of size 2^( 5) =       0.000559318464
  error estimate for blocks of size 2^( 6) =       0.000563343395
  error estimate for blocks of size 2^( 7) =       0.000566783515

      target function =      -0.341616049031
              le_mean =     -22.813003423433
             les_mean =     521.703830627520
             stat err =       0.000559864006
             autocorr =       1.277350573534
   target nu stat err =       0.000559864006
   target dn stat err =       0.755727934231
      target stat err =       0.144275535077
              std dev =       0.700555410147
             le_variance =       0.490777882686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493218781325
                                         uncertainty =       0.003839932455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493218781325
                                         uncertainty =       0.003839932455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496567545
  error estimate for blocks of size 2^( 2) =       0.000517835630
  error estimate for blocks of size 2^( 3) =       0.000537205643
  error estimate for blocks of size 2^( 4) =       0.000551384099
  error estimate for blocks of size 2^( 5) =       0.000560748225
  error estimate for blocks of size 2^( 6) =       0.000564740584
  error estimate for blocks of size 2^( 7) =       0.000568118167

      target function =      -0.660642318331
              le_mean =     -22.812938229383
             les_mean =     521.000500933318
             stat err =       0.000561247769
             autocorr =       1.277475534770
   target nu stat err =       0.000561247769
   target dn stat err =       0.034945219863
      target stat err =       0.021202732977
              std dev =       0.702252557311
             le_variance =       0.493158654250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497047071170
                                         uncertainty =       0.003997019096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497047071170
                                         uncertainty =       0.003997019096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498490323
  error estimate for blocks of size 2^( 2) =       0.000519828040
  error estimate for blocks of size 2^( 3) =       0.000539268367
  error estimate for blocks of size 2^( 4) =       0.000553470652
  error estimate for blocks of size 2^( 5) =       0.000562902490
  error estimate for blocks of size 2^( 6) =       0.000566870331
  error estimate for blocks of size 2^( 7) =       0.000570353949

      target function =      -0.692527786287
              le_mean =     -22.812948340377
             les_mean =     520.951806062768
             stat err =       0.000563399356
             autocorr =       1.277377397535
   target nu stat err =       0.000563399356
   target dn stat err =       0.008977795515
      target stat err =       0.006002815580
              std dev =       0.704971775985
             le_variance =       0.496985204936


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.090412193131        initial
     2.5000e-01     2.5000e+00             5.0608e-03        -0.341616049031
     1.0000e+00     1.0000e+01             1.4389e-03        -0.660642318331
     4.0000e+00     4.0000e+01             3.7245e-04        -0.692527786287  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.3365e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.571064e-01 3 1  ON 0
ci_02                -5.217333e-02 3 1  ON 1
ci_03                -5.231644e-02 3 1  ON 2
ci_04                 5.062362e-02 3 1  ON 3
ci_05                -3.659448e-02 3 1  ON 4
ci_06                -3.663458e-02 3 1  ON 5
ci_07                 2.995603e-02 3 1  ON 6
ci_08                -1.597631e-02 3 1  ON 7
ci_09                -1.580340e-02 3 1  ON 8
ci_10                -1.568012e-02 3 1  ON 9
ci_11                 1.548671e-02 3 1  ON 10
ci_12                 1.216246e-02 3 1  ON 11
ci_13                 1.268660e-02 3 1  ON 12
ci_14                 1.279494e-02 3 1  ON 13
ci_15                 1.130512e-02 3 1  ON 14
ci_16                 1.124538e-02 3 1  ON 15
ci_17                -1.090692e-02 3 1  ON 16
ci_18                -1.104306e-02 3 1  ON 17
ci_19                 1.116134e-02 3 1  ON 18
ci_20                 9.818005e-03 3 1  ON 19
ci_21                 9.832720e-03 3 1  ON 20
ci_22                 9.708846e-03 3 1  ON 21
ci_23                 6.361687e-03 3 1  ON 22
ci_24                 5.097975e-03 3 1  ON 23
ci_25                 4.693702e-03 3 1  ON 24
ci_26                 4.452177e-03 3 1  ON 25
ci_27                 4.504243e-03 3 1  ON 26
ci_28                 3.771188e-03 3 1  ON 27
ci_29                 3.775607e-03 3 1  ON 28
ci_30                -3.401681e-03 3 1  ON 29
ci_31                -3.285741e-03 3 1  ON 30
ci_32                -2.871957e-03 3 1  ON 31
ci_33                -2.891459e-03 3 1  ON 32
ci_34                 2.328547e-03 3 1  ON 33
ci_35                 2.419022e-03 3 1  ON 34
ci_36                -2.318185e-03 3 1  ON 35
ci_37                -2.305006e-03 3 1  ON 36
ci_38                -1.837669e-03 3 1  ON 37
ci_39                -1.782698e-03 3 1  ON 38
ci_40                -1.971180e-03 3 1  ON 39
ci_41                -1.722377e-03 3 1  ON 40
ci_42                -1.784633e-03 3 1  ON 41
ci_43                -2.135258e-03 3 1  ON 42
ci_44                -1.901853e-03 3 1  ON 43
ci_45                -1.586888e-03 3 1  ON 44
ci_46                -1.618134e-03 3 1  ON 45
ci_47                -1.408244e-03 3 1  ON 46
ci_48                -1.412769e-03 3 1  ON 47
ci_49                -1.624819e-03 3 1  ON 48
ci_50                -1.534512e-03 3 1  ON 49
ci_51                 1.473939e-03 3 1  ON 50
ci_52                 1.392329e-03 3 1  ON 51
ci_53                -1.367038e-03 3 1  ON 52
ci_54                -1.352393e-03 3 1  ON 53
ci_55                -1.303676e-03 3 1  ON 54
ci_56                 1.521013e-03 3 1  ON 55
ci_57                 1.354271e-03 3 1  ON 56
ci_58                -1.226962e-03 3 1  ON 57
ci_59                -1.207588e-03 3 1  ON 58
ci_60                 1.088908e-03 3 1  ON 59
ci_61                 1.186020e-03 3 1  ON 60
ci_62                -9.879403e-04 3 1  ON 61
ci_63                -9.986207e-04 3 1  ON 62
ci_64                -1.004358e-03 3 1  ON 63
ci_65                -9.842641e-04 3 1  ON 64
ci_66                -1.006984e-03 3 1  ON 65
ci_67                -9.731178e-04 3 1  ON 66
ci_68                 5.165512e-04 3 1  ON 67
ci_69                 6.278354e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3660e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7606
    reference variance = 0.594588
====================================================
  Execution time = 2.5774e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 5.1449e-01
  Total weights = 1.962981904e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496339893089
                                         uncertainty =       0.005115275882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496339893089
                                         uncertainty =       0.005115275882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498180177
  error estimate for blocks of size 2^( 2) =       0.000519024786
  error estimate for blocks of size 2^( 3) =       0.000539032719
  error estimate for blocks of size 2^( 4) =       0.000554818263
  error estimate for blocks of size 2^( 5) =       0.000563834911
  error estimate for blocks of size 2^( 6) =       0.000569353305
  error estimate for blocks of size 2^( 7) =       0.000570590395

      target function =      -0.697052564228
              le_mean =     -22.813854722088
             les_mean =     520.986456286466
             stat err =       0.000564649218
             autocorr =       1.284649276537
   target nu stat err =       0.000564649218
   target dn stat err =       0.006043568174
      target stat err =       0.004118657120
              std dev =       0.704533163473
             le_variance =       0.496366978434


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281385472209e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.697075978659       residual = 7.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.697646691664       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.697736728609       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.697749520789       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.697752790378       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.697754558129       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.697755162046       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.697755257733       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.697755252078       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.697755249214       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.697755251050       residual = 1.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.340353e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.697075978659       residual = 7.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.697223402514       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.697246360593       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.697249581035       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.697250394059       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.697250823293       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.697250967687       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.697250990447       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.697250988976       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.697250988286       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.697250988728       residual = 1.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.468697e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.697075978659       residual = 7.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.697113143294       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.697118911232       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.697119717636       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.697119920562       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.697120027030       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.697120062707       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.697120068323       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.697120067953       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.697120067782       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.697120067891       residual = 1.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 8.748529e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.452689 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0378e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.568175e-01 3 1  ON 0
ci_02                -5.187210e-02 3 1  ON 1
ci_03                -5.197921e-02 3 1  ON 2
ci_04                 5.027675e-02 3 1  ON 3
ci_05                -3.640360e-02 3 1  ON 4
ci_06                -3.642106e-02 3 1  ON 5
ci_07                 2.990520e-02 3 1  ON 6
ci_08                -1.586028e-02 3 1  ON 7
ci_09                -1.572349e-02 3 1  ON 8
ci_10                -1.557921e-02 3 1  ON 9
ci_11                 1.545409e-02 3 1  ON 10
ci_12                 1.205664e-02 3 1  ON 11
ci_13                 1.266869e-02 3 1  ON 12
ci_14                 1.278588e-02 3 1  ON 13
ci_15                 1.126207e-02 3 1  ON 14
ci_16                 1.118951e-02 3 1  ON 15
ci_17                -1.085989e-02 3 1  ON 16
ci_18                -1.100725e-02 3 1  ON 17
ci_19                 1.112257e-02 3 1  ON 18
ci_20                 9.768415e-03 3 1  ON 19
ci_21                 9.832508e-03 3 1  ON 20
ci_22                 9.713606e-03 3 1  ON 21
ci_23                 6.337306e-03 3 1  ON 22
ci_24                 5.095280e-03 3 1  ON 23
ci_25                 4.698592e-03 3 1  ON 24
ci_26                 4.457988e-03 3 1  ON 25
ci_27                 4.497314e-03 3 1  ON 26
ci_28                 3.729070e-03 3 1  ON 27
ci_29                 3.747133e-03 3 1  ON 28
ci_30                -3.373886e-03 3 1  ON 29
ci_31                -3.276771e-03 3 1  ON 30
ci_32                -2.845593e-03 3 1  ON 31
ci_33                -2.864674e-03 3 1  ON 32
ci_34                 2.301153e-03 3 1  ON 33
ci_35                 2.414077e-03 3 1  ON 34
ci_36                -2.304598e-03 3 1  ON 35
ci_37                -2.287820e-03 3 1  ON 36
ci_38                -1.814303e-03 3 1  ON 37
ci_39                -1.769283e-03 3 1  ON 38
ci_40                -1.967806e-03 3 1  ON 39
ci_41                -1.708860e-03 3 1  ON 40
ci_42                -1.768100e-03 3 1  ON 41
ci_43                -2.134327e-03 3 1  ON 42
ci_44                -1.882943e-03 3 1  ON 43
ci_45                -1.549504e-03 3 1  ON 44
ci_46                -1.612900e-03 3 1  ON 45
ci_47                -1.366057e-03 3 1  ON 46
ci_48                -1.378474e-03 3 1  ON 47
ci_49                -1.620533e-03 3 1  ON 48
ci_50                -1.520061e-03 3 1  ON 49
ci_51                 1.454414e-03 3 1  ON 50
ci_52                 1.386491e-03 3 1  ON 51
ci_53                -1.354128e-03 3 1  ON 52
ci_54                -1.345008e-03 3 1  ON 53
ci_55                -1.295229e-03 3 1  ON 54
ci_56                 1.511670e-03 3 1  ON 55
ci_57                 1.349759e-03 3 1  ON 56
ci_58                -1.219709e-03 3 1  ON 57
ci_59                -1.216369e-03 3 1  ON 58
ci_60                 1.060379e-03 3 1  ON 59
ci_61                 1.181618e-03 3 1  ON 60
ci_62                -9.636807e-04 3 1  ON 61
ci_63                -9.889417e-04 3 1  ON 62
ci_64                -9.950487e-04 3 1  ON 63
ci_65                -9.728635e-04 3 1  ON 64
ci_66                -1.006584e-03 3 1  ON 65
ci_67                -9.692621e-04 3 1  ON 66
ci_68                 4.890223e-04 3 1  ON 67
ci_69                 6.082183e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8562
    reference variance = 0.304327
====================================================
  Execution time = 2.5826e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.0964e-01
  Total weights = 1.9633e+06
  Execution time = 4.0709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496306580337
                                         uncertainty =       0.004390803145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496306580337
                                         uncertainty =       0.004390803145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498116686
  error estimate for blocks of size 2^( 2) =       0.000519563858
  error estimate for blocks of size 2^( 3) =       0.000539042364
  error estimate for blocks of size 2^( 4) =       0.000553952074
  error estimate for blocks of size 2^( 5) =       0.000563494181
  error estimate for blocks of size 2^( 6) =       0.000569236924
  error estimate for blocks of size 2^( 7) =       0.000572850872

      target function =      -0.700424421950
              le_mean =     -22.812885798579
             les_mean =     520.937276886366
             stat err =       0.000564883513
             autocorr =       1.286043381220
   target nu stat err =       0.000564883513
   target dn stat err =       0.005203993398
      target stat err =       0.003586651341
              std dev =       0.704443372677
             le_variance =       0.496240465309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497525564926
                                         uncertainty =       0.007385689575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497525564926
                                         uncertainty =       0.007385689575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498730572
  error estimate for blocks of size 2^( 2) =       0.000520072659
  error estimate for blocks of size 2^( 3) =       0.000539472018
  error estimate for blocks of size 2^( 4) =       0.000554332107
  error estimate for blocks of size 2^( 5) =       0.000563859690
  error estimate for blocks of size 2^( 6) =       0.000569508756
  error estimate for blocks of size 2^( 7) =       0.000573131618

      target function =      -0.626753596613
              le_mean =     -22.812872162660
             les_mean =     521.047419312860
             stat err =       0.000565208043
             autocorr =       1.284353828417
   target nu stat err =       0.000565208043
   target dn stat err =       0.107568083723
      target stat err =       0.059183570173
              std dev =       0.705311538349
             le_variance =       0.497464366128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496496579840
                                         uncertainty =       0.005534148344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496496579840
                                         uncertainty =       0.005534148344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498213081
  error estimate for blocks of size 2^( 2) =       0.000519612396
  error estimate for blocks of size 2^( 3) =       0.000539058643
  error estimate for blocks of size 2^( 4) =       0.000553946359
  error estimate for blocks of size 2^( 5) =       0.000563487171
  error estimate for blocks of size 2^( 6) =       0.000569198851
  error estimate for blocks of size 2^( 7) =       0.000572818412

      target function =      -0.694189226336
              le_mean =     -22.812874894769
             les_mean =     520.945938453352
             stat err =       0.000564862698
             autocorr =       1.285451042963
   target nu stat err =       0.000564862698
   target dn stat err =       0.010423422149
      target stat err =       0.006994999342
              std dev =       0.704579695511
             le_variance =       0.496432547326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496296086441
                                         uncertainty =       0.004503857008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496296086441
                                         uncertainty =       0.004503857008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498111532
  error estimate for blocks of size 2^( 2) =       0.000519553249
  error estimate for blocks of size 2^( 3) =       0.000539027761
  error estimate for blocks of size 2^( 4) =       0.000553934948
  error estimate for blocks of size 2^( 5) =       0.000563477158
  error estimate for blocks of size 2^( 6) =       0.000569216187
  error estimate for blocks of size 2^( 7) =       0.000572831244

      target function =      -0.700436246656
              le_mean =     -22.812883983217
             les_mean =     520.937175349959
             stat err =       0.000564864884
             autocorr =       1.285985171355
   target nu stat err =       0.000564864884
   target dn stat err =       0.005334539536
      target stat err =       0.003674655657
              std dev =       0.704436084103
             le_variance =       0.496230196586


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.700424421950        initial
     1.0000e+00     1.0000e+01             1.3404e-03        -0.626753596613
     4.0000e+00     4.0000e+01             3.4687e-04        -0.694189226336
     1.6000e+01     1.6000e+02             8.7485e-05        -0.700436246656  <--

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.4320e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.570338e-01 3 1  ON 0
ci_02                -5.209744e-02 3 1  ON 1
ci_03                -5.223148e-02 3 1  ON 2
ci_04                 5.053613e-02 3 1  ON 3
ci_05                -3.654637e-02 3 1  ON 4
ci_06                -3.658077e-02 3 1  ON 5
ci_07                 2.994324e-02 3 1  ON 6
ci_08                -1.594706e-02 3 1  ON 7
ci_09                -1.578329e-02 3 1  ON 8
ci_10                -1.565472e-02 3 1  ON 9
ci_11                 1.547849e-02 3 1  ON 10
ci_12                 1.213579e-02 3 1  ON 11
ci_13                 1.268209e-02 3 1  ON 12
ci_14                 1.279267e-02 3 1  ON 13
ci_15                 1.129428e-02 3 1  ON 14
ci_16                 1.123130e-02 3 1  ON 15
ci_17                -1.089509e-02 3 1  ON 16
ci_18                -1.103405e-02 3 1  ON 17
ci_19                 1.115155e-02 3 1  ON 18
ci_20                 9.805501e-03 3 1  ON 19
ci_21                 9.832672e-03 3 1  ON 20
ci_22                 9.710047e-03 3 1  ON 21
ci_23                 6.355533e-03 3 1  ON 22
ci_24                 5.097291e-03 3 1  ON 23
ci_25                 4.694935e-03 3 1  ON 24
ci_26                 4.453632e-03 3 1  ON 25
ci_27                 4.502493e-03 3 1  ON 26
ci_28                 3.760591e-03 3 1  ON 27
ci_29                 3.768442e-03 3 1  ON 28
ci_30                -3.394701e-03 3 1  ON 29
ci_31                -3.283493e-03 3 1  ON 30
ci_32                -2.865296e-03 3 1  ON 31
ci_33                -2.884692e-03 3 1  ON 32
ci_34                 2.321619e-03 3 1  ON 33
ci_35                 2.417758e-03 3 1  ON 34
ci_36                -2.314761e-03 3 1  ON 35
ci_37                -2.300674e-03 3 1  ON 36
ci_38                -1.831779e-03 3 1  ON 37
ci_39                -1.779318e-03 3 1  ON 38
ci_40                -1.970331e-03 3 1  ON 39
ci_41                -1.718955e-03 3 1  ON 40
ci_42                -1.780450e-03 3 1  ON 41
ci_43                -2.135040e-03 3 1  ON 42
ci_44                -1.897106e-03 3 1  ON 43
ci_45                -1.577463e-03 3 1  ON 44
ci_46                -1.616815e-03 3 1  ON 45
ci_47                -1.397640e-03 3 1  ON 46
ci_48                -1.404152e-03 3 1  ON 47
ci_49                -1.623740e-03 3 1  ON 48
ci_50                -1.530863e-03 3 1  ON 49
ci_51                 1.469020e-03 3 1  ON 50
ci_52                 1.390863e-03 3 1  ON 51
ci_53                -1.363784e-03 3 1  ON 52
ci_54                -1.350533e-03 3 1  ON 53
ci_55                -1.301550e-03 3 1  ON 54
ci_56                 1.518652e-03 3 1  ON 55
ci_57                 1.353128e-03 3 1  ON 56
ci_58                -1.225134e-03 3 1  ON 57
ci_59                -1.209797e-03 3 1  ON 58
ci_60                 1.081752e-03 3 1  ON 59
ci_61                 1.184910e-03 3 1  ON 60
ci_62                -9.818240e-04 3 1  ON 61
ci_63                -9.961823e-04 3 1  ON 62
ci_64                -1.002010e-03 3 1  ON 63
ci_65                -9.813890e-04 3 1  ON 64
ci_66                -1.006884e-03 3 1  ON 65
ci_67                -9.721475e-04 3 1  ON 66
ci_68                 5.096149e-04 3 1  ON 67
ci_69                 6.228933e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4714e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8629
    reference variance = 0.392239
====================================================
  Execution time = 2.5717e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.1308e-01
  Total weights = 1.963130870e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6088e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497277434057
                                         uncertainty =       0.002330417943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497277434057
                                         uncertainty =       0.002330417943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498621155
  error estimate for blocks of size 2^( 2) =       0.000519299628
  error estimate for blocks of size 2^( 3) =       0.000539542889
  error estimate for blocks of size 2^( 4) =       0.000553429782
  error estimate for blocks of size 2^( 5) =       0.000562786949
  error estimate for blocks of size 2^( 6) =       0.000567889526
  error estimate for blocks of size 2^( 7) =       0.000570247675

      target function =      -0.698020574348
              le_mean =     -22.813375871226
             les_mean =     520.963198427025
             stat err =       0.000563588483
             autocorr =       1.277564453070
   target nu stat err =       0.000563588483
   target dn stat err =       0.003229222672
      target stat err =       0.002253031573
              std dev =       0.705156799387
             le_variance =       0.497246111721


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281337587123e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.698027036255       residual = 7.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.698178162917       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.698202375550       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.698206015695       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.698207107974       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.698207365918       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.698207467970       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.698207452974       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.698207450799       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.698207448533       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.698207448234       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.535106e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.698027036255       residual = 7.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.698065135245       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.698071220083       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.698072131466       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.698072403652       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.698072467346       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.698072492416       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.698072488678       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.698072488135       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.698072487574       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.698072487501       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 8.916020e-05

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.698027036255       residual = 7.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.698036581038       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.698038104235       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.698038332163       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.698038400152       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.698038416026       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.698038422266       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.698038421332       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.698038421196       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.698038421056       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.698038421038       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+01 is 2.233948e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.461758 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0344e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.569518e-01 3 1  ON 0
ci_02                -5.201951e-02 3 1  ON 1
ci_03                -5.216007e-02 3 1  ON 2
ci_04                 5.044697e-02 3 1  ON 3
ci_05                -3.649228e-02 3 1  ON 4
ci_06                -3.652413e-02 3 1  ON 5
ci_07                 2.993861e-02 3 1  ON 6
ci_08                -1.590838e-02 3 1  ON 7
ci_09                -1.576063e-02 3 1  ON 8
ci_10                -1.563619e-02 3 1  ON 9
ci_11                 1.546642e-02 3 1  ON 10
ci_12                 1.212255e-02 3 1  ON 11
ci_13                 1.268327e-02 3 1  ON 12
ci_14                 1.279598e-02 3 1  ON 13
ci_15                 1.127737e-02 3 1  ON 14
ci_16                 1.121768e-02 3 1  ON 15
ci_17                -1.088644e-02 3 1  ON 16
ci_18                -1.101856e-02 3 1  ON 17
ci_19                 1.114337e-02 3 1  ON 18
ci_20                 9.794701e-03 3 1  ON 19
ci_21                 9.831126e-03 3 1  ON 20
ci_22                 9.711564e-03 3 1  ON 21
ci_23                 6.348588e-03 3 1  ON 22
ci_24                 5.091794e-03 3 1  ON 23
ci_25                 4.691224e-03 3 1  ON 24
ci_26                 4.446449e-03 3 1  ON 25
ci_27                 4.495786e-03 3 1  ON 26
ci_28                 3.756489e-03 3 1  ON 27
ci_29                 3.760083e-03 3 1  ON 28
ci_30                -3.386947e-03 3 1  ON 29
ci_31                -3.283722e-03 3 1  ON 30
ci_32                -2.857096e-03 3 1  ON 31
ci_33                -2.879247e-03 3 1  ON 32
ci_34                 2.317005e-03 3 1  ON 33
ci_35                 2.414357e-03 3 1  ON 34
ci_36                -2.313291e-03 3 1  ON 35
ci_37                -2.294842e-03 3 1  ON 36
ci_38                -1.828729e-03 3 1  ON 37
ci_39                -1.775013e-03 3 1  ON 38
ci_40                -1.969787e-03 3 1  ON 39
ci_41                -1.716845e-03 3 1  ON 40
ci_42                -1.777371e-03 3 1  ON 41
ci_43                -2.135175e-03 3 1  ON 42
ci_44                -1.896516e-03 3 1  ON 43
ci_45                -1.576084e-03 3 1  ON 44
ci_46                -1.612114e-03 3 1  ON 45
ci_47                -1.395969e-03 3 1  ON 46
ci_48                -1.399540e-03 3 1  ON 47
ci_49                -1.623535e-03 3 1  ON 48
ci_50                -1.528129e-03 3 1  ON 49
ci_51                 1.464445e-03 3 1  ON 50
ci_52                 1.387006e-03 3 1  ON 51
ci_53                -1.359134e-03 3 1  ON 52
ci_54                -1.348184e-03 3 1  ON 53
ci_55                -1.298332e-03 3 1  ON 54
ci_56                 1.522956e-03 3 1  ON 55
ci_57                 1.354169e-03 3 1  ON 56
ci_58                -1.225162e-03 3 1  ON 57
ci_59                -1.208334e-03 3 1  ON 58
ci_60                 1.083744e-03 3 1  ON 59
ci_61                 1.182623e-03 3 1  ON 60
ci_62                -9.801586e-04 3 1  ON 61
ci_63                -9.897782e-04 3 1  ON 62
ci_64                -9.987989e-04 3 1  ON 63
ci_65                -9.838419e-04 3 1  ON 64
ci_66                -1.003317e-03 3 1  ON 65
ci_67                -9.711327e-04 3 1  ON 66
ci_68                 5.053326e-04 3 1  ON 67
ci_69                 6.184400e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7763
    reference variance = 0.412005
====================================================
  Execution time = 2.5208e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.1083e-01
  Total weights = 1.9631e+06
  Execution time = 3.5998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495962721579
                                         uncertainty =       0.003789622481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495962721579
                                         uncertainty =       0.003789622481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497948072
  error estimate for blocks of size 2^( 2) =       0.000519164115
  error estimate for blocks of size 2^( 3) =       0.000539582740
  error estimate for blocks of size 2^( 4) =       0.000554679107
  error estimate for blocks of size 2^( 5) =       0.000563563639
  error estimate for blocks of size 2^( 6) =       0.000566310272
  error estimate for blocks of size 2^( 7) =       0.000565711881

      target function =      -0.699454365586
              le_mean =     -22.812336493089
             les_mean =     520.913643644279
             stat err =       0.000562566225
             autocorr =       1.276377673320
   target nu stat err =       0.000562566225
   target dn stat err =       0.004220103671
      target stat err =       0.002915619604
              std dev =       0.704204916868
             le_variance =       0.495904564942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495412992651
                                         uncertainty =       0.003778909928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495412992651
                                         uncertainty =       0.003778909928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497672106
  error estimate for blocks of size 2^( 2) =       0.000518875544
  error estimate for blocks of size 2^( 3) =       0.000539286256
  error estimate for blocks of size 2^( 4) =       0.000554382150
  error estimate for blocks of size 2^( 5) =       0.000563270864
  error estimate for blocks of size 2^( 6) =       0.000566024398
  error estimate for blocks of size 2^( 7) =       0.000565434190

      target function =      -0.699377568143
              le_mean =     -22.812339722857
             les_mean =     520.913903968401
             stat err =       0.000562277901
             autocorr =       1.276484157891
   target nu stat err =       0.000562277901
   target dn stat err =       0.004250378114
      target stat err =       0.002935133600
              std dev =       0.703814642324
             le_variance =       0.495355050749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495683621703
                                         uncertainty =       0.003784205921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495683621703
                                         uncertainty =       0.003784205921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497807982
  error estimate for blocks of size 2^( 2) =       0.000519017626
  error estimate for blocks of size 2^( 3) =       0.000539432211
  error estimate for blocks of size 2^( 4) =       0.000554528157
  error estimate for blocks of size 2^( 5) =       0.000563414883
  error estimate for blocks of size 2^( 6) =       0.000566164989
  error estimate for blocks of size 2^( 7) =       0.000565570758

      target function =      -0.699497082723
              le_mean =     -22.812337906525
             les_mean =     520.913645197065
             stat err =       0.000562419697
             autocorr =       1.276430967537
   target nu stat err =       0.000562419697
   target dn stat err =       0.004221791892
      target stat err =       0.002917074294
              std dev =       0.704006799290
             le_variance =       0.495625573447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495927563080
                                         uncertainty =       0.003788941142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495927563080
                                         uncertainty =       0.003788941142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497930427
  error estimate for blocks of size 2^( 2) =       0.000519145675
  error estimate for blocks of size 2^( 3) =       0.000539563773
  error estimate for blocks of size 2^( 4) =       0.000554660320
  error estimate for blocks of size 2^( 5) =       0.000563545064
  error estimate for blocks of size 2^( 6) =       0.000566292073
  error estimate for blocks of size 2^( 7) =       0.000565694145

      target function =      -0.698406171499
              le_mean =     -22.812336583708
             les_mean =     520.915192150468
             stat err =       0.000562547900
             autocorr =       1.276384981650
   target nu stat err =       0.000562547900
   target dn stat err =       0.004513732015
      target stat err =       0.003102426144
              std dev =       0.704179962842
             le_variance =       0.495869420069


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.699454365586        initial
     4.0000e+00     4.0000e+01             3.5351e-04        -0.699377568143
     1.6000e+01     1.6000e+02             8.9160e-05        -0.699497082723  <--
     6.4000e+01     6.4000e+02             2.2339e-05        -0.698406171499

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.3269e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.569518e-01 3 1  ON 0
ci_02                -5.201951e-02 3 1  ON 1
ci_03                -5.216007e-02 3 1  ON 2
ci_04                 5.044697e-02 3 1  ON 3
ci_05                -3.649228e-02 3 1  ON 4
ci_06                -3.652413e-02 3 1  ON 5
ci_07                 2.993861e-02 3 1  ON 6
ci_08                -1.590838e-02 3 1  ON 7
ci_09                -1.576063e-02 3 1  ON 8
ci_10                -1.563619e-02 3 1  ON 9
ci_11                 1.546642e-02 3 1  ON 10
ci_12                 1.212255e-02 3 1  ON 11
ci_13                 1.268327e-02 3 1  ON 12
ci_14                 1.279598e-02 3 1  ON 13
ci_15                 1.127737e-02 3 1  ON 14
ci_16                 1.121768e-02 3 1  ON 15
ci_17                -1.088644e-02 3 1  ON 16
ci_18                -1.101856e-02 3 1  ON 17
ci_19                 1.114337e-02 3 1  ON 18
ci_20                 9.794701e-03 3 1  ON 19
ci_21                 9.831126e-03 3 1  ON 20
ci_22                 9.711564e-03 3 1  ON 21
ci_23                 6.348588e-03 3 1  ON 22
ci_24                 5.091794e-03 3 1  ON 23
ci_25                 4.691224e-03 3 1  ON 24
ci_26                 4.446449e-03 3 1  ON 25
ci_27                 4.495786e-03 3 1  ON 26
ci_28                 3.756489e-03 3 1  ON 27
ci_29                 3.760083e-03 3 1  ON 28
ci_30                -3.386947e-03 3 1  ON 29
ci_31                -3.283722e-03 3 1  ON 30
ci_32                -2.857096e-03 3 1  ON 31
ci_33                -2.879247e-03 3 1  ON 32
ci_34                 2.317005e-03 3 1  ON 33
ci_35                 2.414357e-03 3 1  ON 34
ci_36                -2.313291e-03 3 1  ON 35
ci_37                -2.294842e-03 3 1  ON 36
ci_38                -1.828729e-03 3 1  ON 37
ci_39                -1.775013e-03 3 1  ON 38
ci_40                -1.969787e-03 3 1  ON 39
ci_41                -1.716845e-03 3 1  ON 40
ci_42                -1.777371e-03 3 1  ON 41
ci_43                -2.135175e-03 3 1  ON 42
ci_44                -1.896516e-03 3 1  ON 43
ci_45                -1.576084e-03 3 1  ON 44
ci_46                -1.612114e-03 3 1  ON 45
ci_47                -1.395969e-03 3 1  ON 46
ci_48                -1.399540e-03 3 1  ON 47
ci_49                -1.623535e-03 3 1  ON 48
ci_50                -1.528129e-03 3 1  ON 49
ci_51                 1.464445e-03 3 1  ON 50
ci_52                 1.387006e-03 3 1  ON 51
ci_53                -1.359134e-03 3 1  ON 52
ci_54                -1.348184e-03 3 1  ON 53
ci_55                -1.298332e-03 3 1  ON 54
ci_56                 1.522956e-03 3 1  ON 55
ci_57                 1.354169e-03 3 1  ON 56
ci_58                -1.225162e-03 3 1  ON 57
ci_59                -1.208334e-03 3 1  ON 58
ci_60                 1.083744e-03 3 1  ON 59
ci_61                 1.182623e-03 3 1  ON 60
ci_62                -9.801586e-04 3 1  ON 61
ci_63                -9.897782e-04 3 1  ON 62
ci_64                -9.987989e-04 3 1  ON 63
ci_65                -9.838419e-04 3 1  ON 64
ci_66                -1.003317e-03 3 1  ON 65
ci_67                -9.711327e-04 3 1  ON 66
ci_68                 5.053326e-04 3 1  ON 67
ci_69                 6.184400e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3629e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7282
    reference variance = 0.397556
====================================================
  Execution time = 2.5513e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5367e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.0636e-01
  Total weights = 1.963312914e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491149797742
                                         uncertainty =       0.002450242086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491149797742
                                         uncertainty =       0.002450242086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495498361
  error estimate for blocks of size 2^( 2) =       0.000516403300
  error estimate for blocks of size 2^( 3) =       0.000536464223
  error estimate for blocks of size 2^( 4) =       0.000551119620
  error estimate for blocks of size 2^( 5) =       0.000559936915
  error estimate for blocks of size 2^( 6) =       0.000563696686
  error estimate for blocks of size 2^( 7) =       0.000566741893

      target function =      -0.702588262738
              le_mean =     -22.812695318626
             les_mean =     520.925431848376
             stat err =       0.000560373778
             autocorr =       1.279001831488
   target nu stat err =       0.000560373778
   target dn stat err =       0.003155250308
      target stat err =       0.002229667366
              std dev =       0.700740501587
             le_variance =       0.491037250564


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281269531863e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702594482620       residual = 7.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702746542404       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.702770001928       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.702773289800       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.702774205755       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.702774463979       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.702774565391       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.702774566077       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.702774568363       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.702774567120       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.702774567387       residual = 1.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.634042e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702594482620       residual = 7.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702632821236       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.702638717244       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.702639540612       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.702639769074       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.702639833028       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.702639857981       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.702639858123       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.702639858692       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.702639858382       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.702639858449       residual = 1.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 9.166204e-05

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702594482620       residual = 7.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702604087712       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.702605563668       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.702605769595       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.702605826677       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.702605842627       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.702605848840       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.702605848874       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.702605849016       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.702605848939       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.702605848956       residual = 1.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+01 is 2.296674e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.470816 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0096e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.568775e-01 3 1  ON 0
ci_02                -5.194476e-02 3 1  ON 1
ci_03                -5.208543e-02 3 1  ON 2
ci_04                 5.035531e-02 3 1  ON 3
ci_05                -3.644089e-02 3 1  ON 4
ci_06                -3.647275e-02 3 1  ON 5
ci_07                 2.992824e-02 3 1  ON 6
ci_08                -1.586912e-02 3 1  ON 7
ci_09                -1.574014e-02 3 1  ON 8
ci_10                -1.561364e-02 3 1  ON 9
ci_11                 1.545721e-02 3 1  ON 10
ci_12                 1.210541e-02 3 1  ON 11
ci_13                 1.268606e-02 3 1  ON 12
ci_14                 1.279616e-02 3 1  ON 13
ci_15                 1.126383e-02 3 1  ON 14
ci_16                 1.120839e-02 3 1  ON 15
ci_17                -1.087747e-02 3 1  ON 16
ci_18                -1.100662e-02 3 1  ON 17
ci_19                 1.113997e-02 3 1  ON 18
ci_20                 9.785062e-03 3 1  ON 19
ci_21                 9.832000e-03 3 1  ON 20
ci_22                 9.705374e-03 3 1  ON 21
ci_23                 6.344265e-03 3 1  ON 22
ci_24                 5.090340e-03 3 1  ON 23
ci_25                 4.688535e-03 3 1  ON 24
ci_26                 4.441386e-03 3 1  ON 25
ci_27                 4.492574e-03 3 1  ON 26
ci_28                 3.751120e-03 3 1  ON 27
ci_29                 3.754116e-03 3 1  ON 28
ci_30                -3.381679e-03 3 1  ON 29
ci_31                -3.278146e-03 3 1  ON 30
ci_32                -2.851143e-03 3 1  ON 31
ci_33                -2.868937e-03 3 1  ON 32
ci_34                 2.304782e-03 3 1  ON 33
ci_35                 2.407824e-03 3 1  ON 34
ci_36                -2.306547e-03 3 1  ON 35
ci_37                -2.293575e-03 3 1  ON 36
ci_38                -1.823881e-03 3 1  ON 37
ci_39                -1.772110e-03 3 1  ON 38
ci_40                -1.966585e-03 3 1  ON 39
ci_41                -1.710834e-03 3 1  ON 40
ci_42                -1.771187e-03 3 1  ON 41
ci_43                -2.139688e-03 3 1  ON 42
ci_44                -1.895611e-03 3 1  ON 43
ci_45                -1.572544e-03 3 1  ON 44
ci_46                -1.607832e-03 3 1  ON 45
ci_47                -1.388255e-03 3 1  ON 46
ci_48                -1.394707e-03 3 1  ON 47
ci_49                -1.622129e-03 3 1  ON 48
ci_50                -1.525732e-03 3 1  ON 49
ci_51                 1.460375e-03 3 1  ON 50
ci_52                 1.381614e-03 3 1  ON 51
ci_53                -1.357670e-03 3 1  ON 52
ci_54                -1.347359e-03 3 1  ON 53
ci_55                -1.297246e-03 3 1  ON 54
ci_56                 1.524359e-03 3 1  ON 55
ci_57                 1.352078e-03 3 1  ON 56
ci_58                -1.220088e-03 3 1  ON 57
ci_59                -1.205371e-03 3 1  ON 58
ci_60                 1.084275e-03 3 1  ON 59
ci_61                 1.179632e-03 3 1  ON 60
ci_62                -9.801901e-04 3 1  ON 61
ci_63                -9.864987e-04 3 1  ON 62
ci_64                -9.981961e-04 3 1  ON 63
ci_65                -9.830081e-04 3 1  ON 64
ci_66                -1.005392e-03 3 1  ON 65
ci_67                -9.711676e-04 3 1  ON 66
ci_68                 4.990043e-04 3 1  ON 67
ci_69                 6.193467e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.804
    reference variance = 0.532096
====================================================
  Execution time = 2.4945e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.0740e-01
  Total weights = 1.9633e+06
  Execution time = 3.5819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491104656269
                                         uncertainty =       0.002503889957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491104656269
                                         uncertainty =       0.002503889957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495504697
  error estimate for blocks of size 2^( 2) =       0.000516555371
  error estimate for blocks of size 2^( 3) =       0.000536542514
  error estimate for blocks of size 2^( 4) =       0.000551522204
  error estimate for blocks of size 2^( 5) =       0.000559774491
  error estimate for blocks of size 2^( 6) =       0.000565354462
  error estimate for blocks of size 2^( 7) =       0.000565656510

      target function =      -0.701730598491
              le_mean =     -22.812742511698
             les_mean =     520.928831758312
             stat err =       0.000560576917
             autocorr =       1.279896556006
   target nu stat err =       0.000560576917
   target dn stat err =       0.004189409215
      target stat err =       0.002914976346
              std dev =       0.700749462522
             le_variance =       0.491049809225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490518628688
                                         uncertainty =       0.002493373909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490518628688
                                         uncertainty =       0.002493373909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495208865
  error estimate for blocks of size 2^( 2) =       0.000516248150
  error estimate for blocks of size 2^( 3) =       0.000536227752
  error estimate for blocks of size 2^( 4) =       0.000551207745
  error estimate for blocks of size 2^( 5) =       0.000559462839
  error estimate for blocks of size 2^( 6) =       0.000565037152
  error estimate for blocks of size 2^( 7) =       0.000565340966

      target function =      -0.697566122380
              le_mean =     -22.812743773768
             les_mean =     520.934977627889
             stat err =       0.000560262176
             autocorr =       1.279987670852
   target nu stat err =       0.000560262176
   target dn stat err =       0.007759919731
      target stat err =       0.005269215800
              std dev =       0.700331092469
             le_variance =       0.490463639078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490807036852
                                         uncertainty =       0.002498357677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490807036852
                                         uncertainty =       0.002498357677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495354478
  error estimate for blocks of size 2^( 2) =       0.000516399481
  error estimate for blocks of size 2^( 3) =       0.000536382841
  error estimate for blocks of size 2^( 4) =       0.000551362626
  error estimate for blocks of size 2^( 5) =       0.000559616581
  error estimate for blocks of size 2^( 6) =       0.000565193634
  error estimate for blocks of size 2^( 7) =       0.000565496367

      target function =      -0.698339163961
              le_mean =     -22.812742881708
             les_mean =     520.933808141044
             stat err =       0.000560417302
             autocorr =       1.279943750588
   target nu stat err =       0.000560417302
   target dn stat err =       0.006720307180
      target stat err =       0.004581355847
              std dev =       0.700537020285
             le_variance =       0.490752116789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491067159900
                                         uncertainty =       0.002503169943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491067159900
                                         uncertainty =       0.002503169943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495485773
  error estimate for blocks of size 2^( 2) =       0.000516535678
  error estimate for blocks of size 2^( 3) =       0.000536522359
  error estimate for blocks of size 2^( 4) =       0.000551502161
  error estimate for blocks of size 2^( 5) =       0.000559754819
  error estimate for blocks of size 2^( 6) =       0.000565334699
  error estimate for blocks of size 2^( 7) =       0.000565637210

      target function =      -0.698424761160
              le_mean =     -22.812742425848
             les_mean =     520.933664251621
             stat err =       0.000560557222
             autocorr =       1.279904382156
   target nu stat err =       0.000560557222
   target dn stat err =       0.006458091490
      target stat err =       0.004406233493
              std dev =       0.700722700840
             le_variance =       0.491012303472


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.701730598491        initial  <--
     4.0000e+00     4.0000e+01             3.6340e-04        -0.697566122380
     1.6000e+01     1.6000e+02             9.1662e-05        -0.698339163961
     6.4000e+01     6.4000e+02             2.2967e-05        -0.698424761160

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9164
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.569518e-01 3 1  ON 0
ci_02                -5.201951e-02 3 1  ON 1
ci_03                -5.216007e-02 3 1  ON 2
ci_04                 5.044697e-02 3 1  ON 3
ci_05                -3.649228e-02 3 1  ON 4
ci_06                -3.652413e-02 3 1  ON 5
ci_07                 2.993861e-02 3 1  ON 6
ci_08                -1.590838e-02 3 1  ON 7
ci_09                -1.576063e-02 3 1  ON 8
ci_10                -1.563619e-02 3 1  ON 9
ci_11                 1.546642e-02 3 1  ON 10
ci_12                 1.212255e-02 3 1  ON 11
ci_13                 1.268327e-02 3 1  ON 12
ci_14                 1.279598e-02 3 1  ON 13
ci_15                 1.127737e-02 3 1  ON 14
ci_16                 1.121768e-02 3 1  ON 15
ci_17                -1.088644e-02 3 1  ON 16
ci_18                -1.101856e-02 3 1  ON 17
ci_19                 1.114337e-02 3 1  ON 18
ci_20                 9.794701e-03 3 1  ON 19
ci_21                 9.831126e-03 3 1  ON 20
ci_22                 9.711564e-03 3 1  ON 21
ci_23                 6.348588e-03 3 1  ON 22
ci_24                 5.091794e-03 3 1  ON 23
ci_25                 4.691224e-03 3 1  ON 24
ci_26                 4.446449e-03 3 1  ON 25
ci_27                 4.495786e-03 3 1  ON 26
ci_28                 3.756489e-03 3 1  ON 27
ci_29                 3.760083e-03 3 1  ON 28
ci_30                -3.386947e-03 3 1  ON 29
ci_31                -3.283722e-03 3 1  ON 30
ci_32                -2.857096e-03 3 1  ON 31
ci_33                -2.879247e-03 3 1  ON 32
ci_34                 2.317005e-03 3 1  ON 33
ci_35                 2.414357e-03 3 1  ON 34
ci_36                -2.313291e-03 3 1  ON 35
ci_37                -2.294842e-03 3 1  ON 36
ci_38                -1.828729e-03 3 1  ON 37
ci_39                -1.775013e-03 3 1  ON 38
ci_40                -1.969787e-03 3 1  ON 39
ci_41                -1.716845e-03 3 1  ON 40
ci_42                -1.777371e-03 3 1  ON 41
ci_43                -2.135175e-03 3 1  ON 42
ci_44                -1.896516e-03 3 1  ON 43
ci_45                -1.576084e-03 3 1  ON 44
ci_46                -1.612114e-03 3 1  ON 45
ci_47                -1.395969e-03 3 1  ON 46
ci_48                -1.399540e-03 3 1  ON 47
ci_49                -1.623535e-03 3 1  ON 48
ci_50                -1.528129e-03 3 1  ON 49
ci_51                 1.464445e-03 3 1  ON 50
ci_52                 1.387006e-03 3 1  ON 51
ci_53                -1.359134e-03 3 1  ON 52
ci_54                -1.348184e-03 3 1  ON 53
ci_55                -1.298332e-03 3 1  ON 54
ci_56                 1.522956e-03 3 1  ON 55
ci_57                 1.354169e-03 3 1  ON 56
ci_58                -1.225162e-03 3 1  ON 57
ci_59                -1.208334e-03 3 1  ON 58
ci_60                 1.083744e-03 3 1  ON 59
ci_61                 1.182623e-03 3 1  ON 60
ci_62                -9.801586e-04 3 1  ON 61
ci_63                -9.897782e-04 3 1  ON 62
ci_64                -9.987989e-04 3 1  ON 63
ci_65                -9.838419e-04 3 1  ON 64
ci_66                -1.003317e-03 3 1  ON 65
ci_67                -9.711327e-04 3 1  ON 66
ci_68                 5.053326e-04 3 1  ON 67
ci_69                 6.184400e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3028e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.796
    reference variance = 0.399028
====================================================
  Execution time = 2.5651e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.0684e-01
  Total weights = 1.962722821e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492091804461
                                         uncertainty =       0.002405572383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492091804461
                                         uncertainty =       0.002405572383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496011347
  error estimate for blocks of size 2^( 2) =       0.000517073561
  error estimate for blocks of size 2^( 3) =       0.000536755503
  error estimate for blocks of size 2^( 4) =       0.000550498219
  error estimate for blocks of size 2^( 5) =       0.000559995269
  error estimate for blocks of size 2^( 6) =       0.000565828855
  error estimate for blocks of size 2^( 7) =       0.000567601616

      target function =      -0.702267031857
              le_mean =     -22.812930659456
             les_mean =     520.936642789363
             stat err =       0.000560980990
             autocorr =       1.279125226630
   target nu stat err =       0.000560980990
   target dn stat err =       0.003102872239
      target stat err =       0.002193813831
              std dev =       0.701465974710
             le_variance =       0.492054513676


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281293065946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702273040034       residual = 7.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702287872532       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.702290335876       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.702290673133       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.702290770350       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.702290825179       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.702290836618       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.702290838083       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.702290837598       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.702290837476       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.702290837509       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 3.613530e-05

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702273040034       residual = 7.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702276751322       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.702277367480       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.702277451808       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.702277476106       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.702277489802       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.702277492657       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.702277493022       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.702277492901       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.702277492871       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.702277492879       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+02 is 9.041906e-06

solving harmonic davidson linear method for identity shift 6.4000e+02, overlap shift 6.4000e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.702273040034       residual = 7.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.702273968054       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.702274122114       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.702274143196       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.702274149270       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.702274152694       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.702274153407       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.702274153498       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.702274153468       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.702274153461       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.702274153463       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+02 is 2.260982e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.479862 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0239e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.569436e-01 3 1  ON 0
ci_02                -5.201208e-02 3 1  ON 1
ci_03                -5.215207e-02 3 1  ON 2
ci_04                 5.043793e-02 3 1  ON 3
ci_05                -3.648732e-02 3 1  ON 4
ci_06                -3.651957e-02 3 1  ON 5
ci_07                 2.993725e-02 3 1  ON 6
ci_08                -1.590477e-02 3 1  ON 7
ci_09                -1.575873e-02 3 1  ON 8
ci_10                -1.563411e-02 3 1  ON 9
ci_11                 1.546512e-02 3 1  ON 10
ci_12                 1.212071e-02 3 1  ON 11
ci_13                 1.268304e-02 3 1  ON 12
ci_14                 1.279575e-02 3 1  ON 13
ci_15                 1.127603e-02 3 1  ON 14
ci_16                 1.121640e-02 3 1  ON 15
ci_17                -1.088553e-02 3 1  ON 16
ci_18                -1.101757e-02 3 1  ON 17
ci_19                 1.114270e-02 3 1  ON 18
ci_20                 9.793471e-03 3 1  ON 19
ci_21                 9.830499e-03 3 1  ON 20
ci_22                 9.711192e-03 3 1  ON 21
ci_23                 6.347519e-03 3 1  ON 22
ci_24                 5.091404e-03 3 1  ON 23
ci_25                 4.690688e-03 3 1  ON 24
ci_26                 4.446070e-03 3 1  ON 25
ci_27                 4.495251e-03 3 1  ON 26
ci_28                 3.755552e-03 3 1  ON 27
ci_29                 3.759702e-03 3 1  ON 28
ci_30                -3.386635e-03 3 1  ON 29
ci_31                -3.283069e-03 3 1  ON 30
ci_32                -2.856397e-03 3 1  ON 31
ci_33                -2.878265e-03 3 1  ON 32
ci_34                 2.316932e-03 3 1  ON 33
ci_35                 2.413442e-03 3 1  ON 34
ci_36                -2.312697e-03 3 1  ON 35
ci_37                -2.294574e-03 3 1  ON 36
ci_38                -1.828417e-03 3 1  ON 37
ci_39                -1.774446e-03 3 1  ON 38
ci_40                -1.969394e-03 3 1  ON 39
ci_41                -1.716555e-03 3 1  ON 40
ci_42                -1.777251e-03 3 1  ON 41
ci_43                -2.135010e-03 3 1  ON 42
ci_44                -1.896719e-03 3 1  ON 43
ci_45                -1.575821e-03 3 1  ON 44
ci_46                -1.611882e-03 3 1  ON 45
ci_47                -1.395305e-03 3 1  ON 46
ci_48                -1.399185e-03 3 1  ON 47
ci_49                -1.623069e-03 3 1  ON 48
ci_50                -1.527675e-03 3 1  ON 49
ci_51                 1.464213e-03 3 1  ON 50
ci_52                 1.386315e-03 3 1  ON 51
ci_53                -1.359073e-03 3 1  ON 52
ci_54                -1.348148e-03 3 1  ON 53
ci_55                -1.298767e-03 3 1  ON 54
ci_56                 1.523160e-03 3 1  ON 55
ci_57                 1.354220e-03 3 1  ON 56
ci_58                -1.225320e-03 3 1  ON 57
ci_59                -1.208057e-03 3 1  ON 58
ci_60                 1.083974e-03 3 1  ON 59
ci_61                 1.182431e-03 3 1  ON 60
ci_62                -9.801161e-04 3 1  ON 61
ci_63                -9.897583e-04 3 1  ON 62
ci_64                -9.985104e-04 3 1  ON 63
ci_65                -9.835841e-04 3 1  ON 64
ci_66                -1.003376e-03 3 1  ON 65
ci_67                -9.710160e-04 3 1  ON 66
ci_68                 5.045044e-04 3 1  ON 67
ci_69                 6.182720e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8321
    reference variance = 0.77396
====================================================
  Execution time = 2.5115e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.0778e-01
  Total weights = 1.9629e+06
  Execution time = 3.5776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491526511014
                                         uncertainty =       0.003106694494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491526511014
                                         uncertainty =       0.003106694494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495769928
  error estimate for blocks of size 2^( 2) =       0.000516973931
  error estimate for blocks of size 2^( 3) =       0.000536592528
  error estimate for blocks of size 2^( 4) =       0.000550821241
  error estimate for blocks of size 2^( 5) =       0.000559276110
  error estimate for blocks of size 2^( 6) =       0.000562872341
  error estimate for blocks of size 2^( 7) =       0.000567511382

      target function =      -0.701603307396
              le_mean =     -22.812160343968
             les_mean =     520.902454797285
             stat err =       0.000560120268
             autocorr =       1.276445322296
   target nu stat err =       0.000560120268
   target dn stat err =       0.003120648008
      target stat err =       0.002199004387
              std dev =       0.701124555985
             le_variance =       0.491575643005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491469135631
                                         uncertainty =       0.003105753382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491469135631
                                         uncertainty =       0.003105753382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495741004
  error estimate for blocks of size 2^( 2) =       0.000516943553
  error estimate for blocks of size 2^( 3) =       0.000536561006
  error estimate for blocks of size 2^( 4) =       0.000550789587
  error estimate for blocks of size 2^( 5) =       0.000559244002
  error estimate for blocks of size 2^( 6) =       0.000562839988
  error estimate for blocks of size 2^( 7) =       0.000567478737

      target function =      -0.701618504518
              le_mean =     -22.812160118757
             les_mean =     520.902422263387
             stat err =       0.000560088078
             autocorr =       1.276447549615
   target nu stat err =       0.000560088078
   target dn stat err =       0.003119644134
      target stat err =       0.002198424298
              std dev =       0.701083650702
             le_variance =       0.491518285281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491497780866
                                         uncertainty =       0.003106223071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491497780866
                                         uncertainty =       0.003106223071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495755445
  error estimate for blocks of size 2^( 2) =       0.000516958721
  error estimate for blocks of size 2^( 3) =       0.000536576745
  error estimate for blocks of size 2^( 4) =       0.000550805392
  error estimate for blocks of size 2^( 5) =       0.000559260034
  error estimate for blocks of size 2^( 6) =       0.000562856138
  error estimate for blocks of size 2^( 7) =       0.000567495033

      target function =      -0.701623629714
              le_mean =     -22.812160228583
             les_mean =     520.902419772488
             stat err =       0.000560104150
             autocorr =       1.276446436672
   target nu stat err =       0.000560104150
   target dn stat err =       0.003119058986
      target stat err =       0.002198072616
              std dev =       0.701104073370
             le_variance =       0.491546921696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491522916909
                                         uncertainty =       0.003106635499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491522916909
                                         uncertainty =       0.003106635499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495768116
  error estimate for blocks of size 2^( 2) =       0.000516972028
  error estimate for blocks of size 2^( 3) =       0.000536590554
  error estimate for blocks of size 2^( 4) =       0.000550819258
  error estimate for blocks of size 2^( 5) =       0.000559274099
  error estimate for blocks of size 2^( 6) =       0.000562870314
  error estimate for blocks of size 2^( 7) =       0.000567509336

      target function =      -0.701606706621
              le_mean =     -22.812160329216
             les_mean =     520.902449146274
             stat err =       0.000560118252
             autocorr =       1.276445461155
   target nu stat err =       0.000560118252
   target dn stat err =       0.003120383647
      target stat err =       0.002198849662
              std dev =       0.701121993669
             le_variance =       0.491572050006


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.701603307396        initial
     4.0000e+01     4.0000e+02             3.6135e-05        -0.701618504518
     1.6000e+02     1.6000e+03             9.0419e-06        -0.701623629714  <--
     6.4000e+02     6.4000e+03             2.2610e-06        -0.701606706621

*****************************************************************************
Applying the update for shift_i =   1.6000e+02     and shift_s =   1.6000e+03
*****************************************************************************

  Execution time = 4.3084e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.569436e-01 3 1  ON 0
ci_02                -5.201208e-02 3 1  ON 1
ci_03                -5.215207e-02 3 1  ON 2
ci_04                 5.043793e-02 3 1  ON 3
ci_05                -3.648732e-02 3 1  ON 4
ci_06                -3.651957e-02 3 1  ON 5
ci_07                 2.993725e-02 3 1  ON 6
ci_08                -1.590477e-02 3 1  ON 7
ci_09                -1.575873e-02 3 1  ON 8
ci_10                -1.563411e-02 3 1  ON 9
ci_11                 1.546512e-02 3 1  ON 10
ci_12                 1.212071e-02 3 1  ON 11
ci_13                 1.268304e-02 3 1  ON 12
ci_14                 1.279575e-02 3 1  ON 13
ci_15                 1.127603e-02 3 1  ON 14
ci_16                 1.121640e-02 3 1  ON 15
ci_17                -1.088553e-02 3 1  ON 16
ci_18                -1.101757e-02 3 1  ON 17
ci_19                 1.114270e-02 3 1  ON 18
ci_20                 9.793471e-03 3 1  ON 19
ci_21                 9.830499e-03 3 1  ON 20
ci_22                 9.711192e-03 3 1  ON 21
ci_23                 6.347519e-03 3 1  ON 22
ci_24                 5.091404e-03 3 1  ON 23
ci_25                 4.690688e-03 3 1  ON 24
ci_26                 4.446070e-03 3 1  ON 25
ci_27                 4.495251e-03 3 1  ON 26
ci_28                 3.755552e-03 3 1  ON 27
ci_29                 3.759702e-03 3 1  ON 28
ci_30                -3.386635e-03 3 1  ON 29
ci_31                -3.283069e-03 3 1  ON 30
ci_32                -2.856397e-03 3 1  ON 31
ci_33                -2.878265e-03 3 1  ON 32
ci_34                 2.316932e-03 3 1  ON 33
ci_35                 2.413442e-03 3 1  ON 34
ci_36                -2.312697e-03 3 1  ON 35
ci_37                -2.294574e-03 3 1  ON 36
ci_38                -1.828417e-03 3 1  ON 37
ci_39                -1.774446e-03 3 1  ON 38
ci_40                -1.969394e-03 3 1  ON 39
ci_41                -1.716555e-03 3 1  ON 40
ci_42                -1.777251e-03 3 1  ON 41
ci_43                -2.135010e-03 3 1  ON 42
ci_44                -1.896719e-03 3 1  ON 43
ci_45                -1.575821e-03 3 1  ON 44
ci_46                -1.611882e-03 3 1  ON 45
ci_47                -1.395305e-03 3 1  ON 46
ci_48                -1.399185e-03 3 1  ON 47
ci_49                -1.623069e-03 3 1  ON 48
ci_50                -1.527675e-03 3 1  ON 49
ci_51                 1.464213e-03 3 1  ON 50
ci_52                 1.386315e-03 3 1  ON 51
ci_53                -1.359073e-03 3 1  ON 52
ci_54                -1.348148e-03 3 1  ON 53
ci_55                -1.298767e-03 3 1  ON 54
ci_56                 1.523160e-03 3 1  ON 55
ci_57                 1.354220e-03 3 1  ON 56
ci_58                -1.225320e-03 3 1  ON 57
ci_59                -1.208057e-03 3 1  ON 58
ci_60                 1.083974e-03 3 1  ON 59
ci_61                 1.182431e-03 3 1  ON 60
ci_62                -9.801161e-04 3 1  ON 61
ci_63                -9.897583e-04 3 1  ON 62
ci_64                -9.985104e-04 3 1  ON 63
ci_65                -9.835841e-04 3 1  ON 64
ci_66                -1.003376e-03 3 1  ON 65
ci_67                -9.710160e-04 3 1  ON 66
ci_68                 5.045044e-04 3 1  ON 67
ci_69                 6.182720e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3338e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8488
    reference variance = 0.60493
====================================================
  Execution time = 2.5762e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5323e+04
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.0399e-01
  Total weights = 1.963320269e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489213572446
                                         uncertainty =       0.002421226966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489213572446
                                         uncertainty =       0.002421226966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494641876
  error estimate for blocks of size 2^( 2) =       0.000515964690
  error estimate for blocks of size 2^( 3) =       0.000536031663
  error estimate for blocks of size 2^( 4) =       0.000551593154
  error estimate for blocks of size 2^( 5) =       0.000561240150
  error estimate for blocks of size 2^( 6) =       0.000566288854
  error estimate for blocks of size 2^( 7) =       0.000570771019

      target function =      -0.704207443730
              le_mean =     -22.812045480686
             les_mean =     520.893412872221
             stat err =       0.000562473294
             autocorr =       1.293070051587
   target nu stat err =       0.000562473294
   target dn stat err =       0.002831946532
      target stat err =       0.002023343528
              std dev =       0.699529249721
             le_variance =       0.489341171215


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281204548069e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.704212459388       residual = 7.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.704227502284       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.704230021719       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.704230372148       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.704230459058       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.704230485736       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.704230497094       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.704230498392       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.704230498144       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.704230498106       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.704230498025       residual = 1.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 3.590452e-05

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.704212459388       residual = 7.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.704216223311       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.704216853501       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.704216941123       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.704216962844       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.704216969505       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.704216972341       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.704216972665       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.704216972603       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.704216972593       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.704216972573       residual = 1.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+02 is 8.984154e-06

solving harmonic davidson linear method for identity shift 6.4000e+02, overlap shift 6.4000e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.704212459388       residual = 7.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.704213400569       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.704213558137       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.704213580044       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.704213585474       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.704213587137       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.704213587847       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.704213587928       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.704213587911       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.704213587910       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.704213587904       residual = 1.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+02 is 2.246541e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.488962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0347e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.569358e-01 3 1  ON 0
ci_02                -5.200403e-02 3 1  ON 1
ci_03                -5.214400e-02 3 1  ON 2
ci_04                 5.042894e-02 3 1  ON 3
ci_05                -3.648207e-02 3 1  ON 4
ci_06                -3.651456e-02 3 1  ON 5
ci_07                 2.993608e-02 3 1  ON 6
ci_08                -1.590130e-02 3 1  ON 7
ci_09                -1.575650e-02 3 1  ON 8
ci_10                -1.563205e-02 3 1  ON 9
ci_11                 1.546432e-02 3 1  ON 10
ci_12                 1.211922e-02 3 1  ON 11
ci_13                 1.268299e-02 3 1  ON 12
ci_14                 1.279578e-02 3 1  ON 13
ci_15                 1.127441e-02 3 1  ON 14
ci_16                 1.121497e-02 3 1  ON 15
ci_17                -1.088431e-02 3 1  ON 16
ci_18                -1.101666e-02 3 1  ON 17
ci_19                 1.114184e-02 3 1  ON 18
ci_20                 9.792462e-03 3 1  ON 19
ci_21                 9.830277e-03 3 1  ON 20
ci_22                 9.711094e-03 3 1  ON 21
ci_23                 6.346629e-03 3 1  ON 22
ci_24                 5.091244e-03 3 1  ON 23
ci_25                 4.690172e-03 3 1  ON 24
ci_26                 4.445641e-03 3 1  ON 25
ci_27                 4.494878e-03 3 1  ON 26
ci_28                 3.754863e-03 3 1  ON 27
ci_29                 3.758890e-03 3 1  ON 28
ci_30                -3.385934e-03 3 1  ON 29
ci_31                -3.282555e-03 3 1  ON 30
ci_32                -2.855709e-03 3 1  ON 31
ci_33                -2.877895e-03 3 1  ON 32
ci_34                 2.316668e-03 3 1  ON 33
ci_35                 2.413061e-03 3 1  ON 34
ci_36                -2.312089e-03 3 1  ON 35
ci_37                -2.293869e-03 3 1  ON 36
ci_38                -1.827946e-03 3 1  ON 37
ci_39                -1.774210e-03 3 1  ON 38
ci_40                -1.969176e-03 3 1  ON 39
ci_41                -1.716214e-03 3 1  ON 40
ci_42                -1.776628e-03 3 1  ON 41
ci_43                -2.134748e-03 3 1  ON 42
ci_44                -1.896437e-03 3 1  ON 43
ci_45                -1.575626e-03 3 1  ON 44
ci_46                -1.611803e-03 3 1  ON 45
ci_47                -1.394776e-03 3 1  ON 46
ci_48                -1.398507e-03 3 1  ON 47
ci_49                -1.622826e-03 3 1  ON 48
ci_50                -1.527395e-03 3 1  ON 49
ci_51                 1.463883e-03 3 1  ON 50
ci_52                 1.386090e-03 3 1  ON 51
ci_53                -1.358932e-03 3 1  ON 52
ci_54                -1.347848e-03 3 1  ON 53
ci_55                -1.298515e-03 3 1  ON 54
ci_56                 1.523288e-03 3 1  ON 55
ci_57                 1.354601e-03 3 1  ON 56
ci_58                -1.225265e-03 3 1  ON 57
ci_59                -1.207975e-03 3 1  ON 58
ci_60                 1.083437e-03 3 1  ON 59
ci_61                 1.181925e-03 3 1  ON 60
ci_62                -9.800999e-04 3 1  ON 61
ci_63                -9.897744e-04 3 1  ON 62
ci_64                -9.981882e-04 3 1  ON 63
ci_65                -9.836059e-04 3 1  ON 64
ci_66                -1.003427e-03 3 1  ON 65
ci_67                -9.706900e-04 3 1  ON 66
ci_68                 5.039445e-04 3 1  ON 67
ci_69                 6.176400e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8023
    reference variance = 0.392931
====================================================
  Execution time = 2.4997e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.1174e-01
  Total weights = 1.9629e+06
  Execution time = 3.5991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493651493807
                                         uncertainty =       0.002805577952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493651493807
                                         uncertainty =       0.002805577952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496777141
  error estimate for blocks of size 2^( 2) =       0.000517855034
  error estimate for blocks of size 2^( 3) =       0.000538265292
  error estimate for blocks of size 2^( 4) =       0.000553355138
  error estimate for blocks of size 2^( 5) =       0.000562637923
  error estimate for blocks of size 2^( 6) =       0.000570326869
  error estimate for blocks of size 2^( 7) =       0.000574554071

      target function =      -0.698911527737
              le_mean =     -22.813205867140
             les_mean =     520.954120352268
             stat err =       0.000565218500
             autocorr =       1.294522278067
   target nu stat err =       0.000565218500
   target dn stat err =       0.003973244269
      target stat err =       0.002750863784
              std dev =       0.702548970419
             le_variance =       0.493575055837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493593490046
                                         uncertainty =       0.002805050538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493593490046
                                         uncertainty =       0.002805050538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496747961
  error estimate for blocks of size 2^( 2) =       0.000517824456
  error estimate for blocks of size 2^( 3) =       0.000538233451
  error estimate for blocks of size 2^( 4) =       0.000553322981
  error estimate for blocks of size 2^( 5) =       0.000562605607
  error estimate for blocks of size 2^( 6) =       0.000570294256
  error estimate for blocks of size 2^( 7) =       0.000574520462

      target function =      -0.698944497354
              le_mean =     -22.813206015664
             les_mean =     520.954078552009
             stat err =       0.000565185827
             autocorr =       1.294524693358
   target nu stat err =       0.000565185827
   target dn stat err =       0.003971054732
      target stat err =       0.002749656616
              std dev =       0.702507702822
             le_variance =       0.493517072524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493622445611
                                         uncertainty =       0.002805313151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493622445611
                                         uncertainty =       0.002805313151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496762528
  error estimate for blocks of size 2^( 2) =       0.000517839721
  error estimate for blocks of size 2^( 3) =       0.000538249347
  error estimate for blocks of size 2^( 4) =       0.000553339034
  error estimate for blocks of size 2^( 5) =       0.000562621739
  error estimate for blocks of size 2^( 6) =       0.000570310535
  error estimate for blocks of size 2^( 7) =       0.000574537238

      target function =      -0.698929832218
              le_mean =     -22.813205939008
             les_mean =     520.954096660420
             stat err =       0.000565202137
             autocorr =       1.294523483613
   target nu stat err =       0.000565202137
   target dn stat err =       0.003972124029
      target stat err =       0.002750257317
              std dev =       0.702528303970
             le_variance =       0.493546017879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493647859554
                                         uncertainty =       0.002805544749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493647859554
                                         uncertainty =       0.002805544749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496775313
  error estimate for blocks of size 2^( 2) =       0.000517853118
  error estimate for blocks of size 2^( 3) =       0.000538263297
  error estimate for blocks of size 2^( 4) =       0.000553353123
  error estimate for blocks of size 2^( 5) =       0.000562635898
  error estimate for blocks of size 2^( 6) =       0.000570324825
  error estimate for blocks of size 2^( 7) =       0.000574551965

      target function =      -0.698913956115
              le_mean =     -22.813205875844
             les_mean =     520.954117171183
             stat err =       0.000565216453
             autocorr =       1.294522428577
   target nu stat err =       0.000565216453
   target dn stat err =       0.003973101926
      target stat err =       0.002750787523
              std dev =       0.702546384849
             le_variance =       0.493571422865


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.698911527737        initial
     4.0000e+01     4.0000e+02             3.5905e-05        -0.698944497354  <--
     1.6000e+02     1.6000e+03             8.9842e-06        -0.698929832218
     6.4000e+02     6.4000e+03             2.2465e-06        -0.698913956115

*****************************************************************************
Applying the update for shift_i =   4.0000e+01     and shift_s =   4.0000e+02
*****************************************************************************

  Execution time = 4.4743e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.569122e-01 3 1  ON 0
ci_02                -5.197988e-02 3 1  ON 1
ci_03                -5.211984e-02 3 1  ON 2
ci_04                 5.040202e-02 3 1  ON 3
ci_05                -3.646633e-02 3 1  ON 4
ci_06                -3.649955e-02 3 1  ON 5
ci_07                 2.993259e-02 3 1  ON 6
ci_08                -1.589090e-02 3 1  ON 7
ci_09                -1.574980e-02 3 1  ON 8
ci_10                -1.562589e-02 3 1  ON 9
ci_11                 1.546193e-02 3 1  ON 10
ci_12                 1.211477e-02 3 1  ON 11
ci_13                 1.268283e-02 3 1  ON 12
ci_14                 1.279590e-02 3 1  ON 13
ci_15                 1.126955e-02 3 1  ON 14
ci_16                 1.121070e-02 3 1  ON 15
ci_17                -1.088064e-02 3 1  ON 16
ci_18                -1.101394e-02 3 1  ON 17
ci_19                 1.113925e-02 3 1  ON 18
ci_20                 9.789436e-03 3 1  ON 19
ci_21                 9.829613e-03 3 1  ON 20
ci_22                 9.710798e-03 3 1  ON 21
ci_23                 6.343964e-03 3 1  ON 22
ci_24                 5.090765e-03 3 1  ON 23
ci_25                 4.688628e-03 3 1  ON 24
ci_26                 4.444355e-03 3 1  ON 25
ci_27                 4.493760e-03 3 1  ON 26
ci_28                 3.752796e-03 3 1  ON 27
ci_29                 3.756459e-03 3 1  ON 28
ci_30                -3.383833e-03 3 1  ON 29
ci_31                -3.281013e-03 3 1  ON 30
ci_32                -2.853649e-03 3 1  ON 31
ci_33                -2.876785e-03 3 1  ON 32
ci_34                 2.315877e-03 3 1  ON 33
ci_35                 2.411920e-03 3 1  ON 34
ci_36                -2.310268e-03 3 1  ON 35
ci_37                -2.291756e-03 3 1  ON 36
ci_38                -1.826535e-03 3 1  ON 37
ci_39                -1.773504e-03 3 1  ON 38
ci_40                -1.968524e-03 3 1  ON 39
ci_41                -1.715190e-03 3 1  ON 40
ci_42                -1.774760e-03 3 1  ON 41
ci_43                -2.133963e-03 3 1  ON 42
ci_44                -1.895592e-03 3 1  ON 43
ci_45                -1.575039e-03 3 1  ON 44
ci_46                -1.611565e-03 3 1  ON 45
ci_47                -1.393190e-03 3 1  ON 46
ci_48                -1.396476e-03 3 1  ON 47
ci_49                -1.622099e-03 3 1  ON 48
ci_50                -1.526554e-03 3 1  ON 49
ci_51                 1.462892e-03 3 1  ON 50
ci_52                 1.385416e-03 3 1  ON 51
ci_53                -1.358510e-03 3 1  ON 52
ci_54                -1.346946e-03 3 1  ON 53
ci_55                -1.297760e-03 3 1  ON 54
ci_56                 1.523674e-03 3 1  ON 55
ci_57                 1.355741e-03 3 1  ON 56
ci_58                -1.225100e-03 3 1  ON 57
ci_59                -1.207731e-03 3 1  ON 58
ci_60                 1.081826e-03 3 1  ON 59
ci_61                 1.180407e-03 3 1  ON 60
ci_62                -9.800513e-04 3 1  ON 61
ci_63                -9.898224e-04 3 1  ON 62
ci_64                -9.972224e-04 3 1  ON 63
ci_65                -9.836709e-04 3 1  ON 64
ci_66                -1.003579e-03 3 1  ON 65
ci_67                -9.697133e-04 3 1  ON 66
ci_68                 5.022668e-04 3 1  ON 67
ci_69                 6.157463e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5101e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7208
    reference variance = 0.651903
====================================================
  Execution time = 2.5655e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.2060e-01
  Total weights = 1.963010770e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6090e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503148952808
                                         uncertainty =       0.004115887829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503148952808
                                         uncertainty =       0.004115887829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501570109
  error estimate for blocks of size 2^( 2) =       0.000523234661
  error estimate for blocks of size 2^( 3) =       0.000543256674
  error estimate for blocks of size 2^( 4) =       0.000558636756
  error estimate for blocks of size 2^( 5) =       0.000568882936
  error estimate for blocks of size 2^( 6) =       0.000573304403
  error estimate for blocks of size 2^( 7) =       0.000575676231

      target function =      -0.692962599565
              le_mean =     -22.813061055883
             les_mean =     520.956353761616
             stat err =       0.000569125082
             autocorr =       1.287514583896
   target nu stat err =       0.000569125082
   target dn stat err =       0.004470400390
      target stat err =       0.003030771213
              std dev =       0.709327251089
             le_variance =       0.503145149137


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281306105588e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.692974965222       residual = 6.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.693033413434       residual = 9.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.693042249498       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.693043570134       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.693043955798       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.693044041783       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.693044083098       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.693044083198       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.693044083117       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.693044082968       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.693044083381       residual = 1.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.382218e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.692974965222       residual = 6.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.692989625692       residual = 9.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.692991839103       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.692992169451       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.692992265764       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.692992287167       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.692992297429       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.692992297451       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.692992297430       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.692992297393       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.692992297496       residual = 1.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 3.467617e-05

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.692974965222       residual = 6.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.692978633378       residual = 9.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.692979187005       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.692979269604       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.692979293676       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.692979299021       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.692979301582       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.692979301588       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.692979301582       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.692979301573       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.692979301599       residual = 1.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+02 is 8.676618e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.493055 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0273e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.568834e-01 3 1  ON 0
ci_02                -5.194804e-02 3 1  ON 1
ci_03                -5.208782e-02 3 1  ON 2
ci_04                 5.036735e-02 3 1  ON 3
ci_05                -3.644693e-02 3 1  ON 4
ci_06                -3.648200e-02 3 1  ON 5
ci_07                 2.992983e-02 3 1  ON 6
ci_08                -1.587764e-02 3 1  ON 7
ci_09                -1.573911e-02 3 1  ON 8
ci_10                -1.561677e-02 3 1  ON 9
ci_11                 1.545682e-02 3 1  ON 10
ci_12                 1.210818e-02 3 1  ON 11
ci_13                 1.268300e-02 3 1  ON 12
ci_14                 1.279556e-02 3 1  ON 13
ci_15                 1.126107e-02 3 1  ON 14
ci_16                 1.120460e-02 3 1  ON 15
ci_17                -1.087737e-02 3 1  ON 16
ci_18                -1.101033e-02 3 1  ON 17
ci_19                 1.113774e-02 3 1  ON 18
ci_20                 9.786876e-03 3 1  ON 19
ci_21                 9.828565e-03 3 1  ON 20
ci_22                 9.711528e-03 3 1  ON 21
ci_23                 6.342631e-03 3 1  ON 22
ci_24                 5.089274e-03 3 1  ON 23
ci_25                 4.687123e-03 3 1  ON 24
ci_26                 4.442814e-03 3 1  ON 25
ci_27                 4.494564e-03 3 1  ON 26
ci_28                 3.750518e-03 3 1  ON 27
ci_29                 3.756009e-03 3 1  ON 28
ci_30                -3.381500e-03 3 1  ON 29
ci_31                -3.276626e-03 3 1  ON 30
ci_32                -2.851472e-03 3 1  ON 31
ci_33                -2.872901e-03 3 1  ON 32
ci_34                 2.313965e-03 3 1  ON 33
ci_35                 2.409200e-03 3 1  ON 34
ci_36                -2.309440e-03 3 1  ON 35
ci_37                -2.291271e-03 3 1  ON 36
ci_38                -1.825251e-03 3 1  ON 37
ci_39                -1.771077e-03 3 1  ON 38
ci_40                -1.967264e-03 3 1  ON 39
ci_41                -1.713675e-03 3 1  ON 40
ci_42                -1.773152e-03 3 1  ON 41
ci_43                -2.133931e-03 3 1  ON 42
ci_44                -1.896631e-03 3 1  ON 43
ci_45                -1.573772e-03 3 1  ON 44
ci_46                -1.610486e-03 3 1  ON 45
ci_47                -1.390568e-03 3 1  ON 46
ci_48                -1.395717e-03 3 1  ON 47
ci_49                -1.620666e-03 3 1  ON 48
ci_50                -1.525427e-03 3 1  ON 49
ci_51                 1.460288e-03 3 1  ON 50
ci_52                 1.384348e-03 3 1  ON 51
ci_53                -1.356203e-03 3 1  ON 52
ci_54                -1.347286e-03 3 1  ON 53
ci_55                -1.297079e-03 3 1  ON 54
ci_56                 1.524772e-03 3 1  ON 55
ci_57                 1.355708e-03 3 1  ON 56
ci_58                -1.223799e-03 3 1  ON 57
ci_59                -1.207446e-03 3 1  ON 58
ci_60                 1.080101e-03 3 1  ON 59
ci_61                 1.179258e-03 3 1  ON 60
ci_62                -9.794699e-04 3 1  ON 61
ci_63                -9.890800e-04 3 1  ON 62
ci_64                -9.952981e-04 3 1  ON 63
ci_65                -9.834157e-04 3 1  ON 64
ci_66                -1.003145e-03 3 1  ON 65
ci_67                -9.689659e-04 3 1  ON 66
ci_68                 5.000709e-04 3 1  ON 67
ci_69                 6.141220e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8814
    reference variance = 0.413348
====================================================
  Execution time = 2.5306e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.0536e-01
  Total weights = 1.9629e+06
  Execution time = 3.6083e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489673544963
                                         uncertainty =       0.002047708851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489673544963
                                         uncertainty =       0.002047708851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494797571
  error estimate for blocks of size 2^( 2) =       0.000516134149
  error estimate for blocks of size 2^( 3) =       0.000536595353
  error estimate for blocks of size 2^( 4) =       0.000550637108
  error estimate for blocks of size 2^( 5) =       0.000559829797
  error estimate for blocks of size 2^( 6) =       0.000565866970
  error estimate for blocks of size 2^( 7) =       0.000567803625

      target function =      -0.703254571936
              le_mean =     -22.813164872161
             les_mean =     520.945893477241
             stat err =       0.000561034375
             autocorr =       1.285653173067
   target nu stat err =       0.000561034375
   target dn stat err =       0.003019455110
      target stat err =       0.002145080840
              std dev =       0.699749435064
             le_variance =       0.489649271872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489471878225
                                         uncertainty =       0.002048644565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489471878225
                                         uncertainty =       0.002048644565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494695774
  error estimate for blocks of size 2^( 2) =       0.000516027258
  error estimate for blocks of size 2^( 3) =       0.000536484290
  error estimate for blocks of size 2^( 4) =       0.000550524511
  error estimate for blocks of size 2^( 5) =       0.000559717962
  error estimate for blocks of size 2^( 6) =       0.000565753345
  error estimate for blocks of size 2^( 7) =       0.000567692142

      target function =      -0.703235872871
              le_mean =     -22.813165162125
             les_mean =     520.945933895311
             stat err =       0.000560921990
             autocorr =       1.285667106038
   target nu stat err =       0.000560921990
   target dn stat err =       0.003026624015
      target stat err =       0.002149704187
              std dev =       0.699605472187
             le_variance =       0.489447816715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489573978497
                                         uncertainty =       0.002048149297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489573978497
                                         uncertainty =       0.002048149297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494747315
  error estimate for blocks of size 2^( 2) =       0.000516081306
  error estimate for blocks of size 2^( 3) =       0.000536539567
  error estimate for blocks of size 2^( 4) =       0.000550581949
  error estimate for blocks of size 2^( 5) =       0.000559776340
  error estimate for blocks of size 2^( 6) =       0.000565814668
  error estimate for blocks of size 2^( 7) =       0.000567754564

      target function =      -0.276523217059
              le_mean =     -22.813165956175
             les_mean =     521.995035460789
             stat err =       0.000560981880
             autocorr =       1.285673745075
   target nu stat err =       0.000560981880
   target dn stat err =       1.049613768345
      target stat err =       0.140012885275
              std dev =       0.699678363200
             le_variance =       0.489549811930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489660824290
                                         uncertainty =       0.002047766016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489660824290
                                         uncertainty =       0.002047766016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494791150
  error estimate for blocks of size 2^( 2) =       0.000516127408
  error estimate for blocks of size 2^( 3) =       0.000536588351
  error estimate for blocks of size 2^( 4) =       0.000550630009
  error estimate for blocks of size 2^( 5) =       0.000559822747
  error estimate for blocks of size 2^( 6) =       0.000565859809
  error estimate for blocks of size 2^( 7) =       0.000567796603

      target function =      -0.703262471670
              le_mean =     -22.813164882026
             les_mean =     520.945882424449
             stat err =       0.000561027292
             autocorr =       1.285654074654
   target nu stat err =       0.000561027292
   target dn stat err =       0.003019724697
      target stat err =       0.002145304753
              std dev =       0.699740355007
             le_variance =       0.489636564426


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.703254571936        initial
     1.0000e+01     1.0000e+02             1.3822e-04        -0.703235872871
     4.0000e+01     4.0000e+02             3.4676e-05        -0.276523217059
     1.6000e+02     1.6000e+03             8.6766e-06        -0.703262471670  <--

*****************************************************************************
Applying the update for shift_i =   1.6000e+02     and shift_s =   1.6000e+03
*****************************************************************************

  Execution time = 4.3403e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.569050e-01 3 1  ON 0
ci_02                -5.197192e-02 3 1  ON 1
ci_03                -5.211183e-02 3 1  ON 2
ci_04                 5.039335e-02 3 1  ON 3
ci_05                -3.646148e-02 3 1  ON 4
ci_06                -3.649516e-02 3 1  ON 5
ci_07                 2.993190e-02 3 1  ON 6
ci_08                -1.588758e-02 3 1  ON 7
ci_09                -1.574713e-02 3 1  ON 8
ci_10                -1.562361e-02 3 1  ON 9
ci_11                 1.546065e-02 3 1  ON 10
ci_12                 1.211312e-02 3 1  ON 11
ci_13                 1.268287e-02 3 1  ON 12
ci_14                 1.279581e-02 3 1  ON 13
ci_15                 1.126743e-02 3 1  ON 14
ci_16                 1.120917e-02 3 1  ON 15
ci_17                -1.087982e-02 3 1  ON 16
ci_18                -1.101304e-02 3 1  ON 17
ci_19                 1.113887e-02 3 1  ON 18
ci_20                 9.788796e-03 3 1  ON 19
ci_21                 9.829351e-03 3 1  ON 20
ci_22                 9.710981e-03 3 1  ON 21
ci_23                 6.343630e-03 3 1  ON 22
ci_24                 5.090392e-03 3 1  ON 23
ci_25                 4.688251e-03 3 1  ON 24
ci_26                 4.443969e-03 3 1  ON 25
ci_27                 4.493961e-03 3 1  ON 26
ci_28                 3.752227e-03 3 1  ON 27
ci_29                 3.756346e-03 3 1  ON 28
ci_30                -3.383249e-03 3 1  ON 29
ci_31                -3.279916e-03 3 1  ON 30
ci_32                -2.853104e-03 3 1  ON 31
ci_33                -2.875813e-03 3 1  ON 32
ci_34                 2.315398e-03 3 1  ON 33
ci_35                 2.411239e-03 3 1  ON 34
ci_36                -2.310061e-03 3 1  ON 35
ci_37                -2.291635e-03 3 1  ON 36
ci_38                -1.826214e-03 3 1  ON 37
ci_39                -1.772896e-03 3 1  ON 38
ci_40                -1.968209e-03 3 1  ON 39
ci_41                -1.714811e-03 3 1  ON 40
ci_42                -1.774358e-03 3 1  ON 41
ci_43                -2.133955e-03 3 1  ON 42
ci_44                -1.895852e-03 3 1  ON 43
ci_45                -1.574722e-03 3 1  ON 44
ci_46                -1.611295e-03 3 1  ON 45
ci_47                -1.392534e-03 3 1  ON 46
ci_48                -1.396286e-03 3 1  ON 47
ci_49                -1.621740e-03 3 1  ON 48
ci_50                -1.526272e-03 3 1  ON 49
ci_51                 1.462241e-03 3 1  ON 50
ci_52                 1.385149e-03 3 1  ON 51
ci_53                -1.357933e-03 3 1  ON 52
ci_54                -1.347031e-03 3 1  ON 53
ci_55                -1.297590e-03 3 1  ON 54
ci_56                 1.523949e-03 3 1  ON 55
ci_57                 1.355733e-03 3 1  ON 56
ci_58                -1.224775e-03 3 1  ON 57
ci_59                -1.207659e-03 3 1  ON 58
ci_60                 1.081394e-03 3 1  ON 59
ci_61                 1.180120e-03 3 1  ON 60
ci_62                -9.799058e-04 3 1  ON 61
ci_63                -9.896367e-04 3 1  ON 62
ci_64                -9.967409e-04 3 1  ON 63
ci_65                -9.836071e-04 3 1  ON 64
ci_66                -1.003470e-03 3 1  ON 65
ci_67                -9.695263e-04 3 1  ON 66
ci_68                 5.017174e-04 3 1  ON 67
ci_69                 6.153400e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3682e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7476
    reference variance = 0.343517
====================================================
  Execution time = 2.5648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5339e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.0829e-01
  Total weights = 1.963216226e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492962603924
                                         uncertainty =       0.002504512372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492962603924
                                         uncertainty =       0.002504512372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496493359
  error estimate for blocks of size 2^( 2) =       0.000518002619
  error estimate for blocks of size 2^( 3) =       0.000537950756
  error estimate for blocks of size 2^( 4) =       0.000552578010
  error estimate for blocks of size 2^( 5) =       0.000562003546
  error estimate for blocks of size 2^( 6) =       0.000568310834
  error estimate for blocks of size 2^( 7) =       0.000572608936

      target function =      -0.701269633200
              le_mean =     -22.812785562494
             les_mean =     520.931477275510
             stat err =       0.000563875332
             autocorr =       1.289850282588
   target nu stat err =       0.000563875332
   target dn stat err =       0.003412804256
      target stat err =       0.002393438608
              std dev =       0.702147642113
             le_variance =       0.493011311324


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281278556249e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.701276987341       residual = 7.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701292144732       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.701294656549       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.701294988552       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.701295101243       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.701295129019       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.701295138717       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.701295139501       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.701295139102       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.701295139031       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.701295139039       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 3.536343e-05

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.701276987341       residual = 7.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701280779902       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.701281408184       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.701281491196       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.701281519363       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.701281526300       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.701281528721       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.701281528916       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.701281528817       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.701281528799       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.701281528801       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+02 is 8.848768e-06

solving harmonic davidson linear method for identity shift 6.4000e+02, overlap shift 6.4000e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.701276987341       residual = 7.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701277935682       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.701278092773       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.701278113527       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.701278120568       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.701278122302       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.701278122907       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.701278122956       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.701278122931       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.701278122927       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.701278122927       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+02 is 2.212687e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.497183 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0223e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.568974e-01 3 1  ON 0
ci_02                -5.196397e-02 3 1  ON 1
ci_03                -5.210373e-02 3 1  ON 2
ci_04                 5.038450e-02 3 1  ON 3
ci_05                -3.645667e-02 3 1  ON 4
ci_06                -3.649017e-02 3 1  ON 5
ci_07                 2.993075e-02 3 1  ON 6
ci_08                -1.588403e-02 3 1  ON 7
ci_09                -1.574573e-02 3 1  ON 8
ci_10                -1.562174e-02 3 1  ON 9
ci_11                 1.545971e-02 3 1  ON 10
ci_12                 1.211147e-02 3 1  ON 11
ci_13                 1.268274e-02 3 1  ON 12
ci_14                 1.279550e-02 3 1  ON 13
ci_15                 1.126595e-02 3 1  ON 14
ci_16                 1.120778e-02 3 1  ON 15
ci_17                -1.087888e-02 3 1  ON 16
ci_18                -1.101162e-02 3 1  ON 17
ci_19                 1.113793e-02 3 1  ON 18
ci_20                 9.787515e-03 3 1  ON 19
ci_21                 9.829169e-03 3 1  ON 20
ci_22                 9.710853e-03 3 1  ON 21
ci_23                 6.342881e-03 3 1  ON 22
ci_24                 5.090101e-03 3 1  ON 23
ci_25                 4.687414e-03 3 1  ON 24
ci_26                 4.443431e-03 3 1  ON 25
ci_27                 4.493103e-03 3 1  ON 26
ci_28                 3.751865e-03 3 1  ON 27
ci_29                 3.756259e-03 3 1  ON 28
ci_30                -3.382819e-03 3 1  ON 29
ci_31                -3.279657e-03 3 1  ON 30
ci_32                -2.852376e-03 3 1  ON 31
ci_33                -2.875240e-03 3 1  ON 32
ci_34                 2.315202e-03 3 1  ON 33
ci_35                 2.410469e-03 3 1  ON 34
ci_36                -2.309454e-03 3 1  ON 35
ci_37                -2.291402e-03 3 1  ON 36
ci_38                -1.825779e-03 3 1  ON 37
ci_39                -1.772532e-03 3 1  ON 38
ci_40                -1.968240e-03 3 1  ON 39
ci_41                -1.714712e-03 3 1  ON 40
ci_42                -1.773808e-03 3 1  ON 41
ci_43                -2.134222e-03 3 1  ON 42
ci_44                -1.895855e-03 3 1  ON 43
ci_45                -1.574284e-03 3 1  ON 44
ci_46                -1.611134e-03 3 1  ON 45
ci_47                -1.392386e-03 3 1  ON 46
ci_48                -1.395888e-03 3 1  ON 47
ci_49                -1.621438e-03 3 1  ON 48
ci_50                -1.526189e-03 3 1  ON 49
ci_51                 1.462029e-03 3 1  ON 50
ci_52                 1.384845e-03 3 1  ON 51
ci_53                -1.357671e-03 3 1  ON 52
ci_54                -1.346782e-03 3 1  ON 53
ci_55                -1.297210e-03 3 1  ON 54
ci_56                 1.524031e-03 3 1  ON 55
ci_57                 1.355951e-03 3 1  ON 56
ci_58                -1.224464e-03 3 1  ON 57
ci_59                -1.207406e-03 3 1  ON 58
ci_60                 1.081139e-03 3 1  ON 59
ci_61                 1.180111e-03 3 1  ON 60
ci_62                -9.796467e-04 3 1  ON 61
ci_63                -9.894564e-04 3 1  ON 62
ci_64                -9.967281e-04 3 1  ON 63
ci_65                -9.833585e-04 3 1  ON 64
ci_66                -1.003352e-03 3 1  ON 65
ci_67                -9.695848e-04 3 1  ON 66
ci_68                 5.012064e-04 3 1  ON 67
ci_69                 6.149638e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.853
    reference variance = 0.997318
====================================================
  Execution time = 2.5167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.1084e-01
  Total weights = 1.9632e+06
  Execution time = 3.5946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494773474797
                                         uncertainty =       0.002826364205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494773474797
                                         uncertainty =       0.002826364205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497434835
  error estimate for blocks of size 2^( 2) =       0.000518246894
  error estimate for blocks of size 2^( 3) =       0.000538733437
  error estimate for blocks of size 2^( 4) =       0.000553654601
  error estimate for blocks of size 2^( 5) =       0.000562358452
  error estimate for blocks of size 2^( 6) =       0.000569621679
  error estimate for blocks of size 2^( 7) =       0.000572597394

      target function =      -0.699527409953
              le_mean =     -22.812168226960
             les_mean =     520.905861881828
             stat err =       0.000564558032
             autocorr =       1.288085793445
   target nu stat err =       0.000564558032
   target dn stat err =       0.003530780011
      target stat err =       0.002457972574
              std dev =       0.703479089521
             le_variance =       0.494882829393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494716332033
                                         uncertainty =       0.002825693601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494716332033
                                         uncertainty =       0.002825693601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497406103
  error estimate for blocks of size 2^( 2) =       0.000518216948
  error estimate for blocks of size 2^( 3) =       0.000538702364
  error estimate for blocks of size 2^( 4) =       0.000553623284
  error estimate for blocks of size 2^( 5) =       0.000562326816
  error estimate for blocks of size 2^( 6) =       0.000569588408
  error estimate for blocks of size 2^( 7) =       0.000572565284

      target function =      -0.699565173453
              le_mean =     -22.812168534671
             les_mean =     520.905820287084
             stat err =       0.000564525948
             autocorr =       1.288088190037
   target nu stat err =       0.000564525948
   target dn stat err =       0.003530040773
      target stat err =       0.002457736355
              std dev =       0.703438456885
             le_variance =       0.494825662625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494744861047
                                         uncertainty =       0.002826028186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494744861047
                                         uncertainty =       0.002826028186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497420448
  error estimate for blocks of size 2^( 2) =       0.000518231899
  error estimate for blocks of size 2^( 3) =       0.000538717878
  error estimate for blocks of size 2^( 4) =       0.000553638920
  error estimate for blocks of size 2^( 5) =       0.000562342610
  error estimate for blocks of size 2^( 6) =       0.000569605020
  error estimate for blocks of size 2^( 7) =       0.000572581316

      target function =      -0.699548363566
              le_mean =     -22.812168378138
             les_mean =     520.905837908789
             stat err =       0.000564541967
             autocorr =       1.288086994907
   target nu stat err =       0.000564541967
   target dn stat err =       0.003530399871
      target stat err =       0.002457861699
              std dev =       0.703458743367
             le_variance =       0.494854203619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494769895249
                                         uncertainty =       0.002826322146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494769895249
                                         uncertainty =       0.002826322146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497433035
  error estimate for blocks of size 2^( 2) =       0.000518245018
  error estimate for blocks of size 2^( 3) =       0.000538731491
  error estimate for blocks of size 2^( 4) =       0.000553652639
  error estimate for blocks of size 2^( 5) =       0.000562356470
  error estimate for blocks of size 2^( 6) =       0.000569619596
  error estimate for blocks of size 2^( 7) =       0.000572595383

      target function =      -0.699520597435
              le_mean =     -22.812168245753
             les_mean =     520.905872778085
             stat err =       0.000564556022
             autocorr =       1.288085943586
   target nu stat err =       0.000564556022
   target dn stat err =       0.003530768870
      target stat err =       0.002457918146
              std dev =       0.703476544272
             le_variance =       0.494879248341


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.699527409953        initial
     4.0000e+01     4.0000e+02             3.5363e-05        -0.699565173453  <--
     1.6000e+02     1.6000e+03             8.8488e-06        -0.699548363566
     6.4000e+02     6.4000e+03             2.2127e-06        -0.699520597435

*****************************************************************************
Applying the update for shift_i =   4.0000e+01     and shift_s =   4.0000e+02
*****************************************************************************

  Execution time = 4.3189e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.568745e-01 3 1  ON 0
ci_02                -5.194015e-02 3 1  ON 1
ci_03                -5.207947e-02 3 1  ON 2
ci_04                 5.035798e-02 3 1  ON 3
ci_05                -3.644227e-02 3 1  ON 4
ci_06                -3.647520e-02 3 1  ON 5
ci_07                 2.992731e-02 3 1  ON 6
ci_08                -1.587339e-02 3 1  ON 7
ci_09                -1.574154e-02 3 1  ON 8
ci_10                -1.561614e-02 3 1  ON 9
ci_11                 1.545688e-02 3 1  ON 10
ci_12                 1.210653e-02 3 1  ON 11
ci_13                 1.268234e-02 3 1  ON 12
ci_14                 1.279457e-02 3 1  ON 13
ci_15                 1.126153e-02 3 1  ON 14
ci_16                 1.120361e-02 3 1  ON 15
ci_17                -1.087607e-02 3 1  ON 16
ci_18                -1.100739e-02 3 1  ON 17
ci_19                 1.113513e-02 3 1  ON 18
ci_20                 9.783678e-03 3 1  ON 19
ci_21                 9.828625e-03 3 1  ON 20
ci_22                 9.710470e-03 3 1  ON 21
ci_23                 6.340638e-03 3 1  ON 22
ci_24                 5.089227e-03 3 1  ON 23
ci_25                 4.684906e-03 3 1  ON 24
ci_26                 4.441817e-03 3 1  ON 25
ci_27                 4.490533e-03 3 1  ON 26
ci_28                 3.750780e-03 3 1  ON 27
ci_29                 3.755996e-03 3 1  ON 28
ci_30                -3.381528e-03 3 1  ON 29
ci_31                -3.278882e-03 3 1  ON 30
ci_32                -2.850195e-03 3 1  ON 31
ci_33                -2.873524e-03 3 1  ON 32
ci_34                 2.314613e-03 3 1  ON 33
ci_35                 2.408163e-03 3 1  ON 34
ci_36                -2.307637e-03 3 1  ON 35
ci_37                -2.290704e-03 3 1  ON 36
ci_38                -1.824476e-03 3 1  ON 37
ci_39                -1.771440e-03 3 1  ON 38
ci_40                -1.968333e-03 3 1  ON 39
ci_41                -1.714417e-03 3 1  ON 40
ci_42                -1.772162e-03 3 1  ON 41
ci_43                -2.135023e-03 3 1  ON 42
ci_44                -1.895862e-03 3 1  ON 43
ci_45                -1.572973e-03 3 1  ON 44
ci_46                -1.610651e-03 3 1  ON 45
ci_47                -1.391942e-03 3 1  ON 46
ci_48                -1.394695e-03 3 1  ON 47
ci_49                -1.620532e-03 3 1  ON 48
ci_50                -1.525940e-03 3 1  ON 49
ci_51                 1.461395e-03 3 1  ON 50
ci_52                 1.383935e-03 3 1  ON 51
ci_53                -1.356886e-03 3 1  ON 52
ci_54                -1.346035e-03 3 1  ON 53
ci_55                -1.296073e-03 3 1  ON 54
ci_56                 1.524279e-03 3 1  ON 55
ci_57                 1.356604e-03 3 1  ON 56
ci_58                -1.223532e-03 3 1  ON 57
ci_59                -1.206648e-03 3 1  ON 58
ci_60                 1.080375e-03 3 1  ON 59
ci_61                 1.180085e-03 3 1  ON 60
ci_62                -9.788701e-04 3 1  ON 61
ci_63                -9.889160e-04 3 1  ON 62
ci_64                -9.966898e-04 3 1  ON 63
ci_65                -9.826134e-04 3 1  ON 64
ci_66                -1.002997e-03 3 1  ON 65
ci_67                -9.697597e-04 3 1  ON 66
ci_68                 4.996750e-04 3 1  ON 67
ci_69                 6.138363e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3418e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7651
    reference variance = 0.888341
====================================================
  Execution time = 2.5588e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5321e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.1163e-01
  Total weights = 1.963169256e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492402661912
                                         uncertainty =       0.002445140601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492402661912
                                         uncertainty =       0.002445140601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496173560
  error estimate for blocks of size 2^( 2) =       0.000517291754
  error estimate for blocks of size 2^( 3) =       0.000537782813
  error estimate for blocks of size 2^( 4) =       0.000553450300
  error estimate for blocks of size 2^( 5) =       0.000561686094
  error estimate for blocks of size 2^( 6) =       0.000567297733
  error estimate for blocks of size 2^( 7) =       0.000570885815

      target function =      -0.698993227244
              le_mean =     -22.812666536755
             les_mean =     520.929386394669
             stat err =       0.000563329985
             autocorr =       1.289016574500
   target nu stat err =       0.000563329985
   target dn stat err =       0.003933315815
      target stat err =       0.002722542505
              std dev =       0.701695378045
             le_variance =       0.492376403570


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281266653676e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.699003745421       residual = 7.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699065462298       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.699074895073       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.699076447444       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.699076874764       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.699077131279       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.699077206240       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.699077205635       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.699077206289       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.699077205819       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.699077205363       residual = 1.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.446209e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.699003745421       residual = 7.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699019226895       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.699021590128       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.699021978546       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.699022085260       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.699022149220       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.699022167867       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.699022167708       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.699022167869       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.699022167752       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.699022167638       residual = 1.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 3.628332e-05

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.699003745421       residual = 7.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699007619069       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.699008210193       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.699008307318       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.699008333989       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.699008349968       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.699008354624       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.699008354584       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.699008354624       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.699008354594       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.699008354566       residual = 1.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+02 is 9.078871e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.501281 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0183e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.568442e-01 3 1  ON 0
ci_02                -5.191137e-02 3 1  ON 1
ci_03                -5.204899e-02 3 1  ON 2
ci_04                 5.032170e-02 3 1  ON 3
ci_05                -3.642051e-02 3 1  ON 4
ci_06                -3.645509e-02 3 1  ON 5
ci_07                 2.992412e-02 3 1  ON 6
ci_08                -1.585882e-02 3 1  ON 7
ci_09                -1.573240e-02 3 1  ON 8
ci_10                -1.560472e-02 3 1  ON 9
ci_11                 1.545445e-02 3 1  ON 10
ci_12                 1.209981e-02 3 1  ON 11
ci_13                 1.268160e-02 3 1  ON 12
ci_14                 1.279313e-02 3 1  ON 13
ci_15                 1.125513e-02 3 1  ON 14
ci_16                 1.119806e-02 3 1  ON 15
ci_17                -1.087326e-02 3 1  ON 16
ci_18                -1.100356e-02 3 1  ON 17
ci_19                 1.113147e-02 3 1  ON 18
ci_20                 9.779812e-03 3 1  ON 19
ci_21                 9.826879e-03 3 1  ON 20
ci_22                 9.709822e-03 3 1  ON 21
ci_23                 6.338960e-03 3 1  ON 22
ci_24                 5.089720e-03 3 1  ON 23
ci_25                 4.682300e-03 3 1  ON 24
ci_26                 4.440925e-03 3 1  ON 25
ci_27                 4.490703e-03 3 1  ON 26
ci_28                 3.746715e-03 3 1  ON 27
ci_29                 3.754151e-03 3 1  ON 28
ci_30                -3.379308e-03 3 1  ON 29
ci_31                -3.276939e-03 3 1  ON 30
ci_32                -2.845736e-03 3 1  ON 31
ci_33                -2.870946e-03 3 1  ON 32
ci_34                 2.310594e-03 3 1  ON 33
ci_35                 2.407389e-03 3 1  ON 34
ci_36                -2.305499e-03 3 1  ON 35
ci_37                -2.288875e-03 3 1  ON 36
ci_38                -1.824225e-03 3 1  ON 37
ci_39                -1.769879e-03 3 1  ON 38
ci_40                -1.966287e-03 3 1  ON 39
ci_41                -1.714675e-03 3 1  ON 40
ci_42                -1.771643e-03 3 1  ON 41
ci_43                -2.134281e-03 3 1  ON 42
ci_44                -1.896269e-03 3 1  ON 43
ci_45                -1.572019e-03 3 1  ON 44
ci_46                -1.609017e-03 3 1  ON 45
ci_47                -1.388624e-03 3 1  ON 46
ci_48                -1.392124e-03 3 1  ON 47
ci_49                -1.619857e-03 3 1  ON 48
ci_50                -1.524151e-03 3 1  ON 49
ci_51                 1.459044e-03 3 1  ON 50
ci_52                 1.381523e-03 3 1  ON 51
ci_53                -1.356735e-03 3 1  ON 52
ci_54                -1.344455e-03 3 1  ON 53
ci_55                -1.295275e-03 3 1  ON 54
ci_56                 1.525894e-03 3 1  ON 55
ci_57                 1.356920e-03 3 1  ON 56
ci_58                -1.221870e-03 3 1  ON 57
ci_59                -1.205815e-03 3 1  ON 58
ci_60                 1.081328e-03 3 1  ON 59
ci_61                 1.177463e-03 3 1  ON 60
ci_62                -9.793611e-04 3 1  ON 61
ci_63                -9.874067e-04 3 1  ON 62
ci_64                -9.973533e-04 3 1  ON 63
ci_65                -9.811572e-04 3 1  ON 64
ci_66                -1.003412e-03 3 1  ON 65
ci_67                -9.689275e-04 3 1  ON 66
ci_68                 4.986857e-04 3 1  ON 67
ci_69                 6.103243e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7647
    reference variance = 0.979745
====================================================
  Execution time = 2.5350e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 5.0858e-01
  Total weights = 1.9630e+06
  Execution time = 3.5986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494107919499
                                         uncertainty =       0.002591551756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494107919499
                                         uncertainty =       0.002591551756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497057165
  error estimate for blocks of size 2^( 2) =       0.000518324218
  error estimate for blocks of size 2^( 3) =       0.000538416090
  error estimate for blocks of size 2^( 4) =       0.000553329072
  error estimate for blocks of size 2^( 5) =       0.000562983094
  error estimate for blocks of size 2^( 6) =       0.000566765619
  error estimate for blocks of size 2^( 7) =       0.000569727003

      target function =      -0.701032775857
              le_mean =     -22.814222886959
             les_mean =     520.997424905935
             stat err =       0.000563201197
             autocorr =       1.283850518906
   target nu stat err =       0.000563201197
   target dn stat err =       0.003224310177
      target stat err =       0.002271272766
              std dev =       0.702944984411
             le_variance =       0.494131651108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493882452291
                                         uncertainty =       0.002587585706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493882452291
                                         uncertainty =       0.002587585706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496943857
  error estimate for blocks of size 2^( 2) =       0.000518205958
  error estimate for blocks of size 2^( 3) =       0.000538293950
  error estimate for blocks of size 2^( 4) =       0.000553206347
  error estimate for blocks of size 2^( 5) =       0.000562859135
  error estimate for blocks of size 2^( 6) =       0.000566644558
  error estimate for blocks of size 2^( 7) =       0.000569606114

      target function =      -0.701222660699
              le_mean =     -22.814223564974
             les_mean =     520.997178138545
             stat err =       0.000563079038
             autocorr =       1.283878916969
   target nu stat err =       0.000563079038
   target dn stat err =       0.003221113053
      target stat err =       0.002270319069
              std dev =       0.702784742507
             le_variance =       0.493906394301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493994514631
                                         uncertainty =       0.002589555147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493994514631
                                         uncertainty =       0.002589555147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497000177
  error estimate for blocks of size 2^( 2) =       0.000518264743
  error estimate for blocks of size 2^( 3) =       0.000538354669
  error estimate for blocks of size 2^( 4) =       0.000553267357
  error estimate for blocks of size 2^( 5) =       0.000562920768
  error estimate for blocks of size 2^( 6) =       0.000566704742
  error estimate for blocks of size 2^( 7) =       0.000569666209

      target function =      -0.701132521744
              le_mean =     -22.814223185317
             les_mean =     520.997292624138
             stat err =       0.000563139769
             autocorr =       1.283864853901
   target nu stat err =       0.000563139769
   target dn stat err =       0.003222437139
      target stat err =       0.002270644061
              std dev =       0.702864390803
             le_variance =       0.494018351859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494093698519
                                         uncertainty =       0.002591301162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494093698519
                                         uncertainty =       0.002591301162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497050019
  error estimate for blocks of size 2^( 2) =       0.000518316761
  error estimate for blocks of size 2^( 3) =       0.000538408389
  error estimate for blocks of size 2^( 4) =       0.000553321335
  error estimate for blocks of size 2^( 5) =       0.000562975281
  error estimate for blocks of size 2^( 6) =       0.000566757987
  error estimate for blocks of size 2^( 7) =       0.000569719381

      target function =      -0.701045872541
              le_mean =     -22.814222919608
             les_mean =     520.997407237255
             stat err =       0.000563193496
             autocorr =       1.283852322372
   target nu stat err =       0.000563193496
   target dn stat err =       0.003224033507
      target stat err =       0.002271169928
              std dev =       0.702934878458
             le_variance =       0.494117443353


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.701032775857        initial
     1.0000e+01     1.0000e+02             1.4462e-04        -0.701222660699  <--
     4.0000e+01     4.0000e+02             3.6283e-05        -0.701132521744
     1.6000e+02     1.6000e+03             9.0789e-06        -0.701045872541

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 4.3396e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.567535e-01 3 1  ON 0
ci_02                -5.182538e-02 3 1  ON 1
ci_03                -5.195795e-02 3 1  ON 2
ci_04                 5.021336e-02 3 1  ON 3
ci_05                -3.635550e-02 3 1  ON 4
ci_06                -3.639505e-02 3 1  ON 5
ci_07                 2.991460e-02 3 1  ON 6
ci_08                -1.581531e-02 3 1  ON 7
ci_09                -1.570507e-02 3 1  ON 8
ci_10                -1.557057e-02 3 1  ON 9
ci_11                 1.544721e-02 3 1  ON 10
ci_12                 1.207974e-02 3 1  ON 11
ci_13                 1.267942e-02 3 1  ON 12
ci_14                 1.278883e-02 3 1  ON 13
ci_15                 1.123598e-02 3 1  ON 14
ci_16                 1.118148e-02 3 1  ON 15
ci_17                -1.086485e-02 3 1  ON 16
ci_18                -1.099210e-02 3 1  ON 17
ci_19                 1.112056e-02 3 1  ON 18
ci_20                 9.768266e-03 3 1  ON 19
ci_21                 9.821655e-03 3 1  ON 20
ci_22                 9.707877e-03 3 1  ON 21
ci_23                 6.333948e-03 3 1  ON 22
ci_24                 5.091195e-03 3 1  ON 23
ci_25                 4.674521e-03 3 1  ON 24
ci_26                 4.438259e-03 3 1  ON 25
ci_27                 4.491213e-03 3 1  ON 26
ci_28                 3.734563e-03 3 1  ON 27
ci_29                 3.748634e-03 3 1  ON 28
ci_30                -3.372664e-03 3 1  ON 29
ci_31                -3.271126e-03 3 1  ON 30
ci_32                -2.832429e-03 3 1  ON 31
ci_33                -2.863257e-03 3 1  ON 32
ci_34                 2.298598e-03 3 1  ON 33
ci_35                 2.405092e-03 3 1  ON 34
ci_36                -2.299114e-03 3 1  ON 35
ci_37                -2.283410e-03 3 1  ON 36
ci_38                -1.823473e-03 3 1  ON 37
ci_39                -1.765220e-03 3 1  ON 38
ci_40                -1.960180e-03 3 1  ON 39
ci_41                -1.715450e-03 3 1  ON 40
ci_42                -1.770105e-03 3 1  ON 41
ci_43                -2.132053e-03 3 1  ON 42
ci_44                -1.897478e-03 3 1  ON 43
ci_45                -1.569169e-03 3 1  ON 44
ci_46                -1.604138e-03 3 1  ON 45
ci_47                -1.378694e-03 3 1  ON 46
ci_48                -1.384433e-03 3 1  ON 47
ci_49                -1.617841e-03 3 1  ON 48
ci_50                -1.518815e-03 3 1  ON 49
ci_51                 1.452025e-03 3 1  ON 50
ci_52                 1.374321e-03 3 1  ON 51
ci_53                -1.356285e-03 3 1  ON 52
ci_54                -1.339732e-03 3 1  ON 53
ci_55                -1.292895e-03 3 1  ON 54
ci_56                 1.530713e-03 3 1  ON 55
ci_57                 1.357868e-03 3 1  ON 56
ci_58                -1.216905e-03 3 1  ON 57
ci_59                -1.203328e-03 3 1  ON 58
ci_60                 1.084183e-03 3 1  ON 59
ci_61                 1.169613e-03 3 1  ON 60
ci_62                -9.808252e-04 3 1  ON 61
ci_63                -9.828995e-04 3 1  ON 62
ci_64                -9.993333e-04 3 1  ON 63
ci_65                -9.768067e-04 3 1  ON 64
ci_66                -1.004647e-03 3 1  ON 65
ci_67                -9.664413e-04 3 1  ON 66
ci_68                 4.957296e-04 3 1  ON 67
ci_69                 5.998333e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3585e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.838
    reference variance = 0.301114
====================================================
  Execution time = 2.5777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.0836e-01
  Total weights = 1.963101809e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5691e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492641967962
                                         uncertainty =       0.002199806809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492641967962
                                         uncertainty =       0.002199806809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496306585
  error estimate for blocks of size 2^( 2) =       0.000517801541
  error estimate for blocks of size 2^( 3) =       0.000537404655
  error estimate for blocks of size 2^( 4) =       0.000553399948
  error estimate for blocks of size 2^( 5) =       0.000562931318
  error estimate for blocks of size 2^( 6) =       0.000567610155
  error estimate for blocks of size 2^( 7) =       0.000569110384

      target function =      -0.701218148432
              le_mean =     -22.812142003653
             les_mean =     520.902183777640
             stat err =       0.000563262951
             autocorr =       1.288019083262
   target nu stat err =       0.000563262951
   target dn stat err =       0.002870029699
      target stat err =       0.002032307960
              std dev =       0.701883503843
             le_variance =       0.492640452967


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281214200365e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.701223227324       residual = 7.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701461687103       residual = 9.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.701499192537       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.701504447233       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.701505886245       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.701506419712       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.701506576332       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.701506602436       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.701506606610       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.701506605685       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.701506606683       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 5.574819e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.701223227324       residual = 7.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701283647472       residual = 9.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.701293101094       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.701294418079       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.701294776481       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.701294908031       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.701294946214       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.701294952588       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.701294953605       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.701294953376       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.701294953621       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.413487e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.701223227324       residual = 7.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.701238383514       residual = 9.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.701240751776       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.701241081222       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.701241170733       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.701241203505       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.701241212990       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.701241214574       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.701241214826       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.701241214769       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.701241214830       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 3.546293e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.505382 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0356e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.566329e-01 3 1  ON 0
ci_02                -5.170320e-02 3 1  ON 1
ci_03                -5.183886e-02 3 1  ON 2
ci_04                 5.007201e-02 3 1  ON 3
ci_05                -3.626862e-02 3 1  ON 4
ci_06                -3.631308e-02 3 1  ON 5
ci_07                 2.990151e-02 3 1  ON 6
ci_08                -1.576168e-02 3 1  ON 7
ci_09                -1.567219e-02 3 1  ON 8
ci_10                -1.553422e-02 3 1  ON 9
ci_11                 1.542820e-02 3 1  ON 10
ci_12                 1.204765e-02 3 1  ON 11
ci_13                 1.268095e-02 3 1  ON 12
ci_14                 1.278832e-02 3 1  ON 13
ci_15                 1.121326e-02 3 1  ON 14
ci_16                 1.116089e-02 3 1  ON 15
ci_17                -1.084787e-02 3 1  ON 16
ci_18                -1.097238e-02 3 1  ON 17
ci_19                 1.111013e-02 3 1  ON 18
ci_20                 9.751489e-03 3 1  ON 19
ci_21                 9.816978e-03 3 1  ON 20
ci_22                 9.705470e-03 3 1  ON 21
ci_23                 6.322097e-03 3 1  ON 22
ci_24                 5.084473e-03 3 1  ON 23
ci_25                 4.665138e-03 3 1  ON 24
ci_26                 4.428237e-03 3 1  ON 25
ci_27                 4.483847e-03 3 1  ON 26
ci_28                 3.727114e-03 3 1  ON 27
ci_29                 3.739349e-03 3 1  ON 28
ci_30                -3.366024e-03 3 1  ON 29
ci_31                -3.269961e-03 3 1  ON 30
ci_32                -2.817401e-03 3 1  ON 31
ci_33                -2.850381e-03 3 1  ON 32
ci_34                 2.292198e-03 3 1  ON 33
ci_35                 2.390310e-03 3 1  ON 34
ci_36                -2.291125e-03 3 1  ON 35
ci_37                -2.280446e-03 3 1  ON 36
ci_38                -1.817859e-03 3 1  ON 37
ci_39                -1.759858e-03 3 1  ON 38
ci_40                -1.962490e-03 3 1  ON 39
ci_41                -1.708163e-03 3 1  ON 40
ci_42                -1.763239e-03 3 1  ON 41
ci_43                -2.130054e-03 3 1  ON 42
ci_44                -1.893924e-03 3 1  ON 43
ci_45                -1.565528e-03 3 1  ON 44
ci_46                -1.600245e-03 3 1  ON 45
ci_47                -1.375876e-03 3 1  ON 46
ci_48                -1.375999e-03 3 1  ON 47
ci_49                -1.615034e-03 3 1  ON 48
ci_50                -1.515296e-03 3 1  ON 49
ci_51                 1.443427e-03 3 1  ON 50
ci_52                 1.369754e-03 3 1  ON 51
ci_53                -1.352606e-03 3 1  ON 52
ci_54                -1.332429e-03 3 1  ON 53
ci_55                -1.287022e-03 3 1  ON 54
ci_56                 1.526000e-03 3 1  ON 55
ci_57                 1.363268e-03 3 1  ON 56
ci_58                -1.216719e-03 3 1  ON 57
ci_59                -1.204263e-03 3 1  ON 58
ci_60                 1.082549e-03 3 1  ON 59
ci_61                 1.169246e-03 3 1  ON 60
ci_62                -9.778228e-04 3 1  ON 61
ci_63                -9.761177e-04 3 1  ON 62
ci_64                -9.953395e-04 3 1  ON 63
ci_65                -9.702231e-04 3 1  ON 64
ci_66                -1.005897e-03 3 1  ON 65
ci_67                -9.658419e-04 3 1  ON 66
ci_68                 4.842573e-04 3 1  ON 67
ci_69                 5.959521e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8361
    reference variance = 0.288911
====================================================
  Execution time = 2.4968e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.1043e-01
  Total weights = 1.9631e+06
  Execution time = 3.5858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492619406731
                                         uncertainty =       0.002709629014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492619406731
                                         uncertainty =       0.002709629014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496254321
  error estimate for blocks of size 2^( 2) =       0.000516948350
  error estimate for blocks of size 2^( 3) =       0.000536506096
  error estimate for blocks of size 2^( 4) =       0.000551293017
  error estimate for blocks of size 2^( 5) =       0.000561650301
  error estimate for blocks of size 2^( 6) =       0.000566722595
  error estimate for blocks of size 2^( 7) =       0.000571451086

      target function =      -0.696843696100
              le_mean =     -22.813245081418
             les_mean =     520.958946501348
             stat err =       0.000562779250
             autocorr =       1.286078711930
   target nu stat err =       0.000562779250
   target dn stat err =       0.006050285768
      target stat err =       0.004116977716
              std dev =       0.701809591668
             le_variance =       0.492536702957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491734712770
                                         uncertainty =       0.002685174977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491734712770
                                         uncertainty =       0.002685174977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495808867
  error estimate for blocks of size 2^( 2) =       0.000516485055
  error estimate for blocks of size 2^( 3) =       0.000536031318
  error estimate for blocks of size 2^( 4) =       0.000550812172
  error estimate for blocks of size 2^( 5) =       0.000561171129
  error estimate for blocks of size 2^( 6) =       0.000566243336
  error estimate for blocks of size 2^( 7) =       0.000570967629

      target function =      -0.679923219534
              le_mean =     -22.813249235582
             les_mean =     520.984040630420
             stat err =       0.000562298566
             autocorr =       1.286190726537
   target nu stat err =       0.000562298566
   target dn stat err =       0.029875336871
      target stat err =       0.019205654092
              std dev =       0.701179623972
             le_variance =       0.491652865073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492162047478
                                         uncertainty =       0.002696821724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492162047478
                                         uncertainty =       0.002696821724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496024089
  error estimate for blocks of size 2^( 2) =       0.000516709079
  error estimate for blocks of size 2^( 3) =       0.000536260260
  error estimate for blocks of size 2^( 4) =       0.000551044855
  error estimate for blocks of size 2^( 5) =       0.000561404350
  error estimate for blocks of size 2^( 6) =       0.000566477893
  error estimate for blocks of size 2^( 7) =       0.000571200612

      target function =      -0.699485126889
              le_mean =     -22.813247604090
             les_mean =     520.955173611801
             stat err =       0.000562531928
             autocorr =       1.286141694628
   target nu stat err =       0.000562531928
   target dn stat err =       0.004744172430
      target stat err =       0.003270107097
              std dev =       0.701483993522
             le_variance =       0.492079793168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492561485903
                                         uncertainty =       0.002707996935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492561485903
                                         uncertainty =       0.002707996935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496225170
  error estimate for blocks of size 2^( 2) =       0.000516918062
  error estimate for blocks of size 2^( 3) =       0.000536475054
  error estimate for blocks of size 2^( 4) =       0.000551261694
  error estimate for blocks of size 2^( 5) =       0.000561619343
  error estimate for blocks of size 2^( 6) =       0.000566691932
  error estimate for blocks of size 2^( 7) =       0.000571420370

      target function =      -0.697447995774
              le_mean =     -22.813245412116
             les_mean =     520.958069549883
             stat err =       0.000562748335
             autocorr =       1.286088510646
   target nu stat err =       0.000562748335
   target dn stat err =       0.005772076241
      target stat err =       0.003937800878
              std dev =       0.701768365662
             le_variance =       0.492478839044


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.696843696100        initial
     2.5000e+00     2.5000e+01             5.5748e-04        -0.679923219534
     1.0000e+01     1.0000e+02             1.4135e-04        -0.699485126889  <--
     4.0000e+01     4.0000e+02             3.5463e-05        -0.697447995774

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 4.5379e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.566329e-01 3 1  ON 0
ci_02                -5.170320e-02 3 1  ON 1
ci_03                -5.183886e-02 3 1  ON 2
ci_04                 5.007201e-02 3 1  ON 3
ci_05                -3.626862e-02 3 1  ON 4
ci_06                -3.631308e-02 3 1  ON 5
ci_07                 2.990151e-02 3 1  ON 6
ci_08                -1.576168e-02 3 1  ON 7
ci_09                -1.567219e-02 3 1  ON 8
ci_10                -1.553422e-02 3 1  ON 9
ci_11                 1.542820e-02 3 1  ON 10
ci_12                 1.204765e-02 3 1  ON 11
ci_13                 1.268095e-02 3 1  ON 12
ci_14                 1.278832e-02 3 1  ON 13
ci_15                 1.121326e-02 3 1  ON 14
ci_16                 1.116089e-02 3 1  ON 15
ci_17                -1.084787e-02 3 1  ON 16
ci_18                -1.097238e-02 3 1  ON 17
ci_19                 1.111013e-02 3 1  ON 18
ci_20                 9.751489e-03 3 1  ON 19
ci_21                 9.816978e-03 3 1  ON 20
ci_22                 9.705470e-03 3 1  ON 21
ci_23                 6.322097e-03 3 1  ON 22
ci_24                 5.084473e-03 3 1  ON 23
ci_25                 4.665138e-03 3 1  ON 24
ci_26                 4.428237e-03 3 1  ON 25
ci_27                 4.483847e-03 3 1  ON 26
ci_28                 3.727114e-03 3 1  ON 27
ci_29                 3.739349e-03 3 1  ON 28
ci_30                -3.366024e-03 3 1  ON 29
ci_31                -3.269961e-03 3 1  ON 30
ci_32                -2.817401e-03 3 1  ON 31
ci_33                -2.850381e-03 3 1  ON 32
ci_34                 2.292198e-03 3 1  ON 33
ci_35                 2.390310e-03 3 1  ON 34
ci_36                -2.291125e-03 3 1  ON 35
ci_37                -2.280446e-03 3 1  ON 36
ci_38                -1.817859e-03 3 1  ON 37
ci_39                -1.759858e-03 3 1  ON 38
ci_40                -1.962490e-03 3 1  ON 39
ci_41                -1.708163e-03 3 1  ON 40
ci_42                -1.763239e-03 3 1  ON 41
ci_43                -2.130054e-03 3 1  ON 42
ci_44                -1.893924e-03 3 1  ON 43
ci_45                -1.565528e-03 3 1  ON 44
ci_46                -1.600245e-03 3 1  ON 45
ci_47                -1.375876e-03 3 1  ON 46
ci_48                -1.375999e-03 3 1  ON 47
ci_49                -1.615034e-03 3 1  ON 48
ci_50                -1.515296e-03 3 1  ON 49
ci_51                 1.443427e-03 3 1  ON 50
ci_52                 1.369754e-03 3 1  ON 51
ci_53                -1.352606e-03 3 1  ON 52
ci_54                -1.332429e-03 3 1  ON 53
ci_55                -1.287022e-03 3 1  ON 54
ci_56                 1.526000e-03 3 1  ON 55
ci_57                 1.363268e-03 3 1  ON 56
ci_58                -1.216719e-03 3 1  ON 57
ci_59                -1.204263e-03 3 1  ON 58
ci_60                 1.082549e-03 3 1  ON 59
ci_61                 1.169246e-03 3 1  ON 60
ci_62                -9.778228e-04 3 1  ON 61
ci_63                -9.761177e-04 3 1  ON 62
ci_64                -9.953395e-04 3 1  ON 63
ci_65                -9.702231e-04 3 1  ON 64
ci_66                -1.005897e-03 3 1  ON 65
ci_67                -9.658419e-04 3 1  ON 66
ci_68                 4.842573e-04 3 1  ON 67
ci_69                 5.959521e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5740e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.9265
    reference variance = 0.774309
====================================================
  Execution time = 2.5635e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5326e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.1521e-01
  Total weights = 1.963028174e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495760261108
                                         uncertainty =       0.002912627445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495760261108
                                         uncertainty =       0.002912627445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497858311
  error estimate for blocks of size 2^( 2) =       0.000519598686
  error estimate for blocks of size 2^( 3) =       0.000539190185
  error estimate for blocks of size 2^( 4) =       0.000554585256
  error estimate for blocks of size 2^( 5) =       0.000564035759
  error estimate for blocks of size 2^( 6) =       0.000570169971
  error estimate for blocks of size 2^( 7) =       0.000574982278

      target function =      -0.696575032207
              le_mean =     -22.813142636735
             les_mean =     520.954690465425
             stat err =       0.000565943316
             autocorr =       1.292213718044
   target nu stat err =       0.000565943316
   target dn stat err =       0.003977018810
      target stat err =       0.002735259836
              std dev =       0.704077975872
             le_variance =       0.495725796107


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281314263674e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696585083360       residual = 7.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696820419545       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696845088743       residual = 7.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696866108658       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696869502945       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696870754909       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696870987979       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696871106532       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696871101635       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696871100782       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696871101058       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.696871101331       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 5.593777e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696585083360       residual = 7.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696644706033       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696650918729       residual = 7.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696656225892       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696657076922       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696657388748       residual = 9.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696657445695       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696657474677       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696657473431       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696657473217       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696657473290       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.696657473356       residual = 9.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.418431e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.696585083360       residual = 7.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696600039121       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696601595146       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696602925229       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696603138137       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696603216017       residual = 9.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696603230170       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696603237374       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696603237061       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696603237007       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696603237026       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 3.558401e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.509911 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0212e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.565224e-01 3 1  ON 0
ci_02                -5.157560e-02 3 1  ON 1
ci_03                -5.171622e-02 3 1  ON 2
ci_04                 4.993017e-02 3 1  ON 3
ci_05                -3.618806e-02 3 1  ON 4
ci_06                -3.623244e-02 3 1  ON 5
ci_07                 2.988630e-02 3 1  ON 6
ci_08                -1.570558e-02 3 1  ON 7
ci_09                -1.564715e-02 3 1  ON 8
ci_10                -1.549738e-02 3 1  ON 9
ci_11                 1.541912e-02 3 1  ON 10
ci_12                 1.202251e-02 3 1  ON 11
ci_13                 1.268195e-02 3 1  ON 12
ci_14                 1.278851e-02 3 1  ON 13
ci_15                 1.118542e-02 3 1  ON 14
ci_16                 1.113821e-02 3 1  ON 15
ci_17                -1.082931e-02 3 1  ON 16
ci_18                -1.095292e-02 3 1  ON 17
ci_19                 1.109304e-02 3 1  ON 18
ci_20                 9.730826e-03 3 1  ON 19
ci_21                 9.817772e-03 3 1  ON 20
ci_22                 9.699313e-03 3 1  ON 21
ci_23                 6.311872e-03 3 1  ON 22
ci_24                 5.085559e-03 3 1  ON 23
ci_25                 4.651339e-03 3 1  ON 24
ci_26                 4.428259e-03 3 1  ON 25
ci_27                 4.469960e-03 3 1  ON 26
ci_28                 3.720575e-03 3 1  ON 27
ci_29                 3.731626e-03 3 1  ON 28
ci_30                -3.354365e-03 3 1  ON 29
ci_31                -3.255903e-03 3 1  ON 30
ci_32                -2.798496e-03 3 1  ON 31
ci_33                -2.836578e-03 3 1  ON 32
ci_34                 2.285469e-03 3 1  ON 33
ci_35                 2.384576e-03 3 1  ON 34
ci_36                -2.283136e-03 3 1  ON 35
ci_37                -2.277424e-03 3 1  ON 36
ci_38                -1.812776e-03 3 1  ON 37
ci_39                -1.751785e-03 3 1  ON 38
ci_40                -1.962068e-03 3 1  ON 39
ci_41                -1.705795e-03 3 1  ON 40
ci_42                -1.757079e-03 3 1  ON 41
ci_43                -2.128738e-03 3 1  ON 42
ci_44                -1.898074e-03 3 1  ON 43
ci_45                -1.557032e-03 3 1  ON 44
ci_46                -1.592916e-03 3 1  ON 45
ci_47                -1.362346e-03 3 1  ON 46
ci_48                -1.372907e-03 3 1  ON 47
ci_49                -1.609965e-03 3 1  ON 48
ci_50                -1.511656e-03 3 1  ON 49
ci_51                 1.438046e-03 3 1  ON 50
ci_52                 1.364457e-03 3 1  ON 51
ci_53                -1.355298e-03 3 1  ON 52
ci_54                -1.331453e-03 3 1  ON 53
ci_55                -1.279033e-03 3 1  ON 54
ci_56                 1.532059e-03 3 1  ON 55
ci_57                 1.367977e-03 3 1  ON 56
ci_58                -1.216658e-03 3 1  ON 57
ci_59                -1.201780e-03 3 1  ON 58
ci_60                 1.079192e-03 3 1  ON 59
ci_61                 1.162790e-03 3 1  ON 60
ci_62                -9.748294e-04 3 1  ON 61
ci_63                -9.713107e-04 3 1  ON 62
ci_64                -9.957611e-04 3 1  ON 63
ci_65                -9.637149e-04 3 1  ON 64
ci_66                -1.001992e-03 3 1  ON 65
ci_67                -9.613877e-04 3 1  ON 66
ci_68                 4.807912e-04 3 1  ON 67
ci_69                 5.871768e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8029
    reference variance = 0.436609
====================================================
  Execution time = 2.5075e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.0577e-01
  Total weights = 1.9630e+06
  Execution time = 3.5704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0041345
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491158638307
                                         uncertainty =       0.002976054913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491158638307
                                         uncertainty =       0.002976054913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495528779
  error estimate for blocks of size 2^( 2) =       0.000516837930
  error estimate for blocks of size 2^( 3) =       0.000536389350
  error estimate for blocks of size 2^( 4) =       0.000551468674
  error estimate for blocks of size 2^( 5) =       0.000561010687
  error estimate for blocks of size 2^( 6) =       0.000566304524
  error estimate for blocks of size 2^( 7) =       0.000569008546

      target function =      -0.702780390200
              le_mean =     -22.812503950973
             les_mean =     520.916415539739
             stat err =       0.000561948108
             autocorr =       1.286040546545
   target nu stat err =       0.000561948108
   target dn stat err =       0.003347333287
      target stat err =       0.002358459315
              std dev =       0.700783520187
             le_variance =       0.491097542166

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00020983
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490273865741
                                         uncertainty =       0.002967122687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490273865741
                                         uncertainty =       0.002967122687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495082665
  error estimate for blocks of size 2^( 2) =       0.000516376003
  error estimate for blocks of size 2^( 3) =       0.000535914973
  error estimate for blocks of size 2^( 4) =       0.000550988273
  error estimate for blocks of size 2^( 5) =       0.000560522847
  error estimate for blocks of size 2^( 6) =       0.000565811120
  error estimate for blocks of size 2^( 7) =       0.000568532319

      target function =      -0.703333635105
              le_mean =     -22.812507843948
             les_mean =     520.915786549006
             stat err =       0.000561463640
             autocorr =       1.286138780419
   target nu stat err =       0.000561463640
   target dn stat err =       0.003348339485
      target stat err =       0.002362648646
              std dev =       0.700152619222
             le_variance =       0.490213690203

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00418709
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490705285843
                                         uncertainty =       0.002971356080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490705285843
                                         uncertainty =       0.002971356080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495300241
  error estimate for blocks of size 2^( 2) =       0.000516601405
  error estimate for blocks of size 2^( 3) =       0.000536146419
  error estimate for blocks of size 2^( 4) =       0.000551222662
  error estimate for blocks of size 2^( 5) =       0.000560760790
  error estimate for blocks of size 2^( 6) =       0.000566051817
  error estimate for blocks of size 2^( 7) =       0.000568764396

      target function =      -0.703165840646
              le_mean =     -22.812505261467
             les_mean =     520.915913323606
             stat err =       0.000561699916
             autocorr =       1.286090821370
   target nu stat err =       0.000561699916
   target dn stat err =       0.003328037685
      target stat err =       0.002348050879
              std dev =       0.700460318852
             le_variance =       0.490644658287

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0116902
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491101179510
                                         uncertainty =       0.002975444888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491101179510
                                         uncertainty =       0.002975444888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495499820
  error estimate for blocks of size 2^( 2) =       0.000516807965
  error estimate for blocks of size 2^( 3) =       0.000536358579
  error estimate for blocks of size 2^( 4) =       0.000551437512
  error estimate for blocks of size 2^( 5) =       0.000560979033
  error estimate for blocks of size 2^( 6) =       0.000566272491
  error estimate for blocks of size 2^( 7) =       0.000568977585

      target function =      -0.702840831567
              le_mean =     -22.812504040988
             les_mean =     520.916331480864
             stat err =       0.000561916655
             autocorr =       1.286046903872
   target nu stat err =       0.000561916655
   target dn stat err =       0.003343648824
      target stat err =       0.002356390947
              std dev =       0.700742565026
             le_variance =       0.491040142439


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.702780390200        initial
     2.5000e+00     2.5000e+01             5.5938e-04        -0.703333635105  <--
     1.0000e+01     1.0000e+02             1.4184e-04        -0.703165840646
     4.0000e+01     4.0000e+02             3.5584e-05        -0.702840831567

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 4.2987e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.561943e-01 3 1  ON 0
ci_02                -5.119905e-02 3 1  ON 1
ci_03                -5.135412e-02 3 1  ON 2
ci_04                 4.951264e-02 3 1  ON 3
ci_05                -3.595052e-02 3 1  ON 4
ci_06                -3.599475e-02 3 1  ON 5
ci_07                 2.984123e-02 3 1  ON 6
ci_08                -1.554026e-02 3 1  ON 7
ci_09                -1.557323e-02 3 1  ON 8
ci_10                -1.538842e-02 3 1  ON 9
ci_11                 1.539240e-02 3 1  ON 10
ci_12                 1.194842e-02 3 1  ON 11
ci_13                 1.268498e-02 3 1  ON 12
ci_14                 1.278915e-02 3 1  ON 13
ci_15                 1.110298e-02 3 1  ON 14
ci_16                 1.107122e-02 3 1  ON 15
ci_17                -1.077444e-02 3 1  ON 16
ci_18                -1.089531e-02 3 1  ON 17
ci_19                 1.104285e-02 3 1  ON 18
ci_20                 9.669958e-03 3 1  ON 19
ci_21                 9.820185e-03 3 1  ON 20
ci_22                 9.681021e-03 3 1  ON 21
ci_23                 6.281771e-03 3 1  ON 22
ci_24                 5.088732e-03 3 1  ON 23
ci_25                 4.610746e-03 3 1  ON 24
ci_26                 4.428386e-03 3 1  ON 25
ci_27                 4.429079e-03 3 1  ON 26
ci_28                 3.701114e-03 3 1  ON 27
ci_29                 3.708749e-03 3 1  ON 28
ci_30                -3.319878e-03 3 1  ON 29
ci_31                -3.214104e-03 3 1  ON 30
ci_32                -2.742997e-03 3 1  ON 31
ci_33                -2.796105e-03 3 1  ON 32
ci_34                 2.265803e-03 3 1  ON 33
ci_35                 2.367915e-03 3 1  ON 34
ci_36                -2.259557e-03 3 1  ON 35
ci_37                -2.268463e-03 3 1  ON 36
ci_38                -1.797815e-03 3 1  ON 37
ci_39                -1.727964e-03 3 1  ON 38
ci_40                -1.960812e-03 3 1  ON 39
ci_41                -1.698896e-03 3 1  ON 40
ci_42                -1.739147e-03 3 1  ON 41
ci_43                -2.124691e-03 3 1  ON 42
ci_44                -1.910212e-03 3 1  ON 43
ci_45                -1.532044e-03 3 1  ON 44
ci_46                -1.571276e-03 3 1  ON 45
ci_47                -1.322133e-03 3 1  ON 46
ci_48                -1.363619e-03 3 1  ON 47
ci_49                -1.595031e-03 3 1  ON 48
ci_50                -1.500956e-03 3 1  ON 49
ci_51                 1.422145e-03 3 1  ON 50
ci_52                 1.348815e-03 3 1  ON 51
ci_53                -1.363155e-03 3 1  ON 52
ci_54                -1.328573e-03 3 1  ON 53
ci_55                -1.255508e-03 3 1  ON 54
ci_56                 1.549854e-03 3 1  ON 55
ci_57                 1.381843e-03 3 1  ON 56
ci_58                -1.216453e-03 3 1  ON 57
ci_59                -1.194492e-03 3 1  ON 58
ci_60                 1.069229e-03 3 1  ON 59
ci_61                 1.143608e-03 3 1  ON 60
ci_62                -9.659578e-04 3 1  ON 61
ci_63                -9.571258e-04 3 1  ON 62
ci_64                -9.970140e-04 3 1  ON 63
ci_65                -9.445063e-04 3 1  ON 64
ci_66                -9.905344e-04 3 1  ON 65
ci_67                -9.482550e-04 3 1  ON 66
ci_68                 4.705046e-04 3 1  ON 67
ci_69                 5.611964e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3209e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8362
    reference variance = 0.405362
====================================================
  Execution time = 2.5675e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.2359e-01
  Total weights = 1.963189888e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6015e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500332581862
                                         uncertainty =       0.009037088165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500332581862
                                         uncertainty =       0.009037088165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500191694
  error estimate for blocks of size 2^( 2) =       0.000521078257
  error estimate for blocks of size 2^( 3) =       0.000540657748
  error estimate for blocks of size 2^( 4) =       0.000555170741
  error estimate for blocks of size 2^( 5) =       0.000565221843
  error estimate for blocks of size 2^( 6) =       0.000568670978
  error estimate for blocks of size 2^( 7) =       0.000571343539

      target function =      -0.690896662497
              le_mean =     -22.813466370647
             les_mean =     520.977834256052
             stat err =       0.000565101775
             autocorr =       1.276381181364
   target nu stat err =       0.000565101775
   target dn stat err =       0.011865516844
      target stat err =       0.007888863578
              std dev =       0.707377876819
             le_variance =       0.500383460613


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281346637065e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.690986672468       residual = 7.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.691943325354       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.692086496833       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.692106936594       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.692113372337       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.692117674237       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.692119414177       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.692119389863       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.692119335465       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.692119325052       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.692119339752       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 2.147609e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.690986672468       residual = 7.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.691238240759       residual = 9.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.691275159209       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.691280295531       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.691281881511       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.691282915400       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.691283322429       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.691283313812       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.691283300368       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.691283298067       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.691283301463       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 5.664605e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.690986672468       residual = 7.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.691050389130       residual = 9.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.691059690534       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.691060975654       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.691061370425       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.691061626064       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.691061725992       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.691061723685       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.691061720339       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.691061719784       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.691061720615       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.435867e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.518983 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0294e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.556639e-01 3 1  ON 0
ci_02                -5.074248e-02 3 1  ON 1
ci_03                -5.079810e-02 3 1  ON 2
ci_04                 4.894618e-02 3 1  ON 3
ci_05                -3.575005e-02 3 1  ON 4
ci_06                -3.563165e-02 3 1  ON 5
ci_07                 2.977218e-02 3 1  ON 6
ci_08                -1.533971e-02 3 1  ON 7
ci_09                -1.543063e-02 3 1  ON 8
ci_10                -1.526297e-02 3 1  ON 9
ci_11                 1.532936e-02 3 1  ON 10
ci_12                 1.186306e-02 3 1  ON 11
ci_13                 1.270159e-02 3 1  ON 12
ci_14                 1.273297e-02 3 1  ON 13
ci_15                 1.100899e-02 3 1  ON 14
ci_16                 1.098219e-02 3 1  ON 15
ci_17                -1.077117e-02 3 1  ON 16
ci_18                -1.076750e-02 3 1  ON 17
ci_19                 1.098445e-02 3 1  ON 18
ci_20                 9.598034e-03 3 1  ON 19
ci_21                 9.773649e-03 3 1  ON 20
ci_22                 9.683241e-03 3 1  ON 21
ci_23                 6.258994e-03 3 1  ON 22
ci_24                 5.069144e-03 3 1  ON 23
ci_25                 4.576328e-03 3 1  ON 24
ci_26                 4.433025e-03 3 1  ON 25
ci_27                 4.403871e-03 3 1  ON 26
ci_28                 3.743576e-03 3 1  ON 27
ci_29                 3.658466e-03 3 1  ON 28
ci_30                -3.265191e-03 3 1  ON 29
ci_31                -3.173620e-03 3 1  ON 30
ci_32                -2.717304e-03 3 1  ON 31
ci_33                -2.731170e-03 3 1  ON 32
ci_34                 2.323674e-03 3 1  ON 33
ci_35                 2.327582e-03 3 1  ON 34
ci_36                -2.252884e-03 3 1  ON 35
ci_37                -2.241174e-03 3 1  ON 36
ci_38                -1.759451e-03 3 1  ON 37
ci_39                -1.695716e-03 3 1  ON 38
ci_40                -1.950892e-03 3 1  ON 39
ci_41                -1.745591e-03 3 1  ON 40
ci_42                -1.689537e-03 3 1  ON 41
ci_43                -2.242782e-03 3 1  ON 42
ci_44                -1.945284e-03 3 1  ON 43
ci_45                -1.524505e-03 3 1  ON 44
ci_46                -1.521931e-03 3 1  ON 45
ci_47                -1.226441e-03 3 1  ON 46
ci_48                -1.309614e-03 3 1  ON 47
ci_49                -1.564502e-03 3 1  ON 48
ci_50                -1.473715e-03 3 1  ON 49
ci_51                 1.367573e-03 3 1  ON 50
ci_52                 1.325960e-03 3 1  ON 51
ci_53                -1.351039e-03 3 1  ON 52
ci_54                -1.303933e-03 3 1  ON 53
ci_55                -1.176597e-03 3 1  ON 54
ci_56                 1.568643e-03 3 1  ON 55
ci_57                 1.387829e-03 3 1  ON 56
ci_58                -1.206256e-03 3 1  ON 57
ci_59                -1.177898e-03 3 1  ON 58
ci_60                 1.116439e-03 3 1  ON 59
ci_61                 1.113252e-03 3 1  ON 60
ci_62                -9.559704e-04 3 1  ON 61
ci_63                -9.091211e-04 3 1  ON 62
ci_64                -1.018132e-03 3 1  ON 63
ci_65                -9.073849e-04 3 1  ON 64
ci_66                -1.006788e-03 3 1  ON 65
ci_67                -9.394594e-04 3 1  ON 66
ci_68                 4.479564e-04 3 1  ON 67
ci_69                 5.944434e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8876
    reference variance = 0.423294
====================================================
  Execution time = 2.4987e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.1142e-01
  Total weights = 1.9632e+06
  Execution time = 3.6166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495215427660
                                         uncertainty =       0.002909228712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495215427660
                                         uncertainty =       0.002909228712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497591656
  error estimate for blocks of size 2^( 2) =       0.000518619951
  error estimate for blocks of size 2^( 3) =       0.000538705697
  error estimate for blocks of size 2^( 4) =       0.000553158679
  error estimate for blocks of size 2^( 5) =       0.000561551666
  error estimate for blocks of size 2^( 6) =       0.000566639860
  error estimate for blocks of size 2^( 7) =       0.000571190178

      target function =      -0.692151819875
              le_mean =     -22.813463252598
             les_mean =     520.975864730965
             stat err =       0.000563135095
             autocorr =       1.280793188485
   target nu stat err =       0.000563135095
   target dn stat err =       0.008784651593
      target stat err =       0.005872547702
              std dev =       0.703700868925
             le_variance =       0.495194912925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492190821689
                                         uncertainty =       0.002884097889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492190821689
                                         uncertainty =       0.002884097889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496069869
  error estimate for blocks of size 2^( 2) =       0.000517032576
  error estimate for blocks of size 2^( 3) =       0.000537081655
  error estimate for blocks of size 2^( 4) =       0.000551512709
  error estimate for blocks of size 2^( 5) =       0.000559943334
  error estimate for blocks of size 2^( 6) =       0.000565068193
  error estimate for blocks of size 2^( 7) =       0.000569634231

      target function =      -0.698704553280
              le_mean =     -22.813491203908
             les_mean =     520.967447654764
             stat err =       0.000561539617
             autocorr =       1.281371627207
   target nu stat err =       0.000561539617
   target dn stat err =       0.003856632045
      target stat err =       0.002672162612
              std dev =       0.701548737252
             le_variance =       0.492170630740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493560598546
                                         uncertainty =       0.002894223428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493560598546
                                         uncertainty =       0.002894223428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496759616
  error estimate for blocks of size 2^( 2) =       0.000517750804
  error estimate for blocks of size 2^( 3) =       0.000537815173
  error estimate for blocks of size 2^( 4) =       0.000552256389
  error estimate for blocks of size 2^( 5) =       0.000560667428
  error estimate for blocks of size 2^( 6) =       0.000565776807
  error estimate for blocks of size 2^( 7) =       0.000570345746

      target function =      -0.691555951564
              le_mean =     -22.813470121343
             les_mean =     520.977060455396
             stat err =       0.000562261592
             autocorr =       1.281103655458
   target nu stat err =       0.000562261592
   target dn stat err =       0.009564446255
      target stat err =       0.006378702603
              std dev =       0.702524186814
             le_variance =       0.493540233059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494995901092
                                         uncertainty =       0.002906930940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494995901092
                                         uncertainty =       0.002906930940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497481360
  error estimate for blocks of size 2^( 2) =       0.000518505175
  error estimate for blocks of size 2^( 3) =       0.000538588728
  error estimate for blocks of size 2^( 4) =       0.000553039899
  error estimate for blocks of size 2^( 5) =       0.000561433898
  error estimate for blocks of size 2^( 6) =       0.000566523114
  error estimate for blocks of size 2^( 7) =       0.000571076855

      target function =      -0.698278933224
              le_mean =     -22.813462696633
             les_mean =     520.966776260089
             stat err =       0.000563018442
             autocorr =       1.280830365708
   target nu stat err =       0.000563018442
   target dn stat err =       0.003630290827
      target stat err =       0.002519264914
              std dev =       0.703544886063
             le_variance =       0.494975406705


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.692151819875        initial
     6.2500e-01     6.2500e+00             2.1476e-03        -0.698704553280  <--
     2.5000e+00     2.5000e+01             5.6646e-04        -0.691555951564
     1.0000e+01     1.0000e+02             1.4359e-04        -0.698278933224

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.3132e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.541322e-01 3 1  ON 0
ci_02                -4.945749e-02 3 1  ON 1
ci_03                -4.923181e-02 3 1  ON 2
ci_04                 4.736503e-02 3 1  ON 3
ci_05                -3.519124e-02 3 1  ON 4
ci_06                -3.461348e-02 3 1  ON 5
ci_07                 2.957549e-02 3 1  ON 6
ci_08                -1.477744e-02 3 1  ON 7
ci_09                -1.502593e-02 3 1  ON 8
ci_10                -1.490796e-02 3 1  ON 9
ci_11                 1.515176e-02 3 1  ON 10
ci_12                 1.162386e-02 3 1  ON 11
ci_13                 1.274958e-02 3 1  ON 12
ci_14                 1.257387e-02 3 1  ON 13
ci_15                 1.074402e-02 3 1  ON 14
ci_16                 1.073107e-02 3 1  ON 15
ci_17                -1.076049e-02 3 1  ON 16
ci_18                -1.040496e-02 3 1  ON 17
ci_19                 1.082252e-02 3 1  ON 18
ci_20                 9.397163e-03 3 1  ON 19
ci_21                 9.640531e-03 3 1  ON 20
ci_22                 9.688660e-03 3 1  ON 21
ci_23                 6.195489e-03 3 1  ON 22
ci_24                 5.013901e-03 3 1  ON 23
ci_25                 4.480156e-03 3 1  ON 24
ci_26                 4.445860e-03 3 1  ON 25
ci_27                 4.333920e-03 3 1  ON 26
ci_28                 3.860340e-03 3 1  ON 27
ci_29                 3.515398e-03 3 1  ON 28
ci_30                -3.107882e-03 3 1  ON 29
ci_31                -3.055996e-03 3 1  ON 30
ci_32                -2.647600e-03 3 1  ON 31
ci_33                -2.551955e-03 3 1  ON 32
ci_34                 2.487970e-03 3 1  ON 33
ci_35                 2.217126e-03 3 1  ON 34
ci_36                -2.233660e-03 3 1  ON 35
ci_37                -2.164307e-03 3 1  ON 36
ci_38                -1.652345e-03 3 1  ON 37
ci_39                -1.605584e-03 3 1  ON 38
ci_40                -1.923204e-03 3 1  ON 39
ci_41                -1.876980e-03 3 1  ON 40
ci_42                -1.552751e-03 3 1  ON 41
ci_43                -2.574328e-03 3 1  ON 42
ci_44                -2.041738e-03 3 1  ON 43
ci_45                -1.502749e-03 3 1  ON 44
ci_46                -1.384405e-03 3 1  ON 45
ci_47                -9.529216e-04 3 1  ON 46
ci_48                -1.154197e-03 3 1  ON 47
ci_49                -1.478841e-03 3 1  ON 48
ci_50                -1.398053e-03 3 1  ON 49
ci_51                 1.215703e-03 3 1  ON 50
ci_52                 1.261705e-03 3 1  ON 51
ci_53                -1.317260e-03 3 1  ON 52
ci_54                -1.234008e-03 3 1  ON 53
ci_55                -9.556594e-04 3 1  ON 54
ci_56                 1.621515e-03 3 1  ON 55
ci_57                 1.404970e-03 3 1  ON 56
ci_58                -1.177679e-03 3 1  ON 57
ci_59                -1.131792e-03 3 1  ON 58
ci_60                 1.252483e-03 3 1  ON 59
ci_61                 1.023496e-03 3 1  ON 60
ci_62                -9.281692e-04 3 1  ON 61
ci_63                -7.756698e-04 3 1  ON 62
ci_64                -1.076397e-03 3 1  ON 63
ci_65                -8.034540e-04 3 1  ON 64
ci_66                -1.051570e-03 3 1  ON 65
ci_67                -9.148172e-04 3 1  ON 66
ci_68                 3.837735e-04 3 1  ON 67
ci_69                 6.872715e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3442e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8514
    reference variance = 0.516687
====================================================
  Execution time = 2.5940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.9965e-01
  Total weights = 1.963078327e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483214701354
                                         uncertainty =       0.002199728644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483214701354
                                         uncertainty =       0.002199728644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491544795
  error estimate for blocks of size 2^( 2) =       0.000512978109
  error estimate for blocks of size 2^( 3) =       0.000532395592
  error estimate for blocks of size 2^( 4) =       0.000547893726
  error estimate for blocks of size 2^( 5) =       0.000558387935
  error estimate for blocks of size 2^( 6) =       0.000564644001
  error estimate for blocks of size 2^( 7) =       0.000569516059

      target function =      -0.707234433154
              le_mean =     -22.813743855748
             les_mean =     520.966560471466
             stat err =       0.000560110430
             autocorr =       1.298437702282
   target nu stat err =       0.000560110430
   target dn stat err =       0.003540286457
      target stat err =       0.002522068149
              std dev =       0.695149315046
             le_variance =       0.483232570209


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281374385575e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707242476568       residual = 6.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709747749465       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710228306071       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710293546838       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710318410794       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710328878133       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710331771056       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710331886342       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710331857183       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710331897343       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710331974151       residual = 9.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 6.410082e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707242476568       residual = 6.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707999278819       residual = 9.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708136016161       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708153347464       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708159527398       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708161841862       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708162348706       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708162353706       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708162344965       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708162353144       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708162367780       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 1.833871e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707242476568       residual = 6.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707442022807       residual = 9.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707477376011       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707481758852       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707483288600       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707483840457       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707483951769       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707483951671       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707483949482       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707483951399       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707483954731       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 4.845565e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.528108 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0678e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.523359e-01 3 1  ON 0
ci_02                -4.789552e-02 3 1  ON 1
ci_03                -4.754840e-02 3 1  ON 2
ci_04                 4.553116e-02 3 1  ON 3
ci_05                -3.403817e-02 3 1  ON 4
ci_06                -3.340543e-02 3 1  ON 5
ci_07                 2.932711e-02 3 1  ON 6
ci_08                -1.397681e-02 3 1  ON 7
ci_09                -1.461826e-02 3 1  ON 8
ci_10                -1.436274e-02 3 1  ON 9
ci_11                 1.490077e-02 3 1  ON 10
ci_12                 1.122000e-02 3 1  ON 11
ci_13                 1.275939e-02 3 1  ON 12
ci_14                 1.251356e-02 3 1  ON 13
ci_15                 1.027832e-02 3 1  ON 14
ci_16                 1.043138e-02 3 1  ON 15
ci_17                -1.060173e-02 3 1  ON 16
ci_18                -1.007171e-02 3 1  ON 17
ci_19                 1.068819e-02 3 1  ON 18
ci_20                 9.127689e-03 3 1  ON 19
ci_21                 9.480185e-03 3 1  ON 20
ci_22                 9.664271e-03 3 1  ON 21
ci_23                 5.986647e-03 3 1  ON 22
ci_24                 5.016068e-03 3 1  ON 23
ci_25                 4.285979e-03 3 1  ON 24
ci_26                 4.243333e-03 3 1  ON 25
ci_27                 4.386362e-03 3 1  ON 26
ci_28                 3.673026e-03 3 1  ON 27
ci_29                 3.413974e-03 3 1  ON 28
ci_30                -2.925527e-03 3 1  ON 29
ci_31                -3.002834e-03 3 1  ON 30
ci_32                -2.479184e-03 3 1  ON 31
ci_33                -2.381328e-03 3 1  ON 32
ci_34                 2.404053e-03 3 1  ON 33
ci_35                 2.058575e-03 3 1  ON 34
ci_36                -2.148206e-03 3 1  ON 35
ci_37                -2.054351e-03 3 1  ON 36
ci_38                -1.527554e-03 3 1  ON 37
ci_39                -1.533855e-03 3 1  ON 38
ci_40                -1.882464e-03 3 1  ON 39
ci_41                -1.766665e-03 3 1  ON 40
ci_42                -1.441511e-03 3 1  ON 41
ci_43                -2.564630e-03 3 1  ON 42
ci_44                -2.036904e-03 3 1  ON 43
ci_45                -1.476725e-03 3 1  ON 44
ci_46                -1.343866e-03 3 1  ON 45
ci_47                -7.852995e-04 3 1  ON 46
ci_48                -8.619050e-04 3 1  ON 47
ci_49                -1.391435e-03 3 1  ON 48
ci_50                -1.323055e-03 3 1  ON 49
ci_51                 1.150885e-03 3 1  ON 50
ci_52                 1.173430e-03 3 1  ON 51
ci_53                -1.270468e-03 3 1  ON 52
ci_54                -1.193760e-03 3 1  ON 53
ci_55                -9.510919e-04 3 1  ON 54
ci_56                 1.682658e-03 3 1  ON 55
ci_57                 1.474440e-03 3 1  ON 56
ci_58                -1.110134e-03 3 1  ON 57
ci_59                -1.158051e-03 3 1  ON 58
ci_60                 1.161225e-03 3 1  ON 59
ci_61                 9.182830e-04 3 1  ON 60
ci_62                -8.840956e-04 3 1  ON 61
ci_63                -8.111312e-04 3 1  ON 62
ci_64                -1.003136e-03 3 1  ON 63
ci_65                -7.266115e-04 3 1  ON 64
ci_66                -1.001052e-03 3 1  ON 65
ci_67                -8.446181e-04 3 1  ON 66
ci_68                 2.665261e-04 3 1  ON 67
ci_69                 5.524577e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8893
    reference variance = 0.373089
====================================================
  Execution time = 2.5045e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.1462e-01
  Total weights = 1.9633e+06
  Execution time = 3.5981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493392736685
                                         uncertainty =       0.003022498351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493392736685
                                         uncertainty =       0.003022498351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496661557
  error estimate for blocks of size 2^( 2) =       0.000517492338
  error estimate for blocks of size 2^( 3) =       0.000537303629
  error estimate for blocks of size 2^( 4) =       0.000551647461
  error estimate for blocks of size 2^( 5) =       0.000561675644
  error estimate for blocks of size 2^( 6) =       0.000568606786
  error estimate for blocks of size 2^( 7) =       0.000569459607

      target function =      -0.695118483524
              le_mean =     -22.815324564865
             les_mean =     521.056377185257
             stat err =       0.000562847375
             autocorr =       1.284281415203
   target nu stat err =       0.000562847375
   target dn stat err =       0.007288878088
      target stat err =       0.004936299039
              std dev =       0.702385509727
             le_variance =       0.493345404274

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.21543
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488089779278
                                         uncertainty =       0.003647208674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488089779278
                                         uncertainty =       0.003647208674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493983217
  error estimate for blocks of size 2^( 2) =       0.000514712930
  error estimate for blocks of size 2^( 3) =       0.000534417633
  error estimate for blocks of size 2^( 4) =       0.000548569590
  error estimate for blocks of size 2^( 5) =       0.000558642382
  error estimate for blocks of size 2^( 6) =       0.000565449009
  error estimate for blocks of size 2^( 7) =       0.000566607939

      target function =      -0.692451930076
              le_mean =     -22.815499458974
             les_mean =     521.068300408224
             stat err =       0.000559817230
             autocorr =       1.284304881261
   target nu stat err =       0.000559817230
   target dn stat err =       0.009335784928
      target stat err =       0.006260827107
              std dev =       0.698597765515
             le_variance =       0.488038837983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.825061769989
                                         uncertainty =       0.335697829057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.825061769989
                                         uncertainty =       0.335697829057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000641940445
  error estimate for blocks of size 2^( 2) =       0.000657829474
  error estimate for blocks of size 2^( 3) =       0.000673390370
  error estimate for blocks of size 2^( 4) =       0.000685229490
  error estimate for blocks of size 2^( 5) =       0.000693283717
  error estimate for blocks of size 2^( 6) =       0.000700395379
  error estimate for blocks of size 2^( 7) =       0.000700054663

      target function =      -0.262258472723
              le_mean =     -22.814926230644
             les_mean =     522.154515082317
             stat err =       0.000694740812
             autocorr =       1.171267642495
   target nu stat err =       0.000694740812
   target dn stat err =       1.126602931147
      target stat err =       0.137449431518
              std dev =       0.907840884102
             le_variance =       0.824175070847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492841511354
                                         uncertainty =       0.003099004720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492841511354
                                         uncertainty =       0.003099004720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496383816
  error estimate for blocks of size 2^( 2) =       0.000517196942
  error estimate for blocks of size 2^( 3) =       0.000536998230
  error estimate for blocks of size 2^( 4) =       0.000551333939
  error estimate for blocks of size 2^( 5) =       0.000561364919
  error estimate for blocks of size 2^( 6) =       0.000568324003
  error estimate for blocks of size 2^( 7) =       0.000569177787

      target function =      -0.692981646538
              le_mean =     -22.815302109782
             les_mean =     521.058516057357
             stat err =       0.000562550162
             autocorr =       1.284361505857
   target nu stat err =       0.000562550162
   target dn stat err =       0.008682144305
      target stat err =       0.005833316831
              std dev =       0.701992725250
             le_variance =       0.492793786304


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.695118483524        initial  <--
     1.5625e-01     1.5625e+00             6.4101e-03        -0.692451930076
     6.2500e-01     6.2500e+00             1.8339e-03        -0.262258472723
     2.5000e+00     2.5000e+01             4.8456e-04        -0.692981646538

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0796
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.541322e-01 3 1  ON 0
ci_02                -4.945749e-02 3 1  ON 1
ci_03                -4.923181e-02 3 1  ON 2
ci_04                 4.736503e-02 3 1  ON 3
ci_05                -3.519124e-02 3 1  ON 4
ci_06                -3.461348e-02 3 1  ON 5
ci_07                 2.957549e-02 3 1  ON 6
ci_08                -1.477744e-02 3 1  ON 7
ci_09                -1.502593e-02 3 1  ON 8
ci_10                -1.490796e-02 3 1  ON 9
ci_11                 1.515176e-02 3 1  ON 10
ci_12                 1.162386e-02 3 1  ON 11
ci_13                 1.274958e-02 3 1  ON 12
ci_14                 1.257387e-02 3 1  ON 13
ci_15                 1.074402e-02 3 1  ON 14
ci_16                 1.073107e-02 3 1  ON 15
ci_17                -1.076049e-02 3 1  ON 16
ci_18                -1.040496e-02 3 1  ON 17
ci_19                 1.082252e-02 3 1  ON 18
ci_20                 9.397163e-03 3 1  ON 19
ci_21                 9.640531e-03 3 1  ON 20
ci_22                 9.688660e-03 3 1  ON 21
ci_23                 6.195489e-03 3 1  ON 22
ci_24                 5.013901e-03 3 1  ON 23
ci_25                 4.480156e-03 3 1  ON 24
ci_26                 4.445860e-03 3 1  ON 25
ci_27                 4.333920e-03 3 1  ON 26
ci_28                 3.860340e-03 3 1  ON 27
ci_29                 3.515398e-03 3 1  ON 28
ci_30                -3.107882e-03 3 1  ON 29
ci_31                -3.055996e-03 3 1  ON 30
ci_32                -2.647600e-03 3 1  ON 31
ci_33                -2.551955e-03 3 1  ON 32
ci_34                 2.487970e-03 3 1  ON 33
ci_35                 2.217126e-03 3 1  ON 34
ci_36                -2.233660e-03 3 1  ON 35
ci_37                -2.164307e-03 3 1  ON 36
ci_38                -1.652345e-03 3 1  ON 37
ci_39                -1.605584e-03 3 1  ON 38
ci_40                -1.923204e-03 3 1  ON 39
ci_41                -1.876980e-03 3 1  ON 40
ci_42                -1.552751e-03 3 1  ON 41
ci_43                -2.574328e-03 3 1  ON 42
ci_44                -2.041738e-03 3 1  ON 43
ci_45                -1.502749e-03 3 1  ON 44
ci_46                -1.384405e-03 3 1  ON 45
ci_47                -9.529216e-04 3 1  ON 46
ci_48                -1.154197e-03 3 1  ON 47
ci_49                -1.478841e-03 3 1  ON 48
ci_50                -1.398053e-03 3 1  ON 49
ci_51                 1.215703e-03 3 1  ON 50
ci_52                 1.261705e-03 3 1  ON 51
ci_53                -1.317260e-03 3 1  ON 52
ci_54                -1.234008e-03 3 1  ON 53
ci_55                -9.556594e-04 3 1  ON 54
ci_56                 1.621515e-03 3 1  ON 55
ci_57                 1.404970e-03 3 1  ON 56
ci_58                -1.177679e-03 3 1  ON 57
ci_59                -1.131792e-03 3 1  ON 58
ci_60                 1.252483e-03 3 1  ON 59
ci_61                 1.023496e-03 3 1  ON 60
ci_62                -9.281692e-04 3 1  ON 61
ci_63                -7.756698e-04 3 1  ON 62
ci_64                -1.076397e-03 3 1  ON 63
ci_65                -8.034540e-04 3 1  ON 64
ci_66                -1.051570e-03 3 1  ON 65
ci_67                -9.148172e-04 3 1  ON 66
ci_68                 3.837735e-04 3 1  ON 67
ci_69                 6.872715e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3773e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7315
    reference variance = 0.435159
====================================================
  Execution time = 2.5666e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.0537e-01
  Total weights = 1.963194721e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486964921077
                                         uncertainty =       0.002964510180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486964921077
                                         uncertainty =       0.002964510180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493387355
  error estimate for blocks of size 2^( 2) =       0.000514442325
  error estimate for blocks of size 2^( 3) =       0.000534056259
  error estimate for blocks of size 2^( 4) =       0.000548691105
  error estimate for blocks of size 2^( 5) =       0.000560108152
  error estimate for blocks of size 2^( 6) =       0.000567798755
  error estimate for blocks of size 2^( 7) =       0.000570214078

      target function =      -0.703284627700
              le_mean =     -22.814562074418
             les_mean =     521.009612215388
             stat err =       0.000561703023
             autocorr =       1.296096960504
   target nu stat err =       0.000561703023
   target dn stat err =       0.004647491606
      target stat err =       0.003245540941
              std dev =       0.697755088912
             le_variance =       0.486862164102


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281456207442e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.703298725023       residual = 5.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.703602350761       residual = 7.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.703647382991       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.703654563040       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.703656444403       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.703656978504       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.703657261087       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.703657272110       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.703657265859       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.703657267025       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.703657269249       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 7.948648e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.703298725023       residual = 5.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.703376287835       residual = 7.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.703387696391       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.703389499925       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.703389966897       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.703390096916       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.703390165215       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.703390167762       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.703390166221       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.703390166511       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.703390167047       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 2.032471e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.703298725023       residual = 5.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.703318222024       residual = 7.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.703321083665       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.703321535058       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.703321651573       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.703321683853       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.703321700780       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.703321701403       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.703321701019       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.703321701092       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.703321701225       residual = 1.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 5.110285e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.537217 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0272e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.539557e-01 3 1  ON 0
ci_02                -4.926572e-02 3 1  ON 1
ci_03                -4.907461e-02 3 1  ON 2
ci_04                 4.716178e-02 3 1  ON 3
ci_05                -3.507901e-02 3 1  ON 4
ci_06                -3.452056e-02 3 1  ON 5
ci_07                 2.955831e-02 3 1  ON 6
ci_08                -1.469678e-02 3 1  ON 7
ci_09                -1.498928e-02 3 1  ON 8
ci_10                -1.485964e-02 3 1  ON 9
ci_11                 1.513743e-02 3 1  ON 10
ci_12                 1.158346e-02 3 1  ON 11
ci_13                 1.275680e-02 3 1  ON 12
ci_14                 1.256113e-02 3 1  ON 13
ci_15                 1.071289e-02 3 1  ON 14
ci_16                 1.071019e-02 3 1  ON 15
ci_17                -1.073161e-02 3 1  ON 16
ci_18                -1.038529e-02 3 1  ON 17
ci_19                 1.080864e-02 3 1  ON 18
ci_20                 9.381888e-03 3 1  ON 19
ci_21                 9.634007e-03 3 1  ON 20
ci_22                 9.691212e-03 3 1  ON 21
ci_23                 6.184173e-03 3 1  ON 22
ci_24                 5.008590e-03 3 1  ON 23
ci_25                 4.458985e-03 3 1  ON 24
ci_26                 4.442092e-03 3 1  ON 25
ci_27                 4.321269e-03 3 1  ON 26
ci_28                 3.839500e-03 3 1  ON 27
ci_29                 3.496211e-03 3 1  ON 28
ci_30                -3.090141e-03 3 1  ON 29
ci_31                -3.034695e-03 3 1  ON 30
ci_32                -2.633550e-03 3 1  ON 31
ci_33                -2.531582e-03 3 1  ON 32
ci_34                 2.479549e-03 3 1  ON 33
ci_35                 2.207624e-03 3 1  ON 34
ci_36                -2.216893e-03 3 1  ON 35
ci_37                -2.144498e-03 3 1  ON 36
ci_38                -1.644942e-03 3 1  ON 37
ci_39                -1.597488e-03 3 1  ON 38
ci_40                -1.922443e-03 3 1  ON 39
ci_41                -1.859643e-03 3 1  ON 40
ci_42                -1.551441e-03 3 1  ON 41
ci_43                -2.565323e-03 3 1  ON 42
ci_44                -2.038350e-03 3 1  ON 43
ci_45                -1.494422e-03 3 1  ON 44
ci_46                -1.382635e-03 3 1  ON 45
ci_47                -9.460373e-04 3 1  ON 46
ci_48                -1.138814e-03 3 1  ON 47
ci_49                -1.467137e-03 3 1  ON 48
ci_50                -1.392029e-03 3 1  ON 49
ci_51                 1.208972e-03 3 1  ON 50
ci_52                 1.258710e-03 3 1  ON 51
ci_53                -1.314749e-03 3 1  ON 52
ci_54                -1.234378e-03 3 1  ON 53
ci_55                -9.464266e-04 3 1  ON 54
ci_56                 1.625194e-03 3 1  ON 55
ci_57                 1.406639e-03 3 1  ON 56
ci_58                -1.174809e-03 3 1  ON 57
ci_59                -1.099823e-03 3 1  ON 58
ci_60                 1.242783e-03 3 1  ON 59
ci_61                 1.018226e-03 3 1  ON 60
ci_62                -9.137501e-04 3 1  ON 61
ci_63                -7.794346e-04 3 1  ON 62
ci_64                -1.063413e-03 3 1  ON 63
ci_65                -7.903991e-04 3 1  ON 64
ci_66                -1.041588e-03 3 1  ON 65
ci_67                -9.148064e-04 3 1  ON 66
ci_68                 3.663303e-04 3 1  ON 67
ci_69                 6.606264e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.687
    reference variance = 7.80415
====================================================
  Execution time = 2.5268e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.0846e-01
  Total weights = 1.9634e+06
  Execution time = 3.5851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490302911733
                                         uncertainty =       0.002260517777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490302911733
                                         uncertainty =       0.002260517777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495181596
  error estimate for blocks of size 2^( 2) =       0.000515890365
  error estimate for blocks of size 2^( 3) =       0.000536234379
  error estimate for blocks of size 2^( 4) =       0.000550836516
  error estimate for blocks of size 2^( 5) =       0.000562012271
  error estimate for blocks of size 2^( 6) =       0.000568118347
  error estimate for blocks of size 2^( 7) =       0.000571904027

      target function =      -0.700968671964
              le_mean =     -22.815118086877
             les_mean =     521.038376386850
             stat err =       0.000563217790
             autocorr =       1.293670686130
   target nu stat err =       0.000563217790
   target dn stat err =       0.003057301682
      target stat err =       0.002162994472
              std dev =       0.700292529366
             le_variance =       0.490409626686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489245300178
                                         uncertainty =       0.002256765746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489245300178
                                         uncertainty =       0.002256765746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494647276
  error estimate for blocks of size 2^( 2) =       0.000515336801
  error estimate for blocks of size 2^( 3) =       0.000535670248
  error estimate for blocks of size 2^( 4) =       0.000550271393
  error estimate for blocks of size 2^( 5) =       0.000561437724
  error estimate for blocks of size 2^( 6) =       0.000567535533
  error estimate for blocks of size 2^( 7) =       0.000571296775

      target function =      -0.701619606065
              le_mean =     -22.815120736182
             les_mean =     521.037546442948
             stat err =       0.000562635356
             autocorr =       1.293787041121
   target nu stat err =       0.000562635356
   target dn stat err =       0.003127024344
      target stat err =       0.002213014021
              std dev =       0.699536886205
             le_variance =       0.489351855161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489754045530
                                         uncertainty =       0.002258329795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489754045530
                                         uncertainty =       0.002258329795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494904378
  error estimate for blocks of size 2^( 2) =       0.000515603170
  error estimate for blocks of size 2^( 3) =       0.000535941661
  error estimate for blocks of size 2^( 4) =       0.000550543320
  error estimate for blocks of size 2^( 5) =       0.000561714249
  error estimate for blocks of size 2^( 6) =       0.000567815523
  error estimate for blocks of size 2^( 7) =       0.000571588344

      target function =      -0.699680376964
              le_mean =     -22.815118104609
             les_mean =     521.040257048151
             stat err =       0.000562915359
             autocorr =       1.293729873465
   target nu stat err =       0.000562915359
   target dn stat err =       0.004010572017
      target stat err =       0.002788641409
              std dev =       0.699900482814
             le_variance =       0.489860685844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490232878706
                                         uncertainty =       0.002260212365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490232878706
                                         uncertainty =       0.002260212365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495146234
  error estimate for blocks of size 2^( 2) =       0.000515853721
  error estimate for blocks of size 2^( 3) =       0.000536197026
  error estimate for blocks of size 2^( 4) =       0.000550799078
  error estimate for blocks of size 2^( 5) =       0.000561974226
  error estimate for blocks of size 2^( 6) =       0.000568079689
  error estimate for blocks of size 2^( 7) =       0.000571863668

      target function =      -0.701035519321
              le_mean =     -22.815117925909
             les_mean =     521.038271346004
             stat err =       0.000563179165
             autocorr =       1.293678021850
   target nu stat err =       0.000563179165
   target dn stat err =       0.003058655413
      target stat err =       0.002164279722
              std dev =       0.700242518946
             le_variance =       0.490339585340


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.700968671964        initial
     1.5625e+00     1.5625e+01             7.9486e-04        -0.701619606065  <--
     6.2500e+00     6.2500e+01             2.0325e-04        -0.699680376964
     2.5000e+01     2.5000e+02             5.1103e-05        -0.701035519321

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 4.5404e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.534347e-01 3 1  ON 0
ci_02                -4.870536e-02 3 1  ON 1
ci_03                -4.861521e-02 3 1  ON 2
ci_04                 4.657016e-02 3 1  ON 3
ci_05                -3.475165e-02 3 1  ON 4
ci_06                -3.424980e-02 3 1  ON 5
ci_07                 2.950800e-02 3 1  ON 6
ci_08                -1.446178e-02 3 1  ON 7
ci_09                -1.488176e-02 3 1  ON 8
ci_10                -1.471804e-02 3 1  ON 9
ci_11                 1.509573e-02 3 1  ON 10
ci_12                 1.146564e-02 3 1  ON 11
ci_13                 1.277835e-02 3 1  ON 12
ci_14                 1.252356e-02 3 1  ON 13
ci_15                 1.062190e-02 3 1  ON 14
ci_16                 1.064913e-02 3 1  ON 15
ci_17                -1.064684e-02 3 1  ON 16
ci_18                -1.032762e-02 3 1  ON 17
ci_19                 1.076831e-02 3 1  ON 18
ci_20                 9.337403e-03 3 1  ON 19
ci_21                 9.614799e-03 3 1  ON 20
ci_22                 9.698724e-03 3 1  ON 21
ci_23                 6.151321e-03 3 1  ON 22
ci_24                 4.993038e-03 3 1  ON 23
ci_25                 4.397351e-03 3 1  ON 24
ci_26                 4.431224e-03 3 1  ON 25
ci_27                 4.284464e-03 3 1  ON 26
ci_28                 3.778382e-03 3 1  ON 27
ci_29                 3.440060e-03 3 1  ON 28
ci_30                -3.037740e-03 3 1  ON 29
ci_31                -2.971775e-03 3 1  ON 30
ci_32                -2.593002e-03 3 1  ON 31
ci_33                -2.472630e-03 3 1  ON 32
ci_34                 2.455342e-03 3 1  ON 33
ci_35                 2.180330e-03 3 1  ON 34
ci_36                -2.168027e-03 3 1  ON 35
ci_37                -2.086749e-03 3 1  ON 36
ci_38                -1.623301e-03 3 1  ON 37
ci_39                -1.573851e-03 3 1  ON 38
ci_40                -1.920256e-03 3 1  ON 39
ci_41                -1.809462e-03 3 1  ON 40
ci_42                -1.547920e-03 3 1  ON 41
ci_43                -2.538722e-03 3 1  ON 42
ci_44                -2.028179e-03 3 1  ON 43
ci_45                -1.470097e-03 3 1  ON 44
ci_46                -1.377446e-03 3 1  ON 45
ci_47                -9.255782e-04 3 1  ON 46
ci_48                -1.093349e-03 3 1  ON 47
ci_49                -1.433074e-03 3 1  ON 48
ci_50                -1.374516e-03 3 1  ON 49
ci_51                 1.189331e-03 3 1  ON 50
ci_52                 1.249927e-03 3 1  ON 51
ci_53                -1.307416e-03 3 1  ON 52
ci_54                -1.235560e-03 3 1  ON 53
ci_55                -9.193998e-04 3 1  ON 54
ci_56                 1.635956e-03 3 1  ON 55
ci_57                 1.411542e-03 3 1  ON 56
ci_58                -1.166412e-03 3 1  ON 57
ci_59                -1.006695e-03 3 1  ON 58
ci_60                 1.214045e-03 3 1  ON 59
ci_61                 1.002579e-03 3 1  ON 60
ci_62                -8.717771e-04 3 1  ON 61
ci_63                -7.903002e-04 3 1  ON 62
ci_64                -1.025586e-03 3 1  ON 63
ci_65                -7.523421e-04 3 1  ON 64
ci_66                -1.012428e-03 3 1  ON 65
ci_67                -9.146998e-04 3 1  ON 66
ci_68                 3.154025e-04 3 1  ON 67
ci_69                 5.828264e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5691e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8263
    reference variance = 0.374526
====================================================
  Execution time = 2.5612e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.9948e-01
  Total weights = 1.963257887e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485373215947
                                         uncertainty =       0.002155501730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485373215947
                                         uncertainty =       0.002155501730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492644073
  error estimate for blocks of size 2^( 2) =       0.000514098758
  error estimate for blocks of size 2^( 3) =       0.000534185146
  error estimate for blocks of size 2^( 4) =       0.000549639469
  error estimate for blocks of size 2^( 5) =       0.000559850774
  error estimate for blocks of size 2^( 6) =       0.000563754628
  error estimate for blocks of size 2^( 7) =       0.000567200350

      target function =      -0.707367789530
              le_mean =     -22.814250052618
             les_mean =     520.989481925665
             stat err =       0.000560111305
             autocorr =       1.292653580163
   target nu stat err =       0.000560111305
   target dn stat err =       0.002894954547
      target stat err =       0.002088770516
              std dev =       0.696703928978
             le_variance =       0.485396364653


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281425005262e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707373083893       residual = 5.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708485958937       residual = 9.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708676574328       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708704454696       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708713695504       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708717528203       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708718424735       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708718459813       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708718454305       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708718442215       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708718447342       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.775173e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707373083893       residual = 5.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707675400448       residual = 8.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707725656052       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707732813764       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707735121948       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707736005428       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707736200045       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707736201950       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707736200023       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707736197392       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707736198467       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 7.563786e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707373083893       residual = 5.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707450332145       residual = 8.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707463065893       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707464866162       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707465442194       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707465657748       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707465704462       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707465704512       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707465704000       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707465703370       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707465703625       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.934456e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.546372 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0210e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.527598e-01 3 1  ON 0
ci_02                -4.800964e-02 3 1  ON 1
ci_03                -4.793266e-02 3 1  ON 2
ci_04                 4.581378e-02 3 1  ON 3
ci_05                -3.433896e-02 3 1  ON 4
ci_06                -3.376967e-02 3 1  ON 5
ci_07                 2.941287e-02 3 1  ON 6
ci_08                -1.413508e-02 3 1  ON 7
ci_09                -1.466791e-02 3 1  ON 8
ci_10                -1.450942e-02 3 1  ON 9
ci_11                 1.500167e-02 3 1  ON 10
ci_12                 1.132461e-02 3 1  ON 11
ci_13                 1.271324e-02 3 1  ON 12
ci_14                 1.242447e-02 3 1  ON 13
ci_15                 1.049438e-02 3 1  ON 14
ci_16                 1.052967e-02 3 1  ON 15
ci_17                -1.056073e-02 3 1  ON 16
ci_18                -1.019304e-02 3 1  ON 17
ci_19                 1.072229e-02 3 1  ON 18
ci_20                 9.266833e-03 3 1  ON 19
ci_21                 9.578101e-03 3 1  ON 20
ci_22                 9.600729e-03 3 1  ON 21
ci_23                 6.116112e-03 3 1  ON 22
ci_24                 5.025948e-03 3 1  ON 23
ci_25                 4.318747e-03 3 1  ON 24
ci_26                 4.410625e-03 3 1  ON 25
ci_27                 4.221572e-03 3 1  ON 26
ci_28                 3.695336e-03 3 1  ON 27
ci_29                 3.403620e-03 3 1  ON 28
ci_30                -3.004526e-03 3 1  ON 29
ci_31                -2.996488e-03 3 1  ON 30
ci_32                -2.526087e-03 3 1  ON 31
ci_33                -2.383124e-03 3 1  ON 32
ci_34                 2.418444e-03 3 1  ON 33
ci_35                 2.160883e-03 3 1  ON 34
ci_36                -2.083961e-03 3 1  ON 35
ci_37                -2.048350e-03 3 1  ON 36
ci_38                -1.569390e-03 3 1  ON 37
ci_39                -1.557158e-03 3 1  ON 38
ci_40                -1.902542e-03 3 1  ON 39
ci_41                -1.772096e-03 3 1  ON 40
ci_42                -1.531471e-03 3 1  ON 41
ci_43                -2.521194e-03 3 1  ON 42
ci_44                -2.013243e-03 3 1  ON 43
ci_45                -1.439908e-03 3 1  ON 44
ci_46                -1.343028e-03 3 1  ON 45
ci_47                -8.763731e-04 3 1  ON 46
ci_48                -1.056460e-03 3 1  ON 47
ci_49                -1.410333e-03 3 1  ON 48
ci_50                -1.316750e-03 3 1  ON 49
ci_51                 1.180578e-03 3 1  ON 50
ci_52                 1.230739e-03 3 1  ON 51
ci_53                -1.295739e-03 3 1  ON 52
ci_54                -1.223156e-03 3 1  ON 53
ci_55                -8.885828e-04 3 1  ON 54
ci_56                 1.616768e-03 3 1  ON 55
ci_57                 1.430210e-03 3 1  ON 56
ci_58                -1.177459e-03 3 1  ON 57
ci_59                -9.970974e-04 3 1  ON 58
ci_60                 1.192920e-03 3 1  ON 59
ci_61                 9.862191e-04 3 1  ON 60
ci_62                -8.443127e-04 3 1  ON 61
ci_63                -7.771692e-04 3 1  ON 62
ci_64                -9.588220e-04 3 1  ON 63
ci_65                -7.607448e-04 3 1  ON 64
ci_66                -1.007920e-03 3 1  ON 65
ci_67                -8.398754e-04 3 1  ON 66
ci_68                 2.952857e-04 3 1  ON 67
ci_69                 5.077256e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.746
    reference variance = 0.458564
====================================================
  Execution time = 2.5087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.0327e-01
  Total weights = 1.9632e+06
  Execution time = 3.6160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489833953382
                                         uncertainty =       0.002530452712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489833953382
                                         uncertainty =       0.002530452712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494905112
  error estimate for blocks of size 2^( 2) =       0.000516016351
  error estimate for blocks of size 2^( 3) =       0.000535913939
  error estimate for blocks of size 2^( 4) =       0.000550791228
  error estimate for blocks of size 2^( 5) =       0.000560510704
  error estimate for blocks of size 2^( 6) =       0.000564562716
  error estimate for blocks of size 2^( 7) =       0.000567682081

      target function =      -0.695697647222
              le_mean =     -22.814732184016
             les_mean =     521.028402585620
             stat err =       0.000560886682
             autocorr =       1.284417980807
   target nu stat err =       0.000560886682
   target dn stat err =       0.011882870123
      target stat err =       0.008024112475
              std dev =       0.699901521654
             le_variance =       0.489862140014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485993918318
                                         uncertainty =       0.002491157198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485993918318
                                         uncertainty =       0.002491157198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492961100
  error estimate for blocks of size 2^( 2) =       0.000514007295
  error estimate for blocks of size 2^( 3) =       0.000533877264
  error estimate for blocks of size 2^( 4) =       0.000548741507
  error estimate for blocks of size 2^( 5) =       0.000558472725
  error estimate for blocks of size 2^( 6) =       0.000562554593
  error estimate for blocks of size 2^( 7) =       0.000565714660

      target function =      -0.704296806597
              le_mean =     -22.814762866089
             les_mean =     521.017319020774
             stat err =       0.000558870871
             autocorr =       1.285279701725
   target nu stat err =       0.000558870871
   target dn stat err =       0.003371534555
      target stat err =       0.002391384222
              std dev =       0.697152273567
             le_variance =       0.486021292540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487927551553
                                         uncertainty =       0.002579684266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487927551553
                                         uncertainty =       0.002579684266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493940502
  error estimate for blocks of size 2^( 2) =       0.000515007426
  error estimate for blocks of size 2^( 3) =       0.000534892684
  error estimate for blocks of size 2^( 4) =       0.000549759529
  error estimate for blocks of size 2^( 5) =       0.000559470552
  error estimate for blocks of size 2^( 6) =       0.000563506952
  error estimate for blocks of size 2^( 7) =       0.000566512994

      target function =      -0.603793267807
              le_mean =     -22.814744053867
             les_mean =     521.167411795200
             stat err =       0.000559812506
             autocorr =       1.284505343607
   target nu stat err =       0.000559812506
   target dn stat err =       0.148692437970
      target stat err =       0.076665691388
              std dev =       0.698537357196
             le_variance =       0.487954439398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489536332875
                                         uncertainty =       0.002527407847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489536332875
                                         uncertainty =       0.002527407847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494754734
  error estimate for blocks of size 2^( 2) =       0.000515862875
  error estimate for blocks of size 2^( 3) =       0.000535757213
  error estimate for blocks of size 2^( 4) =       0.000550631614
  error estimate for blocks of size 2^( 5) =       0.000560350869
  error estimate for blocks of size 2^( 6) =       0.000564406067
  error estimate for blocks of size 2^( 7) =       0.000567535694

      target function =      -0.675686355318
              le_mean =     -22.814729032161
             les_mean =     521.057409419825
             stat err =       0.000560731061
             autocorr =       1.284485811040
   target nu stat err =       0.000560731061
   target dn stat err =       0.040878536440
      target stat err =       0.026019310750
              std dev =       0.699688854489
             le_variance =       0.489564493096


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.695697647222        initial
     3.9062e-01     3.9062e+00             2.7752e-03        -0.704296806597  <--
     1.5625e+00     1.5625e+01             7.5638e-04        -0.603793267807
     6.2500e+00     6.2500e+01             1.9345e-04        -0.675686355318

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.3229e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.508655e-01 3 1  ON 0
ci_02                -4.612632e-02 3 1  ON 1
ci_03                -4.608385e-02 3 1  ON 2
ci_04                 4.379499e-02 3 1  ON 3
ci_05                -3.323164e-02 3 1  ON 4
ci_06                -3.247730e-02 3 1  ON 5
ci_07                 2.915285e-02 3 1  ON 6
ci_08                -1.326086e-02 3 1  ON 7
ci_09                -1.408423e-02 3 1  ON 8
ci_10                -1.393821e-02 3 1  ON 9
ci_11                 1.474556e-02 3 1  ON 10
ci_12                 1.094510e-02 3 1  ON 11
ci_13                 1.252999e-02 3 1  ON 12
ci_14                 1.214855e-02 3 1  ON 13
ci_15                 1.014882e-02 3 1  ON 14
ci_16                 1.020734e-02 3 1  ON 15
ci_17                -1.032375e-02 3 1  ON 16
ci_18                -9.823938e-03 3 1  ON 17
ci_19                 1.060103e-02 3 1  ON 18
ci_20                 9.077753e-03 3 1  ON 19
ci_21                 9.476053e-03 3 1  ON 20
ci_22                 9.329935e-03 3 1  ON 21
ci_23                 6.022919e-03 3 1  ON 22
ci_24                 5.119675e-03 3 1  ON 23
ci_25                 4.108469e-03 3 1  ON 24
ci_26                 4.356543e-03 3 1  ON 25
ci_27                 4.053334e-03 3 1  ON 26
ci_28                 3.466201e-03 3 1  ON 27
ci_29                 3.303481e-03 3 1  ON 28
ci_30                -2.911867e-03 3 1  ON 29
ci_31                -3.062989e-03 3 1  ON 30
ci_32                -2.351718e-03 3 1  ON 31
ci_33                -2.146708e-03 3 1  ON 32
ci_34                 2.324126e-03 3 1  ON 33
ci_35                 2.113189e-03 3 1  ON 34
ci_36                -1.859076e-03 3 1  ON 35
ci_37                -1.944650e-03 3 1  ON 36
ci_38                -1.424791e-03 3 1  ON 37
ci_39                -1.511581e-03 3 1  ON 38
ci_40                -1.855208e-03 3 1  ON 39
ci_41                -1.675488e-03 3 1  ON 40
ci_42                -1.490919e-03 3 1  ON 41
ci_43                -2.469661e-03 3 1  ON 42
ci_44                -1.968003e-03 3 1  ON 43
ci_45                -1.358542e-03 3 1  ON 44
ci_46                -1.251417e-03 3 1  ON 45
ci_47                -7.380120e-04 3 1  ON 46
ci_48                -9.526332e-04 3 1  ON 47
ci_49                -1.351079e-03 3 1  ON 48
ci_50                -1.164237e-03 3 1  ON 49
ci_51                 1.155641e-03 3 1  ON 50
ci_52                 1.177679e-03 3 1  ON 51
ci_53                -1.264400e-03 3 1  ON 52
ci_54                -1.189688e-03 3 1  ON 53
ci_55                -8.049616e-04 3 1  ON 54
ci_56                 1.565942e-03 3 1  ON 55
ci_57                 1.480182e-03 3 1  ON 56
ci_58                -1.207390e-03 3 1  ON 57
ci_59                -9.719648e-04 3 1  ON 58
ci_60                 1.131844e-03 3 1  ON 59
ci_61                 9.395738e-04 3 1  ON 60
ci_62                -7.716556e-04 3 1  ON 61
ci_63                -7.410281e-04 3 1  ON 62
ci_64                -7.806250e-04 3 1  ON 63
ci_65                -7.824615e-04 3 1  ON 64
ci_66                -9.951811e-04 3 1  ON 65
ci_67                -6.403045e-04 3 1  ON 66
ci_68                 2.402017e-04 3 1  ON 67
ci_69                 3.051608e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3454e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8004
    reference variance = 0.349555
====================================================
  Execution time = 2.5645e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.9920e-01
  Total weights = 1.963100755e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481396554104
                                         uncertainty =       0.002239284200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481396554104
                                         uncertainty =       0.002239284200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490593761
  error estimate for blocks of size 2^( 2) =       0.000511134064
  error estimate for blocks of size 2^( 3) =       0.000530472445
  error estimate for blocks of size 2^( 4) =       0.000544118271
  error estimate for blocks of size 2^( 5) =       0.000553289575
  error estimate for blocks of size 2^( 6) =       0.000557836122
  error estimate for blocks of size 2^( 7) =       0.000564466043

      target function =      -0.707569916515
              le_mean =     -22.815007483043
             les_mean =     521.023767941591
             stat err =       0.000554927503
             autocorr =       1.279465137218
   target nu stat err =       0.000554927503
   target dn stat err =       0.003324832075
      target stat err =       0.002381318708
              std dev =       0.693804350760
             le_variance =       0.481364477134


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281500748304e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707577115582       residual = 4.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710287358628       residual = 7.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710771905064       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710853965341       residual = 4.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710881108777       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710898220002       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710901961370       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710902731157       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710902854971       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710902767372       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710902819051       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.710902834200       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 8.625423e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707577115582       residual = 4.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708471966667       residual = 6.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708620543763       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708643615988       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708650381170       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708654035058       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708654594382       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708654738606       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708654759729       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708654742276       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708654753232       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.563746e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707577115582       residual = 4.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707820228454       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707859496562       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707865401991       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707867055748       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707867899899       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707868011282       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707868043758       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707868048374       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707868044462       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707868047006       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 6.960678e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.555807 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0215e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.483018e-01 3 1  ON 0
ci_02                -4.415032e-02 3 1  ON 1
ci_03                -4.389514e-02 3 1  ON 2
ci_04                 4.124082e-02 3 1  ON 3
ci_05                -3.161430e-02 3 1  ON 4
ci_06                -3.095866e-02 3 1  ON 5
ci_07                 2.875347e-02 3 1  ON 6
ci_08                -1.220478e-02 3 1  ON 7
ci_09                -1.360234e-02 3 1  ON 8
ci_10                -1.335047e-02 3 1  ON 9
ci_11                 1.448213e-02 3 1  ON 10
ci_12                 1.046672e-02 3 1  ON 11
ci_13                 1.257076e-02 3 1  ON 12
ci_14                 1.224981e-02 3 1  ON 13
ci_15                 9.810484e-03 3 1  ON 14
ci_16                 9.723875e-03 3 1  ON 15
ci_17                -1.005015e-02 3 1  ON 16
ci_18                -9.317232e-03 3 1  ON 17
ci_19                 1.048102e-02 3 1  ON 18
ci_20                 8.762385e-03 3 1  ON 19
ci_21                 9.342039e-03 3 1  ON 20
ci_22                 9.392341e-03 3 1  ON 21
ci_23                 5.778437e-03 3 1  ON 22
ci_24                 5.137100e-03 3 1  ON 23
ci_25                 4.053623e-03 3 1  ON 24
ci_26                 4.021643e-03 3 1  ON 25
ci_27                 3.993812e-03 3 1  ON 26
ci_28                 3.176838e-03 3 1  ON 27
ci_29                 3.264213e-03 3 1  ON 28
ci_30                -2.666617e-03 3 1  ON 29
ci_31                -2.883202e-03 3 1  ON 30
ci_32                -2.040008e-03 3 1  ON 31
ci_33                -2.048600e-03 3 1  ON 32
ci_34                 2.012409e-03 3 1  ON 33
ci_35                 2.092029e-03 3 1  ON 34
ci_36                -1.796845e-03 3 1  ON 35
ci_37                -1.886645e-03 3 1  ON 36
ci_38                -1.316831e-03 3 1  ON 37
ci_39                -1.419498e-03 3 1  ON 38
ci_40                -1.829148e-03 3 1  ON 39
ci_41                -1.570413e-03 3 1  ON 40
ci_42                -1.273676e-03 3 1  ON 41
ci_43                -2.482537e-03 3 1  ON 42
ci_44                -1.870020e-03 3 1  ON 43
ci_45                -1.289642e-03 3 1  ON 44
ci_46                -1.090699e-03 3 1  ON 45
ci_47                -5.423836e-04 3 1  ON 46
ci_48                -7.592328e-04 3 1  ON 47
ci_49                -1.339353e-03 3 1  ON 48
ci_50                -1.018764e-03 3 1  ON 49
ci_51                 1.156098e-03 3 1  ON 50
ci_52                 9.464285e-04 3 1  ON 51
ci_53                -1.334933e-03 3 1  ON 52
ci_54                -1.229306e-03 3 1  ON 53
ci_55                -7.092959e-04 3 1  ON 54
ci_56                 1.625433e-03 3 1  ON 55
ci_57                 1.535958e-03 3 1  ON 56
ci_58                -1.105502e-03 3 1  ON 57
ci_59                -1.039697e-03 3 1  ON 58
ci_60                 1.183241e-03 3 1  ON 59
ci_61                 1.000343e-03 3 1  ON 60
ci_62                -7.088675e-04 3 1  ON 61
ci_63                -8.422608e-04 3 1  ON 62
ci_64                -7.221113e-04 3 1  ON 63
ci_65                -7.236177e-04 3 1  ON 64
ci_66                -9.348584e-04 3 1  ON 65
ci_67                -6.904820e-04 3 1  ON 66
ci_68                -2.596567e-05 3 1  ON 67
ci_69                 1.819459e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8131
    reference variance = 0.351458
====================================================
  Execution time = 2.4953e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 5.0418e-01
  Total weights = 1.9636e+06
  Execution time = 3.5970e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491889411365
                                         uncertainty =       0.002891368835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491889411365
                                         uncertainty =       0.002891368835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495939375
  error estimate for blocks of size 2^( 2) =       0.000516396746
  error estimate for blocks of size 2^( 3) =       0.000535644624
  error estimate for blocks of size 2^( 4) =       0.000550454598
  error estimate for blocks of size 2^( 5) =       0.000560276753
  error estimate for blocks of size 2^( 6) =       0.000563324792
  error estimate for blocks of size 2^( 7) =       0.000568693717

      target function =      -0.645361622012
              le_mean =     -22.816586864911
             les_mean =     521.189500985651
             stat err =       0.000560687465
             autocorr =       1.278157915325
   target nu stat err =       0.000560687465
   target dn stat err =       0.066624125586
      target stat err =       0.038864043303
              std dev =       0.701364189658
             le_variance =       0.491911726535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527133649682
                                         uncertainty =       0.043464068523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527133649682
                                         uncertainty =       0.043464068523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513336030
  error estimate for blocks of size 2^( 2) =       0.000532870531
  error estimate for blocks of size 2^( 3) =       0.000551261382
  error estimate for blocks of size 2^( 4) =       0.000565647741
  error estimate for blocks of size 2^( 5) =       0.000575157066
  error estimate for blocks of size 2^( 6) =       0.000578735575
  error estimate for blocks of size 2^( 7) =       0.000584391212

      target function =      -0.091338534931
              le_mean =     -22.816870904068
             les_mean =     524.928070608663
             stat err =       0.000575982899
             autocorr =       1.258970872582
   target nu stat err =       0.000575982899
   target dn stat err =       3.815500061700
      target stat err =       0.072129366851
              std dev =       0.725966776023
             le_variance =       0.527027759889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486248121602
                                         uncertainty =       0.002930937607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486248121602
                                         uncertainty =       0.002930937607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493088811
  error estimate for blocks of size 2^( 2) =       0.000513486727
  error estimate for blocks of size 2^( 3) =       0.000532669771
  error estimate for blocks of size 2^( 4) =       0.000547511126
  error estimate for blocks of size 2^( 5) =       0.000557401762
  error estimate for blocks of size 2^( 6) =       0.000560399252
  error estimate for blocks of size 2^( 7) =       0.000565794438

      target function =      -0.672555919427
              le_mean =     -22.816573612293
             les_mean =     521.146717353975
             stat err =       0.000557776644
             autocorr =       1.279588577135
   target nu stat err =       0.000557776644
   target dn stat err =       0.037039759041
      target stat err =       0.023412828813
              std dev =       0.697332884107
             le_variance =       0.486273151258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490828902819
                                         uncertainty =       0.002870797185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490828902819
                                         uncertainty =       0.002870797185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495405025
  error estimate for blocks of size 2^( 2) =       0.000515848911
  error estimate for blocks of size 2^( 3) =       0.000535069710
  error estimate for blocks of size 2^( 4) =       0.000549861051
  error estimate for blocks of size 2^( 5) =       0.000559628220
  error estimate for blocks of size 2^( 6) =       0.000562669295
  error estimate for blocks of size 2^( 7) =       0.000567971845

      target function =      -0.235055658410
              le_mean =     -22.816549466376
             les_mean =     522.440942765876
             stat err =       0.000560032603
             autocorr =       1.277926296421
   target nu stat err =       0.000560032603
   target dn stat err =       1.275897250614
      target stat err =       0.127099216991
              std dev =       0.700608504833
             le_variance =       0.490852277044


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.645361622012        initial
     9.7656e-02     9.7656e-01             8.6254e-03        -0.091338534931
     3.9062e-01     3.9062e+00             2.5637e-03        -0.672555919427  <--
     1.5625e+00     1.5625e+01             6.9607e-04        -0.235055658410

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.2981e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.483018e-01 3 1  ON 0
ci_02                -4.415032e-02 3 1  ON 1
ci_03                -4.389514e-02 3 1  ON 2
ci_04                 4.124082e-02 3 1  ON 3
ci_05                -3.161430e-02 3 1  ON 4
ci_06                -3.095866e-02 3 1  ON 5
ci_07                 2.875347e-02 3 1  ON 6
ci_08                -1.220478e-02 3 1  ON 7
ci_09                -1.360234e-02 3 1  ON 8
ci_10                -1.335047e-02 3 1  ON 9
ci_11                 1.448213e-02 3 1  ON 10
ci_12                 1.046672e-02 3 1  ON 11
ci_13                 1.257076e-02 3 1  ON 12
ci_14                 1.224981e-02 3 1  ON 13
ci_15                 9.810484e-03 3 1  ON 14
ci_16                 9.723875e-03 3 1  ON 15
ci_17                -1.005015e-02 3 1  ON 16
ci_18                -9.317232e-03 3 1  ON 17
ci_19                 1.048102e-02 3 1  ON 18
ci_20                 8.762385e-03 3 1  ON 19
ci_21                 9.342039e-03 3 1  ON 20
ci_22                 9.392341e-03 3 1  ON 21
ci_23                 5.778437e-03 3 1  ON 22
ci_24                 5.137100e-03 3 1  ON 23
ci_25                 4.053623e-03 3 1  ON 24
ci_26                 4.021643e-03 3 1  ON 25
ci_27                 3.993812e-03 3 1  ON 26
ci_28                 3.176838e-03 3 1  ON 27
ci_29                 3.264213e-03 3 1  ON 28
ci_30                -2.666617e-03 3 1  ON 29
ci_31                -2.883202e-03 3 1  ON 30
ci_32                -2.040008e-03 3 1  ON 31
ci_33                -2.048600e-03 3 1  ON 32
ci_34                 2.012409e-03 3 1  ON 33
ci_35                 2.092029e-03 3 1  ON 34
ci_36                -1.796845e-03 3 1  ON 35
ci_37                -1.886645e-03 3 1  ON 36
ci_38                -1.316831e-03 3 1  ON 37
ci_39                -1.419498e-03 3 1  ON 38
ci_40                -1.829148e-03 3 1  ON 39
ci_41                -1.570413e-03 3 1  ON 40
ci_42                -1.273676e-03 3 1  ON 41
ci_43                -2.482537e-03 3 1  ON 42
ci_44                -1.870020e-03 3 1  ON 43
ci_45                -1.289642e-03 3 1  ON 44
ci_46                -1.090699e-03 3 1  ON 45
ci_47                -5.423836e-04 3 1  ON 46
ci_48                -7.592328e-04 3 1  ON 47
ci_49                -1.339353e-03 3 1  ON 48
ci_50                -1.018764e-03 3 1  ON 49
ci_51                 1.156098e-03 3 1  ON 50
ci_52                 9.464285e-04 3 1  ON 51
ci_53                -1.334933e-03 3 1  ON 52
ci_54                -1.229306e-03 3 1  ON 53
ci_55                -7.092959e-04 3 1  ON 54
ci_56                 1.625433e-03 3 1  ON 55
ci_57                 1.535958e-03 3 1  ON 56
ci_58                -1.105502e-03 3 1  ON 57
ci_59                -1.039697e-03 3 1  ON 58
ci_60                 1.183241e-03 3 1  ON 59
ci_61                 1.000343e-03 3 1  ON 60
ci_62                -7.088675e-04 3 1  ON 61
ci_63                -8.422608e-04 3 1  ON 62
ci_64                -7.221113e-04 3 1  ON 63
ci_65                -7.236177e-04 3 1  ON 64
ci_66                -9.348584e-04 3 1  ON 65
ci_67                -6.904820e-04 3 1  ON 66
ci_68                -2.596567e-05 3 1  ON 67
ci_69                 1.819459e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3212e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7299
    reference variance = 0.593192
====================================================
  Execution time = 2.5775e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.0111e-01
  Total weights = 1.963402273e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483902367181
                                         uncertainty =       0.003200482350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483902367181
                                         uncertainty =       0.003200482350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491881337
  error estimate for blocks of size 2^( 2) =       0.000512709234
  error estimate for blocks of size 2^( 3) =       0.000532462213
  error estimate for blocks of size 2^( 4) =       0.000547608725
  error estimate for blocks of size 2^( 5) =       0.000557534110
  error estimate for blocks of size 2^( 6) =       0.000563467488
  error estimate for blocks of size 2^( 7) =       0.000566108403

      target function =      -0.706252549231
              le_mean =     -22.815903967608
             les_mean =     521.066579092159
             stat err =       0.000558679682
             autocorr =       1.290045606483
   target nu stat err =       0.000558679682
   target dn stat err =       0.004289904149
      target stat err =       0.003033366600
              std dev =       0.695625257955
             le_variance =       0.483894499504


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281590396761e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706264725047       residual = 3.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708438155849       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708880078255       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708959035037       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708991452843       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709004382695       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709008825713       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709008909758       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709008872639       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709008814773       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709008844941       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 9.125634e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706264725047       residual = 3.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706982223926       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707117684521       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707139378313       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707147339447       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707149998488       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707150810505       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707150813837       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707150803433       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707150791514       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707150797490       residual = 9.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.699460e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706264725047       residual = 3.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706459659850       residual = 5.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706495466449       residual = 8.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706500975647       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706502918532       residual = 9.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706503528395       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.706503707504       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.706503707424       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.706503704890       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.706503702183       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 7.076159e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.564644 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0352e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.456023e-01 3 1  ON 0
ci_02                -4.219779e-02 3 1  ON 1
ci_03                -4.184462e-02 3 1  ON 2
ci_04                 3.890019e-02 3 1  ON 3
ci_05                -3.055913e-02 3 1  ON 4
ci_06                -2.947589e-02 3 1  ON 5
ci_07                 2.849616e-02 3 1  ON 6
ci_08                -1.132593e-02 3 1  ON 7
ci_09                -1.294472e-02 3 1  ON 8
ci_10                -1.287849e-02 3 1  ON 9
ci_11                 1.428100e-02 3 1  ON 10
ci_12                 1.009077e-02 3 1  ON 11
ci_13                 1.263064e-02 3 1  ON 12
ci_14                 1.227371e-02 3 1  ON 13
ci_15                 9.474991e-03 3 1  ON 14
ci_16                 9.384363e-03 3 1  ON 15
ci_17                -9.691809e-03 3 1  ON 16
ci_18                -8.910398e-03 3 1  ON 17
ci_19                 1.035275e-02 3 1  ON 18
ci_20                 8.565679e-03 3 1  ON 19
ci_21                 9.403335e-03 3 1  ON 20
ci_22                 9.430987e-03 3 1  ON 21
ci_23                 5.665212e-03 3 1  ON 22
ci_24                 5.037486e-03 3 1  ON 23
ci_25                 3.899895e-03 3 1  ON 24
ci_26                 3.820006e-03 3 1  ON 25
ci_27                 4.006574e-03 3 1  ON 26
ci_28                 3.139853e-03 3 1  ON 27
ci_29                 3.043282e-03 3 1  ON 28
ci_30                -2.464773e-03 3 1  ON 29
ci_31                -2.764714e-03 3 1  ON 30
ci_32                -1.839852e-03 3 1  ON 31
ci_33                -1.891011e-03 3 1  ON 32
ci_34                 1.883875e-03 3 1  ON 33
ci_35                 2.001282e-03 3 1  ON 34
ci_36                -1.640975e-03 3 1  ON 35
ci_37                -1.800560e-03 3 1  ON 36
ci_38                -1.193594e-03 3 1  ON 37
ci_39                -1.228306e-03 3 1  ON 38
ci_40                -1.741560e-03 3 1  ON 39
ci_41                -1.429861e-03 3 1  ON 40
ci_42                -1.205815e-03 3 1  ON 41
ci_43                -2.489593e-03 3 1  ON 42
ci_44                -1.717537e-03 3 1  ON 43
ci_45                -1.152148e-03 3 1  ON 44
ci_46                -1.070598e-03 3 1  ON 45
ci_47                -4.598286e-04 3 1  ON 46
ci_48                -6.983751e-04 3 1  ON 47
ci_49                -1.357136e-03 3 1  ON 48
ci_50                -1.007687e-03 3 1  ON 49
ci_51                 9.541991e-04 3 1  ON 50
ci_52                 8.779266e-04 3 1  ON 51
ci_53                -1.293357e-03 3 1  ON 52
ci_54                -1.011299e-03 3 1  ON 53
ci_55                -7.467430e-04 3 1  ON 54
ci_56                 1.585006e-03 3 1  ON 55
ci_57                 1.636370e-03 3 1  ON 56
ci_58                -1.206860e-03 3 1  ON 57
ci_59                -9.481494e-04 3 1  ON 58
ci_60                 1.120836e-03 3 1  ON 59
ci_61                 8.847137e-04 3 1  ON 60
ci_62                -7.035035e-04 3 1  ON 61
ci_63                -8.291968e-04 3 1  ON 62
ci_64                -9.304047e-04 3 1  ON 63
ci_65                -5.847640e-04 3 1  ON 64
ci_66                -9.111121e-04 3 1  ON 65
ci_67                -6.647921e-04 3 1  ON 66
ci_68                -1.895607e-04 3 1  ON 67
ci_69                 6.490903e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8499
    reference variance = 0.380242
====================================================
  Execution time = 2.4932e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 5.0363e-01
  Total weights = 1.9633e+06
  Execution time = 3.5853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486907060912
                                         uncertainty =       0.002508796193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486907060912
                                         uncertainty =       0.002508796193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493422749
  error estimate for blocks of size 2^( 2) =       0.000514029654
  error estimate for blocks of size 2^( 3) =       0.000534167475
  error estimate for blocks of size 2^( 4) =       0.000549428107
  error estimate for blocks of size 2^( 5) =       0.000559046408
  error estimate for blocks of size 2^( 6) =       0.000564201043
  error estimate for blocks of size 2^( 7) =       0.000563317931

      target function =      -0.695943460330
              le_mean =     -22.817507370151
             les_mean =     521.154768836743
             stat err =       0.000558998372
             autocorr =       1.283461217495
   target nu stat err =       0.000558998372
   target dn stat err =       0.006081160586
      target stat err =       0.004151125935
              std dev =       0.697805143048
             le_variance =       0.486932017664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554181274603
                                         uncertainty =       0.071286247762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554181274603
                                         uncertainty =       0.071286247762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526339405
  error estimate for blocks of size 2^( 2) =       0.000545592840
  error estimate for blocks of size 2^( 3) =       0.000564493137
  error estimate for blocks of size 2^( 4) =       0.000578870961
  error estimate for blocks of size 2^( 5) =       0.000587882052
  error estimate for blocks of size 2^( 6) =       0.000593495241
  error estimate for blocks of size 2^( 7) =       0.000592898673

      target function =      -0.011424791129
              le_mean =     -22.817865422184
             les_mean =     552.496778373460
             stat err =       0.000588286732
             autocorr =       1.249241310739
   target nu stat err =       0.000588286732
   target dn stat err =      31.299518051202
      target stat err =       0.011052599200
              std dev =       0.744356324296
             le_variance =       0.554066337519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482871372154
                                         uncertainty =       0.002772123962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482871372154
                                         uncertainty =       0.002772123962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491373958
  error estimate for blocks of size 2^( 2) =       0.000511921855
  error estimate for blocks of size 2^( 3) =       0.000532077927
  error estimate for blocks of size 2^( 4) =       0.000547377580
  error estimate for blocks of size 2^( 5) =       0.000557116360
  error estimate for blocks of size 2^( 6) =       0.000562284425
  error estimate for blocks of size 2^( 7) =       0.000561609444

      target function =      -0.632082335199
              le_mean =     -22.817468862084
             les_mean =     521.247963453558
             stat err =       0.000557096952
             autocorr =       1.285397035434
   target nu stat err =       0.000557096952
   target dn stat err =       0.100580384020
      target stat err =       0.056594895939
              std dev =       0.694907715132
             le_variance =       0.482896732549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486000046498
                                         uncertainty =       0.002503264751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486000046498
                                         uncertainty =       0.002503264751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492963162
  error estimate for blocks of size 2^( 2) =       0.000513563126
  error estimate for blocks of size 2^( 3) =       0.000533705017
  error estimate for blocks of size 2^( 4) =       0.000548971110
  error estimate for blocks of size 2^( 5) =       0.000558592515
  error estimate for blocks of size 2^( 6) =       0.000563747269
  error estimate for blocks of size 2^( 7) =       0.000562871281

      target function =      -0.696795204407
              le_mean =     -22.817480145701
             les_mean =     521.152223652314
             stat err =       0.000558545544
             autocorr =       1.283773036300
   target nu stat err =       0.000558545544
   target dn stat err =       0.009165695274
      target stat err =       0.006241786498
              std dev =       0.697155189200
             le_variance =       0.486025357828


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.695943460330        initial
     9.7656e-02     9.7656e-01             9.1256e-03        -0.011424791129
     3.9062e-01     3.9062e+00             2.6995e-03        -0.632082335199
     1.5625e+00     1.5625e+01             7.0762e-04        -0.696795204407  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 4.2917e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.475942e-01 3 1  ON 0
ci_02                -4.362371e-02 3 1  ON 1
ci_03                -4.334170e-02 3 1  ON 2
ci_04                 4.060303e-02 3 1  ON 3
ci_05                -3.132740e-02 3 1  ON 4
ci_06                -3.055710e-02 3 1  ON 5
ci_07                 2.868394e-02 3 1  ON 6
ci_08                -1.196642e-02 3 1  ON 7
ci_09                -1.342693e-02 3 1  ON 8
ci_10                -1.322363e-02 3 1  ON 9
ci_11                 1.442770e-02 3 1  ON 10
ci_12                 1.036481e-02 3 1  ON 11
ci_13                 1.258549e-02 3 1  ON 12
ci_14                 1.225619e-02 3 1  ON 13
ci_15                 9.720235e-03 3 1  ON 14
ci_16                 9.632234e-03 3 1  ON 15
ci_17                -9.954112e-03 3 1  ON 16
ci_18                -9.208552e-03 3 1  ON 17
ci_19                 1.044550e-02 3 1  ON 18
ci_20                 8.708838e-03 3 1  ON 19
ci_21                 9.358400e-03 3 1  ON 20
ci_22                 9.402599e-03 3 1  ON 21
ci_23                 5.747288e-03 3 1  ON 22
ci_24                 5.110416e-03 3 1  ON 23
ci_25                 4.011734e-03 3 1  ON 24
ci_26                 3.966825e-03 3 1  ON 25
ci_27                 3.996757e-03 3 1  ON 26
ci_28                 3.167632e-03 3 1  ON 27
ci_29                 3.205221e-03 3 1  ON 28
ci_30                -2.613484e-03 3 1  ON 29
ci_31                -2.851999e-03 3 1  ON 30
ci_32                -1.984468e-03 3 1  ON 31
ci_33                -2.004671e-03 3 1  ON 32
ci_34                 1.976591e-03 3 1  ON 33
ci_35                 2.066306e-03 3 1  ON 34
ci_36                -1.754748e-03 3 1  ON 35
ci_37                -1.863653e-03 3 1  ON 36
ci_38                -1.283443e-03 3 1  ON 37
ci_39                -1.367676e-03 3 1  ON 38
ci_40                -1.805458e-03 3 1  ON 39
ci_41                -1.531293e-03 3 1  ON 40
ci_42                -1.254381e-03 3 1  ON 41
ci_43                -2.485313e-03 3 1  ON 42
ci_44                -1.829781e-03 3 1  ON 43
ci_45                -1.252423e-03 3 1  ON 44
ci_46                -1.085433e-03 3 1  ON 45
ci_47                -5.208990e-04 3 1  ON 46
ci_48                -7.438832e-04 3 1  ON 47
ci_49                -1.344413e-03 3 1  ON 48
ci_50                -1.015760e-03 3 1  ON 49
ci_51                 1.101283e-03 3 1  ON 50
ci_52                 9.280597e-04 3 1  ON 51
ci_53                -1.323655e-03 3 1  ON 52
ci_54                -1.170625e-03 3 1  ON 53
ci_55                -7.196403e-04 3 1  ON 54
ci_56                 1.614183e-03 3 1  ON 55
ci_57                 1.563051e-03 3 1  ON 56
ci_58                -1.132815e-03 3 1  ON 57
ci_59                -1.014948e-03 3 1  ON 58
ci_60                 1.167390e-03 3 1  ON 59
ci_61                 9.706216e-04 3 1  ON 60
ci_62                -7.076253e-04 3 1  ON 61
ci_63                -8.389891e-04 3 1  ON 62
ci_64                -7.789666e-04 3 1  ON 63
ci_65                -6.860078e-04 3 1  ON 64
ci_66                -9.283724e-04 3 1  ON 65
ci_67                -6.836228e-04 3 1  ON 66
ci_68                -7.007600e-05 3 1  ON 67
ci_69                 1.502989e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3284e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8365
    reference variance = 0.545554
====================================================
  Execution time = 2.5767e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5335e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 5.1660e-01
  Total weights = 1.963300393e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488296695252
                                         uncertainty =       0.002837730837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488296695252
                                         uncertainty =       0.002837730837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494147127
  error estimate for blocks of size 2^( 2) =       0.000515248641
  error estimate for blocks of size 2^( 3) =       0.000535195219
  error estimate for blocks of size 2^( 4) =       0.000550779648
  error estimate for blocks of size 2^( 5) =       0.000561794425
  error estimate for blocks of size 2^( 6) =       0.000566686949
  error estimate for blocks of size 2^( 7) =       0.000571158567

      target function =      -0.695540858019
              le_mean =     -22.818291166620
             les_mean =     521.191007842761
             stat err =       0.000562604897
             autocorr =       1.296267005892
   target nu stat err =       0.000562604897
   target dn stat err =       0.012671878024
      target stat err =       0.008593529728
              std dev =       0.698829568718
             le_variance =       0.488362766114


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281829116662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.695645993121       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.696405411557       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.696524372079       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.696544509962       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.696550755106       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.696553702413       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.696554393653       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.696554402877       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.696554422738       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.696554376159       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.696554378631       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.696554368552       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.241268e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.695645993121       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.695851941513       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.695883255201       residual = 7.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.695888387581       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.695889923061       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.695890604932       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.695890751735       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.695890751035       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.695890754816       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.695890743578       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.695890744120       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.695890741799       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 6.016239e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.695645993121       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.695698593263       residual = 5.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.695706524453       residual = 7.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.695707812756       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.695708194341       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.695708360962       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.695708395973       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.695708395615       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.695708396485       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.695708393709       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.695708393841       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.695708393275       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.537782e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.574607 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0403e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.470067e-01 3 1  ON 0
ci_02                -4.313592e-02 3 1  ON 1
ci_03                -4.285781e-02 3 1  ON 2
ci_04                 4.000141e-02 3 1  ON 3
ci_05                -3.088728e-02 3 1  ON 4
ci_06                -3.015275e-02 3 1  ON 5
ci_07                 2.862655e-02 3 1  ON 6
ci_08                -1.174485e-02 3 1  ON 7
ci_09                -1.328890e-02 3 1  ON 8
ci_10                -1.313413e-02 3 1  ON 9
ci_11                 1.438059e-02 3 1  ON 10
ci_12                 1.023013e-02 3 1  ON 11
ci_13                 1.260176e-02 3 1  ON 12
ci_14                 1.214487e-02 3 1  ON 13
ci_15                 9.607235e-03 3 1  ON 14
ci_16                 9.537889e-03 3 1  ON 15
ci_17                -9.790905e-03 3 1  ON 16
ci_18                -9.099218e-03 3 1  ON 17
ci_19                 1.037836e-02 3 1  ON 18
ci_20                 8.580387e-03 3 1  ON 19
ci_21                 9.200635e-03 3 1  ON 20
ci_22                 9.400796e-03 3 1  ON 21
ci_23                 5.653730e-03 3 1  ON 22
ci_24                 5.005245e-03 3 1  ON 23
ci_25                 3.912616e-03 3 1  ON 24
ci_26                 3.932248e-03 3 1  ON 25
ci_27                 4.080965e-03 3 1  ON 26
ci_28                 3.096945e-03 3 1  ON 27
ci_29                 3.154567e-03 3 1  ON 28
ci_30                -2.513774e-03 3 1  ON 29
ci_31                -2.806306e-03 3 1  ON 30
ci_32                -1.941203e-03 3 1  ON 31
ci_33                -2.011191e-03 3 1  ON 32
ci_34                 1.916477e-03 3 1  ON 33
ci_35                 1.904571e-03 3 1  ON 34
ci_36                -1.683773e-03 3 1  ON 35
ci_37                -1.838050e-03 3 1  ON 36
ci_38                -1.245906e-03 3 1  ON 37
ci_39                -1.358871e-03 3 1  ON 38
ci_40                -1.811464e-03 3 1  ON 39
ci_41                -1.500302e-03 3 1  ON 40
ci_42                -1.267453e-03 3 1  ON 41
ci_43                -2.555320e-03 3 1  ON 42
ci_44                -1.755250e-03 3 1  ON 43
ci_45                -1.216477e-03 3 1  ON 44
ci_46                -1.008717e-03 3 1  ON 45
ci_47                -5.262664e-04 3 1  ON 46
ci_48                -6.767770e-04 3 1  ON 47
ci_49                -1.330397e-03 3 1  ON 48
ci_50                -1.018924e-03 3 1  ON 49
ci_51                 1.065266e-03 3 1  ON 50
ci_52                 9.023687e-04 3 1  ON 51
ci_53                -1.234492e-03 3 1  ON 52
ci_54                -1.102437e-03 3 1  ON 53
ci_55                -7.268643e-04 3 1  ON 54
ci_56                 1.588238e-03 3 1  ON 55
ci_57                 1.561959e-03 3 1  ON 56
ci_58                -1.057735e-03 3 1  ON 57
ci_59                -9.071010e-04 3 1  ON 58
ci_60                 9.716985e-04 3 1  ON 59
ci_61                 8.894207e-04 3 1  ON 60
ci_62                -6.537566e-04 3 1  ON 61
ci_63                -8.299093e-04 3 1  ON 62
ci_64                -7.538265e-04 3 1  ON 63
ci_65                -6.210016e-04 3 1  ON 64
ci_66                -8.846092e-04 3 1  ON 65
ci_67                -6.932760e-04 3 1  ON 66
ci_68                -2.770340e-05 3 1  ON 67
ci_69                 1.536347e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8455
    reference variance = 0.506089
====================================================
  Execution time = 2.5101e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.9986e-01
  Total weights = 1.9635e+06
  Execution time = 3.5953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483362108623
                                         uncertainty =       0.003339443558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483362108623
                                         uncertainty =       0.003339443558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491577188
  error estimate for blocks of size 2^( 2) =       0.000512760961
  error estimate for blocks of size 2^( 3) =       0.000533007148
  error estimate for blocks of size 2^( 4) =       0.000548347475
  error estimate for blocks of size 2^( 5) =       0.000558421331
  error estimate for blocks of size 2^( 6) =       0.000563493446
  error estimate for blocks of size 2^( 7) =       0.000567998431

      target function =      -0.698272378113
              le_mean =     -22.815621716052
             les_mean =     521.065194186342
             stat err =       0.000559565170
             autocorr =       1.295740122755
   target nu stat err =       0.000559565170
   target dn stat err =       0.011568704978
      target stat err =       0.007880372749
              std dev =       0.695195126320
             le_variance =       0.483296263658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481174398940
                                         uncertainty =       0.003334084484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481174398940
                                         uncertainty =       0.003334084484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490463607
  error estimate for blocks of size 2^( 2) =       0.000511658300
  error estimate for blocks of size 2^( 3) =       0.000531937207
  error estimate for blocks of size 2^( 4) =       0.000547307548
  error estimate for blocks of size 2^( 5) =       0.000557410051
  error estimate for blocks of size 2^( 6) =       0.000562464730
  error estimate for blocks of size 2^( 7) =       0.000566860832

      target function =      -0.707179378494
              le_mean =     -22.815650975508
             les_mean =     521.053691024559
             stat err =       0.000558510790
             autocorr =       1.296730007201
   target nu stat err =       0.000558510790
   target dn stat err =       0.005081573449
      target stat err =       0.003584153986
              std dev =       0.693620284681
             le_variance =       0.481109099320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482105202835
                                         uncertainty =       0.003336141097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482105202835
                                         uncertainty =       0.003336141097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490937731
  error estimate for blocks of size 2^( 2) =       0.000512126054
  error estimate for blocks of size 2^( 3) =       0.000532389292
  error estimate for blocks of size 2^( 4) =       0.000547746709
  error estimate for blocks of size 2^( 5) =       0.000557836620
  error estimate for blocks of size 2^( 6) =       0.000562900519
  error estimate for blocks of size 2^( 7) =       0.000567344484

      target function =      -0.707507036531
              le_mean =     -22.815626571379
             les_mean =     521.052107524734
             stat err =       0.000558957083
             autocorr =       1.296295774141
   target nu stat err =       0.000558957083
   target dn stat err =       0.005024229070
      target stat err =       0.003547858552
              std dev =       0.694290797682
             le_variance =       0.482039711746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483189744991
                                         uncertainty =       0.003338693265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483189744991
                                         uncertainty =       0.003338693265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491489553
  error estimate for blocks of size 2^( 2) =       0.000512673448
  error estimate for blocks of size 2^( 3) =       0.000532921780
  error estimate for blocks of size 2^( 4) =       0.000548265311
  error estimate for blocks of size 2^( 5) =       0.000558340523
  error estimate for blocks of size 2^( 6) =       0.000563411979
  error estimate for blocks of size 2^( 7) =       0.000567906270

      target function =      -0.702713617127
              le_mean =     -22.815621247656
             les_mean =     521.058754186956
             stat err =       0.000559481021
             autocorr =       1.295812408451
   target nu stat err =       0.000559481021
   target dn stat err =       0.007409085961
      target stat err =       0.005128081402
              std dev =       0.695071192061
             le_variance =       0.483123962034


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.698272378113        initial
     3.9062e-01     3.9062e+00             2.2413e-03        -0.707179378494
     1.5625e+00     1.5625e+01             6.0162e-04        -0.707507036531  <--
     6.2500e+00     6.2500e+01             1.5378e-04        -0.702713617127

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 4.6099e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.470067e-01 3 1  ON 0
ci_02                -4.313592e-02 3 1  ON 1
ci_03                -4.285781e-02 3 1  ON 2
ci_04                 4.000141e-02 3 1  ON 3
ci_05                -3.088728e-02 3 1  ON 4
ci_06                -3.015275e-02 3 1  ON 5
ci_07                 2.862655e-02 3 1  ON 6
ci_08                -1.174485e-02 3 1  ON 7
ci_09                -1.328890e-02 3 1  ON 8
ci_10                -1.313413e-02 3 1  ON 9
ci_11                 1.438059e-02 3 1  ON 10
ci_12                 1.023013e-02 3 1  ON 11
ci_13                 1.260176e-02 3 1  ON 12
ci_14                 1.214487e-02 3 1  ON 13
ci_15                 9.607235e-03 3 1  ON 14
ci_16                 9.537889e-03 3 1  ON 15
ci_17                -9.790905e-03 3 1  ON 16
ci_18                -9.099218e-03 3 1  ON 17
ci_19                 1.037836e-02 3 1  ON 18
ci_20                 8.580387e-03 3 1  ON 19
ci_21                 9.200635e-03 3 1  ON 20
ci_22                 9.400796e-03 3 1  ON 21
ci_23                 5.653730e-03 3 1  ON 22
ci_24                 5.005245e-03 3 1  ON 23
ci_25                 3.912616e-03 3 1  ON 24
ci_26                 3.932248e-03 3 1  ON 25
ci_27                 4.080965e-03 3 1  ON 26
ci_28                 3.096945e-03 3 1  ON 27
ci_29                 3.154567e-03 3 1  ON 28
ci_30                -2.513774e-03 3 1  ON 29
ci_31                -2.806306e-03 3 1  ON 30
ci_32                -1.941203e-03 3 1  ON 31
ci_33                -2.011191e-03 3 1  ON 32
ci_34                 1.916477e-03 3 1  ON 33
ci_35                 1.904571e-03 3 1  ON 34
ci_36                -1.683773e-03 3 1  ON 35
ci_37                -1.838050e-03 3 1  ON 36
ci_38                -1.245906e-03 3 1  ON 37
ci_39                -1.358871e-03 3 1  ON 38
ci_40                -1.811464e-03 3 1  ON 39
ci_41                -1.500302e-03 3 1  ON 40
ci_42                -1.267453e-03 3 1  ON 41
ci_43                -2.555320e-03 3 1  ON 42
ci_44                -1.755250e-03 3 1  ON 43
ci_45                -1.216477e-03 3 1  ON 44
ci_46                -1.008717e-03 3 1  ON 45
ci_47                -5.262664e-04 3 1  ON 46
ci_48                -6.767770e-04 3 1  ON 47
ci_49                -1.330397e-03 3 1  ON 48
ci_50                -1.018924e-03 3 1  ON 49
ci_51                 1.065266e-03 3 1  ON 50
ci_52                 9.023687e-04 3 1  ON 51
ci_53                -1.234492e-03 3 1  ON 52
ci_54                -1.102437e-03 3 1  ON 53
ci_55                -7.268643e-04 3 1  ON 54
ci_56                 1.588238e-03 3 1  ON 55
ci_57                 1.561959e-03 3 1  ON 56
ci_58                -1.057735e-03 3 1  ON 57
ci_59                -9.071010e-04 3 1  ON 58
ci_60                 9.716985e-04 3 1  ON 59
ci_61                 8.894207e-04 3 1  ON 60
ci_62                -6.537566e-04 3 1  ON 61
ci_63                -8.299093e-04 3 1  ON 62
ci_64                -7.538265e-04 3 1  ON 63
ci_65                -6.210016e-04 3 1  ON 64
ci_66                -8.846092e-04 3 1  ON 65
ci_67                -6.932760e-04 3 1  ON 66
ci_68                -2.770340e-05 3 1  ON 67
ci_69                 1.536347e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6514e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8463
    reference variance = 0.435399
====================================================
  Execution time = 2.5804e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 5.0117e-01
  Total weights = 1.963352478e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482042291552
                                         uncertainty =       0.002480136599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482042291552
                                         uncertainty =       0.002480136599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490926556
  error estimate for blocks of size 2^( 2) =       0.000512272558
  error estimate for blocks of size 2^( 3) =       0.000532523352
  error estimate for blocks of size 2^( 4) =       0.000547735204
  error estimate for blocks of size 2^( 5) =       0.000557144772
  error estimate for blocks of size 2^( 6) =       0.000563397176
  error estimate for blocks of size 2^( 7) =       0.000567191186

      target function =      -0.706222585229
              le_mean =     -22.816913599574
             les_mean =     521.112712172428
             stat err =       0.000558867084
             autocorr =       1.295937366607
   target nu stat err =       0.000558867084
   target dn stat err =       0.004304265490
      target stat err =       0.003047257017
              std dev =       0.694274993988
             le_variance =       0.482017767278


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281691359957e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706234897109       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706921131390       residual = 5.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707039911882       residual = 7.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707057680648       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707062671981       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707064242741       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707064700481       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707064840097       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707064954418       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707064930204       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.707064915235       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.250204e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706234897109       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706421297458       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706452671427       residual = 6.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706457200248       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706458415672       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706458771728       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.706458867124       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.706458899839       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.706458925523       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.706458919471       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.706458916269       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 5.899902e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706234897109       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706282525940       residual = 5.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706290479910       residual = 6.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706291616647       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706291917811       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706292004326       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.706292026948       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.706292034981       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.706292041206       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.706292039697       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.706292038932       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.493246e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.578746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0438e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.464167e-01 3 1  ON 0
ci_02                -4.260689e-02 3 1  ON 1
ci_03                -4.232521e-02 3 1  ON 2
ci_04                 3.944712e-02 3 1  ON 3
ci_05                -3.052415e-02 3 1  ON 4
ci_06                -2.981188e-02 3 1  ON 5
ci_07                 2.858440e-02 3 1  ON 6
ci_08                -1.150566e-02 3 1  ON 7
ci_09                -1.307279e-02 3 1  ON 8
ci_10                -1.295909e-02 3 1  ON 9
ci_11                 1.432404e-02 3 1  ON 10
ci_12                 1.015010e-02 3 1  ON 11
ci_13                 1.255772e-02 3 1  ON 12
ci_14                 1.217684e-02 3 1  ON 13
ci_15                 9.500096e-03 3 1  ON 14
ci_16                 9.422844e-03 3 1  ON 15
ci_17                -9.675670e-03 3 1  ON 16
ci_18                -8.998421e-03 3 1  ON 17
ci_19                 1.032247e-02 3 1  ON 18
ci_20                 8.521300e-03 3 1  ON 19
ci_21                 9.194360e-03 3 1  ON 20
ci_22                 9.348439e-03 3 1  ON 21
ci_23                 5.619352e-03 3 1  ON 22
ci_24                 4.950027e-03 3 1  ON 23
ci_25                 3.868210e-03 3 1  ON 24
ci_26                 3.883921e-03 3 1  ON 25
ci_27                 4.029863e-03 3 1  ON 26
ci_28                 3.066956e-03 3 1  ON 27
ci_29                 3.078779e-03 3 1  ON 28
ci_30                -2.497600e-03 3 1  ON 29
ci_31                -2.801408e-03 3 1  ON 30
ci_32                -1.890439e-03 3 1  ON 31
ci_33                -1.961787e-03 3 1  ON 32
ci_34                 1.938258e-03 3 1  ON 33
ci_35                 1.810698e-03 3 1  ON 34
ci_36                -1.661909e-03 3 1  ON 35
ci_37                -1.797568e-03 3 1  ON 36
ci_38                -1.230554e-03 3 1  ON 37
ci_39                -1.320661e-03 3 1  ON 38
ci_40                -1.803720e-03 3 1  ON 39
ci_41                -1.470539e-03 3 1  ON 40
ci_42                -1.223480e-03 3 1  ON 41
ci_43                -2.579583e-03 3 1  ON 42
ci_44                -1.759432e-03 3 1  ON 43
ci_45                -1.196022e-03 3 1  ON 44
ci_46                -9.756061e-04 3 1  ON 45
ci_47                -4.733426e-04 3 1  ON 46
ci_48                -6.339781e-04 3 1  ON 47
ci_49                -1.307635e-03 3 1  ON 48
ci_50                -1.005559e-03 3 1  ON 49
ci_51                 1.032980e-03 3 1  ON 50
ci_52                 8.980090e-04 3 1  ON 51
ci_53                -1.201544e-03 3 1  ON 52
ci_54                -1.062922e-03 3 1  ON 53
ci_55                -7.223968e-04 3 1  ON 54
ci_56                 1.604156e-03 3 1  ON 55
ci_57                 1.586007e-03 3 1  ON 56
ci_58                -1.060860e-03 3 1  ON 57
ci_59                -8.676530e-04 3 1  ON 58
ci_60                 9.955964e-04 3 1  ON 59
ci_61                 8.835819e-04 3 1  ON 60
ci_62                -6.386756e-04 3 1  ON 61
ci_63                -8.033005e-04 3 1  ON 62
ci_64                -7.208953e-04 3 1  ON 63
ci_65                -5.831039e-04 3 1  ON 64
ci_66                -8.840492e-04 3 1  ON 65
ci_67                -6.943774e-04 3 1  ON 66
ci_68                -9.035251e-05 3 1  ON 67
ci_69                 1.188371e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8714
    reference variance = 0.846856
====================================================
  Execution time = 2.5171e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.0053e-01
  Total weights = 1.9637e+06
  Execution time = 3.6096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482348246939
                                         uncertainty =       0.003836280266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482348246939
                                         uncertainty =       0.003836280266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491119051
  error estimate for blocks of size 2^( 2) =       0.000512170349
  error estimate for blocks of size 2^( 3) =       0.000531546757
  error estimate for blocks of size 2^( 4) =       0.000546721343
  error estimate for blocks of size 2^( 5) =       0.000556180668
  error estimate for blocks of size 2^( 6) =       0.000561586045
  error estimate for blocks of size 2^( 7) =       0.000564730122

      target function =      -0.705963696120
              le_mean =     -22.816479649199
             les_mean =     521.093242554189
             stat err =       0.000557304545
             autocorr =       1.287690842751
   target nu stat err =       0.000557304545
   target dn stat err =       0.007106438599
      target stat err =       0.004972087386
              std dev =       0.694547222513
             le_variance =       0.482395844300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480469046283
                                         uncertainty =       0.004009243691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480469046283
                                         uncertainty =       0.004009243691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490162350
  error estimate for blocks of size 2^( 2) =       0.000511199738
  error estimate for blocks of size 2^( 3) =       0.000530594627
  error estimate for blocks of size 2^( 4) =       0.000545774592
  error estimate for blocks of size 2^( 5) =       0.000555268527
  error estimate for blocks of size 2^( 6) =       0.000560712163
  error estimate for blocks of size 2^( 7) =       0.000563786887

      target function =      -0.705311447750
              le_mean =     -22.816466984367
             les_mean =     521.093601021278
             stat err =       0.000556385542
             autocorr =       1.288462469988
   target nu stat err =       0.000556385542
   target dn stat err =       0.007272728100
      target stat err =       0.005077514201
              std dev =       0.693194243493
             le_variance =       0.480518259212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481259871813
                                         uncertainty =       0.003924767209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481259871813
                                         uncertainty =       0.003924767209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490565165
  error estimate for blocks of size 2^( 2) =       0.000511607250
  error estimate for blocks of size 2^( 3) =       0.000530991537
  error estimate for blocks of size 2^( 4) =       0.000546166410
  error estimate for blocks of size 2^( 5) =       0.000555645114
  error estimate for blocks of size 2^( 6) =       0.000561070106
  error estimate for blocks of size 2^( 7) =       0.000564175052

      target function =      -0.705816189127
              le_mean =     -22.816463392958
             les_mean =     521.092712927912
             stat err =       0.000556764170
             autocorr =       1.288098714608
   target nu stat err =       0.000556764170
   target dn stat err =       0.007088140008
      target stat err =       0.004957208510
              std dev =       0.693763909564
             le_variance =       0.481308362214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482199801467
                                         uncertainty =       0.003846888945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482199801467
                                         uncertainty =       0.003846888945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491043540
  error estimate for blocks of size 2^( 2) =       0.000512093537
  error estimate for blocks of size 2^( 3) =       0.000531470577
  error estimate for blocks of size 2^( 4) =       0.000546645192
  error estimate for blocks of size 2^( 5) =       0.000556107074
  error estimate for blocks of size 2^( 6) =       0.000561515211
  error estimate for blocks of size 2^( 7) =       0.000564654797

      target function =      -0.705858508990
              le_mean =     -22.816476481398
             les_mean =     521.093249181656
             stat err =       0.000557230568
             autocorr =       1.287744968042
   target nu stat err =       0.000557230568
   target dn stat err =       0.007111161228
      target stat err =       0.004973848082
              std dev =       0.694440433976
             le_variance =       0.482247516341


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.705963696120        initial  <--
     3.9062e-01     3.9062e+00             2.2502e-03        -0.705311447750
     1.5625e+00     1.5625e+01             5.8999e-04        -0.705816189127
     6.2500e+00     6.2500e+01             1.4932e-04        -0.705858508990

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.2672
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.470067e-01 3 1  ON 0
ci_02                -4.313592e-02 3 1  ON 1
ci_03                -4.285781e-02 3 1  ON 2
ci_04                 4.000141e-02 3 1  ON 3
ci_05                -3.088728e-02 3 1  ON 4
ci_06                -3.015275e-02 3 1  ON 5
ci_07                 2.862655e-02 3 1  ON 6
ci_08                -1.174485e-02 3 1  ON 7
ci_09                -1.328890e-02 3 1  ON 8
ci_10                -1.313413e-02 3 1  ON 9
ci_11                 1.438059e-02 3 1  ON 10
ci_12                 1.023013e-02 3 1  ON 11
ci_13                 1.260176e-02 3 1  ON 12
ci_14                 1.214487e-02 3 1  ON 13
ci_15                 9.607235e-03 3 1  ON 14
ci_16                 9.537889e-03 3 1  ON 15
ci_17                -9.790905e-03 3 1  ON 16
ci_18                -9.099218e-03 3 1  ON 17
ci_19                 1.037836e-02 3 1  ON 18
ci_20                 8.580387e-03 3 1  ON 19
ci_21                 9.200635e-03 3 1  ON 20
ci_22                 9.400796e-03 3 1  ON 21
ci_23                 5.653730e-03 3 1  ON 22
ci_24                 5.005245e-03 3 1  ON 23
ci_25                 3.912616e-03 3 1  ON 24
ci_26                 3.932248e-03 3 1  ON 25
ci_27                 4.080965e-03 3 1  ON 26
ci_28                 3.096945e-03 3 1  ON 27
ci_29                 3.154567e-03 3 1  ON 28
ci_30                -2.513774e-03 3 1  ON 29
ci_31                -2.806306e-03 3 1  ON 30
ci_32                -1.941203e-03 3 1  ON 31
ci_33                -2.011191e-03 3 1  ON 32
ci_34                 1.916477e-03 3 1  ON 33
ci_35                 1.904571e-03 3 1  ON 34
ci_36                -1.683773e-03 3 1  ON 35
ci_37                -1.838050e-03 3 1  ON 36
ci_38                -1.245906e-03 3 1  ON 37
ci_39                -1.358871e-03 3 1  ON 38
ci_40                -1.811464e-03 3 1  ON 39
ci_41                -1.500302e-03 3 1  ON 40
ci_42                -1.267453e-03 3 1  ON 41
ci_43                -2.555320e-03 3 1  ON 42
ci_44                -1.755250e-03 3 1  ON 43
ci_45                -1.216477e-03 3 1  ON 44
ci_46                -1.008717e-03 3 1  ON 45
ci_47                -5.262664e-04 3 1  ON 46
ci_48                -6.767770e-04 3 1  ON 47
ci_49                -1.330397e-03 3 1  ON 48
ci_50                -1.018924e-03 3 1  ON 49
ci_51                 1.065266e-03 3 1  ON 50
ci_52                 9.023687e-04 3 1  ON 51
ci_53                -1.234492e-03 3 1  ON 52
ci_54                -1.102437e-03 3 1  ON 53
ci_55                -7.268643e-04 3 1  ON 54
ci_56                 1.588238e-03 3 1  ON 55
ci_57                 1.561959e-03 3 1  ON 56
ci_58                -1.057735e-03 3 1  ON 57
ci_59                -9.071010e-04 3 1  ON 58
ci_60                 9.716985e-04 3 1  ON 59
ci_61                 8.894207e-04 3 1  ON 60
ci_62                -6.537566e-04 3 1  ON 61
ci_63                -8.299093e-04 3 1  ON 62
ci_64                -7.538265e-04 3 1  ON 63
ci_65                -6.210016e-04 3 1  ON 64
ci_66                -8.846092e-04 3 1  ON 65
ci_67                -6.932760e-04 3 1  ON 66
ci_68                -2.770340e-05 3 1  ON 67
ci_69                 1.536347e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3712e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.8009
    reference variance = 0.33584
====================================================
  Execution time = 2.5987e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9495e-01
  Total weights = 1.963435364e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478622833867
                                         uncertainty =       0.002338380698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478622833867
                                         uncertainty =       0.002338380698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489170228
  error estimate for blocks of size 2^( 2) =       0.000510450566
  error estimate for blocks of size 2^( 3) =       0.000529594299
  error estimate for blocks of size 2^( 4) =       0.000544495308
  error estimate for blocks of size 2^( 5) =       0.000554323020
  error estimate for blocks of size 2^( 6) =       0.000560975082
  error estimate for blocks of size 2^( 7) =       0.000564980575

      target function =      -0.710586745106
              le_mean =     -22.817154725090
             les_mean =     521.117499816813
             stat err =       0.000556193496
             autocorr =       1.292801295367
   target nu stat err =       0.000556193496
   target dn stat err =       0.003296420914
      target stat err =       0.002389122914
              std dev =       0.691791170710
             le_variance =       0.478575023872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281715472509e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710594008556       residual = 4.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710674232985       residual = 5.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710687701639       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710689932172       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710690610375       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710690863466       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710690937036       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710690951419       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710690955415       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710690956195       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710690956432       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.744533e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710594008556       residual = 4.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710614246136       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710617631966       residual = 7.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710618190352       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710618359076       residual = 8.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710618421867       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710618440038       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710618443580       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710618444558       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710618444748       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710618444805       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 6.895049e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710594008556       residual = 4.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710599079420       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710599927050       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710600066692       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710600108820       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710600124487       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710600129016       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710600129898       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710600130142       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710600130188       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710600130203       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 1.725883e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.582805 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0574e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.469377e-01 3 1  ON 0
ci_02                -4.307849e-02 3 1  ON 1
ci_03                -4.280555e-02 3 1  ON 2
ci_04                 3.993867e-02 3 1  ON 3
ci_05                -3.085781e-02 3 1  ON 4
ci_06                -3.012070e-02 3 1  ON 5
ci_07                 2.861530e-02 3 1  ON 6
ci_08                -1.171906e-02 3 1  ON 7
ci_09                -1.326984e-02 3 1  ON 8
ci_10                -1.311752e-02 3 1  ON 9
ci_11                 1.437820e-02 3 1  ON 10
ci_12                 1.022155e-02 3 1  ON 11
ci_13                 1.260384e-02 3 1  ON 12
ci_14                 1.215667e-02 3 1  ON 13
ci_15                 9.596623e-03 3 1  ON 14
ci_16                 9.525186e-03 3 1  ON 15
ci_17                -9.785734e-03 3 1  ON 16
ci_18                -9.087853e-03 3 1  ON 17
ci_19                 1.037303e-02 3 1  ON 18
ci_20                 8.574256e-03 3 1  ON 19
ci_21                 9.198893e-03 3 1  ON 20
ci_22                 9.399843e-03 3 1  ON 21
ci_23                 5.649643e-03 3 1  ON 22
ci_24                 5.000132e-03 3 1  ON 23
ci_25                 3.908833e-03 3 1  ON 24
ci_26                 3.928021e-03 3 1  ON 25
ci_27                 4.075404e-03 3 1  ON 26
ci_28                 3.093535e-03 3 1  ON 27
ci_29                 3.152218e-03 3 1  ON 28
ci_30                -2.506181e-03 3 1  ON 29
ci_31                -2.807275e-03 3 1  ON 30
ci_32                -1.937537e-03 3 1  ON 31
ci_33                -2.005586e-03 3 1  ON 32
ci_34                 1.909105e-03 3 1  ON 33
ci_35                 1.898328e-03 3 1  ON 34
ci_36                -1.680507e-03 3 1  ON 35
ci_37                -1.831594e-03 3 1  ON 36
ci_38                -1.241132e-03 3 1  ON 37
ci_39                -1.354841e-03 3 1  ON 38
ci_40                -1.808766e-03 3 1  ON 39
ci_41                -1.497228e-03 3 1  ON 40
ci_42                -1.265211e-03 3 1  ON 41
ci_43                -2.547708e-03 3 1  ON 42
ci_44                -1.759642e-03 3 1  ON 43
ci_45                -1.211960e-03 3 1  ON 44
ci_46                -1.005820e-03 3 1  ON 45
ci_47                -5.203785e-04 3 1  ON 46
ci_48                -6.726597e-04 3 1  ON 47
ci_49                -1.330673e-03 3 1  ON 48
ci_50                -1.018634e-03 3 1  ON 49
ci_51                 1.060406e-03 3 1  ON 50
ci_52                 8.995050e-04 3 1  ON 51
ci_53                -1.233777e-03 3 1  ON 52
ci_54                -1.102028e-03 3 1  ON 53
ci_55                -7.285316e-04 3 1  ON 54
ci_56                 1.588941e-03 3 1  ON 55
ci_57                 1.562602e-03 3 1  ON 56
ci_58                -1.058150e-03 3 1  ON 57
ci_59                -9.064675e-04 3 1  ON 58
ci_60                 9.656347e-04 3 1  ON 59
ci_61                 8.829293e-04 3 1  ON 60
ci_62                -6.529940e-04 3 1  ON 61
ci_63                -8.287996e-04 3 1  ON 62
ci_64                -7.539196e-04 3 1  ON 63
ci_65                -6.194762e-04 3 1  ON 64
ci_66                -8.804064e-04 3 1  ON 65
ci_67                -6.948458e-04 3 1  ON 66
ci_68                -2.544331e-05 3 1  ON 67
ci_69                 1.502971e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.8242
    reference variance = 0.345765
====================================================
  Execution time = 2.5249e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.0077e-01
  Total weights = 1.9637e+06
  Execution time = 3.5730e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481609898313
                                         uncertainty =       0.002790243886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481609898313
                                         uncertainty =       0.002790243886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490747232
  error estimate for blocks of size 2^( 2) =       0.000511758445
  error estimate for blocks of size 2^( 3) =       0.000531819807
  error estimate for blocks of size 2^( 4) =       0.000546076067
  error estimate for blocks of size 2^( 5) =       0.000555896765
  error estimate for blocks of size 2^( 6) =       0.000561180511
  error estimate for blocks of size 2^( 7) =       0.000563214662

      target function =      -0.706434019640
              le_mean =     -22.816080663671
             les_mean =     521.074383812048
             stat err =       0.000556592001
             autocorr =       1.286347195221
   target nu stat err =       0.000556592001
   target dn stat err =       0.004372391706
      target stat err =       0.003091753919
              std dev =       0.694021391154
             le_variance =       0.481665691380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481349602320
                                         uncertainty =       0.002787741587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481349602320
                                         uncertainty =       0.002787741587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490614196
  error estimate for blocks of size 2^( 2) =       0.000511625107
  error estimate for blocks of size 2^( 3) =       0.000531685763
  error estimate for blocks of size 2^( 4) =       0.000545943181
  error estimate for blocks of size 2^( 5) =       0.000555761553
  error estimate for blocks of size 2^( 6) =       0.000561043113
  error estimate for blocks of size 2^( 7) =       0.000563086120

      target function =      -0.706546389760
              le_mean =     -22.816080976927
             les_mean =     521.074236734225
             stat err =       0.000556458492
             autocorr =       1.286427535777
   target nu stat err =       0.000556458492
   target dn stat err =       0.004364510291
      target stat err =       0.003087300560
              std dev =       0.693833250118
             le_variance =       0.481404578969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481477672496
                                         uncertainty =       0.002788935750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481477672496
                                         uncertainty =       0.002788935750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490679658
  error estimate for blocks of size 2^( 2) =       0.000511690703
  error estimate for blocks of size 2^( 3) =       0.000531751703
  error estimate for blocks of size 2^( 4) =       0.000546008534
  error estimate for blocks of size 2^( 5) =       0.000555828159
  error estimate for blocks of size 2^( 6) =       0.000561110782
  error estimate for blocks of size 2^( 7) =       0.000563149481

      target function =      -0.706533449941
              le_mean =     -22.816080704960
             les_mean =     521.074242879109
             stat err =       0.000556524239
             autocorr =       1.286388242542
   target nu stat err =       0.000556524239
   target dn stat err =       0.004367130743
      target stat err =       0.003088994783
              std dev =       0.693925826430
             le_variance =       0.481533052587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481593225177
                                         uncertainty =       0.002790075127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481593225177
                                         uncertainty =       0.002790075127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490738712
  error estimate for blocks of size 2^( 2) =       0.000511749902
  error estimate for blocks of size 2^( 3) =       0.000531811216
  error estimate for blocks of size 2^( 4) =       0.000546067547
  error estimate for blocks of size 2^( 5) =       0.000555888109
  error estimate for blocks of size 2^( 6) =       0.000561171716
  error estimate for blocks of size 2^( 7) =       0.000563206439

      target function =      -0.706447803381
              le_mean =     -22.816080653983
             les_mean =     521.074363568755
             stat err =       0.000556583453
             autocorr =       1.286352349821
   target nu stat err =       0.000556583453
   target dn stat err =       0.004371683904
      target stat err =       0.003091386351
              std dev =       0.694009341703
             le_variance =       0.481648966371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706434019640        initial
     3.9062e+00     3.9062e+01             2.7445e-04        -0.706546389760  <--
     1.5625e+01     1.5625e+02             6.8950e-05        -0.706533449941
     6.2500e+01     6.2500e+02             1.7259e-05        -0.706447803381

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.3166e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.467322e-01 3 1  ON 0
ci_02                -4.290809e-02 3 1  ON 1
ci_03                -4.265047e-02 3 1  ON 2
ci_04                 3.975275e-02 3 1  ON 3
ci_05                -3.077041e-02 3 1  ON 4
ci_06                -3.002567e-02 3 1  ON 5
ci_07                 2.858189e-02 3 1  ON 6
ci_08                -1.164266e-02 3 1  ON 7
ci_09                -1.321320e-02 3 1  ON 8
ci_10                -1.306818e-02 3 1  ON 9
ci_11                 1.437112e-02 3 1  ON 10
ci_12                 1.019609e-02 3 1  ON 11
ci_13                 1.261005e-02 3 1  ON 12
ci_14                 1.219191e-02 3 1  ON 13
ci_15                 9.565122e-03 3 1  ON 14
ci_16                 9.487480e-03 3 1  ON 15
ci_17                -9.770339e-03 3 1  ON 16
ci_18                -9.054074e-03 3 1  ON 17
ci_19                 1.035727e-02 3 1  ON 18
ci_20                 8.556075e-03 3 1  ON 19
ci_21                 9.193699e-03 3 1  ON 20
ci_22                 9.397024e-03 3 1  ON 21
ci_23                 5.637547e-03 3 1  ON 22
ci_24                 4.984933e-03 3 1  ON 23
ci_25                 3.897619e-03 3 1  ON 24
ci_26                 3.915490e-03 3 1  ON 25
ci_27                 4.058928e-03 3 1  ON 26
ci_28                 3.083403e-03 3 1  ON 27
ci_29                 3.145215e-03 3 1  ON 28
ci_30                -2.483559e-03 3 1  ON 29
ci_31                -2.810133e-03 3 1  ON 30
ci_32                -1.926709e-03 3 1  ON 31
ci_33                -1.989026e-03 3 1  ON 32
ci_34                 1.887281e-03 3 1  ON 33
ci_35                 1.879838e-03 3 1  ON 34
ci_36                -1.670822e-03 3 1  ON 35
ci_37                -1.812443e-03 3 1  ON 36
ci_38                -1.226973e-03 3 1  ON 37
ci_39                -1.342879e-03 3 1  ON 38
ci_40                -1.800778e-03 3 1  ON 39
ci_41                -1.488153e-03 3 1  ON 40
ci_42                -1.258606e-03 3 1  ON 41
ci_43                -2.525086e-03 3 1  ON 42
ci_44                -1.772644e-03 3 1  ON 43
ci_45                -1.198563e-03 3 1  ON 44
ci_46                -9.972224e-04 3 1  ON 45
ci_47                -5.028453e-04 3 1  ON 46
ci_48                -6.603868e-04 3 1  ON 47
ci_49                -1.331477e-03 3 1  ON 48
ci_50                -1.017772e-03 3 1  ON 49
ci_51                 1.045993e-03 3 1  ON 50
ci_52                 8.910086e-04 3 1  ON 51
ci_53                -1.231647e-03 3 1  ON 52
ci_54                -1.100836e-03 3 1  ON 53
ci_55                -7.334949e-04 3 1  ON 54
ci_56                 1.591040e-03 3 1  ON 55
ci_57                 1.564513e-03 3 1  ON 56
ci_58                -1.059377e-03 3 1  ON 57
ci_59                -9.045780e-04 3 1  ON 58
ci_60                 9.475580e-04 3 1  ON 59
ci_61                 8.635799e-04 3 1  ON 60
ci_62                -6.507298e-04 3 1  ON 61
ci_63                -8.254968e-04 3 1  ON 62
ci_64                -7.541817e-04 3 1  ON 63
ci_65                -6.149534e-04 3 1  ON 64
ci_66                -8.679413e-04 3 1  ON 65
ci_67                -6.994954e-04 3 1  ON 66
ci_68                -1.873239e-05 3 1  ON 67
ci_69                 1.403809e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3746e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8361
    reference variance = 0.44619
====================================================
  Execution time = 2.5727e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5335e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9538e-01
  Total weights = 1.963168598e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481181885689
                                         uncertainty =       0.002081228111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481181885689
                                         uncertainty =       0.002081228111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490487125
  error estimate for blocks of size 2^( 2) =       0.000511102402
  error estimate for blocks of size 2^( 3) =       0.000530980232
  error estimate for blocks of size 2^( 4) =       0.000546044951
  error estimate for blocks of size 2^( 5) =       0.000554589243
  error estimate for blocks of size 2^( 6) =       0.000558462747
  error estimate for blocks of size 2^( 7) =       0.000559646998

      target function =      -0.710286264161
              le_mean =     -22.817159875541
             les_mean =     521.118164504939
             stat err =       0.000554685985
             autocorr =       1.278907580354
   target nu stat err =       0.000554685985
   target dn stat err =       0.002767845834
      target stat err =       0.002026256380
              std dev =       0.693653544512
             le_variance =       0.481155239814


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281715987554e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710291252062       residual = 3.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710563589181       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710611986743       residual = 8.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710620636180       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710623794260       residual = 9.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710624730117       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710624957548       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710625056904       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710625066707       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710625076620       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710625077597       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 9.983914e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710291252062       residual = 3.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710361750448       residual = 5.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710374128815       residual = 7.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710376310392       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710377089975       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710377314811       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710377367889       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710377392068       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710377394388       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710377396706       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710377396922       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.545754e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710291252062       residual = 3.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710309034203       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710312146599       residual = 7.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710312693133       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710312887332       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710312942950       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710312955980       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710312961981       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710312962552       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710312963122       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710312963174       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 6.396327e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.586938 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0329e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.464776e-01 3 1  ON 0
ci_02                -4.268705e-02 3 1  ON 1
ci_03                -4.244882e-02 3 1  ON 2
ci_04                 3.952036e-02 3 1  ON 3
ci_05                -3.062667e-02 3 1  ON 4
ci_06                -2.989277e-02 3 1  ON 5
ci_07                 2.856933e-02 3 1  ON 6
ci_08                -1.155021e-02 3 1  ON 7
ci_09                -1.315887e-02 3 1  ON 8
ci_10                -1.302343e-02 3 1  ON 9
ci_11                 1.433557e-02 3 1  ON 10
ci_12                 1.014146e-02 3 1  ON 11
ci_13                 1.261436e-02 3 1  ON 12
ci_14                 1.222010e-02 3 1  ON 13
ci_15                 9.529802e-03 3 1  ON 14
ci_16                 9.447273e-03 3 1  ON 15
ci_17                -9.730637e-03 3 1  ON 16
ci_18                -9.011803e-03 3 1  ON 17
ci_19                 1.034133e-02 3 1  ON 18
ci_20                 8.524774e-03 3 1  ON 19
ci_21                 9.182599e-03 3 1  ON 20
ci_22                 9.381119e-03 3 1  ON 21
ci_23                 5.620213e-03 3 1  ON 22
ci_24                 4.959951e-03 3 1  ON 23
ci_25                 3.848463e-03 3 1  ON 24
ci_26                 3.902924e-03 3 1  ON 25
ci_27                 4.024255e-03 3 1  ON 26
ci_28                 3.056057e-03 3 1  ON 27
ci_29                 3.116152e-03 3 1  ON 28
ci_30                -2.453752e-03 3 1  ON 29
ci_31                -2.788178e-03 3 1  ON 30
ci_32                -1.918948e-03 3 1  ON 31
ci_33                -1.973279e-03 3 1  ON 32
ci_34                 1.893330e-03 3 1  ON 33
ci_35                 1.862380e-03 3 1  ON 34
ci_36                -1.656587e-03 3 1  ON 35
ci_37                -1.795170e-03 3 1  ON 36
ci_38                -1.210140e-03 3 1  ON 37
ci_39                -1.333285e-03 3 1  ON 38
ci_40                -1.797951e-03 3 1  ON 39
ci_41                -1.476798e-03 3 1  ON 40
ci_42                -1.254620e-03 3 1  ON 41
ci_43                -2.502065e-03 3 1  ON 42
ci_44                -1.775121e-03 3 1  ON 43
ci_45                -1.192662e-03 3 1  ON 44
ci_46                -9.900936e-04 3 1  ON 45
ci_47                -4.875066e-04 3 1  ON 46
ci_48                -6.428524e-04 3 1  ON 47
ci_49                -1.326403e-03 3 1  ON 48
ci_50                -1.008567e-03 3 1  ON 49
ci_51                 1.035449e-03 3 1  ON 50
ci_52                 8.913398e-04 3 1  ON 51
ci_53                -1.226123e-03 3 1  ON 52
ci_54                -1.098295e-03 3 1  ON 53
ci_55                -7.351659e-04 3 1  ON 54
ci_56                 1.587898e-03 3 1  ON 55
ci_57                 1.567667e-03 3 1  ON 56
ci_58                -1.044487e-03 3 1  ON 57
ci_59                -9.235960e-04 3 1  ON 58
ci_60                 9.374045e-04 3 1  ON 59
ci_61                 8.501366e-04 3 1  ON 60
ci_62                -6.623193e-04 3 1  ON 61
ci_63                -8.318879e-04 3 1  ON 62
ci_64                -7.669012e-04 3 1  ON 63
ci_65                -6.067779e-04 3 1  ON 64
ci_66                -8.607807e-04 3 1  ON 65
ci_67                -6.919959e-04 3 1  ON 66
ci_68                -2.682168e-05 3 1  ON 67
ci_69                 1.258625e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8886
    reference variance = 0.316438
====================================================
  Execution time = 2.5119e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.0283e-01
  Total weights = 1.9633e+06
  Execution time = 3.5807e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485031036504
                                         uncertainty =       0.004447803688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485031036504
                                         uncertainty =       0.004447803688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492425897
  error estimate for blocks of size 2^( 2) =       0.000513335504
  error estimate for blocks of size 2^( 3) =       0.000533253167
  error estimate for blocks of size 2^( 4) =       0.000548322325
  error estimate for blocks of size 2^( 5) =       0.000558193790
  error estimate for blocks of size 2^( 6) =       0.000562934062
  error estimate for blocks of size 2^( 7) =       0.000565509531

      target function =      -0.704877222661
              le_mean =     -22.816130776826
             les_mean =     521.078906121137
             stat err =       0.000558739927
             autocorr =       1.287471559817
   target nu stat err =       0.000558739927
   target dn stat err =       0.005152276320
      target stat err =       0.003611962705
              std dev =       0.696395381859
             le_variance =       0.484966527875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484154408007
                                         uncertainty =       0.004430410051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484154408007
                                         uncertainty =       0.004430410051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491980089
  error estimate for blocks of size 2^( 2) =       0.000512889817
  error estimate for blocks of size 2^( 3) =       0.000532806423
  error estimate for blocks of size 2^( 4) =       0.000547883433
  error estimate for blocks of size 2^( 5) =       0.000557784632
  error estimate for blocks of size 2^( 6) =       0.000562520028
  error estimate for blocks of size 2^( 7) =       0.000565126304

      target function =      -0.674182126286
              le_mean =     -22.816138771039
             les_mean =     521.124046644447
             stat err =       0.000558328600
             autocorr =       1.287907566503
   target nu stat err =       0.000558328600
   target dn stat err =       0.040823809974
      target stat err =       0.025919644631
              std dev =       0.695764914942
             le_variance =       0.484088816865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484553104763
                                         uncertainty =       0.004438902628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484553104763
                                         uncertainty =       0.004438902628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492182913
  error estimate for blocks of size 2^( 2) =       0.000513092612
  error estimate for blocks of size 2^( 3) =       0.000533011005
  error estimate for blocks of size 2^( 4) =       0.000548084812
  error estimate for blocks of size 2^( 5) =       0.000557966112
  error estimate for blocks of size 2^( 6) =       0.000562700210
  error estimate for blocks of size 2^( 7) =       0.000565288438

      target function =      -0.705021859723
              le_mean =     -22.816131965097
             les_mean =     521.078751623333
             stat err =       0.000558509893
             autocorr =       1.287682150828
   target nu stat err =       0.000558509893
   target dn stat err =       0.005156641442
      target stat err =       0.003616390459
              std dev =       0.696051750551
             le_variance =       0.484488039445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484969630055
                                         uncertainty =       0.004446607126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484969630055
                                         uncertainty =       0.004446607126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492394685
  error estimate for blocks of size 2^( 2) =       0.000513304069
  error estimate for blocks of size 2^( 3) =       0.000533221935
  error estimate for blocks of size 2^( 4) =       0.000548290645
  error estimate for blocks of size 2^( 5) =       0.000558162959
  error estimate for blocks of size 2^( 6) =       0.000562903235
  error estimate for blocks of size 2^( 7) =       0.000565479314

      target function =      -0.472003865274
              le_mean =     -22.816131173581
             les_mean =     521.471490573783
             stat err =       0.000558709038
             autocorr =       1.287492420904
   target nu stat err =       0.000558709038
   target dn stat err =       0.392875594222
      target stat err =       0.131529911263
              std dev =       0.696351241478
             le_variance =       0.484905051508


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.704877222661        initial
     9.7656e-01     9.7656e+00             9.9839e-04        -0.674182126286
     3.9062e+00     3.9062e+01             2.5458e-04        -0.705021859723  <--
     1.5625e+01     1.5625e+02             6.3963e-05        -0.472003865274

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.3089e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.464776e-01 3 1  ON 0
ci_02                -4.268705e-02 3 1  ON 1
ci_03                -4.244882e-02 3 1  ON 2
ci_04                 3.952036e-02 3 1  ON 3
ci_05                -3.062667e-02 3 1  ON 4
ci_06                -2.989277e-02 3 1  ON 5
ci_07                 2.856933e-02 3 1  ON 6
ci_08                -1.155021e-02 3 1  ON 7
ci_09                -1.315887e-02 3 1  ON 8
ci_10                -1.302343e-02 3 1  ON 9
ci_11                 1.433557e-02 3 1  ON 10
ci_12                 1.014146e-02 3 1  ON 11
ci_13                 1.261436e-02 3 1  ON 12
ci_14                 1.222010e-02 3 1  ON 13
ci_15                 9.529802e-03 3 1  ON 14
ci_16                 9.447273e-03 3 1  ON 15
ci_17                -9.730637e-03 3 1  ON 16
ci_18                -9.011803e-03 3 1  ON 17
ci_19                 1.034133e-02 3 1  ON 18
ci_20                 8.524774e-03 3 1  ON 19
ci_21                 9.182599e-03 3 1  ON 20
ci_22                 9.381119e-03 3 1  ON 21
ci_23                 5.620213e-03 3 1  ON 22
ci_24                 4.959951e-03 3 1  ON 23
ci_25                 3.848463e-03 3 1  ON 24
ci_26                 3.902924e-03 3 1  ON 25
ci_27                 4.024255e-03 3 1  ON 26
ci_28                 3.056057e-03 3 1  ON 27
ci_29                 3.116152e-03 3 1  ON 28
ci_30                -2.453752e-03 3 1  ON 29
ci_31                -2.788178e-03 3 1  ON 30
ci_32                -1.918948e-03 3 1  ON 31
ci_33                -1.973279e-03 3 1  ON 32
ci_34                 1.893330e-03 3 1  ON 33
ci_35                 1.862380e-03 3 1  ON 34
ci_36                -1.656587e-03 3 1  ON 35
ci_37                -1.795170e-03 3 1  ON 36
ci_38                -1.210140e-03 3 1  ON 37
ci_39                -1.333285e-03 3 1  ON 38
ci_40                -1.797951e-03 3 1  ON 39
ci_41                -1.476798e-03 3 1  ON 40
ci_42                -1.254620e-03 3 1  ON 41
ci_43                -2.502065e-03 3 1  ON 42
ci_44                -1.775121e-03 3 1  ON 43
ci_45                -1.192662e-03 3 1  ON 44
ci_46                -9.900936e-04 3 1  ON 45
ci_47                -4.875066e-04 3 1  ON 46
ci_48                -6.428524e-04 3 1  ON 47
ci_49                -1.326403e-03 3 1  ON 48
ci_50                -1.008567e-03 3 1  ON 49
ci_51                 1.035449e-03 3 1  ON 50
ci_52                 8.913398e-04 3 1  ON 51
ci_53                -1.226123e-03 3 1  ON 52
ci_54                -1.098295e-03 3 1  ON 53
ci_55                -7.351659e-04 3 1  ON 54
ci_56                 1.587898e-03 3 1  ON 55
ci_57                 1.567667e-03 3 1  ON 56
ci_58                -1.044487e-03 3 1  ON 57
ci_59                -9.235960e-04 3 1  ON 58
ci_60                 9.374045e-04 3 1  ON 59
ci_61                 8.501366e-04 3 1  ON 60
ci_62                -6.623193e-04 3 1  ON 61
ci_63                -8.318879e-04 3 1  ON 62
ci_64                -7.669012e-04 3 1  ON 63
ci_65                -6.067779e-04 3 1  ON 64
ci_66                -8.607807e-04 3 1  ON 65
ci_67                -6.919959e-04 3 1  ON 66
ci_68                -2.682168e-05 3 1  ON 67
ci_69                 1.258625e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3423e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.7399
    reference variance = 0.481142
====================================================
  Execution time = 2.5817e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9445e-01
  Total weights = 1.963420910e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479361913445
                                         uncertainty =       0.002851988892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479361913445
                                         uncertainty =       0.002851988892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489597575
  error estimate for blocks of size 2^( 2) =       0.000510380345
  error estimate for blocks of size 2^( 3) =       0.000529870405
  error estimate for blocks of size 2^( 4) =       0.000544735505
  error estimate for blocks of size 2^( 5) =       0.000554372895
  error estimate for blocks of size 2^( 6) =       0.000560158472
  error estimate for blocks of size 2^( 7) =       0.000564668455

      target function =      -0.710953166351
              le_mean =     -22.818156154582
             les_mean =     521.162703578463
             stat err =       0.000555983832
             autocorr =       1.289572634232
   target nu stat err =       0.000555983832
   target dn stat err =       0.003602192804
      target stat err =       0.002605610586
              std dev =       0.692395530387
             le_variance =       0.479411570499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281815615458e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710961875084       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711248290176       residual = 5.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711296123894       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711303738931       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711306136972       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711306387256       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711306404032       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711306402835       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711306404266       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711306411989       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.711306417104       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 9.676550e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710961875084       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711036016046       residual = 5.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711048245832       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711050165725       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711050755312       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711050812221       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711050814312       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711050813850       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711050814215       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711050816096       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.711050817297       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.467230e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710961875084       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710980575892       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710983650646       residual = 5.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710984131573       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710984278291       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710984292155       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710984292547       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710984292422       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710984292514       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710984292981       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710984293276       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 6.198928e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.591070 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0439e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_01                 1.462309e-01 3 1  ON 0
ci_02                -4.248141e-02 3 1  ON 1
ci_03                -4.223975e-02 3 1  ON 2
ci_04                 3.927517e-02 3 1  ON 3
ci_05                -3.047915e-02 3 1  ON 4
ci_06                -2.977334e-02 3 1  ON 5
ci_07                 2.854427e-02 3 1  ON 6
ci_08                -1.145318e-02 3 1  ON 7
ci_09                -1.312235e-02 3 1  ON 8
ci_10                -1.296253e-02 3 1  ON 9
ci_11                 1.429814e-02 3 1  ON 10
ci_12                 1.008909e-02 3 1  ON 11
ci_13                 1.261891e-02 3 1  ON 12
ci_14                 1.224672e-02 3 1  ON 13
ci_15                 9.474113e-03 3 1  ON 14
ci_16                 9.403066e-03 3 1  ON 15
ci_17                -9.695450e-03 3 1  ON 16
ci_18                -8.984986e-03 3 1  ON 17
ci_19                 1.033435e-02 3 1  ON 18
ci_20                 8.500906e-03 3 1  ON 19
ci_21                 9.173480e-03 3 1  ON 20
ci_22                 9.369140e-03 3 1  ON 21
ci_23                 5.616982e-03 3 1  ON 22
ci_24                 4.970692e-03 3 1  ON 23
ci_25                 3.838056e-03 3 1  ON 24
ci_26                 3.888857e-03 3 1  ON 25
ci_27                 4.015087e-03 3 1  ON 26
ci_28                 3.022936e-03 3 1  ON 27
ci_29                 3.088344e-03 3 1  ON 28
ci_30                -2.446450e-03 3 1  ON 29
ci_31                -2.798222e-03 3 1  ON 30
ci_32                -1.905735e-03 3 1  ON 31
ci_33                -1.957182e-03 3 1  ON 32
ci_34                 1.870438e-03 3 1  ON 33
ci_35                 1.846343e-03 3 1  ON 34
ci_36                -1.642058e-03 3 1  ON 35
ci_37                -1.796703e-03 3 1  ON 36
ci_38                -1.201869e-03 3 1  ON 37
ci_39                -1.327238e-03 3 1  ON 38
ci_40                -1.793137e-03 3 1  ON 39
ci_41                -1.470583e-03 3 1  ON 40
ci_42                -1.248521e-03 3 1  ON 41
ci_43                -2.488619e-03 3 1  ON 42
ci_44                -1.765796e-03 3 1  ON 43
ci_45                -1.179317e-03 3 1  ON 44
ci_46                -9.912460e-04 3 1  ON 45
ci_47                -4.796174e-04 3 1  ON 46
ci_48                -6.367423e-04 3 1  ON 47
ci_49                -1.322915e-03 3 1  ON 48
ci_50                -1.002059e-03 3 1  ON 49
ci_51                 1.031592e-03 3 1  ON 50
ci_52                 8.843226e-04 3 1  ON 51
ci_53                -1.214205e-03 3 1  ON 52
ci_54                -1.101065e-03 3 1  ON 53
ci_55                -7.373797e-04 3 1  ON 54
ci_56                 1.582482e-03 3 1  ON 55
ci_57                 1.567006e-03 3 1  ON 56
ci_58                -1.039952e-03 3 1  ON 57
ci_59                -9.135758e-04 3 1  ON 58
ci_60                 9.346381e-04 3 1  ON 59
ci_61                 8.459993e-04 3 1  ON 60
ci_62                -6.518912e-04 3 1  ON 61
ci_63                -8.357023e-04 3 1  ON 62
ci_64                -7.716440e-04 3 1  ON 63
ci_65                -5.940497e-04 3 1  ON 64
ci_66                -8.515466e-04 3 1  ON 65
ci_67                -6.993146e-04 3 1  ON 66
ci_68                -3.515301e-05 3 1  ON 67
ci_69                 1.022203e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.8901
    reference variance = 0.46917
====================================================
  Execution time = 2.5316e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.0163e-01
  Total weights = 1.9636e+06
  Execution time = 3.5716e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482916661624
                                         uncertainty =       0.002626166519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482916661624
                                         uncertainty =       0.002626166519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491647770
  error estimate for blocks of size 2^( 2) =       0.000512092057
  error estimate for blocks of size 2^( 3) =       0.000532121433
  error estimate for blocks of size 2^( 4) =       0.000547244120
  error estimate for blocks of size 2^( 5) =       0.000557571346
  error estimate for blocks of size 2^( 6) =       0.000562406247
  error estimate for blocks of size 2^( 7) =       0.000564823237

      target function =      -0.705313438774
              le_mean =     -22.815661700451
             les_mean =     521.056875145940
             stat err =       0.000558011237
             autocorr =       1.288183533188
   target nu stat err =       0.000558011237
   target dn stat err =       0.003944442511
      target stat err =       0.002789094412
              std dev =       0.695294943866
             le_variance =       0.483435058966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482137882503
                                         uncertainty =       0.002668636449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482137882503
                                         uncertainty =       0.002668636449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491251838
  error estimate for blocks of size 2^( 2) =       0.000511688100
  error estimate for blocks of size 2^( 3) =       0.000531714693
  error estimate for blocks of size 2^( 4) =       0.000546846534
  error estimate for blocks of size 2^( 5) =       0.000557180947
  error estimate for blocks of size 2^( 6) =       0.000562014866
  error estimate for blocks of size 2^( 7) =       0.000564416840

      target function =      -0.705472881958
              le_mean =     -22.815659343349
             les_mean =     521.056536418580
             stat err =       0.000557614797
             autocorr =       1.288428142754
   target nu stat err =       0.000557614797
   target dn stat err =       0.004098006220
      target stat err =       0.002894759776
              std dev =       0.694735012074
             le_variance =       0.482656737002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482499785412
                                         uncertainty =       0.002646666488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482499785412
                                         uncertainty =       0.002646666488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491435871
  error estimate for blocks of size 2^( 2) =       0.000511875888
  error estimate for blocks of size 2^( 3) =       0.000531903883
  error estimate for blocks of size 2^( 4) =       0.000547031149
  error estimate for blocks of size 2^( 5) =       0.000557362326
  error estimate for blocks of size 2^( 6) =       0.000562199922
  error estimate for blocks of size 2^( 7) =       0.000564608587

      target function =      -0.705868786515
              le_mean =     -22.815658685349
             les_mean =     521.055936754631
             stat err =       0.000557800496
             autocorr =       1.288320997043
   target nu stat err =       0.000557800496
   target dn stat err =       0.003985823435
      target stat err =       0.002821531533
              std dev =       0.694995274207
             le_variance =       0.483018431170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482864101605
                                         uncertainty =       0.002628466707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482864101605
                                         uncertainty =       0.002628466707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491621057
  error estimate for blocks of size 2^( 2) =       0.000512064897
  error estimate for blocks of size 2^( 3) =       0.000532094189
  error estimate for blocks of size 2^( 4) =       0.000547215726
  error estimate for blocks of size 2^( 5) =       0.000557539918
  error estimate for blocks of size 2^( 6) =       0.000562370369
  error estimate for blocks of size 2^( 7) =       0.000564779494

      target function =      -0.689361930163
              le_mean =     -22.815662012217
             les_mean =     521.079893911975
             stat err =       0.000557976377
             autocorr =       1.288162558219
   target nu stat err =       0.000557976377
   target dn stat err =       0.023983559116
      target stat err =       0.015901130534
              std dev =       0.695257167060
             le_variance =       0.483382528349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.705313438774        initial
     9.7656e-01     9.7656e+00             9.6765e-04        -0.705472881958
     3.9062e+00     3.9062e+01             2.4672e-04        -0.705868786515  <--
     1.5625e+01     1.5625e+02             6.1989e-05        -0.689361930163

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.3233e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_01                 1.462309e-01 3 1  ON 0
ci_02                -4.248141e-02 3 1  ON 1
ci_03                -4.223975e-02 3 1  ON 2
ci_04                 3.927517e-02 3 1  ON 3
ci_05                -3.047915e-02 3 1  ON 4
ci_06                -2.977334e-02 3 1  ON 5
ci_07                 2.854427e-02 3 1  ON 6
ci_08                -1.145318e-02 3 1  ON 7
ci_09                -1.312235e-02 3 1  ON 8
ci_10                -1.296253e-02 3 1  ON 9
ci_11                 1.429814e-02 3 1  ON 10
ci_12                 1.008909e-02 3 1  ON 11
ci_13                 1.261891e-02 3 1  ON 12
ci_14                 1.224672e-02 3 1  ON 13
ci_15                 9.474113e-03 3 1  ON 14
ci_16                 9.403066e-03 3 1  ON 15
ci_17                -9.695450e-03 3 1  ON 16
ci_18                -8.984986e-03 3 1  ON 17
ci_19                 1.033435e-02 3 1  ON 18
ci_20                 8.500906e-03 3 1  ON 19
ci_21                 9.173480e-03 3 1  ON 20
ci_22                 9.369140e-03 3 1  ON 21
ci_23                 5.616982e-03 3 1  ON 22
ci_24                 4.970692e-03 3 1  ON 23
ci_25                 3.838056e-03 3 1  ON 24
ci_26                 3.888857e-03 3 1  ON 25
ci_27                 4.015087e-03 3 1  ON 26
ci_28                 3.022936e-03 3 1  ON 27
ci_29                 3.088344e-03 3 1  ON 28
ci_30                -2.446450e-03 3 1  ON 29
ci_31                -2.798222e-03 3 1  ON 30
ci_32                -1.905735e-03 3 1  ON 31
ci_33                -1.957182e-03 3 1  ON 32
ci_34                 1.870438e-03 3 1  ON 33
ci_35                 1.846343e-03 3 1  ON 34
ci_36                -1.642058e-03 3 1  ON 35
ci_37                -1.796703e-03 3 1  ON 36
ci_38                -1.201869e-03 3 1  ON 37
ci_39                -1.327238e-03 3 1  ON 38
ci_40                -1.793137e-03 3 1  ON 39
ci_41                -1.470583e-03 3 1  ON 40
ci_42                -1.248521e-03 3 1  ON 41
ci_43                -2.488619e-03 3 1  ON 42
ci_44                -1.765796e-03 3 1  ON 43
ci_45                -1.179317e-03 3 1  ON 44
ci_46                -9.912460e-04 3 1  ON 45
ci_47                -4.796174e-04 3 1  ON 46
ci_48                -6.367423e-04 3 1  ON 47
ci_49                -1.322915e-03 3 1  ON 48
ci_50                -1.002059e-03 3 1  ON 49
ci_51                 1.031592e-03 3 1  ON 50
ci_52                 8.843226e-04 3 1  ON 51
ci_53                -1.214205e-03 3 1  ON 52
ci_54                -1.101065e-03 3 1  ON 53
ci_55                -7.373797e-04 3 1  ON 54
ci_56                 1.582482e-03 3 1  ON 55
ci_57                 1.567006e-03 3 1  ON 56
ci_58                -1.039952e-03 3 1  ON 57
ci_59                -9.135758e-04 3 1  ON 58
ci_60                 9.346381e-04 3 1  ON 59
ci_61                 8.459993e-04 3 1  ON 60
ci_62                -6.518912e-04 3 1  ON 61
ci_63                -8.357023e-04 3 1  ON 62
ci_64                -7.716440e-04 3 1  ON 63
ci_65                -5.940497e-04 3 1  ON 64
ci_66                -8.515466e-04 3 1  ON 65
ci_67                -6.993146e-04 3 1  ON 66
ci_68                -3.515301e-05 3 1  ON 67
ci_69                 1.022203e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3695e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.8541
    reference variance = 0.33947
====================================================
  Execution time = 2.7436e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9282e-01
  Total weights = 1.963444810e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5675e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477804372769
                                         uncertainty =       0.002328770151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477804372769
                                         uncertainty =       0.002328770151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488727248
  error estimate for blocks of size 2^( 2) =       0.000509074786
  error estimate for blocks of size 2^( 3) =       0.000528573811
  error estimate for blocks of size 2^( 4) =       0.000543797259
  error estimate for blocks of size 2^( 5) =       0.000552588819
  error estimate for blocks of size 2^( 6) =       0.000557853227
  error estimate for blocks of size 2^( 7) =       0.000558865525

      target function =      -0.712079634712
              le_mean =     -22.816635848761
             les_mean =     521.091693354128
             stat err =       0.000553276208
             autocorr =       1.281595232098
   target nu stat err =       0.000553276208
   target dn stat err =       0.003414592564
      target stat err =       0.002477965587
              std dev =       0.691164702934
             le_variance =       0.477708646582


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281663584876e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712087484629       residual = 3.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712369944942       residual = 5.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712415505812       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712422620944       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712425902815       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712427214345       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712427351577       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712427415867       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712427432558       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712427437668       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.712427437682       residual = 1.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 9.254718e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712087484629       residual = 3.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712160610844       residual = 5.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712172265529       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712174063360       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712174881080       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712175197924       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712175228828       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712175244119       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712175248107       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712175249296       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.712175249284       residual = 9.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.359646e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712087484629       residual = 3.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712105930077       residual = 5.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712108860633       residual = 7.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712109311243       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712109515444       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712109593925       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712109601437       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712109605210       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712109606196       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712109606487       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.928276e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.595005 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2013e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_01                 1.459949e-01 3 1  ON 0
ci_02                -4.226426e-02 3 1  ON 1
ci_03                -4.203716e-02 3 1  ON 2
ci_04                 3.904291e-02 3 1  ON 3
ci_05                -3.034654e-02 3 1  ON 4
ci_06                -2.962980e-02 3 1  ON 5
ci_07                 2.850941e-02 3 1  ON 6
ci_08                -1.136561e-02 3 1  ON 7
ci_09                -1.305104e-02 3 1  ON 8
ci_10                -1.292014e-02 3 1  ON 9
ci_11                 1.428192e-02 3 1  ON 10
ci_12                 1.004392e-02 3 1  ON 11
ci_13                 1.262160e-02 3 1  ON 12
ci_14                 1.224134e-02 3 1  ON 13
ci_15                 9.425167e-03 3 1  ON 14
ci_16                 9.356918e-03 3 1  ON 15
ci_17                -9.648798e-03 3 1  ON 16
ci_18                -8.966648e-03 3 1  ON 17
ci_19                 1.031324e-02 3 1  ON 18
ci_20                 8.475267e-03 3 1  ON 19
ci_21                 9.167034e-03 3 1  ON 20
ci_22                 9.357158e-03 3 1  ON 21
ci_23                 5.596887e-03 3 1  ON 22
ci_24                 4.970575e-03 3 1  ON 23
ci_25                 3.819651e-03 3 1  ON 24
ci_26                 3.873899e-03 3 1  ON 25
ci_27                 4.002563e-03 3 1  ON 26
ci_28                 3.006478e-03 3 1  ON 27
ci_29                 3.083580e-03 3 1  ON 28
ci_30                -2.424924e-03 3 1  ON 29
ci_31                -2.772045e-03 3 1  ON 30
ci_32                -1.886008e-03 3 1  ON 31
ci_33                -1.934780e-03 3 1  ON 32
ci_34                 1.858386e-03 3 1  ON 33
ci_35                 1.830388e-03 3 1  ON 34
ci_36                -1.633127e-03 3 1  ON 35
ci_37                -1.795386e-03 3 1  ON 36
ci_38                -1.194364e-03 3 1  ON 37
ci_39                -1.317987e-03 3 1  ON 38
ci_40                -1.777446e-03 3 1  ON 39
ci_41                -1.472765e-03 3 1  ON 40
ci_42                -1.239398e-03 3 1  ON 41
ci_43                -2.483055e-03 3 1  ON 42
ci_44                -1.779869e-03 3 1  ON 43
ci_45                -1.156137e-03 3 1  ON 44
ci_46                -9.779020e-04 3 1  ON 45
ci_47                -4.798777e-04 3 1  ON 46
ci_48                -6.303235e-04 3 1  ON 47
ci_49                -1.314548e-03 3 1  ON 48
ci_50                -1.009660e-03 3 1  ON 49
ci_51                 1.014572e-03 3 1  ON 50
ci_52                 8.713236e-04 3 1  ON 51
ci_53                -1.203810e-03 3 1  ON 52
ci_54                -1.099647e-03 3 1  ON 53
ci_55                -7.481365e-04 3 1  ON 54
ci_56                 1.596989e-03 3 1  ON 55
ci_57                 1.578033e-03 3 1  ON 56
ci_58                -1.034037e-03 3 1  ON 57
ci_59                -9.104563e-04 3 1  ON 58
ci_60                 9.268258e-04 3 1  ON 59
ci_61                 8.326038e-04 3 1  ON 60
ci_62                -6.542921e-04 3 1  ON 61
ci_63                -8.270709e-04 3 1  ON 62
ci_64                -7.715858e-04 3 1  ON 63
ci_65                -5.965168e-04 3 1  ON 64
ci_66                -8.515649e-04 3 1  ON 65
ci_67                -6.965376e-04 3 1  ON 66
ci_68                -4.309483e-05 3 1  ON 67
ci_69                 8.645571e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.8097
    reference variance = 1.02911
====================================================
  Execution time = 2.5357e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9693e-01
  Total weights = 1.9636e+06
  Execution time = 3.6071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481205725844
                                         uncertainty =       0.002815887495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481205725844
                                         uncertainty =       0.002815887495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490557286
  error estimate for blocks of size 2^( 2) =       0.000511761099
  error estimate for blocks of size 2^( 3) =       0.000531264303
  error estimate for blocks of size 2^( 4) =       0.000546371968
  error estimate for blocks of size 2^( 5) =       0.000556091244
  error estimate for blocks of size 2^( 6) =       0.000562252347
  error estimate for blocks of size 2^( 7) =       0.000563670652

      target function =      -0.555653267039
              le_mean =     -22.816675314941
             les_mean =     521.332572043031
             stat err =       0.000557096553
             autocorr =       1.289678564270
   target nu stat err =       0.000557096553
   target dn stat err =       0.234766045650
      target stat err =       0.104750509050
              std dev =       0.693752767075
             le_variance =       0.481292901824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480316958900
                                         uncertainty =       0.002783152664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480316958900
                                         uncertainty =       0.002783152664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490097954
  error estimate for blocks of size 2^( 2) =       0.000511299791
  error estimate for blocks of size 2^( 3) =       0.000530805783
  error estimate for blocks of size 2^( 4) =       0.000545924044
  error estimate for blocks of size 2^( 5) =       0.000555663677
  error estimate for blocks of size 2^( 6) =       0.000561845604
  error estimate for blocks of size 2^( 7) =       0.000563189474

      target function =      -0.317120185401
              le_mean =     -22.816691584603
             les_mean =     521.970965658437
             stat err =       0.000556655700
             autocorr =       1.290052966805
   target nu stat err =       0.000556655700
   target dn stat err =       0.842380511485
      target stat err =       0.141870061915
              std dev =       0.693103173104
             le_variance =       0.480392008566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480685285921
                                         uncertainty =       0.002802351126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480685285921
                                         uncertainty =       0.002802351126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490288592
  error estimate for blocks of size 2^( 2) =       0.000511490445
  error estimate for blocks of size 2^( 3) =       0.000530990348
  error estimate for blocks of size 2^( 4) =       0.000546098866
  error estimate for blocks of size 2^( 5) =       0.000555824521
  error estimate for blocks of size 2^( 6) =       0.000562000785
  error estimate for blocks of size 2^( 7) =       0.000563397461

      target function =      -0.709050705335
              le_mean =     -22.816677432362
             les_mean =     521.097889969362
             stat err =       0.000556830409
             autocorr =       1.289859220063
   target nu stat err =       0.000556830409
   target dn stat err =       0.003509524390
      target stat err =       0.002523335549
              std dev =       0.693372775722
             le_variance =       0.480765806113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481138381760
                                         uncertainty =       0.002814164327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481138381760
                                         uncertainty =       0.002814164327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490522515
  error estimate for blocks of size 2^( 2) =       0.000511725694
  error estimate for blocks of size 2^( 3) =       0.000531227984
  error estimate for blocks of size 2^( 4) =       0.000546336268
  error estimate for blocks of size 2^( 5) =       0.000556056364
  error estimate for blocks of size 2^( 6) =       0.000562219996
  error estimate for blocks of size 2^( 7) =       0.000563635989

      target function =      -0.709004246770
              le_mean =     -22.816675091933
             les_mean =     521.097849382338
             stat err =       0.000557062154
             autocorr =       1.289702129053
   target nu stat err =       0.000557062154
   target dn stat err =       0.003499725852
      target stat err =       0.002516346825
              std dev =       0.693703592860
             le_variance =       0.481224674747


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.555653267039        initial
     9.7656e-01     9.7656e+00             9.2547e-04        -0.317120185401
     3.9062e+00     3.9062e+01             2.3596e-04        -0.709050705335  <--
     1.5625e+01     1.5625e+02             5.9283e-05        -0.709004246770

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.3440e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_01                 1.459949e-01 3 1  ON 0
ci_02                -4.226426e-02 3 1  ON 1
ci_03                -4.203716e-02 3 1  ON 2
ci_04                 3.904291e-02 3 1  ON 3
ci_05                -3.034654e-02 3 1  ON 4
ci_06                -2.962980e-02 3 1  ON 5
ci_07                 2.850941e-02 3 1  ON 6
ci_08                -1.136561e-02 3 1  ON 7
ci_09                -1.305104e-02 3 1  ON 8
ci_10                -1.292014e-02 3 1  ON 9
ci_11                 1.428192e-02 3 1  ON 10
ci_12                 1.004392e-02 3 1  ON 11
ci_13                 1.262160e-02 3 1  ON 12
ci_14                 1.224134e-02 3 1  ON 13
ci_15                 9.425167e-03 3 1  ON 14
ci_16                 9.356918e-03 3 1  ON 15
ci_17                -9.648798e-03 3 1  ON 16
ci_18                -8.966648e-03 3 1  ON 17
ci_19                 1.031324e-02 3 1  ON 18
ci_20                 8.475267e-03 3 1  ON 19
ci_21                 9.167034e-03 3 1  ON 20
ci_22                 9.357158e-03 3 1  ON 21
ci_23                 5.596887e-03 3 1  ON 22
ci_24                 4.970575e-03 3 1  ON 23
ci_25                 3.819651e-03 3 1  ON 24
ci_26                 3.873899e-03 3 1  ON 25
ci_27                 4.002563e-03 3 1  ON 26
ci_28                 3.006478e-03 3 1  ON 27
ci_29                 3.083580e-03 3 1  ON 28
ci_30                -2.424924e-03 3 1  ON 29
ci_31                -2.772045e-03 3 1  ON 30
ci_32                -1.886008e-03 3 1  ON 31
ci_33                -1.934780e-03 3 1  ON 32
ci_34                 1.858386e-03 3 1  ON 33
ci_35                 1.830388e-03 3 1  ON 34
ci_36                -1.633127e-03 3 1  ON 35
ci_37                -1.795386e-03 3 1  ON 36
ci_38                -1.194364e-03 3 1  ON 37
ci_39                -1.317987e-03 3 1  ON 38
ci_40                -1.777446e-03 3 1  ON 39
ci_41                -1.472765e-03 3 1  ON 40
ci_42                -1.239398e-03 3 1  ON 41
ci_43                -2.483055e-03 3 1  ON 42
ci_44                -1.779869e-03 3 1  ON 43
ci_45                -1.156137e-03 3 1  ON 44
ci_46                -9.779020e-04 3 1  ON 45
ci_47                -4.798777e-04 3 1  ON 46
ci_48                -6.303235e-04 3 1  ON 47
ci_49                -1.314548e-03 3 1  ON 48
ci_50                -1.009660e-03 3 1  ON 49
ci_51                 1.014572e-03 3 1  ON 50
ci_52                 8.713236e-04 3 1  ON 51
ci_53                -1.203810e-03 3 1  ON 52
ci_54                -1.099647e-03 3 1  ON 53
ci_55                -7.481365e-04 3 1  ON 54
ci_56                 1.596989e-03 3 1  ON 55
ci_57                 1.578033e-03 3 1  ON 56
ci_58                -1.034037e-03 3 1  ON 57
ci_59                -9.104563e-04 3 1  ON 58
ci_60                 9.268258e-04 3 1  ON 59
ci_61                 8.326038e-04 3 1  ON 60
ci_62                -6.542921e-04 3 1  ON 61
ci_63                -8.270709e-04 3 1  ON 62
ci_64                -7.715858e-04 3 1  ON 63
ci_65                -5.965168e-04 3 1  ON 64
ci_66                -8.515649e-04 3 1  ON 65
ci_67                -6.965376e-04 3 1  ON 66
ci_68                -4.309483e-05 3 1  ON 67
ci_69                 8.645571e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5459e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.6801
    reference variance = 0.646198
====================================================
  Execution time = 2.5673e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5339e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9873e-01
  Total weights = 1.963612099e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5707e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481984703987
                                         uncertainty =       0.002157925010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481984703987
                                         uncertainty =       0.002157925010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490918295
  error estimate for blocks of size 2^( 2) =       0.000511883365
  error estimate for blocks of size 2^( 3) =       0.000532105447
  error estimate for blocks of size 2^( 4) =       0.000547315583
  error estimate for blocks of size 2^( 5) =       0.000556643650
  error estimate for blocks of size 2^( 6) =       0.000562824041
  error estimate for blocks of size 2^( 7) =       0.000564652683

      target function =      -0.707926845623
              le_mean =     -22.817033210420
             les_mean =     521.115738909689
             stat err =       0.000557858989
             autocorr =       1.291309769215
   target nu stat err =       0.000557858989
   target dn stat err =       0.003250354114
      target stat err =       0.002340384657
              std dev =       0.694263311199
             le_variance =       0.482001545278


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281703321042e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707933753658       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708178125037       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708218187413       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708225235341       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708226622402       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708227063312       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708227055968       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708227032649       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708227034552       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708227030723       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 8.460778e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707933753658       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707996999660       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708007238131       residual = 4.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708009015851       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708009353809       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708009459599       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708009456685       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708009451046       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708009451519       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708009450601       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.157336e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707933753658       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707949705644       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707952279470       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707952724838       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707952808735       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707952834896       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707952834101       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707952832704       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707952832822       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707952832595       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.420382e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.598502 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0252e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_01                 1.457792e-01 3 1  ON 0
ci_02                -4.207181e-02 3 1  ON 1
ci_03                -4.182946e-02 3 1  ON 2
ci_04                 3.883075e-02 3 1  ON 3
ci_05                -3.022001e-02 3 1  ON 4
ci_06                -2.949491e-02 3 1  ON 5
ci_07                 2.848856e-02 3 1  ON 6
ci_08                -1.127431e-02 3 1  ON 7
ci_09                -1.300036e-02 3 1  ON 8
ci_10                -1.282996e-02 3 1  ON 9
ci_11                 1.424973e-02 3 1  ON 10
ci_12                 1.000350e-02 3 1  ON 11
ci_13                 1.262586e-02 3 1  ON 12
ci_14                 1.223244e-02 3 1  ON 13
ci_15                 9.375680e-03 3 1  ON 14
ci_16                 9.346676e-03 3 1  ON 15
ci_17                -9.609141e-03 3 1  ON 16
ci_18                -8.927182e-03 3 1  ON 17
ci_19                 1.028042e-02 3 1  ON 18
ci_20                 8.456537e-03 3 1  ON 19
ci_21                 9.155014e-03 3 1  ON 20
ci_22                 9.352592e-03 3 1  ON 21
ci_23                 5.577577e-03 3 1  ON 22
ci_24                 4.954034e-03 3 1  ON 23
ci_25                 3.807736e-03 3 1  ON 24
ci_26                 3.861834e-03 3 1  ON 25
ci_27                 3.975939e-03 3 1  ON 26
ci_28                 2.992661e-03 3 1  ON 27
ci_29                 3.059740e-03 3 1  ON 28
ci_30                -2.405840e-03 3 1  ON 29
ci_31                -2.761874e-03 3 1  ON 30
ci_32                -1.868325e-03 3 1  ON 31
ci_33                -1.916481e-03 3 1  ON 32
ci_34                 1.846738e-03 3 1  ON 33
ci_35                 1.830679e-03 3 1  ON 34
ci_36                -1.631750e-03 3 1  ON 35
ci_37                -1.788918e-03 3 1  ON 36
ci_38                -1.186651e-03 3 1  ON 37
ci_39                -1.308220e-03 3 1  ON 38
ci_40                -1.780838e-03 3 1  ON 39
ci_41                -1.471119e-03 3 1  ON 40
ci_42                -1.233852e-03 3 1  ON 41
ci_43                -2.473527e-03 3 1  ON 42
ci_44                -1.777073e-03 3 1  ON 43
ci_45                -1.148474e-03 3 1  ON 44
ci_46                -9.736954e-04 3 1  ON 45
ci_47                -4.640010e-04 3 1  ON 46
ci_48                -6.028331e-04 3 1  ON 47
ci_49                -1.305266e-03 3 1  ON 48
ci_50                -1.006646e-03 3 1  ON 49
ci_51                 1.006618e-03 3 1  ON 50
ci_52                 8.721747e-04 3 1  ON 51
ci_53                -1.189945e-03 3 1  ON 52
ci_54                -1.078850e-03 3 1  ON 53
ci_55                -7.551805e-04 3 1  ON 54
ci_56                 1.600655e-03 3 1  ON 55
ci_57                 1.576472e-03 3 1  ON 56
ci_58                -1.041260e-03 3 1  ON 57
ci_59                -9.077929e-04 3 1  ON 58
ci_60                 9.079398e-04 3 1  ON 59
ci_61                 8.312002e-04 3 1  ON 60
ci_62                -6.443471e-04 3 1  ON 61
ci_63                -8.199262e-04 3 1  ON 62
ci_64                -7.702085e-04 3 1  ON 63
ci_65                -5.901794e-04 3 1  ON 64
ci_66                -8.480381e-04 3 1  ON 65
ci_67                -6.974940e-04 3 1  ON 66
ci_68                -6.436281e-05 3 1  ON 67
ci_69                 6.664017e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.8544
    reference variance = 1.14443
====================================================
  Execution time = 2.5399e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9885e-01
  Total weights = 1.9637e+06
  Execution time = 3.6018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480572720466
                                         uncertainty =       0.003091105933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480572720466
                                         uncertainty =       0.003091105933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490168307
  error estimate for blocks of size 2^( 2) =       0.000510885016
  error estimate for blocks of size 2^( 3) =       0.000530690178
  error estimate for blocks of size 2^( 4) =       0.000545278766
  error estimate for blocks of size 2^( 5) =       0.000554292358
  error estimate for blocks of size 2^( 6) =       0.000559602094
  error estimate for blocks of size 2^( 7) =       0.000560799613

      target function =      -0.705695005560
              le_mean =     -22.816792086180
             les_mean =     521.107911779547
             stat err =       0.000554993208
             autocorr =       1.281990718286
   target nu stat err =       0.000554993208
   target dn stat err =       0.005532240264
      target stat err =       0.003884357618
              std dev =       0.693202667961
             le_variance =       0.480529938868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490289043914
                                         uncertainty =       0.010924500236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490289043914
                                         uncertainty =       0.010924500236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495089362
  error estimate for blocks of size 2^( 2) =       0.000515602150
  error estimate for blocks of size 2^( 3) =       0.000535088891
  error estimate for blocks of size 2^( 4) =       0.000549527068
  error estimate for blocks of size 2^( 5) =       0.000558342512
  error estimate for blocks of size 2^( 6) =       0.000563794739
  error estimate for blocks of size 2^( 7) =       0.000565286310

      target function =      -0.005866693239
              le_mean =     -22.816869492175
             les_mean =     582.149878066707
             stat err =       0.000559237657
             autocorr =       1.275926408537
   target nu stat err =       0.000559237657
   target dn stat err =      61.068219836475
      target stat err =       0.005773543898
              std dev =       0.700162090003
             le_variance =       0.490226952277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480118154272
                                         uncertainty =       0.003087288030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480118154272
                                         uncertainty =       0.003087288030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489936230
  error estimate for blocks of size 2^( 2) =       0.000510650418
  error estimate for blocks of size 2^( 3) =       0.000530457319
  error estimate for blocks of size 2^( 4) =       0.000545050299
  error estimate for blocks of size 2^( 5) =       0.000554064099
  error estimate for blocks of size 2^( 6) =       0.000559379239
  error estimate for blocks of size 2^( 7) =       0.000560591729

      target function =      -0.708004426411
              le_mean =     -22.816792609084
             les_mean =     521.104631726403
             stat err =       0.000554771342
             autocorr =       1.282179780802
   target nu stat err =       0.000554771342
   target dn stat err =       0.004778305103
      target stat err =       0.003388010119
              std dev =       0.692874461345
             le_variance =       0.480075019184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480514048456
                                         uncertainty =       0.003090605731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480514048456
                                         uncertainty =       0.003090605731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490138360
  error estimate for blocks of size 2^( 2) =       0.000510853973
  error estimate for blocks of size 2^( 3) =       0.000530659569
  error estimate for blocks of size 2^( 4) =       0.000545249055
  error estimate for blocks of size 2^( 5) =       0.000554263600
  error estimate for blocks of size 2^( 6) =       0.000559574206
  error estimate for blocks of size 2^( 7) =       0.000560773124

      target function =      -0.707627692874
              le_mean =     -22.816791698348
             les_mean =     521.105128765477
             stat err =       0.000554964996
             autocorr =       1.282017035748
   target nu stat err =       0.000554964996
   target dn stat err =       0.004790712665
      target stat err =       0.003393037749
              std dev =       0.693160316166
             le_variance =       0.480471223907


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.705695005560        initial
     9.7656e-01     9.7656e+00             8.4608e-04        -0.005866693239
     3.9062e+00     3.9062e+01             2.1573e-04        -0.708004426411  <--
     1.5625e+01     1.5625e+02             5.4204e-05        -0.707627692874

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.3457e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_01                 1.457792e-01 3 1  ON 0
ci_02                -4.207181e-02 3 1  ON 1
ci_03                -4.182946e-02 3 1  ON 2
ci_04                 3.883075e-02 3 1  ON 3
ci_05                -3.022001e-02 3 1  ON 4
ci_06                -2.949491e-02 3 1  ON 5
ci_07                 2.848856e-02 3 1  ON 6
ci_08                -1.127431e-02 3 1  ON 7
ci_09                -1.300036e-02 3 1  ON 8
ci_10                -1.282996e-02 3 1  ON 9
ci_11                 1.424973e-02 3 1  ON 10
ci_12                 1.000350e-02 3 1  ON 11
ci_13                 1.262586e-02 3 1  ON 12
ci_14                 1.223244e-02 3 1  ON 13
ci_15                 9.375680e-03 3 1  ON 14
ci_16                 9.346676e-03 3 1  ON 15
ci_17                -9.609141e-03 3 1  ON 16
ci_18                -8.927182e-03 3 1  ON 17
ci_19                 1.028042e-02 3 1  ON 18
ci_20                 8.456537e-03 3 1  ON 19
ci_21                 9.155014e-03 3 1  ON 20
ci_22                 9.352592e-03 3 1  ON 21
ci_23                 5.577577e-03 3 1  ON 22
ci_24                 4.954034e-03 3 1  ON 23
ci_25                 3.807736e-03 3 1  ON 24
ci_26                 3.861834e-03 3 1  ON 25
ci_27                 3.975939e-03 3 1  ON 26
ci_28                 2.992661e-03 3 1  ON 27
ci_29                 3.059740e-03 3 1  ON 28
ci_30                -2.405840e-03 3 1  ON 29
ci_31                -2.761874e-03 3 1  ON 30
ci_32                -1.868325e-03 3 1  ON 31
ci_33                -1.916481e-03 3 1  ON 32
ci_34                 1.846738e-03 3 1  ON 33
ci_35                 1.830679e-03 3 1  ON 34
ci_36                -1.631750e-03 3 1  ON 35
ci_37                -1.788918e-03 3 1  ON 36
ci_38                -1.186651e-03 3 1  ON 37
ci_39                -1.308220e-03 3 1  ON 38
ci_40                -1.780838e-03 3 1  ON 39
ci_41                -1.471119e-03 3 1  ON 40
ci_42                -1.233852e-03 3 1  ON 41
ci_43                -2.473527e-03 3 1  ON 42
ci_44                -1.777073e-03 3 1  ON 43
ci_45                -1.148474e-03 3 1  ON 44
ci_46                -9.736954e-04 3 1  ON 45
ci_47                -4.640010e-04 3 1  ON 46
ci_48                -6.028331e-04 3 1  ON 47
ci_49                -1.305266e-03 3 1  ON 48
ci_50                -1.006646e-03 3 1  ON 49
ci_51                 1.006618e-03 3 1  ON 50
ci_52                 8.721747e-04 3 1  ON 51
ci_53                -1.189945e-03 3 1  ON 52
ci_54                -1.078850e-03 3 1  ON 53
ci_55                -7.551805e-04 3 1  ON 54
ci_56                 1.600655e-03 3 1  ON 55
ci_57                 1.576472e-03 3 1  ON 56
ci_58                -1.041260e-03 3 1  ON 57
ci_59                -9.077929e-04 3 1  ON 58
ci_60                 9.079398e-04 3 1  ON 59
ci_61                 8.312002e-04 3 1  ON 60
ci_62                -6.443471e-04 3 1  ON 61
ci_63                -8.199262e-04 3 1  ON 62
ci_64                -7.702085e-04 3 1  ON 63
ci_65                -5.901794e-04 3 1  ON 64
ci_66                -8.480381e-04 3 1  ON 65
ci_67                -6.974940e-04 3 1  ON 66
ci_68                -6.436281e-05 3 1  ON 67
ci_69                 6.664017e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3716e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.8865
    reference variance = 0.287384
====================================================
  Execution time = 2.5660e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9365e-01
  Total weights = 1.963105260e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6136e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477306123618
                                         uncertainty =       0.002816914170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477306123618
                                         uncertainty =       0.002816914170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488547049
  error estimate for blocks of size 2^( 2) =       0.000509121811
  error estimate for blocks of size 2^( 3) =       0.000529275196
  error estimate for blocks of size 2^( 4) =       0.000544781599
  error estimate for blocks of size 2^( 5) =       0.000554996324
  error estimate for blocks of size 2^( 6) =       0.000559839824
  error estimate for blocks of size 2^( 7) =       0.000561489323

      target function =      -0.711500201307
              le_mean =     -22.816875385612
             les_mean =     521.103452521179
             stat err =       0.000555276767
             autocorr =       1.291832531533
   target nu stat err =       0.000555276767
   target dn stat err =       0.003099919272
      target stat err =       0.002259053663
              std dev =       0.690909862763
             le_variance =       0.477356438464


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281687538561e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711506521369       residual = 3.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711770155130       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711812627771       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711818717986       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711820146593       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711820915070       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711821185188       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711821210583       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711821216204       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711821211100       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 8.759407e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711506521369       residual = 3.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711574769691       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711585630987       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711587165837       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711587519028       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711587705922       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711587770274       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711587776242       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711587777530       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711587776296       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.237938e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711506521369       residual = 3.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711523736160       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711526467002       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711526851436       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711526939455       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711526985834       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711527001718       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711527003186       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711527003501       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711527003195       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.640686e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.602644 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0283e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_01                 1.455557e-01 3 1  ON 0
ci_02                -4.187623e-02 3 1  ON 1
ci_03                -4.160567e-02 3 1  ON 2
ci_04                 3.861054e-02 3 1  ON 3
ci_05                -3.008203e-02 3 1  ON 4
ci_06                -2.934822e-02 3 1  ON 5
ci_07                 2.846130e-02 3 1  ON 6
ci_08                -1.118663e-02 3 1  ON 7
ci_09                -1.295030e-02 3 1  ON 8
ci_10                -1.276426e-02 3 1  ON 9
ci_11                 1.423022e-02 3 1  ON 10
ci_12                 9.935201e-03 3 1  ON 11
ci_13                 1.261935e-02 3 1  ON 12
ci_14                 1.223404e-02 3 1  ON 13
ci_15                 9.340467e-03 3 1  ON 14
ci_16                 9.300996e-03 3 1  ON 15
ci_17                -9.560255e-03 3 1  ON 16
ci_18                -8.896631e-03 3 1  ON 17
ci_19                 1.025169e-02 3 1  ON 18
ci_20                 8.423650e-03 3 1  ON 19
ci_21                 9.147986e-03 3 1  ON 20
ci_22                 9.340619e-03 3 1  ON 21
ci_23                 5.558922e-03 3 1  ON 22
ci_24                 4.958744e-03 3 1  ON 23
ci_25                 3.800386e-03 3 1  ON 24
ci_26                 3.866103e-03 3 1  ON 25
ci_27                 3.959576e-03 3 1  ON 26
ci_28                 2.976721e-03 3 1  ON 27
ci_29                 3.027619e-03 3 1  ON 28
ci_30                -2.394764e-03 3 1  ON 29
ci_31                -2.740437e-03 3 1  ON 30
ci_32                -1.861028e-03 3 1  ON 31
ci_33                -1.899784e-03 3 1  ON 32
ci_34                 1.829336e-03 3 1  ON 33
ci_35                 1.820041e-03 3 1  ON 34
ci_36                -1.623039e-03 3 1  ON 35
ci_37                -1.775254e-03 3 1  ON 36
ci_38                -1.174178e-03 3 1  ON 37
ci_39                -1.298136e-03 3 1  ON 38
ci_40                -1.776018e-03 3 1  ON 39
ci_41                -1.446765e-03 3 1  ON 40
ci_42                -1.242080e-03 3 1  ON 41
ci_43                -2.475744e-03 3 1  ON 42
ci_44                -1.770884e-03 3 1  ON 43
ci_45                -1.140101e-03 3 1  ON 44
ci_46                -9.742765e-04 3 1  ON 45
ci_47                -4.494267e-04 3 1  ON 46
ci_48                -5.881366e-04 3 1  ON 47
ci_49                -1.305088e-03 3 1  ON 48
ci_50                -1.003503e-03 3 1  ON 49
ci_51                 9.962945e-04 3 1  ON 50
ci_52                 8.693331e-04 3 1  ON 51
ci_53                -1.181355e-03 3 1  ON 52
ci_54                -1.059946e-03 3 1  ON 53
ci_55                -7.510006e-04 3 1  ON 54
ci_56                 1.600275e-03 3 1  ON 55
ci_57                 1.568161e-03 3 1  ON 56
ci_58                -1.025007e-03 3 1  ON 57
ci_59                -9.181266e-04 3 1  ON 58
ci_60                 9.038710e-04 3 1  ON 59
ci_61                 8.361393e-04 3 1  ON 60
ci_62                -6.368474e-04 3 1  ON 61
ci_63                -8.128365e-04 3 1  ON 62
ci_64                -7.653764e-04 3 1  ON 63
ci_65                -5.843137e-04 3 1  ON 64
ci_66                -8.536612e-04 3 1  ON 65
ci_67                -6.977044e-04 3 1  ON 66
ci_68                -6.489273e-05 3 1  ON 67
ci_69                 4.031203e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.7894
    reference variance = 0.45437
====================================================
  Execution time = 2.5080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 5.0042e-01
  Total weights = 1.9634e+06
  Execution time = 3.5756e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481778068951
                                         uncertainty =       0.003314749055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481778068951
                                         uncertainty =       0.003314749055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490865580
  error estimate for blocks of size 2^( 2) =       0.000512023067
  error estimate for blocks of size 2^( 3) =       0.000531866525
  error estimate for blocks of size 2^( 4) =       0.000546950628
  error estimate for blocks of size 2^( 5) =       0.000555904412
  error estimate for blocks of size 2^( 6) =       0.000561426300
  error estimate for blocks of size 2^( 7) =       0.000563088457

      target function =      -0.706474883354
              le_mean =     -22.817491658051
             les_mean =     521.138739954197
             stat err =       0.000556842449
             autocorr =       1.286884319932
   target nu stat err =       0.000556842449
   target dn stat err =       0.004162619811
      target stat err =       0.002954390473
              std dev =       0.694188761201
             le_variance =       0.481898036178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480963700163
                                         uncertainty =       0.003328551340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480963700163
                                         uncertainty =       0.003328551340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490452088
  error estimate for blocks of size 2^( 2) =       0.000511604082
  error estimate for blocks of size 2^( 3) =       0.000531446889
  error estimate for blocks of size 2^( 4) =       0.000546530899
  error estimate for blocks of size 2^( 5) =       0.000555492345
  error estimate for blocks of size 2^( 6) =       0.000561000318
  error estimate for blocks of size 2^( 7) =       0.000562657011

      target function =      -0.707054763666
              le_mean =     -22.817492691014
             les_mean =     521.137956143336
             stat err =       0.000556420143
             autocorr =       1.287100656785
   target nu stat err =       0.000556420143
   target dn stat err =       0.004173558615
      target stat err =       0.002966593601
              std dev =       0.693603994789
             le_variance =       0.481086501587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481344323276
                                         uncertainty =       0.003321782189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481344323276
                                         uncertainty =       0.003321782189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490645374
  error estimate for blocks of size 2^( 2) =       0.000511799757
  error estimate for blocks of size 2^( 3) =       0.000531642769
  error estimate for blocks of size 2^( 4) =       0.000546726897
  error estimate for blocks of size 2^( 5) =       0.000555684722
  error estimate for blocks of size 2^( 6) =       0.000561199600
  error estimate for blocks of size 2^( 7) =       0.000562859093

      target function =      -0.706923665136
              le_mean =     -22.817490625235
             les_mean =     521.138050007772
             stat err =       0.000556617578
             autocorr =       1.286999614448
   target nu stat err =       0.000556617578
   target dn stat err =       0.004118342210
      target stat err =       0.002927661683
              std dev =       0.693877342799
             le_variance =       0.481465766850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481721941504
                                         uncertainty =       0.003315617361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481721941504
                                         uncertainty =       0.003315617361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490837089
  error estimate for blocks of size 2^( 2) =       0.000511994155
  error estimate for blocks of size 2^( 3) =       0.000531837542
  error estimate for blocks of size 2^( 4) =       0.000546921647
  error estimate for blocks of size 2^( 5) =       0.000555875951
  error estimate for blocks of size 2^( 6) =       0.000561396981
  error estimate for blocks of size 2^( 7) =       0.000563058818

      target function =      -0.706554992053
              le_mean =     -22.817491339322
             les_mean =     521.138610634225
             stat err =       0.000556813349
             autocorr =       1.286899209085
   target nu stat err =       0.000556813349
   target dn stat err =       0.004150879255
      target stat err =       0.002946996166
              std dev =       0.694148468086
             le_variance =       0.481842095746


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706474883354        initial
     9.7656e-01     9.7656e+00             8.7594e-04        -0.707054763666  <--
     3.9062e+00     3.9062e+01             2.2379e-04        -0.706923665136
     1.5625e+01     1.5625e+02             5.6407e-05        -0.706554992053

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 4.3028e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_01                 1.449033e-01 3 1  ON 0
ci_02                -4.131407e-02 3 1  ON 1
ci_03                -4.096249e-02 3 1  ON 2
ci_04                 3.798128e-02 3 1  ON 3
ci_05                -2.968644e-02 3 1  ON 4
ci_06                -2.892765e-02 3 1  ON 5
ci_07                 2.838245e-02 3 1  ON 6
ci_08                -1.093559e-02 3 1  ON 7
ci_09                -1.280587e-02 3 1  ON 8
ci_10                -1.257474e-02 3 1  ON 9
ci_11                 1.417414e-02 3 1  ON 10
ci_12                 9.739432e-03 3 1  ON 11
ci_13                 1.260023e-02 3 1  ON 12
ci_14                 1.223879e-02 3 1  ON 13
ci_15                 9.239160e-03 3 1  ON 14
ci_16                 9.169543e-03 3 1  ON 15
ci_17                -9.419039e-03 3 1  ON 16
ci_18                -8.808372e-03 3 1  ON 17
ci_19                 1.017002e-02 3 1  ON 18
ci_20                 8.329557e-03 3 1  ON 19
ci_21                 9.127332e-03 3 1  ON 20
ci_22                 9.305451e-03 3 1  ON 21
ci_23                 5.505695e-03 3 1  ON 22
ci_24                 4.972771e-03 3 1  ON 23
ci_25                 3.779407e-03 3 1  ON 24
ci_26                 3.878568e-03 3 1  ON 25
ci_27                 3.912759e-03 3 1  ON 26
ci_28                 2.930346e-03 3 1  ON 27
ci_29                 2.934872e-03 3 1  ON 28
ci_30                -2.362620e-03 3 1  ON 29
ci_31                -2.677926e-03 3 1  ON 30
ci_32                -1.840575e-03 3 1  ON 31
ci_33                -1.852650e-03 3 1  ON 32
ci_34                 1.779992e-03 3 1  ON 33
ci_35                 1.790371e-03 3 1  ON 34
ci_36                -1.597991e-03 3 1  ON 35
ci_37                -1.736094e-03 3 1  ON 36
ci_38                -1.138439e-03 3 1  ON 37
ci_39                -1.269168e-03 3 1  ON 38
ci_40                -1.762167e-03 3 1  ON 39
ci_41                -1.377517e-03 3 1  ON 40
ci_42                -1.266082e-03 3 1  ON 41
ci_43                -2.481515e-03 3 1  ON 42
ci_44                -1.752349e-03 3 1  ON 43
ci_45                -1.116070e-03 3 1  ON 44
ci_46                -9.758304e-04 3 1  ON 45
ci_47                -4.067948e-04 3 1  ON 46
ci_48                -5.451998e-04 3 1  ON 47
ci_49                -1.304469e-03 3 1  ON 48
ci_50                -9.944470e-04 3 1  ON 49
ci_51                 9.666396e-04 3 1  ON 50
ci_52                 8.610570e-04 3 1  ON 51
ci_53                -1.156799e-03 3 1  ON 52
ci_54                -1.005536e-03 3 1  ON 53
ci_55                -7.389440e-04 3 1  ON 54
ci_56                 1.599424e-03 3 1  ON 55
ci_57                 1.544618e-03 3 1  ON 56
ci_58                -9.785295e-04 3 1  ON 57
ci_59                -9.478844e-04 3 1  ON 58
ci_60                 8.917605e-04 3 1  ON 59
ci_61                 8.507038e-04 3 1  ON 60
ci_62                -6.152805e-04 3 1  ON 61
ci_63                -7.924383e-04 3 1  ON 62
ci_64                -7.514475e-04 3 1  ON 63
ci_65                -5.672526e-04 3 1  ON 64
ci_66                -8.696365e-04 3 1  ON 65
ci_67                -6.983192e-04 3 1  ON 66
ci_68                -6.630048e-05 3 1  ON 67
ci_69                -3.526020e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3316e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7946
    reference variance = 0.527064
====================================================
  Execution time = 2.5767e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 5.1409e-01
  Total weights = 1.963325347e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484438678487
                                         uncertainty =       0.004162995386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484438678487
                                         uncertainty =       0.004162995386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492129277
  error estimate for blocks of size 2^( 2) =       0.000512980996
  error estimate for blocks of size 2^( 3) =       0.000532766045
  error estimate for blocks of size 2^( 4) =       0.000548773055
  error estimate for blocks of size 2^( 5) =       0.000555914176
  error estimate for blocks of size 2^( 6) =       0.000561612000
  error estimate for blocks of size 2^( 7) =       0.000561859191

      target function =      -0.697112085796
              le_mean =     -22.817355833264
             les_mean =     521.145820500943
             stat err =       0.000557039606
             autocorr =       1.281190603801
   target nu stat err =       0.000557039606
   target dn stat err =       0.018872722208
      target stat err =       0.012827542067
              std dev =       0.695975898094
             le_variance =       0.484382450727


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281735583326e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.697346274844       residual = 9.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.699249898619       residual = 8.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.699461709655       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.699505277036       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.699518380464       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.699525771505       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.699526884271       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.699527546609       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.699527600625       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.699527586994       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.699527605127       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 3.470243e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.697346274844       residual = 9.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.697888286375       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.697945855064       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.697956960848       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.697960135461       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.697961920292       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.697962165897       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.697962323040       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.697962350177       residual = 9.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.697962342667       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.697962348712       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 9.885514e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.697346274844       residual = 9.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.697486634679       residual = 8.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.697501333668       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.697504114971       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.697504898850       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.697505340025       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.697505399452       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.697505437856       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.697505445653       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.697505443562       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.697505445133       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.560231e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.606791 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0397e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_01                 1.440183e-01 3 1  ON 0
ci_02                -4.072872e-02 3 1  ON 1
ci_03                -4.046282e-02 3 1  ON 2
ci_04                 3.699273e-02 3 1  ON 3
ci_05                -2.915142e-02 3 1  ON 4
ci_06                -2.842770e-02 3 1  ON 5
ci_07                 2.837048e-02 3 1  ON 6
ci_08                -1.059565e-02 3 1  ON 7
ci_09                -1.255910e-02 3 1  ON 8
ci_10                -1.238814e-02 3 1  ON 9
ci_11                 1.414116e-02 3 1  ON 10
ci_12                 9.490888e-03 3 1  ON 11
ci_13                 1.255192e-02 3 1  ON 12
ci_14                 1.224513e-02 3 1  ON 13
ci_15                 9.198032e-03 3 1  ON 14
ci_16                 9.052342e-03 3 1  ON 15
ci_17                -9.224153e-03 3 1  ON 16
ci_18                -8.824366e-03 3 1  ON 17
ci_19                 9.970275e-03 3 1  ON 18
ci_20                 7.872598e-03 3 1  ON 19
ci_21                 9.054443e-03 3 1  ON 20
ci_22                 9.279865e-03 3 1  ON 21
ci_23                 5.638027e-03 3 1  ON 22
ci_24                 4.916337e-03 3 1  ON 23
ci_25                 3.733414e-03 3 1  ON 24
ci_26                 3.835504e-03 3 1  ON 25
ci_27                 3.778867e-03 3 1  ON 26
ci_28                 2.945111e-03 3 1  ON 27
ci_29                 2.811351e-03 3 1  ON 28
ci_30                -2.307383e-03 3 1  ON 29
ci_31                -2.491319e-03 3 1  ON 30
ci_32                -1.968144e-03 3 1  ON 31
ci_33                -1.884322e-03 3 1  ON 32
ci_34                 1.490282e-03 3 1  ON 33
ci_35                 1.740711e-03 3 1  ON 34
ci_36                -1.659555e-03 3 1  ON 35
ci_37                -1.658901e-03 3 1  ON 36
ci_38                -1.122237e-03 3 1  ON 37
ci_39                -1.267548e-03 3 1  ON 38
ci_40                -1.669474e-03 3 1  ON 39
ci_41                -1.435011e-03 3 1  ON 40
ci_42                -8.129390e-04 3 1  ON 41
ci_43                -2.360413e-03 3 1  ON 42
ci_44                -1.684154e-03 3 1  ON 43
ci_45                -1.148692e-03 3 1  ON 44
ci_46                -8.667757e-04 3 1  ON 45
ci_47                -2.648665e-04 3 1  ON 46
ci_48                -4.360024e-04 3 1  ON 47
ci_49                -1.171668e-03 3 1  ON 48
ci_50                -9.470201e-04 3 1  ON 49
ci_51                 9.491603e-04 3 1  ON 50
ci_52                 8.301280e-04 3 1  ON 51
ci_53                -1.213956e-03 3 1  ON 52
ci_54                -1.033912e-03 3 1  ON 53
ci_55                -6.925693e-04 3 1  ON 54
ci_56                 1.527116e-03 3 1  ON 55
ci_57                 1.981214e-03 3 1  ON 56
ci_58                -1.029713e-03 3 1  ON 57
ci_59                -8.902946e-04 3 1  ON 58
ci_60                 8.098364e-04 3 1  ON 59
ci_61                 8.967337e-04 3 1  ON 60
ci_62                -5.547506e-04 3 1  ON 61
ci_63                -9.830161e-04 3 1  ON 62
ci_64                -5.981540e-04 3 1  ON 63
ci_65                -6.691738e-04 3 1  ON 64
ci_66                -8.477318e-04 3 1  ON 65
ci_67                -7.998180e-04 3 1  ON 66
ci_68                -2.210924e-04 3 1  ON 67
ci_69                -4.251282e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7473
    reference variance = 0.343696
====================================================
  Execution time = 2.5124e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9171e-01
  Total weights = 1.9632e+06
  Execution time = 3.5770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482827259395
                                         uncertainty =       0.006028104780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482827259395
                                         uncertainty =       0.006028104780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491280032
  error estimate for blocks of size 2^( 2) =       0.000512046234
  error estimate for blocks of size 2^( 3) =       0.000531878221
  error estimate for blocks of size 2^( 4) =       0.000546542060
  error estimate for blocks of size 2^( 5) =       0.000557206607
  error estimate for blocks of size 2^( 6) =       0.000562794895
  error estimate for blocks of size 2^( 7) =       0.000564952019

      target function =      -0.067631578218
              le_mean =     -22.816994966284
             les_mean =     526.321799238865
             stat err =       0.000557873895
             autocorr =       1.289477756572
   target nu stat err =       0.000557873895
   target dn stat err =       5.215821187103
      target stat err =       0.056717309005
              std dev =       0.694774883680
             le_variance =       0.482712138993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491177854458
                                         uncertainty =       0.011362470612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491177854458
                                         uncertainty =       0.011362470612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495508724
  error estimate for blocks of size 2^( 2) =       0.000516032136
  error estimate for blocks of size 2^( 3) =       0.000535534573
  error estimate for blocks of size 2^( 4) =       0.000549820904
  error estimate for blocks of size 2^( 5) =       0.000560123052
  error estimate for blocks of size 2^( 6) =       0.000565540313
  error estimate for blocks of size 2^( 7) =       0.000567543610

      target function =      -0.300649070360
              le_mean =     -22.816967175473
             les_mean =     522.220328941677
             stat err =       0.000560756970
             autocorr =       1.280698057773
   target nu stat err =       0.000560756970
   target dn stat err =       0.746908565803
      target stat err =       0.105955706915
              std dev =       0.700755157307
             le_variance =       0.491057790493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475696718971
                                         uncertainty =       0.002489905836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475696718971
                                         uncertainty =       0.002489905836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487640649
  error estimate for blocks of size 2^( 2) =       0.000508503440
  error estimate for blocks of size 2^( 3) =       0.000528395585
  error estimate for blocks of size 2^( 4) =       0.000543009213
  error estimate for blocks of size 2^( 5) =       0.000553587092
  error estimate for blocks of size 2^( 6) =       0.000559154539
  error estimate for blocks of size 2^( 7) =       0.000561718752

      target function =      -0.701310434315
              le_mean =     -22.816927139945
             les_mean =     521.120334088294
             stat err =       0.000554367399
             autocorr =       1.292395879942
   target nu stat err =       0.000554367399
   target dn stat err =       0.011003750550
      target stat err =       0.007575967729
              std dev =       0.689628018724
             le_variance =       0.475586804209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477113569819
                                         uncertainty =       0.002525576589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477113569819
                                         uncertainty =       0.002525576589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488366070
  error estimate for blocks of size 2^( 2) =       0.000509217602
  error estimate for blocks of size 2^( 3) =       0.000529107690
  error estimate for blocks of size 2^( 4) =       0.000543718895
  error estimate for blocks of size 2^( 5) =       0.000554292179
  error estimate for blocks of size 2^( 6) =       0.000559903156
  error estimate for blocks of size 2^( 7) =       0.000562487293

      target function =      -0.707161406710
              le_mean =     -22.816936220844
             les_mean =     521.112358022758
             stat err =       0.000555100381
             autocorr =       1.291968973113
   target nu stat err =       0.000555100381
   target dn stat err =       0.007698983181
      target stat err =       0.005403254221
              std dev =       0.690653919953
             le_variance =       0.477002837147


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.067631578218        initial
     2.4414e-01     2.4414e+00             3.4702e-03        -0.300649070360
     9.7656e-01     9.7656e+00             9.8855e-04        -0.701310434315
     3.9062e+00     3.9062e+01             2.5602e-04        -0.707161406710  <--

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.3048e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_01                 1.446779e-01 3 1  ON 0
ci_02                -4.116328e-02 3 1  ON 1
ci_03                -4.083362e-02 3 1  ON 2
ci_04                 3.772525e-02 3 1  ON 3
ci_05                -2.954850e-02 3 1  ON 4
ci_06                -2.879853e-02 3 1  ON 5
ci_07                 2.837917e-02 3 1  ON 6
ci_08                -1.084767e-02 3 1  ON 7
ci_09                -1.274098e-02 3 1  ON 8
ci_10                -1.252686e-02 3 1  ON 9
ci_11                 1.416574e-02 3 1  ON 10
ci_12                 9.675138e-03 3 1  ON 11
ci_13                 1.258802e-02 3 1  ON 12
ci_14                 1.224054e-02 3 1  ON 13
ci_15                 9.229235e-03 3 1  ON 14
ci_16                 9.139351e-03 3 1  ON 15
ci_17                -9.368934e-03 3 1  ON 16
ci_18                -8.813077e-03 3 1  ON 17
ci_19                 1.011818e-02 3 1  ON 18
ci_20                 8.211563e-03 3 1  ON 19
ci_21                 9.108779e-03 3 1  ON 20
ci_22                 9.298397e-03 3 1  ON 21
ci_23                 5.540153e-03 3 1  ON 22
ci_24                 4.958227e-03 3 1  ON 23
ci_25                 3.767532e-03 3 1  ON 24
ci_26                 3.867439e-03 3 1  ON 25
ci_27                 3.878961e-03 3 1  ON 26
ci_28                 2.934281e-03 3 1  ON 27
ci_29                 2.903143e-03 3 1  ON 28
ci_30                -2.348456e-03 3 1  ON 29
ci_31                -2.629655e-03 3 1  ON 30
ci_32                -1.873761e-03 3 1  ON 31
ci_33                -1.860601e-03 3 1  ON 32
ci_34                 1.705099e-03 3 1  ON 33
ci_35                 1.777315e-03 3 1  ON 34
ci_36                -1.613953e-03 3 1  ON 35
ci_37                -1.716108e-03 3 1  ON 36
ci_38                -1.134202e-03 3 1  ON 37
ci_39                -1.268803e-03 3 1  ON 38
ci_40                -1.738003e-03 3 1  ON 39
ci_41                -1.392382e-03 3 1  ON 40
ci_42                -1.148453e-03 3 1  ON 41
ci_43                -2.450474e-03 3 1  ON 42
ci_44                -1.734561e-03 3 1  ON 43
ci_45                -1.124516e-03 3 1  ON 44
ci_46                -9.476316e-04 3 1  ON 45
ci_47                -3.700638e-04 3 1  ON 46
ci_48                -5.175556e-04 3 1  ON 47
ci_49                -1.269970e-03 3 1  ON 48
ci_50                -9.821574e-04 3 1  ON 49
ci_51                 9.620613e-04 3 1  ON 50
ci_52                 8.529736e-04 3 1  ON 51
ci_53                -1.171766e-03 3 1  ON 52
ci_54                -1.012752e-03 3 1  ON 53
ci_55                -7.269845e-04 3 1  ON 54
ci_56                 1.580627e-03 3 1  ON 55
ci_57                 1.658109e-03 3 1  ON 56
ci_58                -9.917430e-04 3 1  ON 57
ci_59                -9.326582e-04 3 1  ON 58
ci_60                 8.705791e-04 3 1  ON 59
ci_61                 8.625383e-04 3 1  ON 60
ci_62                -5.995572e-04 3 1  ON 61
ci_63                -8.422563e-04 3 1  ON 62
ci_64                -7.117991e-04 3 1  ON 63
ci_65                -5.938321e-04 3 1  ON 64
ci_66                -8.640577e-04 3 1  ON 65
ci_67                -7.244776e-04 3 1  ON 66
ci_68                -1.064059e-04 3 1  ON 67
ci_69                -3.708564e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3451e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.7673
    reference variance = 0.257536
====================================================
  Execution time = 2.7830e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.9351e-01
  Total weights = 1.963510951e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478978076055
                                         uncertainty =       0.002161812735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478978076055
                                         uncertainty =       0.002161812735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489401683
  error estimate for blocks of size 2^( 2) =       0.000510360323
  error estimate for blocks of size 2^( 3) =       0.000530506517
  error estimate for blocks of size 2^( 4) =       0.000545728383
  error estimate for blocks of size 2^( 5) =       0.000554919880
  error estimate for blocks of size 2^( 6) =       0.000560256477
  error estimate for blocks of size 2^( 7) =       0.000562568538

      target function =      -0.711588380972
              le_mean =     -22.816278661888
             les_mean =     521.076081657181
             stat err =       0.000555868320
             autocorr =       1.290068969724
   target nu stat err =       0.000555868320
   target dn stat err =       0.002919392237
      target stat err =       0.002134447353
              std dev =       0.692118497547
             le_variance =       0.479028014647


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281627866189e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711594004998       residual = 3.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711845625807       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711889300286       residual = 6.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711896906556       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711899602980       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711900184887       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711900466319       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711900494749       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711900499974       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711900506804       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.711900510014       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 1.001356e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711594004998       residual = 3.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711659148035       residual = 4.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711670315341       residual = 6.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711672229348       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711672894789       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711673032725       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711673099575       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711673106191       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711673107421       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711673109037       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.711673109798       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.552199e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711594004998       residual = 3.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711610436825       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711613244522       residual = 6.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711613723734       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711613889494       residual = 8.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711613923492       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711613939980       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711613941603       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711613941906       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711613942304       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.711613942492       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 6.411801e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.610914 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2404e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_01                 1.444227e-01 3 1  ON 0
ci_02                -4.096010e-02 3 1  ON 1
ci_03                -4.065311e-02 3 1  ON 2
ci_04                 3.750955e-02 3 1  ON 3
ci_05                -2.942110e-02 3 1  ON 4
ci_06                -2.865020e-02 3 1  ON 5
ci_07                 2.835732e-02 3 1  ON 6
ci_08                -1.077565e-02 3 1  ON 7
ci_09                -1.266237e-02 3 1  ON 8
ci_10                -1.245130e-02 3 1  ON 9
ci_11                 1.413725e-02 3 1  ON 10
ci_12                 9.639083e-03 3 1  ON 11
ci_13                 1.258000e-02 3 1  ON 12
ci_14                 1.227135e-02 3 1  ON 13
ci_15                 9.197799e-03 3 1  ON 14
ci_16                 9.115176e-03 3 1  ON 15
ci_17                -9.315858e-03 3 1  ON 16
ci_18                -8.786935e-03 3 1  ON 17
ci_19                 1.011204e-02 3 1  ON 18
ci_20                 8.183223e-03 3 1  ON 19
ci_21                 9.113080e-03 3 1  ON 20
ci_22                 9.274481e-03 3 1  ON 21
ci_23                 5.523084e-03 3 1  ON 22
ci_24                 4.954420e-03 3 1  ON 23
ci_25                 3.750214e-03 3 1  ON 24
ci_26                 3.857860e-03 3 1  ON 25
ci_27                 3.882281e-03 3 1  ON 26
ci_28                 2.909638e-03 3 1  ON 27
ci_29                 2.887314e-03 3 1  ON 28
ci_30                -2.335457e-03 3 1  ON 29
ci_31                -2.617643e-03 3 1  ON 30
ci_32                -1.853944e-03 3 1  ON 31
ci_33                -1.827861e-03 3 1  ON 32
ci_34                 1.680916e-03 3 1  ON 33
ci_35                 1.775177e-03 3 1  ON 34
ci_36                -1.605048e-03 3 1  ON 35
ci_37                -1.698846e-03 3 1  ON 36
ci_38                -1.123213e-03 3 1  ON 37
ci_39                -1.261809e-03 3 1  ON 38
ci_40                -1.742468e-03 3 1  ON 39
ci_41                -1.385844e-03 3 1  ON 40
ci_42                -1.147513e-03 3 1  ON 41
ci_43                -2.460607e-03 3 1  ON 42
ci_44                -1.717869e-03 3 1  ON 43
ci_45                -1.108196e-03 3 1  ON 44
ci_46                -9.376477e-04 3 1  ON 45
ci_47                -3.478186e-04 3 1  ON 46
ci_48                -4.939611e-04 3 1  ON 47
ci_49                -1.270178e-03 3 1  ON 48
ci_50                -9.837822e-04 3 1  ON 49
ci_51                 9.459213e-04 3 1  ON 50
ci_52                 8.433979e-04 3 1  ON 51
ci_53                -1.174237e-03 3 1  ON 52
ci_54                -1.016189e-03 3 1  ON 53
ci_55                -7.256962e-04 3 1  ON 54
ci_56                 1.592056e-03 3 1  ON 55
ci_57                 1.652284e-03 3 1  ON 56
ci_58                -1.009754e-03 3 1  ON 57
ci_59                -9.410873e-04 3 1  ON 58
ci_60                 8.753483e-04 3 1  ON 59
ci_61                 8.720716e-04 3 1  ON 60
ci_62                -5.854588e-04 3 1  ON 61
ci_63                -8.413274e-04 3 1  ON 62
ci_64                -7.141426e-04 3 1  ON 63
ci_65                -5.860110e-04 3 1  ON 64
ci_66                -8.760067e-04 3 1  ON 65
ci_67                -7.177528e-04 3 1  ON 66
ci_68                -1.130553e-04 3 1  ON 67
ci_69                -4.418450e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.8495
    reference variance = 0.382833
====================================================
  Execution time = 2.5165e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9083e-01
  Total weights = 1.9631e+06
  Execution time = 3.6179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476550299351
                                         uncertainty =       0.002255975432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476550299351
                                         uncertainty =       0.002255975432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488099856
  error estimate for blocks of size 2^( 2) =       0.000509217087
  error estimate for blocks of size 2^( 3) =       0.000528805472
  error estimate for blocks of size 2^( 4) =       0.000543627062
  error estimate for blocks of size 2^( 5) =       0.000553912020
  error estimate for blocks of size 2^( 6) =       0.000561245165
  error estimate for blocks of size 2^( 7) =       0.000563899535

      target function =      -0.713037696340
              le_mean =     -22.816967100497
             les_mean =     521.105471681770
             stat err =       0.000555670945
             autocorr =       1.296038849491
   target nu stat err =       0.000555670945
   target dn stat err =       0.002740470806
      target stat err =       0.002022423014
              std dev =       0.690277435795
             le_variance =       0.476482938368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475717866722
                                         uncertainty =       0.002246260279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475717866722
                                         uncertainty =       0.002246260279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487672643
  error estimate for blocks of size 2^( 2) =       0.000508792317
  error estimate for blocks of size 2^( 3) =       0.000528390855
  error estimate for blocks of size 2^( 4) =       0.000543225937
  error estimate for blocks of size 2^( 5) =       0.000553511051
  error estimate for blocks of size 2^( 6) =       0.000560835222
  error estimate for blocks of size 2^( 7) =       0.000563504984

      target function =      -0.675783665501
              le_mean =     -22.816973271140
             les_mean =     521.158936016288
             stat err =       0.000555269299
             autocorr =       1.296434370345
   target nu stat err =       0.000555269299
   target dn stat err =       0.048267430567
      target stat err =       0.030844063356
              std dev =       0.689673265288
             le_variance =       0.475649212852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476104543082
                                         uncertainty =       0.002250790483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476104543082
                                         uncertainty =       0.002250790483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487871155
  error estimate for blocks of size 2^( 2) =       0.000508989884
  error estimate for blocks of size 2^( 3) =       0.000528582126
  error estimate for blocks of size 2^( 4) =       0.000543410355
  error estimate for blocks of size 2^( 5) =       0.000553700780
  error estimate for blocks of size 2^( 6) =       0.000561034243
  error estimate for blocks of size 2^( 7) =       0.000563697013

      target function =      -0.711084214702
              le_mean =     -22.816967762405
             les_mean =     521.108251191169
             stat err =       0.000555460598
             autocorr =       1.296272271610
   target nu stat err =       0.000555460598
   target dn stat err =       0.004235305860
      target stat err =       0.003040406253
              std dev =       0.689954004154
             le_variance =       0.476036527848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476492964085
                                         uncertainty =       0.002255300309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476492964085
                                         uncertainty =       0.002255300309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488070446
  error estimate for blocks of size 2^( 2) =       0.000509187847
  error estimate for blocks of size 2^( 3) =       0.000528776632
  error estimate for blocks of size 2^( 4) =       0.000543599091
  error estimate for blocks of size 2^( 5) =       0.000553884698
  error estimate for blocks of size 2^( 6) =       0.000561217806
  error estimate for blocks of size 2^( 7) =       0.000563873142

      target function =      -0.713276607078
              le_mean =     -22.816966979261
             les_mean =     521.105129761779
             stat err =       0.000555643684
             autocorr =       1.296067866271
   target nu stat err =       0.000555643684
   target dn stat err =       0.002726463982
      target stat err =       0.002014151587
              std dev =       0.690235844226
             le_variance =       0.476425520654


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.713037696340        initial
     9.7656e-01     9.7656e+00             1.0014e-03        -0.675783665501
     3.9062e+00     3.9062e+01             2.5522e-04        -0.711084214702
     1.5625e+01     1.5625e+02             6.4118e-05        -0.713276607078  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 4.3286e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_01                 1.446138e-01 3 1  ON 0
ci_02                -4.111207e-02 3 1  ON 1
ci_03                -4.078811e-02 3 1  ON 2
ci_04                 3.767082e-02 3 1  ON 3
ci_05                -2.951637e-02 3 1  ON 4
ci_06                -2.876113e-02 3 1  ON 5
ci_07                 2.837367e-02 3 1  ON 6
ci_08                -1.082951e-02 3 1  ON 7
ci_09                -1.272119e-02 3 1  ON 8
ci_10                -1.250784e-02 3 1  ON 9
ci_11                 1.415856e-02 3 1  ON 10
ci_12                 9.666044e-03 3 1  ON 11
ci_13                 1.258600e-02 3 1  ON 12
ci_14                 1.224826e-02 3 1  ON 13
ci_15                 9.221313e-03 3 1  ON 14
ci_16                 9.133257e-03 3 1  ON 15
ci_17                -9.355566e-03 3 1  ON 16
ci_18                -8.806497e-03 3 1  ON 17
ci_19                 1.011663e-02 3 1  ON 18
ci_20                 8.204417e-03 3 1  ON 19
ci_21                 9.109859e-03 3 1  ON 20
ci_22                 9.292387e-03 3 1  ON 21
ci_23                 5.535844e-03 3 1  ON 22
ci_24                 4.957266e-03 3 1  ON 23
ci_25                 3.763163e-03 3 1  ON 24
ci_26                 3.865019e-03 3 1  ON 25
ci_27                 3.879790e-03 3 1  ON 26
ci_28                 2.928081e-03 3 1  ON 27
ci_29                 2.899159e-03 3 1  ON 28
ci_30                -2.345191e-03 3 1  ON 29
ci_31                -2.626642e-03 3 1  ON 30
ci_32                -1.868750e-03 3 1  ON 31
ci_33                -1.852331e-03 3 1  ON 32
ci_34                 1.698996e-03 3 1  ON 33
ci_35                 1.776761e-03 3 1  ON 34
ci_36                -1.611708e-03 3 1  ON 35
ci_37                -1.711751e-03 3 1  ON 36
ci_38                -1.131432e-03 3 1  ON 37
ci_39                -1.267039e-03 3 1  ON 38
ci_40                -1.739133e-03 3 1  ON 39
ci_41                -1.390728e-03 3 1  ON 40
ci_42                -1.148205e-03 3 1  ON 41
ci_43                -2.453034e-03 3 1  ON 42
ci_44                -1.730367e-03 3 1  ON 43
ci_45                -1.120399e-03 3 1  ON 44
ci_46                -9.451165e-04 3 1  ON 45
ci_47                -3.644736e-04 3 1  ON 46
ci_48                -5.116223e-04 3 1  ON 47
ci_49                -1.270025e-03 3 1  ON 48
ci_50                -9.825692e-04 3 1  ON 49
ci_51                 9.579934e-04 3 1  ON 50
ci_52                 8.505608e-04 3 1  ON 51
ci_53                -1.172391e-03 3 1  ON 52
ci_54                -1.013619e-03 3 1  ON 53
ci_55                -7.266569e-04 3 1  ON 54
ci_56                 1.583509e-03 3 1  ON 55
ci_57                 1.656638e-03 3 1  ON 56
ci_58                -9.962835e-04 3 1  ON 57
ci_59                -9.347829e-04 3 1  ON 58
ci_60                 8.717729e-04 3 1  ON 59
ci_61                 8.649287e-04 3 1  ON 60
ci_62                -5.960009e-04 3 1  ON 61
ci_63                -8.420236e-04 3 1  ON 62
ci_64                -7.123913e-04 3 1  ON 63
ci_65                -5.918594e-04 3 1  ON 64
ci_66                -8.670722e-04 3 1  ON 65
ci_67                -7.227827e-04 3 1  ON 66
ci_68                -1.080808e-04 3 1  ON 67
ci_69                -3.887537e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5696e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8509
    reference variance = 0.324758
====================================================
  Execution time = 2.5947e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9629e-01
  Total weights = 1.963401276e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6399e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480595781056
                                         uncertainty =       0.002569914289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480595781056
                                         uncertainty =       0.002569914289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490195043
  error estimate for blocks of size 2^( 2) =       0.000511061216
  error estimate for blocks of size 2^( 3) =       0.000530718210
  error estimate for blocks of size 2^( 4) =       0.000545445125
  error estimate for blocks of size 2^( 5) =       0.000554388115
  error estimate for blocks of size 2^( 6) =       0.000558564888
  error estimate for blocks of size 2^( 7) =       0.000559374771

      target function =      -0.709631516554
              le_mean =     -22.816753891443
             les_mean =     521.100549262833
             stat err =       0.000554443225
             autocorr =       1.279311581592
   target nu stat err =       0.000554443225
   target dn stat err =       0.004145254133
      target stat err =       0.002964888442
              std dev =       0.693240477788
             le_variance =       0.480582360043


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281675389144e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709643014942       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709710695504       residual = 3.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709719808029       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709721118127       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709721454290       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709721757707       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709721819831       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709721815936       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709721816081       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709721814006       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.219250e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709643014942       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709660084391       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709662374980       residual = 5.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709662703017       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709662786813       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709662862245       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709662877530       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709662876553       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709662876590       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709662876077       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.599236e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709643014942       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709647291738       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709647865167       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709647947208       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709647968141       residual = 8.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709647986972       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709647990778       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709647990534       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709647990543       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709647990415       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 1.403040e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.614456 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0598e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_01                 1.445611e-01 3 1  ON 0
ci_02                -4.106349e-02 3 1  ON 1
ci_03                -4.073893e-02 3 1  ON 2
ci_04                 3.761483e-02 3 1  ON 3
ci_05                -2.948222e-02 3 1  ON 4
ci_06                -2.873311e-02 3 1  ON 5
ci_07                 2.837206e-02 3 1  ON 6
ci_08                -1.080898e-02 3 1  ON 7
ci_09                -1.270180e-02 3 1  ON 8
ci_10                -1.248885e-02 3 1  ON 9
ci_11                 1.415260e-02 3 1  ON 10
ci_12                 9.652010e-03 3 1  ON 11
ci_13                 1.259143e-02 3 1  ON 12
ci_14                 1.224915e-02 3 1  ON 13
ci_15                 9.209522e-03 3 1  ON 14
ci_16                 9.123546e-03 3 1  ON 15
ci_17                -9.346444e-03 3 1  ON 16
ci_18                -8.802192e-03 3 1  ON 17
ci_19                 1.011320e-02 3 1  ON 18
ci_20                 8.201130e-03 3 1  ON 19
ci_21                 9.111234e-03 3 1  ON 20
ci_22                 9.293462e-03 3 1  ON 21
ci_23                 5.533223e-03 3 1  ON 22
ci_24                 4.955218e-03 3 1  ON 23
ci_25                 3.759422e-03 3 1  ON 24
ci_26                 3.867388e-03 3 1  ON 25
ci_27                 3.879190e-03 3 1  ON 26
ci_28                 2.925100e-03 3 1  ON 27
ci_29                 2.895917e-03 3 1  ON 28
ci_30                -2.345225e-03 3 1  ON 29
ci_31                -2.620443e-03 3 1  ON 30
ci_32                -1.863887e-03 3 1  ON 31
ci_33                -1.853120e-03 3 1  ON 32
ci_34                 1.699204e-03 3 1  ON 33
ci_35                 1.773000e-03 3 1  ON 34
ci_36                -1.605643e-03 3 1  ON 35
ci_37                -1.710221e-03 3 1  ON 36
ci_38                -1.132493e-03 3 1  ON 37
ci_39                -1.266424e-03 3 1  ON 38
ci_40                -1.740883e-03 3 1  ON 39
ci_41                -1.390007e-03 3 1  ON 40
ci_42                -1.150092e-03 3 1  ON 41
ci_43                -2.454989e-03 3 1  ON 42
ci_44                -1.732026e-03 3 1  ON 43
ci_45                -1.115135e-03 3 1  ON 44
ci_46                -9.395429e-04 3 1  ON 45
ci_47                -3.583992e-04 3 1  ON 46
ci_48                -5.081530e-04 3 1  ON 47
ci_49                -1.266096e-03 3 1  ON 48
ci_50                -9.825939e-04 3 1  ON 49
ci_51                 9.521863e-04 3 1  ON 50
ci_52                 8.489510e-04 3 1  ON 51
ci_53                -1.170422e-03 3 1  ON 52
ci_54                -1.013127e-03 3 1  ON 53
ci_55                -7.247253e-04 3 1  ON 54
ci_56                 1.584350e-03 3 1  ON 55
ci_57                 1.659148e-03 3 1  ON 56
ci_58                -9.968170e-04 3 1  ON 57
ci_59                -9.332642e-04 3 1  ON 58
ci_60                 8.685131e-04 3 1  ON 59
ci_61                 8.717867e-04 3 1  ON 60
ci_62                -5.956275e-04 3 1  ON 61
ci_63                -8.392634e-04 3 1  ON 62
ci_64                -7.113275e-04 3 1  ON 63
ci_65                -5.917094e-04 3 1  ON 64
ci_66                -8.654253e-04 3 1  ON 65
ci_67                -7.234497e-04 3 1  ON 66
ci_68                -1.109468e-04 3 1  ON 67
ci_69                -4.300833e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8103
    reference variance = 0.355944
====================================================
  Execution time = 2.5063e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9274e-01
  Total weights = 1.9637e+06
  Execution time = 3.5787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478307468867
                                         uncertainty =       0.002345708787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478307468867
                                         uncertainty =       0.002345708787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489017691
  error estimate for blocks of size 2^( 2) =       0.000510193411
  error estimate for blocks of size 2^( 3) =       0.000529623453
  error estimate for blocks of size 2^( 4) =       0.000545441866
  error estimate for blocks of size 2^( 5) =       0.000554011256
  error estimate for blocks of size 2^( 6) =       0.000561995139
  error estimate for blocks of size 2^( 7) =       0.000563110048

      target function =      -0.712076048075
              le_mean =     -22.816656627412
             les_mean =     521.092651466605
             stat err =       0.000556139577
             autocorr =       1.293357136702
   target nu stat err =       0.000556139577
   target dn stat err =       0.002720564285
      target stat err =       0.002002885754
              std dev =       0.691575450348
             le_variance =       0.478276603524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478098163344
                                         uncertainty =       0.002341454452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478098163344
                                         uncertainty =       0.002341454452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488910616
  error estimate for blocks of size 2^( 2) =       0.000510087524
  error estimate for blocks of size 2^( 3) =       0.000529519136
  error estimate for blocks of size 2^( 4) =       0.000545339985
  error estimate for blocks of size 2^( 5) =       0.000553912165
  error estimate for blocks of size 2^( 6) =       0.000561894657
  error estimate for blocks of size 2^( 7) =       0.000563009452

      target function =      -0.712220932965
              le_mean =     -22.816657877537
             les_mean =     521.092503856903
             stat err =       0.000556039065
             autocorr =       1.293456042951
   target nu stat err =       0.000556039065
   target dn stat err =       0.002717080916
      target stat err =       0.002001275629
              std dev =       0.691424023333
             le_variance =       0.478067180042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478201302898
                                         uncertainty =       0.002343544961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478201302898
                                         uncertainty =       0.002343544961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488963382
  error estimate for blocks of size 2^( 2) =       0.000510139691
  error estimate for blocks of size 2^( 3) =       0.000529570523
  error estimate for blocks of size 2^( 4) =       0.000545390153
  error estimate for blocks of size 2^( 5) =       0.000553960923
  error estimate for blocks of size 2^( 6) =       0.000561944102
  error estimate for blocks of size 2^( 7) =       0.000563058934

      target function =      -0.712188153955
              le_mean =     -22.816657156237
             les_mean =     521.092517236173
             stat err =       0.000556088528
             autocorr =       1.293406975702
   target nu stat err =       0.000556088528
   target dn stat err =       0.002715700470
      target stat err =       0.002000170877
              std dev =       0.691498646270
             le_variance =       0.478170377793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478294098115
                                         uncertainty =       0.002345435489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478294098115
                                         uncertainty =       0.002345435489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489010851
  error estimate for blocks of size 2^( 2) =       0.000510186644
  error estimate for blocks of size 2^( 3) =       0.000529616788
  error estimate for blocks of size 2^( 4) =       0.000545435354
  error estimate for blocks of size 2^( 5) =       0.000554004918
  error estimate for blocks of size 2^( 6) =       0.000561988713
  error estimate for blocks of size 2^( 7) =       0.000563103601

      target function =      -0.712097998362
              le_mean =     -22.816656683518
             les_mean =     521.092623015468
             stat err =       0.000556133147
             autocorr =       1.293363405154
   target nu stat err =       0.000556133147
   target dn stat err =       0.002719413983
      target stat err =       0.002002220503
              std dev =       0.691565777975
             le_variance =       0.478263225266


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.712076048075        initial
     3.9062e+00     3.9062e+01             2.2192e-04        -0.712220932965  <--
     1.5625e+01     1.5625e+02             5.5992e-05        -0.712188153955
     6.2500e+01     6.2500e+02             1.4030e-05        -0.712097998362

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.3011e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_01                 1.444042e-01 3 1  ON 0
ci_02                -4.091932e-02 3 1  ON 1
ci_03                -4.059295e-02 3 1  ON 2
ci_04                 3.744890e-02 3 1  ON 3
ci_05                -2.938094e-02 3 1  ON 4
ci_06                -2.865005e-02 3 1  ON 5
ci_07                 2.836729e-02 3 1  ON 6
ci_08                -1.074811e-02 3 1  ON 7
ci_09                -1.264418e-02 3 1  ON 8
ci_10                -1.243243e-02 3 1  ON 9
ci_11                 1.413493e-02 3 1  ON 10
ci_12                 9.610384e-03 3 1  ON 11
ci_13                 1.260765e-02 3 1  ON 12
ci_14                 1.225185e-02 3 1  ON 13
ci_15                 9.174535e-03 3 1  ON 14
ci_16                 9.094725e-03 3 1  ON 15
ci_17                -9.319321e-03 3 1  ON 16
ci_18                -8.789393e-03 3 1  ON 17
ci_19                 1.010308e-02 3 1  ON 18
ci_20                 8.191390e-03 3 1  ON 19
ci_21                 9.115341e-03 3 1  ON 20
ci_22                 9.296684e-03 3 1  ON 21
ci_23                 5.525458e-03 3 1  ON 22
ci_24                 4.949134e-03 3 1  ON 23
ci_25                 3.748344e-03 3 1  ON 24
ci_26                 3.874444e-03 3 1  ON 25
ci_27                 3.877430e-03 3 1  ON 26
ci_28                 2.916218e-03 3 1  ON 27
ci_29                 2.886288e-03 3 1  ON 28
ci_30                -2.345305e-03 3 1  ON 29
ci_31                -2.601954e-03 3 1  ON 30
ci_32                -1.849502e-03 3 1  ON 31
ci_33                -1.855492e-03 3 1  ON 32
ci_34                 1.699877e-03 3 1  ON 33
ci_35                 1.761893e-03 3 1  ON 34
ci_36                -1.587662e-03 3 1  ON 35
ci_37                -1.705683e-03 3 1  ON 36
ci_38                -1.135646e-03 3 1  ON 37
ci_39                -1.264600e-03 3 1  ON 38
ci_40                -1.746060e-03 3 1  ON 39
ci_41                -1.387903e-03 3 1  ON 40
ci_42                -1.155722e-03 3 1  ON 41
ci_43                -2.460758e-03 3 1  ON 42
ci_44                -1.736939e-03 3 1  ON 43
ci_45                -1.099526e-03 3 1  ON 44
ci_46                -9.230169e-04 3 1  ON 45
ci_47                -3.403100e-04 3 1  ON 46
ci_48                -4.978212e-04 3 1  ON 47
ci_49                -1.254445e-03 3 1  ON 48
ci_50                -9.826638e-04 3 1  ON 49
ci_51                 9.349626e-04 3 1  ON 50
ci_52                 8.441729e-04 3 1  ON 51
ci_53                -1.164581e-03 3 1  ON 52
ci_54                -1.011669e-03 3 1  ON 53
ci_55                -7.189844e-04 3 1  ON 54
ci_56                 1.586844e-03 3 1  ON 55
ci_57                 1.666596e-03 3 1  ON 56
ci_58                -9.984071e-04 3 1  ON 57
ci_59                -9.287606e-04 3 1  ON 58
ci_60                 8.587834e-04 3 1  ON 59
ci_61                 8.922516e-04 3 1  ON 60
ci_62                -5.945094e-04 3 1  ON 61
ci_63                -8.310788e-04 3 1  ON 62
ci_64                -7.081667e-04 3 1  ON 63
ci_65                -5.912620e-04 3 1  ON 64
ci_66                -8.605463e-04 3 1  ON 65
ci_67                -7.254284e-04 3 1  ON 66
ci_68                -1.194346e-04 3 1  ON 67
ci_69                -5.527373e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3616e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.7689
    reference variance = 1.03933
====================================================
  Execution time = 2.5700e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.8893e-01
  Total weights = 1.963667614e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474878505425
                                         uncertainty =       0.001988573556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474878505425
                                         uncertainty =       0.001988573556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487233732
  error estimate for blocks of size 2^( 2) =       0.000507909080
  error estimate for blocks of size 2^( 3) =       0.000528461497
  error estimate for blocks of size 2^( 4) =       0.000544389834
  error estimate for blocks of size 2^( 5) =       0.000554236641
  error estimate for blocks of size 2^( 6) =       0.000560065840
  error estimate for blocks of size 2^( 7) =       0.000562437438

      target function =      -0.714853868004
              le_mean =     -22.816999607752
             les_mean =     521.104403524429
             stat err =       0.000555282438
             autocorr =       1.298832605105
   target nu stat err =       0.000555282438
   target dn stat err =       0.002849990646
      target stat err =       0.002107628340
              std dev =       0.689052551465
             le_variance =       0.474793418680


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281699960775e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714859230207       residual = 2.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.715080385741       residual = 4.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.715115566601       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.715120521249       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.715122083951       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.715123163875       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.715123414038       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.715123438162       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.715123434166       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.715123430963       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 8.769845e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714859230207       residual = 2.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714916499824       residual = 4.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714925498201       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714926747025       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714927133479       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714927395949       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714927455527       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714927461241       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714927460227       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714927459469       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.236912e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714859230207       residual = 2.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714873676945       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714875939510       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714876252311       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714876348626       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714876413747       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714876428452       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714876429861       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714876429606       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714876429420       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.620815e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.617974 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0288e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_01                 1.441805e-01 3 1  ON 0
ci_02                -4.073209e-02 3 1  ON 1
ci_03                -4.039874e-02 3 1  ON 2
ci_04                 3.724609e-02 3 1  ON 3
ci_05                -2.925938e-02 3 1  ON 4
ci_06                -2.852366e-02 3 1  ON 5
ci_07                 2.834893e-02 3 1  ON 6
ci_08                -1.065401e-02 3 1  ON 7
ci_09                -1.259550e-02 3 1  ON 8
ci_10                -1.236632e-02 3 1  ON 9
ci_11                 1.410924e-02 3 1  ON 10
ci_12                 9.589806e-03 3 1  ON 11
ci_13                 1.259532e-02 3 1  ON 12
ci_14                 1.227218e-02 3 1  ON 13
ci_15                 9.151482e-03 3 1  ON 14
ci_16                 9.046791e-03 3 1  ON 15
ci_17                -9.300708e-03 3 1  ON 16
ci_18                -8.758313e-03 3 1  ON 17
ci_19                 1.009981e-02 3 1  ON 18
ci_20                 8.159575e-03 3 1  ON 19
ci_21                 9.109780e-03 3 1  ON 20
ci_22                 9.289591e-03 3 1  ON 21
ci_23                 5.509672e-03 3 1  ON 22
ci_24                 4.944033e-03 3 1  ON 23
ci_25                 3.737728e-03 3 1  ON 24
ci_26                 3.857264e-03 3 1  ON 25
ci_27                 3.874904e-03 3 1  ON 26
ci_28                 2.896050e-03 3 1  ON 27
ci_29                 2.871096e-03 3 1  ON 28
ci_30                -2.334270e-03 3 1  ON 29
ci_31                -2.579248e-03 3 1  ON 30
ci_32                -1.850084e-03 3 1  ON 31
ci_33                -1.833331e-03 3 1  ON 32
ci_34                 1.682257e-03 3 1  ON 33
ci_35                 1.754987e-03 3 1  ON 34
ci_36                -1.577154e-03 3 1  ON 35
ci_37                -1.687705e-03 3 1  ON 36
ci_38                -1.119020e-03 3 1  ON 37
ci_39                -1.253620e-03 3 1  ON 38
ci_40                -1.741608e-03 3 1  ON 39
ci_41                -1.381205e-03 3 1  ON 40
ci_42                -1.153872e-03 3 1  ON 41
ci_43                -2.456364e-03 3 1  ON 42
ci_44                -1.741168e-03 3 1  ON 43
ci_45                -1.083960e-03 3 1  ON 44
ci_46                -9.172742e-04 3 1  ON 45
ci_47                -3.237850e-04 3 1  ON 46
ci_48                -4.755149e-04 3 1  ON 47
ci_49                -1.256672e-03 3 1  ON 48
ci_50                -9.739763e-04 3 1  ON 49
ci_51                 9.174870e-04 3 1  ON 50
ci_52                 8.317739e-04 3 1  ON 51
ci_53                -1.164696e-03 3 1  ON 52
ci_54                -1.014219e-03 3 1  ON 53
ci_55                -7.226506e-04 3 1  ON 54
ci_56                 1.596557e-03 3 1  ON 55
ci_57                 1.667831e-03 3 1  ON 56
ci_58                -9.951882e-04 3 1  ON 57
ci_59                -9.285770e-04 3 1  ON 58
ci_60                 8.727349e-04 3 1  ON 59
ci_61                 8.707857e-04 3 1  ON 60
ci_62                -5.889301e-04 3 1  ON 61
ci_63                -8.269535e-04 3 1  ON 62
ci_64                -6.986684e-04 3 1  ON 63
ci_65                -5.844637e-04 3 1  ON 64
ci_66                -8.622815e-04 3 1  ON 65
ci_67                -7.151105e-04 3 1  ON 66
ci_68                -1.307421e-04 3 1  ON 67
ci_69                -6.408509e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.7738
    reference variance = 0.304426
====================================================
  Execution time = 2.5067e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9642e-01
  Total weights = 1.9635e+06
  Execution time = 3.5986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481547193875
                                         uncertainty =       0.002895260661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481547193875
                                         uncertainty =       0.002895260661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490633537
  error estimate for blocks of size 2^( 2) =       0.000511666438
  error estimate for blocks of size 2^( 3) =       0.000531466941
  error estimate for blocks of size 2^( 4) =       0.000546075312
  error estimate for blocks of size 2^( 5) =       0.000555249768
  error estimate for blocks of size 2^( 6) =       0.000562438154
  error estimate for blocks of size 2^( 7) =       0.000565012572

      target function =      -0.709088791748
              le_mean =     -22.817843893949
             les_mean =     521.151090638395
             stat err =       0.000557193952
             autocorr =       1.289728584868
   target nu stat err =       0.000557193952
   target dn stat err =       0.003716981153
      target stat err =       0.002670278028
              std dev =       0.693860601941
             le_variance =       0.481442534925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480777273628
                                         uncertainty =       0.002900431867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480777273628
                                         uncertainty =       0.002900431867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490241614
  error estimate for blocks of size 2^( 2) =       0.000511278271
  error estimate for blocks of size 2^( 3) =       0.000531088042
  error estimate for blocks of size 2^( 4) =       0.000545715910
  error estimate for blocks of size 2^( 5) =       0.000554903257
  error estimate for blocks of size 2^( 6) =       0.000562088533
  error estimate for blocks of size 2^( 7) =       0.000564664497

      target function =      -0.709339200214
              le_mean =     -22.817844891573
             les_mean =     521.150779819524
             stat err =       0.000556843049
             autocorr =       1.290165010928
   target nu stat err =       0.000556843049
   target dn stat err =       0.003746935883
      target stat err =       0.002692674216
              std dev =       0.693306339160
             le_variance =       0.480673679920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481140415850
                                         uncertainty =       0.002897740466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481140415850
                                         uncertainty =       0.002897740466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490426504
  error estimate for blocks of size 2^( 2) =       0.000511461112
  error estimate for blocks of size 2^( 3) =       0.000531266122
  error estimate for blocks of size 2^( 4) =       0.000545884433
  error estimate for blocks of size 2^( 5) =       0.000555065463
  error estimate for blocks of size 2^( 6) =       0.000562252346
  error estimate for blocks of size 2^( 7) =       0.000564827473

      target function =      -0.709697696213
              le_mean =     -22.817843178733
             les_mean =     521.150192453865
             stat err =       0.000557007429
             autocorr =       1.289953662336
   target nu stat err =       0.000557007429
   target dn stat err =       0.003708574644
      target stat err =       0.002668936027
              std dev =       0.693567812873
             le_variance =       0.481036311054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481660452292
                                         uncertainty =       0.002930592817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481660452292
                                         uncertainty =       0.002930592817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490691222
  error estimate for blocks of size 2^( 2) =       0.000511717071
  error estimate for blocks of size 2^( 3) =       0.000531514750
  error estimate for blocks of size 2^( 4) =       0.000546114107
  error estimate for blocks of size 2^( 5) =       0.000555292081
  error estimate for blocks of size 2^( 6) =       0.000562475518
  error estimate for blocks of size 2^( 7) =       0.000565041759

      target function =      -0.030965611248
              le_mean =     -22.817834475923
             les_mean =     532.661204000062
             stat err =       0.000557230866
             autocorr =       1.289596220451
   target nu stat err =       0.000557230866
   target dn stat err =      11.515919334075
      target stat err =       0.028483577493
              std dev =       0.693942181491
             le_variance =       0.481555751253


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709088791748        initial
     9.7656e-01     9.7656e+00             8.7698e-04        -0.709339200214
     3.9062e+00     3.9062e+01             2.2369e-04        -0.709697696213  <--
     1.5625e+01     1.5625e+02             5.6208e-05        -0.030965611248

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.3115e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_01                 1.441805e-01 3 1  ON 0
ci_02                -4.073209e-02 3 1  ON 1
ci_03                -4.039874e-02 3 1  ON 2
ci_04                 3.724609e-02 3 1  ON 3
ci_05                -2.925938e-02 3 1  ON 4
ci_06                -2.852366e-02 3 1  ON 5
ci_07                 2.834893e-02 3 1  ON 6
ci_08                -1.065401e-02 3 1  ON 7
ci_09                -1.259550e-02 3 1  ON 8
ci_10                -1.236632e-02 3 1  ON 9
ci_11                 1.410924e-02 3 1  ON 10
ci_12                 9.589806e-03 3 1  ON 11
ci_13                 1.259532e-02 3 1  ON 12
ci_14                 1.227218e-02 3 1  ON 13
ci_15                 9.151482e-03 3 1  ON 14
ci_16                 9.046791e-03 3 1  ON 15
ci_17                -9.300708e-03 3 1  ON 16
ci_18                -8.758313e-03 3 1  ON 17
ci_19                 1.009981e-02 3 1  ON 18
ci_20                 8.159575e-03 3 1  ON 19
ci_21                 9.109780e-03 3 1  ON 20
ci_22                 9.289591e-03 3 1  ON 21
ci_23                 5.509672e-03 3 1  ON 22
ci_24                 4.944033e-03 3 1  ON 23
ci_25                 3.737728e-03 3 1  ON 24
ci_26                 3.857264e-03 3 1  ON 25
ci_27                 3.874904e-03 3 1  ON 26
ci_28                 2.896050e-03 3 1  ON 27
ci_29                 2.871096e-03 3 1  ON 28
ci_30                -2.334270e-03 3 1  ON 29
ci_31                -2.579248e-03 3 1  ON 30
ci_32                -1.850084e-03 3 1  ON 31
ci_33                -1.833331e-03 3 1  ON 32
ci_34                 1.682257e-03 3 1  ON 33
ci_35                 1.754987e-03 3 1  ON 34
ci_36                -1.577154e-03 3 1  ON 35
ci_37                -1.687705e-03 3 1  ON 36
ci_38                -1.119020e-03 3 1  ON 37
ci_39                -1.253620e-03 3 1  ON 38
ci_40                -1.741608e-03 3 1  ON 39
ci_41                -1.381205e-03 3 1  ON 40
ci_42                -1.153872e-03 3 1  ON 41
ci_43                -2.456364e-03 3 1  ON 42
ci_44                -1.741168e-03 3 1  ON 43
ci_45                -1.083960e-03 3 1  ON 44
ci_46                -9.172742e-04 3 1  ON 45
ci_47                -3.237850e-04 3 1  ON 46
ci_48                -4.755149e-04 3 1  ON 47
ci_49                -1.256672e-03 3 1  ON 48
ci_50                -9.739763e-04 3 1  ON 49
ci_51                 9.174870e-04 3 1  ON 50
ci_52                 8.317739e-04 3 1  ON 51
ci_53                -1.164696e-03 3 1  ON 52
ci_54                -1.014219e-03 3 1  ON 53
ci_55                -7.226506e-04 3 1  ON 54
ci_56                 1.596557e-03 3 1  ON 55
ci_57                 1.667831e-03 3 1  ON 56
ci_58                -9.951882e-04 3 1  ON 57
ci_59                -9.285770e-04 3 1  ON 58
ci_60                 8.727349e-04 3 1  ON 59
ci_61                 8.707857e-04 3 1  ON 60
ci_62                -5.889301e-04 3 1  ON 61
ci_63                -8.269535e-04 3 1  ON 62
ci_64                -6.986684e-04 3 1  ON 63
ci_65                -5.844637e-04 3 1  ON 64
ci_66                -8.622815e-04 3 1  ON 65
ci_67                -7.151105e-04 3 1  ON 66
ci_68                -1.307421e-04 3 1  ON 67
ci_69                -6.408509e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3408e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8034
    reference variance = 0.302744
====================================================
  Execution time = 2.5738e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9671e-01
  Total weights = 1.963661954e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479276700326
                                         uncertainty =       0.002430684903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479276700326
                                         uncertainty =       0.002430684903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489579113
  error estimate for blocks of size 2^( 2) =       0.000510378045
  error estimate for blocks of size 2^( 3) =       0.000529998620
  error estimate for blocks of size 2^( 4) =       0.000544911423
  error estimate for blocks of size 2^( 5) =       0.000554497784
  error estimate for blocks of size 2^( 6) =       0.000560065116
  error estimate for blocks of size 2^( 7) =       0.000564575073

      target function =      -0.709372031185
              le_mean =     -22.818642410702
             les_mean =     521.187147093984
             stat err =       0.000556012349
             autocorr =       1.289802199372
   target nu stat err =       0.000556012349
   target dn stat err =       0.003478157125
      target stat err =       0.002510782067
              std dev =       0.692369420914
             le_variance =       0.479375415016


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281864241070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709380119278       residual = 2.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709596309498       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709632078886       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709637961065       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709639316412       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709639986056       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709640055046       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709640078113       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709640080306       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709640090293       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709640087351       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 8.303232e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709380119278       residual = 2.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709436072822       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709445218317       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709446700362       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709447035294       residual = 8.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709447195841       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709447210795       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709447216404       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709447216844       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709447219239       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709447218542       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.117695e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.709380119278       residual = 2.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709394232033       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709396531375       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709396902559       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709396986018       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709397025707       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709397029301       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709397030693       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709397030797       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709397031389       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.709397031217       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.321129e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.622110 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0322e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_01                 1.439688e-01 3 1  ON 0
ci_02                -4.053447e-02 3 1  ON 1
ci_03                -4.022312e-02 3 1  ON 2
ci_04                 3.704833e-02 3 1  ON 3
ci_05                -2.913114e-02 3 1  ON 4
ci_06                -2.840947e-02 3 1  ON 5
ci_07                 2.831850e-02 3 1  ON 6
ci_08                -1.057267e-02 3 1  ON 7
ci_09                -1.254918e-02 3 1  ON 8
ci_10                -1.231035e-02 3 1  ON 9
ci_11                 1.409235e-02 3 1  ON 10
ci_12                 9.541937e-03 3 1  ON 11
ci_13                 1.259582e-02 3 1  ON 12
ci_14                 1.226430e-02 3 1  ON 13
ci_15                 9.107652e-03 3 1  ON 14
ci_16                 9.004804e-03 3 1  ON 15
ci_17                -9.276286e-03 3 1  ON 16
ci_18                -8.723585e-03 3 1  ON 17
ci_19                 1.008909e-02 3 1  ON 18
ci_20                 8.133238e-03 3 1  ON 19
ci_21                 9.091313e-03 3 1  ON 20
ci_22                 9.282285e-03 3 1  ON 21
ci_23                 5.494245e-03 3 1  ON 22
ci_24                 4.946069e-03 3 1  ON 23
ci_25                 3.728604e-03 3 1  ON 24
ci_26                 3.862597e-03 3 1  ON 25
ci_27                 3.852695e-03 3 1  ON 26
ci_28                 2.876754e-03 3 1  ON 27
ci_29                 2.853650e-03 3 1  ON 28
ci_30                -2.324720e-03 3 1  ON 29
ci_31                -2.545094e-03 3 1  ON 30
ci_32                -1.837343e-03 3 1  ON 31
ci_33                -1.835914e-03 3 1  ON 32
ci_34                 1.669476e-03 3 1  ON 33
ci_35                 1.759345e-03 3 1  ON 34
ci_36                -1.572986e-03 3 1  ON 35
ci_37                -1.671838e-03 3 1  ON 36
ci_38                -1.113636e-03 3 1  ON 37
ci_39                -1.235434e-03 3 1  ON 38
ci_40                -1.739733e-03 3 1  ON 39
ci_41                -1.350039e-03 3 1  ON 40
ci_42                -1.151613e-03 3 1  ON 41
ci_43                -2.446797e-03 3 1  ON 42
ci_44                -1.744177e-03 3 1  ON 43
ci_45                -1.077806e-03 3 1  ON 44
ci_46                -9.103049e-04 3 1  ON 45
ci_47                -2.927768e-04 3 1  ON 46
ci_48                -4.588337e-04 3 1  ON 47
ci_49                -1.245603e-03 3 1  ON 48
ci_50                -9.635853e-04 3 1  ON 49
ci_51                 9.002141e-04 3 1  ON 50
ci_52                 8.124797e-04 3 1  ON 51
ci_53                -1.153440e-03 3 1  ON 52
ci_54                -1.013928e-03 3 1  ON 53
ci_55                -7.212286e-04 3 1  ON 54
ci_56                 1.602158e-03 3 1  ON 55
ci_57                 1.666848e-03 3 1  ON 56
ci_58                -9.908892e-04 3 1  ON 57
ci_59                -9.340144e-04 3 1  ON 58
ci_60                 8.473730e-04 3 1  ON 59
ci_61                 8.445862e-04 3 1  ON 60
ci_62                -5.748580e-04 3 1  ON 61
ci_63                -8.253999e-04 3 1  ON 62
ci_64                -6.791224e-04 3 1  ON 63
ci_65                -5.962330e-04 3 1  ON 64
ci_66                -8.575324e-04 3 1  ON 65
ci_67                -7.112412e-04 3 1  ON 66
ci_68                -1.469290e-04 3 1  ON 67
ci_69                -9.243405e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8679
    reference variance = 0.473719
====================================================
  Execution time = 2.5148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9785e-01
  Total weights = 1.9633e+06
  Execution time = 3.5929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479040298215
                                         uncertainty =       0.002487187830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479040298215
                                         uncertainty =       0.002487187830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489409410
  error estimate for blocks of size 2^( 2) =       0.000510116774
  error estimate for blocks of size 2^( 3) =       0.000530416942
  error estimate for blocks of size 2^( 4) =       0.000544704482
  error estimate for blocks of size 2^( 5) =       0.000553779345
  error estimate for blocks of size 2^( 6) =       0.000560102562
  error estimate for blocks of size 2^( 7) =       0.000562789220

      target function =      -0.707199797196
              le_mean =     -22.817271312610
             les_mean =     521.127637203165
             stat err =       0.000555343902
             autocorr =       1.287595306310
   target nu stat err =       0.000555343902
   target dn stat err =       0.004720804061
      target stat err =       0.003343135081
              std dev =       0.692129425143
             le_variance =       0.479043141149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478312447505
                                         uncertainty =       0.002472828401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478312447505
                                         uncertainty =       0.002472828401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489033204
  error estimate for blocks of size 2^( 2) =       0.000509749310
  error estimate for blocks of size 2^( 3) =       0.000530054900
  error estimate for blocks of size 2^( 4) =       0.000544349258
  error estimate for blocks of size 2^( 5) =       0.000553420094
  error estimate for blocks of size 2^( 6) =       0.000559734653
  error estimate for blocks of size 2^( 7) =       0.000562437393

      target function =      -0.632727419006
              le_mean =     -22.817278315220
             les_mean =     521.236668915511
             stat err =       0.000554985349
             autocorr =       1.287912452257
   target nu stat err =       0.000554985349
   target dn stat err =       0.108360632266
      target stat err =       0.061161240912
              std dev =       0.691597389646
             le_variance =       0.478306949365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478630823246
                                         uncertainty =       0.002480930043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478630823246
                                         uncertainty =       0.002480930043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489197798
  error estimate for blocks of size 2^( 2) =       0.000509908196
  error estimate for blocks of size 2^( 3) =       0.000530212894
  error estimate for blocks of size 2^( 4) =       0.000544503205
  error estimate for blocks of size 2^( 5) =       0.000553581677
  error estimate for blocks of size 2^( 6) =       0.000559890766
  error estimate for blocks of size 2^( 7) =       0.000562584099

      target function =      -0.707037175692
              le_mean =     -22.817271595236
             les_mean =     521.127880201865
             stat err =       0.000555139937
             autocorr =       1.287763037966
   target nu stat err =       0.000555139937
   target dn stat err =       0.005011990888
      target stat err =       0.003542319725
              std dev =       0.691830160818
             le_variance =       0.478628971418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478986978847
                                         uncertainty =       0.002486368849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478986978847
                                         uncertainty =       0.002486368849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489381847
  error estimate for blocks of size 2^( 2) =       0.000510089501
  error estimate for blocks of size 2^( 3) =       0.000530390258
  error estimate for blocks of size 2^( 4) =       0.000544678280
  error estimate for blocks of size 2^( 5) =       0.000553753870
  error estimate for blocks of size 2^( 6) =       0.000560075583
  error estimate for blocks of size 2^( 7) =       0.000562762753

      target function =      -0.708295217672
              le_mean =     -22.817270991647
             les_mean =     521.126063161834
             stat err =       0.000555317621
             autocorr =       1.287618473090
   target nu stat err =       0.000555317621
   target dn stat err =       0.003984992821
      target stat err =       0.002845947347
              std dev =       0.692090444706
             le_variance =       0.478989183653


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707199797196        initial
     9.7656e-01     9.7656e+00             8.3032e-04        -0.632727419006
     3.9062e+00     3.9062e+01             2.1177e-04        -0.707037175692
     1.5625e+01     1.5625e+02             5.3211e-05        -0.708295217672  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 4.3157e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_01                 1.441273e-01 3 1  ON 0
ci_02                -4.068229e-02 3 1  ON 1
ci_03                -4.035448e-02 3 1  ON 2
ci_04                 3.719620e-02 3 1  ON 3
ci_05                -2.922704e-02 3 1  ON 4
ci_06                -2.849486e-02 3 1  ON 5
ci_07                 2.834127e-02 3 1  ON 6
ci_08                -1.063349e-02 3 1  ON 7
ci_09                -1.258384e-02 3 1  ON 8
ci_10                -1.235223e-02 3 1  ON 9
ci_11                 1.410498e-02 3 1  ON 10
ci_12                 9.577734e-03 3 1  ON 11
ci_13                 1.259544e-02 3 1  ON 12
ci_14                 1.227020e-02 3 1  ON 13
ci_15                 9.140437e-03 3 1  ON 14
ci_16                 9.036216e-03 3 1  ON 15
ci_17                -9.294562e-03 3 1  ON 16
ci_18                -8.749570e-03 3 1  ON 17
ci_19                 1.009710e-02 3 1  ON 18
ci_20                 8.152930e-03 3 1  ON 19
ci_21                 9.105132e-03 3 1  ON 20
ci_22                 9.287758e-03 3 1  ON 21
ci_23                 5.505777e-03 3 1  ON 22
ci_24                 4.944538e-03 3 1  ON 23
ci_25                 3.735427e-03 3 1  ON 24
ci_26                 3.858601e-03 3 1  ON 25
ci_27                 3.869305e-03 3 1  ON 26
ci_28                 2.891195e-03 3 1  ON 27
ci_29                 2.866710e-03 3 1  ON 28
ci_30                -2.331873e-03 3 1  ON 29
ci_31                -2.570664e-03 3 1  ON 30
ci_32                -1.846861e-03 3 1  ON 31
ci_33                -1.833974e-03 3 1  ON 32
ci_34                 1.679023e-03 3 1  ON 33
ci_35                 1.756074e-03 3 1  ON 34
ci_36                -1.576105e-03 3 1  ON 35
ci_37                -1.683703e-03 3 1  ON 36
ci_38                -1.117664e-03 3 1  ON 37
ci_39                -1.249033e-03 3 1  ON 38
ci_40                -1.741137e-03 3 1  ON 39
ci_41                -1.373335e-03 3 1  ON 40
ci_42                -1.153295e-03 3 1  ON 41
ci_43                -2.453963e-03 3 1  ON 42
ci_44                -1.741930e-03 3 1  ON 43
ci_45                -1.082410e-03 3 1  ON 44
ci_46                -9.155157e-04 3 1  ON 45
ci_47                -3.159893e-04 3 1  ON 46
ci_48                -4.713221e-04 3 1  ON 47
ci_49                -1.253880e-03 3 1  ON 48
ci_50                -9.713544e-04 3 1  ON 49
ci_51                 9.131312e-04 3 1  ON 50
ci_52                 8.269111e-04 3 1  ON 51
ci_53                -1.161855e-03 3 1  ON 52
ci_54                -1.014147e-03 3 1  ON 53
ci_55                -7.222931e-04 3 1  ON 54
ci_56                 1.597968e-03 3 1  ON 55
ci_57                 1.667582e-03 3 1  ON 56
ci_58                -9.941035e-04 3 1  ON 57
ci_59                -9.299453e-04 3 1  ON 58
ci_60                 8.663713e-04 3 1  ON 59
ci_61                 8.642117e-04 3 1  ON 60
ci_62                -5.853815e-04 3 1  ON 61
ci_63                -8.265645e-04 3 1  ON 62
ci_64                -6.937383e-04 3 1  ON 63
ci_65                -5.874334e-04 3 1  ON 64
ci_66                -8.610855e-04 3 1  ON 65
ci_67                -7.141354e-04 3 1  ON 66
ci_68                -1.348186e-04 3 1  ON 67
ci_69                -7.123260e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3484e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.9596
    reference variance = 0.711476
====================================================
  Execution time = 2.7470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5366e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9726e-01
  Total weights = 1.963385319e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478312964840
                                         uncertainty =       0.002557823959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478312964840
                                         uncertainty =       0.002557823959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489007186
  error estimate for blocks of size 2^( 2) =       0.000509514188
  error estimate for blocks of size 2^( 3) =       0.000529665505
  error estimate for blocks of size 2^( 4) =       0.000544183903
  error estimate for blocks of size 2^( 5) =       0.000554141566
  error estimate for blocks of size 2^( 6) =       0.000559415615
  error estimate for blocks of size 2^( 7) =       0.000562136658

      target function =      -0.708952187358
              le_mean =     -22.817234760149
             les_mean =     521.123466331717
             stat err =       0.000554969435
             autocorr =       1.287975640106
   target nu stat err =       0.000554969435
   target dn stat err =       0.004680853142
      target stat err =       0.003331602537
              std dev =       0.691560593929
             le_variance =       0.478256055076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281723476015e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708967091778       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.709021532456       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.709030909876       residual = 5.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.709032255708       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.709032835686       residual = 8.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.709033059824       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.709033104102       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709033109812       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.709033108119       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.709033109815       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.197462e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708967091778       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708980823094       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708983180685       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708983517819       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708983662534       residual = 8.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708983718001       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708983728883       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708983730282       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708983729863       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708983730284       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.520795e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708967091778       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708970532262       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708971122492       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708971206817       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708971242978       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708971256808       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708971259517       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708971259865       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708971259760       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708971259866       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 1.381906e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.625618 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2077e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_01                 1.440721e-01 3 1  ON 0
ci_02                -4.063766e-02 3 1  ON 1
ci_03                -4.031648e-02 3 1  ON 2
ci_04                 3.714757e-02 3 1  ON 3
ci_05                -2.919500e-02 3 1  ON 4
ci_06                -2.845746e-02 3 1  ON 5
ci_07                 2.833408e-02 3 1  ON 6
ci_08                -1.061086e-02 3 1  ON 7
ci_09                -1.256896e-02 3 1  ON 8
ci_10                -1.233625e-02 3 1  ON 9
ci_11                 1.409924e-02 3 1  ON 10
ci_12                 9.568062e-03 3 1  ON 11
ci_13                 1.259607e-02 3 1  ON 12
ci_14                 1.226992e-02 3 1  ON 13
ci_15                 9.127292e-03 3 1  ON 14
ci_16                 9.032871e-03 3 1  ON 15
ci_17                -9.290003e-03 3 1  ON 16
ci_18                -8.742944e-03 3 1  ON 17
ci_19                 1.009348e-02 3 1  ON 18
ci_20                 8.149590e-03 3 1  ON 19
ci_21                 9.101632e-03 3 1  ON 20
ci_22                 9.285081e-03 3 1  ON 21
ci_23                 5.501596e-03 3 1  ON 22
ci_24                 4.952409e-03 3 1  ON 23
ci_25                 3.734621e-03 3 1  ON 24
ci_26                 3.857189e-03 3 1  ON 25
ci_27                 3.865882e-03 3 1  ON 26
ci_28                 2.889292e-03 3 1  ON 27
ci_29                 2.859867e-03 3 1  ON 28
ci_30                -2.326654e-03 3 1  ON 29
ci_31                -2.565155e-03 3 1  ON 30
ci_32                -1.844024e-03 3 1  ON 31
ci_33                -1.830406e-03 3 1  ON 32
ci_34                 1.674315e-03 3 1  ON 33
ci_35                 1.752632e-03 3 1  ON 34
ci_36                -1.575504e-03 3 1  ON 35
ci_37                -1.679606e-03 3 1  ON 36
ci_38                -1.117350e-03 3 1  ON 37
ci_39                -1.246745e-03 3 1  ON 38
ci_40                -1.740752e-03 3 1  ON 39
ci_41                -1.371094e-03 3 1  ON 40
ci_42                -1.155260e-03 3 1  ON 41
ci_43                -2.457595e-03 3 1  ON 42
ci_44                -1.731220e-03 3 1  ON 43
ci_45                -1.082773e-03 3 1  ON 44
ci_46                -9.118013e-04 3 1  ON 45
ci_47                -3.113299e-04 3 1  ON 46
ci_48                -4.662013e-04 3 1  ON 47
ci_49                -1.252559e-03 3 1  ON 48
ci_50                -9.725299e-04 3 1  ON 49
ci_51                 9.087201e-04 3 1  ON 50
ci_52                 8.246960e-04 3 1  ON 51
ci_53                -1.160557e-03 3 1  ON 52
ci_54                -1.012371e-03 3 1  ON 53
ci_55                -7.241928e-04 3 1  ON 54
ci_56                 1.596466e-03 3 1  ON 55
ci_57                 1.670511e-03 3 1  ON 56
ci_58                -9.905880e-04 3 1  ON 57
ci_59                -9.292364e-04 3 1  ON 58
ci_60                 8.645757e-04 3 1  ON 59
ci_61                 8.629642e-04 3 1  ON 60
ci_62                -5.828854e-04 3 1  ON 61
ci_63                -8.237309e-04 3 1  ON 62
ci_64                -6.971380e-04 3 1  ON 63
ci_65                -5.857007e-04 3 1  ON 64
ci_66                -8.584738e-04 3 1  ON 65
ci_67                -7.137740e-04 3 1  ON 66
ci_68                -1.367709e-04 3 1  ON 67
ci_69                -7.091142e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8293
    reference variance = 0.337403
====================================================
  Execution time = 2.5182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9371e-01
  Total weights = 1.9633e+06
  Execution time = 3.5815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478073750169
                                         uncertainty =       0.003077186452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478073750169
                                         uncertainty =       0.003077186452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488907448
  error estimate for blocks of size 2^( 2) =       0.000509879980
  error estimate for blocks of size 2^( 3) =       0.000530035624
  error estimate for blocks of size 2^( 4) =       0.000544229307
  error estimate for blocks of size 2^( 5) =       0.000553660840
  error estimate for blocks of size 2^( 6) =       0.000559152158
  error estimate for blocks of size 2^( 7) =       0.000562107014

      target function =      -0.711435354383
              le_mean =     -22.818151696835
             les_mean =     521.161812897016
             stat err =       0.000554787330
             autocorr =       1.287655719713
   target nu stat err =       0.000554787330
   target dn stat err =       0.004276593982
      target stat err =       0.003077026176
              std dev =       0.691419543821
             le_variance =       0.478060985578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477907622166
                                         uncertainty =       0.003093143618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477907622166
                                         uncertainty =       0.003093143618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488822442
  error estimate for blocks of size 2^( 2) =       0.000509793956
  error estimate for blocks of size 2^( 3) =       0.000529950715
  error estimate for blocks of size 2^( 4) =       0.000544147939
  error estimate for blocks of size 2^( 5) =       0.000553585152
  error estimate for blocks of size 2^( 6) =       0.000559079221
  error estimate for blocks of size 2^( 7) =       0.000562037422

      target function =      -0.711509673194
              le_mean =     -22.818150377539
             les_mean =     521.161647422271
             stat err =       0.000554712434
             autocorr =       1.287755841836
   target nu stat err =       0.000554712434
   target dn stat err =       0.004305193575
      target stat err =       0.003097562213
              std dev =       0.691299326804
             le_variance =       0.477894759239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477989119528
                                         uncertainty =       0.003085105854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477989119528
                                         uncertainty =       0.003085105854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488864146
  error estimate for blocks of size 2^( 2) =       0.000509836155
  error estimate for blocks of size 2^( 3) =       0.000529992352
  error estimate for blocks of size 2^( 4) =       0.000544187829
  error estimate for blocks of size 2^( 5) =       0.000553622244
  error estimate for blocks of size 2^( 6) =       0.000559114931
  error estimate for blocks of size 2^( 7) =       0.000562071498

      target function =      -0.711220621366
              le_mean =     -22.818150963896
             les_mean =     521.162082615954
             stat err =       0.000554749126
             autocorr =       1.287706474942
   target nu stat err =       0.000554749126
   target dn stat err =       0.004309471852
      target stat err =       0.003098073047
              std dev =       0.691358305500
             le_variance =       0.477976306584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478063052353
                                         uncertainty =       0.003078166643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478063052353
                                         uncertainty =       0.003078166643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488901975
  error estimate for blocks of size 2^( 2) =       0.000509874439
  error estimate for blocks of size 2^( 3) =       0.000530030149
  error estimate for blocks of size 2^( 4) =       0.000544224057
  error estimate for blocks of size 2^( 5) =       0.000553655951
  error estimate for blocks of size 2^( 6) =       0.000559147437
  error estimate for blocks of size 2^( 7) =       0.000562102511

      target function =      -0.711448955215
              le_mean =     -22.818151590807
             les_mean =     521.161788827940
             stat err =       0.000554782489
             autocorr =       1.287662080310
   target nu stat err =       0.000554782489
   target dn stat err =       0.004278064450
      target stat err =       0.003078164662
              std dev =       0.691411803358
             le_variance =       0.478050281823


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.711435354383        initial
     3.9062e+00     3.9062e+01             2.1975e-04        -0.711509673194  <--
     1.5625e+01     1.5625e+02             5.5208e-05        -0.711220621366
     6.2500e+01     6.2500e+02             1.3819e-05        -0.711448955215

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.3145e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_01                 1.439076e-01 3 1  ON 0
ci_02                -4.050521e-02 3 1  ON 1
ci_03                -4.020370e-02 3 1  ON 2
ci_04                 3.700345e-02 3 1  ON 3
ci_05                -2.909998e-02 3 1  ON 4
ci_06                -2.834650e-02 3 1  ON 5
ci_07                 2.831271e-02 3 1  ON 6
ci_08                -1.054376e-02 3 1  ON 7
ci_09                -1.252474e-02 3 1  ON 8
ci_10                -1.228875e-02 3 1  ON 9
ci_11                 1.408220e-02 3 1  ON 10
ci_12                 9.539389e-03 3 1  ON 11
ci_13                 1.259794e-02 3 1  ON 12
ci_14                 1.226910e-02 3 1  ON 13
ci_15                 9.088266e-03 3 1  ON 14
ci_16                 9.022944e-03 3 1  ON 15
ci_17                -9.276429e-03 3 1  ON 16
ci_18                -8.723245e-03 3 1  ON 17
ci_19                 1.008277e-02 3 1  ON 18
ci_20                 8.139702e-03 3 1  ON 19
ci_21                 9.091216e-03 3 1  ON 20
ci_22                 9.277107e-03 3 1  ON 21
ci_23                 5.489212e-03 3 1  ON 22
ci_24                 4.975797e-03 3 1  ON 23
ci_25                 3.732240e-03 3 1  ON 24
ci_26                 3.853011e-03 3 1  ON 25
ci_27                 3.855745e-03 3 1  ON 26
ci_28                 2.883619e-03 3 1  ON 27
ci_29                 2.839532e-03 3 1  ON 28
ci_30                -2.311105e-03 3 1  ON 29
ci_31                -2.548731e-03 3 1  ON 30
ci_32                -1.835650e-03 3 1  ON 31
ci_33                -1.819861e-03 3 1  ON 32
ci_34                 1.660371e-03 3 1  ON 33
ci_35                 1.742458e-03 3 1  ON 34
ci_36                -1.573718e-03 3 1  ON 35
ci_37                -1.667459e-03 3 1  ON 36
ci_38                -1.116408e-03 3 1  ON 37
ci_39                -1.239963e-03 3 1  ON 38
ci_40                -1.739607e-03 3 1  ON 39
ci_41                -1.364481e-03 3 1  ON 40
ci_42                -1.161117e-03 3 1  ON 41
ci_43                -2.468347e-03 3 1  ON 42
ci_44                -1.699385e-03 3 1  ON 43
ci_45                -1.083830e-03 3 1  ON 44
ci_46                -9.007970e-04 3 1  ON 45
ci_47                -2.974493e-04 3 1  ON 46
ci_48                -4.509694e-04 3 1  ON 47
ci_49                -1.248641e-03 3 1  ON 48
ci_50                -9.760010e-04 3 1  ON 49
ci_51                 8.956511e-04 3 1  ON 50
ci_52                 8.181335e-04 3 1  ON 51
ci_53                -1.156700e-03 3 1  ON 52
ci_54                -1.007093e-03 3 1  ON 53
ci_55                -7.298355e-04 3 1  ON 54
ci_56                 1.592024e-03 3 1  ON 55
ci_57                 1.679196e-03 3 1  ON 56
ci_58                -9.801662e-04 3 1  ON 57
ci_59                -9.271422e-04 3 1  ON 58
ci_60                 8.591913e-04 3 1  ON 59
ci_61                 8.592199e-04 3 1  ON 60
ci_62                -5.754811e-04 3 1  ON 61
ci_63                -8.153341e-04 3 1  ON 62
ci_64                -7.072013e-04 3 1  ON 63
ci_65                -5.805562e-04 3 1  ON 64
ci_66                -8.507270e-04 3 1  ON 65
ci_67                -7.127015e-04 3 1  ON 66
ci_68                -1.425812e-04 3 1  ON 67
ci_69                -6.995674e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5228e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8997
    reference variance = 0.41262
====================================================
  Execution time = 2.5887e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5321e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9851e-01
  Total weights = 1.963103430e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479917175233
                                         uncertainty =       0.002367040467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479917175233
                                         uncertainty =       0.002367040467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489864064
  error estimate for blocks of size 2^( 2) =       0.000510972354
  error estimate for blocks of size 2^( 3) =       0.000531675444
  error estimate for blocks of size 2^( 4) =       0.000546145889
  error estimate for blocks of size 2^( 5) =       0.000555121254
  error estimate for blocks of size 2^( 6) =       0.000564107534
  error estimate for blocks of size 2^( 7) =       0.000568251932

      target function =      -0.708091196895
              le_mean =     -22.817695465231
             les_mean =     521.145734167872
             stat err =       0.000558406652
             autocorr =       1.299421367163
   target nu stat err =       0.000558406652
   target dn stat err =       0.003890482352
      target stat err =       0.002781677640
              std dev =       0.692772403398
             le_variance =       0.479933602910


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281769546523e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708101363982       residual = 2.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708331453894       residual = 3.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708367024694       residual = 4.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708371033171       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708372064887       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708372646130       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708372708042       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708372665025       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708372657171       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708372654366       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708372652735       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 7.992809e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708101363982       residual = 2.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708160921937       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708170018385       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708171025758       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708171281317       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708171422028       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708171435279       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708171424696       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708171422826       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708171422147       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708171421766       residual = 1.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.070858e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708101363982       residual = 2.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708116386305       residual = 3.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708118673423       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708118925552       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708118989273       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708119024147       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708119027319       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708119024685       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708119024224       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708119024055       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.708119023962       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.224612e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.629718 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0500e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_01                 1.437265e-01 3 1  ON 0
ci_02                -4.032245e-02 3 1  ON 1
ci_03                -4.003169e-02 3 1  ON 2
ci_04                 3.679636e-02 3 1  ON 3
ci_05                -2.896687e-02 3 1  ON 4
ci_06                -2.821061e-02 3 1  ON 5
ci_07                 2.830074e-02 3 1  ON 6
ci_08                -1.046487e-02 3 1  ON 7
ci_09                -1.247537e-02 3 1  ON 8
ci_10                -1.224144e-02 3 1  ON 9
ci_11                 1.406581e-02 3 1  ON 10
ci_12                 9.502316e-03 3 1  ON 11
ci_13                 1.257928e-02 3 1  ON 12
ci_14                 1.225858e-02 3 1  ON 13
ci_15                 9.055984e-03 3 1  ON 14
ci_16                 8.995044e-03 3 1  ON 15
ci_17                -9.224142e-03 3 1  ON 16
ci_18                -8.689080e-03 3 1  ON 17
ci_19                 1.008164e-02 3 1  ON 18
ci_20                 8.115262e-03 3 1  ON 19
ci_21                 9.067401e-03 3 1  ON 20
ci_22                 9.254947e-03 3 1  ON 21
ci_23                 5.476026e-03 3 1  ON 22
ci_24                 4.949642e-03 3 1  ON 23
ci_25                 3.720779e-03 3 1  ON 24
ci_26                 3.837476e-03 3 1  ON 25
ci_27                 3.855428e-03 3 1  ON 26
ci_28                 2.872772e-03 3 1  ON 27
ci_29                 2.821622e-03 3 1  ON 28
ci_30                -2.299309e-03 3 1  ON 29
ci_31                -2.538379e-03 3 1  ON 30
ci_32                -1.823173e-03 3 1  ON 31
ci_33                -1.801416e-03 3 1  ON 32
ci_34                 1.650069e-03 3 1  ON 33
ci_35                 1.703812e-03 3 1  ON 34
ci_36                -1.577749e-03 3 1  ON 35
ci_37                -1.648552e-03 3 1  ON 36
ci_38                -1.105713e-03 3 1  ON 37
ci_39                -1.225648e-03 3 1  ON 38
ci_40                -1.730337e-03 3 1  ON 39
ci_41                -1.361687e-03 3 1  ON 40
ci_42                -1.152711e-03 3 1  ON 41
ci_43                -2.470961e-03 3 1  ON 42
ci_44                -1.705289e-03 3 1  ON 43
ci_45                -1.073429e-03 3 1  ON 44
ci_46                -8.936684e-04 3 1  ON 45
ci_47                -2.853716e-04 3 1  ON 46
ci_48                -4.366233e-04 3 1  ON 47
ci_49                -1.240025e-03 3 1  ON 48
ci_50                -9.770969e-04 3 1  ON 49
ci_51                 8.833273e-04 3 1  ON 50
ci_52                 8.107413e-04 3 1  ON 51
ci_53                -1.147458e-03 3 1  ON 52
ci_54                -9.873414e-04 3 1  ON 53
ci_55                -7.385997e-04 3 1  ON 54
ci_56                 1.594021e-03 3 1  ON 55
ci_57                 1.683112e-03 3 1  ON 56
ci_58                -9.860858e-04 3 1  ON 57
ci_59                -9.391381e-04 3 1  ON 58
ci_60                 8.491786e-04 3 1  ON 59
ci_61                 8.635533e-04 3 1  ON 60
ci_62                -5.701598e-04 3 1  ON 61
ci_63                -8.156148e-04 3 1  ON 62
ci_64                -6.927059e-04 3 1  ON 63
ci_65                -5.851893e-04 3 1  ON 64
ci_66                -8.416234e-04 3 1  ON 65
ci_67                -7.040414e-04 3 1  ON 66
ci_68                -1.702936e-04 3 1  ON 67
ci_69                -7.570227e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.7744
    reference variance = 0.384302
====================================================
  Execution time = 2.5084e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.8766e-01
  Total weights = 1.9635e+06
  Execution time = 3.5810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474425782784
                                         uncertainty =       0.002082547298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474425782784
                                         uncertainty =       0.002082547298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487044853
  error estimate for blocks of size 2^( 2) =       0.000507521343
  error estimate for blocks of size 2^( 3) =       0.000527047601
  error estimate for blocks of size 2^( 4) =       0.000542373682
  error estimate for blocks of size 2^( 5) =       0.000552302877
  error estimate for blocks of size 2^( 6) =       0.000558272934
  error estimate for blocks of size 2^( 7) =       0.000561048212

      target function =      -0.715475480894
              le_mean =     -22.816613239100
             les_mean =     521.085888566822
             stat err =       0.000553499426
             autocorr =       1.291506016728
   target nu stat err =       0.000553499426
   target dn stat err =       0.002755079515
      target stat err =       0.002044207345
              std dev =       0.688785436627
             le_variance =       0.474425377709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473708060687
                                         uncertainty =       0.002081646848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473708060687
                                         uncertainty =       0.002081646848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486676526
  error estimate for blocks of size 2^( 2) =       0.000507157417
  error estimate for blocks of size 2^( 3) =       0.000526694646
  error estimate for blocks of size 2^( 4) =       0.000542034428
  error estimate for blocks of size 2^( 5) =       0.000551969389
  error estimate for blocks of size 2^( 6) =       0.000557945610
  error estimate for blocks of size 2^( 7) =       0.000560736273

      target function =      -0.715885796288
              le_mean =     -22.816611422138
             les_mean =     521.085231565262
             stat err =       0.000553171425
             autocorr =       1.291929089629
   target nu stat err =       0.000553171425
   target dn stat err =       0.002747039091
      target stat err =       0.002040837163
              std dev =       0.688264543586
             le_variance =       0.473708081958

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474046966979
                                         uncertainty =       0.002081919065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474046966979
                                         uncertainty =       0.002081919065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486850483
  error estimate for blocks of size 2^( 2) =       0.000507329099
  error estimate for blocks of size 2^( 3) =       0.000526860969
  error estimate for blocks of size 2^( 4) =       0.000542194083
  error estimate for blocks of size 2^( 5) =       0.000552126373
  error estimate for blocks of size 2^( 6) =       0.000558100213
  error estimate for blocks of size 2^( 7) =       0.000560884123

      target function =      -0.715910161879
              le_mean =     -22.816611013530
             les_mean =     521.085178879897
             stat err =       0.000553326198
             autocorr =       1.291728540766
   target nu stat err =       0.000553326198
   target dn stat err =       0.002738883331
      target stat err =       0.002035397114
              std dev =       0.688510555733
             le_variance =       0.474046785355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474377570316
                                         uncertainty =       0.002082439608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474377570316
                                         uncertainty =       0.002082439608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487020119
  error estimate for blocks of size 2^( 2) =       0.000507497232
  error estimate for blocks of size 2^( 3) =       0.000527024411
  error estimate for blocks of size 2^( 4) =       0.000542351200
  error estimate for blocks of size 2^( 5) =       0.000552281137
  error estimate for blocks of size 2^( 6) =       0.000558251971
  error estimate for blocks of size 2^( 7) =       0.000561027272

      target function =      -0.704984120907
              le_mean =     -22.816613341355
             les_mean =     521.100583283149
             stat err =       0.000553477895
             autocorr =       1.291536712322
   target nu stat err =       0.000553477895
   target dn stat err =       0.015048738953
      target stat err =       0.010453521116
              std dev =       0.688750457660
             le_variance =       0.474377192927


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.715475480894        initial
     9.7656e-01     9.7656e+00             7.9928e-04        -0.715885796288
     3.9062e+00     3.9062e+01             2.0709e-04        -0.715910161879  <--
     1.5625e+01     1.5625e+02             5.2246e-05        -0.704984120907

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.3039e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_01                 1.437265e-01 3 1  ON 0
ci_02                -4.032245e-02 3 1  ON 1
ci_03                -4.003169e-02 3 1  ON 2
ci_04                 3.679636e-02 3 1  ON 3
ci_05                -2.896687e-02 3 1  ON 4
ci_06                -2.821061e-02 3 1  ON 5
ci_07                 2.830074e-02 3 1  ON 6
ci_08                -1.046487e-02 3 1  ON 7
ci_09                -1.247537e-02 3 1  ON 8
ci_10                -1.224144e-02 3 1  ON 9
ci_11                 1.406581e-02 3 1  ON 10
ci_12                 9.502316e-03 3 1  ON 11
ci_13                 1.257928e-02 3 1  ON 12
ci_14                 1.225858e-02 3 1  ON 13
ci_15                 9.055984e-03 3 1  ON 14
ci_16                 8.995044e-03 3 1  ON 15
ci_17                -9.224142e-03 3 1  ON 16
ci_18                -8.689080e-03 3 1  ON 17
ci_19                 1.008164e-02 3 1  ON 18
ci_20                 8.115262e-03 3 1  ON 19
ci_21                 9.067401e-03 3 1  ON 20
ci_22                 9.254947e-03 3 1  ON 21
ci_23                 5.476026e-03 3 1  ON 22
ci_24                 4.949642e-03 3 1  ON 23
ci_25                 3.720779e-03 3 1  ON 24
ci_26                 3.837476e-03 3 1  ON 25
ci_27                 3.855428e-03 3 1  ON 26
ci_28                 2.872772e-03 3 1  ON 27
ci_29                 2.821622e-03 3 1  ON 28
ci_30                -2.299309e-03 3 1  ON 29
ci_31                -2.538379e-03 3 1  ON 30
ci_32                -1.823173e-03 3 1  ON 31
ci_33                -1.801416e-03 3 1  ON 32
ci_34                 1.650069e-03 3 1  ON 33
ci_35                 1.703812e-03 3 1  ON 34
ci_36                -1.577749e-03 3 1  ON 35
ci_37                -1.648552e-03 3 1  ON 36
ci_38                -1.105713e-03 3 1  ON 37
ci_39                -1.225648e-03 3 1  ON 38
ci_40                -1.730337e-03 3 1  ON 39
ci_41                -1.361687e-03 3 1  ON 40
ci_42                -1.152711e-03 3 1  ON 41
ci_43                -2.470961e-03 3 1  ON 42
ci_44                -1.705289e-03 3 1  ON 43
ci_45                -1.073429e-03 3 1  ON 44
ci_46                -8.936684e-04 3 1  ON 45
ci_47                -2.853716e-04 3 1  ON 46
ci_48                -4.366233e-04 3 1  ON 47
ci_49                -1.240025e-03 3 1  ON 48
ci_50                -9.770969e-04 3 1  ON 49
ci_51                 8.833273e-04 3 1  ON 50
ci_52                 8.107413e-04 3 1  ON 51
ci_53                -1.147458e-03 3 1  ON 52
ci_54                -9.873414e-04 3 1  ON 53
ci_55                -7.385997e-04 3 1  ON 54
ci_56                 1.594021e-03 3 1  ON 55
ci_57                 1.683112e-03 3 1  ON 56
ci_58                -9.860858e-04 3 1  ON 57
ci_59                -9.391381e-04 3 1  ON 58
ci_60                 8.491786e-04 3 1  ON 59
ci_61                 8.635533e-04 3 1  ON 60
ci_62                -5.701598e-04 3 1  ON 61
ci_63                -8.156148e-04 3 1  ON 62
ci_64                -6.927059e-04 3 1  ON 63
ci_65                -5.851893e-04 3 1  ON 64
ci_66                -8.416234e-04 3 1  ON 65
ci_67                -7.040414e-04 3 1  ON 66
ci_68                -1.702936e-04 3 1  ON 67
ci_69                -7.570227e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3545e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8823
    reference variance = 0.325396
====================================================
  Execution time = 2.5666e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9550e-01
  Total weights = 1.963042463e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476285660595
                                         uncertainty =       0.002393668888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476285660595
                                         uncertainty =       0.002393668888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488025157
  error estimate for blocks of size 2^( 2) =       0.000508920286
  error estimate for blocks of size 2^( 3) =       0.000528086593
  error estimate for blocks of size 2^( 4) =       0.000544327572
  error estimate for blocks of size 2^( 5) =       0.000552908578
  error estimate for blocks of size 2^( 6) =       0.000557846761
  error estimate for blocks of size 2^( 7) =       0.000560916041

      target function =      -0.710203733584
              le_mean =     -22.817507351095
             les_mean =     521.134139274411
             stat err =       0.000553999738
             autocorr =       1.288649169510
   target nu stat err =       0.000553999738
   target dn stat err =       0.003935110530
      target stat err =       0.002827218889
              std dev =       0.690171796283
             le_variance =       0.476337108384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281750735109e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710214047478       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710417228498       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710451382035       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710456730342       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710457988085       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710458761500       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710459050392       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710459027494       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710459021999       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710459020051       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710459022308       residual = 9.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 7.850736e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710214047478       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710266633576       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710275364067       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710276711579       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710277021147       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710277207993       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710277277254       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710277271358       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710277270031       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710277269588       residual = 8.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.001373e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710214047478       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710227310859       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710229505739       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710229843226       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710229920282       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710229966567       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710229983692       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710229982208       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710229981880       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710229981772       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.028364e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.633425 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0253e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_01                 1.435264e-01 3 1  ON 0
ci_02                -4.015203e-02 3 1  ON 1
ci_03                -3.985289e-02 3 1  ON 2
ci_04                 3.661303e-02 3 1  ON 3
ci_05                -2.885912e-02 3 1  ON 4
ci_06                -2.808376e-02 3 1  ON 5
ci_07                 2.827257e-02 3 1  ON 6
ci_08                -1.037917e-02 3 1  ON 7
ci_09                -1.241894e-02 3 1  ON 8
ci_10                -1.216835e-02 3 1  ON 9
ci_11                 1.405583e-02 3 1  ON 10
ci_12                 9.467131e-03 3 1  ON 11
ci_13                 1.259525e-02 3 1  ON 12
ci_14                 1.225941e-02 3 1  ON 13
ci_15                 9.007240e-03 3 1  ON 14
ci_16                 8.968457e-03 3 1  ON 15
ci_17                -9.176736e-03 3 1  ON 16
ci_18                -8.657695e-03 3 1  ON 17
ci_19                 1.006532e-02 3 1  ON 18
ci_20                 8.100208e-03 3 1  ON 19
ci_21                 9.062999e-03 3 1  ON 20
ci_22                 9.258905e-03 3 1  ON 21
ci_23                 5.464426e-03 3 1  ON 22
ci_24                 4.917937e-03 3 1  ON 23
ci_25                 3.708055e-03 3 1  ON 24
ci_26                 3.829737e-03 3 1  ON 25
ci_27                 3.832790e-03 3 1  ON 26
ci_28                 2.865663e-03 3 1  ON 27
ci_29                 2.795641e-03 3 1  ON 28
ci_30                -2.268937e-03 3 1  ON 29
ci_31                -2.530670e-03 3 1  ON 30
ci_32                -1.805318e-03 3 1  ON 31
ci_33                -1.794530e-03 3 1  ON 32
ci_34                 1.633708e-03 3 1  ON 33
ci_35                 1.682600e-03 3 1  ON 34
ci_36                -1.562649e-03 3 1  ON 35
ci_37                -1.647797e-03 3 1  ON 36
ci_38                -1.104619e-03 3 1  ON 37
ci_39                -1.218352e-03 3 1  ON 38
ci_40                -1.730443e-03 3 1  ON 39
ci_41                -1.350157e-03 3 1  ON 40
ci_42                -1.155548e-03 3 1  ON 41
ci_43                -2.450195e-03 3 1  ON 42
ci_44                -1.704050e-03 3 1  ON 43
ci_45                -1.059649e-03 3 1  ON 44
ci_46                -8.894423e-04 3 1  ON 45
ci_47                -2.810230e-04 3 1  ON 46
ci_48                -4.211786e-04 3 1  ON 47
ci_49                -1.223704e-03 3 1  ON 48
ci_50                -9.808121e-04 3 1  ON 49
ci_51                 8.673097e-04 3 1  ON 50
ci_52                 7.892485e-04 3 1  ON 51
ci_53                -1.145101e-03 3 1  ON 52
ci_54                -9.960234e-04 3 1  ON 53
ci_55                -7.407246e-04 3 1  ON 54
ci_56                 1.597772e-03 3 1  ON 55
ci_57                 1.679918e-03 3 1  ON 56
ci_58                -9.854085e-04 3 1  ON 57
ci_59                -9.484779e-04 3 1  ON 58
ci_60                 8.151512e-04 3 1  ON 59
ci_61                 8.696332e-04 3 1  ON 60
ci_62                -5.784323e-04 3 1  ON 61
ci_63                -8.139248e-04 3 1  ON 62
ci_64                -6.835225e-04 3 1  ON 63
ci_65                -5.786135e-04 3 1  ON 64
ci_66                -8.462801e-04 3 1  ON 65
ci_67                -6.984308e-04 3 1  ON 66
ci_68                -1.930639e-04 3 1  ON 67
ci_69                -1.006150e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8145
    reference variance = 0.859406
====================================================
  Execution time = 2.5217e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9514e-01
  Total weights = 1.9635e+06
  Execution time = 3.5878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478705422986
                                         uncertainty =       0.002593296121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478705422986
                                         uncertainty =       0.002593296121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489209417
  error estimate for blocks of size 2^( 2) =       0.000509790768
  error estimate for blocks of size 2^( 3) =       0.000529092820
  error estimate for blocks of size 2^( 4) =       0.000543890271
  error estimate for blocks of size 2^( 5) =       0.000553906936
  error estimate for blocks of size 2^( 6) =       0.000560966954
  error estimate for blocks of size 2^( 7) =       0.000566125939

      target function =      -0.710309288785
              le_mean =     -22.816799248118
             les_mean =     521.101660596537
             stat err =       0.000556222525
             autocorr =       1.292729111453
   target nu stat err =       0.000556222525
   target dn stat err =       0.003632734930
      target stat err =       0.002617146426
              std dev =       0.691846591750
             le_variance =       0.478651706516

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477956280811
                                         uncertainty =       0.002579601619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477956280811
                                         uncertainty =       0.002579601619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488826421
  error estimate for blocks of size 2^( 2) =       0.000509415355
  error estimate for blocks of size 2^( 3) =       0.000528723749
  error estimate for blocks of size 2^( 4) =       0.000543542445
  error estimate for blocks of size 2^( 5) =       0.000553562945
  error estimate for blocks of size 2^( 6) =       0.000560632237
  error estimate for blocks of size 2^( 7) =       0.000565811315

      target function =      -0.709865022741
              le_mean =     -22.816802292275
             les_mean =     521.102430558031
             stat err =       0.000555887236
             autocorr =       1.293195132322
   target nu stat err =       0.000555887236
   target dn stat err =       0.003670375149
      target stat err =       0.002639774826
              std dev =       0.691304953856
             le_variance =       0.477902539226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478310438012
                                         uncertainty =       0.002585854086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478310438012
                                         uncertainty =       0.002585854086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489007523
  error estimate for blocks of size 2^( 2) =       0.000509592714
  error estimate for blocks of size 2^( 3) =       0.000528897941
  error estimate for blocks of size 2^( 4) =       0.000543706084
  error estimate for blocks of size 2^( 5) =       0.000553724939
  error estimate for blocks of size 2^( 6) =       0.000560789477
  error estimate for blocks of size 2^( 7) =       0.000565959058

      target function =      -0.710469975323
              le_mean =     -22.816799606588
             les_mean =     521.101449010052
             stat err =       0.000556044890
             autocorr =       1.292970532578
   target nu stat err =       0.000556044890
   target dn stat err =       0.003610090132
      target stat err =       0.002602673202
              std dev =       0.691561070575
             le_variance =       0.478256714335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478654678476
                                         uncertainty =       0.002592311821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478654678476
                                         uncertainty =       0.002592311821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489183484
  error estimate for blocks of size 2^( 2) =       0.000509765309
  error estimate for blocks of size 2^( 3) =       0.000529067746
  error estimate for blocks of size 2^( 4) =       0.000543866538
  error estimate for blocks of size 2^( 5) =       0.000553883500
  error estimate for blocks of size 2^( 6) =       0.000560944166
  error estimate for blocks of size 2^( 7) =       0.000566104511

      target function =      -0.710362906775
              le_mean =     -22.816799165383
             les_mean =     521.101580715789
             stat err =       0.000556199679
             autocorr =       1.292759970906
   target nu stat err =       0.000556199679
   target dn stat err =       0.003629043984
      target stat err =       0.002614986289
              std dev =       0.691809917317
             le_variance =       0.478600961698


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.710309288785        initial
     9.7656e-01     9.7656e+00             7.8507e-04        -0.709865022741
     3.9062e+00     3.9062e+01             2.0014e-04        -0.710469975323  <--
     1.5625e+01     1.5625e+02             5.0284e-05        -0.710362906775

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.3215e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_01                 1.435264e-01 3 1  ON 0
ci_02                -4.015203e-02 3 1  ON 1
ci_03                -3.985289e-02 3 1  ON 2
ci_04                 3.661303e-02 3 1  ON 3
ci_05                -2.885912e-02 3 1  ON 4
ci_06                -2.808376e-02 3 1  ON 5
ci_07                 2.827257e-02 3 1  ON 6
ci_08                -1.037917e-02 3 1  ON 7
ci_09                -1.241894e-02 3 1  ON 8
ci_10                -1.216835e-02 3 1  ON 9
ci_11                 1.405583e-02 3 1  ON 10
ci_12                 9.467131e-03 3 1  ON 11
ci_13                 1.259525e-02 3 1  ON 12
ci_14                 1.225941e-02 3 1  ON 13
ci_15                 9.007240e-03 3 1  ON 14
ci_16                 8.968457e-03 3 1  ON 15
ci_17                -9.176736e-03 3 1  ON 16
ci_18                -8.657695e-03 3 1  ON 17
ci_19                 1.006532e-02 3 1  ON 18
ci_20                 8.100208e-03 3 1  ON 19
ci_21                 9.062999e-03 3 1  ON 20
ci_22                 9.258905e-03 3 1  ON 21
ci_23                 5.464426e-03 3 1  ON 22
ci_24                 4.917937e-03 3 1  ON 23
ci_25                 3.708055e-03 3 1  ON 24
ci_26                 3.829737e-03 3 1  ON 25
ci_27                 3.832790e-03 3 1  ON 26
ci_28                 2.865663e-03 3 1  ON 27
ci_29                 2.795641e-03 3 1  ON 28
ci_30                -2.268937e-03 3 1  ON 29
ci_31                -2.530670e-03 3 1  ON 30
ci_32                -1.805318e-03 3 1  ON 31
ci_33                -1.794530e-03 3 1  ON 32
ci_34                 1.633708e-03 3 1  ON 33
ci_35                 1.682600e-03 3 1  ON 34
ci_36                -1.562649e-03 3 1  ON 35
ci_37                -1.647797e-03 3 1  ON 36
ci_38                -1.104619e-03 3 1  ON 37
ci_39                -1.218352e-03 3 1  ON 38
ci_40                -1.730443e-03 3 1  ON 39
ci_41                -1.350157e-03 3 1  ON 40
ci_42                -1.155548e-03 3 1  ON 41
ci_43                -2.450195e-03 3 1  ON 42
ci_44                -1.704050e-03 3 1  ON 43
ci_45                -1.059649e-03 3 1  ON 44
ci_46                -8.894423e-04 3 1  ON 45
ci_47                -2.810230e-04 3 1  ON 46
ci_48                -4.211786e-04 3 1  ON 47
ci_49                -1.223704e-03 3 1  ON 48
ci_50                -9.808121e-04 3 1  ON 49
ci_51                 8.673097e-04 3 1  ON 50
ci_52                 7.892485e-04 3 1  ON 51
ci_53                -1.145101e-03 3 1  ON 52
ci_54                -9.960234e-04 3 1  ON 53
ci_55                -7.407246e-04 3 1  ON 54
ci_56                 1.597772e-03 3 1  ON 55
ci_57                 1.679918e-03 3 1  ON 56
ci_58                -9.854085e-04 3 1  ON 57
ci_59                -9.484779e-04 3 1  ON 58
ci_60                 8.151512e-04 3 1  ON 59
ci_61                 8.696332e-04 3 1  ON 60
ci_62                -5.784323e-04 3 1  ON 61
ci_63                -8.139248e-04 3 1  ON 62
ci_64                -6.835225e-04 3 1  ON 63
ci_65                -5.786135e-04 3 1  ON 64
ci_66                -8.462801e-04 3 1  ON 65
ci_67                -6.984308e-04 3 1  ON 66
ci_68                -1.930639e-04 3 1  ON 67
ci_69                -1.006150e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3474e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.8348
    reference variance = 0.348804
====================================================
  Execution time = 2.5763e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9165e-01
  Total weights = 1.963639316e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475830202468
                                         uncertainty =       0.002028744822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475830202468
                                         uncertainty =       0.002028744822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487743155
  error estimate for blocks of size 2^( 2) =       0.000508558858
  error estimate for blocks of size 2^( 3) =       0.000528189591
  error estimate for blocks of size 2^( 4) =       0.000543323035
  error estimate for blocks of size 2^( 5) =       0.000553071697
  error estimate for blocks of size 2^( 6) =       0.000558450365
  error estimate for blocks of size 2^( 7) =       0.000560226612

      target function =      -0.712916313521
              le_mean =     -22.816815829462
             les_mean =     521.098733427837
             stat err =       0.000553767927
             autocorr =       1.289060294915
   target nu stat err =       0.000553767927
   target dn stat err =       0.003036384622
      target stat err =       0.002223536138
              std dev =       0.689772984916
             le_variance =       0.475786770720


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281681582946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712922406661       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713135742386       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713167883389       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713173593397       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713175303436       residual = 9.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713176336175       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713176547855       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713176528519       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713176534157       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713176538928       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 8.730900e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712922406661       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712977631918       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712985854168       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712987293573       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712987715936       residual = 9.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712987965876       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712988016031       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712988011127       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712988012503       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712988013648       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.226670e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712922406661       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712936336418       residual = 3.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712938403930       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712938764481       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712938869711       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712938931655       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712938944018       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712938942788       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712938943130       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712938943413       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.594887e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.637047 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0351e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_01                 1.433037e-01 3 1  ON 0
ci_02                -3.996780e-02 3 1  ON 1
ci_03                -3.965872e-02 3 1  ON 2
ci_04                 3.642432e-02 3 1  ON 3
ci_05                -2.874384e-02 3 1  ON 4
ci_06                -2.797648e-02 3 1  ON 5
ci_07                 2.824378e-02 3 1  ON 6
ci_08                -1.030316e-02 3 1  ON 7
ci_09                -1.237921e-02 3 1  ON 8
ci_10                -1.212457e-02 3 1  ON 9
ci_11                 1.405241e-02 3 1  ON 10
ci_12                 9.401461e-03 3 1  ON 11
ci_13                 1.260380e-02 3 1  ON 12
ci_14                 1.226474e-02 3 1  ON 13
ci_15                 8.964488e-03 3 1  ON 14
ci_16                 8.946549e-03 3 1  ON 15
ci_17                -9.142651e-03 3 1  ON 16
ci_18                -8.608826e-03 3 1  ON 17
ci_19                 1.006228e-02 3 1  ON 18
ci_20                 8.082296e-03 3 1  ON 19
ci_21                 9.056733e-03 3 1  ON 20
ci_22                 9.249937e-03 3 1  ON 21
ci_23                 5.446607e-03 3 1  ON 22
ci_24                 4.876647e-03 3 1  ON 23
ci_25                 3.707424e-03 3 1  ON 24
ci_26                 3.823178e-03 3 1  ON 25
ci_27                 3.797129e-03 3 1  ON 26
ci_28                 2.855564e-03 3 1  ON 27
ci_29                 2.786488e-03 3 1  ON 28
ci_30                -2.253303e-03 3 1  ON 29
ci_31                -2.515117e-03 3 1  ON 30
ci_32                -1.801493e-03 3 1  ON 31
ci_33                -1.772665e-03 3 1  ON 32
ci_34                 1.626807e-03 3 1  ON 33
ci_35                 1.681520e-03 3 1  ON 34
ci_36                -1.557888e-03 3 1  ON 35
ci_37                -1.643302e-03 3 1  ON 36
ci_38                -1.098483e-03 3 1  ON 37
ci_39                -1.216117e-03 3 1  ON 38
ci_40                -1.741319e-03 3 1  ON 39
ci_41                -1.362122e-03 3 1  ON 40
ci_42                -1.140857e-03 3 1  ON 41
ci_43                -2.456666e-03 3 1  ON 42
ci_44                -1.712430e-03 3 1  ON 43
ci_45                -1.036522e-03 3 1  ON 44
ci_46                -8.888701e-04 3 1  ON 45
ci_47                -2.575008e-04 3 1  ON 46
ci_48                -3.968851e-04 3 1  ON 47
ci_49                -1.211956e-03 3 1  ON 48
ci_50                -9.870880e-04 3 1  ON 49
ci_51                 8.543880e-04 3 1  ON 50
ci_52                 7.786030e-04 3 1  ON 51
ci_53                -1.127151e-03 3 1  ON 52
ci_54                -9.950852e-04 3 1  ON 53
ci_55                -7.517193e-04 3 1  ON 54
ci_56                 1.597089e-03 3 1  ON 55
ci_57                 1.696641e-03 3 1  ON 56
ci_58                -9.833317e-04 3 1  ON 57
ci_59                -9.369774e-04 3 1  ON 58
ci_60                 7.987269e-04 3 1  ON 59
ci_61                 8.437975e-04 3 1  ON 60
ci_62                -5.691508e-04 3 1  ON 61
ci_63                -7.997859e-04 3 1  ON 62
ci_64                -6.791979e-04 3 1  ON 63
ci_65                -5.809988e-04 3 1  ON 64
ci_66                -8.418402e-04 3 1  ON 65
ci_67                -6.961372e-04 3 1  ON 66
ci_68                -1.994871e-04 3 1  ON 67
ci_69                -1.093721e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.8833
    reference variance = 0.544325
====================================================
  Execution time = 2.5270e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.8508e-01
  Total weights = 1.9638e+06
  Execution time = 3.5891e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471508304711
                                         uncertainty =       0.002159589362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471508304711
                                         uncertainty =       0.002159589362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485646874
  error estimate for blocks of size 2^( 2) =       0.000506502330
  error estimate for blocks of size 2^( 3) =       0.000526397636
  error estimate for blocks of size 2^( 4) =       0.000541545113
  error estimate for blocks of size 2^( 5) =       0.000551807463
  error estimate for blocks of size 2^( 6) =       0.000556862804
  error estimate for blocks of size 2^( 7) =       0.000561319395

      target function =      -0.713448809650
              le_mean =     -22.817295719986
             les_mean =     521.119869026436
             stat err =       0.000552883694
             autocorr =       1.296063761105
   target nu stat err =       0.000552883694
   target dn stat err =       0.006148490021
      target stat err =       0.004406207908
              std dev =       0.686808395897
             le_variance =       0.471705772675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470871405385
                                         uncertainty =       0.002151699313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470871405385
                                         uncertainty =       0.002151699313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485319188
  error estimate for blocks of size 2^( 2) =       0.000506178884
  error estimate for blocks of size 2^( 3) =       0.000526078034
  error estimate for blocks of size 2^( 4) =       0.000541239534
  error estimate for blocks of size 2^( 5) =       0.000551515429
  error estimate for blocks of size 2^( 6) =       0.000556587041
  error estimate for blocks of size 2^( 7) =       0.000561051480

      target function =      -0.713191863819
              le_mean =     -22.817297631409
             les_mean =     521.120306943635
             stat err =       0.000552598371
             autocorr =       1.296475388561
   target nu stat err =       0.000552598371
   target dn stat err =       0.006980028819
      target stat err =       0.004989806552
              std dev =       0.686344977052
             le_variance =       0.471069427524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471172352562
                                         uncertainty =       0.002155092336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471172352562
                                         uncertainty =       0.002155092336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485474052
  error estimate for blocks of size 2^( 2) =       0.000506331697
  error estimate for blocks of size 2^( 3) =       0.000526228516
  error estimate for blocks of size 2^( 4) =       0.000541381750
  error estimate for blocks of size 2^( 5) =       0.000551650700
  error estimate for blocks of size 2^( 6) =       0.000556719229
  error estimate for blocks of size 2^( 7) =       0.000561179127

      target function =      -0.707419654691
              le_mean =     -22.817293679570
             les_mean =     521.128156013079
             stat err =       0.000552732702
             autocorr =       1.296278372680
   target nu stat err =       0.000552732702
   target dn stat err =       0.014576461805
      target stat err =       0.010205877869
              std dev =       0.686563988007
             le_variance =       0.471370109627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471464600270
                                         uncertainty =       0.002159052187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471464600270
                                         uncertainty =       0.002159052187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485624395
  error estimate for blocks of size 2^( 2) =       0.000506480188
  error estimate for blocks of size 2^( 3) =       0.000526375728
  error estimate for blocks of size 2^( 4) =       0.000541523960
  error estimate for blocks of size 2^( 5) =       0.000551786693
  error estimate for blocks of size 2^( 6) =       0.000556842647
  error estimate for blocks of size 2^( 7) =       0.000561299877

      target function =      -0.717277025034
              le_mean =     -22.817295542169
             les_mean =     521.114535508999
             stat err =       0.000552863294
             autocorr =       1.296088102144
   target nu stat err =       0.000552863294
   target dn stat err =       0.002707762954
      target stat err =       0.002023198293
              std dev =       0.686776605839
             le_variance =       0.471662106328


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.713448809650        initial
     9.7656e-01     9.7656e+00             8.7309e-04        -0.713191863819
     3.9062e+00     3.9062e+01             2.2267e-04        -0.707419654691
     1.5625e+01     1.5625e+02             5.5949e-05        -0.717277025034  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 4.3268e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_01                 1.434704e-01 3 1  ON 0
ci_02                -4.010560e-02 3 1  ON 1
ci_03                -3.980395e-02 3 1  ON 2
ci_04                 3.656541e-02 3 1  ON 3
ci_05                -2.883004e-02 3 1  ON 4
ci_06                -2.805670e-02 3 1  ON 5
ci_07                 2.826532e-02 3 1  ON 6
ci_08                -1.036000e-02 3 1  ON 7
ci_09                -1.240893e-02 3 1  ON 8
ci_10                -1.215732e-02 3 1  ON 9
ci_11                 1.405496e-02 3 1  ON 10
ci_12                 9.450569e-03 3 1  ON 11
ci_13                 1.259740e-02 3 1  ON 12
ci_14                 1.226074e-02 3 1  ON 13
ci_15                 8.996465e-03 3 1  ON 14
ci_16                 8.962937e-03 3 1  ON 15
ci_17                -9.168154e-03 3 1  ON 16
ci_18                -8.645379e-03 3 1  ON 17
ci_19                 1.006455e-02 3 1  ON 18
ci_20                 8.095688e-03 3 1  ON 19
ci_21                 9.061420e-03 3 1  ON 20
ci_22                 9.256648e-03 3 1  ON 21
ci_23                 5.459927e-03 3 1  ON 22
ci_24                 4.907554e-03 3 1  ON 23
ci_25                 3.707894e-03 3 1  ON 24
ci_26                 3.828079e-03 3 1  ON 25
ci_27                 3.823803e-03 3 1  ON 26
ci_28                 2.863126e-03 3 1  ON 27
ci_29                 2.793339e-03 3 1  ON 28
ci_30                -2.265014e-03 3 1  ON 29
ci_31                -2.526766e-03 3 1  ON 30
ci_32                -1.804348e-03 3 1  ON 31
ci_33                -1.789006e-03 3 1  ON 32
ci_34                 1.631958e-03 3 1  ON 33
ci_35                 1.682315e-03 3 1  ON 34
ci_36                -1.561450e-03 3 1  ON 35
ci_37                -1.646665e-03 3 1  ON 36
ci_38                -1.103075e-03 3 1  ON 37
ci_39                -1.217791e-03 3 1  ON 38
ci_40                -1.733192e-03 3 1  ON 39
ci_41                -1.353169e-03 3 1  ON 40
ci_42                -1.151834e-03 3 1  ON 41
ci_43                -2.451830e-03 3 1  ON 42
ci_44                -1.706170e-03 3 1  ON 43
ci_45                -1.053817e-03 3 1  ON 44
ci_46                -8.892999e-04 3 1  ON 45
ci_47                -2.751090e-04 3 1  ON 46
ci_48                -4.150704e-04 3 1  ON 47
ci_49                -1.220742e-03 3 1  ON 48
ci_50                -9.823993e-04 3 1  ON 49
ci_51                 8.640508e-04 3 1  ON 50
ci_52                 7.865650e-04 3 1  ON 51
ci_53                -1.140568e-03 3 1  ON 52
ci_54                -9.957887e-04 3 1  ON 53
ci_55                -7.434948e-04 3 1  ON 54
ci_56                 1.597602e-03 3 1  ON 55
ci_57                 1.684136e-03 3 1  ON 56
ci_58                -9.848865e-04 3 1  ON 57
ci_59                -9.455781e-04 3 1  ON 58
ci_60                 8.110287e-04 3 1  ON 59
ci_61                 8.631455e-04 3 1  ON 60
ci_62                -5.760898e-04 3 1  ON 61
ci_63                -8.103560e-04 3 1  ON 62
ci_64                -6.824336e-04 3 1  ON 63
ci_65                -5.792150e-04 3 1  ON 64
ci_66                -8.451605e-04 3 1  ON 65
ci_67                -6.978540e-04 3 1  ON 66
ci_68                -1.946798e-04 3 1  ON 67
ci_69                -1.028204e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3625e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7488
    reference variance = 0.278849
====================================================
  Execution time = 2.7527e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5339e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9092e-01
  Total weights = 1.963396568e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476563939100
                                         uncertainty =       0.002486985461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476563939100
                                         uncertainty =       0.002486985461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488284396
  error estimate for blocks of size 2^( 2) =       0.000509736290
  error estimate for blocks of size 2^( 3) =       0.000529320979
  error estimate for blocks of size 2^( 4) =       0.000545299091
  error estimate for blocks of size 2^( 5) =       0.000554348254
  error estimate for blocks of size 2^( 6) =       0.000560876022
  error estimate for blocks of size 2^( 7) =       0.000560418315

      target function =      -0.713442925673
              le_mean =     -22.817427847892
             les_mean =     521.125937426963
             stat err =       0.000555235421
             autocorr =       1.293030100087
   target nu stat err =       0.000555235421
   target dn stat err =       0.003338248565
      target stat err =       0.002437511506
              std dev =       0.690538415716
             le_variance =       0.476843303580


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281742784789e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713450422134       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713501775911       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713509622539       residual = 6.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713511005450       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713511459821       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713511664224       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713511719207       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713511724607       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713511728811       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713511728651       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713511729503       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 1.955452e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713450422134       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713463376852       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713465350499       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713465696895       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713465810207       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713465860893       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713465874442       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713465875781       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713465876816       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713465876777       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713465876986       residual = 1.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 4.934572e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713450422134       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713453668163       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713454162328       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713454248968       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713454277278       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713454289923       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713454293298       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713454293632       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713454293890       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713454293880       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713454293932       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 1.236548e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.641137 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2103e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_01                 1.434214e-01 3 1  ON 0
ci_02                -4.006378e-02 3 1  ON 1
ci_03                -3.976179e-02 3 1  ON 2
ci_04                 3.651607e-02 3 1  ON 3
ci_05                -2.880198e-02 3 1  ON 4
ci_06                -2.802492e-02 3 1  ON 5
ci_07                 2.826138e-02 3 1  ON 6
ci_08                -1.034234e-02 3 1  ON 7
ci_09                -1.239283e-02 3 1  ON 8
ci_10                -1.214645e-02 3 1  ON 9
ci_11                 1.404530e-02 3 1  ON 10
ci_12                 9.442314e-03 3 1  ON 11
ci_13                 1.259334e-02 3 1  ON 12
ci_14                 1.226203e-02 3 1  ON 13
ci_15                 8.987448e-03 3 1  ON 14
ci_16                 8.950805e-03 3 1  ON 15
ci_17                -9.160168e-03 3 1  ON 16
ci_18                -8.635316e-03 3 1  ON 17
ci_19                 1.006538e-02 3 1  ON 18
ci_20                 8.093942e-03 3 1  ON 19
ci_21                 9.053685e-03 3 1  ON 20
ci_22                 9.256706e-03 3 1  ON 21
ci_23                 5.459449e-03 3 1  ON 22
ci_24                 4.906935e-03 3 1  ON 23
ci_25                 3.707198e-03 3 1  ON 24
ci_26                 3.823529e-03 3 1  ON 25
ci_27                 3.823334e-03 3 1  ON 26
ci_28                 2.858391e-03 3 1  ON 27
ci_29                 2.790027e-03 3 1  ON 28
ci_30                -2.261408e-03 3 1  ON 29
ci_31                -2.522933e-03 3 1  ON 30
ci_32                -1.798279e-03 3 1  ON 31
ci_33                -1.786030e-03 3 1  ON 32
ci_34                 1.628789e-03 3 1  ON 33
ci_35                 1.682222e-03 3 1  ON 34
ci_36                -1.559353e-03 3 1  ON 35
ci_37                -1.641073e-03 3 1  ON 36
ci_38                -1.101717e-03 3 1  ON 37
ci_39                -1.217214e-03 3 1  ON 38
ci_40                -1.729796e-03 3 1  ON 39
ci_41                -1.355062e-03 3 1  ON 40
ci_42                -1.152842e-03 3 1  ON 41
ci_43                -2.451072e-03 3 1  ON 42
ci_44                -1.706909e-03 3 1  ON 43
ci_45                -1.053836e-03 3 1  ON 44
ci_46                -8.888810e-04 3 1  ON 45
ci_47                -2.705888e-04 3 1  ON 46
ci_48                -4.101369e-04 3 1  ON 47
ci_49                -1.220332e-03 3 1  ON 48
ci_50                -9.792545e-04 3 1  ON 49
ci_51                 8.622237e-04 3 1  ON 50
ci_52                 7.838609e-04 3 1  ON 51
ci_53                -1.136913e-03 3 1  ON 52
ci_54                -9.974276e-04 3 1  ON 53
ci_55                -7.454008e-04 3 1  ON 54
ci_56                 1.602434e-03 3 1  ON 55
ci_57                 1.683486e-03 3 1  ON 56
ci_58                -9.799538e-04 3 1  ON 57
ci_59                -9.458802e-04 3 1  ON 58
ci_60                 8.115394e-04 3 1  ON 59
ci_61                 8.620675e-04 3 1  ON 60
ci_62                -5.745590e-04 3 1  ON 61
ci_63                -8.105290e-04 3 1  ON 62
ci_64                -6.784560e-04 3 1  ON 63
ci_65                -5.756038e-04 3 1  ON 64
ci_66                -8.448243e-04 3 1  ON 65
ci_67                -6.976548e-04 3 1  ON 66
ci_68                -2.005161e-04 3 1  ON 67
ci_69                -1.048022e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7878
    reference variance = 0.354571
====================================================
  Execution time = 2.5167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9099e-01
  Total weights = 1.9636e+06
  Execution time = 3.5963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475808906940
                                         uncertainty =       0.002277423359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475808906940
                                         uncertainty =       0.002277423359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487733425
  error estimate for blocks of size 2^( 2) =       0.000508595783
  error estimate for blocks of size 2^( 3) =       0.000527930671
  error estimate for blocks of size 2^( 4) =       0.000542863621
  error estimate for blocks of size 2^( 5) =       0.000553109366
  error estimate for blocks of size 2^( 6) =       0.000558466072
  error estimate for blocks of size 2^( 7) =       0.000560370085

      target function =      -0.713347975543
              le_mean =     -22.817414822454
             les_mean =     521.125479086805
             stat err =       0.000553702286
             autocorr =       1.288806133210
   target nu stat err =       0.000553702286
   target dn stat err =       0.002865559381
      target stat err =       0.002110548952
              std dev =       0.689759224468
             le_variance =       0.475767787738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475617067380
                                         uncertainty =       0.002271204060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475617067380
                                         uncertainty =       0.002271204060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487635077
  error estimate for blocks of size 2^( 2) =       0.000508499237
  error estimate for blocks of size 2^( 3) =       0.000527838051
  error estimate for blocks of size 2^( 4) =       0.000542771783
  error estimate for blocks of size 2^( 5) =       0.000553017475
  error estimate for blocks of size 2^( 6) =       0.000558376365
  error estimate for blocks of size 2^( 7) =       0.000560285821

      target function =      -0.713516203264
              le_mean =     -22.817415888761
             les_mean =     521.125291269618
             stat err =       0.000553612861
             autocorr =       1.288909619247
   target nu stat err =       0.000553612861
   target dn stat err =       0.002852269712
      target stat err =       0.002102368025
              std dev =       0.689620139695
             le_variance =       0.475575937073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475711634577
                                         uncertainty =       0.002274265076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475711634577
                                         uncertainty =       0.002274265076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487683560
  error estimate for blocks of size 2^( 2) =       0.000508546822
  error estimate for blocks of size 2^( 3) =       0.000527883688
  error estimate for blocks of size 2^( 4) =       0.000542817027
  error estimate for blocks of size 2^( 5) =       0.000553062743
  error estimate for blocks of size 2^( 6) =       0.000558420533
  error estimate for blocks of size 2^( 7) =       0.000560327307

      target function =      -0.713447074142
              le_mean =     -22.817415287701
             les_mean =     521.125360995821
             stat err =       0.000553656902
             autocorr =       1.288858396905
   target nu stat err =       0.000553656902
   target dn stat err =       0.002857905977
      target stat err =       0.002105852160
              std dev =       0.689688705222
             le_variance =       0.475670510111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475796661030
                                         uncertainty =       0.002277025033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475796661030
                                         uncertainty =       0.002277025033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487727148
  error estimate for blocks of size 2^( 2) =       0.000508589619
  error estimate for blocks of size 2^( 3) =       0.000527924754
  error estimate for blocks of size 2^( 4) =       0.000542857752
  error estimate for blocks of size 2^( 5) =       0.000553103493
  error estimate for blocks of size 2^( 6) =       0.000558460333
  error estimate for blocks of size 2^( 7) =       0.000560364691

      target function =      -0.713361662071
              le_mean =     -22.817414872405
             les_mean =     521.125462121805
             stat err =       0.000553696567
             autocorr =       1.288812686733
   target nu stat err =       0.000553696567
   target dn stat err =       0.002864488583
      target stat err =       0.002109891041
              std dev =       0.689750347013
             le_variance =       0.475755541205


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.713347975543        initial
     3.9062e+00     3.9062e+01             1.9555e-04        -0.713516203264  <--
     1.5625e+01     1.5625e+02             4.9346e-05        -0.713447074142
     6.2500e+01     6.2500e+02             1.2365e-05        -0.713361662071

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.3212e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_01                 1.432754e-01 3 1  ON 0
ci_02                -3.993969e-02 3 1  ON 1
ci_03                -3.963670e-02 3 1  ON 2
ci_04                 3.636987e-02 3 1  ON 3
ci_05                -2.871878e-02 3 1  ON 4
ci_06                -2.793067e-02 3 1  ON 5
ci_07                 2.824963e-02 3 1  ON 6
ci_08                -1.028997e-02 3 1  ON 7
ci_09                -1.234499e-02 3 1  ON 8
ci_10                -1.211410e-02 3 1  ON 9
ci_11                 1.401663e-02 3 1  ON 10
ci_12                 9.417821e-03 3 1  ON 11
ci_13                 1.258127e-02 3 1  ON 12
ci_14                 1.226591e-02 3 1  ON 13
ci_15                 8.960694e-03 3 1  ON 14
ci_16                 8.914804e-03 3 1  ON 15
ci_17                -9.136447e-03 3 1  ON 16
ci_18                -8.605415e-03 3 1  ON 17
ci_19                 1.006787e-02 3 1  ON 18
ci_20                 8.088757e-03 3 1  ON 19
ci_21                 9.030649e-03 3 1  ON 20
ci_22                 9.256874e-03 3 1  ON 21
ci_23                 5.458042e-03 3 1  ON 22
ci_24                 4.905109e-03 3 1  ON 23
ci_25                 3.705126e-03 3 1  ON 24
ci_26                 3.810062e-03 3 1  ON 25
ci_27                 3.821952e-03 3 1  ON 26
ci_28                 2.844313e-03 3 1  ON 27
ci_29                 2.780173e-03 3 1  ON 28
ci_30                -2.250655e-03 3 1  ON 29
ci_31                -2.511524e-03 3 1  ON 30
ci_32                -1.780322e-03 3 1  ON 31
ci_33                -1.777225e-03 3 1  ON 32
ci_34                 1.619422e-03 3 1  ON 33
ci_35                 1.681983e-03 3 1  ON 34
ci_36                -1.553129e-03 3 1  ON 35
ci_37                -1.624502e-03 3 1  ON 36
ci_38                -1.097674e-03 3 1  ON 37
ci_39                -1.215504e-03 3 1  ON 38
ci_40                -1.719751e-03 3 1  ON 39
ci_41                -1.360685e-03 3 1  ON 40
ci_42                -1.155847e-03 3 1  ON 41
ci_43                -2.448795e-03 3 1  ON 42
ci_44                -1.709081e-03 3 1  ON 43
ci_45                -1.053882e-03 3 1  ON 44
ci_46                -8.876330e-04 3 1  ON 45
ci_47                -2.571478e-04 3 1  ON 46
ci_48                -3.954400e-04 3 1  ON 47
ci_49                -1.219100e-03 3 1  ON 48
ci_50                -9.699551e-04 3 1  ON 49
ci_51                 8.567984e-04 3 1  ON 50
ci_52                 7.758366e-04 3 1  ON 51
ci_53                -1.126093e-03 3 1  ON 52
ci_54                -1.002285e-03 3 1  ON 53
ci_55                -7.510433e-04 3 1  ON 54
ci_56                 1.616759e-03 3 1  ON 55
ci_57                 1.681567e-03 3 1  ON 56
ci_58                -9.653320e-04 3 1  ON 57
ci_59                -9.467822e-04 3 1  ON 58
ci_60                 8.130584e-04 3 1  ON 59
ci_61                 8.588657e-04 3 1  ON 60
ci_62                -5.700357e-04 3 1  ON 61
ci_63                -8.110326e-04 3 1  ON 62
ci_64                -6.666469e-04 3 1  ON 63
ci_65                -5.649039e-04 3 1  ON 64
ci_66                -8.438238e-04 3 1  ON 65
ci_67                -6.970564e-04 3 1  ON 66
ci_68                -2.178371e-04 3 1  ON 67
ci_69                -1.106859e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5320e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.8447
    reference variance = 0.362114
====================================================
  Execution time = 2.5842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9174e-01
  Total weights = 1.963805767e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5737e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475221656235
                                         uncertainty =       0.002472753344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475221656235
                                         uncertainty =       0.002472753344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487456309
  error estimate for blocks of size 2^( 2) =       0.000508150117
  error estimate for blocks of size 2^( 3) =       0.000528104445
  error estimate for blocks of size 2^( 4) =       0.000543396478
  error estimate for blocks of size 2^( 5) =       0.000553262939
  error estimate for blocks of size 2^( 6) =       0.000559337725
  error estimate for blocks of size 2^( 7) =       0.000563337424

      target function =      -0.712853083596
              le_mean =     -22.816948312840
             les_mean =     521.104867168367
             stat err =       0.000554833641
             autocorr =       1.295550003366
   target nu stat err =       0.000554833641
   target dn stat err =       0.003778163633
      target stat err =       0.002736741443
              std dev =       0.689367323584
             le_variance =       0.475227306826


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281694831284e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712862769903       residual = 2.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713083449299       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713110905498       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713120315015       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713122847846       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713123378822       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713124182720       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713124041595       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713124041311       residual = 9.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713124066394       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713124059977       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 9.520493e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712862769903       residual = 2.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712919786145       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712926802710       residual = 7.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712929245349       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712929856286       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712929985165       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712930183339       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712930148388       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712930148530       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712930154414       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.712930152988       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.427901e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712862769903       residual = 2.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712877144176       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712878908084       residual = 7.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712879524582       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712879675841       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712879707908       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712879757208       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712879748498       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712879748547       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712879749993       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.712879749648       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 6.100420e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.645267 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0426e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_01                 1.430326e-01 3 1  ON 0
ci_02                -3.974520e-02 3 1  ON 1
ci_03                -3.945859e-02 3 1  ON 2
ci_04                 3.619038e-02 3 1  ON 3
ci_05                -2.861381e-02 3 1  ON 4
ci_06                -2.782040e-02 3 1  ON 5
ci_07                 2.823134e-02 3 1  ON 6
ci_08                -1.022611e-02 3 1  ON 7
ci_09                -1.229363e-02 3 1  ON 8
ci_10                -1.204308e-02 3 1  ON 9
ci_11                 1.398496e-02 3 1  ON 10
ci_12                 9.372234e-03 3 1  ON 11
ci_13                 1.257764e-02 3 1  ON 12
ci_14                 1.226298e-02 3 1  ON 13
ci_15                 8.924078e-03 3 1  ON 14
ci_16                 8.874270e-03 3 1  ON 15
ci_17                -9.088614e-03 3 1  ON 16
ci_18                -8.584929e-03 3 1  ON 17
ci_19                 1.006541e-02 3 1  ON 18
ci_20                 8.073672e-03 3 1  ON 19
ci_21                 9.039850e-03 3 1  ON 20
ci_22                 9.244281e-03 3 1  ON 21
ci_23                 5.450926e-03 3 1  ON 22
ci_24                 4.903749e-03 3 1  ON 23
ci_25                 3.704734e-03 3 1  ON 24
ci_26                 3.757516e-03 3 1  ON 25
ci_27                 3.811081e-03 3 1  ON 26
ci_28                 2.823883e-03 3 1  ON 27
ci_29                 2.774783e-03 3 1  ON 28
ci_30                -2.249744e-03 3 1  ON 29
ci_31                -2.501431e-03 3 1  ON 30
ci_32                -1.761847e-03 3 1  ON 31
ci_33                -1.771085e-03 3 1  ON 32
ci_34                 1.633195e-03 3 1  ON 33
ci_35                 1.662196e-03 3 1  ON 34
ci_36                -1.541146e-03 3 1  ON 35
ci_37                -1.614346e-03 3 1  ON 36
ci_38                -1.084122e-03 3 1  ON 37
ci_39                -1.209230e-03 3 1  ON 38
ci_40                -1.704878e-03 3 1  ON 39
ci_41                -1.352045e-03 3 1  ON 40
ci_42                -1.164705e-03 3 1  ON 41
ci_43                -2.456517e-03 3 1  ON 42
ci_44                -1.683717e-03 3 1  ON 43
ci_45                -1.042962e-03 3 1  ON 44
ci_46                -8.827482e-04 3 1  ON 45
ci_47                -2.252143e-04 3 1  ON 46
ci_48                -3.759641e-04 3 1  ON 47
ci_49                -1.215724e-03 3 1  ON 48
ci_50                -9.622790e-04 3 1  ON 49
ci_51                 8.505231e-04 3 1  ON 50
ci_52                 7.640283e-04 3 1  ON 51
ci_53                -1.113732e-03 3 1  ON 52
ci_54                -1.012879e-03 3 1  ON 53
ci_55                -7.521423e-04 3 1  ON 54
ci_56                 1.616964e-03 3 1  ON 55
ci_57                 1.693388e-03 3 1  ON 56
ci_58                -9.665312e-04 3 1  ON 57
ci_59                -9.382538e-04 3 1  ON 58
ci_60                 8.189363e-04 3 1  ON 59
ci_61                 8.511372e-04 3 1  ON 60
ci_62                -5.721991e-04 3 1  ON 61
ci_63                -8.169406e-04 3 1  ON 62
ci_64                -6.572185e-04 3 1  ON 63
ci_65                -5.568268e-04 3 1  ON 64
ci_66                -8.357893e-04 3 1  ON 65
ci_67                -6.899809e-04 3 1  ON 66
ci_68                -2.101696e-04 3 1  ON 67
ci_69                -1.296648e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.8292
    reference variance = 0.381241
====================================================
  Execution time = 2.5439e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9584e-01
  Total weights = 1.9633e+06
  Execution time = 3.5973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478895665203
                                         uncertainty =       0.002660946016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478895665203
                                         uncertainty =       0.002660946016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489271508
  error estimate for blocks of size 2^( 2) =       0.000510132175
  error estimate for blocks of size 2^( 3) =       0.000530222158
  error estimate for blocks of size 2^( 4) =       0.000546128310
  error estimate for blocks of size 2^( 5) =       0.000555313284
  error estimate for blocks of size 2^( 6) =       0.000561968922
  error estimate for blocks of size 2^( 7) =       0.000562350099

      target function =      -0.709296529225
              le_mean =     -22.817451617789
             les_mean =     521.132882756136
             stat err =       0.000556440153
             autocorr =       1.293412550322
   target nu stat err =       0.000556440153
   target dn stat err =       0.004029569001
      target stat err =       0.002885533737
              std dev =       0.691934402835
             le_variance =       0.478773217827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478221769386
                                         uncertainty =       0.002644683565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478221769386
                                         uncertainty =       0.002644683565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488927343
  error estimate for blocks of size 2^( 2) =       0.000509792035
  error estimate for blocks of size 2^( 3) =       0.000529891771
  error estimate for blocks of size 2^( 4) =       0.000545806288
  error estimate for blocks of size 2^( 5) =       0.000554984188
  error estimate for blocks of size 2^( 6) =       0.000561641696
  error estimate for blocks of size 2^( 7) =       0.000562027460

      target function =      -0.710014871890
              le_mean =     -22.817453725903
             les_mean =     521.131958879300
             stat err =       0.000556114908
             autocorr =       1.293720393569
   target nu stat err =       0.000556114908
   target dn stat err =       0.003922844306
      target stat err =       0.002817468424
              std dev =       0.691447679244
             le_variance =       0.478099893132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478539049014
                                         uncertainty =       0.002652319497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478539049014
                                         uncertainty =       0.002652319497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489089414
  error estimate for blocks of size 2^( 2) =       0.000509951991
  error estimate for blocks of size 2^( 3) =       0.000530046906
  error estimate for blocks of size 2^( 4) =       0.000545957335
  error estimate for blocks of size 2^( 5) =       0.000555138523
  error estimate for blocks of size 2^( 6) =       0.000561795127
  error estimate for blocks of size 2^( 7) =       0.000562178772

      target function =      -0.710188727082
              le_mean =     -22.817451647904
             les_mean =     521.131617270379
             stat err =       0.000556267439
             autocorr =       1.293572438779
   target nu stat err =       0.000556267439
   target dn stat err =       0.003915350349
      target stat err =       0.002813664926
              std dev =       0.691676881924
             le_variance =       0.478416908988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478849649117
                                         uncertainty =       0.002659827924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478849649117
                                         uncertainty =       0.002659827924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489248016
  error estimate for blocks of size 2^( 2) =       0.000510108874
  error estimate for blocks of size 2^( 3) =       0.000530199452
  error estimate for blocks of size 2^( 4) =       0.000546106157
  error estimate for blocks of size 2^( 5) =       0.000555290589
  error estimate for blocks of size 2^( 6) =       0.000561946329
  error estimate for blocks of size 2^( 7) =       0.000562327845

      target function =      -0.709581035916
              le_mean =     -22.817451497001
             les_mean =     521.132473083021
             stat err =       0.000556417730
             autocorr =       1.293432515075
   target nu stat err =       0.000556417730
   target dn stat err =       0.003972058277
      target stat err =       0.002848099861
              std dev =       0.691901179302
             le_variance =       0.478727241920


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709296529225        initial
     9.7656e-01     9.7656e+00             9.5205e-04        -0.710014871890
     3.9062e+00     3.9062e+01             2.4279e-04        -0.710188727082  <--
     1.5625e+01     1.5625e+02             6.1004e-05        -0.709581035916

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.3585e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_01                 1.430326e-01 3 1  ON 0
ci_02                -3.974520e-02 3 1  ON 1
ci_03                -3.945859e-02 3 1  ON 2
ci_04                 3.619038e-02 3 1  ON 3
ci_05                -2.861381e-02 3 1  ON 4
ci_06                -2.782040e-02 3 1  ON 5
ci_07                 2.823134e-02 3 1  ON 6
ci_08                -1.022611e-02 3 1  ON 7
ci_09                -1.229363e-02 3 1  ON 8
ci_10                -1.204308e-02 3 1  ON 9
ci_11                 1.398496e-02 3 1  ON 10
ci_12                 9.372234e-03 3 1  ON 11
ci_13                 1.257764e-02 3 1  ON 12
ci_14                 1.226298e-02 3 1  ON 13
ci_15                 8.924078e-03 3 1  ON 14
ci_16                 8.874270e-03 3 1  ON 15
ci_17                -9.088614e-03 3 1  ON 16
ci_18                -8.584929e-03 3 1  ON 17
ci_19                 1.006541e-02 3 1  ON 18
ci_20                 8.073672e-03 3 1  ON 19
ci_21                 9.039850e-03 3 1  ON 20
ci_22                 9.244281e-03 3 1  ON 21
ci_23                 5.450926e-03 3 1  ON 22
ci_24                 4.903749e-03 3 1  ON 23
ci_25                 3.704734e-03 3 1  ON 24
ci_26                 3.757516e-03 3 1  ON 25
ci_27                 3.811081e-03 3 1  ON 26
ci_28                 2.823883e-03 3 1  ON 27
ci_29                 2.774783e-03 3 1  ON 28
ci_30                -2.249744e-03 3 1  ON 29
ci_31                -2.501431e-03 3 1  ON 30
ci_32                -1.761847e-03 3 1  ON 31
ci_33                -1.771085e-03 3 1  ON 32
ci_34                 1.633195e-03 3 1  ON 33
ci_35                 1.662196e-03 3 1  ON 34
ci_36                -1.541146e-03 3 1  ON 35
ci_37                -1.614346e-03 3 1  ON 36
ci_38                -1.084122e-03 3 1  ON 37
ci_39                -1.209230e-03 3 1  ON 38
ci_40                -1.704878e-03 3 1  ON 39
ci_41                -1.352045e-03 3 1  ON 40
ci_42                -1.164705e-03 3 1  ON 41
ci_43                -2.456517e-03 3 1  ON 42
ci_44                -1.683717e-03 3 1  ON 43
ci_45                -1.042962e-03 3 1  ON 44
ci_46                -8.827482e-04 3 1  ON 45
ci_47                -2.252143e-04 3 1  ON 46
ci_48                -3.759641e-04 3 1  ON 47
ci_49                -1.215724e-03 3 1  ON 48
ci_50                -9.622790e-04 3 1  ON 49
ci_51                 8.505231e-04 3 1  ON 50
ci_52                 7.640283e-04 3 1  ON 51
ci_53                -1.113732e-03 3 1  ON 52
ci_54                -1.012879e-03 3 1  ON 53
ci_55                -7.521423e-04 3 1  ON 54
ci_56                 1.616964e-03 3 1  ON 55
ci_57                 1.693388e-03 3 1  ON 56
ci_58                -9.665312e-04 3 1  ON 57
ci_59                -9.382538e-04 3 1  ON 58
ci_60                 8.189363e-04 3 1  ON 59
ci_61                 8.511372e-04 3 1  ON 60
ci_62                -5.721991e-04 3 1  ON 61
ci_63                -8.169406e-04 3 1  ON 62
ci_64                -6.572185e-04 3 1  ON 63
ci_65                -5.568268e-04 3 1  ON 64
ci_66                -8.357893e-04 3 1  ON 65
ci_67                -6.899809e-04 3 1  ON 66
ci_68                -2.101696e-04 3 1  ON 67
ci_69                -1.296648e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.8928
    reference variance = 0.381112
====================================================
  Execution time = 2.5967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9207e-01
  Total weights = 1.963436284e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474900769711
                                         uncertainty =       0.002090618288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474900769711
                                         uncertainty =       0.002090618288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487273764
  error estimate for blocks of size 2^( 2) =       0.000508063542
  error estimate for blocks of size 2^( 3) =       0.000528344339
  error estimate for blocks of size 2^( 4) =       0.000543591913
  error estimate for blocks of size 2^( 5) =       0.000553662665
  error estimate for blocks of size 2^( 6) =       0.000560418117
  error estimate for blocks of size 2^( 7) =       0.000560727654

      target function =      -0.712632397426
              le_mean =     -22.817427500719
             les_mean =     521.127064298466
             stat err =       0.000554600087
             autocorr =       1.295429582072
   target nu stat err =       0.000554600087
   target dn stat err =       0.003080525677
      target stat err =       0.002254275292
              std dev =       0.689109165549
             le_variance =       0.474871442043


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281742750072e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712638735870       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712847349004       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712876537048       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712882022538       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712883738952       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712884078125       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712884216842       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712884231266       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712884231257       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712884243812       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.712884243258       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 8.736739e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712638735870       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712692757589       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712700223122       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712701605095       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712702027272       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712702106862       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712702139772       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712702143168       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712702143186       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712702146217       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.712702146057       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.227930e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712638735870       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712652363304       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712654240449       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712654586560       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712654691629       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712654711193       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712654719308       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712654720144       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712654720150       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712654720900       residual = 9.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.597765e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.649221 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0555e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_01                 1.428099e-01 3 1  ON 0
ci_02                -3.955550e-02 3 1  ON 1
ci_03                -3.929906e-02 3 1  ON 2
ci_04                 3.597960e-02 3 1  ON 3
ci_05                -2.850270e-02 3 1  ON 4
ci_06                -2.772333e-02 3 1  ON 5
ci_07                 2.822439e-02 3 1  ON 6
ci_08                -1.015493e-02 3 1  ON 7
ci_09                -1.223421e-02 3 1  ON 8
ci_10                -1.199568e-02 3 1  ON 9
ci_11                 1.395412e-02 3 1  ON 10
ci_12                 9.341995e-03 3 1  ON 11
ci_13                 1.257627e-02 3 1  ON 12
ci_14                 1.228601e-02 3 1  ON 13
ci_15                 8.898772e-03 3 1  ON 14
ci_16                 8.852333e-03 3 1  ON 15
ci_17                -9.070854e-03 3 1  ON 16
ci_18                -8.556303e-03 3 1  ON 17
ci_19                 1.004021e-02 3 1  ON 18
ci_20                 8.018604e-03 3 1  ON 19
ci_21                 9.053170e-03 3 1  ON 20
ci_22                 9.234061e-03 3 1  ON 21
ci_23                 5.434707e-03 3 1  ON 22
ci_24                 4.899098e-03 3 1  ON 23
ci_25                 3.690335e-03 3 1  ON 24
ci_26                 3.742626e-03 3 1  ON 25
ci_27                 3.782393e-03 3 1  ON 26
ci_28                 2.811537e-03 3 1  ON 27
ci_29                 2.758533e-03 3 1  ON 28
ci_30                -2.240232e-03 3 1  ON 29
ci_31                -2.464196e-03 3 1  ON 30
ci_32                -1.757905e-03 3 1  ON 31
ci_33                -1.768484e-03 3 1  ON 32
ci_34                 1.619723e-03 3 1  ON 33
ci_35                 1.666945e-03 3 1  ON 34
ci_36                -1.537504e-03 3 1  ON 35
ci_37                -1.601520e-03 3 1  ON 36
ci_38                -1.081851e-03 3 1  ON 37
ci_39                -1.204567e-03 3 1  ON 38
ci_40                -1.699244e-03 3 1  ON 39
ci_41                -1.344252e-03 3 1  ON 40
ci_42                -1.139372e-03 3 1  ON 41
ci_43                -2.467451e-03 3 1  ON 42
ci_44                -1.676891e-03 3 1  ON 43
ci_45                -1.035553e-03 3 1  ON 44
ci_46                -8.868979e-04 3 1  ON 45
ci_47                -2.078906e-04 3 1  ON 46
ci_48                -3.578236e-04 3 1  ON 47
ci_49                -1.204896e-03 3 1  ON 48
ci_50                -9.551936e-04 3 1  ON 49
ci_51                 8.404596e-04 3 1  ON 50
ci_52                 7.519552e-04 3 1  ON 51
ci_53                -1.103719e-03 3 1  ON 52
ci_54                -9.926814e-04 3 1  ON 53
ci_55                -7.462767e-04 3 1  ON 54
ci_56                 1.634505e-03 3 1  ON 55
ci_57                 1.699314e-03 3 1  ON 56
ci_58                -9.619072e-04 3 1  ON 57
ci_59                -9.368364e-04 3 1  ON 58
ci_60                 8.047123e-04 3 1  ON 59
ci_61                 8.450329e-04 3 1  ON 60
ci_62                -5.723778e-04 3 1  ON 61
ci_63                -8.161724e-04 3 1  ON 62
ci_64                -6.436064e-04 3 1  ON 63
ci_65                -5.417936e-04 3 1  ON 64
ci_66                -8.376738e-04 3 1  ON 65
ci_67                -6.867340e-04 3 1  ON 66
ci_68                -2.322493e-04 3 1  ON 67
ci_69                -1.328020e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.7568
    reference variance = 0.352125
====================================================
  Execution time = 2.5160e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.8832e-01
  Total weights = 1.9635e+06
  Execution time = 3.6048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475031381719
                                         uncertainty =       0.002757843063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475031381719
                                         uncertainty =       0.002757843063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487368737
  error estimate for blocks of size 2^( 2) =       0.000508417618
  error estimate for blocks of size 2^( 3) =       0.000528350728
  error estimate for blocks of size 2^( 4) =       0.000543635830
  error estimate for blocks of size 2^( 5) =       0.000553937208
  error estimate for blocks of size 2^( 6) =       0.000559773069
  error estimate for blocks of size 2^( 7) =       0.000563743105

      target function =      -0.715130143792
              le_mean =     -22.817129856355
             les_mean =     521.109961679626
             stat err =       0.000555272303
             autocorr =       1.298065741696
   target nu stat err =       0.000555272303
   target dn stat err =       0.003331921749
      target stat err =       0.002443345036
              std dev =       0.689243477665
             le_variance =       0.475056571503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474312954883
                                         uncertainty =       0.002736410296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474312954883
                                         uncertainty =       0.002736410296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487000866
  error estimate for blocks of size 2^( 2) =       0.000508055870
  error estimate for blocks of size 2^( 3) =       0.000528009213
  error estimate for blocks of size 2^( 4) =       0.000543314570
  error estimate for blocks of size 2^( 5) =       0.000553615740
  error estimate for blocks of size 2^( 6) =       0.000559443148
  error estimate for blocks of size 2^( 7) =       0.000563449392

      target function =      -0.715250494013
              le_mean =     -22.817134589518
             les_mean =     521.110009456059
             stat err =       0.000554955712
             autocorr =       1.298545540505
   target nu stat err =       0.000554955712
   target dn stat err =       0.003317057502
      target stat err =       0.002433749018
              std dev =       0.688723229536
             le_variance =       0.474339686902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474652613835
                                         uncertainty =       0.002746568393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474652613835
                                         uncertainty =       0.002746568393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487174813
  error estimate for blocks of size 2^( 2) =       0.000508226502
  error estimate for blocks of size 2^( 3) =       0.000528169814
  error estimate for blocks of size 2^( 4) =       0.000543464409
  error estimate for blocks of size 2^( 5) =       0.000553766056
  error estimate for blocks of size 2^( 6) =       0.000559597451
  error estimate for blocks of size 2^( 7) =       0.000563586997

      target function =      -0.714983082598
              le_mean =     -22.817131419961
             les_mean =     521.110238835552
             stat err =       0.000555103728
             autocorr =       1.298310694546
   target nu stat err =       0.000555103728
   target dn stat err =       0.003365262059
      target stat err =       0.002465519871
              std dev =       0.688969227381
             le_variance =       0.474678596278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474987588064
                                         uncertainty =       0.002756099573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474987588064
                                         uncertainty =       0.002756099573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487346320
  error estimate for blocks of size 2^( 2) =       0.000508394867
  error estimate for blocks of size 2^( 3) =       0.000528329564
  error estimate for blocks of size 2^( 4) =       0.000543616195
  error estimate for blocks of size 2^( 5) =       0.000553917798
  error estimate for blocks of size 2^( 6) =       0.000559746409
  error estimate for blocks of size 2^( 7) =       0.000563718795

      target function =      -0.036081713767
              le_mean =     -22.817131388998
             les_mean =     530.987111131629
             stat err =       0.000555249799
             autocorr =       1.298079936859
   target nu stat err =       0.000555249799
   target dn stat err =       9.881481314150
      target stat err =       0.032775094657
              std dev =       0.689211775985
             le_variance =       0.475012872156


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.715130143792        initial
     9.7656e-01     9.7656e+00             8.7367e-04        -0.715250494013  <--
     3.9062e+00     3.9062e+01             2.2279e-04        -0.714983082598
     1.5625e+01     1.5625e+02             5.5978e-05        -0.036081713767

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 4.3230e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_01                 1.421590e-01 3 1  ON 0
ci_02                -3.901048e-02 3 1  ON 1
ci_03                -3.884072e-02 3 1  ON 2
ci_04                 3.537714e-02 3 1  ON 3
ci_05                -2.818452e-02 3 1  ON 4
ci_06                -2.744581e-02 3 1  ON 5
ci_07                 2.820443e-02 3 1  ON 6
ci_08                -9.951141e-03 3 1  ON 7
ci_09                -1.206250e-02 3 1  ON 8
ci_10                -1.185893e-02 3 1  ON 9
ci_11                 1.386546e-02 3 1  ON 10
ci_12                 9.255198e-03 3 1  ON 11
ci_13                 1.257282e-02 3 1  ON 12
ci_14                 1.235366e-02 3 1  ON 13
ci_15                 8.826170e-03 3 1  ON 14
ci_16                 8.789230e-03 3 1  ON 15
ci_17                -9.019289e-03 3 1  ON 16
ci_18                -8.473503e-03 3 1  ON 17
ci_19                 9.968430e-03 3 1  ON 18
ci_20                 7.861035e-03 3 1  ON 19
ci_21                 9.091842e-03 3 1  ON 20
ci_22                 9.204212e-03 3 1  ON 21
ci_23                 5.388488e-03 3 1  ON 22
ci_24                 4.885827e-03 3 1  ON 23
ci_25                 3.649170e-03 3 1  ON 24
ci_26                 3.700027e-03 3 1  ON 25
ci_27                 3.700045e-03 3 1  ON 26
ci_28                 2.775664e-03 3 1  ON 27
ci_29                 2.711631e-03 3 1  ON 28
ci_30                -2.212618e-03 3 1  ON 29
ci_31                -2.355767e-03 3 1  ON 30
ci_32                -1.747199e-03 3 1  ON 31
ci_33                -1.761464e-03 3 1  ON 32
ci_34                 1.581624e-03 3 1  ON 33
ci_35                 1.681278e-03 3 1  ON 34
ci_36                -1.527007e-03 3 1  ON 35
ci_37                -1.564842e-03 3 1  ON 36
ci_38                -1.075202e-03 3 1  ON 37
ci_39                -1.191217e-03 3 1  ON 38
ci_40                -1.683055e-03 3 1  ON 39
ci_41                -1.322426e-03 3 1  ON 40
ci_42                -1.067411e-03 3 1  ON 41
ci_43                -2.498560e-03 3 1  ON 42
ci_44                -1.657046e-03 3 1  ON 43
ci_45                -1.014217e-03 3 1  ON 44
ci_46                -8.986639e-04 3 1  ON 45
ci_47                -1.571315e-04 3 1  ON 46
ci_48                -3.051998e-04 3 1  ON 47
ci_49                -1.173845e-03 3 1  ON 48
ci_50                -9.349499e-04 3 1  ON 49
ci_51                 8.115462e-04 3 1  ON 50
ci_52                 7.173576e-04 3 1  ON 51
ci_53                -1.075071e-03 3 1  ON 52
ci_54                -9.347472e-04 3 1  ON 53
ci_55                -7.295118e-04 3 1  ON 54
ci_56                 1.684662e-03 3 1  ON 55
ci_57                 1.716448e-03 3 1  ON 56
ci_58                -9.487564e-04 3 1  ON 57
ci_59                -9.327796e-04 3 1  ON 58
ci_60                 7.631863e-04 3 1  ON 59
ci_61                 8.272944e-04 3 1  ON 60
ci_62                -5.727629e-04 3 1  ON 61
ci_63                -8.137764e-04 3 1  ON 62
ci_64                -6.045811e-04 3 1  ON 63
ci_65                -4.988851e-04 3 1  ON 64
ci_66                -8.431154e-04 3 1  ON 65
ci_67                -6.772575e-04 3 1  ON 66
ci_68                -2.954165e-04 3 1  ON 67
ci_69                -1.416636e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3791e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8158
    reference variance = 0.438546
====================================================
  Execution time = 2.5720e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5325e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9220e-01
  Total weights = 1.963493231e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475811643161
                                         uncertainty =       0.002380458814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475811643161
                                         uncertainty =       0.002380458814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487784134
  error estimate for blocks of size 2^( 2) =       0.000508759038
  error estimate for blocks of size 2^( 3) =       0.000528571074
  error estimate for blocks of size 2^( 4) =       0.000542602916
  error estimate for blocks of size 2^( 5) =       0.000551535415
  error estimate for blocks of size 2^( 6) =       0.000557599620
  error estimate for blocks of size 2^( 7) =       0.000561979697

      target function =      -0.712540188642
              le_mean =     -22.817516174439
             les_mean =     521.131240767140
             stat err =       0.000553429412
             autocorr =       1.287268471841
   target nu stat err =       0.000553429412
   target dn stat err =       0.003477463640
      target stat err =       0.002527688927
              std dev =       0.689830937587
             le_variance =       0.475866722452


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281751617444e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712548387211       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713126447146       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713236223620       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713259800670       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713270703506       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713272805599       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713273259627       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713273405037       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713273395194       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713273398192       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713273409257       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 3.515881e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712548387211       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712712896524       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712742855702       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712748953612       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712751592892       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712752037713       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712752119417       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712752149981       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712752146305       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712752147391       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.712752149800       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 9.450587e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712548387211       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712590986408       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712598647957       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712600182839       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712600834299       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712600939855       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712600958234       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712600965463       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712600964478       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712600964778       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.408408e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.653188 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0298e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_01                 1.412139e-01 3 1  ON 0
ci_02                -3.831093e-02 3 1  ON 1
ci_03                -3.827834e-02 3 1  ON 2
ci_04                 3.467516e-02 3 1  ON 3
ci_05                -2.773885e-02 3 1  ON 4
ci_06                -2.715084e-02 3 1  ON 5
ci_07                 2.817913e-02 3 1  ON 6
ci_08                -9.643804e-03 3 1  ON 7
ci_09                -1.188295e-02 3 1  ON 8
ci_10                -1.164328e-02 3 1  ON 9
ci_11                 1.384016e-02 3 1  ON 10
ci_12                 9.167797e-03 3 1  ON 11
ci_13                 1.263570e-02 3 1  ON 12
ci_14                 1.228778e-02 3 1  ON 13
ci_15                 8.732217e-03 3 1  ON 14
ci_16                 8.674834e-03 3 1  ON 15
ci_17                -8.875245e-03 3 1  ON 16
ci_18                -8.386807e-03 3 1  ON 17
ci_19                 9.883078e-03 3 1  ON 18
ci_20                 7.798052e-03 3 1  ON 19
ci_21                 9.115290e-03 3 1  ON 20
ci_22                 9.227202e-03 3 1  ON 21
ci_23                 5.336708e-03 3 1  ON 22
ci_24                 4.850099e-03 3 1  ON 23
ci_25                 3.585025e-03 3 1  ON 24
ci_26                 3.659857e-03 3 1  ON 25
ci_27                 3.654832e-03 3 1  ON 26
ci_28                 2.686858e-03 3 1  ON 27
ci_29                 2.715501e-03 3 1  ON 28
ci_30                -2.206222e-03 3 1  ON 29
ci_31                -2.344573e-03 3 1  ON 30
ci_32                -1.709148e-03 3 1  ON 31
ci_33                -1.690293e-03 3 1  ON 32
ci_34                 1.538188e-03 3 1  ON 33
ci_35                 1.713552e-03 3 1  ON 34
ci_36                -1.461231e-03 3 1  ON 35
ci_37                -1.559058e-03 3 1  ON 36
ci_38                -1.051428e-03 3 1  ON 37
ci_39                -1.170370e-03 3 1  ON 38
ci_40                -1.652477e-03 3 1  ON 39
ci_41                -1.278095e-03 3 1  ON 40
ci_42                -1.028892e-03 3 1  ON 41
ci_43                -2.437878e-03 3 1  ON 42
ci_44                -1.764651e-03 3 1  ON 43
ci_45                -9.655003e-04 3 1  ON 44
ci_46                -8.659537e-04 3 1  ON 45
ci_47                -7.340505e-05 3 1  ON 46
ci_48                -2.682928e-04 3 1  ON 47
ci_49                -1.184833e-03 3 1  ON 48
ci_50                -9.095379e-04 3 1  ON 49
ci_51                 7.725687e-04 3 1  ON 50
ci_52                 6.941895e-04 3 1  ON 51
ci_53                -1.028281e-03 3 1  ON 52
ci_54                -9.270900e-04 3 1  ON 53
ci_55                -6.769469e-04 3 1  ON 54
ci_56                 1.701402e-03 3 1  ON 55
ci_57                 1.713003e-03 3 1  ON 56
ci_58                -9.803707e-04 3 1  ON 57
ci_59                -9.102390e-04 3 1  ON 58
ci_60                 7.848097e-04 3 1  ON 59
ci_61                 7.577217e-04 3 1  ON 60
ci_62                -5.706197e-04 3 1  ON 61
ci_63                -7.999553e-04 3 1  ON 62
ci_64                -5.746923e-04 3 1  ON 63
ci_65                -4.521666e-04 3 1  ON 64
ci_66                -8.245588e-04 3 1  ON 65
ci_67                -6.811568e-04 3 1  ON 66
ci_68                -2.561058e-04 3 1  ON 67
ci_69                -1.744052e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8198
    reference variance = 0.317773
====================================================
  Execution time = 2.5302e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9692e-01
  Total weights = 1.9631e+06
  Execution time = 3.5992e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479930591326
                                         uncertainty =       0.003574641021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479930591326
                                         uncertainty =       0.003574641021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489822389
  error estimate for blocks of size 2^( 2) =       0.000510604013
  error estimate for blocks of size 2^( 3) =       0.000531518839
  error estimate for blocks of size 2^( 4) =       0.000546495850
  error estimate for blocks of size 2^( 5) =       0.000556413804
  error estimate for blocks of size 2^( 6) =       0.000561571202
  error estimate for blocks of size 2^( 7) =       0.000564874173

      target function =      -0.707509556500
              le_mean =     -22.817030337091
             les_mean =     521.116194047197
             stat err =       0.000557338757
             autocorr =       1.294676383055
   target nu stat err =       0.000557338757
   target dn stat err =       0.004594651168
      target stat err =       0.003258279045
              std dev =       0.692713465187
             le_variance =       0.479851944852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480506208860
                                         uncertainty =       0.004355804605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480506208860
                                         uncertainty =       0.004355804605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490110144
  error estimate for blocks of size 2^( 2) =       0.000510877131
  error estimate for blocks of size 2^( 3) =       0.000531758834
  error estimate for blocks of size 2^( 4) =       0.000546732112
  error estimate for blocks of size 2^( 5) =       0.000556729448
  error estimate for blocks of size 2^( 6) =       0.000562065185
  error estimate for blocks of size 2^( 7) =       0.000565403886

      target function =      -0.078680043943
              le_mean =     -22.817089789675
             les_mean =     525.578585764877
             stat err =       0.000557732658
             autocorr =       1.294985085494
   target nu stat err =       0.000557732658
   target dn stat err =       4.458605706692
      target stat err =       0.064110665292
              std dev =       0.693120413188
             le_variance =       0.480415907178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478720468023
                                         uncertainty =       0.003533722271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478720468023
                                         uncertainty =       0.003533722271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489204494
  error estimate for blocks of size 2^( 2) =       0.000510000754
  error estimate for blocks of size 2^( 3) =       0.000530932908
  error estimate for blocks of size 2^( 4) =       0.000545926374
  error estimate for blocks of size 2^( 5) =       0.000555876433
  error estimate for blocks of size 2^( 6) =       0.000561044935
  error estimate for blocks of size 2^( 7) =       0.000564341746

      target function =      -0.684300159456
              le_mean =     -22.817030183031
             les_mean =     521.149357687983
             stat err =       0.000556797372
             autocorr =       1.295428587678
   target nu stat err =       0.000556797372
   target dn stat err =       0.035185019013
      target stat err =       0.023037193482
              std dev =       0.691839630514
             le_variance =       0.478642074350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479760728562
                                         uncertainty =       0.003569261554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479760728562
                                         uncertainty =       0.003569261554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489735705
  error estimate for blocks of size 2^( 2) =       0.000510518749
  error estimate for blocks of size 2^( 3) =       0.000531435569
  error estimate for blocks of size 2^( 4) =       0.000546415044
  error estimate for blocks of size 2^( 5) =       0.000556336931
  error estimate for blocks of size 2^( 6) =       0.000561496582
  error estimate for blocks of size 2^( 7) =       0.000564798783

      target function =      -0.708592159439
              le_mean =     -22.817028562664
             les_mean =     521.114568279045
             stat err =       0.000557261835
             autocorr =       1.294777264951
   target nu stat err =       0.000557261835
   target dn stat err =       0.004387549161
      target stat err =       0.003125069954
              std dev =       0.692590876159
             le_variance =       0.479682121739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.707509556500        initial
     2.4414e-01     2.4414e+00             3.5159e-03        -0.078680043943
     9.7656e-01     9.7656e+00             9.4506e-04        -0.684300159456
     3.9062e+00     3.9062e+01             2.4084e-04        -0.708592159439  <--

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.3373e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_01                 1.419181e-01 3 1  ON 0
ci_02                -3.882993e-02 3 1  ON 1
ci_03                -3.869552e-02 3 1  ON 2
ci_04                 3.519524e-02 3 1  ON 3
ci_05                -2.806924e-02 3 1  ON 4
ci_06                -2.736934e-02 3 1  ON 5
ci_07                 2.819778e-02 3 1  ON 6
ci_08                -9.871575e-03 3 1  ON 7
ci_09                -1.201636e-02 3 1  ON 8
ci_10                -1.180343e-02 3 1  ON 9
ci_11                 1.385882e-02 3 1  ON 10
ci_12                 9.232568e-03 3 1  ON 11
ci_13                 1.258875e-02 3 1  ON 12
ci_14                 1.233704e-02 3 1  ON 13
ci_15                 8.801854e-03 3 1  ON 14
ci_16                 8.759705e-03 3 1  ON 15
ci_17                -8.982220e-03 3 1  ON 16
ci_18                -8.451286e-03 3 1  ON 17
ci_19                 9.946227e-03 3 1  ON 18
ci_20                 7.844721e-03 3 1  ON 19
ci_21                 9.097784e-03 3 1  ON 20
ci_22                 9.209985e-03 3 1  ON 21
ci_23                 5.375087e-03 3 1  ON 22
ci_24                 4.876631e-03 3 1  ON 23
ci_25                 3.632558e-03 3 1  ON 24
ci_26                 3.689597e-03 3 1  ON 25
ci_27                 3.688358e-03 3 1  ON 26
ci_28                 2.752846e-03 3 1  ON 27
ci_29                 2.712712e-03 3 1  ON 28
ci_30                -2.211071e-03 3 1  ON 29
ci_31                -2.353016e-03 3 1  ON 30
ci_32                -1.737199e-03 3 1  ON 31
ci_33                -1.742813e-03 3 1  ON 32
ci_34                 1.570234e-03 3 1  ON 33
ci_35                 1.689375e-03 3 1  ON 34
ci_36                -1.510038e-03 3 1  ON 35
ci_37                -1.563334e-03 3 1  ON 36
ci_38                -1.069098e-03 3 1  ON 37
ci_39                -1.185833e-03 3 1  ON 38
ci_40                -1.675168e-03 3 1  ON 39
ci_41                -1.310847e-03 3 1  ON 40
ci_42                -1.057312e-03 3 1  ON 41
ci_43                -2.483030e-03 3 1  ON 42
ci_44                -1.684892e-03 3 1  ON 43
ci_45                -1.001611e-03 3 1  ON 44
ci_46                -8.902379e-04 3 1  ON 45
ci_47                -1.356699e-04 3 1  ON 46
ci_48                -2.957666e-04 3 1  ON 47
ci_49                -1.176693e-03 3 1  ON 48
ci_50                -9.283706e-04 3 1  ON 49
ci_51                 8.014563e-04 3 1  ON 50
ci_52                 7.113882e-04 3 1  ON 51
ci_53                -1.062903e-03 3 1  ON 52
ci_54                -9.328014e-04 3 1  ON 53
ci_55                -7.159236e-04 3 1  ON 54
ci_56                 1.688980e-03 3 1  ON 55
ci_57                 1.715552e-03 3 1  ON 56
ci_58                -9.569190e-04 3 1  ON 57
ci_59                -9.269515e-04 3 1  ON 58
ci_60                 7.687574e-04 3 1  ON 59
ci_61                 8.098592e-04 3 1  ON 60
ci_62                -5.722656e-04 3 1  ON 61
ci_63                -8.102417e-04 3 1  ON 62
ci_64                -5.968926e-04 3 1  ON 63
ci_65                -4.868100e-04 3 1  ON 64
ci_66                -8.383316e-04 3 1  ON 65
ci_67                -6.782425e-04 3 1  ON 66
ci_68                -2.852390e-04 3 1  ON 67
ci_69                -1.500552e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3677e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7866
    reference variance = 0.290658
====================================================
  Execution time = 2.7488e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9567e-01
  Total weights = 1.963578444e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476276100362
                                         uncertainty =       0.002489393115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476276100362
                                         uncertainty =       0.002489393115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487938690
  error estimate for blocks of size 2^( 2) =       0.000508960105
  error estimate for blocks of size 2^( 3) =       0.000528804224
  error estimate for blocks of size 2^( 4) =       0.000543976222
  error estimate for blocks of size 2^( 5) =       0.000552398951
  error estimate for blocks of size 2^( 6) =       0.000559553773
  error estimate for blocks of size 2^( 7) =       0.000566395813

      target function =      -0.710084395236
              le_mean =     -22.818676874682
             les_mean =     521.187680396208
             stat err =       0.000555581190
             autocorr =       1.296476221940
   target nu stat err =       0.000555581190
   target dn stat err =       0.006474950972
      target stat err =       0.004602491934
              std dev =       0.690049512616
             le_variance =       0.476168329861


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281867687468e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710113448887       residual = 2.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710287761879       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710315281404       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710319679137       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710321678078       residual = 7.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710321916750       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710322044240       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710322072016       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710322074340       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710322071031       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 8.076062e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710113448887       residual = 2.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710158570466       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710165607975       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710166715470       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710167211245       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710167264758       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710167294702       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710167301329       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710167301817       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710167301028       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.058160e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710113448887       residual = 2.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710124830014       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710126599457       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710126876800       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710127000458       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710127013441       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710127020804       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710127022441       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710127022557       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710127022363       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.170502e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.656744 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2082e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_01                 1.417123e-01 3 1  ON 0
ci_02                -3.866382e-02 3 1  ON 1
ci_03                -3.852755e-02 3 1  ON 2
ci_04                 3.501621e-02 3 1  ON 3
ci_05                -2.797350e-02 3 1  ON 4
ci_06                -2.727780e-02 3 1  ON 5
ci_07                 2.817448e-02 3 1  ON 6
ci_08                -9.793014e-03 3 1  ON 7
ci_09                -1.197353e-02 3 1  ON 8
ci_10                -1.175728e-02 3 1  ON 9
ci_11                 1.383214e-02 3 1  ON 10
ci_12                 9.199630e-03 3 1  ON 11
ci_13                 1.258485e-02 3 1  ON 12
ci_14                 1.235061e-02 3 1  ON 13
ci_15                 8.765115e-03 3 1  ON 14
ci_16                 8.733440e-03 3 1  ON 15
ci_17                -8.964515e-03 3 1  ON 16
ci_18                -8.429092e-03 3 1  ON 17
ci_19                 9.944469e-03 3 1  ON 18
ci_20                 7.812710e-03 3 1  ON 19
ci_21                 9.090356e-03 3 1  ON 20
ci_22                 9.194930e-03 3 1  ON 21
ci_23                 5.358107e-03 3 1  ON 22
ci_24                 4.866048e-03 3 1  ON 23
ci_25                 3.613504e-03 3 1  ON 24
ci_26                 3.688089e-03 3 1  ON 25
ci_27                 3.674686e-03 3 1  ON 26
ci_28                 2.725564e-03 3 1  ON 27
ci_29                 2.701383e-03 3 1  ON 28
ci_30                -2.197549e-03 3 1  ON 29
ci_31                -2.333365e-03 3 1  ON 30
ci_32                -1.725665e-03 3 1  ON 31
ci_33                -1.733814e-03 3 1  ON 32
ci_34                 1.557055e-03 3 1  ON 33
ci_35                 1.664003e-03 3 1  ON 34
ci_36                -1.503123e-03 3 1  ON 35
ci_37                -1.564178e-03 3 1  ON 36
ci_38                -1.063493e-03 3 1  ON 37
ci_39                -1.175228e-03 3 1  ON 38
ci_40                -1.665463e-03 3 1  ON 39
ci_41                -1.317588e-03 3 1  ON 40
ci_42                -1.077210e-03 3 1  ON 41
ci_43                -2.505810e-03 3 1  ON 42
ci_44                -1.681514e-03 3 1  ON 43
ci_45                -9.879128e-04 3 1  ON 44
ci_46                -8.865731e-04 3 1  ON 45
ci_47                -1.272281e-04 3 1  ON 46
ci_48                -2.809862e-04 3 1  ON 47
ci_49                -1.175442e-03 3 1  ON 48
ci_50                -9.209065e-04 3 1  ON 49
ci_51                 7.964763e-04 3 1  ON 50
ci_52                 7.078269e-04 3 1  ON 51
ci_53                -1.059275e-03 3 1  ON 52
ci_54                -9.386189e-04 3 1  ON 53
ci_55                -7.318983e-04 3 1  ON 54
ci_56                 1.695661e-03 3 1  ON 55
ci_57                 1.710582e-03 3 1  ON 56
ci_58                -9.440241e-04 3 1  ON 57
ci_59                -9.132997e-04 3 1  ON 58
ci_60                 7.730370e-04 3 1  ON 59
ci_61                 7.976936e-04 3 1  ON 60
ci_62                -5.715409e-04 3 1  ON 61
ci_63                -7.936336e-04 3 1  ON 62
ci_64                -5.939755e-04 3 1  ON 63
ci_65                -4.884585e-04 3 1  ON 64
ci_66                -8.349404e-04 3 1  ON 65
ci_67                -6.807485e-04 3 1  ON 66
ci_68                -2.904974e-04 3 1  ON 67
ci_69                -1.445870e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.8062
    reference variance = 0.37771
====================================================
  Execution time = 2.5187e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9224e-01
  Total weights = 1.9636e+06
  Execution time = 3.6016e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474239377546
                                         uncertainty =       0.002555574217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474239377546
                                         uncertainty =       0.002555574217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486915827
  error estimate for blocks of size 2^( 2) =       0.000507992769
  error estimate for blocks of size 2^( 3) =       0.000528284749
  error estimate for blocks of size 2^( 4) =       0.000543320824
  error estimate for blocks of size 2^( 5) =       0.000552527671
  error estimate for blocks of size 2^( 6) =       0.000556015174
  error estimate for blocks of size 2^( 7) =       0.000558146167

      target function =      -0.712456929404
              le_mean =     -22.817006668654
             les_mean =     521.108083532692
             stat err =       0.000552502459
             autocorr =       1.287539759241
   target nu stat err =       0.000552502459
   target dn stat err =       0.004629133834
      target stat err =       0.003326542888
              std dev =       0.688602965685
             le_variance =       0.474174044350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473710737999
                                         uncertainty =       0.002577623162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473710737999
                                         uncertainty =       0.002577623162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486644103
  error estimate for blocks of size 2^( 2) =       0.000507726441
  error estimate for blocks of size 2^( 3) =       0.000528028110
  error estimate for blocks of size 2^( 4) =       0.000543075586
  error estimate for blocks of size 2^( 5) =       0.000552301087
  error estimate for blocks of size 2^( 6) =       0.000555811632
  error estimate for blocks of size 2^( 7) =       0.000557941734

      target function =      -0.712205802447
              le_mean =     -22.817011524010
             les_mean =     521.108658414719
             stat err =       0.000552282510
             autocorr =       1.287951917311
   target nu stat err =       0.000552282510
   target dn stat err =       0.004769590484
      target stat err =       0.003422370318
              std dev =       0.688218690087
             le_variance =       0.473644965385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473958123520
                                         uncertainty =       0.002565977505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473958123520
                                         uncertainty =       0.002565977505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486771285
  error estimate for blocks of size 2^( 2) =       0.000507850961
  error estimate for blocks of size 2^( 3) =       0.000528147777
  error estimate for blocks of size 2^( 4) =       0.000543189582
  error estimate for blocks of size 2^( 5) =       0.000552406240
  error estimate for blocks of size 2^( 6) =       0.000555905395
  error estimate for blocks of size 2^( 7) =       0.000558035910

      target function =      -0.712394302452
              le_mean =     -22.817008174442
             les_mean =     521.108240123437
             stat err =       0.000552384282
             autocorr =       1.287753449323
   target nu stat err =       0.000552384282
   target dn stat err =       0.004688649920
      target stat err =       0.003367556934
              std dev =       0.688398553330
             le_variance =       0.473892568227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474202969720
                                         uncertainty =       0.002556775528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474202969720
                                         uncertainty =       0.002556775528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486897119
  error estimate for blocks of size 2^( 2) =       0.000507974398
  error estimate for blocks of size 2^( 3) =       0.000528266967
  error estimate for blocks of size 2^( 4) =       0.000543303755
  error estimate for blocks of size 2^( 5) =       0.000552511850
  error estimate for blocks of size 2^( 6) =       0.000556000807
  error estimate for blocks of size 2^( 7) =       0.000558131751

      target function =      -0.712472303446
              le_mean =     -22.817006730633
             les_mean =     521.108064610927
             stat err =       0.000552487041
             autocorr =       1.287566835485
   target nu stat err =       0.000552487041
   target dn stat err =       0.004635662315
      target stat err =       0.003331246106
              std dev =       0.688576509206
             le_variance =       0.474137609031


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.712456929404        initial
     9.7656e-01     9.7656e+00             8.0761e-04        -0.712205802447
     3.9062e+00     3.9062e+01             2.0582e-04        -0.712394302452
     1.5625e+01     1.5625e+02             5.1705e-05        -0.712472303446  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 4.3254e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_01                 1.418664e-01 3 1  ON 0
ci_02                -3.878806e-02 3 1  ON 1
ci_03                -3.865319e-02 3 1  ON 2
ci_04                 3.515007e-02 3 1  ON 3
ci_05                -2.804509e-02 3 1  ON 4
ci_06                -2.734625e-02 3 1  ON 5
ci_07                 2.819191e-02 3 1  ON 6
ci_08                -9.851759e-03 3 1  ON 7
ci_09                -1.200557e-02 3 1  ON 8
ci_10                -1.179181e-02 3 1  ON 9
ci_11                 1.385210e-02 3 1  ON 10
ci_12                 9.224263e-03 3 1  ON 11
ci_13                 1.258776e-02 3 1  ON 12
ci_14                 1.234045e-02 3 1  ON 13
ci_15                 8.792594e-03 3 1  ON 14
ci_16                 8.753085e-03 3 1  ON 15
ci_17                -8.977764e-03 3 1  ON 16
ci_18                -8.445697e-03 3 1  ON 17
ci_19                 9.945780e-03 3 1  ON 18
ci_20                 7.836647e-03 3 1  ON 19
ci_21                 9.095917e-03 3 1  ON 20
ci_22                 9.206201e-03 3 1  ON 21
ci_23                 5.370800e-03 3 1  ON 22
ci_24                 4.873968e-03 3 1  ON 23
ci_25                 3.627750e-03 3 1  ON 24
ci_26                 3.689215e-03 3 1  ON 25
ci_27                 3.684911e-03 3 1  ON 26
ci_28                 2.745973e-03 3 1  ON 27
ci_29                 2.709864e-03 3 1  ON 28
ci_30                -2.207673e-03 3 1  ON 29
ci_31                -2.348078e-03 3 1  ON 30
ci_32                -1.734283e-03 3 1  ON 31
ci_33                -1.740537e-03 3 1  ON 32
ci_34                 1.566901e-03 3 1  ON 33
ci_35                 1.682971e-03 3 1  ON 34
ci_36                -1.508295e-03 3 1  ON 35
ci_37                -1.563549e-03 3 1  ON 36
ci_38                -1.067685e-03 3 1  ON 37
ci_39                -1.183160e-03 3 1  ON 38
ci_40                -1.672720e-03 3 1  ON 39
ci_41                -1.312543e-03 3 1  ON 40
ci_42                -1.062323e-03 3 1  ON 41
ci_43                -2.488777e-03 3 1  ON 42
ci_44                -1.684049e-03 3 1  ON 43
ci_45                -9.981547e-04 3 1  ON 44
ci_46                -8.893146e-04 3 1  ON 45
ci_47                -1.335522e-04 3 1  ON 46
ci_48                -2.920498e-04 3 1  ON 47
ci_49                -1.176380e-03 3 1  ON 48
ci_50                -9.264868e-04 3 1  ON 49
ci_51                 8.002015e-04 3 1  ON 50
ci_52                 7.104911e-04 3 1  ON 51
ci_53                -1.061988e-03 3 1  ON 52
ci_54                -9.342667e-04 3 1  ON 53
ci_55                -7.199489e-04 3 1  ON 54
ci_56                 1.690665e-03 3 1  ON 55
ci_57                 1.714297e-03 3 1  ON 56
ci_58                -9.536672e-04 3 1  ON 57
ci_59                -9.235085e-04 3 1  ON 58
ci_60                 7.698336e-04 3 1  ON 59
ci_61                 8.068034e-04 3 1  ON 60
ci_62                -5.720838e-04 3 1  ON 61
ci_63                -8.060523e-04 3 1  ON 62
ci_64                -5.961571e-04 3 1  ON 63
ci_65                -4.872267e-04 3 1  ON 64
ci_66                -8.374758e-04 3 1  ON 65
ci_67                -6.788743e-04 3 1  ON 66
ci_68                -2.865648e-04 3 1  ON 67
ci_69                -1.486765e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5342e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.8088
    reference variance = 0.319248
====================================================
  Execution time = 2.5751e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 5.0202e-01
  Total weights = 1.963780401e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480880940319
                                         uncertainty =       0.004439974020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480880940319
                                         uncertainty =       0.004439974020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490307996
  error estimate for blocks of size 2^( 2) =       0.000510701552
  error estimate for blocks of size 2^( 3) =       0.000530648753
  error estimate for blocks of size 2^( 4) =       0.000545675705
  error estimate for blocks of size 2^( 5) =       0.000554321685
  error estimate for blocks of size 2^( 6) =       0.000559158700
  error estimate for blocks of size 2^( 7) =       0.000562760504

      target function =      -0.705618808657
              le_mean =     -22.817230502477
             les_mean =     521.128026307684
             stat err =       0.000555479148
             autocorr =       1.283505014277
   target nu stat err =       0.000555479148
   target dn stat err =       0.006275848054
      target stat err =       0.004398573404
              std dev =       0.693400218241
             le_variance =       0.480803862656


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281723050248e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705645103940       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705684801123       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705691021502       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705692261584       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705692523225       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705692632679       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705692682415       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705692680870       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705692680886       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705692680820       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705692682300       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 1.887010e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705645103940       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705655115756       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705656679564       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705656990275       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705657055296       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705657082413       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705657094678       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705657094280       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705657094283       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705657094268       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705657094634       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 4.740177e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705645103940       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705647612424       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705648003923       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705648081643       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705648097874       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705648104638       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705648107693       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705648107593       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705648107594       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705648107590       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.705648107681       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 1.186469e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.660806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0347e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_01                 1.418190e-01 3 1  ON 0
ci_02                -3.875534e-02 3 1  ON 1
ci_03                -3.861733e-02 3 1  ON 2
ci_04                 3.510896e-02 3 1  ON 3
ci_05                -2.801812e-02 3 1  ON 4
ci_06                -2.731890e-02 3 1  ON 5
ci_07                 2.818680e-02 3 1  ON 6
ci_08                -9.834267e-03 3 1  ON 7
ci_09                -1.199272e-02 3 1  ON 8
ci_10                -1.177815e-02 3 1  ON 9
ci_11                 1.383978e-02 3 1  ON 10
ci_12                 9.213906e-03 3 1  ON 11
ci_13                 1.258836e-02 3 1  ON 12
ci_14                 1.234611e-02 3 1  ON 13
ci_15                 8.783351e-03 3 1  ON 14
ci_16                 8.739452e-03 3 1  ON 15
ci_17                -8.972415e-03 3 1  ON 16
ci_18                -8.438056e-03 3 1  ON 17
ci_19                 9.941400e-03 3 1  ON 18
ci_20                 7.836748e-03 3 1  ON 19
ci_21                 9.096380e-03 3 1  ON 20
ci_22                 9.207391e-03 3 1  ON 21
ci_23                 5.367490e-03 3 1  ON 22
ci_24                 4.864490e-03 3 1  ON 23
ci_25                 3.622365e-03 3 1  ON 24
ci_26                 3.680233e-03 3 1  ON 25
ci_27                 3.682636e-03 3 1  ON 26
ci_28                 2.740608e-03 3 1  ON 27
ci_29                 2.701411e-03 3 1  ON 28
ci_30                -2.209626e-03 3 1  ON 29
ci_31                -2.344913e-03 3 1  ON 30
ci_32                -1.730830e-03 3 1  ON 31
ci_33                -1.738196e-03 3 1  ON 32
ci_34                 1.559904e-03 3 1  ON 33
ci_35                 1.679887e-03 3 1  ON 34
ci_36                -1.505404e-03 3 1  ON 35
ci_37                -1.561546e-03 3 1  ON 36
ci_38                -1.064932e-03 3 1  ON 37
ci_39                -1.180817e-03 3 1  ON 38
ci_40                -1.670451e-03 3 1  ON 39
ci_41                -1.309690e-03 3 1  ON 40
ci_42                -1.062215e-03 3 1  ON 41
ci_43                -2.487148e-03 3 1  ON 42
ci_44                -1.686916e-03 3 1  ON 43
ci_45                -9.975359e-04 3 1  ON 44
ci_46                -8.882188e-04 3 1  ON 45
ci_47                -1.291952e-04 3 1  ON 46
ci_48                -2.867198e-04 3 1  ON 47
ci_49                -1.175684e-03 3 1  ON 48
ci_50                -9.252359e-04 3 1  ON 49
ci_51                 7.996144e-04 3 1  ON 50
ci_52                 7.082870e-04 3 1  ON 51
ci_53                -1.061524e-03 3 1  ON 52
ci_54                -9.330833e-04 3 1  ON 53
ci_55                -7.144396e-04 3 1  ON 54
ci_56                 1.692088e-03 3 1  ON 55
ci_57                 1.717683e-03 3 1  ON 56
ci_58                -9.556009e-04 3 1  ON 57
ci_59                -9.212980e-04 3 1  ON 58
ci_60                 7.762712e-04 3 1  ON 59
ci_61                 8.075018e-04 3 1  ON 60
ci_62                -5.722064e-04 3 1  ON 61
ci_63                -8.045028e-04 3 1  ON 62
ci_64                -5.971326e-04 3 1  ON 63
ci_65                -4.895628e-04 3 1  ON 64
ci_66                -8.365421e-04 3 1  ON 65
ci_67                -6.800184e-04 3 1  ON 66
ci_68                -2.879062e-04 3 1  ON 67
ci_69                -1.522133e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.9725
    reference variance = 0.569624
====================================================
  Execution time = 2.5063e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 5.0780e-01
  Total weights = 1.9635e+06
  Execution time = 3.6055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473923097441
                                         uncertainty =       0.002532242406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473923097441
                                         uncertainty =       0.002532242406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486783642
  error estimate for blocks of size 2^( 2) =       0.000508155840
  error estimate for blocks of size 2^( 3) =       0.000528248412
  error estimate for blocks of size 2^( 4) =       0.000543067444
  error estimate for blocks of size 2^( 5) =       0.000552686050
  error estimate for blocks of size 2^( 6) =       0.000560727547
  error estimate for blocks of size 2^( 7) =       0.000565717074

      target function =      -0.700961441501
              le_mean =     -22.816665362801
             les_mean =     521.108680643559
             stat err =       0.000555549529
             autocorr =       1.302487652131
   target nu stat err =       0.000555549529
   target dn stat err =       0.018453128791
      target stat err =       0.012669221980
              std dev =       0.688416029138
             le_variance =       0.473916629174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473758278236
                                         uncertainty =       0.002528355979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473758278236
                                         uncertainty =       0.002528355979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486698996
  error estimate for blocks of size 2^( 2) =       0.000508072895
  error estimate for blocks of size 2^( 3) =       0.000528168671
  error estimate for blocks of size 2^( 4) =       0.000542990271
  error estimate for blocks of size 2^( 5) =       0.000552611079
  error estimate for blocks of size 2^( 6) =       0.000560659680
  error estimate for blocks of size 2^( 7) =       0.000565649221

      target function =      -0.701281185511
              le_mean =     -22.816665919445
             les_mean =     521.108259637612
             stat err =       0.000555477563
             autocorr =       1.302603201872
   target nu stat err =       0.000555477563
   target dn stat err =       0.017895732386
      target stat err =       0.012298222873
              std dev =       0.688296321194
             le_variance =       0.473751825769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473839568442
                                         uncertainty =       0.002530267225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473839568442
                                         uncertainty =       0.002530267225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486740746
  error estimate for blocks of size 2^( 2) =       0.000508113800
  error estimate for blocks of size 2^( 3) =       0.000528207955
  error estimate for blocks of size 2^( 4) =       0.000543028288
  error estimate for blocks of size 2^( 5) =       0.000552648032
  error estimate for blocks of size 2^( 6) =       0.000560693159
  error estimate for blocks of size 2^( 7) =       0.000565682539

      target function =      -0.701595174467
              le_mean =     -22.816665598928
             les_mean =     521.107778427689
             stat err =       0.000555513004
             autocorr =       1.302545948898
   target nu stat err =       0.000555513004
   target dn stat err =       0.018155264304
      target stat err =       0.012487506332
              std dev =       0.688355364770
             le_variance =       0.473833108208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473912664366
                                         uncertainty =       0.002531991946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473912664366
                                         uncertainty =       0.002531991946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486778285
  error estimate for blocks of size 2^( 2) =       0.000508150511
  error estimate for blocks of size 2^( 3) =       0.000528243634
  error estimate for blocks of size 2^( 4) =       0.000543062772
  error estimate for blocks of size 2^( 5) =       0.000552680929
  error estimate for blocks of size 2^( 6) =       0.000560722986
  error estimate for blocks of size 2^( 7) =       0.000565713883

      target function =      -0.638087886371
              le_mean =     -22.816665195457
             les_mean =     521.201588911240
             stat err =       0.000555545142
             autocorr =       1.302495755800
   target nu stat err =       0.000555545142
   target dn stat err =       0.095325181324
      target stat err =       0.054562905466
              std dev =       0.688408452264
             le_variance =       0.473906197148


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.700961441501        initial
     3.9062e+00     3.9062e+01             1.8870e-04        -0.701281185511
     1.5625e+01     1.5625e+02             4.7402e-05        -0.701595174467  <--
     6.2500e+01     6.2500e+02             1.1865e-05        -0.638087886371

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 4.3163e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_01                 1.418190e-01 3 1  ON 0
ci_02                -3.875534e-02 3 1  ON 1
ci_03                -3.861733e-02 3 1  ON 2
ci_04                 3.510896e-02 3 1  ON 3
ci_05                -2.801812e-02 3 1  ON 4
ci_06                -2.731890e-02 3 1  ON 5
ci_07                 2.818680e-02 3 1  ON 6
ci_08                -9.834267e-03 3 1  ON 7
ci_09                -1.199272e-02 3 1  ON 8
ci_10                -1.177815e-02 3 1  ON 9
ci_11                 1.383978e-02 3 1  ON 10
ci_12                 9.213906e-03 3 1  ON 11
ci_13                 1.258836e-02 3 1  ON 12
ci_14                 1.234611e-02 3 1  ON 13
ci_15                 8.783351e-03 3 1  ON 14
ci_16                 8.739452e-03 3 1  ON 15
ci_17                -8.972415e-03 3 1  ON 16
ci_18                -8.438056e-03 3 1  ON 17
ci_19                 9.941400e-03 3 1  ON 18
ci_20                 7.836748e-03 3 1  ON 19
ci_21                 9.096380e-03 3 1  ON 20
ci_22                 9.207391e-03 3 1  ON 21
ci_23                 5.367490e-03 3 1  ON 22
ci_24                 4.864490e-03 3 1  ON 23
ci_25                 3.622365e-03 3 1  ON 24
ci_26                 3.680233e-03 3 1  ON 25
ci_27                 3.682636e-03 3 1  ON 26
ci_28                 2.740608e-03 3 1  ON 27
ci_29                 2.701411e-03 3 1  ON 28
ci_30                -2.209626e-03 3 1  ON 29
ci_31                -2.344913e-03 3 1  ON 30
ci_32                -1.730830e-03 3 1  ON 31
ci_33                -1.738196e-03 3 1  ON 32
ci_34                 1.559904e-03 3 1  ON 33
ci_35                 1.679887e-03 3 1  ON 34
ci_36                -1.505404e-03 3 1  ON 35
ci_37                -1.561546e-03 3 1  ON 36
ci_38                -1.064932e-03 3 1  ON 37
ci_39                -1.180817e-03 3 1  ON 38
ci_40                -1.670451e-03 3 1  ON 39
ci_41                -1.309690e-03 3 1  ON 40
ci_42                -1.062215e-03 3 1  ON 41
ci_43                -2.487148e-03 3 1  ON 42
ci_44                -1.686916e-03 3 1  ON 43
ci_45                -9.975359e-04 3 1  ON 44
ci_46                -8.882188e-04 3 1  ON 45
ci_47                -1.291952e-04 3 1  ON 46
ci_48                -2.867198e-04 3 1  ON 47
ci_49                -1.175684e-03 3 1  ON 48
ci_50                -9.252359e-04 3 1  ON 49
ci_51                 7.996144e-04 3 1  ON 50
ci_52                 7.082870e-04 3 1  ON 51
ci_53                -1.061524e-03 3 1  ON 52
ci_54                -9.330833e-04 3 1  ON 53
ci_55                -7.144396e-04 3 1  ON 54
ci_56                 1.692088e-03 3 1  ON 55
ci_57                 1.717683e-03 3 1  ON 56
ci_58                -9.556009e-04 3 1  ON 57
ci_59                -9.212980e-04 3 1  ON 58
ci_60                 7.762712e-04 3 1  ON 59
ci_61                 8.075018e-04 3 1  ON 60
ci_62                -5.722064e-04 3 1  ON 61
ci_63                -8.045028e-04 3 1  ON 62
ci_64                -5.971326e-04 3 1  ON 63
ci_65                -4.895628e-04 3 1  ON 64
ci_66                -8.365421e-04 3 1  ON 65
ci_67                -6.800184e-04 3 1  ON 66
ci_68                -2.879062e-04 3 1  ON 67
ci_69                -1.522133e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3516e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7874
    reference variance = 0.506159
====================================================
  Execution time = 2.5898e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8755e-01
  Total weights = 1.963646371e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474638627293
                                         uncertainty =       0.002224746410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474638627293
                                         uncertainty =       0.002224746410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487169890
  error estimate for blocks of size 2^( 2) =       0.000508105654
  error estimate for blocks of size 2^( 3) =       0.000527940173
  error estimate for blocks of size 2^( 4) =       0.000542575553
  error estimate for blocks of size 2^( 5) =       0.000552144193
  error estimate for blocks of size 2^( 6) =       0.000555910480
  error estimate for blocks of size 2^( 7) =       0.000559483334

      target function =      -0.715863942865
              le_mean =     -22.817965398660
             les_mean =     521.147098049813
             stat err =       0.000552528390
             autocorr =       1.286317917427
   target nu stat err =       0.000552528390
   target dn stat err =       0.002659661741
      target stat err =       0.001984207256
              std dev =       0.688962264959
             le_variance =       0.474669002537


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281796539866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.715868614030       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.715911726161       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.715918600087       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.715919678907       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.715920041085       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.715920133291       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.715920164604       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.715920168600       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.715920170584       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.715920170410       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.051631e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.715868614030       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.715879490148       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.715881218653       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.715881488752       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.715881578951       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.715881601743       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.715881609457       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.715881610442       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.715881610931       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.715881610887       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.155100e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.715868614030       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.715871339259       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.715871772015       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.715871839564       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.715871862092       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.715871867773       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.715871869695       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.715871869940       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.715871870062       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.715871870051       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 1.290413e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.664323 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0521e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_01                 1.417675e-01 3 1  ON 0
ci_02                -3.871638e-02 3 1  ON 1
ci_03                -3.857568e-02 3 1  ON 2
ci_04                 3.506488e-02 3 1  ON 3
ci_05                -2.799203e-02 3 1  ON 4
ci_06                -2.729366e-02 3 1  ON 5
ci_07                 2.817920e-02 3 1  ON 6
ci_08                -9.817635e-03 3 1  ON 7
ci_09                -1.198241e-02 3 1  ON 8
ci_10                -1.176897e-02 3 1  ON 9
ci_11                 1.383783e-02 3 1  ON 10
ci_12                 9.208806e-03 3 1  ON 11
ci_13                 1.258695e-02 3 1  ON 12
ci_14                 1.234357e-02 3 1  ON 13
ci_15                 8.775897e-03 3 1  ON 14
ci_16                 8.729671e-03 3 1  ON 15
ci_17                -8.962632e-03 3 1  ON 16
ci_18                -8.432408e-03 3 1  ON 17
ci_19                 9.938104e-03 3 1  ON 18
ci_20                 7.835050e-03 3 1  ON 19
ci_21                 9.094356e-03 3 1  ON 20
ci_22                 9.206802e-03 3 1  ON 21
ci_23                 5.367344e-03 3 1  ON 22
ci_24                 4.862819e-03 3 1  ON 23
ci_25                 3.619096e-03 3 1  ON 24
ci_26                 3.677877e-03 3 1  ON 25
ci_27                 3.679778e-03 3 1  ON 26
ci_28                 2.740068e-03 3 1  ON 27
ci_29                 2.698293e-03 3 1  ON 28
ci_30                -2.204052e-03 3 1  ON 29
ci_31                -2.341808e-03 3 1  ON 30
ci_32                -1.723711e-03 3 1  ON 31
ci_33                -1.735185e-03 3 1  ON 32
ci_34                 1.556656e-03 3 1  ON 33
ci_35                 1.678064e-03 3 1  ON 34
ci_36                -1.501923e-03 3 1  ON 35
ci_37                -1.559207e-03 3 1  ON 36
ci_38                -1.064720e-03 3 1  ON 37
ci_39                -1.177973e-03 3 1  ON 38
ci_40                -1.668900e-03 3 1  ON 39
ci_41                -1.304101e-03 3 1  ON 40
ci_42                -1.059496e-03 3 1  ON 41
ci_43                -2.486509e-03 3 1  ON 42
ci_44                -1.684808e-03 3 1  ON 43
ci_45                -9.954744e-04 3 1  ON 44
ci_46                -8.865961e-04 3 1  ON 45
ci_47                -1.274229e-04 3 1  ON 46
ci_48                -2.859647e-04 3 1  ON 47
ci_49                -1.171623e-03 3 1  ON 48
ci_50                -9.239970e-04 3 1  ON 49
ci_51                 7.977915e-04 3 1  ON 50
ci_52                 7.065096e-04 3 1  ON 51
ci_53                -1.061897e-03 3 1  ON 52
ci_54                -9.300505e-04 3 1  ON 53
ci_55                -7.176264e-04 3 1  ON 54
ci_56                 1.692753e-03 3 1  ON 55
ci_57                 1.716480e-03 3 1  ON 56
ci_58                -9.568974e-04 3 1  ON 57
ci_59                -9.190601e-04 3 1  ON 58
ci_60                 7.752860e-04 3 1  ON 59
ci_61                 8.067906e-04 3 1  ON 60
ci_62                -5.735493e-04 3 1  ON 61
ci_63                -8.046568e-04 3 1  ON 62
ci_64                -5.950329e-04 3 1  ON 63
ci_65                -4.923784e-04 3 1  ON 64
ci_66                -8.353246e-04 3 1  ON 65
ci_67                -6.811688e-04 3 1  ON 66
ci_68                -2.907893e-04 3 1  ON 67
ci_69                -1.541026e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.8525
    reference variance = 0.594387
====================================================
  Execution time = 2.5190e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8871e-01
  Total weights = 1.9635e+06
  Execution time = 3.5864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474038770168
                                         uncertainty =       0.002273764289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474038770168
                                         uncertainty =       0.002273764289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486798962
  error estimate for blocks of size 2^( 2) =       0.000507887191
  error estimate for blocks of size 2^( 3) =       0.000527700197
  error estimate for blocks of size 2^( 4) =       0.000542295234
  error estimate for blocks of size 2^( 5) =       0.000552457134
  error estimate for blocks of size 2^( 6) =       0.000557278198
  error estimate for blocks of size 2^( 7) =       0.000561349937

      target function =      -0.715061707143
              le_mean =     -22.817971294141
             les_mean =     521.148487066363
             stat err =       0.000553345126
             autocorr =       1.292090374402
   target nu stat err =       0.000553345126
   target dn stat err =       0.002856011009
      target stat err =       0.002115322370
              std dev =       0.688437693761
             le_variance =       0.473946458190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473877964904
                                         uncertainty =       0.002269157842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473877964904
                                         uncertainty =       0.002269157842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486716394
  error estimate for blocks of size 2^( 2) =       0.000507806576
  error estimate for blocks of size 2^( 3) =       0.000527622110
  error estimate for blocks of size 2^( 4) =       0.000542219458
  error estimate for blocks of size 2^( 5) =       0.000552384210
  error estimate for blocks of size 2^( 6) =       0.000557199475
  error estimate for blocks of size 2^( 7) =       0.000561270545

      target function =      -0.712535666543
              le_mean =     -22.817969725127
             les_mean =     521.151946902876
             stat err =       0.000553268422
             autocorr =       1.292170489028
   target nu stat err =       0.000553268422
   target dn stat err =       0.004777488093
      target stat err =       0.003435781664
              std dev =       0.688320924943
             le_variance =       0.473785695715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473957237111
                                         uncertainty =       0.002271426307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473957237111
                                         uncertainty =       0.002271426307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486757099
  error estimate for blocks of size 2^( 2) =       0.000507846266
  error estimate for blocks of size 2^( 3) =       0.000527660746
  error estimate for blocks of size 2^( 4) =       0.000542257019
  error estimate for blocks of size 2^( 5) =       0.000552419395
  error estimate for blocks of size 2^( 6) =       0.000557237640
  error estimate for blocks of size 2^( 7) =       0.000561308584

      target function =      -0.714832730986
              le_mean =     -22.817970218493
             les_mean =     521.148758118322
             stat err =       0.000553305660
             autocorr =       1.292128293662
   target nu stat err =       0.000553305660
   target dn stat err =       0.002896387928
      target stat err =       0.002141856166
              std dev =       0.688378491320
             le_variance =       0.473864947312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474028511317
                                         uncertainty =       0.002273469969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474028511317
                                         uncertainty =       0.002273469969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486793695
  error estimate for blocks of size 2^( 2) =       0.000507882042
  error estimate for blocks of size 2^( 3) =       0.000527695227
  error estimate for blocks of size 2^( 4) =       0.000542290417
  error estimate for blocks of size 2^( 5) =       0.000552452395
  error estimate for blocks of size 2^( 6) =       0.000557273103
  error estimate for blocks of size 2^( 7) =       0.000561344750

      target function =      -0.715060224211
              le_mean =     -22.817971155789
             les_mean =     521.148482824289
             stat err =       0.000553340166
             autocorr =       1.292095171688
   target nu stat err =       0.000553340166
   target dn stat err =       0.002855692324
      target stat err =       0.002115092296
              std dev =       0.688430244934
             le_variance =       0.473936202140


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.715061707143        initial  <--
     3.9062e+00     3.9062e+01             2.0516e-04        -0.712535666543
     1.5625e+01     1.5625e+02             5.1551e-05        -0.714832730986
     6.2500e+01     6.2500e+02             1.2904e-05        -0.715060224211

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.1849
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_01                 1.418190e-01 3 1  ON 0
ci_02                -3.875534e-02 3 1  ON 1
ci_03                -3.861733e-02 3 1  ON 2
ci_04                 3.510896e-02 3 1  ON 3
ci_05                -2.801812e-02 3 1  ON 4
ci_06                -2.731890e-02 3 1  ON 5
ci_07                 2.818680e-02 3 1  ON 6
ci_08                -9.834267e-03 3 1  ON 7
ci_09                -1.199272e-02 3 1  ON 8
ci_10                -1.177815e-02 3 1  ON 9
ci_11                 1.383978e-02 3 1  ON 10
ci_12                 9.213906e-03 3 1  ON 11
ci_13                 1.258836e-02 3 1  ON 12
ci_14                 1.234611e-02 3 1  ON 13
ci_15                 8.783351e-03 3 1  ON 14
ci_16                 8.739452e-03 3 1  ON 15
ci_17                -8.972415e-03 3 1  ON 16
ci_18                -8.438056e-03 3 1  ON 17
ci_19                 9.941400e-03 3 1  ON 18
ci_20                 7.836748e-03 3 1  ON 19
ci_21                 9.096380e-03 3 1  ON 20
ci_22                 9.207391e-03 3 1  ON 21
ci_23                 5.367490e-03 3 1  ON 22
ci_24                 4.864490e-03 3 1  ON 23
ci_25                 3.622365e-03 3 1  ON 24
ci_26                 3.680233e-03 3 1  ON 25
ci_27                 3.682636e-03 3 1  ON 26
ci_28                 2.740608e-03 3 1  ON 27
ci_29                 2.701411e-03 3 1  ON 28
ci_30                -2.209626e-03 3 1  ON 29
ci_31                -2.344913e-03 3 1  ON 30
ci_32                -1.730830e-03 3 1  ON 31
ci_33                -1.738196e-03 3 1  ON 32
ci_34                 1.559904e-03 3 1  ON 33
ci_35                 1.679887e-03 3 1  ON 34
ci_36                -1.505404e-03 3 1  ON 35
ci_37                -1.561546e-03 3 1  ON 36
ci_38                -1.064932e-03 3 1  ON 37
ci_39                -1.180817e-03 3 1  ON 38
ci_40                -1.670451e-03 3 1  ON 39
ci_41                -1.309690e-03 3 1  ON 40
ci_42                -1.062215e-03 3 1  ON 41
ci_43                -2.487148e-03 3 1  ON 42
ci_44                -1.686916e-03 3 1  ON 43
ci_45                -9.975359e-04 3 1  ON 44
ci_46                -8.882188e-04 3 1  ON 45
ci_47                -1.291952e-04 3 1  ON 46
ci_48                -2.867198e-04 3 1  ON 47
ci_49                -1.175684e-03 3 1  ON 48
ci_50                -9.252359e-04 3 1  ON 49
ci_51                 7.996144e-04 3 1  ON 50
ci_52                 7.082870e-04 3 1  ON 51
ci_53                -1.061524e-03 3 1  ON 52
ci_54                -9.330833e-04 3 1  ON 53
ci_55                -7.144396e-04 3 1  ON 54
ci_56                 1.692088e-03 3 1  ON 55
ci_57                 1.717683e-03 3 1  ON 56
ci_58                -9.556009e-04 3 1  ON 57
ci_59                -9.212980e-04 3 1  ON 58
ci_60                 7.762712e-04 3 1  ON 59
ci_61                 8.075018e-04 3 1  ON 60
ci_62                -5.722064e-04 3 1  ON 61
ci_63                -8.045028e-04 3 1  ON 62
ci_64                -5.971326e-04 3 1  ON 63
ci_65                -4.895628e-04 3 1  ON 64
ci_66                -8.365421e-04 3 1  ON 65
ci_67                -6.800184e-04 3 1  ON 66
ci_68                -2.879062e-04 3 1  ON 67
ci_69                -1.522133e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3712e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.79
    reference variance = 0.511503
====================================================
  Execution time = 2.5820e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5360e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8830e-01
  Total weights = 1.963635865e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475369422857
                                         uncertainty =       0.002131279264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475369422857
                                         uncertainty =       0.002131279264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487582956
  error estimate for blocks of size 2^( 2) =       0.000508105002
  error estimate for blocks of size 2^( 3) =       0.000527833211
  error estimate for blocks of size 2^( 4) =       0.000542483100
  error estimate for blocks of size 2^( 5) =       0.000551550183
  error estimate for blocks of size 2^( 6) =       0.000556333249
  error estimate for blocks of size 2^( 7) =       0.000556915307

      target function =      -0.715334824824
              le_mean =     -22.818114892412
             les_mean =     521.154664910305
             stat err =       0.000551820460
             autocorr =       1.280850865982
   target nu stat err =       0.000551820460
   target dn stat err =       0.002516713993
      target stat err =       0.001883580027
              std dev =       0.689546428532
             le_variance =       0.475474277101


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281811489241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.715339020453       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.715343489785       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.715344176121       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.715344285813       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.715344320663       residual = 7.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.715344331576       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.715344335082       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.715344334901       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.715344335017       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.715344334922       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 1.928484e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.715339020453       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.715340138792       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.715340310478       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.715340337907       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.715340346617       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.715340349341       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.715340350216       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.715340350171       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.715340350200       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.715340350176       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 4.823648e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.715339020453       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.715339300101       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.715339343029       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.715339349886       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.715339352064       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.715339352745       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.715339352962       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.715339352953       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.715339352959       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.715339352953       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 1.206065e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.667817 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0429e+01
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_01                 1.418142e-01 3 1  ON 0
ci_02                -3.875110e-02 3 1  ON 1
ci_03                -3.861320e-02 3 1  ON 2
ci_04                 3.510429e-02 3 1  ON 3
ci_05                -2.801535e-02 3 1  ON 4
ci_06                -2.731659e-02 3 1  ON 5
ci_07                 2.818630e-02 3 1  ON 6
ci_08                -9.832487e-03 3 1  ON 7
ci_09                -1.199149e-02 3 1  ON 8
ci_10                -1.177674e-02 3 1  ON 9
ci_11                 1.383938e-02 3 1  ON 10
ci_12                 9.213328e-03 3 1  ON 11
ci_13                 1.258866e-02 3 1  ON 12
ci_14                 1.234632e-02 3 1  ON 13
ci_15                 8.782249e-03 3 1  ON 14
ci_16                 8.738645e-03 3 1  ON 15
ci_17                -8.971613e-03 3 1  ON 16
ci_18                -8.437644e-03 3 1  ON 17
ci_19                 9.940908e-03 3 1  ON 18
ci_20                 7.836256e-03 3 1  ON 19
ci_21                 9.096458e-03 3 1  ON 20
ci_22                 9.207752e-03 3 1  ON 21
ci_23                 5.367012e-03 3 1  ON 22
ci_24                 4.864537e-03 3 1  ON 23
ci_25                 3.622311e-03 3 1  ON 24
ci_26                 3.679888e-03 3 1  ON 25
ci_27                 3.682323e-03 3 1  ON 26
ci_28                 2.740167e-03 3 1  ON 27
ci_29                 2.701165e-03 3 1  ON 28
ci_30                -2.209325e-03 3 1  ON 29
ci_31                -2.344627e-03 3 1  ON 30
ci_32                -1.730635e-03 3 1  ON 31
ci_33                -1.738131e-03 3 1  ON 32
ci_34                 1.559437e-03 3 1  ON 33
ci_35                 1.679755e-03 3 1  ON 34
ci_36                -1.505195e-03 3 1  ON 35
ci_37                -1.561443e-03 3 1  ON 36
ci_38                -1.064805e-03 3 1  ON 37
ci_39                -1.180548e-03 3 1  ON 38
ci_40                -1.670364e-03 3 1  ON 39
ci_41                -1.309728e-03 3 1  ON 40
ci_42                -1.062231e-03 3 1  ON 41
ci_43                -2.487262e-03 3 1  ON 42
ci_44                -1.687190e-03 3 1  ON 43
ci_45                -9.974815e-04 3 1  ON 44
ci_46                -8.878867e-04 3 1  ON 45
ci_47                -1.287556e-04 3 1  ON 46
ci_48                -2.865725e-04 3 1  ON 47
ci_49                -1.175764e-03 3 1  ON 48
ci_50                -9.250988e-04 3 1  ON 49
ci_51                 7.993833e-04 3 1  ON 50
ci_52                 7.081632e-04 3 1  ON 51
ci_53                -1.061354e-03 3 1  ON 52
ci_54                -9.330407e-04 3 1  ON 53
ci_55                -7.143392e-04 3 1  ON 54
ci_56                 1.692330e-03 3 1  ON 55
ci_57                 1.717601e-03 3 1  ON 56
ci_58                -9.557186e-04 3 1  ON 57
ci_59                -9.215949e-04 3 1  ON 58
ci_60                 7.761816e-04 3 1  ON 59
ci_61                 8.076376e-04 3 1  ON 60
ci_62                -5.720759e-04 3 1  ON 61
ci_63                -8.043807e-04 3 1  ON 62
ci_64                -5.971692e-04 3 1  ON 63
ci_65                -4.893542e-04 3 1  ON 64
ci_66                -8.363554e-04 3 1  ON 65
ci_67                -6.801383e-04 3 1  ON 66
ci_68                -2.879828e-04 3 1  ON 67
ci_69                -1.525966e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.8431
    reference variance = 0.393908
====================================================
  Execution time = 2.5192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9856e-01
  Total weights = 1.9635e+06
  Execution time = 3.6074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481300610855
                                         uncertainty =       0.002919620463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481300610855
                                         uncertainty =       0.002919620463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490592142
  error estimate for blocks of size 2^( 2) =       0.000511726385
  error estimate for blocks of size 2^( 3) =       0.000531185850
  error estimate for blocks of size 2^( 4) =       0.000545608209
  error estimate for blocks of size 2^( 5) =       0.000554915512
  error estimate for blocks of size 2^( 6) =       0.000560727185
  error estimate for blocks of size 2^( 7) =       0.000564904193

      target function =      -0.708021865172
              le_mean =     -22.817434925214
             les_mean =     521.133925029727
             stat err =       0.000556538775
             autocorr =       1.286914458788
   target nu stat err =       0.000556538775
   target dn stat err =       0.005383258501
      target stat err =       0.003810206865
              std dev =       0.693802060666
             le_variance =       0.481361299384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481287639142
                                         uncertainty =       0.002920612904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481287639142
                                         uncertainty =       0.002920612904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490585541
  error estimate for blocks of size 2^( 2) =       0.000511719878
  error estimate for blocks of size 2^( 3) =       0.000531179574
  error estimate for blocks of size 2^( 4) =       0.000545601967
  error estimate for blocks of size 2^( 5) =       0.000554909380
  error estimate for blocks of size 2^( 6) =       0.000560721205
  error estimate for blocks of size 2^( 7) =       0.000564897774

      target function =      -0.708075534248
              le_mean =     -22.817434775341
             les_mean =     521.133841524815
             stat err =       0.000556532582
             autocorr =       1.286920448396
   target nu stat err =       0.000556532582
   target dn stat err =       0.005386411670
      target stat err =       0.003812962489
              std dev =       0.693792725252
             le_variance =       0.481348345613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481294115119
                                         uncertainty =       0.002920116940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481294115119
                                         uncertainty =       0.002920116940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490588836
  error estimate for blocks of size 2^( 2) =       0.000511723127
  error estimate for blocks of size 2^( 3) =       0.000531182708
  error estimate for blocks of size 2^( 4) =       0.000545605083
  error estimate for blocks of size 2^( 5) =       0.000554912441
  error estimate for blocks of size 2^( 6) =       0.000560724189
  error estimate for blocks of size 2^( 7) =       0.000564900978

      target function =      -0.708054710963
              le_mean =     -22.817434849796
             les_mean =     521.133874674045
             stat err =       0.000556535673
             autocorr =       1.286917455423
   target nu stat err =       0.000556535673
   target dn stat err =       0.005384544795
      target stat err =       0.003811447421
              std dev =       0.693797385862
             le_variance =       0.481354812629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481299798191
                                         uncertainty =       0.002919682499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481299798191
                                         uncertainty =       0.002919682499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490591728
  error estimate for blocks of size 2^( 2) =       0.000511725977
  error estimate for blocks of size 2^( 3) =       0.000531185457
  error estimate for blocks of size 2^( 4) =       0.000545607818
  error estimate for blocks of size 2^( 5) =       0.000554915128
  error estimate for blocks of size 2^( 6) =       0.000560726810
  error estimate for blocks of size 2^( 7) =       0.000564903791

      target function =      -0.708026932531
              le_mean =     -22.817434915749
             les_mean =     521.133917360788
             stat err =       0.000556538387
             autocorr =       1.286914833320
   target nu stat err =       0.000556538387
   target dn stat err =       0.005383363467
      target stat err =       0.003810333479
              std dev =       0.693801475815
             le_variance =       0.481360487843


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.708021865172        initial
     3.9062e+01     3.9062e+02             1.9285e-05        -0.708075534248  <--
     1.5625e+02     1.5625e+03             4.8236e-06        -0.708054710963
     6.2500e+02     6.2500e+03             1.2061e-06        -0.708026932531

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 4.3274e+01
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_01                 1.417997e-01 3 1  ON 0
ci_02                -3.873839e-02 3 1  ON 1
ci_03                -3.860081e-02 3 1  ON 2
ci_04                 3.509029e-02 3 1  ON 3
ci_05                -2.800706e-02 3 1  ON 4
ci_06                -2.730969e-02 3 1  ON 5
ci_07                 2.818482e-02 3 1  ON 6
ci_08                -9.827154e-03 3 1  ON 7
ci_09                -1.198779e-02 3 1  ON 8
ci_10                -1.177250e-02 3 1  ON 9
ci_11                 1.383820e-02 3 1  ON 10
ci_12                 9.211594e-03 3 1  ON 11
ci_13                 1.258955e-02 3 1  ON 12
ci_14                 1.234697e-02 3 1  ON 13
ci_15                 8.778946e-03 3 1  ON 14
ci_16                 8.736226e-03 3 1  ON 15
ci_17                -8.969208e-03 3 1  ON 16
ci_18                -8.436408e-03 3 1  ON 17
ci_19                 9.939434e-03 3 1  ON 18
ci_20                 7.834780e-03 3 1  ON 19
ci_21                 9.096693e-03 3 1  ON 20
ci_22                 9.208834e-03 3 1  ON 21
ci_23                 5.365578e-03 3 1  ON 22
ci_24                 4.864680e-03 3 1  ON 23
ci_25                 3.622148e-03 3 1  ON 24
ci_26                 3.678856e-03 3 1  ON 25
ci_27                 3.681385e-03 3 1  ON 26
ci_28                 2.738845e-03 3 1  ON 27
ci_29                 2.700428e-03 3 1  ON 28
ci_30                -2.208425e-03 3 1  ON 29
ci_31                -2.343768e-03 3 1  ON 30
ci_32                -1.730049e-03 3 1  ON 31
ci_33                -1.737938e-03 3 1  ON 32
ci_34                 1.558039e-03 3 1  ON 33
ci_35                 1.679358e-03 3 1  ON 34
ci_36                -1.504569e-03 3 1  ON 35
ci_37                -1.561135e-03 3 1  ON 36
ci_38                -1.064424e-03 3 1  ON 37
ci_39                -1.179742e-03 3 1  ON 38
ci_40                -1.670104e-03 3 1  ON 39
ci_41                -1.309842e-03 3 1  ON 40
ci_42                -1.062278e-03 3 1  ON 41
ci_43                -2.487606e-03 3 1  ON 42
ci_44                -1.688012e-03 3 1  ON 43
ci_45                -9.973185e-04 3 1  ON 44
ci_46                -8.868917e-04 3 1  ON 45
ci_47                -1.274377e-04 3 1  ON 46
ci_48                -2.861308e-04 3 1  ON 47
ci_49                -1.176004e-03 3 1  ON 48
ci_50                -9.246881e-04 3 1  ON 49
ci_51                 7.986909e-04 3 1  ON 50
ci_52                 7.077921e-04 3 1  ON 51
ci_53                -1.060845e-03 3 1  ON 52
ci_54                -9.329129e-04 3 1  ON 53
ci_55                -7.140385e-04 3 1  ON 54
ci_56                 1.693056e-03 3 1  ON 55
ci_57                 1.717357e-03 3 1  ON 56
ci_58                -9.560716e-04 3 1  ON 57
ci_59                -9.224848e-04 3 1  ON 58
ci_60                 7.759128e-04 3 1  ON 59
ci_61                 8.080448e-04 3 1  ON 60
ci_62                -5.716847e-04 3 1  ON 61
ci_63                -8.040146e-04 3 1  ON 62
ci_64                -5.972787e-04 3 1  ON 63
ci_65                -4.887289e-04 3 1  ON 64
ci_66                -8.357960e-04 3 1  ON 65
ci_67                -6.804975e-04 3 1  ON 66
ci_68                -2.882125e-04 3 1  ON 67
ci_69                -1.537455e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3709e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.9037
    reference variance = 1.32634
====================================================
  Execution time = 2.7589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9747e-01
  Total weights = 1.963326056e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477818800189
                                         uncertainty =       0.002555710087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477818800189
                                         uncertainty =       0.002555710087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488790901
  error estimate for blocks of size 2^( 2) =       0.000509803601
  error estimate for blocks of size 2^( 3) =       0.000529788818
  error estimate for blocks of size 2^( 4) =       0.000544300171
  error estimate for blocks of size 2^( 5) =       0.000552977376
  error estimate for blocks of size 2^( 6) =       0.000557658195
  error estimate for blocks of size 2^( 7) =       0.000558507973

      target function =      -0.708814750036
              le_mean =     -22.817567112860
             les_mean =     521.138843924927
             stat err =       0.000553360929
             autocorr =       1.281653881326
   target nu stat err =       0.000553360929
   target dn stat err =       0.003737414696
      target stat err =       0.002680484767
              std dev =       0.691254721885
             le_variance =       0.477833090528


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281756711286e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708824040164       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708841583453       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708844468732       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708845006473       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708845224999       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708845279686       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708845284407       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708845285447       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708845287215       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708845287004       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 8.017311e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708824040164       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708828441729       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708829164618       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708829299148       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708829353733       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708829367349       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708829368507       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708829368765       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708829369205       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708829369152       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 2.008276e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.708824040164       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.708825141544       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.708825322364       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.708825356002       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.708825369646       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.708825373046       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.708825373334       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.708825373399       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.708825373508       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.708825373495       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 5.023163e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.671302 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2213e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_01                 1.417797e-01 3 1  ON 0
ci_02                -3.872320e-02 3 1  ON 1
ci_03                -3.858334e-02 3 1  ON 2
ci_04                 3.507265e-02 3 1  ON 3
ci_05                -2.799956e-02 3 1  ON 4
ci_06                -2.729985e-02 3 1  ON 5
ci_07                 2.818222e-02 3 1  ON 6
ci_08                -9.819491e-03 3 1  ON 7
ci_09                -1.198247e-02 3 1  ON 8
ci_10                -1.176752e-02 3 1  ON 9
ci_11                 1.383245e-02 3 1  ON 10
ci_12                 9.207349e-03 3 1  ON 11
ci_13                 1.259006e-02 3 1  ON 12
ci_14                 1.234618e-02 3 1  ON 13
ci_15                 8.777355e-03 3 1  ON 14
ci_16                 8.731206e-03 3 1  ON 15
ci_17                -8.972166e-03 3 1  ON 16
ci_18                -8.432170e-03 3 1  ON 17
ci_19                 9.938722e-03 3 1  ON 18
ci_20                 7.834846e-03 3 1  ON 19
ci_21                 9.095428e-03 3 1  ON 20
ci_22                 9.208744e-03 3 1  ON 21
ci_23                 5.363990e-03 3 1  ON 22
ci_24                 4.863524e-03 3 1  ON 23
ci_25                 3.621067e-03 3 1  ON 24
ci_26                 3.679419e-03 3 1  ON 25
ci_27                 3.681192e-03 3 1  ON 26
ci_28                 2.740407e-03 3 1  ON 27
ci_29                 2.698696e-03 3 1  ON 28
ci_30                -2.207283e-03 3 1  ON 29
ci_31                -2.341773e-03 3 1  ON 30
ci_32                -1.728304e-03 3 1  ON 31
ci_33                -1.736292e-03 3 1  ON 32
ci_34                 1.558016e-03 3 1  ON 33
ci_35                 1.679610e-03 3 1  ON 34
ci_36                -1.503605e-03 3 1  ON 35
ci_37                -1.560660e-03 3 1  ON 36
ci_38                -1.064597e-03 3 1  ON 37
ci_39                -1.178220e-03 3 1  ON 38
ci_40                -1.670688e-03 3 1  ON 39
ci_41                -1.308049e-03 3 1  ON 40
ci_42                -1.062282e-03 3 1  ON 41
ci_43                -2.487430e-03 3 1  ON 42
ci_44                -1.689345e-03 3 1  ON 43
ci_45                -9.969005e-04 3 1  ON 44
ci_46                -8.859826e-04 3 1  ON 45
ci_47                -1.243754e-04 3 1  ON 46
ci_48                -2.820042e-04 3 1  ON 47
ci_49                -1.175150e-03 3 1  ON 48
ci_50                -9.250262e-04 3 1  ON 49
ci_51                 8.001238e-04 3 1  ON 50
ci_52                 7.077584e-04 3 1  ON 51
ci_53                -1.060622e-03 3 1  ON 52
ci_54                -9.323441e-04 3 1  ON 53
ci_55                -7.135416e-04 3 1  ON 54
ci_56                 1.692669e-03 3 1  ON 55
ci_57                 1.718812e-03 3 1  ON 56
ci_58                -9.568581e-04 3 1  ON 57
ci_59                -9.234427e-04 3 1  ON 58
ci_60                 7.754357e-04 3 1  ON 59
ci_61                 8.072532e-04 3 1  ON 60
ci_62                -5.710383e-04 3 1  ON 61
ci_63                -8.031532e-04 3 1  ON 62
ci_64                -5.956602e-04 3 1  ON 63
ci_65                -4.892364e-04 3 1  ON 64
ci_66                -8.356250e-04 3 1  ON 65
ci_67                -6.806917e-04 3 1  ON 66
ci_68                -2.894850e-04 3 1  ON 67
ci_69                -1.546205e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.7979
    reference variance = 0.455907
====================================================
  Execution time = 2.5109e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9715e-01
  Total weights = 1.9635e+06
  Execution time = 3.5743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480417391065
                                         uncertainty =       0.002892750476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480417391065
                                         uncertainty =       0.002892750476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490078965
  error estimate for blocks of size 2^( 2) =       0.000511056708
  error estimate for blocks of size 2^( 3) =       0.000530676942
  error estimate for blocks of size 2^( 4) =       0.000546363695
  error estimate for blocks of size 2^( 5) =       0.000554984290
  error estimate for blocks of size 2^( 6) =       0.000561307139
  error estimate for blocks of size 2^( 7) =       0.000564736523

      target function =      -0.709004146744
              le_mean =     -22.818081112080
             les_mean =     521.162042394774
             stat err =       0.000556847912
             autocorr =       1.291044070135
   target nu stat err =       0.000556847912
   target dn stat err =       0.003578442678
      target stat err =       0.002575266098
              std dev =       0.693076318372
             le_variance =       0.480354783088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480358365369
                                         uncertainty =       0.002893256008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480358365369
                                         uncertainty =       0.002893256008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490048879
  error estimate for blocks of size 2^( 2) =       0.000511027302
  error estimate for blocks of size 2^( 3) =       0.000530648064
  error estimate for blocks of size 2^( 4) =       0.000546335368
  error estimate for blocks of size 2^( 5) =       0.000554956746
  error estimate for blocks of size 2^( 6) =       0.000561279406
  error estimate for blocks of size 2^( 7) =       0.000564708024

      target function =      -0.705806614422
              le_mean =     -22.818081561035
             les_mean =     521.166611070104
             stat err =       0.000556819886
             autocorr =       1.291072629772
   target nu stat err =       0.000556819886
   target dn stat err =       0.005870413186
      target stat err =       0.004126203079
              std dev =       0.693033770620
             le_variance =       0.480295807220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480387691089
                                         uncertainty =       0.002893003193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480387691089
                                         uncertainty =       0.002893003193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490063827
  error estimate for blocks of size 2^( 2) =       0.000511041918
  error estimate for blocks of size 2^( 3) =       0.000530662433
  error estimate for blocks of size 2^( 4) =       0.000546349580
  error estimate for blocks of size 2^( 5) =       0.000554970618
  error estimate for blocks of size 2^( 6) =       0.000561293442
  error estimate for blocks of size 2^( 7) =       0.000564722507

      target function =      -0.709058711140
              le_mean =     -22.818081374088
             les_mean =     521.161976735152
             stat err =       0.000556834037
             autocorr =       1.291059489640
   target nu stat err =       0.000556834037
   target dn stat err =       0.003578829299
      target stat err =       0.002575916882
              std dev =       0.693054909927
             le_variance =       0.480325108174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480413666750
                                         uncertainty =       0.002892781922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480413666750
                                         uncertainty =       0.002892781922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490077066
  error estimate for blocks of size 2^( 2) =       0.000511054853
  error estimate for blocks of size 2^( 3) =       0.000530675127
  error estimate for blocks of size 2^( 4) =       0.000546361931
  error estimate for blocks of size 2^( 5) =       0.000554982583
  error estimate for blocks of size 2^( 6) =       0.000561305429
  error estimate for blocks of size 2^( 7) =       0.000564734785

      target function =      -0.708854049159
              le_mean =     -22.818081140125
             les_mean =     521.162257188556
             stat err =       0.000556846182
             autocorr =       1.291046050029
   target nu stat err =       0.000556846182
   target dn stat err =       0.003587940093
      target stat err =       0.002580719162
              std dev =       0.693073633834
             le_variance =       0.480351061916


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709004146744        initial
     9.7656e+00     9.7656e+01             8.0173e-05        -0.705806614422
     3.9062e+01     3.9062e+02             2.0083e-05        -0.709058711140  <--
     1.5625e+02     1.5625e+03             5.0232e-06        -0.708854049159

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 4.3000e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_01                 1.417797e-01 3 1  ON 0
ci_02                -3.872320e-02 3 1  ON 1
ci_03                -3.858334e-02 3 1  ON 2
ci_04                 3.507265e-02 3 1  ON 3
ci_05                -2.799956e-02 3 1  ON 4
ci_06                -2.729985e-02 3 1  ON 5
ci_07                 2.818222e-02 3 1  ON 6
ci_08                -9.819491e-03 3 1  ON 7
ci_09                -1.198247e-02 3 1  ON 8
ci_10                -1.176752e-02 3 1  ON 9
ci_11                 1.383245e-02 3 1  ON 10
ci_12                 9.207349e-03 3 1  ON 11
ci_13                 1.259006e-02 3 1  ON 12
ci_14                 1.234618e-02 3 1  ON 13
ci_15                 8.777355e-03 3 1  ON 14
ci_16                 8.731206e-03 3 1  ON 15
ci_17                -8.972166e-03 3 1  ON 16
ci_18                -8.432170e-03 3 1  ON 17
ci_19                 9.938722e-03 3 1  ON 18
ci_20                 7.834846e-03 3 1  ON 19
ci_21                 9.095428e-03 3 1  ON 20
ci_22                 9.208744e-03 3 1  ON 21
ci_23                 5.363990e-03 3 1  ON 22
ci_24                 4.863524e-03 3 1  ON 23
ci_25                 3.621067e-03 3 1  ON 24
ci_26                 3.679419e-03 3 1  ON 25
ci_27                 3.681192e-03 3 1  ON 26
ci_28                 2.740407e-03 3 1  ON 27
ci_29                 2.698696e-03 3 1  ON 28
ci_30                -2.207283e-03 3 1  ON 29
ci_31                -2.341773e-03 3 1  ON 30
ci_32                -1.728304e-03 3 1  ON 31
ci_33                -1.736292e-03 3 1  ON 32
ci_34                 1.558016e-03 3 1  ON 33
ci_35                 1.679610e-03 3 1  ON 34
ci_36                -1.503605e-03 3 1  ON 35
ci_37                -1.560660e-03 3 1  ON 36
ci_38                -1.064597e-03 3 1  ON 37
ci_39                -1.178220e-03 3 1  ON 38
ci_40                -1.670688e-03 3 1  ON 39
ci_41                -1.308049e-03 3 1  ON 40
ci_42                -1.062282e-03 3 1  ON 41
ci_43                -2.487430e-03 3 1  ON 42
ci_44                -1.689345e-03 3 1  ON 43
ci_45                -9.969005e-04 3 1  ON 44
ci_46                -8.859826e-04 3 1  ON 45
ci_47                -1.243754e-04 3 1  ON 46
ci_48                -2.820042e-04 3 1  ON 47
ci_49                -1.175150e-03 3 1  ON 48
ci_50                -9.250262e-04 3 1  ON 49
ci_51                 8.001238e-04 3 1  ON 50
ci_52                 7.077584e-04 3 1  ON 51
ci_53                -1.060622e-03 3 1  ON 52
ci_54                -9.323441e-04 3 1  ON 53
ci_55                -7.135416e-04 3 1  ON 54
ci_56                 1.692669e-03 3 1  ON 55
ci_57                 1.718812e-03 3 1  ON 56
ci_58                -9.568581e-04 3 1  ON 57
ci_59                -9.234427e-04 3 1  ON 58
ci_60                 7.754357e-04 3 1  ON 59
ci_61                 8.072532e-04 3 1  ON 60
ci_62                -5.710383e-04 3 1  ON 61
ci_63                -8.031532e-04 3 1  ON 62
ci_64                -5.956602e-04 3 1  ON 63
ci_65                -4.892364e-04 3 1  ON 64
ci_66                -8.356250e-04 3 1  ON 65
ci_67                -6.806917e-04 3 1  ON 66
ci_68                -2.894850e-04 3 1  ON 67
ci_69                -1.546205e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5218e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.8602
    reference variance = 0.551506
====================================================
  Execution time = 2.5693e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5335e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9044e-01
  Total weights = 1.963516310e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475629512291
                                         uncertainty =       0.002105464940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475629512291
                                         uncertainty =       0.002105464940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487708774
  error estimate for blocks of size 2^( 2) =       0.000509107723
  error estimate for blocks of size 2^( 3) =       0.000528799231
  error estimate for blocks of size 2^( 4) =       0.000544389316
  error estimate for blocks of size 2^( 5) =       0.000552834990
  error estimate for blocks of size 2^( 6) =       0.000557627986
  error estimate for blocks of size 2^( 7) =       0.000558933600

      target function =      -0.713796523160
              le_mean =     -22.817748445304
             les_mean =     521.140082284169
             stat err =       0.000553446473
             autocorr =       1.287745707825
   target nu stat err =       0.000553446473
   target dn stat err =       0.003040346641
      target stat err =       0.002234421954
              std dev =       0.689724362864
             le_variance =       0.475719696728


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281774844530e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713802869928       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713821790743       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713825587998       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713826251825       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713826483823       residual = 9.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713826572491       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713826596918       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713826596875       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713826596285       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713826597022       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713826597415       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 9.982551e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713802869928       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713807617278       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713808568829       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713808734889       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713808792792       residual = 9.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713808814855       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713808820931       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713808820917       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713808820770       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713808820954       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713808821051       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 2.500518e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713802869928       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713804057842       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713804295870       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713804337391       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713804351861       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713804357370       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713804358887       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713804358884       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713804358847       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713804358893       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713804358917       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 6.254354e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.675358 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0267e+01
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_01                 1.417547e-01 3 1  ON 0
ci_02                -3.870491e-02 3 1  ON 1
ci_03                -3.856771e-02 3 1  ON 2
ci_04                 3.505434e-02 3 1  ON 3
ci_05                -2.798967e-02 3 1  ON 4
ci_06                -2.728947e-02 3 1  ON 5
ci_07                 2.817926e-02 3 1  ON 6
ci_08                -9.811495e-03 3 1  ON 7
ci_09                -1.197700e-02 3 1  ON 8
ci_10                -1.176284e-02 3 1  ON 9
ci_11                 1.383096e-02 3 1  ON 10
ci_12                 9.203902e-03 3 1  ON 11
ci_13                 1.259020e-02 3 1  ON 12
ci_14                 1.234759e-02 3 1  ON 13
ci_15                 8.775242e-03 3 1  ON 14
ci_16                 8.730114e-03 3 1  ON 15
ci_17                -8.967325e-03 3 1  ON 16
ci_18                -8.429914e-03 3 1  ON 17
ci_19                 9.936380e-03 3 1  ON 18
ci_20                 7.833148e-03 3 1  ON 19
ci_21                 9.093165e-03 3 1  ON 20
ci_22                 9.208973e-03 3 1  ON 21
ci_23                 5.362663e-03 3 1  ON 22
ci_24                 4.862337e-03 3 1  ON 23
ci_25                 3.619866e-03 3 1  ON 24
ci_26                 3.678296e-03 3 1  ON 25
ci_27                 3.680391e-03 3 1  ON 26
ci_28                 2.741765e-03 3 1  ON 27
ci_29                 2.695698e-03 3 1  ON 28
ci_30                -2.205557e-03 3 1  ON 29
ci_31                -2.342009e-03 3 1  ON 30
ci_32                -1.727417e-03 3 1  ON 31
ci_33                -1.734855e-03 3 1  ON 32
ci_34                 1.557437e-03 3 1  ON 33
ci_35                 1.678285e-03 3 1  ON 34
ci_36                -1.501374e-03 3 1  ON 35
ci_37                -1.561628e-03 3 1  ON 36
ci_38                -1.062819e-03 3 1  ON 37
ci_39                -1.177070e-03 3 1  ON 38
ci_40                -1.669274e-03 3 1  ON 39
ci_41                -1.306439e-03 3 1  ON 40
ci_42                -1.062797e-03 3 1  ON 41
ci_43                -2.487923e-03 3 1  ON 42
ci_44                -1.687112e-03 3 1  ON 43
ci_45                -9.969363e-04 3 1  ON 44
ci_46                -8.860362e-04 3 1  ON 45
ci_47                -1.250295e-04 3 1  ON 46
ci_48                -2.813007e-04 3 1  ON 47
ci_49                -1.174533e-03 3 1  ON 48
ci_50                -9.244941e-04 3 1  ON 49
ci_51                 7.996069e-04 3 1  ON 50
ci_52                 7.072129e-04 3 1  ON 51
ci_53                -1.060168e-03 3 1  ON 52
ci_54                -9.331591e-04 3 1  ON 53
ci_55                -7.134133e-04 3 1  ON 54
ci_56                 1.693673e-03 3 1  ON 55
ci_57                 1.718638e-03 3 1  ON 56
ci_58                -9.573970e-04 3 1  ON 57
ci_59                -9.233313e-04 3 1  ON 58
ci_60                 7.745145e-04 3 1  ON 59
ci_61                 8.082488e-04 3 1  ON 60
ci_62                -5.714846e-04 3 1  ON 61
ci_63                -8.031849e-04 3 1  ON 62
ci_64                -5.943126e-04 3 1  ON 63
ci_65                -4.892865e-04 3 1  ON 64
ci_66                -8.362703e-04 3 1  ON 65
ci_67                -6.807236e-04 3 1  ON 66
ci_68                -2.899542e-04 3 1  ON 67
ci_69                -1.530711e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.9015
    reference variance = 0.230413
====================================================
  Execution time = 2.5118e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9106e-01
  Total weights = 1.9636e+06
  Execution time = 3.5853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474394199556
                                         uncertainty =       0.002240173814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474394199556
                                         uncertainty =       0.002240173814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487008032
  error estimate for blocks of size 2^( 2) =       0.000508059562
  error estimate for blocks of size 2^( 3) =       0.000528126419
  error estimate for blocks of size 2^( 4) =       0.000543540236
  error estimate for blocks of size 2^( 5) =       0.000552245027
  error estimate for blocks of size 2^( 6) =       0.000559072484
  error estimate for blocks of size 2^( 7) =       0.000561156854

      target function =      -0.713294368295
              le_mean =     -22.817136139005
             les_mean =     521.112822572533
             stat err =       0.000554003650
             autocorr =       1.294055801893
   target nu stat err =       0.000554003650
   target dn stat err =       0.003763928260
      target stat err =       0.002730707184
              std dev =       0.688733364163
             le_variance =       0.474353646911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474326386657
                                         uncertainty =       0.002241630262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474326386657
                                         uncertainty =       0.002241630262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486973246
  error estimate for blocks of size 2^( 2) =       0.000508025204
  error estimate for blocks of size 2^( 3) =       0.000528093017
  error estimate for blocks of size 2^( 4) =       0.000543507666
  error estimate for blocks of size 2^( 5) =       0.000552213038
  error estimate for blocks of size 2^( 6) =       0.000559040477
  error estimate for blocks of size 2^( 7) =       0.000561125929

      target function =      -0.713418181445
              le_mean =     -22.817136365706
             les_mean =     521.112659216860
             stat err =       0.000553971778
             autocorr =       1.294091770284
   target nu stat err =       0.000553971778
   target dn stat err =       0.003693957498
      target stat err =       0.002682940260
              std dev =       0.688684169410
             le_variance =       0.474285885196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474360028953
                                         uncertainty =       0.002240911427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474360028953
                                         uncertainty =       0.002240911427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486990504
  error estimate for blocks of size 2^( 2) =       0.000508042250
  error estimate for blocks of size 2^( 3) =       0.000528109590
  error estimate for blocks of size 2^( 4) =       0.000543523824
  error estimate for blocks of size 2^( 5) =       0.000552228905
  error estimate for blocks of size 2^( 6) =       0.000559056351
  error estimate for blocks of size 2^( 7) =       0.000561141268

      target function =      -0.713368238188
              le_mean =     -22.817136238553
             les_mean =     521.112723433608
             stat err =       0.000553987587
             autocorr =       1.294073909806
   target nu stat err =       0.000553987587
   target dn stat err =       0.003727605417
      target stat err =       0.002705981566
              std dev =       0.688708575767
             le_variance =       0.474319502336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474389907515
                                         uncertainty =       0.002240266874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474389907515
                                         uncertainty =       0.002240266874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487005831
  error estimate for blocks of size 2^( 2) =       0.000508057387
  error estimate for blocks of size 2^( 3) =       0.000528124305
  error estimate for blocks of size 2^( 4) =       0.000543538174
  error estimate for blocks of size 2^( 5) =       0.000552243002
  error estimate for blocks of size 2^( 6) =       0.000559070457
  error estimate for blocks of size 2^( 7) =       0.000561154895

      target function =      -0.713307064211
              le_mean =     -22.817136149812
             les_mean =     521.112805232786
             stat err =       0.000554001632
             autocorr =       1.294058073728
   target nu stat err =       0.000554001632
   target dn stat err =       0.003759249356
      target stat err =       0.002727546030
              std dev =       0.688730250654
             le_variance =       0.474349358166


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.713294368295        initial
     9.7656e+00     9.7656e+01             9.9826e-05        -0.713418181445  <--
     3.9062e+01     3.9062e+02             2.5005e-05        -0.713368238188
     1.5625e+02     1.5625e+03             6.2544e-06        -0.713307064211

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 4.3099e+01
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_01                 1.416798e-01 3 1  ON 0
ci_02                -3.865029e-02 3 1  ON 1
ci_03                -3.852103e-02 3 1  ON 2
ci_04                 3.499968e-02 3 1  ON 3
ci_05                -2.796012e-02 3 1  ON 4
ci_06                -2.725850e-02 3 1  ON 5
ci_07                 2.817042e-02 3 1  ON 6
ci_08                -9.787621e-03 3 1  ON 7
ci_09                -1.196066e-02 3 1  ON 8
ci_10                -1.174888e-02 3 1  ON 9
ci_11                 1.382650e-02 3 1  ON 10
ci_12                 9.193611e-03 3 1  ON 11
ci_13                 1.259060e-02 3 1  ON 12
ci_14                 1.235184e-02 3 1  ON 13
ci_15                 8.768933e-03 3 1  ON 14
ci_16                 8.726853e-03 3 1  ON 15
ci_17                -8.952859e-03 3 1  ON 16
ci_18                -8.423171e-03 3 1  ON 17
ci_19                 9.929391e-03 3 1  ON 18
ci_20                 7.828077e-03 3 1  ON 19
ci_21                 9.086398e-03 3 1  ON 20
ci_22                 9.209658e-03 3 1  ON 21
ci_23                 5.358705e-03 3 1  ON 22
ci_24                 4.858790e-03 3 1  ON 23
ci_25                 3.616281e-03 3 1  ON 24
ci_26                 3.674944e-03 3 1  ON 25
ci_27                 3.678002e-03 3 1  ON 26
ci_28                 2.745816e-03 3 1  ON 27
ci_29                 2.686740e-03 3 1  ON 28
ci_30                -2.200396e-03 3 1  ON 29
ci_31                -2.342716e-03 3 1  ON 30
ci_32                -1.724776e-03 3 1  ON 31
ci_33                -1.730570e-03 3 1  ON 32
ci_34                 1.555710e-03 3 1  ON 33
ci_35                 1.674333e-03 3 1  ON 34
ci_36                -1.494715e-03 3 1  ON 35
ci_37                -1.564513e-03 3 1  ON 36
ci_38                -1.057509e-03 3 1  ON 37
ci_39                -1.173638e-03 3 1  ON 38
ci_40                -1.665054e-03 3 1  ON 39
ci_41                -1.301638e-03 3 1  ON 40
ci_42                -1.064340e-03 3 1  ON 41
ci_43                -2.489395e-03 3 1  ON 42
ci_44                -1.680435e-03 3 1  ON 43
ci_45                -9.970409e-04 3 1  ON 44
ci_46                -8.861958e-04 3 1  ON 45
ci_47                -1.269831e-04 3 1  ON 46
ci_48                -2.791921e-04 3 1  ON 47
ci_49                -1.172692e-03 3 1  ON 48
ci_50                -9.229069e-04 3 1  ON 49
ci_51                 7.980620e-04 3 1  ON 50
ci_52                 7.055838e-04 3 1  ON 51
ci_53                -1.058812e-03 3 1  ON 52
ci_54                -9.355941e-04 3 1  ON 53
ci_55                -7.130292e-04 3 1  ON 54
ci_56                 1.696671e-03 3 1  ON 55
ci_57                 1.718122e-03 3 1  ON 56
ci_58                -9.590073e-04 3 1  ON 57
ci_59                -9.229998e-04 3 1  ON 58
ci_60                 7.717556e-04 3 1  ON 59
ci_61                 8.112295e-04 3 1  ON 60
ci_62                -5.728144e-04 3 1  ON 61
ci_63                -8.032771e-04 3 1  ON 62
ci_64                -5.902875e-04 3 1  ON 63
ci_65                -4.894362e-04 3 1  ON 64
ci_66                -8.381961e-04 3 1  ON 65
ci_67                -6.808176e-04 3 1  ON 66
ci_68                -2.913554e-04 3 1  ON 67
ci_69                -1.484452e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3372e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.9998
    reference variance = 1.60505
====================================================
  Execution time = 2.5742e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5320e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9951e-01
  Total weights = 1.963567615e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5862e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482696119317
                                         uncertainty =       0.004138990758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482696119317
                                         uncertainty =       0.004138990758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491234137
  error estimate for blocks of size 2^( 2) =       0.000512122445
  error estimate for blocks of size 2^( 3) =       0.000532067501
  error estimate for blocks of size 2^( 4) =       0.000547280476
  error estimate for blocks of size 2^( 5) =       0.000556868974
  error estimate for blocks of size 2^( 6) =       0.000563376737
  error estimate for blocks of size 2^( 7) =       0.000564656598

      target function =      -0.707376894991
              le_mean =     -22.817439012922
             les_mean =     521.135034940260
             stat err =       0.000558045696
             autocorr =       1.290513187489
   target nu stat err =       0.000558045696
   target dn stat err =       0.005213475299
      target stat err =       0.003686173166
              std dev =       0.694709979365
             le_variance =       0.482621955430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281743901292e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707395330432       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707464963155       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707478017194       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707480639873       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707481544293       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707481776110       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707481766413       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707481756935       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707481761631       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707481762183       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 3.860559e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707395330432       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707412986272       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707416280189       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707416937100       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707417161655       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707417218295       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707417215787       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707417213396       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707417214549       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707417214682       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 9.724626e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707395330432       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707399760145       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707400585542       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707400749842       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707400805881       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707400819958       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707400819326       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707400818727       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707400819014       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707400819047       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 2.435780e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.678826 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0337e+01
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_01                 1.415826e-01 3 1  ON 0
ci_02                -3.859481e-02 3 1  ON 1
ci_03                -3.845480e-02 3 1  ON 2
ci_04                 3.492854e-02 3 1  ON 3
ci_05                -2.791559e-02 3 1  ON 4
ci_06                -2.722543e-02 3 1  ON 5
ci_07                 2.816666e-02 3 1  ON 6
ci_08                -9.756866e-03 3 1  ON 7
ci_09                -1.193480e-02 3 1  ON 8
ci_10                -1.172504e-02 3 1  ON 9
ci_11                 1.381797e-02 3 1  ON 10
ci_12                 9.170204e-03 3 1  ON 11
ci_13                 1.259305e-02 3 1  ON 12
ci_14                 1.235031e-02 3 1  ON 13
ci_15                 8.761617e-03 3 1  ON 14
ci_16                 8.717217e-03 3 1  ON 15
ci_17                -8.940328e-03 3 1  ON 16
ci_18                -8.416838e-03 3 1  ON 17
ci_19                 9.924417e-03 3 1  ON 18
ci_20                 7.814802e-03 3 1  ON 19
ci_21                 9.090526e-03 3 1  ON 20
ci_22                 9.213081e-03 3 1  ON 21
ci_23                 5.357423e-03 3 1  ON 22
ci_24                 4.858716e-03 3 1  ON 23
ci_25                 3.611805e-03 3 1  ON 24
ci_26                 3.668464e-03 3 1  ON 25
ci_27                 3.675898e-03 3 1  ON 26
ci_28                 2.735298e-03 3 1  ON 27
ci_29                 2.685300e-03 3 1  ON 28
ci_30                -2.199703e-03 3 1  ON 29
ci_31                -2.341114e-03 3 1  ON 30
ci_32                -1.719972e-03 3 1  ON 31
ci_33                -1.728875e-03 3 1  ON 32
ci_34                 1.554042e-03 3 1  ON 33
ci_35                 1.665505e-03 3 1  ON 34
ci_36                -1.493390e-03 3 1  ON 35
ci_37                -1.558096e-03 3 1  ON 36
ci_38                -1.054781e-03 3 1  ON 37
ci_39                -1.164898e-03 3 1  ON 38
ci_40                -1.658760e-03 3 1  ON 39
ci_41                -1.300058e-03 3 1  ON 40
ci_42                -1.065702e-03 3 1  ON 41
ci_43                -2.490371e-03 3 1  ON 42
ci_44                -1.681105e-03 3 1  ON 43
ci_45                -9.873573e-04 3 1  ON 44
ci_46                -8.826676e-04 3 1  ON 45
ci_47                -1.189404e-04 3 1  ON 46
ci_48                -2.689431e-04 3 1  ON 47
ci_49                -1.174902e-03 3 1  ON 48
ci_50                -9.218375e-04 3 1  ON 49
ci_51                 7.952810e-04 3 1  ON 50
ci_52                 6.996566e-04 3 1  ON 51
ci_53                -1.054552e-03 3 1  ON 52
ci_54                -9.325407e-04 3 1  ON 53
ci_55                -7.104821e-04 3 1  ON 54
ci_56                 1.698346e-03 3 1  ON 55
ci_57                 1.719595e-03 3 1  ON 56
ci_58                -9.664082e-04 3 1  ON 57
ci_59                -9.205379e-04 3 1  ON 58
ci_60                 7.666058e-04 3 1  ON 59
ci_61                 8.083454e-04 3 1  ON 60
ci_62                -5.776573e-04 3 1  ON 61
ci_63                -8.020225e-04 3 1  ON 62
ci_64                -5.951691e-04 3 1  ON 63
ci_65                -4.780346e-04 3 1  ON 64
ci_66                -8.380483e-04 3 1  ON 65
ci_67                -6.815924e-04 3 1  ON 66
ci_68                -2.978392e-04 3 1  ON 67
ci_69                -1.464383e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.9042
    reference variance = 0.530644
====================================================
  Execution time = 2.5171e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9563e-01
  Total weights = 1.9635e+06
  Execution time = 3.5949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478908216285
                                         uncertainty =       0.002630044554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478908216285
                                         uncertainty =       0.002630044554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489314149
  error estimate for blocks of size 2^( 2) =       0.000510270188
  error estimate for blocks of size 2^( 3) =       0.000530188098
  error estimate for blocks of size 2^( 4) =       0.000545303151
  error estimate for blocks of size 2^( 5) =       0.000554553910
  error estimate for blocks of size 2^( 6) =       0.000558062491
  error estimate for blocks of size 2^( 7) =       0.000561633235

      target function =      -0.710060945723
              le_mean =     -22.818216052489
             les_mean =     521.166700822799
             stat err =       0.000554888197
             autocorr =       1.285983587920
   target nu stat err =       0.000554888197
   target dn stat err =       0.003625016112
      target stat err =       0.002614942600
              std dev =       0.691994705506
             le_variance =       0.478856672448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478682929305
                                         uncertainty =       0.002630371246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478682929305
                                         uncertainty =       0.002630371246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489198972
  error estimate for blocks of size 2^( 2) =       0.000510155788
  error estimate for blocks of size 2^( 3) =       0.000530077855
  error estimate for blocks of size 2^( 4) =       0.000545195831
  error estimate for blocks of size 2^( 5) =       0.000554449311
  error estimate for blocks of size 2^( 6) =       0.000557963419
  error estimate for blocks of size 2^( 7) =       0.000561529663

      target function =      -0.710259617405
              le_mean =     -22.818217754499
             les_mean =     521.166496849734
             stat err =       0.000554784556
             autocorr =       1.286108634592
   target nu stat err =       0.000554784556
   target dn stat err =       0.003625850721
      target stat err =       0.002616933862
              std dev =       0.691831820937
             le_variance =       0.478631268460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478792950142
                                         uncertainty =       0.002630181173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478792950142
                                         uncertainty =       0.002630181173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489255224
  error estimate for blocks of size 2^( 2) =       0.000510211644
  error estimate for blocks of size 2^( 3) =       0.000530131642
  error estimate for blocks of size 2^( 4) =       0.000545248165
  error estimate for blocks of size 2^( 5) =       0.000554500308
  error estimate for blocks of size 2^( 6) =       0.000558011674
  error estimate for blocks of size 2^( 7) =       0.000561580104

      target function =      -0.710227236757
              le_mean =     -22.818216719258
             les_mean =     521.166495499232
             stat err =       0.000554835063
             autocorr =       1.286047039859
   target nu stat err =       0.000554835063
   target dn stat err =       0.003623718971
      target stat err =       0.002615237093
              std dev =       0.691911373035
             le_variance =       0.478741348135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478893631744
                                         uncertainty =       0.002630058741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478893631744
                                         uncertainty =       0.002630058741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489306694
  error estimate for blocks of size 2^( 2) =       0.000510262779
  error estimate for blocks of size 2^( 3) =       0.000530180951
  error estimate for blocks of size 2^( 4) =       0.000545296186
  error estimate for blocks of size 2^( 5) =       0.000554547127
  error estimate for blocks of size 2^( 6) =       0.000558056045
  error estimate for blocks of size 2^( 7) =       0.000561626497

      target function =      -0.710095082197
              le_mean =     -22.818216112611
             les_mean =     521.166655162930
             stat err =       0.000554881464
             autocorr =       1.285991565781
   target nu stat err =       0.000554881464
   target dn stat err =       0.003624376386
      target stat err =       0.002614746236
              std dev =       0.691984162199
             le_variance =       0.478842080734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.710060945723        initial
     2.4414e+00     2.4414e+01             3.8606e-04        -0.710259617405  <--
     9.7656e+00     9.7656e+01             9.7246e-05        -0.710227236757
     3.9062e+01     3.9062e+02             2.4358e-05        -0.710095082197

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 4.3182e+01
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_01                 1.412938e-01 3 1  ON 0
ci_02                -3.843129e-02 3 1  ON 1
ci_03                -3.825949e-02 3 1  ON 2
ci_04                 3.471920e-02 3 1  ON 3
ci_05                -2.778444e-02 3 1  ON 4
ci_06                -2.712813e-02 3 1  ON 5
ci_07                 2.815559e-02 3 1  ON 6
ci_08                -9.666317e-03 3 1  ON 7
ci_09                -1.185839e-02 3 1  ON 8
ci_10                -1.165459e-02 3 1  ON 9
ci_11                 1.379275e-02 3 1  ON 10
ci_12                 9.101265e-03 3 1  ON 11
ci_13                 1.260041e-02 3 1  ON 12
ci_14                 1.234580e-02 3 1  ON 13
ci_15                 8.740035e-03 3 1  ON 14
ci_16                 8.688820e-03 3 1  ON 15
ci_17                -8.903307e-03 3 1  ON 16
ci_18                -8.398108e-03 3 1  ON 17
ci_19                 9.909820e-03 3 1  ON 18
ci_20                 7.775721e-03 3 1  ON 19
ci_21                 9.102784e-03 3 1  ON 20
ci_22                 9.223248e-03 3 1  ON 21
ci_23                 5.353660e-03 3 1  ON 22
ci_24                 4.858541e-03 3 1  ON 23
ci_25                 3.598633e-03 3 1  ON 24
ci_26                 3.649373e-03 3 1  ON 25
ci_27                 3.669726e-03 3 1  ON 26
ci_28                 2.704223e-03 3 1  ON 27
ci_29                 2.681004e-03 3 1  ON 28
ci_30                -2.197636e-03 3 1  ON 29
ci_31                -2.336326e-03 3 1  ON 30
ci_32                -1.705912e-03 3 1  ON 31
ci_33                -1.723943e-03 3 1  ON 32
ci_34                 1.549226e-03 3 1  ON 33
ci_35                 1.639550e-03 3 1  ON 34
ci_36                -1.489499e-03 3 1  ON 35
ci_37                -1.539208e-03 3 1  ON 36
ci_38                -1.046744e-03 3 1  ON 37
ci_39                -1.139174e-03 3 1  ON 38
ci_40                -1.640265e-03 3 1  ON 39
ci_41                -1.295470e-03 3 1  ON 40
ci_42                -1.069774e-03 3 1  ON 41
ci_43                -2.493180e-03 3 1  ON 42
ci_44                -1.683032e-03 3 1  ON 43
ci_45                -9.588518e-04 3 1  ON 44
ci_46                -8.722810e-04 3 1  ON 45
ci_47                -9.509869e-05 3 1  ON 46
ci_48                -2.385822e-04 3 1  ON 47
ci_49                -1.181395e-03 3 1  ON 48
ci_50                -9.186993e-04 3 1  ON 49
ci_51                 7.870832e-04 3 1  ON 50
ci_52                 6.821892e-04 3 1  ON 51
ci_53                -1.042026e-03 3 1  ON 52
ci_54                -9.235285e-04 3 1  ON 53
ci_55                -7.029580e-04 3 1  ON 54
ci_56                 1.703282e-03 3 1  ON 55
ci_57                 1.723943e-03 3 1  ON 56
ci_58                -9.882115e-04 3 1  ON 57
ci_59                -9.132904e-04 3 1  ON 58
ci_60                 7.512838e-04 3 1  ON 59
ci_61                 7.997842e-04 3 1  ON 60
ci_62                -5.918618e-04 3 1  ON 61
ci_63                -7.983189e-04 3 1  ON 62
ci_64                -6.095225e-04 3 1  ON 63
ci_65                -4.444442e-04 3 1  ON 64
ci_66                -8.376014e-04 3 1  ON 65
ci_67                -6.838759e-04 3 1  ON 66
ci_68                -3.169114e-04 3 1  ON 67
ci_69                -1.405090e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3525e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.8435
    reference variance = 0.338444
====================================================
  Execution time = 2.5637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5322e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9044e-01
  Total weights = 1.963727318e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474800506874
                                         uncertainty =       0.002315101500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474800506874
                                         uncertainty =       0.002315101500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487214841
  error estimate for blocks of size 2^( 2) =       0.000508117088
  error estimate for blocks of size 2^( 3) =       0.000528303862
  error estimate for blocks of size 2^( 4) =       0.000543918557
  error estimate for blocks of size 2^( 5) =       0.000554886644
  error estimate for blocks of size 2^( 6) =       0.000559651097
  error estimate for blocks of size 2^( 7) =       0.000564404454

      target function =      -0.713797434282
              le_mean =     -22.817817113324
             les_mean =     521.143217150868
             stat err =       0.000555715188
             autocorr =       1.300958714922
   target nu stat err =       0.000555715188
   target dn stat err =       0.003013910934
      target stat err =       0.002216967432
              std dev =       0.689025836195
             le_variance =       0.474756602945


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281781711332e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713803505151       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714032022257       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714070691572       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714078165652       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714080423488       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714080956217       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714081206768       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714081236117       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714081248602       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714081244543       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.714081248078       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 1.245870e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713803505151       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713863881893       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713873905878       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713875799476       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713876352071       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713876471664       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713876529859       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713876536567       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713876539408       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713876538411       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713876539232       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 3.213063e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713803505151       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713818816836       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713821345923       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713821820752       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713821958029       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713821987038       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713822001300       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713822002937       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713822003629       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713822003381       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713822003582       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 8.096794e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.682895 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0239e+01
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_01                 1.409725e-01 3 1  ON 0
ci_02                -3.821048e-02 3 1  ON 1
ci_03                -3.801232e-02 3 1  ON 2
ci_04                 3.445878e-02 3 1  ON 3
ci_05                -2.762670e-02 3 1  ON 4
ci_06                -2.697095e-02 3 1  ON 5
ci_07                 2.813674e-02 3 1  ON 6
ci_08                -9.559417e-03 3 1  ON 7
ci_09                -1.177734e-02 3 1  ON 8
ci_10                -1.156164e-02 3 1  ON 9
ci_11                 1.376956e-02 3 1  ON 10
ci_12                 9.066998e-03 3 1  ON 11
ci_13                 1.261704e-02 3 1  ON 12
ci_14                 1.231873e-02 3 1  ON 13
ci_15                 8.697190e-03 3 1  ON 14
ci_16                 8.654054e-03 3 1  ON 15
ci_17                -8.849741e-03 3 1  ON 16
ci_18                -8.387574e-03 3 1  ON 17
ci_19                 9.889883e-03 3 1  ON 18
ci_20                 7.734643e-03 3 1  ON 19
ci_21                 9.110316e-03 3 1  ON 20
ci_22                 9.252012e-03 3 1  ON 21
ci_23                 5.335623e-03 3 1  ON 22
ci_24                 4.840996e-03 3 1  ON 23
ci_25                 3.586825e-03 3 1  ON 24
ci_26                 3.662587e-03 3 1  ON 25
ci_27                 3.652597e-03 3 1  ON 26
ci_28                 2.703355e-03 3 1  ON 27
ci_29                 2.646075e-03 3 1  ON 28
ci_30                -2.161350e-03 3 1  ON 29
ci_31                -2.334018e-03 3 1  ON 30
ci_32                -1.688619e-03 3 1  ON 31
ci_33                -1.720569e-03 3 1  ON 32
ci_34                 1.532919e-03 3 1  ON 33
ci_35                 1.641883e-03 3 1  ON 34
ci_36                -1.459789e-03 3 1  ON 35
ci_37                -1.522774e-03 3 1  ON 36
ci_38                -1.042506e-03 3 1  ON 37
ci_39                -1.120372e-03 3 1  ON 38
ci_40                -1.636389e-03 3 1  ON 39
ci_41                -1.286182e-03 3 1  ON 40
ci_42                -1.055463e-03 3 1  ON 41
ci_43                -2.480991e-03 3 1  ON 42
ci_44                -1.662614e-03 3 1  ON 43
ci_45                -9.464808e-04 3 1  ON 44
ci_46                -8.686346e-04 3 1  ON 45
ci_47                -1.030307e-04 3 1  ON 46
ci_48                -1.974534e-04 3 1  ON 47
ci_49                -1.162124e-03 3 1  ON 48
ci_50                -9.105580e-04 3 1  ON 49
ci_51                 7.627836e-04 3 1  ON 50
ci_52                 6.829300e-04 3 1  ON 51
ci_53                -1.034301e-03 3 1  ON 52
ci_54                -9.345304e-04 3 1  ON 53
ci_55                -6.940940e-04 3 1  ON 54
ci_56                 1.708693e-03 3 1  ON 55
ci_57                 1.728968e-03 3 1  ON 56
ci_58                -9.764329e-04 3 1  ON 57
ci_59                -9.045713e-04 3 1  ON 58
ci_60                 7.109512e-04 3 1  ON 59
ci_61                 7.537286e-04 3 1  ON 60
ci_62                -6.046850e-04 3 1  ON 61
ci_63                -7.820102e-04 3 1  ON 62
ci_64                -6.322667e-04 3 1  ON 63
ci_65                -4.317752e-04 3 1  ON 64
ci_66                -8.407400e-04 3 1  ON 65
ci_67                -6.626238e-04 3 1  ON 66
ci_68                -3.393081e-04 3 1  ON 67
ci_69                -1.595834e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.8442
    reference variance = 0.470092
====================================================
  Execution time = 2.4948e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9860e-01
  Total weights = 1.9634e+06
  Execution time = 3.5911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478299359825
                                         uncertainty =       0.002800108100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478299359825
                                         uncertainty =       0.002800108100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489096560
  error estimate for blocks of size 2^( 2) =       0.000510217914
  error estimate for blocks of size 2^( 3) =       0.000529831719
  error estimate for blocks of size 2^( 4) =       0.000544397506
  error estimate for blocks of size 2^( 5) =       0.000553629117
  error estimate for blocks of size 2^( 6) =       0.000558960847
  error estimate for blocks of size 2^( 7) =       0.000563545857

      target function =      -0.016904530728
              le_mean =     -22.817662932416
             les_mean =     542.286710346958
             stat err =       0.000555133332
             autocorr =       1.288265545674
   target nu stat err =       0.000555133332
   target dn stat err =      21.150603129080
      target stat err =       0.016139632626
              std dev =       0.691686988768
             le_variance =       0.478430890431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476579035850
                                         uncertainty =       0.002621049447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476579035850
                                         uncertainty =       0.002621049447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488220704
  error estimate for blocks of size 2^( 2) =       0.000509368231
  error estimate for blocks of size 2^( 3) =       0.000529020020
  error estimate for blocks of size 2^( 4) =       0.000543603340
  error estimate for blocks of size 2^( 5) =       0.000552911279
  error estimate for blocks of size 2^( 6) =       0.000558376963
  error estimate for blocks of size 2^( 7) =       0.000562968603

      target function =      -0.683498862580
              le_mean =     -22.817642890230
             les_mean =     521.178392242374
             stat err =       0.000554465046
             autocorr =       1.289780959039
   target nu stat err =       0.000554465046
   target dn stat err =       0.037130278505
      target stat err =       0.024277110948
              std dev =       0.690448340935
             le_variance =       0.476718911500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476849329041
                                         uncertainty =       0.002592868047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476849329041
                                         uncertainty =       0.002592868047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488358121
  error estimate for blocks of size 2^( 2) =       0.000509501659
  error estimate for blocks of size 2^( 3) =       0.000529148496
  error estimate for blocks of size 2^( 4) =       0.000543720974
  error estimate for blocks of size 2^( 5) =       0.000553024408
  error estimate for blocks of size 2^( 6) =       0.000558477854
  error estimate for blocks of size 2^( 7) =       0.000563048575

      target function =      -0.706890427409
              le_mean =     -22.817640586117
             les_mean =     521.144932421885
             stat err =       0.000554567953
             autocorr =       1.289533741492
   target nu stat err =       0.000554567953
   target dn stat err =       0.005334154882
      target stat err =       0.003765045835
              std dev =       0.690642677618
             le_variance =       0.476987308147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477163016017
                                         uncertainty =       0.002572723972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477163016017
                                         uncertainty =       0.002572723972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488517760
  error estimate for blocks of size 2^( 2) =       0.000509658914
  error estimate for blocks of size 2^( 3) =       0.000529299358
  error estimate for blocks of size 2^( 4) =       0.000543862309
  error estimate for blocks of size 2^( 5) =       0.000553156896
  error estimate for blocks of size 2^( 6) =       0.000558605890
  error estimate for blocks of size 2^( 7) =       0.000563164552

      target function =      -0.707101224071
              le_mean =     -22.817639863519
             les_mean =     521.144603063065
             stat err =       0.000554697412
             autocorr =       1.289292823272
   target nu stat err =       0.000554697412
   target dn stat err =       0.004784174457
      target stat err =       0.003387521849
              std dev =       0.690868441005
             le_variance =       0.477299202776


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.016904530728        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9320
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_01                 1.412938e-01 3 1  ON 0
ci_02                -3.843129e-02 3 1  ON 1
ci_03                -3.825949e-02 3 1  ON 2
ci_04                 3.471920e-02 3 1  ON 3
ci_05                -2.778444e-02 3 1  ON 4
ci_06                -2.712813e-02 3 1  ON 5
ci_07                 2.815559e-02 3 1  ON 6
ci_08                -9.666317e-03 3 1  ON 7
ci_09                -1.185839e-02 3 1  ON 8
ci_10                -1.165459e-02 3 1  ON 9
ci_11                 1.379275e-02 3 1  ON 10
ci_12                 9.101265e-03 3 1  ON 11
ci_13                 1.260041e-02 3 1  ON 12
ci_14                 1.234580e-02 3 1  ON 13
ci_15                 8.740035e-03 3 1  ON 14
ci_16                 8.688820e-03 3 1  ON 15
ci_17                -8.903307e-03 3 1  ON 16
ci_18                -8.398108e-03 3 1  ON 17
ci_19                 9.909820e-03 3 1  ON 18
ci_20                 7.775721e-03 3 1  ON 19
ci_21                 9.102784e-03 3 1  ON 20
ci_22                 9.223248e-03 3 1  ON 21
ci_23                 5.353660e-03 3 1  ON 22
ci_24                 4.858541e-03 3 1  ON 23
ci_25                 3.598633e-03 3 1  ON 24
ci_26                 3.649373e-03 3 1  ON 25
ci_27                 3.669726e-03 3 1  ON 26
ci_28                 2.704223e-03 3 1  ON 27
ci_29                 2.681004e-03 3 1  ON 28
ci_30                -2.197636e-03 3 1  ON 29
ci_31                -2.336326e-03 3 1  ON 30
ci_32                -1.705912e-03 3 1  ON 31
ci_33                -1.723943e-03 3 1  ON 32
ci_34                 1.549226e-03 3 1  ON 33
ci_35                 1.639550e-03 3 1  ON 34
ci_36                -1.489499e-03 3 1  ON 35
ci_37                -1.539208e-03 3 1  ON 36
ci_38                -1.046744e-03 3 1  ON 37
ci_39                -1.139174e-03 3 1  ON 38
ci_40                -1.640265e-03 3 1  ON 39
ci_41                -1.295470e-03 3 1  ON 40
ci_42                -1.069774e-03 3 1  ON 41
ci_43                -2.493180e-03 3 1  ON 42
ci_44                -1.683032e-03 3 1  ON 43
ci_45                -9.588518e-04 3 1  ON 44
ci_46                -8.722810e-04 3 1  ON 45
ci_47                -9.509869e-05 3 1  ON 46
ci_48                -2.385822e-04 3 1  ON 47
ci_49                -1.181395e-03 3 1  ON 48
ci_50                -9.186993e-04 3 1  ON 49
ci_51                 7.870832e-04 3 1  ON 50
ci_52                 6.821892e-04 3 1  ON 51
ci_53                -1.042026e-03 3 1  ON 52
ci_54                -9.235285e-04 3 1  ON 53
ci_55                -7.029580e-04 3 1  ON 54
ci_56                 1.703282e-03 3 1  ON 55
ci_57                 1.723943e-03 3 1  ON 56
ci_58                -9.882115e-04 3 1  ON 57
ci_59                -9.132904e-04 3 1  ON 58
ci_60                 7.512838e-04 3 1  ON 59
ci_61                 7.997842e-04 3 1  ON 60
ci_62                -5.918618e-04 3 1  ON 61
ci_63                -7.983189e-04 3 1  ON 62
ci_64                -6.095225e-04 3 1  ON 63
ci_65                -4.444442e-04 3 1  ON 64
ci_66                -8.376014e-04 3 1  ON 65
ci_67                -6.838759e-04 3 1  ON 66
ci_68                -3.169114e-04 3 1  ON 67
ci_69                -1.405090e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3177e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.8396
    reference variance = 0.416909
====================================================
  Execution time = 2.5643e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5360e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9402e-01
  Total weights = 1.963778153e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476951628433
                                         uncertainty =       0.003147979088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476951628433
                                         uncertainty =       0.003147979088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488352982
  error estimate for blocks of size 2^( 2) =       0.000509260209
  error estimate for blocks of size 2^( 3) =       0.000529674153
  error estimate for blocks of size 2^( 4) =       0.000545706349
  error estimate for blocks of size 2^( 5) =       0.000556269939
  error estimate for blocks of size 2^( 6) =       0.000561605839
  error estimate for blocks of size 2^( 7) =       0.000565818286

      target function =      -0.711241195447
              le_mean =     -22.817915616720
             les_mean =     521.151290236474
             stat err =       0.000557350103
             autocorr =       1.302532245346
   target nu stat err =       0.000557350103
   target dn stat err =       0.006029570878
      target stat err =       0.004300126434
              std dev =       0.690635410593
             le_variance =       0.476977270365


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281791561672e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711266150607       residual = 2.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711297889698       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711302739886       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711303257823       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711303435630       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711303504484       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711303515096       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711303515258       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711303517017       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711303516736       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 1.337034e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711266150607       residual = 2.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711274131632       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711275348742       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711275478282       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711275522682       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711275539818       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711275542450       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711275542489       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711275542924       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711275542852       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 3.359880e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711266150607       residual = 2.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711268148775       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711268453338       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711268485727       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711268496823       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711268501103       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711268501759       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711268501769       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711268501877       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711268501859       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 8.410580e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.686386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0942e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_01                 1.412696e-01 3 1  ON 0
ci_02                -3.840996e-02 3 1  ON 1
ci_03                -3.822589e-02 3 1  ON 2
ci_04                 3.468685e-02 3 1  ON 3
ci_05                -2.776624e-02 3 1  ON 4
ci_06                -2.711268e-02 3 1  ON 5
ci_07                 2.814915e-02 3 1  ON 6
ci_08                -9.656665e-03 3 1  ON 7
ci_09                -1.185141e-02 3 1  ON 8
ci_10                -1.165058e-02 3 1  ON 9
ci_11                 1.378951e-02 3 1  ON 10
ci_12                 9.097695e-03 3 1  ON 11
ci_13                 1.259509e-02 3 1  ON 12
ci_14                 1.234506e-02 3 1  ON 13
ci_15                 8.734806e-03 3 1  ON 14
ci_16                 8.682122e-03 3 1  ON 15
ci_17                -8.898651e-03 3 1  ON 16
ci_18                -8.395353e-03 3 1  ON 17
ci_19                 9.908924e-03 3 1  ON 18
ci_20                 7.775077e-03 3 1  ON 19
ci_21                 9.101340e-03 3 1  ON 20
ci_22                 9.216690e-03 3 1  ON 21
ci_23                 5.352912e-03 3 1  ON 22
ci_24                 4.856662e-03 3 1  ON 23
ci_25                 3.598834e-03 3 1  ON 24
ci_26                 3.643746e-03 3 1  ON 25
ci_27                 3.666115e-03 3 1  ON 26
ci_28                 2.701187e-03 3 1  ON 27
ci_29                 2.679924e-03 3 1  ON 28
ci_30                -2.196825e-03 3 1  ON 29
ci_31                -2.337110e-03 3 1  ON 30
ci_32                -1.706345e-03 3 1  ON 31
ci_33                -1.717021e-03 3 1  ON 32
ci_34                 1.551849e-03 3 1  ON 33
ci_35                 1.638767e-03 3 1  ON 34
ci_36                -1.490011e-03 3 1  ON 35
ci_37                -1.536227e-03 3 1  ON 36
ci_38                -1.046487e-03 3 1  ON 37
ci_39                -1.137198e-03 3 1  ON 38
ci_40                -1.640942e-03 3 1  ON 39
ci_41                -1.294407e-03 3 1  ON 40
ci_42                -1.068719e-03 3 1  ON 41
ci_43                -2.492834e-03 3 1  ON 42
ci_44                -1.683149e-03 3 1  ON 43
ci_45                -9.571507e-04 3 1  ON 44
ci_46                -8.717782e-04 3 1  ON 45
ci_47                -9.411919e-05 3 1  ON 46
ci_48                -2.364756e-04 3 1  ON 47
ci_49                -1.181146e-03 3 1  ON 48
ci_50                -9.186805e-04 3 1  ON 49
ci_51                 7.833222e-04 3 1  ON 50
ci_52                 6.824747e-04 3 1  ON 51
ci_53                -1.040100e-03 3 1  ON 52
ci_54                -9.222987e-04 3 1  ON 53
ci_55                -7.002238e-04 3 1  ON 54
ci_56                 1.703831e-03 3 1  ON 55
ci_57                 1.722288e-03 3 1  ON 56
ci_58                -9.877052e-04 3 1  ON 57
ci_59                -9.114826e-04 3 1  ON 58
ci_60                 7.514735e-04 3 1  ON 59
ci_61                 7.974308e-04 3 1  ON 60
ci_62                -5.917666e-04 3 1  ON 61
ci_63                -7.957619e-04 3 1  ON 62
ci_64                -6.074391e-04 3 1  ON 63
ci_65                -4.435852e-04 3 1  ON 64
ci_66                -8.376743e-04 3 1  ON 65
ci_67                -6.834537e-04 3 1  ON 66
ci_68                -3.181875e-04 3 1  ON 67
ci_69                -1.444946e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.8318
    reference variance = 0.550087
====================================================
  Execution time = 2.5075e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8974e-01
  Total weights = 1.9638e+06
  Execution time = 3.5617e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474396911037
                                         uncertainty =       0.002175092227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474396911037
                                         uncertainty =       0.002175092227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487040561
  error estimate for blocks of size 2^( 2) =       0.000508106601
  error estimate for blocks of size 2^( 3) =       0.000528848897
  error estimate for blocks of size 2^( 4) =       0.000544448756
  error estimate for blocks of size 2^( 5) =       0.000553515504
  error estimate for blocks of size 2^( 6) =       0.000559508185
  error estimate for blocks of size 2^( 7) =       0.000563748508

      target function =      -0.714272919587
              le_mean =     -22.818086848728
             les_mean =     521.154868656400
             stat err =       0.000555305238
             autocorr =       1.299969843402
   target nu stat err =       0.000555305238
   target dn stat err =       0.002858555643
      target stat err =       0.002113423701
              std dev =       0.688779367409
             le_variance =       0.474417016968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474314681313
                                         uncertainty =       0.002177419850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474314681313
                                         uncertainty =       0.002177419850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486998358
  error estimate for blocks of size 2^( 2) =       0.000508065563
  error estimate for blocks of size 2^( 3) =       0.000528809438
  error estimate for blocks of size 2^( 4) =       0.000544411002
  error estimate for blocks of size 2^( 5) =       0.000553480248
  error estimate for blocks of size 2^( 6) =       0.000559474126
  error estimate for blocks of size 2^( 7) =       0.000563712706

      target function =      -0.714374008487
              le_mean =     -22.818086812768
             les_mean =     521.154725356458
             stat err =       0.000555269520
             autocorr =       1.300027912483
   target nu stat err =       0.000555269520
   target dn stat err =       0.002854968564
      target stat err =       0.002111521831
              std dev =       0.688719682155
             le_variance =       0.474334800587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474355312818
                                         uncertainty =       0.002176251892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474355312818
                                         uncertainty =       0.002176251892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487019212
  error estimate for blocks of size 2^( 2) =       0.000508085835
  error estimate for blocks of size 2^( 3) =       0.000528828920
  error estimate for blocks of size 2^( 4) =       0.000544429636
  error estimate for blocks of size 2^( 5) =       0.000553497640
  error estimate for blocks of size 2^( 6) =       0.000559490921
  error estimate for blocks of size 2^( 7) =       0.000563730372

      target function =      -0.714327107684
              le_mean =     -22.818086802114
             les_mean =     521.154790588896
             stat err =       0.000555287142
             autocorr =       1.299999088134
   target nu stat err =       0.000555287142
   target dn stat err =       0.002856461388
      target stat err =       0.002112286531
              std dev =       0.688749174604
             le_variance =       0.474375425517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474391675671
                                         uncertainty =       0.002175236305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474391675671
                                         uncertainty =       0.002175236305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487037875
  error estimate for blocks of size 2^( 2) =       0.000508103987
  error estimate for blocks of size 2^( 3) =       0.000528846381
  error estimate for blocks of size 2^( 4) =       0.000544446347
  error estimate for blocks of size 2^( 5) =       0.000553513253
  error estimate for blocks of size 2^( 6) =       0.000559506009
  error estimate for blocks of size 2^( 7) =       0.000563746222

      target function =      -0.714279582921
              le_mean =     -22.818086839673
             les_mean =     521.154858904538
             stat err =       0.000555302958
             autocorr =       1.299973509210
   target nu stat err =       0.000555302958
   target dn stat err =       0.002858257359
      target stat err =       0.002113255802
              std dev =       0.688775567550
             le_variance =       0.474411782454


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.714272919587        initial
     6.1035e+00     6.1035e+01             1.3370e-04        -0.714374008487  <--
     2.4414e+01     2.4414e+02             3.3599e-05        -0.714327107684
     9.7656e+01     9.7656e+02             8.4106e-06        -0.714279582921

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 4.2942e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_01                 1.411973e-01 3 1  ON 0
ci_02                -3.834642e-02 3 1  ON 1
ci_03                -3.812579e-02 3 1  ON 2
ci_04                 3.459060e-02 3 1  ON 3
ci_05                -2.771204e-02 3 1  ON 4
ci_06                -2.706667e-02 3 1  ON 5
ci_07                 2.812997e-02 3 1  ON 6
ci_08                -9.627921e-03 3 1  ON 7
ci_09                -1.183062e-02 3 1  ON 8
ci_10                -1.163863e-02 3 1  ON 9
ci_11                 1.377985e-02 3 1  ON 10
ci_12                 9.087064e-03 3 1  ON 11
ci_13                 1.257920e-02 3 1  ON 12
ci_14                 1.234286e-02 3 1  ON 13
ci_15                 8.719223e-03 3 1  ON 14
ci_16                 8.662160e-03 3 1  ON 15
ci_17                -8.884761e-03 3 1  ON 16
ci_18                -8.387137e-03 3 1  ON 17
ci_19                 9.906263e-03 3 1  ON 18
ci_20                 7.773154e-03 3 1  ON 19
ci_21                 9.097017e-03 3 1  ON 20
ci_22                 9.197107e-03 3 1  ON 21
ci_23                 5.350685e-03 3 1  ON 22
ci_24                 4.851058e-03 3 1  ON 23
ci_25                 3.599432e-03 3 1  ON 24
ci_26                 3.626980e-03 3 1  ON 25
ci_27                 3.655353e-03 3 1  ON 26
ci_28                 2.692124e-03 3 1  ON 27
ci_29                 2.676696e-03 3 1  ON 28
ci_30                -2.194406e-03 3 1  ON 29
ci_31                -2.339447e-03 3 1  ON 30
ci_32                -1.707646e-03 3 1  ON 31
ci_33                -1.696433e-03 3 1  ON 32
ci_34                 1.559689e-03 3 1  ON 33
ci_35                 1.636454e-03 3 1  ON 34
ci_36                -1.491531e-03 3 1  ON 35
ci_37                -1.527352e-03 3 1  ON 36
ci_38                -1.045722e-03 3 1  ON 37
ci_39                -1.131316e-03 3 1  ON 38
ci_40                -1.642950e-03 3 1  ON 39
ci_41                -1.291256e-03 3 1  ON 40
ci_42                -1.065598e-03 3 1  ON 41
ci_43                -2.491795e-03 3 1  ON 42
ci_44                -1.683493e-03 3 1  ON 43
ci_45                -9.520860e-04 3 1  ON 44
ci_46                -8.702810e-04 3 1  ON 45
ci_47                -9.118823e-05 3 1  ON 46
ci_48                -2.301915e-04 3 1  ON 47
ci_49                -1.180413e-03 3 1  ON 48
ci_50                -9.186211e-04 3 1  ON 49
ci_51                 7.721231e-04 3 1  ON 50
ci_52                 6.833214e-04 3 1  ON 51
ci_53                -1.034365e-03 3 1  ON 52
ci_54                -9.186337e-04 3 1  ON 53
ci_55                -6.920872e-04 3 1  ON 54
ci_56                 1.705472e-03 3 1  ON 55
ci_57                 1.717362e-03 3 1  ON 56
ci_58                -9.861988e-04 3 1  ON 57
ci_59                -9.060980e-04 3 1  ON 58
ci_60                 7.520372e-04 3 1  ON 59
ci_61                 7.903969e-04 3 1  ON 60
ci_62                -5.914744e-04 3 1  ON 61
ci_63                -7.881498e-04 3 1  ON 62
ci_64                -6.012408e-04 3 1  ON 63
ci_65                -4.410292e-04 3 1  ON 64
ci_66                -8.378857e-04 3 1  ON 65
ci_67                -6.821910e-04 3 1  ON 66
ci_68                -3.219925e-04 3 1  ON 67
ci_69                -1.563695e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3890e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.8616
    reference variance = 0.427881
====================================================
  Execution time = 2.5722e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9441e-01
  Total weights = 1.963659533e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475476394332
                                         uncertainty =       0.002873518174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475476394332
                                         uncertainty =       0.002873518174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487660764
  error estimate for blocks of size 2^( 2) =       0.000509032314
  error estimate for blocks of size 2^( 3) =       0.000529342280
  error estimate for blocks of size 2^( 4) =       0.000545002679
  error estimate for blocks of size 2^( 5) =       0.000554976039
  error estimate for blocks of size 2^( 6) =       0.000561824507
  error estimate for blocks of size 2^( 7) =       0.000564519730

      target function =      -0.710969086775
              le_mean =     -22.817487168646
             les_mean =     521.132128777799
             stat err =       0.000556580739
             autocorr =       1.302628922628
   target nu stat err =       0.000556580739
   target dn stat err =       0.004410327503
      target stat err =       0.003163480264
              std dev =       0.689656466331
             le_variance =       0.475626041553


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281748716865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710982335503       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711103902238       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711126639059       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711130151378       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711131219435       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711131387101       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711131394248       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711131398431       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711131403177       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711131398993       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.711131398523       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 5.122816e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710982335503       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711013430267       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711019197499       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711020079436       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711020342954       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711020383161       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711020384615       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711020385641       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711020386793       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711020385758       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.711020385646       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 1.296941e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710982335503       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710990154404       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710991601472       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710991822185       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710991887834       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710991897777       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710991898120       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710991898375       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710991898661       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710991898403       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710991898375       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 3.252674e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.690490 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0354e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_01                 1.410676e-01 3 1  ON 0
ci_02                -3.822917e-02 3 1  ON 1
ci_03                -3.802053e-02 3 1  ON 2
ci_04                 3.447521e-02 3 1  ON 3
ci_05                -2.764254e-02 3 1  ON 4
ci_06                -2.701905e-02 3 1  ON 5
ci_07                 2.811503e-02 3 1  ON 6
ci_08                -9.575610e-03 3 1  ON 7
ci_09                -1.179122e-02 3 1  ON 8
ci_10                -1.159134e-02 3 1  ON 9
ci_11                 1.376972e-02 3 1  ON 10
ci_12                 9.069988e-03 3 1  ON 11
ci_13                 1.257348e-02 3 1  ON 12
ci_14                 1.235120e-02 3 1  ON 13
ci_15                 8.695722e-03 3 1  ON 14
ci_16                 8.641342e-03 3 1  ON 15
ci_17                -8.851846e-03 3 1  ON 16
ci_18                -8.367004e-03 3 1  ON 17
ci_19                 9.900548e-03 3 1  ON 18
ci_20                 7.766689e-03 3 1  ON 19
ci_21                 9.097154e-03 3 1  ON 20
ci_22                 9.192839e-03 3 1  ON 21
ci_23                 5.337195e-03 3 1  ON 22
ci_24                 4.850689e-03 3 1  ON 23
ci_25                 3.589046e-03 3 1  ON 24
ci_26                 3.610504e-03 3 1  ON 25
ci_27                 3.653810e-03 3 1  ON 26
ci_28                 2.683371e-03 3 1  ON 27
ci_29                 2.657151e-03 3 1  ON 28
ci_30                -2.194036e-03 3 1  ON 29
ci_31                -2.335796e-03 3 1  ON 30
ci_32                -1.696295e-03 3 1  ON 31
ci_33                -1.679832e-03 3 1  ON 32
ci_34                 1.555565e-03 3 1  ON 33
ci_35                 1.632196e-03 3 1  ON 34
ci_36                -1.484093e-03 3 1  ON 35
ci_37                -1.527343e-03 3 1  ON 36
ci_38                -1.041313e-03 3 1  ON 37
ci_39                -1.123834e-03 3 1  ON 38
ci_40                -1.644661e-03 3 1  ON 39
ci_41                -1.277993e-03 3 1  ON 40
ci_42                -1.059718e-03 3 1  ON 41
ci_43                -2.487174e-03 3 1  ON 42
ci_44                -1.687977e-03 3 1  ON 43
ci_45                -9.570737e-04 3 1  ON 44
ci_46                -8.697975e-04 3 1  ON 45
ci_47                -8.234227e-05 3 1  ON 46
ci_48                -2.148314e-04 3 1  ON 47
ci_49                -1.175659e-03 3 1  ON 48
ci_50                -9.169283e-04 3 1  ON 49
ci_51                 7.651123e-04 3 1  ON 50
ci_52                 6.738566e-04 3 1  ON 51
ci_53                -1.027261e-03 3 1  ON 52
ci_54                -9.129575e-04 3 1  ON 53
ci_55                -6.902704e-04 3 1  ON 54
ci_56                 1.695490e-03 3 1  ON 55
ci_57                 1.725014e-03 3 1  ON 56
ci_58                -9.802744e-04 3 1  ON 57
ci_59                -8.986851e-04 3 1  ON 58
ci_60                 7.662568e-04 3 1  ON 59
ci_61                 7.935321e-04 3 1  ON 60
ci_62                -5.903612e-04 3 1  ON 61
ci_63                -7.891041e-04 3 1  ON 62
ci_64                -5.994758e-04 3 1  ON 63
ci_65                -4.452261e-04 3 1  ON 64
ci_66                -8.301472e-04 3 1  ON 65
ci_67                -6.840562e-04 3 1  ON 66
ci_68                -3.342165e-04 3 1  ON 67
ci_69                -1.688751e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.805
    reference variance = 0.321059
====================================================
  Execution time = 2.5195e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 5.0435e-01
  Total weights = 1.9637e+06
  Execution time = 3.6014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483062568367
                                         uncertainty =       0.005083719795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483062568367
                                         uncertainty =       0.005083719795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491487316
  error estimate for blocks of size 2^( 2) =       0.000512343689
  error estimate for blocks of size 2^( 3) =       0.000532329181
  error estimate for blocks of size 2^( 4) =       0.000547367954
  error estimate for blocks of size 2^( 5) =       0.000556022925
  error estimate for blocks of size 2^( 6) =       0.000561031720
  error estimate for blocks of size 2^( 7) =       0.000565236127

      target function =      -0.704036148107
              le_mean =     -22.817839977517
             les_mean =     521.158118773632
             stat err =       0.000557414682
             autocorr =       1.286270109217
   target nu stat err =       0.000557414682
   target dn stat err =       0.006878082976
      target stat err =       0.004797315819
              std dev =       0.695068028516
             le_variance =       0.483119564265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482921781134
                                         uncertainty =       0.005084405105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482921781134
                                         uncertainty =       0.005084405105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491415379
  error estimate for blocks of size 2^( 2) =       0.000512279064
  error estimate for blocks of size 2^( 3) =       0.000532274020
  error estimate for blocks of size 2^( 4) =       0.000547313359
  error estimate for blocks of size 2^( 5) =       0.000555993395
  error estimate for blocks of size 2^( 6) =       0.000561014879
  error estimate for blocks of size 2^( 7) =       0.000565174019

      target function =      -0.104717177067
              le_mean =     -22.817854350202
             les_mean =     524.454129795802
             stat err =       0.000557373913
             autocorr =       1.286458526372
   target nu stat err =       0.000557373913
   target dn stat err =       3.297615714688
      target stat err =       0.080093957654
              std dev =       0.694966293412
             le_variance =       0.482978148979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482816855504
                                         uncertainty =       0.005072909063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482816855504
                                         uncertainty =       0.005072909063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491362319
  error estimate for blocks of size 2^( 2) =       0.000512222520
  error estimate for blocks of size 2^( 3) =       0.000532212020
  error estimate for blocks of size 2^( 4) =       0.000547254873
  error estimate for blocks of size 2^( 5) =       0.000555915631
  error estimate for blocks of size 2^( 6) =       0.000560930296
  error estimate for blocks of size 2^( 7) =       0.000565125460

      target function =      -0.703569720688
              le_mean =     -22.817840443204
             les_mean =     521.158812859459
             stat err =       0.000557306565
             autocorr =       1.286425442127
   target nu stat err =       0.000557306565
   target dn stat err =       0.006939280358
      target stat err =       0.004833069655
              std dev =       0.694891255752
             le_variance =       0.482873857320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483031221204
                                         uncertainty =       0.005082317514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483031221204
                                         uncertainty =       0.005082317514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491471372
  error estimate for blocks of size 2^( 2) =       0.000512328211
  error estimate for blocks of size 2^( 3) =       0.000532314194
  error estimate for blocks of size 2^( 4) =       0.000547353473
  error estimate for blocks of size 2^( 5) =       0.000556009149
  error estimate for blocks of size 2^( 6) =       0.000561018686
  error estimate for blocks of size 2^( 7) =       0.000565221926

      target function =      -0.704045839966
              le_mean =     -22.817839971210
             les_mean =     521.158104563150
             stat err =       0.000557400809
             autocorr =       1.286289541681
   target nu stat err =       0.000557400809
   target dn stat err =       0.006873276798
      target stat err =       0.004794136683
              std dev =       0.695045479289
             le_variance =       0.483088218279


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.704036148107        initial
     1.5259e+00     1.5259e+01             5.1228e-04        -0.104717177067
     6.1035e+00     6.1035e+01             1.2969e-04        -0.703569720688
     2.4414e+01     2.4414e+02             3.2527e-05        -0.704045839966  <--

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 4.3255e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_01                 1.411648e-01 3 1  ON 0
ci_02                -3.831695e-02 3 1  ON 1
ci_03                -3.809934e-02 3 1  ON 2
ci_04                 3.456158e-02 3 1  ON 3
ci_05                -2.769457e-02 3 1  ON 4
ci_06                -2.705470e-02 3 1  ON 5
ci_07                 2.812622e-02 3 1  ON 6
ci_08                -9.614767e-03 3 1  ON 7
ci_09                -1.182072e-02 3 1  ON 8
ci_10                -1.162675e-02 3 1  ON 9
ci_11                 1.377730e-02 3 1  ON 10
ci_12                 9.082770e-03 3 1  ON 11
ci_13                 1.257777e-02 3 1  ON 12
ci_14                 1.234495e-02 3 1  ON 13
ci_15                 8.713318e-03 3 1  ON 14
ci_16                 8.656928e-03 3 1  ON 15
ci_17                -8.876493e-03 3 1  ON 16
ci_18                -8.382081e-03 3 1  ON 17
ci_19                 9.904824e-03 3 1  ON 18
ci_20                 7.771529e-03 3 1  ON 19
ci_21                 9.097052e-03 3 1  ON 20
ci_22                 9.196036e-03 3 1  ON 21
ci_23                 5.347291e-03 3 1  ON 22
ci_24                 4.850962e-03 3 1  ON 23
ci_25                 3.596820e-03 3 1  ON 24
ci_26                 3.622837e-03 3 1  ON 25
ci_27                 3.654964e-03 3 1  ON 26
ci_28                 2.689928e-03 3 1  ON 27
ci_29                 2.671786e-03 3 1  ON 28
ci_30                -2.194314e-03 3 1  ON 29
ci_31                -2.338530e-03 3 1  ON 30
ci_32                -1.704788e-03 3 1  ON 31
ci_33                -1.692255e-03 3 1  ON 32
ci_34                 1.558648e-03 3 1  ON 33
ci_35                 1.635378e-03 3 1  ON 34
ci_36                -1.489661e-03 3 1  ON 35
ci_37                -1.527351e-03 3 1  ON 36
ci_38                -1.044614e-03 3 1  ON 37
ci_39                -1.129436e-03 3 1  ON 38
ci_40                -1.643381e-03 3 1  ON 39
ci_41                -1.287917e-03 3 1  ON 40
ci_42                -1.064117e-03 3 1  ON 41
ci_43                -2.490635e-03 3 1  ON 42
ci_44                -1.684623e-03 3 1  ON 43
ci_45                -9.533418e-04 3 1  ON 44
ci_46                -8.701596e-04 3 1  ON 45
ci_47                -8.896977e-05 3 1  ON 46
ci_48                -2.263369e-04 3 1  ON 47
ci_49                -1.179218e-03 3 1  ON 48
ci_50                -9.181954e-04 3 1  ON 49
ci_51                 7.703610e-04 3 1  ON 50
ci_52                 6.809418e-04 3 1  ON 51
ci_53                -1.032578e-03 3 1  ON 52
ci_54                -9.172077e-04 3 1  ON 53
ci_55                -6.916310e-04 3 1  ON 54
ci_56                 1.702961e-03 3 1  ON 55
ci_57                 1.719286e-03 3 1  ON 56
ci_58                -9.847086e-04 3 1  ON 57
ci_59                -9.042337e-04 3 1  ON 58
ci_60                 7.556007e-04 3 1  ON 59
ci_61                 7.911843e-04 3 1  ON 60
ci_62                -5.911951e-04 3 1  ON 61
ci_63                -7.883908e-04 3 1  ON 62
ci_64                -6.007974e-04 3 1  ON 63
ci_65                -4.420852e-04 3 1  ON 64
ci_66                -8.359398e-04 3 1  ON 65
ci_67                -6.826608e-04 3 1  ON 66
ci_68                -3.250651e-04 3 1  ON 67
ci_69                -1.595111e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3615e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.7665
    reference variance = 0.702355
====================================================
  Execution time = 2.5697e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9247e-01
  Total weights = 1.963930730e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476046943355
                                         uncertainty =       0.003116739264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476046943355
                                         uncertainty =       0.003116739264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487827405
  error estimate for blocks of size 2^( 2) =       0.000508486284
  error estimate for blocks of size 2^( 3) =       0.000528477002
  error estimate for blocks of size 2^( 4) =       0.000543072748
  error estimate for blocks of size 2^( 5) =       0.000552846237
  error estimate for blocks of size 2^( 6) =       0.000557917169
  error estimate for blocks of size 2^( 7) =       0.000561949785

      target function =      -0.712362261576
              le_mean =     -22.818421381577
             les_mean =     521.172820708614
             stat err =       0.000553946485
             autocorr =       1.289446217580
   target nu stat err =       0.000553946485
   target dn stat err =       0.004185549915
      target stat err =       0.003022359396
              std dev =       0.689892132546
             le_variance =       0.475951154550


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281842138158e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712374090338       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712401011438       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712405265806       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712405914757       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712406197058       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712406301302       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712406331827       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712406336605       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712406338283       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712406338441       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 1.235597e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712374090338       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712380859420       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712381926885       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712382089299       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712382159806       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712382185690       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712382193262       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712382194445       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712382194860       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712382194899       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 3.098765e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712374090338       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712375785051       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712376052161       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712376092775       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712376110397       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712376116857       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712376118746       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712376119042       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712376119145       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712376119155       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 7.753047e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.694001 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0315e+01
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_01                 1.411338e-01 3 1  ON 0
ci_02                -3.828935e-02 3 1  ON 1
ci_03                -3.807359e-02 3 1  ON 2
ci_04                 3.453298e-02 3 1  ON 3
ci_05                -2.768308e-02 3 1  ON 4
ci_06                -2.704081e-02 3 1  ON 5
ci_07                 2.812142e-02 3 1  ON 6
ci_08                -9.602549e-03 3 1  ON 7
ci_09                -1.181335e-02 3 1  ON 8
ci_10                -1.161848e-02 3 1  ON 9
ci_11                 1.377481e-02 3 1  ON 10
ci_12                 9.078803e-03 3 1  ON 11
ci_13                 1.257656e-02 3 1  ON 12
ci_14                 1.234772e-02 3 1  ON 13
ci_15                 8.708490e-03 3 1  ON 14
ci_16                 8.650501e-03 3 1  ON 15
ci_17                -8.873578e-03 3 1  ON 16
ci_18                -8.375661e-03 3 1  ON 17
ci_19                 9.904308e-03 3 1  ON 18
ci_20                 7.769014e-03 3 1  ON 19
ci_21                 9.095964e-03 3 1  ON 20
ci_22                 9.195613e-03 3 1  ON 21
ci_23                 5.345581e-03 3 1  ON 22
ci_24                 4.849037e-03 3 1  ON 23
ci_25                 3.595376e-03 3 1  ON 24
ci_26                 3.621563e-03 3 1  ON 25
ci_27                 3.652703e-03 3 1  ON 26
ci_28                 2.685965e-03 3 1  ON 27
ci_29                 2.668935e-03 3 1  ON 28
ci_30                -2.190920e-03 3 1  ON 29
ci_31                -2.335724e-03 3 1  ON 30
ci_32                -1.703405e-03 3 1  ON 31
ci_33                -1.687087e-03 3 1  ON 32
ci_34                 1.556518e-03 3 1  ON 33
ci_35                 1.632319e-03 3 1  ON 34
ci_36                -1.487450e-03 3 1  ON 35
ci_37                -1.527228e-03 3 1  ON 36
ci_38                -1.044711e-03 3 1  ON 37
ci_39                -1.127407e-03 3 1  ON 38
ci_40                -1.642876e-03 3 1  ON 39
ci_41                -1.288060e-03 3 1  ON 40
ci_42                -1.063593e-03 3 1  ON 41
ci_43                -2.489018e-03 3 1  ON 42
ci_44                -1.688342e-03 3 1  ON 43
ci_45                -9.537262e-04 3 1  ON 44
ci_46                -8.689752e-04 3 1  ON 45
ci_47                -8.651114e-05 3 1  ON 46
ci_48                -2.246891e-04 3 1  ON 47
ci_49                -1.179137e-03 3 1  ON 48
ci_50                -9.164860e-04 3 1  ON 49
ci_51                 7.692881e-04 3 1  ON 50
ci_52                 6.804192e-04 3 1  ON 51
ci_53                -1.031462e-03 3 1  ON 52
ci_54                -9.182021e-04 3 1  ON 53
ci_55                -6.907083e-04 3 1  ON 54
ci_56                 1.703594e-03 3 1  ON 55
ci_57                 1.721907e-03 3 1  ON 56
ci_58                -9.852321e-04 3 1  ON 57
ci_59                -9.032499e-04 3 1  ON 58
ci_60                 7.533999e-04 3 1  ON 59
ci_61                 7.909900e-04 3 1  ON 60
ci_62                -5.904411e-04 3 1  ON 61
ci_63                -7.874918e-04 3 1  ON 62
ci_64                -6.024232e-04 3 1  ON 63
ci_65                -4.414268e-04 3 1  ON 64
ci_66                -8.355093e-04 3 1  ON 65
ci_67                -6.823351e-04 3 1  ON 66
ci_68                -3.275018e-04 3 1  ON 67
ci_69                -1.620065e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.8511
    reference variance = 0.373512
====================================================
  Execution time = 2.5208e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9324e-01
  Total weights = 1.9635e+06
  Execution time = 3.5907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477259973401
                                         uncertainty =       0.002710582821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477259973401
                                         uncertainty =       0.002710582821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488563476
  error estimate for blocks of size 2^( 2) =       0.000509436046
  error estimate for blocks of size 2^( 3) =       0.000529043289
  error estimate for blocks of size 2^( 4) =       0.000543843726
  error estimate for blocks of size 2^( 5) =       0.000553820344
  error estimate for blocks of size 2^( 6) =       0.000557822852
  error estimate for blocks of size 2^( 7) =       0.000559339244

      target function =      -0.711813198178
              le_mean =     -22.817872365477
             les_mean =     521.148533368144
             stat err =       0.000553706542
             autocorr =       1.284450329517
   target nu stat err =       0.000553706542
   target dn stat err =       0.003108018961
      target stat err =       0.002269317973
              std dev =       0.690933094287
             le_variance =       0.477388540781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477165138608
                                         uncertainty =       0.002709842773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477165138608
                                         uncertainty =       0.002709842773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488514951
  error estimate for blocks of size 2^( 2) =       0.000509388568
  error estimate for blocks of size 2^( 3) =       0.000528997552
  error estimate for blocks of size 2^( 4) =       0.000543800731
  error estimate for blocks of size 2^( 5) =       0.000553779334
  error estimate for blocks of size 2^( 6) =       0.000557783244
  error estimate for blocks of size 2^( 7) =       0.000559301859

      target function =      -0.711608624816
              le_mean =     -22.817872501105
             les_mean =     521.148828288682
             stat err =       0.000553666292
             autocorr =       1.284518747229
   target nu stat err =       0.000553666292
   target dn stat err =       0.003138225799
      target stat err =       0.002288792382
              std dev =       0.690864469624
             le_variance =       0.477293715389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477212110466
                                         uncertainty =       0.002710207345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477212110466
                                         uncertainty =       0.002710207345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488538987
  error estimate for blocks of size 2^( 2) =       0.000509412090
  error estimate for blocks of size 2^( 3) =       0.000529020205
  error estimate for blocks of size 2^( 4) =       0.000543822057
  error estimate for blocks of size 2^( 5) =       0.000553799688
  error estimate for blocks of size 2^( 6) =       0.000557802904
  error estimate for blocks of size 2^( 7) =       0.000559320368

      target function =      -0.711800818465
              le_mean =     -22.817872400045
             les_mean =     521.148552367704
             stat err =       0.000553686254
             autocorr =       1.284484977810
   target nu stat err =       0.000553686254
   target dn stat err =       0.003117454149
      target stat err =       0.002275720057
              std dev =       0.690898460562
             le_variance =       0.477340682807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477253960947
                                         uncertainty =       0.002710535318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477253960947
                                         uncertainty =       0.002710535318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488560400
  error estimate for blocks of size 2^( 2) =       0.000509433037
  error estimate for blocks of size 2^( 3) =       0.000529040388
  error estimate for blocks of size 2^( 4) =       0.000543841001
  error estimate for blocks of size 2^( 5) =       0.000553817747
  error estimate for blocks of size 2^( 6) =       0.000557820342
  error estimate for blocks of size 2^( 7) =       0.000559336865

      target function =      -0.711815545534
              le_mean =     -22.817872367740
             les_mean =     521.148530150916
             stat err =       0.000553703988
             autocorr =       1.284454659575
   target nu stat err =       0.000553703988
   target dn stat err =       0.003109081734
      target stat err =       0.002270062156
              std dev =       0.690928743772
             le_variance =       0.477382528971


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.711813198178        initial
     6.1035e+00     6.1035e+01             1.2356e-04        -0.711608624816
     2.4414e+01     2.4414e+02             3.0988e-05        -0.711800818465
     9.7656e+01     9.7656e+02             7.7530e-06        -0.711815545534  <--

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 4.3248e+01
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_01                 1.411570e-01 3 1  ON 0
ci_02                -3.831004e-02 3 1  ON 1
ci_03                -3.809289e-02 3 1  ON 2
ci_04                 3.455442e-02 3 1  ON 3
ci_05                -2.769169e-02 3 1  ON 4
ci_06                -2.705122e-02 3 1  ON 5
ci_07                 2.812502e-02 3 1  ON 6
ci_08                -9.611708e-03 3 1  ON 7
ci_09                -1.181888e-02 3 1  ON 8
ci_10                -1.162468e-02 3 1  ON 9
ci_11                 1.377668e-02 3 1  ON 10
ci_12                 9.081777e-03 3 1  ON 11
ci_13                 1.257747e-02 3 1  ON 12
ci_14                 1.234564e-02 3 1  ON 13
ci_15                 8.712110e-03 3 1  ON 14
ci_16                 8.655319e-03 3 1  ON 15
ci_17                -8.875764e-03 3 1  ON 16
ci_18                -8.380474e-03 3 1  ON 17
ci_19                 9.904694e-03 3 1  ON 18
ci_20                 7.770899e-03 3 1  ON 19
ci_21                 9.096780e-03 3 1  ON 20
ci_22                 9.195930e-03 3 1  ON 21
ci_23                 5.346863e-03 3 1  ON 22
ci_24                 4.850480e-03 3 1  ON 23
ci_25                 3.596458e-03 3 1  ON 24
ci_26                 3.622518e-03 3 1  ON 25
ci_27                 3.654398e-03 3 1  ON 26
ci_28                 2.688936e-03 3 1  ON 27
ci_29                 2.671072e-03 3 1  ON 28
ci_30                -2.193465e-03 3 1  ON 29
ci_31                -2.337828e-03 3 1  ON 30
ci_32                -1.704441e-03 3 1  ON 31
ci_33                -1.690961e-03 3 1  ON 32
ci_34                 1.558115e-03 3 1  ON 33
ci_35                 1.634612e-03 3 1  ON 34
ci_36                -1.489108e-03 3 1  ON 35
ci_37                -1.527320e-03 3 1  ON 36
ci_38                -1.044638e-03 3 1  ON 37
ci_39                -1.128928e-03 3 1  ON 38
ci_40                -1.643255e-03 3 1  ON 39
ci_41                -1.287953e-03 3 1  ON 40
ci_42                -1.063986e-03 3 1  ON 41
ci_43                -2.490231e-03 3 1  ON 42
ci_44                -1.685554e-03 3 1  ON 43
ci_45                -9.534381e-04 3 1  ON 44
ci_46                -8.698631e-04 3 1  ON 45
ci_47                -8.835461e-05 3 1  ON 46
ci_48                -2.259247e-04 3 1  ON 47
ci_49                -1.179198e-03 3 1  ON 48
ci_50                -9.177674e-04 3 1  ON 49
ci_51                 7.700924e-04 3 1  ON 50
ci_52                 6.808110e-04 3 1  ON 51
ci_53                -1.032298e-03 3 1  ON 52
ci_54                -9.174566e-04 3 1  ON 53
ci_55                -6.914000e-04 3 1  ON 54
ci_56                 1.703119e-03 3 1  ON 55
ci_57                 1.719942e-03 3 1  ON 56
ci_58                -9.848396e-04 3 1  ON 57
ci_59                -9.039874e-04 3 1  ON 58
ci_60                 7.550501e-04 3 1  ON 59
ci_61                 7.911357e-04 3 1  ON 60
ci_62                -5.910063e-04 3 1  ON 61
ci_63                -7.881657e-04 3 1  ON 62
ci_64                -6.012045e-04 3 1  ON 63
ci_65                -4.419204e-04 3 1  ON 64
ci_66                -8.358320e-04 3 1  ON 65
ci_67                -6.825793e-04 3 1  ON 66
ci_68                -3.256751e-04 3 1  ON 67
ci_69                -1.601358e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3569e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.7752
    reference variance = 0.581792
====================================================
  Execution time = 2.5751e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5374e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9236e-01
  Total weights = 1.963958750e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478545367779
                                         uncertainty =       0.004189757492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478545367779
                                         uncertainty =       0.004189757492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489097458
  error estimate for blocks of size 2^( 2) =       0.000510260947
  error estimate for blocks of size 2^( 3) =       0.000529996737
  error estimate for blocks of size 2^( 4) =       0.000545897630
  error estimate for blocks of size 2^( 5) =       0.000556864346
  error estimate for blocks of size 2^( 6) =       0.000563627210
  error estimate for blocks of size 2^( 7) =       0.000568932458

      target function =      -0.712430596101
              le_mean =     -22.817846423835
             les_mean =     521.146470698350
             stat err =       0.000558830411
             autocorr =       1.305477084698
   target nu stat err =       0.000558830411
   target dn stat err =       0.004092869887
      target stat err =       0.002956783387
              std dev =       0.691688257865
             le_variance =       0.478432646068


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281784642384e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712442125546       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712448362007       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712449593760       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712449812284       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712449899820       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712449916900       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712449920983       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712449920852       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712449920483       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712449920459       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 3.997956e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712442125546       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712443686913       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712443995122       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712444049758       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712444071628       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712444075887       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712444076905       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712444076872       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712444076780       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712444076774       residual = 8.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 1.000268e-05

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712442125546       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712442516029       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712442593098       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712442606758       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712442612224       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712442613289       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712442613542       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712442613534       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712442613511       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712442613510       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 2.501157e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.697491 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0392e+01
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_01                 1.411470e-01 3 1  ON 0
ci_02                -3.830368e-02 3 1  ON 1
ci_03                -3.808716e-02 3 1  ON 2
ci_04                 3.454773e-02 3 1  ON 3
ci_05                -2.768801e-02 3 1  ON 4
ci_06                -2.704691e-02 3 1  ON 5
ci_07                 2.812347e-02 3 1  ON 6
ci_08                -9.608985e-03 3 1  ON 7
ci_09                -1.181701e-02 3 1  ON 8
ci_10                -1.162258e-02 3 1  ON 9
ci_11                 1.377580e-02 3 1  ON 10
ci_12                 9.081272e-03 3 1  ON 11
ci_13                 1.257746e-02 3 1  ON 12
ci_14                 1.234567e-02 3 1  ON 13
ci_15                 8.711441e-03 3 1  ON 14
ci_16                 8.654626e-03 3 1  ON 15
ci_17                -8.874068e-03 3 1  ON 16
ci_18                -8.378777e-03 3 1  ON 17
ci_19                 9.904310e-03 3 1  ON 18
ci_20                 7.770238e-03 3 1  ON 19
ci_21                 9.096156e-03 3 1  ON 20
ci_22                 9.196033e-03 3 1  ON 21
ci_23                 5.346528e-03 3 1  ON 22
ci_24                 4.850302e-03 3 1  ON 23
ci_25                 3.595850e-03 3 1  ON 24
ci_26                 3.622300e-03 3 1  ON 25
ci_27                 3.653992e-03 3 1  ON 26
ci_28                 2.688429e-03 3 1  ON 27
ci_29                 2.670205e-03 3 1  ON 28
ci_30                -2.192537e-03 3 1  ON 29
ci_31                -2.337463e-03 3 1  ON 30
ci_32                -1.703395e-03 3 1  ON 31
ci_33                -1.690403e-03 3 1  ON 32
ci_34                 1.558129e-03 3 1  ON 33
ci_35                 1.634401e-03 3 1  ON 34
ci_36                -1.488823e-03 3 1  ON 35
ci_37                -1.526731e-03 3 1  ON 36
ci_38                -1.044650e-03 3 1  ON 37
ci_39                -1.128636e-03 3 1  ON 38
ci_40                -1.643477e-03 3 1  ON 39
ci_41                -1.287800e-03 3 1  ON 40
ci_42                -1.063366e-03 3 1  ON 41
ci_43                -2.490085e-03 3 1  ON 42
ci_44                -1.685908e-03 3 1  ON 43
ci_45                -9.530621e-04 3 1  ON 44
ci_46                -8.697299e-04 3 1  ON 45
ci_47                -8.740854e-05 3 1  ON 46
ci_48                -2.254963e-04 3 1  ON 47
ci_49                -1.179162e-03 3 1  ON 48
ci_50                -9.175856e-04 3 1  ON 49
ci_51                 7.696644e-04 3 1  ON 50
ci_52                 6.808311e-04 3 1  ON 51
ci_53                -1.031989e-03 3 1  ON 52
ci_54                -9.171368e-04 3 1  ON 53
ci_55                -6.913970e-04 3 1  ON 54
ci_56                 1.703194e-03 3 1  ON 55
ci_57                 1.719963e-03 3 1  ON 56
ci_58                -9.852378e-04 3 1  ON 57
ci_59                -9.042891e-04 3 1  ON 58
ci_60                 7.553427e-04 3 1  ON 59
ci_61                 7.906803e-04 3 1  ON 60
ci_62                -5.908897e-04 3 1  ON 61
ci_63                -7.875053e-04 3 1  ON 62
ci_64                -6.009810e-04 3 1  ON 63
ci_65                -4.418134e-04 3 1  ON 64
ci_66                -8.354973e-04 3 1  ON 65
ci_67                -6.825214e-04 3 1  ON 66
ci_68                -3.261789e-04 3 1  ON 67
ci_69                -1.606095e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.7223
    reference variance = 0.317389
====================================================
  Execution time = 2.5257e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9053e-01
  Total weights = 1.9637e+06
  Execution time = 3.5814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472991768207
                                         uncertainty =       0.002436687515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472991768207
                                         uncertainty =       0.002436687515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486297884
  error estimate for blocks of size 2^( 2) =       0.000506935454
  error estimate for blocks of size 2^( 3) =       0.000526469312
  error estimate for blocks of size 2^( 4) =       0.000541617148
  error estimate for blocks of size 2^( 5) =       0.000550559021
  error estimate for blocks of size 2^( 6) =       0.000556846618
  error estimate for blocks of size 2^( 7) =       0.000561007377

      target function =      -0.713719695183
              le_mean =     -22.817339738243
             les_mean =     521.121525219633
             stat err =       0.000552507541
             autocorr =       1.290837755010
   target nu stat err =       0.000552507541
   target dn stat err =       0.003268281362
      target stat err =       0.002389964012
              std dev =       0.687729063261
             le_variance =       0.472971264453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472968994581
                                         uncertainty =       0.002436457754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472968994581
                                         uncertainty =       0.002436457754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486286177
  error estimate for blocks of size 2^( 2) =       0.000506923863
  error estimate for blocks of size 2^( 3) =       0.000526458019
  error estimate for blocks of size 2^( 4) =       0.000541606273
  error estimate for blocks of size 2^( 5) =       0.000550548352
  error estimate for blocks of size 2^( 6) =       0.000556835516
  error estimate for blocks of size 2^( 7) =       0.000560995031

      target function =      -0.713714777670
              le_mean =     -22.817339695493
             les_mean =     521.121530125451
             stat err =       0.000552496293
             autocorr =       1.290847349848
   target nu stat err =       0.000552496293
   target dn stat err =       0.003276458340
      target stat err =       0.002395591507
              std dev =       0.687712506602
             le_variance =       0.472948491737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472980354726
                                         uncertainty =       0.002436571968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472980354726
                                         uncertainty =       0.002436571968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486292017
  error estimate for blocks of size 2^( 2) =       0.000506929644
  error estimate for blocks of size 2^( 3) =       0.000526463651
  error estimate for blocks of size 2^( 4) =       0.000541611696
  error estimate for blocks of size 2^( 5) =       0.000550553671
  error estimate for blocks of size 2^( 6) =       0.000556841053
  error estimate for blocks of size 2^( 7) =       0.000561001189

      target function =      -0.713718895143
              le_mean =     -22.817339714802
             les_mean =     521.121525248560
             stat err =       0.000552501902
             autocorr =       1.290842558038
   target nu stat err =       0.000552501902
   target dn stat err =       0.003272143999
      target stat err =       0.002392632104
              std dev =       0.687720765594
             le_variance =       0.472959851429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472990339765
                                         uncertainty =       0.002436673011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472990339765
                                         uncertainty =       0.002436673011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486297150
  error estimate for blocks of size 2^( 2) =       0.000506934727
  error estimate for blocks of size 2^( 3) =       0.000526468604
  error estimate for blocks of size 2^( 4) =       0.000541616465
  error estimate for blocks of size 2^( 5) =       0.000550558351
  error estimate for blocks of size 2^( 6) =       0.000556845922
  error estimate for blocks of size 2^( 7) =       0.000561006602

      target function =      -0.713719806905
              le_mean =     -22.817339735074
             les_mean =     521.121524914971
             stat err =       0.000552506835
             autocorr =       1.290838355502
   target nu stat err =       0.000552506835
   target dn stat err =       0.003268738903
      target stat err =       0.002390281383
              std dev =       0.687728024780
             le_variance =       0.472969836068


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.713719695183        initial
     2.4414e+01     2.4414e+02             3.9980e-05        -0.713714777670
     9.7656e+01     9.7656e+02             1.0003e-05        -0.713718895143
     3.9062e+02     3.9062e+03             2.5012e-06        -0.713719806905  <--

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 4.3214e+01
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_01                 1.411545e-01 3 1  ON 0
ci_02                -3.830845e-02 3 1  ON 1
ci_03                -3.809146e-02 3 1  ON 2
ci_04                 3.455275e-02 3 1  ON 3
ci_05                -2.769077e-02 3 1  ON 4
ci_06                -2.705014e-02 3 1  ON 5
ci_07                 2.812463e-02 3 1  ON 6
ci_08                -9.611027e-03 3 1  ON 7
ci_09                -1.181841e-02 3 1  ON 8
ci_10                -1.162416e-02 3 1  ON 9
ci_11                 1.377646e-02 3 1  ON 10
ci_12                 9.081651e-03 3 1  ON 11
ci_13                 1.257746e-02 3 1  ON 12
ci_14                 1.234565e-02 3 1  ON 13
ci_15                 8.711942e-03 3 1  ON 14
ci_16                 8.655146e-03 3 1  ON 15
ci_17                -8.875340e-03 3 1  ON 16
ci_18                -8.380050e-03 3 1  ON 17
ci_19                 9.904598e-03 3 1  ON 18
ci_20                 7.770734e-03 3 1  ON 19
ci_21                 9.096624e-03 3 1  ON 20
ci_22                 9.195956e-03 3 1  ON 21
ci_23                 5.346779e-03 3 1  ON 22
ci_24                 4.850436e-03 3 1  ON 23
ci_25                 3.596306e-03 3 1  ON 24
ci_26                 3.622463e-03 3 1  ON 25
ci_27                 3.654296e-03 3 1  ON 26
ci_28                 2.688809e-03 3 1  ON 27
ci_29                 2.670856e-03 3 1  ON 28
ci_30                -2.193233e-03 3 1  ON 29
ci_31                -2.337737e-03 3 1  ON 30
ci_32                -1.704180e-03 3 1  ON 31
ci_33                -1.690821e-03 3 1  ON 32
ci_34                 1.558118e-03 3 1  ON 33
ci_35                 1.634559e-03 3 1  ON 34
ci_36                -1.489036e-03 3 1  ON 35
ci_37                -1.527173e-03 3 1  ON 36
ci_38                -1.044641e-03 3 1  ON 37
ci_39                -1.128855e-03 3 1  ON 38
ci_40                -1.643310e-03 3 1  ON 39
ci_41                -1.287915e-03 3 1  ON 40
ci_42                -1.063831e-03 3 1  ON 41
ci_43                -2.490194e-03 3 1  ON 42
ci_44                -1.685643e-03 3 1  ON 43
ci_45                -9.533440e-04 3 1  ON 44
ci_46                -8.698298e-04 3 1  ON 45
ci_47                -8.811804e-05 3 1  ON 46
ci_48                -2.258175e-04 3 1  ON 47
ci_49                -1.179189e-03 3 1  ON 48
ci_50                -9.177219e-04 3 1  ON 49
ci_51                 7.699854e-04 3 1  ON 50
ci_52                 6.808160e-04 3 1  ON 51
ci_53                -1.032221e-03 3 1  ON 52
ci_54                -9.173767e-04 3 1  ON 53
ci_55                -6.913993e-04 3 1  ON 54
ci_56                 1.703138e-03 3 1  ON 55
ci_57                 1.719947e-03 3 1  ON 56
ci_58                -9.849392e-04 3 1  ON 57
ci_59                -9.040628e-04 3 1  ON 58
ci_60                 7.551233e-04 3 1  ON 59
ci_61                 7.910218e-04 3 1  ON 60
ci_62                -5.909772e-04 3 1  ON 61
ci_63                -7.880006e-04 3 1  ON 62
ci_64                -6.011486e-04 3 1  ON 63
ci_65                -4.418936e-04 3 1  ON 64
ci_66                -8.357483e-04 3 1  ON 65
ci_67                -6.825648e-04 3 1  ON 66
ci_68                -3.258011e-04 3 1  ON 67
ci_69                -1.602543e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3612e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.7637
    reference variance = 0.292901
====================================================
  Execution time = 2.5633e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5353e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 5.1002e-01
  Total weights = 1.963333625e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479467203805
                                         uncertainty =       0.003194644327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479467203805
                                         uncertainty =       0.003194644327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489681302
  error estimate for blocks of size 2^( 2) =       0.000510731702
  error estimate for blocks of size 2^( 3) =       0.000530955808
  error estimate for blocks of size 2^( 4) =       0.000545672314
  error estimate for blocks of size 2^( 5) =       0.000554863791
  error estimate for blocks of size 2^( 6) =       0.000559785641
  error estimate for blocks of size 2^( 7) =       0.000563982511

      target function =      -0.700062854468
              le_mean =     -22.818385712844
             les_mean =     521.188750392629
             stat err =       0.000556076064
             autocorr =       1.289559429423
   target nu stat err =       0.000556076064
   target dn stat err =       0.009525489787
      target stat err =       0.006553869710
              std dev =       0.692513938405
             le_variance =       0.479575554885


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281838571284e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.700123344778       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.700125340545       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.700125618519       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.700125675270       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.700125689112       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.700125692895       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.700125696938       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.700125696878       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.700125697045       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.700125697043       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.700125696973       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 7.363468e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.700123344778       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.700123843894       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.700123913403       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.700123927592       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.700123931051       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.700123931996       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.700123933007       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.700123932992       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.700123933034       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.700123933033       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.700123933016       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 1.841538e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.700123344778       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.700123469568       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.700123486946       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.700123490493       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.700123491358       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.700123491595       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.700123491847       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.700123491845       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.700123491855       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.700123491857       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.700123491850       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 4.604266e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.701553 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0250e+01
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_01                 1.411530e-01 3 1  ON 0
ci_02                -3.830698e-02 3 1  ON 1
ci_03                -3.809017e-02 3 1  ON 2
ci_04                 3.455091e-02 3 1  ON 3
ci_05                -2.768969e-02 3 1  ON 4
ci_06                -2.704887e-02 3 1  ON 5
ci_07                 2.812451e-02 3 1  ON 6
ci_08                -9.610495e-03 3 1  ON 7
ci_09                -1.181825e-02 3 1  ON 8
ci_10                -1.162365e-02 3 1  ON 9
ci_11                 1.377730e-02 3 1  ON 10
ci_12                 9.081367e-03 3 1  ON 11
ci_13                 1.257749e-02 3 1  ON 12
ci_14                 1.234571e-02 3 1  ON 13
ci_15                 8.710864e-03 3 1  ON 14
ci_16                 8.655046e-03 3 1  ON 15
ci_17                -8.875178e-03 3 1  ON 16
ci_18                -8.379444e-03 3 1  ON 17
ci_19                 9.904537e-03 3 1  ON 18
ci_20                 7.770439e-03 3 1  ON 19
ci_21                 9.096680e-03 3 1  ON 20
ci_22                 9.195746e-03 3 1  ON 21
ci_23                 5.346728e-03 3 1  ON 22
ci_24                 4.849846e-03 3 1  ON 23
ci_25                 3.596204e-03 3 1  ON 24
ci_26                 3.622360e-03 3 1  ON 25
ci_27                 3.653992e-03 3 1  ON 26
ci_28                 2.688572e-03 3 1  ON 27
ci_29                 2.670752e-03 3 1  ON 28
ci_30                -2.193360e-03 3 1  ON 29
ci_31                -2.337117e-03 3 1  ON 30
ci_32                -1.703830e-03 3 1  ON 31
ci_33                -1.690718e-03 3 1  ON 32
ci_34                 1.558019e-03 3 1  ON 33
ci_35                 1.634690e-03 3 1  ON 34
ci_36                -1.488978e-03 3 1  ON 35
ci_37                -1.527112e-03 3 1  ON 36
ci_38                -1.044824e-03 3 1  ON 37
ci_39                -1.128728e-03 3 1  ON 38
ci_40                -1.643304e-03 3 1  ON 39
ci_41                -1.288012e-03 3 1  ON 40
ci_42                -1.063977e-03 3 1  ON 41
ci_43                -2.490265e-03 3 1  ON 42
ci_44                -1.685494e-03 3 1  ON 43
ci_45                -9.532104e-04 3 1  ON 44
ci_46                -8.699222e-04 3 1  ON 45
ci_47                -8.808395e-05 3 1  ON 46
ci_48                -2.264382e-04 3 1  ON 47
ci_49                -1.179154e-03 3 1  ON 48
ci_50                -9.176863e-04 3 1  ON 49
ci_51                 7.706539e-04 3 1  ON 50
ci_52                 6.804949e-04 3 1  ON 51
ci_53                -1.032149e-03 3 1  ON 52
ci_54                -9.174531e-04 3 1  ON 53
ci_55                -6.915365e-04 3 1  ON 54
ci_56                 1.703057e-03 3 1  ON 55
ci_57                 1.719938e-03 3 1  ON 56
ci_58                -9.848778e-04 3 1  ON 57
ci_59                -9.039999e-04 3 1  ON 58
ci_60                 7.543444e-04 3 1  ON 59
ci_61                 7.908789e-04 3 1  ON 60
ci_62                -5.911171e-04 3 1  ON 61
ci_63                -7.879696e-04 3 1  ON 62
ci_64                -6.011306e-04 3 1  ON 63
ci_65                -4.419184e-04 3 1  ON 64
ci_66                -8.357622e-04 3 1  ON 65
ci_67                -6.827023e-04 3 1  ON 66
ci_68                -3.259233e-04 3 1  ON 67
ci_69                -1.602341e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.8944
    reference variance = 0.560812
====================================================
  Execution time = 2.7008e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8909e-01
  Total weights = 1.9634e+06
  Execution time = 3.5921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473118809456
                                         uncertainty =       0.002124985492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473118809456
                                         uncertainty =       0.002124985492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486389755
  error estimate for blocks of size 2^( 2) =       0.000507479359
  error estimate for blocks of size 2^( 3) =       0.000526860967
  error estimate for blocks of size 2^( 4) =       0.000541837895
  error estimate for blocks of size 2^( 5) =       0.000552441946
  error estimate for blocks of size 2^( 6) =       0.000556526202
  error estimate for blocks of size 2^( 7) =       0.000557458669

      target function =      -0.714731128101
              le_mean =     -22.817656774035
             les_mean =     521.134584243405
             stat err =       0.000552066178
             autocorr =       1.288289431415
   target nu stat err =       0.000552066178
   target dn stat err =       0.003251702002
      target stat err =       0.002386005123
              std dev =       0.687858988600
             le_variance =       0.473149988198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473112893142
                                         uncertainty =       0.002124949718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473112893142
                                         uncertainty =       0.002124949718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486386712
  error estimate for blocks of size 2^( 2) =       0.000507476365
  error estimate for blocks of size 2^( 3) =       0.000526858074
  error estimate for blocks of size 2^( 4) =       0.000541835123
  error estimate for blocks of size 2^( 5) =       0.000552439284
  error estimate for blocks of size 2^( 6) =       0.000556523836
  error estimate for blocks of size 2^( 7) =       0.000557456400

      target function =      -0.714763083849
              le_mean =     -22.817656770619
             les_mean =     521.134539326461
             stat err =       0.000552063661
             autocorr =       1.288293806804
   target nu stat err =       0.000552063661
   target dn stat err =       0.003251783235
      target stat err =       0.002386268625
              std dev =       0.687854684352
             le_variance =       0.473144066784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473115849503
                                         uncertainty =       0.002124967594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473115849503
                                         uncertainty =       0.002124967594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486388233
  error estimate for blocks of size 2^( 2) =       0.000507477861
  error estimate for blocks of size 2^( 3) =       0.000526859519
  error estimate for blocks of size 2^( 4) =       0.000541836508
  error estimate for blocks of size 2^( 5) =       0.000552440614
  error estimate for blocks of size 2^( 6) =       0.000556525018
  error estimate for blocks of size 2^( 7) =       0.000557457533

      target function =      -0.714759666809
              le_mean =     -22.817656772123
             les_mean =     521.134544182037
             stat err =       0.000552064918
             autocorr =       1.288291618904
   target nu stat err =       0.000552064918
   target dn stat err =       0.003251656842
      target stat err =       0.002386158915
              std dev =       0.687856835174
             le_variance =       0.473147025695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473118439340
                                         uncertainty =       0.002124983254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473118439340
                                         uncertainty =       0.002124983254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486389565
  error estimate for blocks of size 2^( 2) =       0.000507479172
  error estimate for blocks of size 2^( 3) =       0.000526860786
  error estimate for blocks of size 2^( 4) =       0.000541837721
  error estimate for blocks of size 2^( 5) =       0.000552441779
  error estimate for blocks of size 2^( 6) =       0.000556526054
  error estimate for blocks of size 2^( 7) =       0.000557458527

      target function =      -0.714748799719
              le_mean =     -22.817656773725
             les_mean =     521.134559477055
             stat err =       0.000552066020
             autocorr =       1.288289704283
   target nu stat err =       0.000552066020
   target dn stat err =       0.003251559449
      target stat err =       0.002386020903
              std dev =       0.687858719334
             le_variance =       0.473149617764


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.714731128101        initial
     9.7656e+01     9.7656e+02             7.3635e-06        -0.714763083849  <--
     3.9062e+02     3.9062e+03             1.8415e-06        -0.714759666809
     1.5625e+03     1.5625e+04             4.6043e-07        -0.714748799719

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 4.5007e+01
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_01                 1.411483e-01 3 1  ON 0
ci_02                -3.830255e-02 3 1  ON 1
ci_03                -3.808631e-02 3 1  ON 2
ci_04                 3.454539e-02 3 1  ON 3
ci_05                -2.768646e-02 3 1  ON 4
ci_06                -2.704507e-02 3 1  ON 5
ci_07                 2.812414e-02 3 1  ON 6
ci_08                -9.608898e-03 3 1  ON 7
ci_09                -1.181777e-02 3 1  ON 8
ci_10                -1.162214e-02 3 1  ON 9
ci_11                 1.377983e-02 3 1  ON 10
ci_12                 9.080515e-03 3 1  ON 11
ci_13                 1.257757e-02 3 1  ON 12
ci_14                 1.234591e-02 3 1  ON 13
ci_15                 8.707632e-03 3 1  ON 14
ci_16                 8.654745e-03 3 1  ON 15
ci_17                -8.874692e-03 3 1  ON 16
ci_18                -8.377629e-03 3 1  ON 17
ci_19                 9.904354e-03 3 1  ON 18
ci_20                 7.769557e-03 3 1  ON 19
ci_21                 9.096848e-03 3 1  ON 20
ci_22                 9.195114e-03 3 1  ON 21
ci_23                 5.346576e-03 3 1  ON 22
ci_24                 4.848078e-03 3 1  ON 23
ci_25                 3.595897e-03 3 1  ON 24
ci_26                 3.622050e-03 3 1  ON 25
ci_27                 3.653080e-03 3 1  ON 26
ci_28                 2.687862e-03 3 1  ON 27
ci_29                 2.670442e-03 3 1  ON 28
ci_30                -2.193739e-03 3 1  ON 29
ci_31                -2.335260e-03 3 1  ON 30
ci_32                -1.702783e-03 3 1  ON 31
ci_33                -1.690408e-03 3 1  ON 32
ci_34                 1.557719e-03 3 1  ON 33
ci_35                 1.635083e-03 3 1  ON 34
ci_36                -1.488801e-03 3 1  ON 35
ci_37                -1.526928e-03 3 1  ON 36
ci_38                -1.045370e-03 3 1  ON 37
ci_39                -1.128347e-03 3 1  ON 38
ci_40                -1.643284e-03 3 1  ON 39
ci_41                -1.288303e-03 3 1  ON 40
ci_42                -1.064416e-03 3 1  ON 41
ci_43                -2.490477e-03 3 1  ON 42
ci_44                -1.685047e-03 3 1  ON 43
ci_45                -9.528096e-04 3 1  ON 44
ci_46                -8.701993e-04 3 1  ON 45
ci_47                -8.798165e-05 3 1  ON 46
ci_48                -2.282994e-04 3 1  ON 47
ci_49                -1.179050e-03 3 1  ON 48
ci_50                -9.175795e-04 3 1  ON 49
ci_51                 7.726585e-04 3 1  ON 50
ci_52                 6.795321e-04 3 1  ON 51
ci_53                -1.031932e-03 3 1  ON 52
ci_54                -9.176821e-04 3 1  ON 53
ci_55                -6.919481e-04 3 1  ON 54
ci_56                 1.702816e-03 3 1  ON 55
ci_57                 1.719910e-03 3 1  ON 56
ci_58                -9.846935e-04 3 1  ON 57
ci_59                -9.038110e-04 3 1  ON 58
ci_60                 7.520084e-04 3 1  ON 59
ci_61                 7.904504e-04 3 1  ON 60
ci_62                -5.915365e-04 3 1  ON 61
ci_63                -7.878767e-04 3 1  ON 62
ci_64                -6.010768e-04 3 1  ON 63
ci_65                -4.419928e-04 3 1  ON 64
ci_66                -8.358040e-04 3 1  ON 65
ci_67                -6.831147e-04 3 1  ON 66
ci_68                -3.262898e-04 3 1  ON 67
ci_69                -1.601736e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5263e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.8144
    reference variance = 0.387706
====================================================
  Execution time = 2.5748e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8717e-01
  Total weights = 1.963555078e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471808672212
                                         uncertainty =       0.002271613100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471808672212
                                         uncertainty =       0.002271613100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485731078
  error estimate for blocks of size 2^( 2) =       0.000506669139
  error estimate for blocks of size 2^( 3) =       0.000527133741
  error estimate for blocks of size 2^( 4) =       0.000542310724
  error estimate for blocks of size 2^( 5) =       0.000550923319
  error estimate for blocks of size 2^( 6) =       0.000555604505
  error estimate for blocks of size 2^( 7) =       0.000559381678

      target function =      -0.716128205633
              le_mean =     -22.817751613753
             les_mean =     521.136961182707
             stat err =       0.000552055057
             autocorr =       1.291733734041
   target nu stat err =       0.000552055057
   target dn stat err =       0.003415987002
      target stat err =       0.002510140438
              std dev =       0.686927478341
             le_variance =       0.471869360499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281775161375e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.716136174673       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.716142810081       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.716143836317       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.716144022376       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.716144078333       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.716144112776       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.716144124092       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.716144123487       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.716144123454       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.716144123326       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 3.412835e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.716136174673       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.716137835920       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.716138092707       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.716138139233       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.716138153214       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.716138161815       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.716138164639       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.716138164487       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.716138164479       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.716138164447       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 8.538824e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.716136174673       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.716136590135       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.716136654346       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.716136665978       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.716136669473       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.716136671622       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.716136672328       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.716136672290       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.716136672287       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.716136672281       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 2.135128e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.705049 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0375e+01
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_01                 1.411398e-01 3 1  ON 0
ci_02                -3.829598e-02 3 1  ON 1
ci_03                -3.807972e-02 3 1  ON 2
ci_04                 3.453880e-02 3 1  ON 3
ci_05                -2.768234e-02 3 1  ON 4
ci_06                -2.704124e-02 3 1  ON 5
ci_07                 2.812363e-02 3 1  ON 6
ci_08                -9.605814e-03 3 1  ON 7
ci_09                -1.181591e-02 3 1  ON 8
ci_10                -1.162023e-02 3 1  ON 9
ci_11                 1.377866e-02 3 1  ON 10
ci_12                 9.079504e-03 3 1  ON 11
ci_13                 1.257721e-02 3 1  ON 12
ci_14                 1.234698e-02 3 1  ON 13
ci_15                 8.706199e-03 3 1  ON 14
ci_16                 8.653371e-03 3 1  ON 15
ci_17                -8.873268e-03 3 1  ON 16
ci_18                -8.376533e-03 3 1  ON 17
ci_19                 9.904046e-03 3 1  ON 18
ci_20                 7.769160e-03 3 1  ON 19
ci_21                 9.095981e-03 3 1  ON 20
ci_22                 9.194506e-03 3 1  ON 21
ci_23                 5.346408e-03 3 1  ON 22
ci_24                 4.847490e-03 3 1  ON 23
ci_25                 3.595504e-03 3 1  ON 24
ci_26                 3.621732e-03 3 1  ON 25
ci_27                 3.653037e-03 3 1  ON 26
ci_28                 2.687430e-03 3 1  ON 27
ci_29                 2.669343e-03 3 1  ON 28
ci_30                -2.193241e-03 3 1  ON 29
ci_31                -2.335189e-03 3 1  ON 30
ci_32                -1.701966e-03 3 1  ON 31
ci_33                -1.689731e-03 3 1  ON 32
ci_34                 1.556966e-03 3 1  ON 33
ci_35                 1.634732e-03 3 1  ON 34
ci_36                -1.488431e-03 3 1  ON 35
ci_37                -1.526724e-03 3 1  ON 36
ci_38                -1.045093e-03 3 1  ON 37
ci_39                -1.128090e-03 3 1  ON 38
ci_40                -1.643381e-03 3 1  ON 39
ci_41                -1.288129e-03 3 1  ON 40
ci_42                -1.064767e-03 3 1  ON 41
ci_43                -2.490707e-03 3 1  ON 42
ci_44                -1.685091e-03 3 1  ON 43
ci_45                -9.525806e-04 3 1  ON 44
ci_46                -8.705162e-04 3 1  ON 45
ci_47                -8.746612e-05 3 1  ON 46
ci_48                -2.284660e-04 3 1  ON 47
ci_49                -1.178868e-03 3 1  ON 48
ci_50                -9.174462e-04 3 1  ON 49
ci_51                 7.724163e-04 3 1  ON 50
ci_52                 6.792285e-04 3 1  ON 51
ci_53                -1.031684e-03 3 1  ON 52
ci_54                -9.171958e-04 3 1  ON 53
ci_55                -6.920497e-04 3 1  ON 54
ci_56                 1.702882e-03 3 1  ON 55
ci_57                 1.720278e-03 3 1  ON 56
ci_58                -9.849072e-04 3 1  ON 57
ci_59                -9.038489e-04 3 1  ON 58
ci_60                 7.514899e-04 3 1  ON 59
ci_61                 7.906022e-04 3 1  ON 60
ci_62                -5.913934e-04 3 1  ON 61
ci_63                -7.877286e-04 3 1  ON 62
ci_64                -6.008171e-04 3 1  ON 63
ci_65                -4.422629e-04 3 1  ON 64
ci_66                -8.361452e-04 3 1  ON 65
ci_67                -6.832522e-04 3 1  ON 66
ci_68                -3.267350e-04 3 1  ON 67
ci_69                -1.609231e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.7612
    reference variance = 0.333741
====================================================
  Execution time = 2.5161e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9302e-01
  Total weights = 1.9635e+06
  Execution time = 3.5783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475672896062
                                         uncertainty =       0.002314762778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475672896062
                                         uncertainty =       0.002314762778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487725000
  error estimate for blocks of size 2^( 2) =       0.000509069538
  error estimate for blocks of size 2^( 3) =       0.000528800887
  error estimate for blocks of size 2^( 4) =       0.000543624259
  error estimate for blocks of size 2^( 5) =       0.000554087648
  error estimate for blocks of size 2^( 6) =       0.000561290594
  error estimate for blocks of size 2^( 7) =       0.000564854485

      target function =      -0.711994486929
              le_mean =     -22.817648928056
             les_mean =     521.138073512318
             stat err =       0.000555964246
             autocorr =       1.299402480449
   target nu stat err =       0.000555964246
   target dn stat err =       0.003320788325
      target stat err =       0.002416751131
              std dev =       0.689747309840
             le_variance =       0.475751351432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475649156270
                                         uncertainty =       0.002314774389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475649156270
                                         uncertainty =       0.002314774389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487712652
  error estimate for blocks of size 2^( 2) =       0.000509057473
  error estimate for blocks of size 2^( 3) =       0.000528789099
  error estimate for blocks of size 2^( 4) =       0.000543612852
  error estimate for blocks of size 2^( 5) =       0.000554076332
  error estimate for blocks of size 2^( 6) =       0.000561278578
  error estimate for blocks of size 2^( 7) =       0.000564842193

      target function =      -0.711738515638
              le_mean =     -22.817649022967
             les_mean =     521.138438629665
             stat err =       0.000555952489
             autocorr =       1.299413316092
   target nu stat err =       0.000555952489
   target dn stat err =       0.003420716786
      target stat err =       0.002483974589
              std dev =       0.689729847132
             le_variance =       0.475727262025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475661000231
                                         uncertainty =       0.002314768263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475661000231
                                         uncertainty =       0.002314768263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487718813
  error estimate for blocks of size 2^( 2) =       0.000509063494
  error estimate for blocks of size 2^( 3) =       0.000528794982
  error estimate for blocks of size 2^( 4) =       0.000543618529
  error estimate for blocks of size 2^( 5) =       0.000554081962
  error estimate for blocks of size 2^( 6) =       0.000561284569
  error estimate for blocks of size 2^( 7) =       0.000564848329

      target function =      -0.711914649648
              le_mean =     -22.817648971358
             les_mean =     521.138187915425
             stat err =       0.000555958347
             autocorr =       1.299407876748
   target nu stat err =       0.000555958347
   target dn stat err =       0.003363339049
      target stat err =       0.002445570251
              std dev =       0.689738559360
             le_variance =       0.475739280268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475671407472
                                         uncertainty =       0.002314763433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475671407472
                                         uncertainty =       0.002314763433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487724226
  error estimate for blocks of size 2^( 2) =       0.000509068782
  error estimate for blocks of size 2^( 3) =       0.000528800148
  error estimate for blocks of size 2^( 4) =       0.000543623542
  error estimate for blocks of size 2^( 5) =       0.000554086936
  error estimate for blocks of size 2^( 6) =       0.000561289840
  error estimate for blocks of size 2^( 7) =       0.000564853714

      target function =      -0.711985942929
              le_mean =     -22.817648933344
             les_mean =     521.138085783012
             stat err =       0.000555963508
             autocorr =       1.299403155734
   target nu stat err =       0.000555963508
   target dn stat err =       0.003325535216
      target stat err =       0.002419968229
              std dev =       0.689746214839
             le_variance =       0.475749840885


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.711994486929        initial  <--
     2.4414e+01     2.4414e+02             3.4128e-05        -0.711738515638
     9.7656e+01     9.7656e+02             8.5388e-06        -0.711914649648
     3.9062e+02     3.9062e+03             2.1351e-06        -0.711985942929

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0963
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_01                 1.411483e-01 3 1  ON 0
ci_02                -3.830255e-02 3 1  ON 1
ci_03                -3.808631e-02 3 1  ON 2
ci_04                 3.454539e-02 3 1  ON 3
ci_05                -2.768646e-02 3 1  ON 4
ci_06                -2.704507e-02 3 1  ON 5
ci_07                 2.812414e-02 3 1  ON 6
ci_08                -9.608898e-03 3 1  ON 7
ci_09                -1.181777e-02 3 1  ON 8
ci_10                -1.162214e-02 3 1  ON 9
ci_11                 1.377983e-02 3 1  ON 10
ci_12                 9.080515e-03 3 1  ON 11
ci_13                 1.257757e-02 3 1  ON 12
ci_14                 1.234591e-02 3 1  ON 13
ci_15                 8.707632e-03 3 1  ON 14
ci_16                 8.654745e-03 3 1  ON 15
ci_17                -8.874692e-03 3 1  ON 16
ci_18                -8.377629e-03 3 1  ON 17
ci_19                 9.904354e-03 3 1  ON 18
ci_20                 7.769557e-03 3 1  ON 19
ci_21                 9.096848e-03 3 1  ON 20
ci_22                 9.195114e-03 3 1  ON 21
ci_23                 5.346576e-03 3 1  ON 22
ci_24                 4.848078e-03 3 1  ON 23
ci_25                 3.595897e-03 3 1  ON 24
ci_26                 3.622050e-03 3 1  ON 25
ci_27                 3.653080e-03 3 1  ON 26
ci_28                 2.687862e-03 3 1  ON 27
ci_29                 2.670442e-03 3 1  ON 28
ci_30                -2.193739e-03 3 1  ON 29
ci_31                -2.335260e-03 3 1  ON 30
ci_32                -1.702783e-03 3 1  ON 31
ci_33                -1.690408e-03 3 1  ON 32
ci_34                 1.557719e-03 3 1  ON 33
ci_35                 1.635083e-03 3 1  ON 34
ci_36                -1.488801e-03 3 1  ON 35
ci_37                -1.526928e-03 3 1  ON 36
ci_38                -1.045370e-03 3 1  ON 37
ci_39                -1.128347e-03 3 1  ON 38
ci_40                -1.643284e-03 3 1  ON 39
ci_41                -1.288303e-03 3 1  ON 40
ci_42                -1.064416e-03 3 1  ON 41
ci_43                -2.490477e-03 3 1  ON 42
ci_44                -1.685047e-03 3 1  ON 43
ci_45                -9.528096e-04 3 1  ON 44
ci_46                -8.701993e-04 3 1  ON 45
ci_47                -8.798165e-05 3 1  ON 46
ci_48                -2.282994e-04 3 1  ON 47
ci_49                -1.179050e-03 3 1  ON 48
ci_50                -9.175795e-04 3 1  ON 49
ci_51                 7.726585e-04 3 1  ON 50
ci_52                 6.795321e-04 3 1  ON 51
ci_53                -1.031932e-03 3 1  ON 52
ci_54                -9.176821e-04 3 1  ON 53
ci_55                -6.919481e-04 3 1  ON 54
ci_56                 1.702816e-03 3 1  ON 55
ci_57                 1.719910e-03 3 1  ON 56
ci_58                -9.846935e-04 3 1  ON 57
ci_59                -9.038110e-04 3 1  ON 58
ci_60                 7.520084e-04 3 1  ON 59
ci_61                 7.904504e-04 3 1  ON 60
ci_62                -5.915365e-04 3 1  ON 61
ci_63                -7.878767e-04 3 1  ON 62
ci_64                -6.010768e-04 3 1  ON 63
ci_65                -4.419928e-04 3 1  ON 64
ci_66                -8.358040e-04 3 1  ON 65
ci_67                -6.831147e-04 3 1  ON 66
ci_68                -3.262898e-04 3 1  ON 67
ci_69                -1.601736e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3477e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.8147
    reference variance = 0.309538
====================================================
  Execution time = 2.5760e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5328e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8934e-01
  Total weights = 1.963514934e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477121196386
                                         uncertainty =       0.003012529552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477121196386
                                         uncertainty =       0.003012529552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488380033
  error estimate for blocks of size 2^( 2) =       0.000509613877
  error estimate for blocks of size 2^( 3) =       0.000529418111
  error estimate for blocks of size 2^( 4) =       0.000543922878
  error estimate for blocks of size 2^( 5) =       0.000551753952
  error estimate for blocks of size 2^( 6) =       0.000554889343
  error estimate for blocks of size 2^( 7) =       0.000558902407

      target function =      -0.714578350778
              le_mean =     -22.817849816098
             les_mean =     521.143614860681
             stat err =       0.000552367145
             autocorr =       1.279204203420
   target nu stat err =       0.000552367145
   target dn stat err =       0.003074634052
      target stat err =       0.002262948934
              std dev =       0.690673666047
             le_variance =       0.477030112971


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281784981610e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714584746363       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714585451501       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714585568523       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714585586654       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714585594315       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714585598107       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714585599206       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714585599297       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714585599232       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714585599206       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.714585599191       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 3.333225e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714584746363       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714584922674       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714584951932       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714584956464       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714584958380       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714584959327       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714584959602       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714584959626       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714584959609       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714584959603       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.714584959599       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 8.333731e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714584746363       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714584790442       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714584797757       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714584798890       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714584799367       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714584799605       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714584799664       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714584799684       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714584799681       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714584799671       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.714584799671       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 2.083475e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.709087 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0358e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_01                 1.411475e-01 3 1  ON 0
ci_02                -3.830200e-02 3 1  ON 1
ci_03                -3.808562e-02 3 1  ON 2
ci_04                 3.454465e-02 3 1  ON 3
ci_05                -2.768610e-02 3 1  ON 4
ci_06                -2.704470e-02 3 1  ON 5
ci_07                 2.812406e-02 3 1  ON 6
ci_08                -9.608608e-03 3 1  ON 7
ci_09                -1.181751e-02 3 1  ON 8
ci_10                -1.162196e-02 3 1  ON 9
ci_11                 1.377972e-02 3 1  ON 10
ci_12                 9.080384e-03 3 1  ON 11
ci_13                 1.257760e-02 3 1  ON 12
ci_14                 1.234602e-02 3 1  ON 13
ci_15                 8.707514e-03 3 1  ON 14
ci_16                 8.654685e-03 3 1  ON 15
ci_17                -8.874541e-03 3 1  ON 16
ci_18                -8.377500e-03 3 1  ON 17
ci_19                 9.904284e-03 3 1  ON 18
ci_20                 7.769466e-03 3 1  ON 19
ci_21                 9.096793e-03 3 1  ON 20
ci_22                 9.195120e-03 3 1  ON 21
ci_23                 5.346492e-03 3 1  ON 22
ci_24                 4.848078e-03 3 1  ON 23
ci_25                 3.595821e-03 3 1  ON 24
ci_26                 3.622024e-03 3 1  ON 25
ci_27                 3.653097e-03 3 1  ON 26
ci_28                 2.687834e-03 3 1  ON 27
ci_29                 2.670384e-03 3 1  ON 28
ci_30                -2.193672e-03 3 1  ON 29
ci_31                -2.335179e-03 3 1  ON 30
ci_32                -1.702746e-03 3 1  ON 31
ci_33                -1.690396e-03 3 1  ON 32
ci_34                 1.557625e-03 3 1  ON 33
ci_35                 1.634994e-03 3 1  ON 34
ci_36                -1.488810e-03 3 1  ON 35
ci_37                -1.526913e-03 3 1  ON 36
ci_38                -1.045333e-03 3 1  ON 37
ci_39                -1.128304e-03 3 1  ON 38
ci_40                -1.643281e-03 3 1  ON 39
ci_41                -1.288349e-03 3 1  ON 40
ci_42                -1.064390e-03 3 1  ON 41
ci_43                -2.490380e-03 3 1  ON 42
ci_44                -1.685071e-03 3 1  ON 43
ci_45                -9.527841e-04 3 1  ON 44
ci_46                -8.701588e-04 3 1  ON 45
ci_47                -8.790482e-05 3 1  ON 46
ci_48                -2.282328e-04 3 1  ON 47
ci_49                -1.179057e-03 3 1  ON 48
ci_50                -9.175486e-04 3 1  ON 49
ci_51                 7.726661e-04 3 1  ON 50
ci_52                 6.795136e-04 3 1  ON 51
ci_53                -1.031942e-03 3 1  ON 52
ci_54                -9.176653e-04 3 1  ON 53
ci_55                -6.919499e-04 3 1  ON 54
ci_56                 1.702747e-03 3 1  ON 55
ci_57                 1.719858e-03 3 1  ON 56
ci_58                -9.846733e-04 3 1  ON 57
ci_59                -9.038156e-04 3 1  ON 58
ci_60                 7.520306e-04 3 1  ON 59
ci_61                 7.904730e-04 3 1  ON 60
ci_62                -5.914980e-04 3 1  ON 61
ci_63                -7.878606e-04 3 1  ON 62
ci_64                -6.010690e-04 3 1  ON 63
ci_65                -4.419479e-04 3 1  ON 64
ci_66                -8.358057e-04 3 1  ON 65
ci_67                -6.831271e-04 3 1  ON 66
ci_68                -3.263192e-04 3 1  ON 67
ci_69                -1.601918e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.7592
    reference variance = 0.293607
====================================================
  Execution time = 2.5209e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9331e-01
  Total weights = 1.9635e+06
  Execution time = 3.5881e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477570155107
                                         uncertainty =       0.002609520075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477570155107
                                         uncertainty =       0.002609520075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488692303
  error estimate for blocks of size 2^( 2) =       0.000509362435
  error estimate for blocks of size 2^( 3) =       0.000529715591
  error estimate for blocks of size 2^( 4) =       0.000544685777
  error estimate for blocks of size 2^( 5) =       0.000554964080
  error estimate for blocks of size 2^( 6) =       0.000560949443
  error estimate for blocks of size 2^( 7) =       0.000562321343

      target function =      -0.711773172848
              le_mean =     -22.818742770991
             les_mean =     521.188332347175
             stat err =       0.000555730161
             autocorr =       1.293173922595
   target nu stat err =       0.000555730161
   target dn stat err =       0.003326050663
      target stat err =       0.002422565605
              std dev =       0.691115282223
             le_variance =       0.477640333322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477567826178
                                         uncertainty =       0.002609536727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477567826178
                                         uncertainty =       0.002609536727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488691108
  error estimate for blocks of size 2^( 2) =       0.000509361273
  error estimate for blocks of size 2^( 3) =       0.000529714463
  error estimate for blocks of size 2^( 4) =       0.000544684689
  error estimate for blocks of size 2^( 5) =       0.000554963030
  error estimate for blocks of size 2^( 6) =       0.000560948495
  error estimate for blocks of size 2^( 7) =       0.000562320395

      target function =      -0.711773674112
              le_mean =     -22.818742740098
             les_mean =     521.188330229078
             stat err =       0.000555729153
             autocorr =       1.293175549892
   target nu stat err =       0.000555729153
   target dn stat err =       0.003326136568
      target stat err =       0.002422627898
              std dev =       0.691113593439
             le_variance =       0.477637999036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477568990342
                                         uncertainty =       0.002609528402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477568990342
                                         uncertainty =       0.002609528402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488691705
  error estimate for blocks of size 2^( 2) =       0.000509361854
  error estimate for blocks of size 2^( 3) =       0.000529715027
  error estimate for blocks of size 2^( 4) =       0.000544685233
  error estimate for blocks of size 2^( 5) =       0.000554963555
  error estimate for blocks of size 2^( 6) =       0.000560948969
  error estimate for blocks of size 2^( 7) =       0.000562320869

      target function =      -0.711773426880
              le_mean =     -22.818742755524
             les_mean =     521.188331282408
             stat err =       0.000555729657
             autocorr =       1.293174736339
   target nu stat err =       0.000555729657
   target dn stat err =       0.003326093479
      target stat err =       0.002422596680
              std dev =       0.691114437614
             le_variance =       0.477639165878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477570009491
                                         uncertainty =       0.002609521116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477570009491
                                         uncertainty =       0.002609521116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488692228
  error estimate for blocks of size 2^( 2) =       0.000509362363
  error estimate for blocks of size 2^( 3) =       0.000529715520
  error estimate for blocks of size 2^( 4) =       0.000544685709
  error estimate for blocks of size 2^( 5) =       0.000554964015
  error estimate for blocks of size 2^( 6) =       0.000560949384
  error estimate for blocks of size 2^( 7) =       0.000562321284

      target function =      -0.711773204963
              le_mean =     -22.818742769056
             les_mean =     521.188332213476
             stat err =       0.000555730098
             autocorr =       1.293174024317
   target nu stat err =       0.000555730098
   target dn stat err =       0.003326056000
      target stat err =       0.002422569481
              std dev =       0.691115176631
             le_variance =       0.477640187370


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.711773172848        initial
     2.4414e+02     2.4414e+03             3.3332e-06        -0.711773674112  <--
     9.7656e+02     9.7656e+03             8.3337e-07        -0.711773426880
     3.9062e+03     3.9062e+04             2.0835e-07        -0.711773204963

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 4.3206e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_01                 1.411450e-01 3 1  ON 0
ci_02                -3.830035e-02 3 1  ON 1
ci_03                -3.808354e-02 3 1  ON 2
ci_04                 3.454246e-02 3 1  ON 3
ci_05                -2.768502e-02 3 1  ON 4
ci_06                -2.704360e-02 3 1  ON 5
ci_07                 2.812384e-02 3 1  ON 6
ci_08                -9.607739e-03 3 1  ON 7
ci_09                -1.181676e-02 3 1  ON 8
ci_10                -1.162141e-02 3 1  ON 9
ci_11                 1.377937e-02 3 1  ON 10
ci_12                 9.079989e-03 3 1  ON 11
ci_13                 1.257772e-02 3 1  ON 12
ci_14                 1.234635e-02 3 1  ON 13
ci_15                 8.707159e-03 3 1  ON 14
ci_16                 8.654505e-03 3 1  ON 15
ci_17                -8.874087e-03 3 1  ON 16
ci_18                -8.377113e-03 3 1  ON 17
ci_19                 9.904074e-03 3 1  ON 18
ci_20                 7.769194e-03 3 1  ON 19
ci_21                 9.096629e-03 3 1  ON 20
ci_22                 9.195138e-03 3 1  ON 21
ci_23                 5.346238e-03 3 1  ON 22
ci_24                 4.848076e-03 3 1  ON 23
ci_25                 3.595592e-03 3 1  ON 24
ci_26                 3.621945e-03 3 1  ON 25
ci_27                 3.653149e-03 3 1  ON 26
ci_28                 2.687752e-03 3 1  ON 27
ci_29                 2.670211e-03 3 1  ON 28
ci_30                -2.193472e-03 3 1  ON 29
ci_31                -2.334938e-03 3 1  ON 30
ci_32                -1.702637e-03 3 1  ON 31
ci_33                -1.690360e-03 3 1  ON 32
ci_34                 1.557341e-03 3 1  ON 33
ci_35                 1.634729e-03 3 1  ON 34
ci_36                -1.488835e-03 3 1  ON 35
ci_37                -1.526869e-03 3 1  ON 36
ci_38                -1.045220e-03 3 1  ON 37
ci_39                -1.128177e-03 3 1  ON 38
ci_40                -1.643271e-03 3 1  ON 39
ci_41                -1.288488e-03 3 1  ON 40
ci_42                -1.064311e-03 3 1  ON 41
ci_43                -2.490089e-03 3 1  ON 42
ci_44                -1.685143e-03 3 1  ON 43
ci_45                -9.527078e-04 3 1  ON 44
ci_46                -8.700373e-04 3 1  ON 45
ci_47                -8.767434e-05 3 1  ON 46
ci_48                -2.280333e-04 3 1  ON 47
ci_49                -1.179079e-03 3 1  ON 48
ci_50                -9.174559e-04 3 1  ON 49
ci_51                 7.726892e-04 3 1  ON 50
ci_52                 6.794582e-04 3 1  ON 51
ci_53                -1.031971e-03 3 1  ON 52
ci_54                -9.176147e-04 3 1  ON 53
ci_55                -6.919551e-04 3 1  ON 54
ci_56                 1.702543e-03 3 1  ON 55
ci_57                 1.719705e-03 3 1  ON 56
ci_58                -9.846127e-04 3 1  ON 57
ci_59                -9.038294e-04 3 1  ON 58
ci_60                 7.520970e-04 3 1  ON 59
ci_61                 7.905405e-04 3 1  ON 60
ci_62                -5.913826e-04 3 1  ON 61
ci_63                -7.878123e-04 3 1  ON 62
ci_64                -6.010455e-04 3 1  ON 63
ci_65                -4.418130e-04 3 1  ON 64
ci_66                -8.358111e-04 3 1  ON 65
ci_67                -6.831641e-04 3 1  ON 66
ci_68                -3.264075e-04 3 1  ON 67
ci_69                -1.602465e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3569e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.8611
    reference variance = 0.387577
====================================================
  Execution time = 2.5730e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.8883e-01
  Total weights = 1.963796822e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472873158611
                                         uncertainty =       0.002480836782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472873158611
                                         uncertainty =       0.002480836782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486242135
  error estimate for blocks of size 2^( 2) =       0.000506996704
  error estimate for blocks of size 2^( 3) =       0.000526334455
  error estimate for blocks of size 2^( 4) =       0.000541913904
  error estimate for blocks of size 2^( 5) =       0.000551595523
  error estimate for blocks of size 2^( 6) =       0.000559508281
  error estimate for blocks of size 2^( 7) =       0.000561022902

      target function =      -0.714934380604
              le_mean =     -22.817263774663
             les_mean =     521.116353905297
             stat err =       0.000553510152
             autocorr =       1.295823952040
   target nu stat err =       0.000553510152
   target dn stat err =       0.002950854670
      target stat err =       0.002177973469
              std dev =       0.687650221733
             le_variance =       0.472862827449


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281726377466e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714940235495       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714942830172       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714943231906       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714943282465       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714943300361       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714943305375       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714943307082       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714943306755       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714943306764       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714943306651       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 1.115042e-05

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714940235495       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714940884540       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714940985010       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714940997652       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714941002125       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714941003377       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714941003803       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714941003721       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714941003724       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714941003695       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 2.789060e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714940235495       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714940397779       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714940422899       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714940426059       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714940427178       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714940427493       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714940427597       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714940427579       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714940427579       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714940427572       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 6.973560e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.712595 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0336e+01
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_01                 1.411422e-01 3 1  ON 0
ci_02                -3.829778e-02 3 1  ON 1
ci_03                -3.808075e-02 3 1  ON 2
ci_04                 3.453969e-02 3 1  ON 3
ci_05                -2.768352e-02 3 1  ON 4
ci_06                -2.704222e-02 3 1  ON 5
ci_07                 2.812353e-02 3 1  ON 6
ci_08                -9.606588e-03 3 1  ON 7
ci_09                -1.181614e-02 3 1  ON 8
ci_10                -1.162063e-02 3 1  ON 9
ci_11                 1.377899e-02 3 1  ON 10
ci_12                 9.079694e-03 3 1  ON 11
ci_13                 1.257772e-02 3 1  ON 12
ci_14                 1.234648e-02 3 1  ON 13
ci_15                 8.706809e-03 3 1  ON 14
ci_16                 8.653895e-03 3 1  ON 15
ci_17                -8.873744e-03 3 1  ON 16
ci_18                -8.376956e-03 3 1  ON 17
ci_19                 9.903982e-03 3 1  ON 18
ci_20                 7.768958e-03 3 1  ON 19
ci_21                 9.096709e-03 3 1  ON 20
ci_22                 9.195149e-03 3 1  ON 21
ci_23                 5.346299e-03 3 1  ON 22
ci_24                 4.847985e-03 3 1  ON 23
ci_25                 3.595771e-03 3 1  ON 24
ci_26                 3.621669e-03 3 1  ON 25
ci_27                 3.652989e-03 3 1  ON 26
ci_28                 2.687385e-03 3 1  ON 27
ci_29                 2.670020e-03 3 1  ON 28
ci_30                -2.193310e-03 3 1  ON 29
ci_31                -2.334633e-03 3 1  ON 30
ci_32                -1.702373e-03 3 1  ON 31
ci_33                -1.690381e-03 3 1  ON 32
ci_34                 1.557101e-03 3 1  ON 33
ci_35                 1.634714e-03 3 1  ON 34
ci_36                -1.488863e-03 3 1  ON 35
ci_37                -1.526750e-03 3 1  ON 36
ci_38                -1.045047e-03 3 1  ON 37
ci_39                -1.128196e-03 3 1  ON 38
ci_40                -1.643196e-03 3 1  ON 39
ci_41                -1.288457e-03 3 1  ON 40
ci_42                -1.064073e-03 3 1  ON 41
ci_43                -2.489789e-03 3 1  ON 42
ci_44                -1.685191e-03 3 1  ON 43
ci_45                -9.526320e-04 3 1  ON 44
ci_46                -8.698365e-04 3 1  ON 45
ci_47                -8.758214e-05 3 1  ON 46
ci_48                -2.275699e-04 3 1  ON 47
ci_49                -1.178939e-03 3 1  ON 48
ci_50                -9.172704e-04 3 1  ON 49
ci_51                 7.724909e-04 3 1  ON 50
ci_52                 6.794478e-04 3 1  ON 51
ci_53                -1.031773e-03 3 1  ON 52
ci_54                -9.176278e-04 3 1  ON 53
ci_55                -6.918743e-04 3 1  ON 54
ci_56                 1.702508e-03 3 1  ON 55
ci_57                 1.719687e-03 3 1  ON 56
ci_58                -9.847108e-04 3 1  ON 57
ci_59                -9.040088e-04 3 1  ON 58
ci_60                 7.522096e-04 3 1  ON 59
ci_61                 7.907797e-04 3 1  ON 60
ci_62                -5.914907e-04 3 1  ON 61
ci_63                -7.876732e-04 3 1  ON 62
ci_64                -6.010410e-04 3 1  ON 63
ci_65                -4.418252e-04 3 1  ON 64
ci_66                -8.357536e-04 3 1  ON 65
ci_67                -6.832046e-04 3 1  ON 66
ci_68                -3.266503e-04 3 1  ON 67
ci_69                -1.601916e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.8281
    reference variance = 0.375988
====================================================
  Execution time = 2.5532e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9555e-01
  Total weights = 1.9634e+06
  Execution time = 3.5939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476293593752
                                         uncertainty =       0.002471093686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476293593752
                                         uncertainty =       0.002471093686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487998516
  error estimate for blocks of size 2^( 2) =       0.000508714294
  error estimate for blocks of size 2^( 3) =       0.000527932731
  error estimate for blocks of size 2^( 4) =       0.000543061316
  error estimate for blocks of size 2^( 5) =       0.000551124860
  error estimate for blocks of size 2^( 6) =       0.000559098044
  error estimate for blocks of size 2^( 7) =       0.000562385951

      target function =      -0.710193435543
              le_mean =     -22.817372523047
             les_mean =     521.127990844805
             stat err =       0.000553917543
             autocorr =       1.288407478393
   target nu stat err =       0.000553917543
   target dn stat err =       0.004732752674
      target stat err =       0.003379669565
              std dev =       0.690134119526
             le_variance =       0.476285102933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476285929853
                                         uncertainty =       0.002471197503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476285929853
                                         uncertainty =       0.002471197503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487994589
  error estimate for blocks of size 2^( 2) =       0.000508710358
  error estimate for blocks of size 2^( 3) =       0.000527929001
  error estimate for blocks of size 2^( 4) =       0.000543057864
  error estimate for blocks of size 2^( 5) =       0.000551121428
  error estimate for blocks of size 2^( 6) =       0.000559094606
  error estimate for blocks of size 2^( 7) =       0.000562382944

      target function =      -0.695157727274
              le_mean =     -22.817372507774
             les_mean =     521.149349765874
             stat err =       0.000553914211
             autocorr =       1.288412714398
   target nu stat err =       0.000553914211
   target dn stat err =       0.021867264100
      target stat err =       0.014778276465
              std dev =       0.690128565512
             le_variance =       0.476277436936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476289757718
                                         uncertainty =       0.002471145583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476289757718
                                         uncertainty =       0.002471145583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487996550
  error estimate for blocks of size 2^( 2) =       0.000508712326
  error estimate for blocks of size 2^( 3) =       0.000527930872
  error estimate for blocks of size 2^( 4) =       0.000543059599
  error estimate for blocks of size 2^( 5) =       0.000551123158
  error estimate for blocks of size 2^( 6) =       0.000559096372
  error estimate for blocks of size 2^( 7) =       0.000562384481

      target function =      -0.710046990314
              le_mean =     -22.817372503444
             les_mean =     521.128197728129
             stat err =       0.000553915902
             autocorr =       1.288410227035
   target nu stat err =       0.000553915902
   target dn stat err =       0.004745217574
      target stat err =       0.003386956866
              std dev =       0.690131339566
             le_variance =       0.476281265851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476293113991
                                         uncertainty =       0.002471100167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476293113991
                                         uncertainty =       0.002471100167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487998270
  error estimate for blocks of size 2^( 2) =       0.000508714048
  error estimate for blocks of size 2^( 3) =       0.000527932498
  error estimate for blocks of size 2^( 4) =       0.000543061101
  error estimate for blocks of size 2^( 5) =       0.000551124647
  error estimate for blocks of size 2^( 6) =       0.000559097835
  error estimate for blocks of size 2^( 7) =       0.000562385767

      target function =      -0.710187095676
              le_mean =     -22.817372520642
             les_mean =     521.127999725988
             stat err =       0.000553917337
             autocorr =       1.288407821243
   target nu stat err =       0.000553917337
   target dn stat err =       0.004733543230
      target stat err =       0.003380159603
              std dev =       0.690133771845
             le_variance =       0.476284623042


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.710193435543        initial  <--
     6.1035e+01     6.1035e+02             1.1150e-05        -0.695157727274
     2.4414e+02     2.4414e+03             2.7891e-06        -0.710046990314
     9.7656e+02     9.7656e+03             6.9736e-07        -0.710187095676

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5810
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_01                 1.411450e-01 3 1  ON 0
ci_02                -3.830035e-02 3 1  ON 1
ci_03                -3.808354e-02 3 1  ON 2
ci_04                 3.454246e-02 3 1  ON 3
ci_05                -2.768502e-02 3 1  ON 4
ci_06                -2.704360e-02 3 1  ON 5
ci_07                 2.812384e-02 3 1  ON 6
ci_08                -9.607739e-03 3 1  ON 7
ci_09                -1.181676e-02 3 1  ON 8
ci_10                -1.162141e-02 3 1  ON 9
ci_11                 1.377937e-02 3 1  ON 10
ci_12                 9.079989e-03 3 1  ON 11
ci_13                 1.257772e-02 3 1  ON 12
ci_14                 1.234635e-02 3 1  ON 13
ci_15                 8.707159e-03 3 1  ON 14
ci_16                 8.654505e-03 3 1  ON 15
ci_17                -8.874087e-03 3 1  ON 16
ci_18                -8.377113e-03 3 1  ON 17
ci_19                 9.904074e-03 3 1  ON 18
ci_20                 7.769194e-03 3 1  ON 19
ci_21                 9.096629e-03 3 1  ON 20
ci_22                 9.195138e-03 3 1  ON 21
ci_23                 5.346238e-03 3 1  ON 22
ci_24                 4.848076e-03 3 1  ON 23
ci_25                 3.595592e-03 3 1  ON 24
ci_26                 3.621945e-03 3 1  ON 25
ci_27                 3.653149e-03 3 1  ON 26
ci_28                 2.687752e-03 3 1  ON 27
ci_29                 2.670211e-03 3 1  ON 28
ci_30                -2.193472e-03 3 1  ON 29
ci_31                -2.334938e-03 3 1  ON 30
ci_32                -1.702637e-03 3 1  ON 31
ci_33                -1.690360e-03 3 1  ON 32
ci_34                 1.557341e-03 3 1  ON 33
ci_35                 1.634729e-03 3 1  ON 34
ci_36                -1.488835e-03 3 1  ON 35
ci_37                -1.526869e-03 3 1  ON 36
ci_38                -1.045220e-03 3 1  ON 37
ci_39                -1.128177e-03 3 1  ON 38
ci_40                -1.643271e-03 3 1  ON 39
ci_41                -1.288488e-03 3 1  ON 40
ci_42                -1.064311e-03 3 1  ON 41
ci_43                -2.490089e-03 3 1  ON 42
ci_44                -1.685143e-03 3 1  ON 43
ci_45                -9.527078e-04 3 1  ON 44
ci_46                -8.700373e-04 3 1  ON 45
ci_47                -8.767434e-05 3 1  ON 46
ci_48                -2.280333e-04 3 1  ON 47
ci_49                -1.179079e-03 3 1  ON 48
ci_50                -9.174559e-04 3 1  ON 49
ci_51                 7.726892e-04 3 1  ON 50
ci_52                 6.794582e-04 3 1  ON 51
ci_53                -1.031971e-03 3 1  ON 52
ci_54                -9.176147e-04 3 1  ON 53
ci_55                -6.919551e-04 3 1  ON 54
ci_56                 1.702543e-03 3 1  ON 55
ci_57                 1.719705e-03 3 1  ON 56
ci_58                -9.846127e-04 3 1  ON 57
ci_59                -9.038294e-04 3 1  ON 58
ci_60                 7.520970e-04 3 1  ON 59
ci_61                 7.905405e-04 3 1  ON 60
ci_62                -5.913826e-04 3 1  ON 61
ci_63                -7.878123e-04 3 1  ON 62
ci_64                -6.010455e-04 3 1  ON 63
ci_65                -4.418130e-04 3 1  ON 64
ci_66                -8.358111e-04 3 1  ON 65
ci_67                -6.831641e-04 3 1  ON 66
ci_68                -3.264075e-04 3 1  ON 67
ci_69                -1.602465e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3923e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.8152
    reference variance = 0.480953
====================================================
  Execution time = 2.5782e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9275e-01
  Total weights = 1.963480583e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476728895808
                                         uncertainty =       0.002281788039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476728895808
                                         uncertainty =       0.002281788039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488230737
  error estimate for blocks of size 2^( 2) =       0.000508762448
  error estimate for blocks of size 2^( 3) =       0.000528005627
  error estimate for blocks of size 2^( 4) =       0.000542740859
  error estimate for blocks of size 2^( 5) =       0.000552430755
  error estimate for blocks of size 2^( 6) =       0.000555560818
  error estimate for blocks of size 2^( 7) =       0.000560326044

      target function =      -0.712168432922
              le_mean =     -22.818345777405
             les_mean =     521.169649955169
             stat err =       0.000552764619
             autocorr =       1.281829432410
   target nu stat err =       0.000552764619
   target dn stat err =       0.002976448025
      target stat err =       0.002182343652
              std dev =       0.690462529897
             le_variance =       0.476738505192


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281834577740e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712174289127       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712174576651       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712174624777       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712174633540       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712174635354       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712174635949       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712174636105       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712174636086       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712174636097       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712174636103       residual = 8.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+02 is 1.274841e-06

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712174289127       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712174361012       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712174373044       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712174375234       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712174375689       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712174375838       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712174375876       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712174375871       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712174375874       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712174375874       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 3.187206e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712174289127       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712174307098       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712174310106       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712174310654       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712174310751       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712174310802       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712174310783       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712174310799       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712174310805       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712174310822       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 7.968081e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.716096 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0369e+01
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_01                 1.411447e-01 3 1  ON 0
ci_02                -3.830011e-02 3 1  ON 1
ci_03                -3.808328e-02 3 1  ON 2
ci_04                 3.454216e-02 3 1  ON 3
ci_05                -2.768485e-02 3 1  ON 4
ci_06                -2.704341e-02 3 1  ON 5
ci_07                 2.812380e-02 3 1  ON 6
ci_08                -9.607638e-03 3 1  ON 7
ci_09                -1.181669e-02 3 1  ON 8
ci_10                -1.162132e-02 3 1  ON 9
ci_11                 1.377934e-02 3 1  ON 10
ci_12                 9.079938e-03 3 1  ON 11
ci_13                 1.257772e-02 3 1  ON 12
ci_14                 1.234637e-02 3 1  ON 13
ci_15                 8.707119e-03 3 1  ON 14
ci_16                 8.654457e-03 3 1  ON 15
ci_17                -8.874078e-03 3 1  ON 16
ci_18                -8.377084e-03 3 1  ON 17
ci_19                 9.904038e-03 3 1  ON 18
ci_20                 7.769147e-03 3 1  ON 19
ci_21                 9.096610e-03 3 1  ON 20
ci_22                 9.195127e-03 3 1  ON 21
ci_23                 5.346214e-03 3 1  ON 22
ci_24                 4.848042e-03 3 1  ON 23
ci_25                 3.595573e-03 3 1  ON 24
ci_26                 3.621951e-03 3 1  ON 25
ci_27                 3.653149e-03 3 1  ON 26
ci_28                 2.687737e-03 3 1  ON 27
ci_29                 2.670185e-03 3 1  ON 28
ci_30                -2.193443e-03 3 1  ON 29
ci_31                -2.334907e-03 3 1  ON 30
ci_32                -1.702609e-03 3 1  ON 31
ci_33                -1.690324e-03 3 1  ON 32
ci_34                 1.557347e-03 3 1  ON 33
ci_35                 1.634687e-03 3 1  ON 34
ci_36                -1.488822e-03 3 1  ON 35
ci_37                -1.526856e-03 3 1  ON 36
ci_38                -1.045212e-03 3 1  ON 37
ci_39                -1.128187e-03 3 1  ON 38
ci_40                -1.643249e-03 3 1  ON 39
ci_41                -1.288490e-03 3 1  ON 40
ci_42                -1.064320e-03 3 1  ON 41
ci_43                -2.490064e-03 3 1  ON 42
ci_44                -1.685133e-03 3 1  ON 43
ci_45                -9.527066e-04 3 1  ON 44
ci_46                -8.700354e-04 3 1  ON 45
ci_47                -8.767142e-05 3 1  ON 46
ci_48                -2.280130e-04 3 1  ON 47
ci_49                -1.179069e-03 3 1  ON 48
ci_50                -9.174395e-04 3 1  ON 49
ci_51                 7.726844e-04 3 1  ON 50
ci_52                 6.794610e-04 3 1  ON 51
ci_53                -1.031977e-03 3 1  ON 52
ci_54                -9.176091e-04 3 1  ON 53
ci_55                -6.919614e-04 3 1  ON 54
ci_56                 1.702566e-03 3 1  ON 55
ci_57                 1.719720e-03 3 1  ON 56
ci_58                -9.846165e-04 3 1  ON 57
ci_59                -9.038432e-04 3 1  ON 58
ci_60                 7.520638e-04 3 1  ON 59
ci_61                 7.905578e-04 3 1  ON 60
ci_62                -5.913644e-04 3 1  ON 61
ci_63                -7.877997e-04 3 1  ON 62
ci_64                -6.010600e-04 3 1  ON 63
ci_65                -4.418151e-04 3 1  ON 64
ci_66                -8.357935e-04 3 1  ON 65
ci_67                -6.831738e-04 3 1  ON 66
ci_68                -3.264320e-04 3 1  ON 67
ci_69                -1.602662e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.7462
    reference variance = 0.376385
====================================================
  Execution time = 2.7105e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9435e-01
  Total weights = 1.9637e+06
  Execution time = 3.5987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474531410521
                                         uncertainty =       0.002351111819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474531410521
                                         uncertainty =       0.002351111819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487388628
  error estimate for blocks of size 2^( 2) =       0.000508710325
  error estimate for blocks of size 2^( 3) =       0.000528531671
  error estimate for blocks of size 2^( 4) =       0.000543316160
  error estimate for blocks of size 2^( 5) =       0.000553489890
  error estimate for blocks of size 2^( 6) =       0.000558498478
  error estimate for blocks of size 2^( 7) =       0.000560257237

      target function =      -0.711010770367
              le_mean =     -22.817869452073
             les_mean =     521.149514280130
             stat err =       0.000553890441
             autocorr =       1.291507572548
   target nu stat err =       0.000553890441
   target dn stat err =       0.005477873825
      target stat err =       0.003910258221
              std dev =       0.689271608094
             le_variance =       0.475095349724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474530474142
                                         uncertainty =       0.002351113757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474530474142
                                         uncertainty =       0.002351113757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487388150
  error estimate for blocks of size 2^( 2) =       0.000508709856
  error estimate for blocks of size 2^( 3) =       0.000528531220
  error estimate for blocks of size 2^( 4) =       0.000543315726
  error estimate for blocks of size 2^( 5) =       0.000553489466
  error estimate for blocks of size 2^( 6) =       0.000558498043
  error estimate for blocks of size 2^( 7) =       0.000560256767

      target function =      -0.711011536369
              le_mean =     -22.817869448181
             les_mean =     521.149513016332
             stat err =       0.000553890001
             autocorr =       1.291508052498
   target nu stat err =       0.000553890001
   target dn stat err =       0.005478067110
      target stat err =       0.003910401726
              std dev =       0.689270931733
             le_variance =       0.475094417332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474530942286
                                         uncertainty =       0.002351112787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474530942286
                                         uncertainty =       0.002351112787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487388389
  error estimate for blocks of size 2^( 2) =       0.000508710091
  error estimate for blocks of size 2^( 3) =       0.000528531445
  error estimate for blocks of size 2^( 4) =       0.000543315943
  error estimate for blocks of size 2^( 5) =       0.000553489678
  error estimate for blocks of size 2^( 6) =       0.000558498260
  error estimate for blocks of size 2^( 7) =       0.000560257002

      target function =      -0.711011153502
              le_mean =     -22.817869450123
             les_mean =     521.149513647894
             stat err =       0.000553890221
             autocorr =       1.291507812537
   target nu stat err =       0.000553890221
   target dn stat err =       0.005477970460
      target stat err =       0.003910329970
              std dev =       0.689271269880
             le_variance =       0.475094883483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474531351989
                                         uncertainty =       0.002351111940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474531351989
                                         uncertainty =       0.002351111940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487388598
  error estimate for blocks of size 2^( 2) =       0.000508710296
  error estimate for blocks of size 2^( 3) =       0.000528531642
  error estimate for blocks of size 2^( 4) =       0.000543316133
  error estimate for blocks of size 2^( 5) =       0.000553489864
  error estimate for blocks of size 2^( 6) =       0.000558498450
  error estimate for blocks of size 2^( 7) =       0.000560257208

      target function =      -0.711010818272
              le_mean =     -22.817869451829
             les_mean =     521.149514201066
             stat err =       0.000553890414
             autocorr =       1.291507602549
   target nu stat err =       0.000553890414
   target dn stat err =       0.005477885903
      target stat err =       0.003910267189
              std dev =       0.689271565815
             le_variance =       0.475095291441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.711010770367        initial
     6.1035e+02     6.1035e+03             1.2748e-06        -0.711011536369  <--
     2.4414e+03     2.4414e+04             3.1872e-07        -0.711011153502
     9.7656e+03     9.7656e+04             7.9681e-08        -0.711010818272

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 4.5154e+01
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_01                 1.411437e-01 3 1  ON 0
ci_02                -3.829937e-02 3 1  ON 1
ci_03                -3.808249e-02 3 1  ON 2
ci_04                 3.454127e-02 3 1  ON 3
ci_05                -2.768434e-02 3 1  ON 4
ci_06                -2.704285e-02 3 1  ON 5
ci_07                 2.812369e-02 3 1  ON 6
ci_08                -9.607336e-03 3 1  ON 7
ci_09                -1.181646e-02 3 1  ON 8
ci_10                -1.162108e-02 3 1  ON 9
ci_11                 1.377923e-02 3 1  ON 10
ci_12                 9.079786e-03 3 1  ON 11
ci_13                 1.257770e-02 3 1  ON 12
ci_14                 1.234641e-02 3 1  ON 13
ci_15                 8.706997e-03 3 1  ON 14
ci_16                 8.654314e-03 3 1  ON 15
ci_17                -8.874050e-03 3 1  ON 16
ci_18                -8.376995e-03 3 1  ON 17
ci_19                 9.903928e-03 3 1  ON 18
ci_20                 7.769004e-03 3 1  ON 19
ci_21                 9.096553e-03 3 1  ON 20
ci_22                 9.195094e-03 3 1  ON 21
ci_23                 5.346141e-03 3 1  ON 22
ci_24                 4.847941e-03 3 1  ON 23
ci_25                 3.595516e-03 3 1  ON 24
ci_26                 3.621970e-03 3 1  ON 25
ci_27                 3.653150e-03 3 1  ON 26
ci_28                 2.687692e-03 3 1  ON 27
ci_29                 2.670106e-03 3 1  ON 28
ci_30                -2.193359e-03 3 1  ON 29
ci_31                -2.334815e-03 3 1  ON 30
ci_32                -1.702526e-03 3 1  ON 31
ci_33                -1.690214e-03 3 1  ON 32
ci_34                 1.557364e-03 3 1  ON 33
ci_35                 1.634560e-03 3 1  ON 34
ci_36                -1.488780e-03 3 1  ON 35
ci_37                -1.526817e-03 3 1  ON 36
ci_38                -1.045187e-03 3 1  ON 37
ci_39                -1.128216e-03 3 1  ON 38
ci_40                -1.643182e-03 3 1  ON 39
ci_41                -1.288497e-03 3 1  ON 40
ci_42                -1.064348e-03 3 1  ON 41
ci_43                -2.489989e-03 3 1  ON 42
ci_44                -1.685106e-03 3 1  ON 43
ci_45                -9.527027e-04 3 1  ON 44
ci_46                -8.700297e-04 3 1  ON 45
ci_47                -8.766268e-05 3 1  ON 46
ci_48                -2.279522e-04 3 1  ON 47
ci_49                -1.179040e-03 3 1  ON 48
ci_50                -9.173902e-04 3 1  ON 49
ci_51                 7.726703e-04 3 1  ON 50
ci_52                 6.794693e-04 3 1  ON 51
ci_53                -1.031996e-03 3 1  ON 52
ci_54                -9.175922e-04 3 1  ON 53
ci_55                -6.919800e-04 3 1  ON 54
ci_56                 1.702634e-03 3 1  ON 55
ci_57                 1.719767e-03 3 1  ON 56
ci_58                -9.846280e-04 3 1  ON 57
ci_59                -9.038844e-04 3 1  ON 58
ci_60                 7.519644e-04 3 1  ON 59
ci_61                 7.906097e-04 3 1  ON 60
ci_62                -5.913100e-04 3 1  ON 61
ci_63                -7.877620e-04 3 1  ON 62
ci_64                -6.011032e-04 3 1  ON 63
ci_65                -4.418213e-04 3 1  ON 64
ci_66                -8.357406e-04 3 1  ON 65
ci_67                -6.832030e-04 3 1  ON 66
ci_68                -3.265058e-04 3 1  ON 67
ci_69                -1.603255e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.8573
    reference variance = 0.282308
====================================================
  Execution time = 2.5702e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.8892e-01
  Total weights = 1.963883582e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474353966577
                                         uncertainty =       0.002288785859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474353966577
                                         uncertainty =       0.002288785859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486989239
  error estimate for blocks of size 2^( 2) =       0.000508334242
  error estimate for blocks of size 2^( 3) =       0.000528965694
  error estimate for blocks of size 2^( 4) =       0.000544631944
  error estimate for blocks of size 2^( 5) =       0.000553751442
  error estimate for blocks of size 2^( 6) =       0.000557451681
  error estimate for blocks of size 2^( 7) =       0.000562163638

      target function =      -0.714857706621
              le_mean =     -22.816927576999
             les_mean =     521.101108275381
             stat err =       0.000554499676
             autocorr =       1.296474156166
   target nu stat err =       0.000554499676
   target dn stat err =       0.002935701431
      target stat err =       0.002166295744
              std dev =       0.688706786772
             le_variance =       0.474317038145


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281692757700e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714863353692       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714864425056       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714864611428       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714864679741       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714864698209       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714864707486       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714864708531       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714864708138       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714864708040       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714864708029       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.714864708024       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+02 is 4.868177e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714863353692       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714863621597       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714863668198       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714863685278       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714863689894       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714863692213       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714863692474       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714863692376       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714863692352       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714863692349       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.714863692347       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+02 is 1.217201e-06

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714863353692       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714863420672       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714863432323       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714863436593       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714863437746       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714863438327       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714863438392       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714863438363       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714863438361       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714863438361       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.714863438360       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 3.043099e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.720179 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0297e+01
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_01                 1.411425e-01 3 1  ON 0
ci_02                -3.829842e-02 3 1  ON 1
ci_03                -3.808148e-02 3 1  ON 2
ci_04                 3.454014e-02 3 1  ON 3
ci_05                -2.768365e-02 3 1  ON 4
ci_06                -2.704215e-02 3 1  ON 5
ci_07                 2.812357e-02 3 1  ON 6
ci_08                -9.606887e-03 3 1  ON 7
ci_09                -1.181616e-02 3 1  ON 8
ci_10                -1.162078e-02 3 1  ON 9
ci_11                 1.377904e-02 3 1  ON 10
ci_12                 9.079671e-03 3 1  ON 11
ci_13                 1.257769e-02 3 1  ON 12
ci_14                 1.234644e-02 3 1  ON 13
ci_15                 8.706758e-03 3 1  ON 14
ci_16                 8.654196e-03 3 1  ON 15
ci_17                -8.873825e-03 3 1  ON 16
ci_18                -8.376892e-03 3 1  ON 17
ci_19                 9.903821e-03 3 1  ON 18
ci_20                 7.768829e-03 3 1  ON 19
ci_21                 9.096517e-03 3 1  ON 20
ci_22                 9.194903e-03 3 1  ON 21
ci_23                 5.346159e-03 3 1  ON 22
ci_24                 4.847931e-03 3 1  ON 23
ci_25                 3.595444e-03 3 1  ON 24
ci_26                 3.621842e-03 3 1  ON 25
ci_27                 3.653002e-03 3 1  ON 26
ci_28                 2.687519e-03 3 1  ON 27
ci_29                 2.669976e-03 3 1  ON 28
ci_30                -2.193280e-03 3 1  ON 29
ci_31                -2.334755e-03 3 1  ON 30
ci_32                -1.702502e-03 3 1  ON 31
ci_33                -1.690024e-03 3 1  ON 32
ci_34                 1.557287e-03 3 1  ON 33
ci_35                 1.634408e-03 3 1  ON 34
ci_36                -1.488770e-03 3 1  ON 35
ci_37                -1.526750e-03 3 1  ON 36
ci_38                -1.045220e-03 3 1  ON 37
ci_39                -1.128163e-03 3 1  ON 38
ci_40                -1.643143e-03 3 1  ON 39
ci_41                -1.288407e-03 3 1  ON 40
ci_42                -1.064335e-03 3 1  ON 41
ci_43                -2.489878e-03 3 1  ON 42
ci_44                -1.685063e-03 3 1  ON 43
ci_45                -9.526939e-04 3 1  ON 44
ci_46                -8.700207e-04 3 1  ON 45
ci_47                -8.754469e-05 3 1  ON 46
ci_48                -2.278790e-04 3 1  ON 47
ci_49                -1.178995e-03 3 1  ON 48
ci_50                -9.172389e-04 3 1  ON 49
ci_51                 7.726057e-04 3 1  ON 50
ci_52                 6.793117e-04 3 1  ON 51
ci_53                -1.032020e-03 3 1  ON 52
ci_54                -9.176261e-04 3 1  ON 53
ci_55                -6.919715e-04 3 1  ON 54
ci_56                 1.702690e-03 3 1  ON 55
ci_57                 1.719810e-03 3 1  ON 56
ci_58                -9.846199e-04 3 1  ON 57
ci_59                -9.038290e-04 3 1  ON 58
ci_60                 7.516924e-04 3 1  ON 59
ci_61                 7.906313e-04 3 1  ON 60
ci_62                -5.912848e-04 3 1  ON 61
ci_63                -7.877805e-04 3 1  ON 62
ci_64                -6.010559e-04 3 1  ON 63
ci_65                -4.417987e-04 3 1  ON 64
ci_66                -8.356611e-04 3 1  ON 65
ci_67                -6.830914e-04 3 1  ON 66
ci_68                -3.265577e-04 3 1  ON 67
ci_69                -1.603631e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.7858
    reference variance = 0.300366
====================================================
  Execution time = 2.5044e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8702e-01
  Total weights = 1.9636e+06
  Execution time = 3.6620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473179320064
                                         uncertainty =       0.002344224454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473179320064
                                         uncertainty =       0.002344224454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486373979
  error estimate for blocks of size 2^( 2) =       0.000507493109
  error estimate for blocks of size 2^( 3) =       0.000527477890
  error estimate for blocks of size 2^( 4) =       0.000542739056
  error estimate for blocks of size 2^( 5) =       0.000552580780
  error estimate for blocks of size 2^( 6) =       0.000559166449
  error estimate for blocks of size 2^( 7) =       0.000561367198

      target function =      -0.716240709008
              le_mean =     -22.817708832339
             les_mean =     521.134852875691
             stat err =       0.000553963371
             autocorr =       1.297243294397
   target nu stat err =       0.000553963371
   target dn stat err =       0.003029112383
      target stat err =       0.002241479633
              std dev =       0.687836677314
             le_variance =       0.473119294659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473175253681
                                         uncertainty =       0.002344161201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473175253681
                                         uncertainty =       0.002344161201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486371889
  error estimate for blocks of size 2^( 2) =       0.000507491055
  error estimate for blocks of size 2^( 3) =       0.000527475886
  error estimate for blocks of size 2^( 4) =       0.000542737164
  error estimate for blocks of size 2^( 5) =       0.000552578966
  error estimate for blocks of size 2^( 6) =       0.000559164605
  error estimate for blocks of size 2^( 7) =       0.000561365485

      target function =      -0.716242932505
              le_mean =     -22.817708780289
             les_mean =     521.134847397733
             stat err =       0.000553961555
             autocorr =       1.297245935905
   target nu stat err =       0.000553961555
   target dn stat err =       0.003029050389
      target stat err =       0.002241449443
              std dev =       0.687833722474
             le_variance =       0.473115229773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473177286171
                                         uncertainty =       0.002344192816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473177286171
                                         uncertainty =       0.002344192816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486372934
  error estimate for blocks of size 2^( 2) =       0.000507492082
  error estimate for blocks of size 2^( 3) =       0.000527476887
  error estimate for blocks of size 2^( 4) =       0.000542738110
  error estimate for blocks of size 2^( 5) =       0.000552579873
  error estimate for blocks of size 2^( 6) =       0.000559165527
  error estimate for blocks of size 2^( 7) =       0.000561366341

      target function =      -0.716241831022
              le_mean =     -22.817708806267
             les_mean =     521.134850120257
             stat err =       0.000553962463
             autocorr =       1.297244615434
   target nu stat err =       0.000553962463
   target dn stat err =       0.003029081195
      target stat err =       0.002241464468
              std dev =       0.687835199385
             le_variance =       0.473117261514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473179065784
                                         uncertainty =       0.002344220498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473179065784
                                         uncertainty =       0.002344220498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486373848
  error estimate for blocks of size 2^( 2) =       0.000507492980
  error estimate for blocks of size 2^( 3) =       0.000527477764
  error estimate for blocks of size 2^( 4) =       0.000542738938
  error estimate for blocks of size 2^( 5) =       0.000552580667
  error estimate for blocks of size 2^( 6) =       0.000559166334
  error estimate for blocks of size 2^( 7) =       0.000561367091

      target function =      -0.716240850320
              le_mean =     -22.817708829075
             les_mean =     521.134852529569
             stat err =       0.000553963257
             autocorr =       1.297243459531
   target nu stat err =       0.000553963257
   target dn stat err =       0.003029108465
      target stat err =       0.002241477729
              std dev =       0.687836492542
             le_variance =       0.473119040472


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.716240709008        initial
     1.5259e+02     1.5259e+03             4.8682e-06        -0.716242932505  <--
     6.1035e+02     6.1035e+03             1.2172e-06        -0.716241831022
     2.4414e+03     2.4414e+04             3.0431e-07        -0.716240850320

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 4.3152e+01
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_01                 1.411388e-01 3 1  ON 0
ci_02                -3.829556e-02 3 1  ON 1
ci_03                -3.807844e-02 3 1  ON 2
ci_04                 3.453673e-02 3 1  ON 3
ci_05                -2.768158e-02 3 1  ON 4
ci_06                -2.704006e-02 3 1  ON 5
ci_07                 2.812320e-02 3 1  ON 6
ci_08                -9.605539e-03 3 1  ON 7
ci_09                -1.181526e-02 3 1  ON 8
ci_10                -1.161986e-02 3 1  ON 9
ci_11                 1.377849e-02 3 1  ON 10
ci_12                 9.079325e-03 3 1  ON 11
ci_13                 1.257767e-02 3 1  ON 12
ci_14                 1.234653e-02 3 1  ON 13
ci_15                 8.706044e-03 3 1  ON 14
ci_16                 8.653842e-03 3 1  ON 15
ci_17                -8.873148e-03 3 1  ON 16
ci_18                -8.376583e-03 3 1  ON 17
ci_19                 9.903499e-03 3 1  ON 18
ci_20                 7.768304e-03 3 1  ON 19
ci_21                 9.096407e-03 3 1  ON 20
ci_22                 9.194328e-03 3 1  ON 21
ci_23                 5.346213e-03 3 1  ON 22
ci_24                 4.847900e-03 3 1  ON 23
ci_25                 3.595226e-03 3 1  ON 24
ci_26                 3.621458e-03 3 1  ON 25
ci_27                 3.652557e-03 3 1  ON 26
ci_28                 2.687002e-03 3 1  ON 27
ci_29                 2.669587e-03 3 1  ON 28
ci_30                -2.193044e-03 3 1  ON 29
ci_31                -2.334573e-03 3 1  ON 30
ci_32                -1.702432e-03 3 1  ON 31
ci_33                -1.689452e-03 3 1  ON 32
ci_34                 1.557056e-03 3 1  ON 33
ci_35                 1.633952e-03 3 1  ON 34
ci_36                -1.488739e-03 3 1  ON 35
ci_37                -1.526548e-03 3 1  ON 36
ci_38                -1.045318e-03 3 1  ON 37
ci_39                -1.128007e-03 3 1  ON 38
ci_40                -1.643025e-03 3 1  ON 39
ci_41                -1.288138e-03 3 1  ON 40
ci_42                -1.064294e-03 3 1  ON 41
ci_43                -2.489547e-03 3 1  ON 42
ci_44                -1.684936e-03 3 1  ON 43
ci_45                -9.526676e-04 3 1  ON 44
ci_46                -8.699935e-04 3 1  ON 45
ci_47                -8.719077e-05 3 1  ON 46
ci_48                -2.276595e-04 3 1  ON 47
ci_49                -1.178859e-03 3 1  ON 48
ci_50                -9.167852e-04 3 1  ON 49
ci_51                 7.724119e-04 3 1  ON 50
ci_52                 6.788389e-04 3 1  ON 51
ci_53                -1.032094e-03 3 1  ON 52
ci_54                -9.177278e-04 3 1  ON 53
ci_55                -6.919458e-04 3 1  ON 54
ci_56                 1.702855e-03 3 1  ON 55
ci_57                 1.719938e-03 3 1  ON 56
ci_58                -9.845955e-04 3 1  ON 57
ci_59                -9.036628e-04 3 1  ON 58
ci_60                 7.508765e-04 3 1  ON 59
ci_61                 7.906961e-04 3 1  ON 60
ci_62                -5.912092e-04 3 1  ON 61
ci_63                -7.878358e-04 3 1  ON 62
ci_64                -6.009140e-04 3 1  ON 63
ci_65                -4.417308e-04 3 1  ON 64
ci_66                -8.354227e-04 3 1  ON 65
ci_67                -6.827567e-04 3 1  ON 66
ci_68                -3.267136e-04 3 1  ON 67
ci_69                -1.604760e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3474e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.8082
    reference variance = 0.328766
====================================================
  Execution time = 2.5624e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9909e-01
  Total weights = 1.963819578e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478248363660
                                         uncertainty =       0.002799042618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478248363660
                                         uncertainty =       0.002799042618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488978232
  error estimate for blocks of size 2^( 2) =       0.000509772267
  error estimate for blocks of size 2^( 3) =       0.000529745469
  error estimate for blocks of size 2^( 4) =       0.000545008969
  error estimate for blocks of size 2^( 5) =       0.000554443171
  error estimate for blocks of size 2^( 6) =       0.000559262837
  error estimate for blocks of size 2^( 7) =       0.000564237938

      target function =      -0.707666039984
              le_mean =     -22.817301750040
             les_mean =     521.128352746746
             stat err =       0.000555738229
             autocorr =       1.291699503792
   target nu stat err =       0.000555738229
   target dn stat err =       0.005417136260
      target stat err =       0.003829050044
              std dev =       0.691519647867
             le_variance =       0.478199423387


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281730175004e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707686052340       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707690223669       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707690969135       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707691104404       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707691145822       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707691163954       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707691165393       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707691165092       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707691165209       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707691165105       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+01 is 2.340470e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707686052340       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707687096125       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707687282598       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707687316420       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707687326769       residual = 7.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707687331297       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707687331656       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707687331580       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707687331609       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707687331583       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+02 is 5.854052e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.707686052340       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.707686313346       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.707686359970       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.707686368426       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.707686371013       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.707686372145       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.707686372234       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707686372216       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.707686372222       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.707686372216       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+02 is 1.463693e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.723683 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0250e+01
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_01                 1.411330e-01 3 1  ON 0
ci_02                -3.829249e-02 3 1  ON 1
ci_03                -3.807408e-02 3 1  ON 2
ci_04                 3.453266e-02 3 1  ON 3
ci_05                -2.767872e-02 3 1  ON 4
ci_06                -2.703684e-02 3 1  ON 5
ci_07                 2.812266e-02 3 1  ON 6
ci_08                -9.603928e-03 3 1  ON 7
ci_09                -1.181394e-02 3 1  ON 8
ci_10                -1.161866e-02 3 1  ON 9
ci_11                 1.377792e-02 3 1  ON 10
ci_12                 9.078370e-03 3 1  ON 11
ci_13                 1.257762e-02 3 1  ON 12
ci_14                 1.234635e-02 3 1  ON 13
ci_15                 8.705286e-03 3 1  ON 14
ci_16                 8.652977e-03 3 1  ON 15
ci_17                -8.872103e-03 3 1  ON 16
ci_18                -8.376105e-03 3 1  ON 17
ci_19                 9.903311e-03 3 1  ON 18
ci_20                 7.767776e-03 3 1  ON 19
ci_21                 9.096318e-03 3 1  ON 20
ci_22                 9.193887e-03 3 1  ON 21
ci_23                 5.346043e-03 3 1  ON 22
ci_24                 4.848156e-03 3 1  ON 23
ci_25                 3.595304e-03 3 1  ON 24
ci_26                 3.621224e-03 3 1  ON 25
ci_27                 3.652783e-03 3 1  ON 26
ci_28                 2.686235e-03 3 1  ON 27
ci_29                 2.669308e-03 3 1  ON 28
ci_30                -2.192816e-03 3 1  ON 29
ci_31                -2.334247e-03 3 1  ON 30
ci_32                -1.701893e-03 3 1  ON 31
ci_33                -1.689012e-03 3 1  ON 32
ci_34                 1.557252e-03 3 1  ON 33
ci_35                 1.633713e-03 3 1  ON 34
ci_36                -1.488481e-03 3 1  ON 35
ci_37                -1.526017e-03 3 1  ON 36
ci_38                -1.045267e-03 3 1  ON 37
ci_39                -1.127772e-03 3 1  ON 38
ci_40                -1.643218e-03 3 1  ON 39
ci_41                -1.287861e-03 3 1  ON 40
ci_42                -1.064183e-03 3 1  ON 41
ci_43                -2.489656e-03 3 1  ON 42
ci_44                -1.684982e-03 3 1  ON 43
ci_45                -9.526588e-04 3 1  ON 44
ci_46                -8.696466e-04 3 1  ON 45
ci_47                -8.696169e-05 3 1  ON 46
ci_48                -2.274101e-04 3 1  ON 47
ci_49                -1.179051e-03 3 1  ON 48
ci_50                -9.166079e-04 3 1  ON 49
ci_51                 7.722770e-04 3 1  ON 50
ci_52                 6.786242e-04 3 1  ON 51
ci_53                -1.031972e-03 3 1  ON 52
ci_54                -9.172693e-04 3 1  ON 53
ci_55                -6.918377e-04 3 1  ON 54
ci_56                 1.703126e-03 3 1  ON 55
ci_57                 1.719986e-03 3 1  ON 56
ci_58                -9.848127e-04 3 1  ON 57
ci_59                -9.033214e-04 3 1  ON 58
ci_60                 7.506482e-04 3 1  ON 59
ci_61                 7.899165e-04 3 1  ON 60
ci_62                -5.907627e-04 3 1  ON 61
ci_63                -7.874805e-04 3 1  ON 62
ci_64                -6.009304e-04 3 1  ON 63
ci_65                -4.416212e-04 3 1  ON 64
ci_66                -8.351771e-04 3 1  ON 65
ci_67                -6.830603e-04 3 1  ON 66
ci_68                -3.273182e-04 3 1  ON 67
ci_69                -1.611281e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.8676
    reference variance = 0.799014
====================================================
  Execution time = 2.5121e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9309e-01
  Total weights = 1.9639e+06
  Execution time = 3.5872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477200829282
                                         uncertainty =       0.002798374878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477200829282
                                         uncertainty =       0.002798374878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488461063
  error estimate for blocks of size 2^( 2) =       0.000509574632
  error estimate for blocks of size 2^( 3) =       0.000529424186
  error estimate for blocks of size 2^( 4) =       0.000544398475
  error estimate for blocks of size 2^( 5) =       0.000555253717
  error estimate for blocks of size 2^( 6) =       0.000559025390
  error estimate for blocks of size 2^( 7) =       0.000561956477

      target function =      -0.711900174792
              le_mean =     -22.817485179941
             les_mean =     521.130726446212
             stat err =       0.000555158515
             autocorr =       1.291737028446
   target nu stat err =       0.000555158515
   target dn stat err =       0.003759191870
      target stat err =       0.002718535973
              std dev =       0.690788260421
             le_variance =       0.477188420736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477186612912
                                         uncertainty =       0.002798397898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477186612912
                                         uncertainty =       0.002798397898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488453788
  error estimate for blocks of size 2^( 2) =       0.000509567468
  error estimate for blocks of size 2^( 3) =       0.000529417268
  error estimate for blocks of size 2^( 4) =       0.000544392011
  error estimate for blocks of size 2^( 5) =       0.000555247567
  error estimate for blocks of size 2^( 6) =       0.000559019443
  error estimate for blocks of size 2^( 7) =       0.000561950404

      target function =      -0.711917395819
              le_mean =     -22.817485329866
             les_mean =     521.130708970846
             stat err =       0.000555152356
             autocorr =       1.291746850333
   target nu stat err =       0.000555152356
   target dn stat err =       0.003759328679
      target stat err =       0.002718758974
              std dev =       0.690777971368
             le_variance =       0.477174205727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477193710999
                                         uncertainty =       0.002798386390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477193710999
                                         uncertainty =       0.002798386390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488457420
  error estimate for blocks of size 2^( 2) =       0.000509571045
  error estimate for blocks of size 2^( 3) =       0.000529420722
  error estimate for blocks of size 2^( 4) =       0.000544395239
  error estimate for blocks of size 2^( 5) =       0.000555250637
  error estimate for blocks of size 2^( 6) =       0.000559022412
  error estimate for blocks of size 2^( 7) =       0.000561953436

      target function =      -0.711909995355
              le_mean =     -22.817485253980
             les_mean =     521.130715957410
             stat err =       0.000555155431
             autocorr =       1.291741945384
   target nu stat err =       0.000555155431
   target dn stat err =       0.003759252035
      target stat err =       0.002718650806
              std dev =       0.690783108604
             le_variance =       0.477181303133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477199938832
                                         uncertainty =       0.002798376310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477199938832
                                         uncertainty =       0.002798376310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488460608
  error estimate for blocks of size 2^( 2) =       0.000509574183
  error estimate for blocks of size 2^( 3) =       0.000529423753
  error estimate for blocks of size 2^( 4) =       0.000544398070
  error estimate for blocks of size 2^( 5) =       0.000555253332
  error estimate for blocks of size 2^( 6) =       0.000559025017
  error estimate for blocks of size 2^( 7) =       0.000561956096

      target function =      -0.711901624036
              le_mean =     -22.817485189071
             les_mean =     521.130724816338
             stat err =       0.000555158129
             autocorr =       1.291737643548
   target nu stat err =       0.000555158129
   target dn stat err =       0.003759197540
      target stat err =       0.002718550701
              std dev =       0.690787615965
             le_variance =       0.477187530371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.711900174792        initial
     3.8147e+01     3.8147e+02             2.3405e-05        -0.711917395819  <--
     1.5259e+02     1.5259e+03             5.8541e-06        -0.711909995355
     6.1035e+02     6.1035e+03             1.4637e-06        -0.711901624036

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 4.3110e+01
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_01                 1.411154e-01 3 1  ON 0
ci_02                -3.828329e-02 3 1  ON 1
ci_03                -3.806100e-02 3 1  ON 2
ci_04                 3.452046e-02 3 1  ON 3
ci_05                -2.767014e-02 3 1  ON 4
ci_06                -2.702720e-02 3 1  ON 5
ci_07                 2.812101e-02 3 1  ON 6
ci_08                -9.599100e-03 3 1  ON 7
ci_09                -1.180997e-02 3 1  ON 8
ci_10                -1.161503e-02 3 1  ON 9
ci_11                 1.377619e-02 3 1  ON 10
ci_12                 9.075507e-03 3 1  ON 11
ci_13                 1.257747e-02 3 1  ON 12
ci_14                 1.234584e-02 3 1  ON 13
ci_15                 8.703015e-03 3 1  ON 14
ci_16                 8.650383e-03 3 1  ON 15
ci_17                -8.868971e-03 3 1  ON 16
ci_18                -8.374672e-03 3 1  ON 17
ci_19                 9.902749e-03 3 1  ON 18
ci_20                 7.766191e-03 3 1  ON 19
ci_21                 9.096050e-03 3 1  ON 20
ci_22                 9.192567e-03 3 1  ON 21
ci_23                 5.345532e-03 3 1  ON 22
ci_24                 4.848922e-03 3 1  ON 23
ci_25                 3.595534e-03 3 1  ON 24
ci_26                 3.620522e-03 3 1  ON 25
ci_27                 3.653461e-03 3 1  ON 26
ci_28                 2.683935e-03 3 1  ON 27
ci_29                 2.668471e-03 3 1  ON 28
ci_30                -2.192133e-03 3 1  ON 29
ci_31                -2.333270e-03 3 1  ON 30
ci_32                -1.700279e-03 3 1  ON 31
ci_33                -1.687694e-03 3 1  ON 32
ci_34                 1.557840e-03 3 1  ON 33
ci_35                 1.632998e-03 3 1  ON 34
ci_36                -1.487707e-03 3 1  ON 35
ci_37                -1.524429e-03 3 1  ON 36
ci_38                -1.045115e-03 3 1  ON 37
ci_39                -1.127069e-03 3 1  ON 38
ci_40                -1.643795e-03 3 1  ON 39
ci_41                -1.287033e-03 3 1  ON 40
ci_42                -1.063848e-03 3 1  ON 41
ci_43                -2.489983e-03 3 1  ON 42
ci_44                -1.685122e-03 3 1  ON 43
ci_45                -9.526324e-04 3 1  ON 44
ci_46                -8.686072e-04 3 1  ON 45
ci_47                -8.627480e-05 3 1  ON 46
ci_48                -2.266623e-04 3 1  ON 47
ci_49                -1.179626e-03 3 1  ON 48
ci_50                -9.160768e-04 3 1  ON 49
ci_51                 7.718728e-04 3 1  ON 50
ci_52                 6.779807e-04 3 1  ON 51
ci_53                -1.031607e-03 3 1  ON 52
ci_54                -9.158953e-04 3 1  ON 53
ci_55                -6.915140e-04 3 1  ON 54
ci_56                 1.703937e-03 3 1  ON 55
ci_57                 1.720129e-03 3 1  ON 56
ci_58                -9.854634e-04 3 1  ON 57
ci_59                -9.022984e-04 3 1  ON 58
ci_60                 7.499635e-04 3 1  ON 59
ci_61                 7.875788e-04 3 1  ON 60
ci_62                -5.894252e-04 3 1  ON 61
ci_63                -7.864161e-04 3 1  ON 62
ci_64                -6.009794e-04 3 1  ON 63
ci_65                -4.412926e-04 3 1  ON 64
ci_66                -8.344412e-04 3 1  ON 65
ci_67                -6.839698e-04 3 1  ON 66
ci_68                -3.291298e-04 3 1  ON 67
ci_69                -1.630824e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3366e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.7489
    reference variance = 0.281491
====================================================
  Execution time = 2.5778e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5362e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9329e-01
  Total weights = 1.963656571e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477055378510
                                         uncertainty =       0.003687411950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477055378510
                                         uncertainty =       0.003687411950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488349846
  error estimate for blocks of size 2^( 2) =       0.000509318598
  error estimate for blocks of size 2^( 3) =       0.000529279321
  error estimate for blocks of size 2^( 4) =       0.000545130869
  error estimate for blocks of size 2^( 5) =       0.000554470145
  error estimate for blocks of size 2^( 6) =       0.000562000782
  error estimate for blocks of size 2^( 7) =       0.000567519179

      target function =      -0.711746339230
              le_mean =     -22.817294927950
             les_mean =     521.122240524978
             stat err =       0.000557280244
             autocorr =       1.302222470606
   target nu stat err =       0.000557280244
   target dn stat err =       0.005495340032
      target stat err =       0.003927840646
              std dev =       0.690630974707
             le_variance =       0.476971143224


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281729492795e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711767335386       residual = 2.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711785326240       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711788390529       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711788944473       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711789071751       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711789103011       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711789114736       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711789113400       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711789113771       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711789113811       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+00 is 8.933468e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711767335386       residual = 2.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711771849561       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711772617367       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711772755924       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711772787659       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711772795430       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711772798341       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711772798008       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711772798101       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711772798110       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+01 is 2.237868e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711767335386       residual = 2.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711768464964       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711768657024       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711768691667       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711768699596       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711768701536       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711768702262       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711768702179       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711768702202       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711768702205       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+02 is 5.597490e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.727179 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0406e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_01                 1.410930e-01 3 1  ON 0
ci_02                -3.826657e-02 3 1  ON 1
ci_03                -3.804337e-02 3 1  ON 2
ci_04                 3.450288e-02 3 1  ON 3
ci_05                -2.765978e-02 3 1  ON 4
ci_06                -2.701699e-02 3 1  ON 5
ci_07                 2.811861e-02 3 1  ON 6
ci_08                -9.592610e-03 3 1  ON 7
ci_09                -1.180466e-02 3 1  ON 8
ci_10                -1.161059e-02 3 1  ON 9
ci_11                 1.377567e-02 3 1  ON 10
ci_12                 9.071608e-03 3 1  ON 11
ci_13                 1.258124e-02 3 1  ON 12
ci_14                 1.234683e-02 3 1  ON 13
ci_15                 8.698671e-03 3 1  ON 14
ci_16                 8.648036e-03 3 1  ON 15
ci_17                -8.865988e-03 3 1  ON 16
ci_18                -8.370204e-03 3 1  ON 17
ci_19                 9.902653e-03 3 1  ON 18
ci_20                 7.763719e-03 3 1  ON 19
ci_21                 9.094862e-03 3 1  ON 20
ci_22                 9.194472e-03 3 1  ON 21
ci_23                 5.344509e-03 3 1  ON 22
ci_24                 4.847727e-03 3 1  ON 23
ci_25                 3.595773e-03 3 1  ON 24
ci_26                 3.619751e-03 3 1  ON 25
ci_27                 3.653442e-03 3 1  ON 26
ci_28                 2.680829e-03 3 1  ON 27
ci_29                 2.665416e-03 3 1  ON 28
ci_30                -2.190850e-03 3 1  ON 29
ci_31                -2.331321e-03 3 1  ON 30
ci_32                -1.699472e-03 3 1  ON 31
ci_33                -1.685333e-03 3 1  ON 32
ci_34                 1.555506e-03 3 1  ON 33
ci_35                 1.631840e-03 3 1  ON 34
ci_36                -1.486664e-03 3 1  ON 35
ci_37                -1.523499e-03 3 1  ON 36
ci_38                -1.045137e-03 3 1  ON 37
ci_39                -1.125673e-03 3 1  ON 38
ci_40                -1.644183e-03 3 1  ON 39
ci_41                -1.285894e-03 3 1  ON 40
ci_42                -1.063446e-03 3 1  ON 41
ci_43                -2.488431e-03 3 1  ON 42
ci_44                -1.682514e-03 3 1  ON 43
ci_45                -9.517735e-04 3 1  ON 44
ci_46                -8.686532e-04 3 1  ON 45
ci_47                -8.515293e-05 3 1  ON 46
ci_48                -2.235185e-04 3 1  ON 47
ci_49                -1.179835e-03 3 1  ON 48
ci_50                -9.161053e-04 3 1  ON 49
ci_51                 7.716971e-04 3 1  ON 50
ci_52                 6.768256e-04 3 1  ON 51
ci_53                -1.031527e-03 3 1  ON 52
ci_54                -9.152873e-04 3 1  ON 53
ci_55                -6.910702e-04 3 1  ON 54
ci_56                 1.705233e-03 3 1  ON 55
ci_57                 1.719047e-03 3 1  ON 56
ci_58                -9.868240e-04 3 1  ON 57
ci_59                -9.006245e-04 3 1  ON 58
ci_60                 7.505335e-04 3 1  ON 59
ci_61                 7.856334e-04 3 1  ON 60
ci_62                -5.889579e-04 3 1  ON 61
ci_63                -7.864364e-04 3 1  ON 62
ci_64                -6.006877e-04 3 1  ON 63
ci_65                -4.405951e-04 3 1  ON 64
ci_66                -8.334153e-04 3 1  ON 65
ci_67                -6.830385e-04 3 1  ON 66
ci_68                -3.315097e-04 3 1  ON 67
ci_69                -1.657439e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.745
    reference variance = 0.629924
====================================================
  Execution time = 2.5093e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9059e-01
  Total weights = 1.9632e+06
  Execution time = 3.5892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475512471019
                                         uncertainty =       0.002108865876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475512471019
                                         uncertainty =       0.002108865876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487604169
  error estimate for blocks of size 2^( 2) =       0.000508775678
  error estimate for blocks of size 2^( 3) =       0.000528650139
  error estimate for blocks of size 2^( 4) =       0.000543709978
  error estimate for blocks of size 2^( 5) =       0.000551895832
  error estimate for blocks of size 2^( 6) =       0.000556293829
  error estimate for blocks of size 2^( 7) =       0.000560160962

      target function =      -0.713662244621
              le_mean =     -22.817697875545
             les_mean =     521.137960497786
             stat err =       0.000553015150
             autocorr =       1.286291021441
   target nu stat err =       0.000553015150
   target dn stat err =       0.003247730337
      target stat err =       0.002376670527
              std dev =       0.689576429046
             le_variance =       0.475515651496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475447327509
                                         uncertainty =       0.002107607867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475447327509
                                         uncertainty =       0.002107607867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487570822
  error estimate for blocks of size 2^( 2) =       0.000508742762
  error estimate for blocks of size 2^( 3) =       0.000528618278
  error estimate for blocks of size 2^( 4) =       0.000543679802
  error estimate for blocks of size 2^( 5) =       0.000551866776
  error estimate for blocks of size 2^( 6) =       0.000556265871
  error estimate for blocks of size 2^( 7) =       0.000560134296

      target function =      -0.713745763564
              le_mean =     -22.817698552173
             les_mean =     521.137874164982
             stat err =       0.000552986686
             autocorr =       1.286334547287
   target nu stat err =       0.000552986686
   target dn stat err =       0.003233834454
      target stat err =       0.002367584864
              std dev =       0.689529269679
             le_variance =       0.475450613745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475479711342
                                         uncertainty =       0.002108232322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475479711342
                                         uncertainty =       0.002108232322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487587400
  error estimate for blocks of size 2^( 2) =       0.000508759124
  error estimate for blocks of size 2^( 3) =       0.000528634114
  error estimate for blocks of size 2^( 4) =       0.000543694798
  error estimate for blocks of size 2^( 5) =       0.000551881216
  error estimate for blocks of size 2^( 6) =       0.000556279759
  error estimate for blocks of size 2^( 7) =       0.000560147537

      target function =      -0.713709404373
              le_mean =     -22.817698202157
             les_mean =     521.137909209127
             stat err =       0.000553000827
             autocorr =       1.286312867708
   target nu stat err =       0.000553000827
   target dn stat err =       0.003240571615
      target stat err =       0.002372016918
              std dev =       0.689552713635
             le_variance =       0.475482944881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475508363812
                                         uncertainty =       0.002108786359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475508363812
                                         uncertainty =       0.002108786359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487602067
  error estimate for blocks of size 2^( 2) =       0.000508773602
  error estimate for blocks of size 2^( 3) =       0.000528648130
  error estimate for blocks of size 2^( 4) =       0.000543708075
  error estimate for blocks of size 2^( 5) =       0.000551893999
  error estimate for blocks of size 2^( 6) =       0.000556292064
  error estimate for blocks of size 2^( 7) =       0.000560159277

      target function =      -0.713669055326
              le_mean =     -22.817697914954
             les_mean =     521.137952735234
             stat err =       0.000553013354
             autocorr =       1.286293755939
   target nu stat err =       0.000553013354
   target dn stat err =       0.003246800149
      target stat err =       0.002376070319
              std dev =       0.689573455790
             le_variance =       0.475511550930


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.713662244621        initial
     9.5367e+00     9.5367e+01             8.9335e-05        -0.713745763564  <--
     3.8147e+01     3.8147e+02             2.2379e-05        -0.713709404373
     1.5259e+02     1.5259e+03             5.5975e-06        -0.713669055326

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 4.3032e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_01                 1.410261e-01 3 1  ON 0
ci_02                -3.821666e-02 3 1  ON 1
ci_03                -3.799068e-02 3 1  ON 2
ci_04                 3.445041e-02 3 1  ON 3
ci_05                -2.762887e-02 3 1  ON 4
ci_06                -2.698650e-02 3 1  ON 5
ci_07                 2.811145e-02 3 1  ON 6
ci_08                -9.573233e-03 3 1  ON 7
ci_09                -1.178879e-02 3 1  ON 8
ci_10                -1.159733e-02 3 1  ON 9
ci_11                 1.377412e-02 3 1  ON 10
ci_12                 9.059968e-03 3 1  ON 11
ci_13                 1.259254e-02 3 1  ON 12
ci_14                 1.234979e-02 3 1  ON 13
ci_15                 8.685696e-03 3 1  ON 14
ci_16                 8.641027e-03 3 1  ON 15
ci_17                -8.857073e-03 3 1  ON 16
ci_18                -8.356854e-03 3 1  ON 17
ci_19                 9.902368e-03 3 1  ON 18
ci_20                 7.756340e-03 3 1  ON 19
ci_21                 9.091310e-03 3 1  ON 20
ci_22                 9.200173e-03 3 1  ON 21
ci_23                 5.341456e-03 3 1  ON 22
ci_24                 4.844153e-03 3 1  ON 23
ci_25                 3.596485e-03 3 1  ON 24
ci_26                 3.617447e-03 3 1  ON 25
ci_27                 3.653390e-03 3 1  ON 26
ci_28                 2.671546e-03 3 1  ON 27
ci_29                 2.656286e-03 3 1  ON 28
ci_30                -2.187004e-03 3 1  ON 29
ci_31                -2.325488e-03 3 1  ON 30
ci_32                -1.697066e-03 3 1  ON 31
ci_33                -1.678293e-03 3 1  ON 32
ci_34                 1.548541e-03 3 1  ON 33
ci_35                 1.628388e-03 3 1  ON 34
ci_36                -1.483547e-03 3 1  ON 35
ci_37                -1.520723e-03 3 1  ON 36
ci_38                -1.045202e-03 3 1  ON 37
ci_39                -1.121503e-03 3 1  ON 38
ci_40                -1.645342e-03 3 1  ON 39
ci_41                -1.282498e-03 3 1  ON 40
ci_42                -1.062250e-03 3 1  ON 41
ci_43                -2.483791e-03 3 1  ON 42
ci_44                -1.674722e-03 3 1  ON 43
ci_45                -9.492078e-04 3 1  ON 44
ci_46                -8.687901e-04 3 1  ON 45
ci_47                -8.179552e-05 3 1  ON 46
ci_48                -2.141153e-04 3 1  ON 47
ci_49                -1.180459e-03 3 1  ON 48
ci_50                -9.161894e-04 3 1  ON 49
ci_51                 7.711720e-04 3 1  ON 50
ci_52                 6.733773e-04 3 1  ON 51
ci_53                -1.031285e-03 3 1  ON 52
ci_54                -9.134715e-04 3 1  ON 53
ci_55                -6.897450e-04 3 1  ON 54
ci_56                 1.709105e-03 3 1  ON 55
ci_57                 1.715819e-03 3 1  ON 56
ci_58                -9.908864e-04 3 1  ON 57
ci_59                -8.956264e-04 3 1  ON 58
ci_60                 7.522399e-04 3 1  ON 59
ci_61                 7.798102e-04 3 1  ON 60
ci_62                -5.875624e-04 3 1  ON 61
ci_63                -7.864958e-04 3 1  ON 62
ci_64                -5.998158e-04 3 1  ON 63
ci_65                -4.385117e-04 3 1  ON 64
ci_66                -8.303522e-04 3 1  ON 65
ci_67                -6.802589e-04 3 1  ON 66
ci_68                -3.386168e-04 3 1  ON 67
ci_69                -1.736932e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3444e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.8562
    reference variance = 0.29455
====================================================
  Execution time = 2.5653e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5339e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9145e-01
  Total weights = 1.963820367e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475748461609
                                         uncertainty =       0.003112611737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475748461609
                                         uncertainty =       0.003112611737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487727323
  error estimate for blocks of size 2^( 2) =       0.000508372478
  error estimate for blocks of size 2^( 3) =       0.000527860530
  error estimate for blocks of size 2^( 4) =       0.000542149510
  error estimate for blocks of size 2^( 5) =       0.000551056991
  error estimate for blocks of size 2^( 6) =       0.000556317620
  error estimate for blocks of size 2^( 7) =       0.000560517276

      target function =      -0.713066054877
              le_mean =     -22.817298374095
             les_mean =     521.120551538108
             stat err =       0.000552510349
             autocorr =       1.283295474544
   target nu stat err =       0.000552510349
   target dn stat err =       0.003935913929
      target stat err =       0.002849062659
              std dev =       0.689750594710
             le_variance =       0.475755882903


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281729837410e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713076278514       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713148493274       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713161506061       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713163463727       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713164214768       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713164309477       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713164297281       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713164290477       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713164285573       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713164285184       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713164282177       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+00 is 3.414392e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713076278514       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713094598640       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713097881596       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713098372357       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713098559058       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713098581637       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713098578363       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713098576661       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713098575445       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713098575344       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713098574608       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+00 is 8.603448e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713076278514       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713080875503       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713081698118       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713081820889       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713081867495       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713081873071       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713081872238       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713081871813       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713081871509       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713081871484       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713081871301       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+01 is 2.155123e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.731254 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0287e+01
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_01                 1.409401e-01 3 1  ON 0
ci_02                -3.814736e-02 3 1  ON 1
ci_03                -3.792472e-02 3 1  ON 2
ci_04                 3.438178e-02 3 1  ON 3
ci_05                -2.757939e-02 3 1  ON 4
ci_06                -2.695466e-02 3 1  ON 5
ci_07                 2.810136e-02 3 1  ON 6
ci_08                -9.545635e-03 3 1  ON 7
ci_09                -1.176395e-02 3 1  ON 8
ci_10                -1.157836e-02 3 1  ON 9
ci_11                 1.377045e-02 3 1  ON 10
ci_12                 9.042743e-03 3 1  ON 11
ci_13                 1.259241e-02 3 1  ON 12
ci_14                 1.236755e-02 3 1  ON 13
ci_15                 8.671149e-03 3 1  ON 14
ci_16                 8.633043e-03 3 1  ON 15
ci_17                -8.839988e-03 3 1  ON 16
ci_18                -8.347613e-03 3 1  ON 17
ci_19                 9.895699e-03 3 1  ON 18
ci_20                 7.747299e-03 3 1  ON 19
ci_21                 9.092046e-03 3 1  ON 20
ci_22                 9.196893e-03 3 1  ON 21
ci_23                 5.333280e-03 3 1  ON 22
ci_24                 4.839911e-03 3 1  ON 23
ci_25                 3.593053e-03 3 1  ON 24
ci_26                 3.612257e-03 3 1  ON 25
ci_27                 3.647669e-03 3 1  ON 26
ci_28                 2.664951e-03 3 1  ON 27
ci_29                 2.653488e-03 3 1  ON 28
ci_30                -2.186586e-03 3 1  ON 29
ci_31                -2.324430e-03 3 1  ON 30
ci_32                -1.684525e-03 3 1  ON 31
ci_33                -1.672393e-03 3 1  ON 32
ci_34                 1.538611e-03 3 1  ON 33
ci_35                 1.624164e-03 3 1  ON 34
ci_36                -1.481353e-03 3 1  ON 35
ci_37                -1.520269e-03 3 1  ON 36
ci_38                -1.044605e-03 3 1  ON 37
ci_39                -1.120178e-03 3 1  ON 38
ci_40                -1.647000e-03 3 1  ON 39
ci_41                -1.273195e-03 3 1  ON 40
ci_42                -1.062801e-03 3 1  ON 41
ci_43                -2.473722e-03 3 1  ON 42
ci_44                -1.667653e-03 3 1  ON 43
ci_45                -9.488660e-04 3 1  ON 44
ci_46                -8.646636e-04 3 1  ON 45
ci_47                -7.362713e-05 3 1  ON 46
ci_48                -2.152348e-04 3 1  ON 47
ci_49                -1.181426e-03 3 1  ON 48
ci_50                -9.137733e-04 3 1  ON 49
ci_51                 7.685732e-04 3 1  ON 50
ci_52                 6.721914e-04 3 1  ON 51
ci_53                -1.031728e-03 3 1  ON 52
ci_54                -9.144082e-04 3 1  ON 53
ci_55                -6.810884e-04 3 1  ON 54
ci_56                 1.710262e-03 3 1  ON 55
ci_57                 1.712435e-03 3 1  ON 56
ci_58                -9.855156e-04 3 1  ON 57
ci_59                -8.929231e-04 3 1  ON 58
ci_60                 7.498393e-04 3 1  ON 59
ci_61                 7.878926e-04 3 1  ON 60
ci_62                -5.855148e-04 3 1  ON 61
ci_63                -7.806478e-04 3 1  ON 62
ci_64                -5.986349e-04 3 1  ON 63
ci_65                -4.348321e-04 3 1  ON 64
ci_66                -8.276247e-04 3 1  ON 65
ci_67                -6.773638e-04 3 1  ON 66
ci_68                -3.357733e-04 3 1  ON 67
ci_69                -1.737628e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.8707
    reference variance = 0.385739
====================================================
  Execution time = 2.6852e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9536e-01
  Total weights = 1.9638e+06
  Execution time = 3.5965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478377200034
                                         uncertainty =       0.002696050091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478377200034
                                         uncertainty =       0.002696050091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489029517
  error estimate for blocks of size 2^( 2) =       0.000510047627
  error estimate for blocks of size 2^( 3) =       0.000529496678
  error estimate for blocks of size 2^( 4) =       0.000543701080
  error estimate for blocks of size 2^( 5) =       0.000552877985
  error estimate for blocks of size 2^( 6) =       0.000559308404
  error estimate for blocks of size 2^( 7) =       0.000561811612

      target function =      -0.710232491229
              le_mean =     -22.817574602731
             les_mean =     521.137171822490
             stat err =       0.000554424770
             autocorr =       1.285331362528
   target nu stat err =       0.000554424770
   target dn stat err =       0.003552070547
      target stat err =       0.002563489920
              std dev =       0.691592174646
             le_variance =       0.478299736031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478126917438
                                         uncertainty =       0.002695599325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478126917438
                                         uncertainty =       0.002695599325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488901669
  error estimate for blocks of size 2^( 2) =       0.000509923271
  error estimate for blocks of size 2^( 3) =       0.000529378866
  error estimate for blocks of size 2^( 4) =       0.000543589239
  error estimate for blocks of size 2^( 5) =       0.000552772050
  error estimate for blocks of size 2^( 6) =       0.000559194680
  error estimate for blocks of size 2^( 7) =       0.000561697957

      target function =      -0.710424143826
              le_mean =     -22.817575608688
             les_mean =     521.136945992535
             stat err =       0.000554313482
             autocorr =       1.285487458030
   target nu stat err =       0.000554313482
   target dn stat err =       0.003542148526
      target stat err =       0.002557987347
              std dev =       0.691411370471
             le_variance =       0.478049683217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478249045104
                                         uncertainty =       0.002695804317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478249045104
                                         uncertainty =       0.002695804317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488964057
  error estimate for blocks of size 2^( 2) =       0.000509983914
  error estimate for blocks of size 2^( 3) =       0.000529436271
  error estimate for blocks of size 2^( 4) =       0.000543643646
  error estimate for blocks of size 2^( 5) =       0.000552823563
  error estimate for blocks of size 2^( 6) =       0.000559249871
  error estimate for blocks of size 2^( 7) =       0.000561753051

      target function =      -0.709341304784
              le_mean =     -22.817574983278
             les_mean =     521.138453129086
             stat err =       0.000554367533
             autocorr =       1.285410084730
   target nu stat err =       0.000554367533
   target dn stat err =       0.003827749222
      target stat err =       0.002746821248
              std dev =       0.691499601102
             le_variance =       0.478171698325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478360977116
                                         uncertainty =       0.002696016976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478360977116
                                         uncertainty =       0.002696016976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489021231
  error estimate for blocks of size 2^( 2) =       0.000510039561
  error estimate for blocks of size 2^( 3) =       0.000529489021
  error estimate for blocks of size 2^( 4) =       0.000543693799
  error estimate for blocks of size 2^( 5) =       0.000552871080
  error estimate for blocks of size 2^( 6) =       0.000559301008
  error estimate for blocks of size 2^( 7) =       0.000561804221

      target function =      -0.710252301779
              le_mean =     -22.817574626096
             les_mean =     521.137144790529
             stat err =       0.000554417527
             autocorr =       1.285341336264
   target nu stat err =       0.000554417527
   target dn stat err =       0.003551162889
      target stat err =       0.002563003261
              std dev =       0.691580456575
             le_variance =       0.478283527916


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.710232491229        initial
     2.3842e+00     2.3842e+01             3.4144e-04        -0.710424143826  <--
     9.5367e+00     9.5367e+01             8.6034e-05        -0.709341304784
     3.8147e+01     3.8147e+02             2.1551e-05        -0.710252301779

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 4.4887e+01
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_01                 1.406846e-01 3 1  ON 0
ci_02                -3.794309e-02 3 1  ON 1
ci_03                -3.773033e-02 3 1  ON 2
ci_04                 3.418004e-02 3 1  ON 3
ci_05                -2.743371e-02 3 1  ON 4
ci_06                -2.686105e-02 3 1  ON 5
ci_07                 2.807159e-02 3 1  ON 6
ci_08                -9.464399e-03 3 1  ON 7
ci_09                -1.169060e-02 3 1  ON 8
ci_10                -1.152232e-02 3 1  ON 9
ci_11                 1.375968e-02 3 1  ON 10
ci_12                 8.992027e-03 3 1  ON 11
ci_13                 1.259203e-02 3 1  ON 12
ci_14                 1.242042e-02 3 1  ON 13
ci_15                 8.628276e-03 3 1  ON 14
ci_16                 8.609508e-03 3 1  ON 15
ci_17                -8.789536e-03 3 1  ON 16
ci_18                -8.320319e-03 3 1  ON 17
ci_19                 9.876143e-03 3 1  ON 18
ci_20                 7.720697e-03 3 1  ON 19
ci_21                 9.094249e-03 3 1  ON 20
ci_22                 9.187158e-03 3 1  ON 21
ci_23                 5.309268e-03 3 1  ON 22
ci_24                 4.827366e-03 3 1  ON 23
ci_25                 3.582974e-03 3 1  ON 24
ci_26                 3.597004e-03 3 1  ON 25
ci_27                 3.630855e-03 3 1  ON 26
ci_28                 2.645431e-03 3 1  ON 27
ci_29                 2.645186e-03 3 1  ON 28
ci_30                -2.185355e-03 3 1  ON 29
ci_31                -2.321209e-03 3 1  ON 30
ci_32                -1.647739e-03 3 1  ON 31
ci_33                -1.655110e-03 3 1  ON 32
ci_34                 1.509406e-03 3 1  ON 33
ci_35                 1.611805e-03 3 1  ON 34
ci_36                -1.474877e-03 3 1  ON 35
ci_37                -1.518914e-03 3 1  ON 36
ci_38                -1.042834e-03 3 1  ON 37
ci_39                -1.116258e-03 3 1  ON 38
ci_40                -1.651847e-03 3 1  ON 39
ci_41                -1.245900e-03 3 1  ON 40
ci_42                -1.064494e-03 3 1  ON 41
ci_43                -2.443958e-03 3 1  ON 42
ci_44                -1.646759e-03 3 1  ON 43
ci_45                -9.478411e-04 3 1  ON 44
ci_46                -8.525093e-04 3 1  ON 45
ci_47                -4.941006e-05 3 1  ON 46
ci_48                -2.185250e-04 3 1  ON 47
ci_49                -1.184262e-03 3 1  ON 48
ci_50                -9.066791e-04 3 1  ON 49
ci_51                 7.609198e-04 3 1  ON 50
ci_52                 6.686901e-04 3 1  ON 51
ci_53                -1.033014e-03 3 1  ON 52
ci_54                -9.172016e-04 3 1  ON 53
ci_55                -6.555931e-04 3 1  ON 54
ci_56                 1.713681e-03 3 1  ON 55
ci_57                 1.702504e-03 3 1  ON 56
ci_58                -9.697102e-04 3 1  ON 57
ci_59                -8.849837e-04 3 1  ON 58
ci_60                 7.427336e-04 3 1  ON 59
ci_61                 8.119403e-04 3 1  ON 60
ci_62                -5.794919e-04 3 1  ON 61
ci_63                -7.634613e-04 3 1  ON 62
ci_64                -5.951550e-04 3 1  ON 63
ci_65                -4.240095e-04 3 1  ON 64
ci_66                -8.195842e-04 3 1  ON 65
ci_67                -6.688380e-04 3 1  ON 66
ci_68                -3.274015e-04 3 1  ON 67
ci_69                -1.739933e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5180e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.8214
    reference variance = 0.29567
====================================================
  Execution time = 2.5711e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8894e-01
  Total weights = 1.963656691e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473303708851
                                         uncertainty =       0.002061509032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473303708851
                                         uncertainty =       0.002061509032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486450255
  error estimate for blocks of size 2^( 2) =       0.000508263126
  error estimate for blocks of size 2^( 3) =       0.000528662664
  error estimate for blocks of size 2^( 4) =       0.000543342240
  error estimate for blocks of size 2^( 5) =       0.000552303259
  error estimate for blocks of size 2^( 6) =       0.000558922683
  error estimate for blocks of size 2^( 7) =       0.000562812834

      target function =      -0.714867348965
              le_mean =     -22.817829438747
             les_mean =     521.142278271320
             stat err =       0.000554345254
             autocorr =       1.298625110269
   target nu stat err =       0.000554345254
   target dn stat err =       0.003284334906
      target stat err =       0.002410676198
              std dev =       0.687944548475
             le_variance =       0.473267701776


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281782943875e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714874668881       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.715110039173       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.715152858990       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.715160622081       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.715163463564       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.715164011344       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.715164384270       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.715164388925       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.715164370952       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.715164367939       residual = 7.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-01 is 1.385968e-03

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714874668881       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714936953729       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714948058689       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714950023012       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714950716372       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714950839299       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714950927163       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714950927782       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714950923465       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714950922739       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+00 is 3.575208e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714874668881       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714890471095       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714893273227       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714893765614       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714893937717       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714893967538       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714893989152       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714893989273       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714893988206       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714893988027       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+00 is 9.009906e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.734780 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0324e+01
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_01                 1.403271e-01 3 1  ON 0
ci_02                -3.769906e-02 3 1  ON 1
ci_03                -3.750165e-02 3 1  ON 2
ci_04                 3.392065e-02 3 1  ON 3
ci_05                -2.725935e-02 3 1  ON 4
ci_06                -2.672015e-02 3 1  ON 5
ci_07                 2.806683e-02 3 1  ON 6
ci_08                -9.357916e-03 3 1  ON 7
ci_09                -1.161020e-02 3 1  ON 8
ci_10                -1.144317e-02 3 1  ON 9
ci_11                 1.371400e-02 3 1  ON 10
ci_12                 8.953810e-03 3 1  ON 11
ci_13                 1.257237e-02 3 1  ON 12
ci_14                 1.242101e-02 3 1  ON 13
ci_15                 8.597337e-03 3 1  ON 14
ci_16                 8.567431e-03 3 1  ON 15
ci_17                -8.745030e-03 3 1  ON 16
ci_18                -8.299345e-03 3 1  ON 17
ci_19                 9.861234e-03 3 1  ON 18
ci_20                 7.696189e-03 3 1  ON 19
ci_21                 9.101940e-03 3 1  ON 20
ci_22                 9.161895e-03 3 1  ON 21
ci_23                 5.283927e-03 3 1  ON 22
ci_24                 4.832261e-03 3 1  ON 23
ci_25                 3.574682e-03 3 1  ON 24
ci_26                 3.580128e-03 3 1  ON 25
ci_27                 3.609507e-03 3 1  ON 26
ci_28                 2.622137e-03 3 1  ON 27
ci_29                 2.627056e-03 3 1  ON 28
ci_30                -2.182118e-03 3 1  ON 29
ci_31                -2.310437e-03 3 1  ON 30
ci_32                -1.621794e-03 3 1  ON 31
ci_33                -1.630197e-03 3 1  ON 32
ci_34                 1.471345e-03 3 1  ON 33
ci_35                 1.571784e-03 3 1  ON 34
ci_36                -1.454512e-03 3 1  ON 35
ci_37                -1.509858e-03 3 1  ON 36
ci_38                -1.024760e-03 3 1  ON 37
ci_39                -1.102716e-03 3 1  ON 38
ci_40                -1.647539e-03 3 1  ON 39
ci_41                -1.228850e-03 3 1  ON 40
ci_42                -1.037171e-03 3 1  ON 41
ci_43                -2.430623e-03 3 1  ON 42
ci_44                -1.641094e-03 3 1  ON 43
ci_45                -9.265987e-04 3 1  ON 44
ci_46                -8.386846e-04 3 1  ON 45
ci_47                -3.802080e-05 3 1  ON 46
ci_48                -2.054626e-04 3 1  ON 47
ci_49                -1.182282e-03 3 1  ON 48
ci_50                -8.973442e-04 3 1  ON 49
ci_51                 7.585244e-04 3 1  ON 50
ci_52                 6.579422e-04 3 1  ON 51
ci_53                -1.022520e-03 3 1  ON 52
ci_54                -9.074251e-04 3 1  ON 53
ci_55                -6.510028e-04 3 1  ON 54
ci_56                 1.702205e-03 3 1  ON 55
ci_57                 1.705236e-03 3 1  ON 56
ci_58                -9.758000e-04 3 1  ON 57
ci_59                -8.863965e-04 3 1  ON 58
ci_60                 7.429988e-04 3 1  ON 59
ci_61                 8.204322e-04 3 1  ON 60
ci_62                -5.677091e-04 3 1  ON 61
ci_63                -7.500721e-04 3 1  ON 62
ci_64                -5.941247e-04 3 1  ON 63
ci_65                -4.203414e-04 3 1  ON 64
ci_66                -8.175023e-04 3 1  ON 65
ci_67                -6.785292e-04 3 1  ON 66
ci_68                -3.310212e-04 3 1  ON 67
ci_69                -1.930414e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.7341
    reference variance = 0.25683
====================================================
  Execution time = 2.5209e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8563e-01
  Total weights = 1.9638e+06
  Execution time = 3.5789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471243426495
                                         uncertainty =       0.002299319578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471243426495
                                         uncertainty =       0.002299319578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485399317
  error estimate for blocks of size 2^( 2) =       0.000506171675
  error estimate for blocks of size 2^( 3) =       0.000526006618
  error estimate for blocks of size 2^( 4) =       0.000541667149
  error estimate for blocks of size 2^( 5) =       0.000552256802
  error estimate for blocks of size 2^( 6) =       0.000557380168
  error estimate for blocks of size 2^( 7) =       0.000560627066

      target function =      -0.717103829251
              le_mean =     -22.818887987556
             les_mean =     521.187505897519
             stat err =       0.000552982796
             autocorr =       1.297851246547
   target nu stat err =       0.000552982796
   target dn stat err =       0.002835224416
      target stat err =       0.002115199318
              std dev =       0.686458297084
             le_variance =       0.471224993635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470588045427
                                         uncertainty =       0.002318779547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470588045427
                                         uncertainty =       0.002318779547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485061244
  error estimate for blocks of size 2^( 2) =       0.000505843025
  error estimate for blocks of size 2^( 3) =       0.000525692482
  error estimate for blocks of size 2^( 4) =       0.000541358661
  error estimate for blocks of size 2^( 5) =       0.000551941613
  error estimate for blocks of size 2^( 6) =       0.000557097751
  error estimate for blocks of size 2^( 7) =       0.000560383934

      target function =      -0.717123915678
              le_mean =     -22.818892675639
             les_mean =     521.187691805856
             stat err =       0.000552695490
             autocorr =       1.298310857135
   target nu stat err =       0.000552695490
   target dn stat err =       0.002889118150
      target stat err =       0.002152718008
              std dev =       0.685980189622
             le_variance =       0.470568820554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470883701653
                                         uncertainty =       0.002309290572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470883701653
                                         uncertainty =       0.002309290572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485213797
  error estimate for blocks of size 2^( 2) =       0.000505990748
  error estimate for blocks of size 2^( 3) =       0.000525832673
  error estimate for blocks of size 2^( 4) =       0.000541495810
  error estimate for blocks of size 2^( 5) =       0.000552082460
  error estimate for blocks of size 2^( 6) =       0.000557224329
  error estimate for blocks of size 2^( 7) =       0.000560492063

      target function =      -0.715904603719
              le_mean =     -22.818887935844
             les_mean =     521.189168593643
             stat err =       0.000552823666
             autocorr =       1.298096470600
   target nu stat err =       0.000552823666
   target dn stat err =       0.003409542283
      target stat err =       0.002508261511
              std dev =       0.686195932785
             le_variance =       0.470864858171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471196092502
                                         uncertainty =       0.002300550021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471196092502
                                         uncertainty =       0.002300550021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485374911
  error estimate for blocks of size 2^( 2) =       0.000506147809
  error estimate for blocks of size 2^( 3) =       0.000525983618
  error estimate for blocks of size 2^( 4) =       0.000541644465
  error estimate for blocks of size 2^( 5) =       0.000552233759
  error estimate for blocks of size 2^( 6) =       0.000557359466
  error estimate for blocks of size 2^( 7) =       0.000560609022

      target function =      -0.717150865166
              le_mean =     -22.818887727033
             les_mean =     521.187428665116
             stat err =       0.000552961678
             autocorr =       1.297882632785
   target nu stat err =       0.000552961678
   target dn stat err =       0.002835188312
      target stat err =       0.002115435832
              std dev =       0.686423781974
             le_variance =       0.471177608459


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.717103829251        initial
     5.9605e-01     5.9605e+00             1.3860e-03        -0.717123915678
     2.3842e+00     2.3842e+01             3.5752e-04        -0.715904603719
     9.5367e+00     9.5367e+01             9.0099e-05        -0.717150865166  <--

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 4.3131e+01
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_01                 1.405945e-01 3 1  ON 0
ci_02                -3.788127e-02 3 1  ON 1
ci_03                -3.767238e-02 3 1  ON 2
ci_04                 3.411419e-02 3 1  ON 3
ci_05                -2.738950e-02 3 1  ON 4
ci_06                -2.682530e-02 3 1  ON 5
ci_07                 2.807037e-02 3 1  ON 6
ci_08                -9.437392e-03 3 1  ON 7
ci_09                -1.167027e-02 3 1  ON 8
ci_10                -1.150228e-02 3 1  ON 9
ci_11                 1.374812e-02 3 1  ON 10
ci_12                 8.982330e-03 3 1  ON 11
ci_13                 1.258706e-02 3 1  ON 12
ci_14                 1.242056e-02 3 1  ON 13
ci_15                 8.620435e-03 3 1  ON 14
ci_16                 8.598859e-03 3 1  ON 15
ci_17                -8.778279e-03 3 1  ON 16
ci_18                -8.315015e-03 3 1  ON 17
ci_19                 9.872351e-03 3 1  ON 18
ci_20                 7.714478e-03 3 1  ON 19
ci_21                 9.096197e-03 3 1  ON 20
ci_22                 9.180774e-03 3 1  ON 21
ci_23                 5.302830e-03 3 1  ON 22
ci_24                 4.828589e-03 3 1  ON 23
ci_25                 3.580868e-03 3 1  ON 24
ci_26                 3.592741e-03 3 1  ON 25
ci_27                 3.625436e-03 3 1  ON 26
ci_28                 2.639542e-03 3 1  ON 27
ci_29                 2.640612e-03 3 1  ON 28
ci_30                -2.184530e-03 3 1  ON 29
ci_31                -2.318489e-03 3 1  ON 30
ci_32                -1.641142e-03 3 1  ON 31
ci_33                -1.648768e-03 3 1  ON 32
ci_34                 1.499750e-03 3 1  ON 33
ci_35                 1.601644e-03 3 1  ON 34
ci_36                -1.469709e-03 3 1  ON 35
ci_37                -1.516619e-03 3 1  ON 36
ci_38                -1.038249e-03 3 1  ON 37
ci_39                -1.112824e-03 3 1  ON 38
ci_40                -1.650757e-03 3 1  ON 39
ci_41                -1.241562e-03 3 1  ON 40
ci_42                -1.057545e-03 3 1  ON 41
ci_43                -2.440604e-03 3 1  ON 42
ci_44                -1.645342e-03 3 1  ON 43
ci_45                -9.424563e-04 3 1  ON 44
ci_46                -8.490059e-04 3 1  ON 45
ci_47                -4.654851e-05 3 1  ON 46
ci_48                -2.152320e-04 3 1  ON 47
ci_49                -1.183766e-03 3 1  ON 48
ci_50                -9.043072e-04 3 1  ON 49
ci_51                 7.603202e-04 3 1  ON 50
ci_52                 6.659653e-04 3 1  ON 51
ci_53                -1.030350e-03 3 1  ON 52
ci_54                -9.147247e-04 3 1  ON 53
ci_55                -6.544303e-04 3 1  ON 54
ci_56                 1.710765e-03 3 1  ON 55
ci_57                 1.703195e-03 3 1  ON 56
ci_58                -9.712555e-04 3 1  ON 57
ci_59                -8.853405e-04 3 1  ON 58
ci_60                 7.427960e-04 3 1  ON 59
ci_61                 8.140742e-04 3 1  ON 60
ci_62                -5.765060e-04 3 1  ON 61
ci_63                -7.600621e-04 3 1  ON 62
ci_64                -5.948978e-04 3 1  ON 63
ci_65                -4.230800e-04 3 1  ON 64
ci_66                -8.190583e-04 3 1  ON 65
ci_67                -6.712983e-04 3 1  ON 66
ci_68                -3.283205e-04 3 1  ON 67
ci_69                -1.788233e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3460e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.7763
    reference variance = 0.302364
====================================================
  Execution time = 2.5641e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9404e-01
  Total weights = 1.963376697e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478525065758
                                         uncertainty =       0.003052403218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478525065758
                                         uncertainty =       0.003052403218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489126711
  error estimate for blocks of size 2^( 2) =       0.000510054575
  error estimate for blocks of size 2^( 3) =       0.000529376821
  error estimate for blocks of size 2^( 4) =       0.000545076503
  error estimate for blocks of size 2^( 5) =       0.000555313690
  error estimate for blocks of size 2^( 6) =       0.000560501390
  error estimate for blocks of size 2^( 7) =       0.000561819220

      target function =      -0.711231231022
              le_mean =     -22.817186167434
             les_mean =     521.118020604555
             stat err =       0.000555677701
             autocorr =       1.290634225512
   target nu stat err =       0.000555677701
   target dn stat err =       0.003581687866
      target stat err =       0.002589850552
              std dev =       0.691729628333
             le_variance =       0.478489878713


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281718616743e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711239738302       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711316231900       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711328014316       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711330088767       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711330811631       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711330951681       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711330951129       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711330952484       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711330954571       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711330954763       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+00 is 3.512725e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711239738302       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711259144053       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711262117816       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711262637693       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711262817109       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711262851362       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711262851088       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711262851422       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711262851930       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711262851976       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+00 is 8.853746e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711239738302       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711244607711       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711245352928       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711245482973       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711245527743       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711245536258       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711245536181       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711245536264       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711245536390       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711245536402       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+01 is 2.217982e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.738318 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0213e+01
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_01                 1.405060e-01 3 1  ON 0
ci_02                -3.781384e-02 3 1  ON 1
ci_03                -3.759737e-02 3 1  ON 2
ci_04                 3.404376e-02 3 1  ON 3
ci_05                -2.735234e-02 3 1  ON 4
ci_06                -2.678487e-02 3 1  ON 5
ci_07                 2.807096e-02 3 1  ON 6
ci_08                -9.407807e-03 3 1  ON 7
ci_09                -1.164793e-02 3 1  ON 8
ci_10                -1.148294e-02 3 1  ON 9
ci_11                 1.374239e-02 3 1  ON 10
ci_12                 8.962935e-03 3 1  ON 11
ci_13                 1.258890e-02 3 1  ON 12
ci_14                 1.241988e-02 3 1  ON 13
ci_15                 8.603258e-03 3 1  ON 14
ci_16                 8.590737e-03 3 1  ON 15
ci_17                -8.767449e-03 3 1  ON 16
ci_18                -8.308758e-03 3 1  ON 17
ci_19                 9.869772e-03 3 1  ON 18
ci_20                 7.691157e-03 3 1  ON 19
ci_21                 9.099082e-03 3 1  ON 20
ci_22                 9.174109e-03 3 1  ON 21
ci_23                 5.300174e-03 3 1  ON 22
ci_24                 4.828149e-03 3 1  ON 23
ci_25                 3.576835e-03 3 1  ON 24
ci_26                 3.586031e-03 3 1  ON 25
ci_27                 3.620348e-03 3 1  ON 26
ci_28                 2.637708e-03 3 1  ON 27
ci_29                 2.634801e-03 3 1  ON 28
ci_30                -2.180193e-03 3 1  ON 29
ci_31                -2.317565e-03 3 1  ON 30
ci_32                -1.641301e-03 3 1  ON 31
ci_33                -1.638107e-03 3 1  ON 32
ci_34                 1.505058e-03 3 1  ON 33
ci_35                 1.602307e-03 3 1  ON 34
ci_36                -1.465825e-03 3 1  ON 35
ci_37                -1.513980e-03 3 1  ON 36
ci_38                -1.040226e-03 3 1  ON 37
ci_39                -1.105733e-03 3 1  ON 38
ci_40                -1.650900e-03 3 1  ON 39
ci_41                -1.236253e-03 3 1  ON 40
ci_42                -1.052072e-03 3 1  ON 41
ci_43                -2.435183e-03 3 1  ON 42
ci_44                -1.648384e-03 3 1  ON 43
ci_45                -9.370244e-04 3 1  ON 44
ci_46                -8.509005e-04 3 1  ON 45
ci_47                -4.036962e-05 3 1  ON 46
ci_48                -2.100556e-04 3 1  ON 47
ci_49                -1.186486e-03 3 1  ON 48
ci_50                -9.055552e-04 3 1  ON 49
ci_51                 7.601467e-04 3 1  ON 50
ci_52                 6.645403e-04 3 1  ON 51
ci_53                -1.028879e-03 3 1  ON 52
ci_54                -9.096487e-04 3 1  ON 53
ci_55                -6.565698e-04 3 1  ON 54
ci_56                 1.714754e-03 3 1  ON 55
ci_57                 1.711860e-03 3 1  ON 56
ci_58                -9.774720e-04 3 1  ON 57
ci_59                -8.762357e-04 3 1  ON 58
ci_60                 7.444053e-04 3 1  ON 59
ci_61                 8.069412e-04 3 1  ON 60
ci_62                -5.735193e-04 3 1  ON 61
ci_63                -7.593665e-04 3 1  ON 62
ci_64                -6.004651e-04 3 1  ON 63
ci_65                -4.439708e-04 3 1  ON 64
ci_66                -8.217509e-04 3 1  ON 65
ci_67                -6.681851e-04 3 1  ON 66
ci_68                -3.325086e-04 3 1  ON 67
ci_69                -1.844685e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.7328
    reference variance = 0.425211
====================================================
  Execution time = 2.5019e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 5.1289e-01
  Total weights = 1.9636e+06
  Execution time = 3.5785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489765696007
                                         uncertainty =       0.010616855053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489765696007
                                         uncertainty =       0.010616855053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494849802
  error estimate for blocks of size 2^( 2) =       0.000514815099
  error estimate for blocks of size 2^( 3) =       0.000534234154
  error estimate for blocks of size 2^( 4) =       0.000549410159
  error estimate for blocks of size 2^( 5) =       0.000558444569
  error estimate for blocks of size 2^( 6) =       0.000561092381
  error estimate for blocks of size 2^( 7) =       0.000563605544

      target function =      -0.698613793684
              le_mean =     -22.817880184860
             les_mean =     521.167590490354
             stat err =       0.000558138163
             autocorr =       1.272145062161
   target nu stat err =       0.000558138163
   target dn stat err =       0.017488890044
      target stat err =       0.011948187518
              std dev =       0.699823300880
             le_variance =       0.489752652454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492731915207
                                         uncertainty =       0.013716333164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492731915207
                                         uncertainty =       0.013716333164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496346934
  error estimate for blocks of size 2^( 2) =       0.000516248435
  error estimate for blocks of size 2^( 3) =       0.000535602314
  error estimate for blocks of size 2^( 4) =       0.000550748964
  error estimate for blocks of size 2^( 5) =       0.000559741207
  error estimate for blocks of size 2^( 6) =       0.000562389787
  error estimate for blocks of size 2^( 7) =       0.000564906714

      target function =      -0.674577951927
              le_mean =     -22.817872995154
             les_mean =     521.202679009421
             stat err =       0.000559446668
             autocorr =       1.270418166365
   target nu stat err =       0.000559446668
   target dn stat err =       0.038066476821
      target stat err =       0.024252234026
              std dev =       0.701940566260
             le_variance =       0.492720558561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491105740166
                                         uncertainty =       0.012026838858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491105740166
                                         uncertainty =       0.012026838858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495526724
  error estimate for blocks of size 2^( 2) =       0.000515463257
  error estimate for blocks of size 2^( 3) =       0.000534852948
  error estimate for blocks of size 2^( 4) =       0.000550016559
  error estimate for blocks of size 2^( 5) =       0.000559031858
  error estimate for blocks of size 2^( 6) =       0.000561678980
  error estimate for blocks of size 2^( 7) =       0.000564194755

      target function =      -0.697122195134
              le_mean =     -22.817876101487
             les_mean =     521.169511618693
             stat err =       0.000558730538
             autocorr =       1.271366180921
   target nu stat err =       0.000558730538
   target dn stat err =       0.019811630465
      target stat err =       0.013475301734
              std dev =       0.700780614012
             le_variance =       0.491093468975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489918288078
                                         uncertainty =       0.010778338018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489918288078
                                         uncertainty =       0.010778338018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494926931
  error estimate for blocks of size 2^( 2) =       0.000514888929
  error estimate for blocks of size 2^( 3) =       0.000534304617
  error estimate for blocks of size 2^( 4) =       0.000549479233
  error estimate for blocks of size 2^( 5) =       0.000558511401
  error estimate for blocks of size 2^( 6) =       0.000561159142
  error estimate for blocks of size 2^( 7) =       0.000563672662

      target function =      -0.698467874416
              le_mean =     -22.817879675177
             les_mean =     521.167772090589
             stat err =       0.000558205609
             autocorr =       1.272055971691
   target nu stat err =       0.000558205609
   target dn stat err =       0.017755089333
      target stat err =       0.012124715026
              std dev =       0.699932377713
             le_variance =       0.489905333370


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.698613793684        initial  <--
     2.3842e+00     2.3842e+01             3.5127e-04        -0.674577951927
     9.5367e+00     9.5367e+01             8.8537e-05        -0.697122195134
     3.8147e+01     3.8147e+02             2.2180e-05        -0.698467874416

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0465
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_01                 1.405945e-01 3 1  ON 0
ci_02                -3.788127e-02 3 1  ON 1
ci_03                -3.767238e-02 3 1  ON 2
ci_04                 3.411419e-02 3 1  ON 3
ci_05                -2.738950e-02 3 1  ON 4
ci_06                -2.682530e-02 3 1  ON 5
ci_07                 2.807037e-02 3 1  ON 6
ci_08                -9.437392e-03 3 1  ON 7
ci_09                -1.167027e-02 3 1  ON 8
ci_10                -1.150228e-02 3 1  ON 9
ci_11                 1.374812e-02 3 1  ON 10
ci_12                 8.982330e-03 3 1  ON 11
ci_13                 1.258706e-02 3 1  ON 12
ci_14                 1.242056e-02 3 1  ON 13
ci_15                 8.620435e-03 3 1  ON 14
ci_16                 8.598859e-03 3 1  ON 15
ci_17                -8.778279e-03 3 1  ON 16
ci_18                -8.315015e-03 3 1  ON 17
ci_19                 9.872351e-03 3 1  ON 18
ci_20                 7.714478e-03 3 1  ON 19
ci_21                 9.096197e-03 3 1  ON 20
ci_22                 9.180774e-03 3 1  ON 21
ci_23                 5.302830e-03 3 1  ON 22
ci_24                 4.828589e-03 3 1  ON 23
ci_25                 3.580868e-03 3 1  ON 24
ci_26                 3.592741e-03 3 1  ON 25
ci_27                 3.625436e-03 3 1  ON 26
ci_28                 2.639542e-03 3 1  ON 27
ci_29                 2.640612e-03 3 1  ON 28
ci_30                -2.184530e-03 3 1  ON 29
ci_31                -2.318489e-03 3 1  ON 30
ci_32                -1.641142e-03 3 1  ON 31
ci_33                -1.648768e-03 3 1  ON 32
ci_34                 1.499750e-03 3 1  ON 33
ci_35                 1.601644e-03 3 1  ON 34
ci_36                -1.469709e-03 3 1  ON 35
ci_37                -1.516619e-03 3 1  ON 36
ci_38                -1.038249e-03 3 1  ON 37
ci_39                -1.112824e-03 3 1  ON 38
ci_40                -1.650757e-03 3 1  ON 39
ci_41                -1.241562e-03 3 1  ON 40
ci_42                -1.057545e-03 3 1  ON 41
ci_43                -2.440604e-03 3 1  ON 42
ci_44                -1.645342e-03 3 1  ON 43
ci_45                -9.424563e-04 3 1  ON 44
ci_46                -8.490059e-04 3 1  ON 45
ci_47                -4.654851e-05 3 1  ON 46
ci_48                -2.152320e-04 3 1  ON 47
ci_49                -1.183766e-03 3 1  ON 48
ci_50                -9.043072e-04 3 1  ON 49
ci_51                 7.603202e-04 3 1  ON 50
ci_52                 6.659653e-04 3 1  ON 51
ci_53                -1.030350e-03 3 1  ON 52
ci_54                -9.147247e-04 3 1  ON 53
ci_55                -6.544303e-04 3 1  ON 54
ci_56                 1.710765e-03 3 1  ON 55
ci_57                 1.703195e-03 3 1  ON 56
ci_58                -9.712555e-04 3 1  ON 57
ci_59                -8.853405e-04 3 1  ON 58
ci_60                 7.427960e-04 3 1  ON 59
ci_61                 8.140742e-04 3 1  ON 60
ci_62                -5.765060e-04 3 1  ON 61
ci_63                -7.600621e-04 3 1  ON 62
ci_64                -5.948978e-04 3 1  ON 63
ci_65                -4.230800e-04 3 1  ON 64
ci_66                -8.190583e-04 3 1  ON 65
ci_67                -6.712983e-04 3 1  ON 66
ci_68                -3.283205e-04 3 1  ON 67
ci_69                -1.788233e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3265e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.8154
    reference variance = 0.438906
====================================================
  Execution time = 2.5684e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9208e-01
  Total weights = 1.963731640e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476157789089
                                         uncertainty =       0.002927048596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476157789089
                                         uncertainty =       0.002927048596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487986605
  error estimate for blocks of size 2^( 2) =       0.000508847755
  error estimate for blocks of size 2^( 3) =       0.000528632181
  error estimate for blocks of size 2^( 4) =       0.000543645816
  error estimate for blocks of size 2^( 5) =       0.000552295324
  error estimate for blocks of size 2^( 6) =       0.000557269705
  error estimate for blocks of size 2^( 7) =       0.000559396514

      target function =      -0.712614834541
              le_mean =     -22.817195990462
             les_mean =     521.116509192635
             stat err =       0.000553151840
             autocorr =       1.284910621825
   target nu stat err =       0.000553151840
   target dn stat err =       0.004234599111
      target stat err =       0.003053359421
              std dev =       0.690117275750
             le_variance =       0.476261854289


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281719599046e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712627108440       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712633165054       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712634080579       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712634307634       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712634354444       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712634378702       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712634380465       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712634380238       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712634379910       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712634380003       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 3.319067e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712627108440       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712628624796       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712628853892       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712628910677       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712628922369       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712628928425       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712628928862       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712628928805       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712628928723       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712628928746       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 8.304387e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712627108440       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712627487667       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712627544954       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712627559152       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712627562075       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712627563588       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712627563697       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712627563682       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712627563661       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712627563668       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 2.076517e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.741899 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0278e+01
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_01                 1.405862e-01 3 1  ON 0
ci_02                -3.787544e-02 3 1  ON 1
ci_03                -3.766572e-02 3 1  ON 2
ci_04                 3.410783e-02 3 1  ON 3
ci_05                -2.738498e-02 3 1  ON 4
ci_06                -2.682141e-02 3 1  ON 5
ci_07                 2.806986e-02 3 1  ON 6
ci_08                -9.435131e-03 3 1  ON 7
ci_09                -1.166883e-02 3 1  ON 8
ci_10                -1.150130e-02 3 1  ON 9
ci_11                 1.374718e-02 3 1  ON 10
ci_12                 8.980957e-03 3 1  ON 11
ci_13                 1.258735e-02 3 1  ON 12
ci_14                 1.242151e-02 3 1  ON 13
ci_15                 8.618906e-03 3 1  ON 14
ci_16                 8.597579e-03 3 1  ON 15
ci_17                -8.777229e-03 3 1  ON 16
ci_18                -8.314410e-03 3 1  ON 17
ci_19                 9.872055e-03 3 1  ON 18
ci_20                 7.713358e-03 3 1  ON 19
ci_21                 9.096533e-03 3 1  ON 20
ci_22                 9.180647e-03 3 1  ON 21
ci_23                 5.302541e-03 3 1  ON 22
ci_24                 4.827653e-03 3 1  ON 23
ci_25                 3.580521e-03 3 1  ON 24
ci_26                 3.593294e-03 3 1  ON 25
ci_27                 3.624581e-03 3 1  ON 26
ci_28                 2.639478e-03 3 1  ON 27
ci_29                 2.639143e-03 3 1  ON 28
ci_30                -2.184464e-03 3 1  ON 29
ci_31                -2.318479e-03 3 1  ON 30
ci_32                -1.641559e-03 3 1  ON 31
ci_33                -1.648524e-03 3 1  ON 32
ci_34                 1.499136e-03 3 1  ON 33
ci_35                 1.600788e-03 3 1  ON 34
ci_36                -1.469387e-03 3 1  ON 35
ci_37                -1.516248e-03 3 1  ON 36
ci_38                -1.038318e-03 3 1  ON 37
ci_39                -1.112670e-03 3 1  ON 38
ci_40                -1.650696e-03 3 1  ON 39
ci_41                -1.241261e-03 3 1  ON 40
ci_42                -1.057142e-03 3 1  ON 41
ci_43                -2.439788e-03 3 1  ON 42
ci_44                -1.645225e-03 3 1  ON 43
ci_45                -9.421231e-04 3 1  ON 44
ci_46                -8.486667e-04 3 1  ON 45
ci_47                -4.613381e-05 3 1  ON 46
ci_48                -2.148915e-04 3 1  ON 47
ci_49                -1.183935e-03 3 1  ON 48
ci_50                -9.041108e-04 3 1  ON 49
ci_51                 7.597376e-04 3 1  ON 50
ci_52                 6.655509e-04 3 1  ON 51
ci_53                -1.030036e-03 3 1  ON 52
ci_54                -9.150269e-04 3 1  ON 53
ci_55                -6.545839e-04 3 1  ON 54
ci_56                 1.710808e-03 3 1  ON 55
ci_57                 1.703270e-03 3 1  ON 56
ci_58                -9.705391e-04 3 1  ON 57
ci_59                -8.861781e-04 3 1  ON 58
ci_60                 7.418829e-04 3 1  ON 59
ci_61                 8.144466e-04 3 1  ON 60
ci_62                -5.764778e-04 3 1  ON 61
ci_63                -7.598896e-04 3 1  ON 62
ci_64                -5.946979e-04 3 1  ON 63
ci_65                -4.231245e-04 3 1  ON 64
ci_66                -8.185300e-04 3 1  ON 65
ci_67                -6.717637e-04 3 1  ON 66
ci_68                -3.284952e-04 3 1  ON 67
ci_69                -1.787778e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.8751
    reference variance = 0.551445
====================================================
  Execution time = 2.5032e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8980e-01
  Total weights = 1.9636e+06
  Execution time = 3.5860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474126581777
                                         uncertainty =       0.001912203714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474126581777
                                         uncertainty =       0.001912203714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486943726
  error estimate for blocks of size 2^( 2) =       0.000507702171
  error estimate for blocks of size 2^( 3) =       0.000527832617
  error estimate for blocks of size 2^( 4) =       0.000542678264
  error estimate for blocks of size 2^( 5) =       0.000552033664
  error estimate for blocks of size 2^( 6) =       0.000557678038
  error estimate for blocks of size 2^( 7) =       0.000559481100

      target function =      -0.714253486109
              le_mean =     -22.818050948796
             les_mean =     521.153256988163
             stat err =       0.000552967767
             autocorr =       1.289561573663
   target nu stat err =       0.000552967767
   target dn stat err =       0.002766642824
      target stat err =       0.002049380246
              std dev =       0.688642421250
             le_variance =       0.474228384345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474107976248
                                         uncertainty =       0.001912443932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474107976248
                                         uncertainty =       0.001912443932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486934181
  error estimate for blocks of size 2^( 2) =       0.000507692880
  error estimate for blocks of size 2^( 3) =       0.000527823802
  error estimate for blocks of size 2^( 4) =       0.000542670327
  error estimate for blocks of size 2^( 5) =       0.000552026114
  error estimate for blocks of size 2^( 6) =       0.000557671173
  error estimate for blocks of size 2^( 7) =       0.000559473489

      target function =      -0.714264958151
              le_mean =     -22.818051190830
             les_mean =     521.153251950589
             stat err =       0.000552960276
             autocorr =       1.289577192078
   target nu stat err =       0.000552960276
   target dn stat err =       0.002768119976
      target stat err =       0.002050457175
              std dev =       0.688628922729
             le_variance =       0.474209793219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474117255681
                                         uncertainty =       0.001912323582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474117255681
                                         uncertainty =       0.001912323582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486938941
  error estimate for blocks of size 2^( 2) =       0.000507697514
  error estimate for blocks of size 2^( 3) =       0.000527828198
  error estimate for blocks of size 2^( 4) =       0.000542674285
  error estimate for blocks of size 2^( 5) =       0.000552029878
  error estimate for blocks of size 2^( 6) =       0.000557674595
  error estimate for blocks of size 2^( 7) =       0.000559477283

      target function =      -0.714260706797
              le_mean =     -22.818051068273
             les_mean =     521.153252317743
             stat err =       0.000552964010
             autocorr =       1.289569394853
   target nu stat err =       0.000552964010
   target dn stat err =       0.002767377488
      target stat err =       0.002049924215
              std dev =       0.688635655077
             le_variance =       0.474219065444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474125414430
                                         uncertainty =       0.001912218660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474125414430
                                         uncertainty =       0.001912218660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486943127
  error estimate for blocks of size 2^( 2) =       0.000507701588
  error estimate for blocks of size 2^( 3) =       0.000527832064
  error estimate for blocks of size 2^( 4) =       0.000542677766
  error estimate for blocks of size 2^( 5) =       0.000552033190
  error estimate for blocks of size 2^( 6) =       0.000557677607
  error estimate for blocks of size 2^( 7) =       0.000559480621

      target function =      -0.714255317854
              le_mean =     -22.818050963525
             les_mean =     521.153255092431
             stat err =       0.000552967296
             autocorr =       1.289562551304
   target nu stat err =       0.000552967296
   target dn stat err =       0.002766735697
      target stat err =       0.002049454093
              std dev =       0.688641574331
             le_variance =       0.474227217897


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.714253486109        initial
     2.3842e+01     2.3842e+02             3.3191e-05        -0.714264958151  <--
     9.5367e+01     9.5367e+02             8.3044e-06        -0.714260706797
     3.8147e+02     3.8147e+03             2.0765e-06        -0.714255317854

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 4.3025e+01
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_01                 1.405614e-01 3 1  ON 0
ci_02                -3.785800e-02 3 1  ON 1
ci_03                -3.764579e-02 3 1  ON 2
ci_04                 3.408876e-02 3 1  ON 3
ci_05                -2.737143e-02 3 1  ON 4
ci_06                -2.680974e-02 3 1  ON 5
ci_07                 2.806835e-02 3 1  ON 6
ci_08                -9.428361e-03 3 1  ON 7
ci_09                -1.166454e-02 3 1  ON 8
ci_10                -1.149836e-02 3 1  ON 9
ci_11                 1.374435e-02 3 1  ON 10
ci_12                 8.976844e-03 3 1  ON 11
ci_13                 1.258822e-02 3 1  ON 12
ci_14                 1.242436e-02 3 1  ON 13
ci_15                 8.614328e-03 3 1  ON 14
ci_16                 8.593747e-03 3 1  ON 15
ci_17                -8.774082e-03 3 1  ON 16
ci_18                -8.312598e-03 3 1  ON 17
ci_19                 9.871168e-03 3 1  ON 18
ci_20                 7.710003e-03 3 1  ON 19
ci_21                 9.097541e-03 3 1  ON 20
ci_22                 9.180266e-03 3 1  ON 21
ci_23                 5.301675e-03 3 1  ON 22
ci_24                 4.824849e-03 3 1  ON 23
ci_25                 3.579481e-03 3 1  ON 24
ci_26                 3.594953e-03 3 1  ON 25
ci_27                 3.622020e-03 3 1  ON 26
ci_28                 2.639287e-03 3 1  ON 27
ci_29                 2.634745e-03 3 1  ON 28
ci_30                -2.184267e-03 3 1  ON 29
ci_31                -2.318448e-03 3 1  ON 30
ci_32                -1.642808e-03 3 1  ON 31
ci_33                -1.647792e-03 3 1  ON 32
ci_34                 1.497300e-03 3 1  ON 33
ci_35                 1.598228e-03 3 1  ON 34
ci_36                -1.468423e-03 3 1  ON 35
ci_37                -1.515140e-03 3 1  ON 36
ci_38                -1.038523e-03 3 1  ON 37
ci_39                -1.112210e-03 3 1  ON 38
ci_40                -1.650512e-03 3 1  ON 39
ci_41                -1.240359e-03 3 1  ON 40
ci_42                -1.055938e-03 3 1  ON 41
ci_43                -2.437344e-03 3 1  ON 42
ci_44                -1.644873e-03 3 1  ON 43
ci_45                -9.411253e-04 3 1  ON 44
ci_46                -8.476511e-04 3 1  ON 45
ci_47                -4.489112e-05 3 1  ON 46
ci_48                -2.138711e-04 3 1  ON 47
ci_49                -1.184443e-03 3 1  ON 48
ci_50                -9.035230e-04 3 1  ON 49
ci_51                 7.579932e-04 3 1  ON 50
ci_52                 6.643101e-04 3 1  ON 51
ci_53                -1.029094e-03 3 1  ON 52
ci_54                -9.159322e-04 3 1  ON 53
ci_55                -6.550439e-04 3 1  ON 54
ci_56                 1.710936e-03 3 1  ON 55
ci_57                 1.703496e-03 3 1  ON 56
ci_58                -9.683943e-04 3 1  ON 57
ci_59                -8.886867e-04 3 1  ON 58
ci_60                 7.391462e-04 3 1  ON 59
ci_61                 8.155634e-04 3 1  ON 60
ci_62                -5.763931e-04 3 1  ON 61
ci_63                -7.593727e-04 3 1  ON 62
ci_64                -5.940991e-04 3 1  ON 63
ci_65                -4.232576e-04 3 1  ON 64
ci_66                -8.169480e-04 3 1  ON 65
ci_67                -6.731572e-04 3 1  ON 66
ci_68                -3.290184e-04 3 1  ON 67
ci_69                -1.786413e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3309e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.8861
    reference variance = 0.522698
====================================================
  Execution time = 2.5620e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9406e-01
  Total weights = 1.963507655e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6054e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477107876268
                                         uncertainty =       0.002507341149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477107876268
                                         uncertainty =       0.002507341149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488402215
  error estimate for blocks of size 2^( 2) =       0.000509213603
  error estimate for blocks of size 2^( 3) =       0.000529851805
  error estimate for blocks of size 2^( 4) =       0.000546488368
  error estimate for blocks of size 2^( 5) =       0.000556907898
  error estimate for blocks of size 2^( 6) =       0.000560772684
  error estimate for blocks of size 2^( 7) =       0.000564695795

      target function =      -0.711239023291
              le_mean =     -22.818602485793
             les_mean =     521.182675412121
             stat err =       0.000557216186
             autocorr =       1.301643925884
   target nu stat err =       0.000557216186
   target dn stat err =       0.004052609225
      target stat err =       0.002921903677
              std dev =       0.690705037034
             le_variance =       0.477073448184


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281860248579e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711250298867       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711278569521       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711282959939       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711283617744       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711283883116       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711284010540       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711284057161       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711284050795       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711284047597       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711284047319       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 1.207164e-04

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711250298867       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711257408359       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711258509978       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711258674721       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711258741037       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711258772718       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711258784317       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711258782721       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711258781925       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711258781856       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 3.027646e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711250298867       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711252078874       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711252354530       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711252395734       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711252412311       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711252420221       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711252423117       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711252422718       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711252422519       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711252422502       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 7.575228e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.745445 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0235e+01
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_01                 1.405311e-01 3 1  ON 0
ci_02                -3.783382e-02 3 1  ON 1
ci_03                -3.761870e-02 3 1  ON 2
ci_04                 3.406117e-02 3 1  ON 3
ci_05                -2.735468e-02 3 1  ON 4
ci_06                -2.679215e-02 3 1  ON 5
ci_07                 2.806825e-02 3 1  ON 6
ci_08                -9.416057e-03 3 1  ON 7
ci_09                -1.165826e-02 3 1  ON 8
ci_10                -1.148966e-02 3 1  ON 9
ci_11                 1.374444e-02 3 1  ON 10
ci_12                 8.971122e-03 3 1  ON 11
ci_13                 1.258484e-02 3 1  ON 12
ci_14                 1.242777e-02 3 1  ON 13
ci_15                 8.609554e-03 3 1  ON 14
ci_16                 8.588638e-03 3 1  ON 15
ci_17                -8.772196e-03 3 1  ON 16
ci_18                -8.308204e-03 3 1  ON 17
ci_19                 9.869690e-03 3 1  ON 18
ci_20                 7.707054e-03 3 1  ON 19
ci_21                 9.097677e-03 3 1  ON 20
ci_22                 9.180291e-03 3 1  ON 21
ci_23                 5.300129e-03 3 1  ON 22
ci_24                 4.822937e-03 3 1  ON 23
ci_25                 3.578361e-03 3 1  ON 24
ci_26                 3.592861e-03 3 1  ON 25
ci_27                 3.624356e-03 3 1  ON 26
ci_28                 2.637056e-03 3 1  ON 27
ci_29                 2.632298e-03 3 1  ON 28
ci_30                -2.182691e-03 3 1  ON 29
ci_31                -2.316597e-03 3 1  ON 30
ci_32                -1.638489e-03 3 1  ON 31
ci_33                -1.649447e-03 3 1  ON 32
ci_34                 1.493546e-03 3 1  ON 33
ci_35                 1.595381e-03 3 1  ON 34
ci_36                -1.468156e-03 3 1  ON 35
ci_37                -1.515922e-03 3 1  ON 36
ci_38                -1.036818e-03 3 1  ON 37
ci_39                -1.109890e-03 3 1  ON 38
ci_40                -1.650190e-03 3 1  ON 39
ci_41                -1.237636e-03 3 1  ON 40
ci_42                -1.053265e-03 3 1  ON 41
ci_43                -2.434948e-03 3 1  ON 42
ci_44                -1.646075e-03 3 1  ON 43
ci_45                -9.384679e-04 3 1  ON 44
ci_46                -8.472306e-04 3 1  ON 45
ci_47                -4.477356e-05 3 1  ON 46
ci_48                -2.096462e-04 3 1  ON 47
ci_49                -1.184201e-03 3 1  ON 48
ci_50                -9.042022e-04 3 1  ON 49
ci_51                 7.571019e-04 3 1  ON 50
ci_52                 6.605887e-04 3 1  ON 51
ci_53                -1.028492e-03 3 1  ON 52
ci_54                -9.175296e-04 3 1  ON 53
ci_55                -6.552741e-04 3 1  ON 54
ci_56                 1.712573e-03 3 1  ON 55
ci_57                 1.702009e-03 3 1  ON 56
ci_58                -9.707936e-04 3 1  ON 57
ci_59                -8.882594e-04 3 1  ON 58
ci_60                 7.397675e-04 3 1  ON 59
ci_61                 8.136896e-04 3 1  ON 60
ci_62                -5.757716e-04 3 1  ON 61
ci_63                -7.584062e-04 3 1  ON 62
ci_64                -5.961919e-04 3 1  ON 63
ci_65                -4.222151e-04 3 1  ON 64
ci_66                -8.160167e-04 3 1  ON 65
ci_67                -6.733898e-04 3 1  ON 66
ci_68                -3.330131e-04 3 1  ON 67
ci_69                -1.800444e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.7757
    reference variance = 0.398064
====================================================
  Execution time = 2.6908e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9513e-01
  Total weights = 1.9635e+06
  Execution time = 3.5856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479076942640
                                         uncertainty =       0.002807351906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479076942640
                                         uncertainty =       0.002807351906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489441154
  error estimate for blocks of size 2^( 2) =       0.000510319279
  error estimate for blocks of size 2^( 3) =       0.000530566276
  error estimate for blocks of size 2^( 4) =       0.000546061492
  error estimate for blocks of size 2^( 5) =       0.000555692605
  error estimate for blocks of size 2^( 6) =       0.000562839837
  error estimate for blocks of size 2^( 7) =       0.000564050126

      target function =      -0.710424827378
              le_mean =     -22.817755640042
             les_mean =     521.145161754008
             stat err =       0.000557161015
             autocorr =       1.295867132472
   target nu stat err =       0.000557161015
   target dn stat err =       0.003972266622
      target stat err =       0.002856251191
              std dev =       0.692174317770
             le_variance =       0.479105286180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478997121237
                                         uncertainty =       0.002808669256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478997121237
                                         uncertainty =       0.002808669256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489400410
  error estimate for blocks of size 2^( 2) =       0.000510279899
  error estimate for blocks of size 2^( 3) =       0.000530529059
  error estimate for blocks of size 2^( 4) =       0.000546025778
  error estimate for blocks of size 2^( 5) =       0.000555657631
  error estimate for blocks of size 2^( 6) =       0.000562804472
  error estimate for blocks of size 2^( 7) =       0.000564017564

      target function =      -0.710563062480
              le_mean =     -22.817755960229
             les_mean =     521.144980512259
             stat err =       0.000557126361
             autocorr =       1.295921689624
   target nu stat err =       0.000557126361
   target dn stat err =       0.003964351138
      target stat err =       0.002851856379
              std dev =       0.692116697373
             le_variance =       0.479025522783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479036590567
                                         uncertainty =       0.002808012253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479036590567
                                         uncertainty =       0.002808012253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489420557
  error estimate for blocks of size 2^( 2) =       0.000510299366
  error estimate for blocks of size 2^( 3) =       0.000530547448
  error estimate for blocks of size 2^( 4) =       0.000546043418
  error estimate for blocks of size 2^( 5) =       0.000555674900
  error estimate for blocks of size 2^( 6) =       0.000562821942
  error estimate for blocks of size 2^( 7) =       0.000564033639

      target function =      -0.710500899073
              le_mean =     -22.817755767622
             les_mean =     521.145059787579
             stat err =       0.000557143475
             autocorr =       1.295894607495
   target nu stat err =       0.000557143475
   target dn stat err =       0.003967701981
      target stat err =       0.002853688798
              std dev =       0.692145189550
             le_variance =       0.479064963417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479071866157
                                         uncertainty =       0.002807434434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479071866157
                                         uncertainty =       0.002807434434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489438563
  error estimate for blocks of size 2^( 2) =       0.000510316774
  error estimate for blocks of size 2^( 3) =       0.000530563906
  error estimate for blocks of size 2^( 4) =       0.000546059217
  error estimate for blocks of size 2^( 5) =       0.000555690375
  error estimate for blocks of size 2^( 6) =       0.000562837584
  error estimate for blocks of size 2^( 7) =       0.000564048048

      target function =      -0.710434305410
              le_mean =     -22.817755652454
             les_mean =     521.145148890013
             stat err =       0.000557158806
             autocorr =       1.295870577861
   target nu stat err =       0.000557158806
   target dn stat err =       0.003971613574
      target stat err =       0.002855873619
              std dev =       0.692170653368
             le_variance =       0.479100213383


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.710424827378        initial
     5.9605e+00     5.9605e+01             1.2072e-04        -0.710563062480  <--
     2.3842e+01     2.3842e+02             3.0276e-05        -0.710500899073
     9.5367e+01     9.5367e+02             7.5752e-06        -0.710434305410

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 4.4920e+01
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_01                 1.404406e-01 3 1  ON 0
ci_02                -3.776180e-02 3 1  ON 1
ci_03                -3.753800e-02 3 1  ON 2
ci_04                 3.397906e-02 3 1  ON 3
ci_05                -2.730478e-02 3 1  ON 4
ci_06                -2.673979e-02 3 1  ON 5
ci_07                 2.806795e-02 3 1  ON 6
ci_08                -9.379435e-03 3 1  ON 7
ci_09                -1.163955e-02 3 1  ON 8
ci_10                -1.146373e-02 3 1  ON 9
ci_11                 1.374471e-02 3 1  ON 10
ci_12                 8.954086e-03 3 1  ON 11
ci_13                 1.257474e-02 3 1  ON 12
ci_14                 1.243798e-02 3 1  ON 13
ci_15                 8.595334e-03 3 1  ON 14
ci_16                 8.573425e-03 3 1  ON 15
ci_17                -8.766564e-03 3 1  ON 16
ci_18                -8.295101e-03 3 1  ON 17
ci_19                 9.865299e-03 3 1  ON 18
ci_20                 7.698278e-03 3 1  ON 19
ci_21                 9.098078e-03 3 1  ON 20
ci_22                 9.180359e-03 3 1  ON 21
ci_23                 5.295533e-03 3 1  ON 22
ci_24                 4.817230e-03 3 1  ON 23
ci_25                 3.575027e-03 3 1  ON 24
ci_26                 3.586634e-03 3 1  ON 25
ci_27                 3.631323e-03 3 1  ON 26
ci_28                 2.630399e-03 3 1  ON 27
ci_29                 2.624998e-03 3 1  ON 28
ci_30                -2.177982e-03 3 1  ON 29
ci_31                -2.311064e-03 3 1  ON 30
ci_32                -1.625648e-03 3 1  ON 31
ci_33                -1.654383e-03 3 1  ON 32
ci_34                 1.482379e-03 3 1  ON 33
ci_35                 1.586911e-03 3 1  ON 34
ci_36                -1.467361e-03 3 1  ON 35
ci_37                -1.518244e-03 3 1  ON 36
ci_38                -1.031742e-03 3 1  ON 37
ci_39                -1.102987e-03 3 1  ON 38
ci_40                -1.649231e-03 3 1  ON 39
ci_41                -1.229546e-03 3 1  ON 40
ci_42                -1.045323e-03 3 1  ON 41
ci_43                -2.427794e-03 3 1  ON 42
ci_44                -1.649643e-03 3 1  ON 43
ci_45                -9.305607e-04 3 1  ON 44
ci_46                -8.459733e-04 3 1  ON 45
ci_47                -4.441469e-05 3 1  ON 46
ci_48                -1.970360e-04 3 1  ON 47
ci_49                -1.183477e-03 3 1  ON 48
ci_50                -9.062221e-04 3 1  ON 49
ci_51                 7.544464e-04 3 1  ON 50
ci_52                 6.495222e-04 3 1  ON 51
ci_53                -1.026700e-03 3 1  ON 52
ci_54                -9.222890e-04 3 1  ON 53
ci_55                -6.559578e-04 3 1  ON 54
ci_56                 1.717443e-03 3 1  ON 55
ci_57                 1.697588e-03 3 1  ON 56
ci_58                -9.779430e-04 3 1  ON 57
ci_59                -8.869903e-04 3 1  ON 58
ci_60                 7.416299e-04 3 1  ON 59
ci_61                 8.080845e-04 3 1  ON 60
ci_62                -5.739205e-04 3 1  ON 61
ci_63                -7.555298e-04 3 1  ON 62
ci_64                -6.024193e-04 3 1  ON 63
ci_65                -4.191105e-04 3 1  ON 64
ci_66                -8.132444e-04 3 1  ON 65
ci_67                -6.740796e-04 3 1  ON 66
ci_68                -3.449103e-04 3 1  ON 67
ci_69                -1.842225e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5161e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.939
    reference variance = 0.373004
====================================================
  Execution time = 2.5660e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9251e-01
  Total weights = 1.963416732e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5688e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475753059404
                                         uncertainty =       0.002201301594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475753059404
                                         uncertainty =       0.002201301594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487702598
  error estimate for blocks of size 2^( 2) =       0.000509068934
  error estimate for blocks of size 2^( 3) =       0.000528402786
  error estimate for blocks of size 2^( 4) =       0.000543810008
  error estimate for blocks of size 2^( 5) =       0.000552377185
  error estimate for blocks of size 2^( 6) =       0.000558418334
  error estimate for blocks of size 2^( 7) =       0.000561605067

      target function =      -0.712326271148
              le_mean =     -22.817772466618
             les_mean =     521.143247667629
             stat err =       0.000554052648
             autocorr =       1.290600805674
   target nu stat err =       0.000554052648
   target dn stat err =       0.003140404315
      target stat err =       0.002294549046
              std dev =       0.689715628718
             le_variance =       0.475707648499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281777246662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712332840541       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712429643112       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712444345280       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712446748979       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712447447700       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712447796901       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712447900120       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712447933269       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712447936414       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712447934406       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 5.353194e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712332840541       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712357609614       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712361340236       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712361942315       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712362115005       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712362200427       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712362225416       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712362233482       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712362234218       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712362233729       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 1.355459e-04

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712332840541       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712339069379       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712340005526       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712340156105       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712340199146       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712340220381       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712340226576       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712340228579       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712340228760       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712340228638       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 3.399560e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.748983 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0238e+01
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_01                 1.403051e-01 3 1  ON 0
ci_02                -3.765870e-02 3 1  ON 1
ci_03                -3.744756e-02 3 1  ON 2
ci_04                 3.386823e-02 3 1  ON 3
ci_05                -2.724332e-02 3 1  ON 4
ci_06                -2.668590e-02 3 1  ON 5
ci_07                 2.806034e-02 3 1  ON 6
ci_08                -9.340671e-03 3 1  ON 7
ci_09                -1.160295e-02 3 1  ON 8
ci_10                -1.144536e-02 3 1  ON 9
ci_11                 1.373448e-02 3 1  ON 10
ci_12                 8.938152e-03 3 1  ON 11
ci_13                 1.257485e-02 3 1  ON 12
ci_14                 1.244726e-02 3 1  ON 13
ci_15                 8.569682e-03 3 1  ON 14
ci_16                 8.562376e-03 3 1  ON 15
ci_17                -8.746199e-03 3 1  ON 16
ci_18                -8.275627e-03 3 1  ON 17
ci_19                 9.859317e-03 3 1  ON 18
ci_20                 7.680508e-03 3 1  ON 19
ci_21                 9.096012e-03 3 1  ON 20
ci_22                 9.177638e-03 3 1  ON 21
ci_23                 5.289177e-03 3 1  ON 22
ci_24                 4.819943e-03 3 1  ON 23
ci_25                 3.569067e-03 3 1  ON 24
ci_26                 3.580722e-03 3 1  ON 25
ci_27                 3.626586e-03 3 1  ON 26
ci_28                 2.624843e-03 3 1  ON 27
ci_29                 2.616125e-03 3 1  ON 28
ci_30                -2.159380e-03 3 1  ON 29
ci_31                -2.308670e-03 3 1  ON 30
ci_32                -1.624514e-03 3 1  ON 31
ci_33                -1.639327e-03 3 1  ON 32
ci_34                 1.489589e-03 3 1  ON 33
ci_35                 1.565551e-03 3 1  ON 34
ci_36                -1.459747e-03 3 1  ON 35
ci_37                -1.515460e-03 3 1  ON 36
ci_38                -1.026246e-03 3 1  ON 37
ci_39                -1.099993e-03 3 1  ON 38
ci_40                -1.648930e-03 3 1  ON 39
ci_41                -1.227185e-03 3 1  ON 40
ci_42                -1.034692e-03 3 1  ON 41
ci_43                -2.436650e-03 3 1  ON 42
ci_44                -1.663938e-03 3 1  ON 43
ci_45                -9.283894e-04 3 1  ON 44
ci_46                -8.500397e-04 3 1  ON 45
ci_47                -3.821561e-05 3 1  ON 46
ci_48                -1.852160e-04 3 1  ON 47
ci_49                -1.189990e-03 3 1  ON 48
ci_50                -9.058726e-04 3 1  ON 49
ci_51                 7.452358e-04 3 1  ON 50
ci_52                 6.473092e-04 3 1  ON 51
ci_53                -1.023465e-03 3 1  ON 52
ci_54                -9.257138e-04 3 1  ON 53
ci_55                -6.661905e-04 3 1  ON 54
ci_56                 1.716359e-03 3 1  ON 55
ci_57                 1.701805e-03 3 1  ON 56
ci_58                -9.726491e-04 3 1  ON 57
ci_59                -8.949587e-04 3 1  ON 58
ci_60                 7.376967e-04 3 1  ON 59
ci_61                 8.027088e-04 3 1  ON 60
ci_62                -5.729388e-04 3 1  ON 61
ci_63                -7.535117e-04 3 1  ON 62
ci_64                -5.965968e-04 3 1  ON 63
ci_65                -4.177586e-04 3 1  ON 64
ci_66                -8.100647e-04 3 1  ON 65
ci_67                -6.782065e-04 3 1  ON 66
ci_68                -3.534986e-04 3 1  ON 67
ci_69                -1.768599e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.7948
    reference variance = 0.360695
====================================================
  Execution time = 2.5156e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9969e-01
  Total weights = 1.9638e+06
  Execution time = 3.5978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483193423453
                                         uncertainty =       0.006100120982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483193423453
                                         uncertainty =       0.006100120982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491536916
  error estimate for blocks of size 2^( 2) =       0.000511844227
  error estimate for blocks of size 2^( 3) =       0.000531127228
  error estimate for blocks of size 2^( 4) =       0.000546092436
  error estimate for blocks of size 2^( 5) =       0.000555323853
  error estimate for blocks of size 2^( 6) =       0.000561871093
  error estimate for blocks of size 2^( 7) =       0.000565334701

      target function =      -0.706937987593
              le_mean =     -22.817493285284
             les_mean =     521.138125922632
             stat err =       0.000557155521
             autocorr =       1.284814992133
   target nu stat err =       0.000557155521
   target dn stat err =       0.006484126821
      target stat err =       0.004561090619
              std dev =       0.695138173325
             le_variance =       0.483217080013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482858658156
                                         uncertainty =       0.006096597577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482858658156
                                         uncertainty =       0.006096597577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491366179
  error estimate for blocks of size 2^( 2) =       0.000511680724
  error estimate for blocks of size 2^( 3) =       0.000530970074
  error estimate for blocks of size 2^( 4) =       0.000545939678
  error estimate for blocks of size 2^( 5) =       0.000555178538
  error estimate for blocks of size 2^( 6) =       0.000561733782
  error estimate for blocks of size 2^( 7) =       0.000565205214

      target function =      -0.706559317229
              le_mean =     -22.817490032581
             les_mean =     521.138518983878
             stat err =       0.000557014303
             autocorr =       1.285056354608
   target nu stat err =       0.000557014303
   target dn stat err =       0.006567214926
      target stat err =       0.004613746738
              std dev =       0.694896714551
             le_variance =       0.482881443893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483018724917
                                         uncertainty =       0.006098180197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483018724917
                                         uncertainty =       0.006098180197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491447823
  error estimate for blocks of size 2^( 2) =       0.000511758777
  error estimate for blocks of size 2^( 3) =       0.000531044891
  error estimate for blocks of size 2^( 4) =       0.000546012480
  error estimate for blocks of size 2^( 5) =       0.000555247567
  error estimate for blocks of size 2^( 6) =       0.000561798794
  error estimate for blocks of size 2^( 7) =       0.000565266183

      target function =      -0.707319564563
              le_mean =     -22.817491103284
             les_mean =     521.137480426288
             stat err =       0.000557081256
             autocorr =       1.284938260712
   target nu stat err =       0.000557081256
   target dn stat err =       0.006459588750
      target stat err =       0.004548928506
              std dev =       0.695012176427
             le_variance =       0.483041925382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483171034498
                                         uncertainty =       0.006099861618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483171034498
                                         uncertainty =       0.006099861618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491525499
  error estimate for blocks of size 2^( 2) =       0.000511833285
  error estimate for blocks of size 2^( 3) =       0.000531116700
  error estimate for blocks of size 2^( 4) =       0.000546082171
  error estimate for blocks of size 2^( 5) =       0.000555313987
  error estimate for blocks of size 2^( 6) =       0.000561861215
  error estimate for blocks of size 2^( 7) =       0.000565325337

      target function =      -0.706623401606
              le_mean =     -22.817493011566
             les_mean =     521.138563824673
             stat err =       0.000557145678
             autocorr =       1.284829281107
   target nu stat err =       0.000557145678
   target dn stat err =       0.006512979608
      target stat err =       0.004577043205
              std dev =       0.695122027051
             le_variance =       0.483194632492


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706937987593        initial
     1.4901e+00     1.4901e+01             5.3532e-04        -0.706559317229
     5.9605e+00     5.9605e+01             1.3555e-04        -0.707319564563  <--
     2.3842e+01     2.3842e+02             3.3996e-05        -0.706623401606

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 4.3187e+01
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_01                 1.403051e-01 3 1  ON 0
ci_02                -3.765870e-02 3 1  ON 1
ci_03                -3.744756e-02 3 1  ON 2
ci_04                 3.386823e-02 3 1  ON 3
ci_05                -2.724332e-02 3 1  ON 4
ci_06                -2.668590e-02 3 1  ON 5
ci_07                 2.806034e-02 3 1  ON 6
ci_08                -9.340671e-03 3 1  ON 7
ci_09                -1.160295e-02 3 1  ON 8
ci_10                -1.144536e-02 3 1  ON 9
ci_11                 1.373448e-02 3 1  ON 10
ci_12                 8.938152e-03 3 1  ON 11
ci_13                 1.257485e-02 3 1  ON 12
ci_14                 1.244726e-02 3 1  ON 13
ci_15                 8.569682e-03 3 1  ON 14
ci_16                 8.562376e-03 3 1  ON 15
ci_17                -8.746199e-03 3 1  ON 16
ci_18                -8.275627e-03 3 1  ON 17
ci_19                 9.859317e-03 3 1  ON 18
ci_20                 7.680508e-03 3 1  ON 19
ci_21                 9.096012e-03 3 1  ON 20
ci_22                 9.177638e-03 3 1  ON 21
ci_23                 5.289177e-03 3 1  ON 22
ci_24                 4.819943e-03 3 1  ON 23
ci_25                 3.569067e-03 3 1  ON 24
ci_26                 3.580722e-03 3 1  ON 25
ci_27                 3.626586e-03 3 1  ON 26
ci_28                 2.624843e-03 3 1  ON 27
ci_29                 2.616125e-03 3 1  ON 28
ci_30                -2.159380e-03 3 1  ON 29
ci_31                -2.308670e-03 3 1  ON 30
ci_32                -1.624514e-03 3 1  ON 31
ci_33                -1.639327e-03 3 1  ON 32
ci_34                 1.489589e-03 3 1  ON 33
ci_35                 1.565551e-03 3 1  ON 34
ci_36                -1.459747e-03 3 1  ON 35
ci_37                -1.515460e-03 3 1  ON 36
ci_38                -1.026246e-03 3 1  ON 37
ci_39                -1.099993e-03 3 1  ON 38
ci_40                -1.648930e-03 3 1  ON 39
ci_41                -1.227185e-03 3 1  ON 40
ci_42                -1.034692e-03 3 1  ON 41
ci_43                -2.436650e-03 3 1  ON 42
ci_44                -1.663938e-03 3 1  ON 43
ci_45                -9.283894e-04 3 1  ON 44
ci_46                -8.500397e-04 3 1  ON 45
ci_47                -3.821561e-05 3 1  ON 46
ci_48                -1.852160e-04 3 1  ON 47
ci_49                -1.189990e-03 3 1  ON 48
ci_50                -9.058726e-04 3 1  ON 49
ci_51                 7.452358e-04 3 1  ON 50
ci_52                 6.473092e-04 3 1  ON 51
ci_53                -1.023465e-03 3 1  ON 52
ci_54                -9.257138e-04 3 1  ON 53
ci_55                -6.661905e-04 3 1  ON 54
ci_56                 1.716359e-03 3 1  ON 55
ci_57                 1.701805e-03 3 1  ON 56
ci_58                -9.726491e-04 3 1  ON 57
ci_59                -8.949587e-04 3 1  ON 58
ci_60                 7.376967e-04 3 1  ON 59
ci_61                 8.027088e-04 3 1  ON 60
ci_62                -5.729388e-04 3 1  ON 61
ci_63                -7.535117e-04 3 1  ON 62
ci_64                -5.965968e-04 3 1  ON 63
ci_65                -4.177586e-04 3 1  ON 64
ci_66                -8.100647e-04 3 1  ON 65
ci_67                -6.782065e-04 3 1  ON 66
ci_68                -3.534986e-04 3 1  ON 67
ci_69                -1.768599e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3431e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.8458
    reference variance = 0.486205
====================================================
  Execution time = 2.5701e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5361e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9341e-01
  Total weights = 1.963577588e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476794935995
                                         uncertainty =       0.002538643880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476794935995
                                         uncertainty =       0.002538643880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488245433
  error estimate for blocks of size 2^( 2) =       0.000509662257
  error estimate for blocks of size 2^( 3) =       0.000529983807
  error estimate for blocks of size 2^( 4) =       0.000546058466
  error estimate for blocks of size 2^( 5) =       0.000556928043
  error estimate for blocks of size 2^( 6) =       0.000560912324
  error estimate for blocks of size 2^( 7) =       0.000562806263

      target function =      -0.711676553938
              le_mean =     -22.817165632718
             les_mean =     521.116453100256
             stat err =       0.000556676274
             autocorr =       1.299957171139
   target nu stat err =       0.000556676274
   target dn stat err =       0.003531621274
      target stat err =       0.002558570849
              std dev =       0.690483313270
             le_variance =       0.476767205904


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281716563272e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711684999716       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711774733119       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711792198769       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711795886695       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711797138179       residual = 7.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711797521050       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711797584073       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711797575459       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711797566951       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711797564837       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.711797565365       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 5.943379e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711684999716       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711707957633       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711712391603       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711713317146       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711713627489       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711713719725       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711713734592       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711713732406       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711713730317       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711713729815       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 1.504818e-04

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711684999716       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711690772938       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711691885719       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711692117312       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711692194728       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711692217565       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711692221226       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711692220677       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711692220157       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711692220033       residual = 9.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 3.774144e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.752692 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0276e+01
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_01                 1.401546e-01 3 1  ON 0
ci_02                -3.757314e-02 3 1  ON 1
ci_03                -3.736559e-02 3 1  ON 2
ci_04                 3.376414e-02 3 1  ON 3
ci_05                -2.717343e-02 3 1  ON 4
ci_06                -2.662599e-02 3 1  ON 5
ci_07                 2.804816e-02 3 1  ON 6
ci_08                -9.296238e-03 3 1  ON 7
ci_09                -1.156501e-02 3 1  ON 8
ci_10                -1.141501e-02 3 1  ON 9
ci_11                 1.372971e-02 3 1  ON 10
ci_12                 8.934588e-03 3 1  ON 11
ci_13                 1.258426e-02 3 1  ON 12
ci_14                 1.245337e-02 3 1  ON 13
ci_15                 8.538152e-03 3 1  ON 14
ci_16                 8.534956e-03 3 1  ON 15
ci_17                -8.733922e-03 3 1  ON 16
ci_18                -8.259032e-03 3 1  ON 17
ci_19                 9.854516e-03 3 1  ON 18
ci_20                 7.659475e-03 3 1  ON 19
ci_21                 9.096006e-03 3 1  ON 20
ci_22                 9.177143e-03 3 1  ON 21
ci_23                 5.285847e-03 3 1  ON 22
ci_24                 4.820096e-03 3 1  ON 23
ci_25                 3.561705e-03 3 1  ON 24
ci_26                 3.568108e-03 3 1  ON 25
ci_27                 3.617394e-03 3 1  ON 26
ci_28                 2.612651e-03 3 1  ON 27
ci_29                 2.609872e-03 3 1  ON 28
ci_30                -2.144851e-03 3 1  ON 29
ci_31                -2.310107e-03 3 1  ON 30
ci_32                -1.623583e-03 3 1  ON 31
ci_33                -1.628563e-03 3 1  ON 32
ci_34                 1.475175e-03 3 1  ON 33
ci_35                 1.559003e-03 3 1  ON 34
ci_36                -1.451342e-03 3 1  ON 35
ci_37                -1.511878e-03 3 1  ON 36
ci_38                -1.021186e-03 3 1  ON 37
ci_39                -1.093245e-03 3 1  ON 38
ci_40                -1.643681e-03 3 1  ON 39
ci_41                -1.223122e-03 3 1  ON 40
ci_42                -1.035814e-03 3 1  ON 41
ci_43                -2.431081e-03 3 1  ON 42
ci_44                -1.680249e-03 3 1  ON 43
ci_45                -9.216029e-04 3 1  ON 44
ci_46                -8.415257e-04 3 1  ON 45
ci_47                -4.520023e-05 3 1  ON 46
ci_48                -1.728945e-04 3 1  ON 47
ci_49                -1.185340e-03 3 1  ON 48
ci_50                -9.019528e-04 3 1  ON 49
ci_51                 7.434385e-04 3 1  ON 50
ci_52                 6.417859e-04 3 1  ON 51
ci_53                -1.023927e-03 3 1  ON 52
ci_54                -9.307290e-04 3 1  ON 53
ci_55                -6.617175e-04 3 1  ON 54
ci_56                 1.726713e-03 3 1  ON 55
ci_57                 1.710932e-03 3 1  ON 56
ci_58                -9.702927e-04 3 1  ON 57
ci_59                -8.857564e-04 3 1  ON 58
ci_60                 7.299663e-04 3 1  ON 59
ci_61                 8.067017e-04 3 1  ON 60
ci_62                -5.783609e-04 3 1  ON 61
ci_63                -7.590694e-04 3 1  ON 62
ci_64                -5.931837e-04 3 1  ON 63
ci_65                -4.205926e-04 3 1  ON 64
ci_66                -8.089666e-04 3 1  ON 65
ci_67                -6.804777e-04 3 1  ON 66
ci_68                -3.564738e-04 3 1  ON 67
ci_69                -1.884985e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.8406
    reference variance = 0.439101
====================================================
  Execution time = 2.5081e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9141e-01
  Total weights = 1.9637e+06
  Execution time = 3.6111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476301489127
                                         uncertainty =       0.002476510678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476301489127
                                         uncertainty =       0.002476510678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488009619
  error estimate for blocks of size 2^( 2) =       0.000508799581
  error estimate for blocks of size 2^( 3) =       0.000529343791
  error estimate for blocks of size 2^( 4) =       0.000543768215
  error estimate for blocks of size 2^( 5) =       0.000553149748
  error estimate for blocks of size 2^( 6) =       0.000558142386
  error estimate for blocks of size 2^( 7) =       0.000562168660

      target function =      -0.712908939226
              le_mean =     -22.818537897543
             les_mean =     521.177376094919
             stat err =       0.000554307252
             autocorr =       1.290162325746
   target nu stat err =       0.000554307252
   target dn stat err =       0.003600785071
      target stat err =       0.002619710446
              std dev =       0.690149822300
             le_variance =       0.476306777221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475950822328
                                         uncertainty =       0.002474303929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475950822328
                                         uncertainty =       0.002474303929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487830093
  error estimate for blocks of size 2^( 2) =       0.000508627522
  error estimate for blocks of size 2^( 3) =       0.000529179368
  error estimate for blocks of size 2^( 4) =       0.000543612031
  error estimate for blocks of size 2^( 5) =       0.000553003709
  error estimate for blocks of size 2^( 6) =       0.000558004391
  error estimate for blocks of size 2^( 7) =       0.000562018320

      target function =      -0.712959724560
              le_mean =     -22.818533797775
             les_mean =     521.177117463686
             stat err =       0.000554159613
             autocorr =       1.290424405177
   target nu stat err =       0.000554159613
   target dn stat err =       0.003602396901
      target stat err =       0.002621149914
              std dev =       0.689895933284
             le_variance =       0.475956398762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476118908720
                                         uncertainty =       0.002475190627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476118908720
                                         uncertainty =       0.002475190627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487916153
  error estimate for blocks of size 2^( 2) =       0.000508709911
  error estimate for blocks of size 2^( 3) =       0.000529258011
  error estimate for blocks of size 2^( 4) =       0.000543686645
  error estimate for blocks of size 2^( 5) =       0.000553073451
  error estimate for blocks of size 2^( 6) =       0.000558070422
  error estimate for blocks of size 2^( 7) =       0.000562090357

      target function =      -0.713245624816
              le_mean =     -22.818535414833
             les_mean =     521.176789718762
             stat err =       0.000554230219
             autocorr =       1.290297960837
   target nu stat err =       0.000554230219
   target dn stat err =       0.003569770971
      target stat err =       0.002600529002
              std dev =       0.690017640685
             le_variance =       0.476124344457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476278128736
                                         uncertainty =       0.002476324544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476278128736
                                         uncertainty =       0.002476324544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487997662
  error estimate for blocks of size 2^( 2) =       0.000508788099
  error estimate for blocks of size 2^( 3) =       0.000529332801
  error estimate for blocks of size 2^( 4) =       0.000543757762
  error estimate for blocks of size 2^( 5) =       0.000553139980
  error estimate for blocks of size 2^( 6) =       0.000558133163
  error estimate for blocks of size 2^( 7) =       0.000562158662

      target function =      -0.712977313960
              le_mean =     -22.818537539694
             les_mean =     521.177263649179
             stat err =       0.000554297392
             autocorr =       1.290179652655
   target nu stat err =       0.000554297392
   target dn stat err =       0.003595843249
      target stat err =       0.002616762550
              std dev =       0.690132911441
             le_variance =       0.476283435454


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.712908939226        initial
     1.4901e+00     1.4901e+01             5.9434e-04        -0.712959724560
     5.9605e+00     5.9605e+01             1.5048e-04        -0.713245624816  <--
     2.3842e+01     2.3842e+02             3.7741e-05        -0.712977313960

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 4.3181e+01
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_01                 1.401546e-01 3 1  ON 0
ci_02                -3.757314e-02 3 1  ON 1
ci_03                -3.736559e-02 3 1  ON 2
ci_04                 3.376414e-02 3 1  ON 3
ci_05                -2.717343e-02 3 1  ON 4
ci_06                -2.662599e-02 3 1  ON 5
ci_07                 2.804816e-02 3 1  ON 6
ci_08                -9.296238e-03 3 1  ON 7
ci_09                -1.156501e-02 3 1  ON 8
ci_10                -1.141501e-02 3 1  ON 9
ci_11                 1.372971e-02 3 1  ON 10
ci_12                 8.934588e-03 3 1  ON 11
ci_13                 1.258426e-02 3 1  ON 12
ci_14                 1.245337e-02 3 1  ON 13
ci_15                 8.538152e-03 3 1  ON 14
ci_16                 8.534956e-03 3 1  ON 15
ci_17                -8.733922e-03 3 1  ON 16
ci_18                -8.259032e-03 3 1  ON 17
ci_19                 9.854516e-03 3 1  ON 18
ci_20                 7.659475e-03 3 1  ON 19
ci_21                 9.096006e-03 3 1  ON 20
ci_22                 9.177143e-03 3 1  ON 21
ci_23                 5.285847e-03 3 1  ON 22
ci_24                 4.820096e-03 3 1  ON 23
ci_25                 3.561705e-03 3 1  ON 24
ci_26                 3.568108e-03 3 1  ON 25
ci_27                 3.617394e-03 3 1  ON 26
ci_28                 2.612651e-03 3 1  ON 27
ci_29                 2.609872e-03 3 1  ON 28
ci_30                -2.144851e-03 3 1  ON 29
ci_31                -2.310107e-03 3 1  ON 30
ci_32                -1.623583e-03 3 1  ON 31
ci_33                -1.628563e-03 3 1  ON 32
ci_34                 1.475175e-03 3 1  ON 33
ci_35                 1.559003e-03 3 1  ON 34
ci_36                -1.451342e-03 3 1  ON 35
ci_37                -1.511878e-03 3 1  ON 36
ci_38                -1.021186e-03 3 1  ON 37
ci_39                -1.093245e-03 3 1  ON 38
ci_40                -1.643681e-03 3 1  ON 39
ci_41                -1.223122e-03 3 1  ON 40
ci_42                -1.035814e-03 3 1  ON 41
ci_43                -2.431081e-03 3 1  ON 42
ci_44                -1.680249e-03 3 1  ON 43
ci_45                -9.216029e-04 3 1  ON 44
ci_46                -8.415257e-04 3 1  ON 45
ci_47                -4.520023e-05 3 1  ON 46
ci_48                -1.728945e-04 3 1  ON 47
ci_49                -1.185340e-03 3 1  ON 48
ci_50                -9.019528e-04 3 1  ON 49
ci_51                 7.434385e-04 3 1  ON 50
ci_52                 6.417859e-04 3 1  ON 51
ci_53                -1.023927e-03 3 1  ON 52
ci_54                -9.307290e-04 3 1  ON 53
ci_55                -6.617175e-04 3 1  ON 54
ci_56                 1.726713e-03 3 1  ON 55
ci_57                 1.710932e-03 3 1  ON 56
ci_58                -9.702927e-04 3 1  ON 57
ci_59                -8.857564e-04 3 1  ON 58
ci_60                 7.299663e-04 3 1  ON 59
ci_61                 8.067017e-04 3 1  ON 60
ci_62                -5.783609e-04 3 1  ON 61
ci_63                -7.590694e-04 3 1  ON 62
ci_64                -5.931837e-04 3 1  ON 63
ci_65                -4.205926e-04 3 1  ON 64
ci_66                -8.089666e-04 3 1  ON 65
ci_67                -6.804777e-04 3 1  ON 66
ci_68                -3.564738e-04 3 1  ON 67
ci_69                -1.884985e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3464e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.77
    reference variance = 0.487814
====================================================
  Execution time = 2.5699e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8939e-01
  Total weights = 1.963586943e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473549859631
                                         uncertainty =       0.002174101400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473549859631
                                         uncertainty =       0.002174101400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486613968
  error estimate for blocks of size 2^( 2) =       0.000507488158
  error estimate for blocks of size 2^( 3) =       0.000527584003
  error estimate for blocks of size 2^( 4) =       0.000542850458
  error estimate for blocks of size 2^( 5) =       0.000552848820
  error estimate for blocks of size 2^( 6) =       0.000558859583
  error estimate for blocks of size 2^( 7) =       0.000561224562

      target function =      -0.714559519571
              le_mean =     -22.818435825217
             les_mean =     521.170400633967
             stat err =       0.000553945856
             autocorr =       1.295882106081
   target nu stat err =       0.000553945856
   target dn stat err =       0.003389851140
      target stat err =       0.002484027538
              std dev =       0.688176073092
             le_variance =       0.473586307577


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281843582522e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714567257986       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714667377880       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714683830991       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714686678967       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714687651810       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714688263105       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714688348971       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714688364224       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714688361729       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714688359060       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.714688357689       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 4.905608e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714567257986       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714592878149       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714597053373       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714597769927       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714598011835       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714598161763       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714598182312       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714598185968       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714598185342       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714598184690       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 1.242617e-04

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714567257986       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714573701000       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714574748732       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714574928148       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714574988536       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714575025830       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714575030910       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714575031813       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714575031657       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714575031495       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 3.116833e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.756438 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0382e+01
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_01                 1.400304e-01 3 1  ON 0
ci_02                -3.746873e-02 3 1  ON 1
ci_03                -3.726581e-02 3 1  ON 2
ci_04                 3.366167e-02 3 1  ON 3
ci_05                -2.711333e-02 3 1  ON 4
ci_06                -2.656003e-02 3 1  ON 5
ci_07                 2.803699e-02 3 1  ON 6
ci_08                -9.257668e-03 3 1  ON 7
ci_09                -1.152422e-02 3 1  ON 8
ci_10                -1.137834e-02 3 1  ON 9
ci_11                 1.372052e-02 3 1  ON 10
ci_12                 8.911272e-03 3 1  ON 11
ci_13                 1.257669e-02 3 1  ON 12
ci_14                 1.245876e-02 3 1  ON 13
ci_15                 8.517316e-03 3 1  ON 14
ci_16                 8.515238e-03 3 1  ON 15
ci_17                -8.731734e-03 3 1  ON 16
ci_18                -8.244050e-03 3 1  ON 17
ci_19                 9.844214e-03 3 1  ON 18
ci_20                 7.649376e-03 3 1  ON 19
ci_21                 9.089926e-03 3 1  ON 20
ci_22                 9.173680e-03 3 1  ON 21
ci_23                 5.270055e-03 3 1  ON 22
ci_24                 4.818345e-03 3 1  ON 23
ci_25                 3.561956e-03 3 1  ON 24
ci_26                 3.568088e-03 3 1  ON 25
ci_27                 3.620605e-03 3 1  ON 26
ci_28                 2.592909e-03 3 1  ON 27
ci_29                 2.598344e-03 3 1  ON 28
ci_30                -2.143320e-03 3 1  ON 29
ci_31                -2.302131e-03 3 1  ON 30
ci_32                -1.617542e-03 3 1  ON 31
ci_33                -1.608283e-03 3 1  ON 32
ci_34                 1.469282e-03 3 1  ON 33
ci_35                 1.552323e-03 3 1  ON 34
ci_36                -1.445799e-03 3 1  ON 35
ci_37                -1.506668e-03 3 1  ON 36
ci_38                -1.016741e-03 3 1  ON 37
ci_39                -1.086047e-03 3 1  ON 38
ci_40                -1.644459e-03 3 1  ON 39
ci_41                -1.221439e-03 3 1  ON 40
ci_42                -1.038887e-03 3 1  ON 41
ci_43                -2.432996e-03 3 1  ON 42
ci_44                -1.675702e-03 3 1  ON 43
ci_45                -9.216994e-04 3 1  ON 44
ci_46                -8.330778e-04 3 1  ON 45
ci_47                -3.683257e-05 3 1  ON 46
ci_48                -1.714166e-04 3 1  ON 47
ci_49                -1.182226e-03 3 1  ON 48
ci_50                -8.974729e-04 3 1  ON 49
ci_51                 7.434345e-04 3 1  ON 50
ci_52                 6.344422e-04 3 1  ON 51
ci_53                -1.022914e-03 3 1  ON 52
ci_54                -9.312798e-04 3 1  ON 53
ci_55                -6.621794e-04 3 1  ON 54
ci_56                 1.729428e-03 3 1  ON 55
ci_57                 1.716156e-03 3 1  ON 56
ci_58                -9.684850e-04 3 1  ON 57
ci_59                -8.887440e-04 3 1  ON 58
ci_60                 7.307280e-04 3 1  ON 59
ci_61                 8.163405e-04 3 1  ON 60
ci_62                -5.721517e-04 3 1  ON 61
ci_63                -7.542197e-04 3 1  ON 62
ci_64                -5.901746e-04 3 1  ON 63
ci_65                -4.243374e-04 3 1  ON 64
ci_66                -8.049282e-04 3 1  ON 65
ci_67                -6.729293e-04 3 1  ON 66
ci_68                -3.749856e-04 3 1  ON 67
ci_69                -1.931124e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.8047
    reference variance = 0.259786
====================================================
  Execution time = 2.5051e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9000e-01
  Total weights = 1.9634e+06
  Execution time = 3.5913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473857501865
                                         uncertainty =       0.001914095128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473857501865
                                         uncertainty =       0.001914095128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486809364
  error estimate for blocks of size 2^( 2) =       0.000508074801
  error estimate for blocks of size 2^( 3) =       0.000527708818
  error estimate for blocks of size 2^( 4) =       0.000541720157
  error estimate for blocks of size 2^( 5) =       0.000551567662
  error estimate for blocks of size 2^( 6) =       0.000556870943
  error estimate for blocks of size 2^( 7) =       0.000559561037

      target function =      -0.713498739908
              le_mean =     -22.817966557408
             les_mean =     521.150459757815
             stat err =       0.000552429950
             autocorr =       1.287764899909
   target nu stat err =       0.000552429950
   target dn stat err =       0.003211192544
      target stat err =       0.002351078211
              std dev =       0.688452405312
             le_variance =       0.473966714379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473542940703
                                         uncertainty =       0.001911276261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473542940703
                                         uncertainty =       0.001911276261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486649326
  error estimate for blocks of size 2^( 2) =       0.000507919605
  error estimate for blocks of size 2^( 3) =       0.000527561290
  error estimate for blocks of size 2^( 4) =       0.000541578967
  error estimate for blocks of size 2^( 5) =       0.000551432268
  error estimate for blocks of size 2^( 6) =       0.000556740487
  error estimate for blocks of size 2^( 7) =       0.000559433624

      target function =      -0.713389361794
              le_mean =     -22.817968241423
             les_mean =     521.150689559513
             stat err =       0.000552296336
             autocorr =       1.287988758113
   target nu stat err =       0.000552296336
   target dn stat err =       0.003333949195
      target stat err =       0.002435352616
              std dev =       0.688226076625
             le_variance =       0.473655132546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473694273729
                                         uncertainty =       0.001912638821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473694273729
                                         uncertainty =       0.001912638821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486726302
  error estimate for blocks of size 2^( 2) =       0.000507994128
  error estimate for blocks of size 2^( 3) =       0.000527631862
  error estimate for blocks of size 2^( 4) =       0.000541646367
  error estimate for blocks of size 2^( 5) =       0.000551496888
  error estimate for blocks of size 2^( 6) =       0.000556802866
  error estimate for blocks of size 2^( 7) =       0.000559494250

      target function =      -0.714361757049
              le_mean =     -22.817967134245
             les_mean =     521.149276400475
             stat err =       0.000552360093
             autocorr =       1.287878688720
   target nu stat err =       0.000552360093
   target dn stat err =       0.002988142792
      target stat err =       0.002202191577
              std dev =       0.688334937590
             le_variance =       0.473804986307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473836699837
                                         uncertainty =       0.001913910569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473836699837
                                         uncertainty =       0.001913910569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486798777
  error estimate for blocks of size 2^( 2) =       0.000508064501
  error estimate for blocks of size 2^( 3) =       0.000527698981
  error estimate for blocks of size 2^( 4) =       0.000541710715
  error estimate for blocks of size 2^( 5) =       0.000551558605
  error estimate for blocks of size 2^( 6) =       0.000556862227
  error estimate for blocks of size 2^( 7) =       0.000559552455

      target function =      -0.713715068047
              le_mean =     -22.817966586174
             les_mean =     521.150157742011
             stat err =       0.000552421001
             autocorr =       1.287779191345
   target nu stat err =       0.000552421001
   target dn stat err =       0.003128798587
      target stat err =       0.002295456817
              std dev =       0.688437432698
             le_variance =       0.473946098739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.713498739908        initial
     1.4901e+00     1.4901e+01             4.9056e-04        -0.713389361794
     5.9605e+00     5.9605e+01             1.2426e-04        -0.714361757049  <--
     2.3842e+01     2.3842e+02             3.1168e-05        -0.713715068047

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 4.3066e+01
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_01                 1.400304e-01 3 1  ON 0
ci_02                -3.746873e-02 3 1  ON 1
ci_03                -3.726581e-02 3 1  ON 2
ci_04                 3.366167e-02 3 1  ON 3
ci_05                -2.711333e-02 3 1  ON 4
ci_06                -2.656003e-02 3 1  ON 5
ci_07                 2.803699e-02 3 1  ON 6
ci_08                -9.257668e-03 3 1  ON 7
ci_09                -1.152422e-02 3 1  ON 8
ci_10                -1.137834e-02 3 1  ON 9
ci_11                 1.372052e-02 3 1  ON 10
ci_12                 8.911272e-03 3 1  ON 11
ci_13                 1.257669e-02 3 1  ON 12
ci_14                 1.245876e-02 3 1  ON 13
ci_15                 8.517316e-03 3 1  ON 14
ci_16                 8.515238e-03 3 1  ON 15
ci_17                -8.731734e-03 3 1  ON 16
ci_18                -8.244050e-03 3 1  ON 17
ci_19                 9.844214e-03 3 1  ON 18
ci_20                 7.649376e-03 3 1  ON 19
ci_21                 9.089926e-03 3 1  ON 20
ci_22                 9.173680e-03 3 1  ON 21
ci_23                 5.270055e-03 3 1  ON 22
ci_24                 4.818345e-03 3 1  ON 23
ci_25                 3.561956e-03 3 1  ON 24
ci_26                 3.568088e-03 3 1  ON 25
ci_27                 3.620605e-03 3 1  ON 26
ci_28                 2.592909e-03 3 1  ON 27
ci_29                 2.598344e-03 3 1  ON 28
ci_30                -2.143320e-03 3 1  ON 29
ci_31                -2.302131e-03 3 1  ON 30
ci_32                -1.617542e-03 3 1  ON 31
ci_33                -1.608283e-03 3 1  ON 32
ci_34                 1.469282e-03 3 1  ON 33
ci_35                 1.552323e-03 3 1  ON 34
ci_36                -1.445799e-03 3 1  ON 35
ci_37                -1.506668e-03 3 1  ON 36
ci_38                -1.016741e-03 3 1  ON 37
ci_39                -1.086047e-03 3 1  ON 38
ci_40                -1.644459e-03 3 1  ON 39
ci_41                -1.221439e-03 3 1  ON 40
ci_42                -1.038887e-03 3 1  ON 41
ci_43                -2.432996e-03 3 1  ON 42
ci_44                -1.675702e-03 3 1  ON 43
ci_45                -9.216994e-04 3 1  ON 44
ci_46                -8.330778e-04 3 1  ON 45
ci_47                -3.683257e-05 3 1  ON 46
ci_48                -1.714166e-04 3 1  ON 47
ci_49                -1.182226e-03 3 1  ON 48
ci_50                -8.974729e-04 3 1  ON 49
ci_51                 7.434345e-04 3 1  ON 50
ci_52                 6.344422e-04 3 1  ON 51
ci_53                -1.022914e-03 3 1  ON 52
ci_54                -9.312798e-04 3 1  ON 53
ci_55                -6.621794e-04 3 1  ON 54
ci_56                 1.729428e-03 3 1  ON 55
ci_57                 1.716156e-03 3 1  ON 56
ci_58                -9.684850e-04 3 1  ON 57
ci_59                -8.887440e-04 3 1  ON 58
ci_60                 7.307280e-04 3 1  ON 59
ci_61                 8.163405e-04 3 1  ON 60
ci_62                -5.721517e-04 3 1  ON 61
ci_63                -7.542197e-04 3 1  ON 62
ci_64                -5.901746e-04 3 1  ON 63
ci_65                -4.243374e-04 3 1  ON 64
ci_66                -8.049282e-04 3 1  ON 65
ci_67                -6.729293e-04 3 1  ON 66
ci_68                -3.749856e-04 3 1  ON 67
ci_69                -1.931124e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3454e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.8171
    reference variance = 0.665941
====================================================
  Execution time = 2.5694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9112e-01
  Total weights = 1.963674170e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475261685708
                                         uncertainty =       0.002297775139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475261685708
                                         uncertainty =       0.002297775139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487459587
  error estimate for blocks of size 2^( 2) =       0.000508271612
  error estimate for blocks of size 2^( 3) =       0.000527969804
  error estimate for blocks of size 2^( 4) =       0.000543097702
  error estimate for blocks of size 2^( 5) =       0.000553222868
  error estimate for blocks of size 2^( 6) =       0.000558598037
  error estimate for blocks of size 2^( 7) =       0.000561951524

      target function =      -0.713299923125
              le_mean =     -22.817144126657
             les_mean =     521.113185133267
             stat err =       0.000554217533
             autocorr =       1.292656961884
   target nu stat err =       0.000554217533
   target dn stat err =       0.002928798803
      target stat err =       0.002153011916
              std dev =       0.689371958481
             le_variance =       0.475233697140


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281714412666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713305596954       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713407983773       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713425144229       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713428457119       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713429690194       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713430567959       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713430718242       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713430773359       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713430760700       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713430760072       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713430760116       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 4.976880e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713305596954       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713331795916       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713336150546       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713336984803       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713337291598       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713337507047       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713337543223       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713337556579       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713337553425       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713337553268       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713337553291       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 1.260261e-04

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713305596954       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713312185442       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713313278188       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713313487122       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713313563718       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713313617321       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713313626276       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713313629589       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713313628801       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713313628762       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713313628768       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 3.160854e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.760571 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0280e+01
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_01                 1.399043e-01 3 1  ON 0
ci_02                -3.737417e-02 3 1  ON 1
ci_03                -3.717233e-02 3 1  ON 2
ci_04                 3.356169e-02 3 1  ON 3
ci_05                -2.705274e-02 3 1  ON 4
ci_06                -2.650089e-02 3 1  ON 5
ci_07                 2.801512e-02 3 1  ON 6
ci_08                -9.207915e-03 3 1  ON 7
ci_09                -1.148550e-02 3 1  ON 8
ci_10                -1.134265e-02 3 1  ON 9
ci_11                 1.370299e-02 3 1  ON 10
ci_12                 8.885935e-03 3 1  ON 11
ci_13                 1.258117e-02 3 1  ON 12
ci_14                 1.244747e-02 3 1  ON 13
ci_15                 8.498949e-03 3 1  ON 14
ci_16                 8.494966e-03 3 1  ON 15
ci_17                -8.707776e-03 3 1  ON 16
ci_18                -8.225133e-03 3 1  ON 17
ci_19                 9.830964e-03 3 1  ON 18
ci_20                 7.640472e-03 3 1  ON 19
ci_21                 9.093597e-03 3 1  ON 20
ci_22                 9.161271e-03 3 1  ON 21
ci_23                 5.266727e-03 3 1  ON 22
ci_24                 4.797861e-03 3 1  ON 23
ci_25                 3.553572e-03 3 1  ON 24
ci_26                 3.553367e-03 3 1  ON 25
ci_27                 3.614608e-03 3 1  ON 26
ci_28                 2.579845e-03 3 1  ON 27
ci_29                 2.579431e-03 3 1  ON 28
ci_30                -2.146652e-03 3 1  ON 29
ci_31                -2.291503e-03 3 1  ON 30
ci_32                -1.612776e-03 3 1  ON 31
ci_33                -1.608964e-03 3 1  ON 32
ci_34                 1.454155e-03 3 1  ON 33
ci_35                 1.548418e-03 3 1  ON 34
ci_36                -1.441393e-03 3 1  ON 35
ci_37                -1.501060e-03 3 1  ON 36
ci_38                -1.011455e-03 3 1  ON 37
ci_39                -1.077641e-03 3 1  ON 38
ci_40                -1.649904e-03 3 1  ON 39
ci_41                -1.213354e-03 3 1  ON 40
ci_42                -1.029729e-03 3 1  ON 41
ci_43                -2.445147e-03 3 1  ON 42
ci_44                -1.684415e-03 3 1  ON 43
ci_45                -9.200720e-04 3 1  ON 44
ci_46                -8.179211e-04 3 1  ON 45
ci_47                -2.236224e-05 3 1  ON 46
ci_48                -1.709042e-04 3 1  ON 47
ci_49                -1.181527e-03 3 1  ON 48
ci_50                -8.963464e-04 3 1  ON 49
ci_51                 7.352953e-04 3 1  ON 50
ci_52                 6.328150e-04 3 1  ON 51
ci_53                -1.016307e-03 3 1  ON 52
ci_54                -9.541576e-04 3 1  ON 53
ci_55                -6.536230e-04 3 1  ON 54
ci_56                 1.727497e-03 3 1  ON 55
ci_57                 1.720159e-03 3 1  ON 56
ci_58                -9.614232e-04 3 1  ON 57
ci_59                -8.906412e-04 3 1  ON 58
ci_60                 7.216480e-04 3 1  ON 59
ci_61                 7.988561e-04 3 1  ON 60
ci_62                -5.711490e-04 3 1  ON 61
ci_63                -7.568111e-04 3 1  ON 62
ci_64                -5.719954e-04 3 1  ON 63
ci_65                -4.177656e-04 3 1  ON 64
ci_66                -8.028447e-04 3 1  ON 65
ci_67                -6.763239e-04 3 1  ON 66
ci_68                -3.818721e-04 3 1  ON 67
ci_69                -2.181393e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.8116
    reference variance = 0.421877
====================================================
  Execution time = 2.6826e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8572e-01
  Total weights = 1.9635e+06
  Execution time = 3.6021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471307833579
                                         uncertainty =       0.002328347392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471307833579
                                         uncertainty =       0.002328347392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485420738
  error estimate for blocks of size 2^( 2) =       0.000506315387
  error estimate for blocks of size 2^( 3) =       0.000526060261
  error estimate for blocks of size 2^( 4) =       0.000542582249
  error estimate for blocks of size 2^( 5) =       0.000553309800
  error estimate for blocks of size 2^( 6) =       0.000558671800
  error estimate for blocks of size 2^( 7) =       0.000560973955

      target function =      -0.717003016032
              le_mean =     -22.818055698209
             les_mean =     521.149634204435
             stat err =       0.000553884451
             autocorr =       1.301972151464
   target nu stat err =       0.000553884451
   target dn stat err =       0.002789179907
      target stat err =       0.002080484098
              std dev =       0.686488590810
             le_variance =       0.471266585313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471007239965
                                         uncertainty =       0.002326644194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471007239965
                                         uncertainty =       0.002326644194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485265885
  error estimate for blocks of size 2^( 2) =       0.000506168309
  error estimate for blocks of size 2^( 3) =       0.000525920153
  error estimate for blocks of size 2^( 4) =       0.000542454349
  error estimate for blocks of size 2^( 5) =       0.000553183468
  error estimate for blocks of size 2^( 6) =       0.000558553400
  error estimate for blocks of size 2^( 7) =       0.000560859809

      target function =      -0.705486723653
              le_mean =     -22.818054325222
             les_mean =     521.165649508936
             stat err =       0.000553762757
             autocorr =       1.302230809091
   target nu stat err =       0.000553762757
   target dn stat err =       0.014655563278
      target stat err =       0.010216110272
              std dev =       0.686269596213
             le_variance =       0.470965958686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471151397415
                                         uncertainty =       0.002327391950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471151397415
                                         uncertainty =       0.002327391950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485340156
  error estimate for blocks of size 2^( 2) =       0.000506238714
  error estimate for blocks of size 2^( 3) =       0.000525987096
  error estimate for blocks of size 2^( 4) =       0.000542515190
  error estimate for blocks of size 2^( 5) =       0.000553243583
  error estimate for blocks of size 2^( 6) =       0.000558609637
  error estimate for blocks of size 2^( 7) =       0.000560914265

      target function =      -0.717250686457
              le_mean =     -22.818054800586
             les_mean =     521.149248965421
             stat err =       0.000553820669
             autocorr =       1.302104583800
   target nu stat err =       0.000553820669
   target dn stat err =       0.002757092976
      target stat err =       0.002059614648
              std dev =       0.686374631674
             le_variance =       0.471110135006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471287842398
                                         uncertainty =       0.002328217664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471287842398
                                         uncertainty =       0.002328217664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485410441
  error estimate for blocks of size 2^( 2) =       0.000506305580
  error estimate for blocks of size 2^( 3) =       0.000526050910
  error estimate for blocks of size 2^( 4) =       0.000542573628
  error estimate for blocks of size 2^( 5) =       0.000553301285
  error estimate for blocks of size 2^( 6) =       0.000558663743
  error estimate for blocks of size 2^( 7) =       0.000560966275

      target function =      -0.716827124645
              le_mean =     -22.818055519779
             les_mean =     521.149870747436
             stat err =       0.000553876233
             autocorr =       1.301988750353
   target nu stat err =       0.000553876233
   target dn stat err =       0.002798799903
      target stat err =       0.002086159112
              std dev =       0.686474029095
             le_variance =       0.471246592622


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.717003016032        initial
     1.4901e+00     1.4901e+01             4.9769e-04        -0.705486723653
     5.9605e+00     5.9605e+01             1.2603e-04        -0.717250686457  <--
     2.3842e+01     2.3842e+02             3.1609e-05        -0.716827124645

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 4.4880e+01
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_01                 1.399043e-01 3 1  ON 0
ci_02                -3.737417e-02 3 1  ON 1
ci_03                -3.717233e-02 3 1  ON 2
ci_04                 3.356169e-02 3 1  ON 3
ci_05                -2.705274e-02 3 1  ON 4
ci_06                -2.650089e-02 3 1  ON 5
ci_07                 2.801512e-02 3 1  ON 6
ci_08                -9.207915e-03 3 1  ON 7
ci_09                -1.148550e-02 3 1  ON 8
ci_10                -1.134265e-02 3 1  ON 9
ci_11                 1.370299e-02 3 1  ON 10
ci_12                 8.885935e-03 3 1  ON 11
ci_13                 1.258117e-02 3 1  ON 12
ci_14                 1.244747e-02 3 1  ON 13
ci_15                 8.498949e-03 3 1  ON 14
ci_16                 8.494966e-03 3 1  ON 15
ci_17                -8.707776e-03 3 1  ON 16
ci_18                -8.225133e-03 3 1  ON 17
ci_19                 9.830964e-03 3 1  ON 18
ci_20                 7.640472e-03 3 1  ON 19
ci_21                 9.093597e-03 3 1  ON 20
ci_22                 9.161271e-03 3 1  ON 21
ci_23                 5.266727e-03 3 1  ON 22
ci_24                 4.797861e-03 3 1  ON 23
ci_25                 3.553572e-03 3 1  ON 24
ci_26                 3.553367e-03 3 1  ON 25
ci_27                 3.614608e-03 3 1  ON 26
ci_28                 2.579845e-03 3 1  ON 27
ci_29                 2.579431e-03 3 1  ON 28
ci_30                -2.146652e-03 3 1  ON 29
ci_31                -2.291503e-03 3 1  ON 30
ci_32                -1.612776e-03 3 1  ON 31
ci_33                -1.608964e-03 3 1  ON 32
ci_34                 1.454155e-03 3 1  ON 33
ci_35                 1.548418e-03 3 1  ON 34
ci_36                -1.441393e-03 3 1  ON 35
ci_37                -1.501060e-03 3 1  ON 36
ci_38                -1.011455e-03 3 1  ON 37
ci_39                -1.077641e-03 3 1  ON 38
ci_40                -1.649904e-03 3 1  ON 39
ci_41                -1.213354e-03 3 1  ON 40
ci_42                -1.029729e-03 3 1  ON 41
ci_43                -2.445147e-03 3 1  ON 42
ci_44                -1.684415e-03 3 1  ON 43
ci_45                -9.200720e-04 3 1  ON 44
ci_46                -8.179211e-04 3 1  ON 45
ci_47                -2.236224e-05 3 1  ON 46
ci_48                -1.709042e-04 3 1  ON 47
ci_49                -1.181527e-03 3 1  ON 48
ci_50                -8.963464e-04 3 1  ON 49
ci_51                 7.352953e-04 3 1  ON 50
ci_52                 6.328150e-04 3 1  ON 51
ci_53                -1.016307e-03 3 1  ON 52
ci_54                -9.541576e-04 3 1  ON 53
ci_55                -6.536230e-04 3 1  ON 54
ci_56                 1.727497e-03 3 1  ON 55
ci_57                 1.720159e-03 3 1  ON 56
ci_58                -9.614232e-04 3 1  ON 57
ci_59                -8.906412e-04 3 1  ON 58
ci_60                 7.216480e-04 3 1  ON 59
ci_61                 7.988561e-04 3 1  ON 60
ci_62                -5.711490e-04 3 1  ON 61
ci_63                -7.568111e-04 3 1  ON 62
ci_64                -5.719954e-04 3 1  ON 63
ci_65                -4.177656e-04 3 1  ON 64
ci_66                -8.028447e-04 3 1  ON 65
ci_67                -6.763239e-04 3 1  ON 66
ci_68                -3.818721e-04 3 1  ON 67
ci_69                -2.181393e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5166e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.8529
    reference variance = 0.484563
====================================================
  Execution time = 2.5738e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5328e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8914e-01
  Total weights = 1.963764344e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5711e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474764098775
                                         uncertainty =       0.003009677008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474764098775
                                         uncertainty =       0.003009677008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487281976
  error estimate for blocks of size 2^( 2) =       0.000508025329
  error estimate for blocks of size 2^( 3) =       0.000527899926
  error estimate for blocks of size 2^( 4) =       0.000543378074
  error estimate for blocks of size 2^( 5) =       0.000553198979
  error estimate for blocks of size 2^( 6) =       0.000558693706
  error estimate for blocks of size 2^( 7) =       0.000560835977

      target function =      -0.714725694305
              le_mean =     -22.818261506951
             les_mean =     521.162201546277
             stat err =       0.000554026684
             autocorr =       1.292708691898
   target nu stat err =       0.000554026684
   target dn stat err =       0.004155713365
      target stat err =       0.003020487534
              std dev =       0.689120779771
             le_variance =       0.474887449112


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281826150695e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714737627768       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714827380998       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714842470747       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714844500746       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714845550919       residual = 6.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714845825324       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714845828151       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714845829918       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714845836188       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714845836699       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.714845837574       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 4.711339e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714737627768       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714760599485       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714764429081       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714764937946       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714765199478       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714765265592       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714765265784       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714765266235       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714765267773       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714765267902       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.714765268117       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 1.193085e-04

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.714737627768       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.714743405026       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.714744366049       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.714744493341       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.714744558653       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.714744575021       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.714744575038       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.714744575151       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.714744575534       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714744575566       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.714744575619       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 2.992411e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.764655 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0318e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_01                 1.397850e-01 3 1  ON 0
ci_02                -3.728575e-02 3 1  ON 1
ci_03                -3.708489e-02 3 1  ON 2
ci_04                 3.345922e-02 3 1  ON 3
ci_05                -2.698204e-02 3 1  ON 4
ci_06                -2.645812e-02 3 1  ON 5
ci_07                 2.800164e-02 3 1  ON 6
ci_08                -9.163145e-03 3 1  ON 7
ci_09                -1.145546e-02 3 1  ON 8
ci_10                -1.131900e-02 3 1  ON 9
ci_11                 1.368857e-02 3 1  ON 10
ci_12                 8.865203e-03 3 1  ON 11
ci_13                 1.257917e-02 3 1  ON 12
ci_14                 1.246421e-02 3 1  ON 13
ci_15                 8.449000e-03 3 1  ON 14
ci_16                 8.471699e-03 3 1  ON 15
ci_17                -8.691364e-03 3 1  ON 16
ci_18                -8.222486e-03 3 1  ON 17
ci_19                 9.822234e-03 3 1  ON 18
ci_20                 7.629603e-03 3 1  ON 19
ci_21                 9.093572e-03 3 1  ON 20
ci_22                 9.169228e-03 3 1  ON 21
ci_23                 5.261566e-03 3 1  ON 22
ci_24                 4.790367e-03 3 1  ON 23
ci_25                 3.543396e-03 3 1  ON 24
ci_26                 3.550241e-03 3 1  ON 25
ci_27                 3.611129e-03 3 1  ON 26
ci_28                 2.574404e-03 3 1  ON 27
ci_29                 2.572393e-03 3 1  ON 28
ci_30                -2.148184e-03 3 1  ON 29
ci_31                -2.276954e-03 3 1  ON 30
ci_32                -1.604351e-03 3 1  ON 31
ci_33                -1.596925e-03 3 1  ON 32
ci_34                 1.452730e-03 3 1  ON 33
ci_35                 1.536294e-03 3 1  ON 34
ci_36                -1.435219e-03 3 1  ON 35
ci_37                -1.489619e-03 3 1  ON 36
ci_38                -1.006122e-03 3 1  ON 37
ci_39                -1.065745e-03 3 1  ON 38
ci_40                -1.645061e-03 3 1  ON 39
ci_41                -1.212181e-03 3 1  ON 40
ci_42                -1.021129e-03 3 1  ON 41
ci_43                -2.433187e-03 3 1  ON 42
ci_44                -1.685354e-03 3 1  ON 43
ci_45                -9.174505e-04 3 1  ON 44
ci_46                -8.128727e-04 3 1  ON 45
ci_47                -1.297930e-05 3 1  ON 46
ci_48                -1.587706e-04 3 1  ON 47
ci_49                -1.177120e-03 3 1  ON 48
ci_50                -8.973865e-04 3 1  ON 49
ci_51                 7.253765e-04 3 1  ON 50
ci_52                 6.272190e-04 3 1  ON 51
ci_53                -1.020204e-03 3 1  ON 52
ci_54                -9.614456e-04 3 1  ON 53
ci_55                -6.479863e-04 3 1  ON 54
ci_56                 1.731636e-03 3 1  ON 55
ci_57                 1.718500e-03 3 1  ON 56
ci_58                -9.592279e-04 3 1  ON 57
ci_59                -8.990929e-04 3 1  ON 58
ci_60                 7.200941e-04 3 1  ON 59
ci_61                 7.980609e-04 3 1  ON 60
ci_62                -5.654344e-04 3 1  ON 61
ci_63                -7.517287e-04 3 1  ON 62
ci_64                -5.691604e-04 3 1  ON 63
ci_65                -4.230522e-04 3 1  ON 64
ci_66                -8.038578e-04 3 1  ON 65
ci_67                -6.817108e-04 3 1  ON 66
ci_68                -3.854197e-04 3 1  ON 67
ci_69                -2.284029e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.7803
    reference variance = 0.403413
====================================================
  Execution time = 2.5098e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.8937e-01
  Total weights = 1.9640e+06
  Execution time = 3.5911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474283214264
                                         uncertainty =       0.002705733820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474283214264
                                         uncertainty =       0.002705733820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486957357
  error estimate for blocks of size 2^( 2) =       0.000507934594
  error estimate for blocks of size 2^( 3) =       0.000528344583
  error estimate for blocks of size 2^( 4) =       0.000542994968
  error estimate for blocks of size 2^( 5) =       0.000552626071
  error estimate for blocks of size 2^( 6) =       0.000555689454
  error estimate for blocks of size 2^( 7) =       0.000561313857

      target function =      -0.714412577972
              le_mean =     -22.817424109732
             les_mean =     521.124401803624
             stat err =       0.000553156087
             autocorr =       1.290367836625
   target nu stat err =       0.000553156087
   target dn stat err =       0.003781640851
      target stat err =       0.002752404300
              std dev =       0.688661698248
             le_variance =       0.474254934634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474007098252
                                         uncertainty =       0.002709205464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474007098252
                                         uncertainty =       0.002709205464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486815682
  error estimate for blocks of size 2^( 2) =       0.000507798305
  error estimate for blocks of size 2^( 3) =       0.000528214370
  error estimate for blocks of size 2^( 4) =       0.000542873716
  error estimate for blocks of size 2^( 5) =       0.000552509506
  error estimate for blocks of size 2^( 6) =       0.000555571502
  error estimate for blocks of size 2^( 7) =       0.000561206554

      target function =      -0.714654331528
              le_mean =     -22.817427473668
             les_mean =     521.124216391516
             stat err =       0.000553040320
             autocorr =       1.290578631862
   target nu stat err =       0.000553040320
   target dn stat err =       0.003794084705
      target stat err =       0.002762919318
              std dev =       0.688461339761
             le_variance =       0.473979016345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474139607745
                                         uncertainty =       0.002707419556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474139607745
                                         uncertainty =       0.002707419556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486883678
  error estimate for blocks of size 2^( 2) =       0.000507863629
  error estimate for blocks of size 2^( 3) =       0.000528276683
  error estimate for blocks of size 2^( 4) =       0.000542931605
  error estimate for blocks of size 2^( 5) =       0.000552565060
  error estimate for blocks of size 2^( 6) =       0.000555627740
  error estimate for blocks of size 2^( 7) =       0.000561257603

      target function =      -0.714598373173
              le_mean =     -22.817425479834
             les_mean =     521.124203830935
             stat err =       0.000553095502
             autocorr =       1.290475674710
   target nu stat err =       0.000553095502
   target dn stat err =       0.003786256570
      target stat err =       0.002757026676
              std dev =       0.688557500065
             le_variance =       0.474111430896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474264886669
                                         uncertainty =       0.002705940235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474264886669
                                         uncertainty =       0.002705940235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486947954
  error estimate for blocks of size 2^( 2) =       0.000507925521
  error estimate for blocks of size 2^( 3) =       0.000528335885
  error estimate for blocks of size 2^( 4) =       0.000542986764
  error estimate for blocks of size 2^( 5) =       0.000552618033
  error estimate for blocks of size 2^( 6) =       0.000555681282
  error estimate for blocks of size 2^( 7) =       0.000561306125

      target function =      -0.712578567786
              le_mean =     -22.817424288503
             les_mean =     521.126981443483
             stat err =       0.000553148051
             autocorr =       1.290380174596
   target nu stat err =       0.000553148051
   target dn stat err =       0.004654773838
      target stat err =       0.003347651746
              std dev =       0.688648400960
             le_variance =       0.474236620144


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.714412577972        initial
     1.4901e+00     1.4901e+01             4.7113e-04        -0.714654331528  <--
     5.9605e+00     5.9605e+01             1.1931e-04        -0.714598373173
     2.3842e+01     2.3842e+02             2.9924e-05        -0.712578567786

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 4.3079e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_01                 1.394332e-01 3 1  ON 0
ci_02                -3.702794e-02 3 1  ON 1
ci_03                -3.682995e-02 3 1  ON 2
ci_04                 3.316162e-02 3 1  ON 3
ci_05                -2.677613e-02 3 1  ON 4
ci_06                -2.633398e-02 3 1  ON 5
ci_07                 2.796222e-02 3 1  ON 6
ci_08                -9.032986e-03 3 1  ON 7
ci_09                -1.136772e-02 3 1  ON 8
ci_10                -1.124980e-02 3 1  ON 9
ci_11                 1.364654e-02 3 1  ON 10
ci_12                 8.804856e-03 3 1  ON 11
ci_13                 1.257349e-02 3 1  ON 12
ci_14                 1.251389e-02 3 1  ON 13
ci_15                 8.303108e-03 3 1  ON 14
ci_16                 8.403781e-03 3 1  ON 15
ci_17                -8.643329e-03 3 1  ON 16
ci_18                -8.214699e-03 3 1  ON 17
ci_19                 9.796958e-03 3 1  ON 18
ci_20                 7.598042e-03 3 1  ON 19
ci_21                 9.093484e-03 3 1  ON 20
ci_22                 9.192565e-03 3 1  ON 21
ci_23                 5.246609e-03 3 1  ON 22
ci_24                 4.768373e-03 3 1  ON 23
ci_25                 3.513844e-03 3 1  ON 24
ci_26                 3.541190e-03 3 1  ON 25
ci_27                 3.601135e-03 3 1  ON 26
ci_28                 2.558329e-03 3 1  ON 27
ci_29                 2.551749e-03 3 1  ON 28
ci_30                -2.152647e-03 3 1  ON 29
ci_31                -2.234146e-03 3 1  ON 30
ci_32                -1.580021e-03 3 1  ON 31
ci_33                -1.562089e-03 3 1  ON 32
ci_34                 1.448773e-03 3 1  ON 33
ci_35                 1.501159e-03 3 1  ON 34
ci_36                -1.417247e-03 3 1  ON 35
ci_37                -1.456405e-03 3 1  ON 36
ci_38                -9.906083e-04 3 1  ON 37
ci_39                -1.031182e-03 3 1  ON 38
ci_40                -1.631005e-03 3 1  ON 39
ci_41                -1.208915e-03 3 1  ON 40
ci_42                -9.962993e-04 3 1  ON 41
ci_43                -2.398107e-03 3 1  ON 42
ci_44                -1.688002e-03 3 1  ON 43
ci_45                -9.097831e-04 3 1  ON 44
ci_46                -7.981995e-04 3 1  ON 45
ci_47                 1.471458e-05 3 1  ON 46
ci_48                -1.230999e-04 3 1  ON 47
ci_49                -1.164330e-03 3 1  ON 48
ci_50                -9.003785e-04 3 1  ON 49
ci_51                 6.965141e-04 3 1  ON 50
ci_52                 6.108755e-04 3 1  ON 51
ci_53                -1.031462e-03 3 1  ON 52
ci_54                -9.827767e-04 3 1  ON 53
ci_55                -6.316021e-04 3 1  ON 54
ci_56                 1.743687e-03 3 1  ON 55
ci_57                 1.713688e-03 3 1  ON 56
ci_58                -9.528819e-04 3 1  ON 57
ci_59                -9.236725e-04 3 1  ON 58
ci_60                 7.154797e-04 3 1  ON 59
ci_61                 7.957373e-04 3 1  ON 60
ci_62                -5.488306e-04 3 1  ON 61
ci_63                -7.369853e-04 3 1  ON 62
ci_64                -5.609170e-04 3 1  ON 63
ci_65                -4.383784e-04 3 1  ON 64
ci_66                -8.067606e-04 3 1  ON 65
ci_67                -6.973347e-04 3 1  ON 66
ci_68                -3.957395e-04 3 1  ON 67
ci_69                -2.583443e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3403e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.9167
    reference variance = 0.387423
====================================================
  Execution time = 2.5621e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9313e-01
  Total weights = 1.963340483e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6046e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477651222250
                                         uncertainty =       0.003894917969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477651222250
                                         uncertainty =       0.003894917969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488647872
  error estimate for blocks of size 2^( 2) =       0.000509434160
  error estimate for blocks of size 2^( 3) =       0.000529281276
  error estimate for blocks of size 2^( 4) =       0.000544072215
  error estimate for blocks of size 2^( 5) =       0.000553681612
  error estimate for blocks of size 2^( 6) =       0.000558638583
  error estimate for blocks of size 2^( 7) =       0.000558703287

      target function =      -0.711870249995
              le_mean =     -22.817611833102
             les_mean =     521.136538268484
             stat err =       0.000553773924
             autocorr =       1.284319219059
   target nu stat err =       0.000553773924
   target dn stat err =       0.005303415050
      target stat err =       0.003795909040
              std dev =       0.691052447149
             le_variance =       0.477553484711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281761183310e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711889560290       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712207858548       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712260503868       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712270940809       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712276214847       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712278865364       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712279133233       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712279140180       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712279175717       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712279180921       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.712279183463       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 1.711216e-03

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711889560290       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711976422819       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711990369355       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711993075990       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711994408649       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711995037661       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711995091504       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711995091057       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711995099241       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711995100275       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 4.496567e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.711889560290       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.711911784472       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.711915323075       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.711916005794       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.711916339497       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711916494263       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.711916506861       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.711916506617       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.711916508616       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.711916508859       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 1.138782e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.768424 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0235e+01
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_01                 1.389835e-01 3 1  ON 0
ci_02                -3.668382e-02 3 1  ON 1
ci_03                -3.643980e-02 3 1  ON 2
ci_04                 3.279641e-02 3 1  ON 3
ci_05                -2.657944e-02 3 1  ON 4
ci_06                -2.611956e-02 3 1  ON 5
ci_07                 2.789483e-02 3 1  ON 6
ci_08                -8.856828e-03 3 1  ON 7
ci_09                -1.127457e-02 3 1  ON 8
ci_10                -1.113683e-02 3 1  ON 9
ci_11                 1.359307e-02 3 1  ON 10
ci_12                 8.768251e-03 3 1  ON 11
ci_13                 1.253899e-02 3 1  ON 12
ci_14                 1.252708e-02 3 1  ON 13
ci_15                 8.323744e-03 3 1  ON 14
ci_16                 8.303124e-03 3 1  ON 15
ci_17                -8.573312e-03 3 1  ON 16
ci_18                -8.122039e-03 3 1  ON 17
ci_19                 9.799384e-03 3 1  ON 18
ci_20                 7.596811e-03 3 1  ON 19
ci_21                 9.055017e-03 3 1  ON 20
ci_22                 9.180170e-03 3 1  ON 21
ci_23                 5.198930e-03 3 1  ON 22
ci_24                 4.709349e-03 3 1  ON 23
ci_25                 3.460829e-03 3 1  ON 24
ci_26                 3.542375e-03 3 1  ON 25
ci_27                 3.560308e-03 3 1  ON 26
ci_28                 2.509465e-03 3 1  ON 27
ci_29                 2.519012e-03 3 1  ON 28
ci_30                -2.139098e-03 3 1  ON 29
ci_31                -2.158488e-03 3 1  ON 30
ci_32                -1.529185e-03 3 1  ON 31
ci_33                -1.563237e-03 3 1  ON 32
ci_34                 1.397036e-03 3 1  ON 33
ci_35                 1.464271e-03 3 1  ON 34
ci_36                -1.386125e-03 3 1  ON 35
ci_37                -1.453501e-03 3 1  ON 36
ci_38                -1.003749e-03 3 1  ON 37
ci_39                -1.001339e-03 3 1  ON 38
ci_40                -1.629314e-03 3 1  ON 39
ci_41                -1.207840e-03 3 1  ON 40
ci_42                -9.790809e-04 3 1  ON 41
ci_43                -2.338180e-03 3 1  ON 42
ci_44                -1.730881e-03 3 1  ON 43
ci_45                -8.764772e-04 3 1  ON 44
ci_46                -7.616128e-04 3 1  ON 45
ci_47                 2.123909e-05 3 1  ON 46
ci_48                -1.914555e-05 3 1  ON 47
ci_49                -1.159244e-03 3 1  ON 48
ci_50                -9.041945e-04 3 1  ON 49
ci_51                 7.564624e-04 3 1  ON 50
ci_52                 5.987725e-04 3 1  ON 51
ci_53                -1.051415e-03 3 1  ON 52
ci_54                -9.622165e-04 3 1  ON 53
ci_55                -6.030937e-04 3 1  ON 54
ci_56                 1.746846e-03 3 1  ON 55
ci_57                 1.734393e-03 3 1  ON 56
ci_58                -9.157835e-04 3 1  ON 57
ci_59                -9.746603e-04 3 1  ON 58
ci_60                 6.928831e-04 3 1  ON 59
ci_61                 8.020652e-04 3 1  ON 60
ci_62                -5.452341e-04 3 1  ON 61
ci_63                -7.281935e-04 3 1  ON 62
ci_64                -5.617182e-04 3 1  ON 63
ci_65                -4.213294e-04 3 1  ON 64
ci_66                -7.578792e-04 3 1  ON 65
ci_67                -6.546795e-04 3 1  ON 66
ci_68                -4.025150e-04 3 1  ON 67
ci_69                -3.253755e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.8269
    reference variance = 0.399315
====================================================
  Execution time = 2.5134e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9105e-01
  Total weights = 1.9636e+06
  Execution time = 3.5680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474103804469
                                         uncertainty =       0.002621797282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474103804469
                                         uncertainty =       0.002621797282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486858368
  error estimate for blocks of size 2^( 2) =       0.000507641673
  error estimate for blocks of size 2^( 3) =       0.000528202826
  error estimate for blocks of size 2^( 4) =       0.000543637028
  error estimate for blocks of size 2^( 5) =       0.000552748126
  error estimate for blocks of size 2^( 6) =       0.000556396706
  error estimate for blocks of size 2^( 7) =       0.000558694432

      target function =      -0.712619045959
              le_mean =     -22.817465405223
             les_mean =     521.128805161373
             stat err =       0.000552869073
             autocorr =       1.289553354501
   target nu stat err =       0.000552869073
   target dn stat err =       0.004289830353
      target stat err =       0.003093048352
              std dev =       0.688521706612
             le_variance =       0.474062140476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473893289561
                                         uncertainty =       0.002665275665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473893289561
                                         uncertainty =       0.002665275665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486750429
  error estimate for blocks of size 2^( 2) =       0.000507529244
  error estimate for blocks of size 2^( 3) =       0.000528111228
  error estimate for blocks of size 2^( 4) =       0.000543586358
  error estimate for blocks of size 2^( 5) =       0.000552743111
  error estimate for blocks of size 2^( 6) =       0.000556397588
  error estimate for blocks of size 2^( 7) =       0.000558705660

      target function =      -0.689653317632
              le_mean =     -22.817445815001
             les_mean =     521.160711229496
             stat err =       0.000552858179
             autocorr =       1.290074504594
   target nu stat err =       0.000552858179
   target dn stat err =       0.026294119397
      target stat err =       0.017491370811
              std dev =       0.688369058358
             le_variance =       0.473851960505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473590164367
                                         uncertainty =       0.002619271759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473590164367
                                         uncertainty =       0.002619271759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486594485
  error estimate for blocks of size 2^( 2) =       0.000507384830
  error estimate for blocks of size 2^( 3) =       0.000527958424
  error estimate for blocks of size 2^( 4) =       0.000543407661
  error estimate for blocks of size 2^( 5) =       0.000552527596
  error estimate for blocks of size 2^( 6) =       0.000556169878
  error estimate for blocks of size 2^( 7) =       0.000558479412

      target function =      -0.713112241399
              le_mean =     -22.817459144492
             les_mean =     521.127822914528
             stat err =       0.000552646137
             autocorr =       1.289911494574
   target nu stat err =       0.000552646137
   target dn stat err =       0.004484466153
      target stat err =       0.003233378797
              std dev =       0.688148519885
             le_variance =       0.473548385419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474032178077
                                         uncertainty =       0.002621549884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474032178077
                                         uncertainty =       0.002621549884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486821578
  error estimate for blocks of size 2^( 2) =       0.000507605753
  error estimate for blocks of size 2^( 3) =       0.000528168400
  error estimate for blocks of size 2^( 4) =       0.000543604372
  error estimate for blocks of size 2^( 5) =       0.000552715207
  error estimate for blocks of size 2^( 6) =       0.000556363036
  error estimate for blocks of size 2^( 7) =       0.000558661191

      target function =      -0.713125652821
              le_mean =     -22.817464043374
             les_mean =     521.128029525845
             stat err =       0.000552835952
             autocorr =       1.289593738743
   target nu stat err =       0.000552835952
   target dn stat err =       0.004278975665
      target stat err =       0.003089776819
              std dev =       0.688469678692
             le_variance =       0.473990498478


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.712619045959        initial
     3.7253e-01     3.7253e+00             1.7112e-03        -0.689653317632
     1.4901e+00     1.4901e+01             4.4966e-04        -0.713112241399
     5.9605e+00     5.9605e+01             1.1388e-04        -0.713125652821  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 4.3028e+01
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_01                 1.393193e-01 3 1  ON 0
ci_02                -3.694008e-02 3 1  ON 1
ci_03                -3.673036e-02 3 1  ON 2
ci_04                 3.306810e-02 3 1  ON 3
ci_05                -2.672582e-02 3 1  ON 4
ci_06                -2.627915e-02 3 1  ON 5
ci_07                 2.794505e-02 3 1  ON 6
ci_08                -8.987902e-03 3 1  ON 7
ci_09                -1.134401e-02 3 1  ON 8
ci_10                -1.122102e-02 3 1  ON 9
ci_11                 1.363286e-02 3 1  ON 10
ci_12                 8.795500e-03 3 1  ON 11
ci_13                 1.256467e-02 3 1  ON 12
ci_14                 1.251723e-02 3 1  ON 13
ci_15                 8.308367e-03 3 1  ON 14
ci_16                 8.378101e-03 3 1  ON 15
ci_17                -8.625492e-03 3 1  ON 16
ci_18                -8.191106e-03 3 1  ON 17
ci_19                 9.797556e-03 3 1  ON 18
ci_20                 7.597717e-03 3 1  ON 19
ci_21                 9.083730e-03 3 1  ON 20
ci_22                 9.189344e-03 3 1  ON 21
ci_23                 5.234383e-03 3 1  ON 22
ci_24                 4.753375e-03 3 1  ON 23
ci_25                 3.500271e-03 3 1  ON 24
ci_26                 3.541461e-03 3 1  ON 25
ci_27                 3.590710e-03 3 1  ON 26
ci_28                 2.545900e-03 3 1  ON 27
ci_29                 2.543399e-03 3 1  ON 28
ci_30                -2.149261e-03 3 1  ON 29
ci_31                -2.214955e-03 3 1  ON 30
ci_32                -1.566977e-03 3 1  ON 31
ci_33                -1.562355e-03 3 1  ON 32
ci_34                 1.435506e-03 3 1  ON 33
ci_35                 1.491680e-03 3 1  ON 34
ci_36                -1.409296e-03 3 1  ON 35
ci_37                -1.455667e-03 3 1  ON 36
ci_38                -9.939893e-04 3 1  ON 37
ci_39                -1.023559e-03 3 1  ON 38
ci_40                -1.630580e-03 3 1  ON 39
ci_41                -1.208602e-03 3 1  ON 40
ci_42                -9.918652e-04 3 1  ON 41
ci_43                -2.382860e-03 3 1  ON 42
ci_44                -1.698990e-03 3 1  ON 43
ci_45                -9.012684e-04 3 1  ON 44
ci_46                -7.888486e-04 3 1  ON 45
ci_47                 1.633385e-05 3 1  ON 46
ci_48                -9.669185e-05 3 1  ON 47
ci_49                -1.163037e-03 3 1  ON 48
ci_50                -9.013595e-04 3 1  ON 49
ci_51                 7.118808e-04 3 1  ON 50
ci_52                 6.077990e-04 3 1  ON 51
ci_53                -1.036597e-03 3 1  ON 52
ci_54                -9.775114e-04 3 1  ON 53
ci_55                -6.243208e-04 3 1  ON 54
ci_56                 1.744496e-03 3 1  ON 55
ci_57                 1.718988e-03 3 1  ON 56
ci_58                -9.433952e-04 3 1  ON 57
ci_59                -9.367053e-04 3 1  ON 58
ci_60                 7.097819e-04 3 1  ON 59
ci_61                 7.973438e-04 3 1  ON 60
ci_62                -5.479210e-04 3 1  ON 61
ci_63                -7.347529e-04 3 1  ON 62
ci_64                -5.611453e-04 3 1  ON 63
ci_65                -4.340266e-04 3 1  ON 64
ci_66                -7.942479e-04 3 1  ON 65
ci_67                -6.864209e-04 3 1  ON 66
ci_68                -3.974666e-04 3 1  ON 67
ci_69                -2.754635e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3269e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.8424
    reference variance = 0.323108
====================================================
  Execution time = 2.5724e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 5.0267e-01
  Total weights = 1.963828746e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485243836685
                                         uncertainty =       0.011913697803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485243836685
                                         uncertainty =       0.011913697803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492501516
  error estimate for blocks of size 2^( 2) =       0.000513344845
  error estimate for blocks of size 2^( 3) =       0.000533053548
  error estimate for blocks of size 2^( 4) =       0.000548160045
  error estimate for blocks of size 2^( 5) =       0.000557846693
  error estimate for blocks of size 2^( 6) =       0.000563753848
  error estimate for blocks of size 2^( 7) =       0.000565402921

      target function =      -0.705068446440
              le_mean =     -22.818146267944
             les_mean =     521.170464312797
             stat err =       0.000558790877
             autocorr =       1.287310972627
   target nu stat err =       0.000558790877
   target dn stat err =       0.014135705721
      target stat err =       0.009844500577
              std dev =       0.696502323191
             le_variance =       0.485115486210


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281814626794e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705203933029       residual = 3.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705366101246       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705387437963       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705391483630       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705392291330       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705392507062       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705392589718       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705392597858       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705392601895       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705392599293       residual = 9.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 5.755276e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705203933029       residual = 3.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705245437799       residual = 3.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705250851695       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705251865686       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705252064258       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705252116136       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705252136225       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705252138158       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705252139126       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705252138472       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 1.456337e-04

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.705203933029       residual = 3.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.705214371168       residual = 3.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.705215729692       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.705215983331       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.705216032754       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.705216045593       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.705216050579       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.705216051056       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.705216051295       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.705216051132       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 3.651965e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.772001 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0348e+01
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_01                 1.391737e-01 3 1  ON 0
ci_02                -3.686509e-02 3 1  ON 1
ci_03                -3.666269e-02 3 1  ON 2
ci_04                 3.295799e-02 3 1  ON 3
ci_05                -2.665977e-02 3 1  ON 4
ci_06                -2.620504e-02 3 1  ON 5
ci_07                 2.794634e-02 3 1  ON 6
ci_08                -8.948583e-03 3 1  ON 7
ci_09                -1.130263e-02 3 1  ON 8
ci_10                -1.120321e-02 3 1  ON 9
ci_11                 1.361844e-02 3 1  ON 10
ci_12                 8.890298e-03 3 1  ON 11
ci_13                 1.256265e-02 3 1  ON 12
ci_14                 1.250907e-02 3 1  ON 13
ci_15                 8.275441e-03 3 1  ON 14
ci_16                 8.318904e-03 3 1  ON 15
ci_17                -8.630174e-03 3 1  ON 16
ci_18                -8.171677e-03 3 1  ON 17
ci_19                 9.767773e-03 3 1  ON 18
ci_20                 7.591315e-03 3 1  ON 19
ci_21                 9.089780e-03 3 1  ON 20
ci_22                 9.175619e-03 3 1  ON 21
ci_23                 5.228792e-03 3 1  ON 22
ci_24                 4.754664e-03 3 1  ON 23
ci_25                 3.490721e-03 3 1  ON 24
ci_26                 3.464915e-03 3 1  ON 25
ci_27                 3.552240e-03 3 1  ON 26
ci_28                 2.539439e-03 3 1  ON 27
ci_29                 2.498865e-03 3 1  ON 28
ci_30                -2.141892e-03 3 1  ON 29
ci_31                -2.209757e-03 3 1  ON 30
ci_32                -1.551234e-03 3 1  ON 31
ci_33                -1.534023e-03 3 1  ON 32
ci_34                 1.444222e-03 3 1  ON 33
ci_35                 1.521457e-03 3 1  ON 34
ci_36                -1.412327e-03 3 1  ON 35
ci_37                -1.460101e-03 3 1  ON 36
ci_38                -9.869100e-04 3 1  ON 37
ci_39                -1.024260e-03 3 1  ON 38
ci_40                -1.636951e-03 3 1  ON 39
ci_41                -1.209055e-03 3 1  ON 40
ci_42                -9.735485e-04 3 1  ON 41
ci_43                -2.373200e-03 3 1  ON 42
ci_44                -1.666483e-03 3 1  ON 43
ci_45                -8.982333e-04 3 1  ON 44
ci_46                -7.885127e-04 3 1  ON 45
ci_47                 2.759099e-05 3 1  ON 46
ci_48                -9.253468e-05 3 1  ON 47
ci_49                -1.157991e-03 3 1  ON 48
ci_50                -8.987744e-04 3 1  ON 49
ci_51                 7.159023e-04 3 1  ON 50
ci_52                 5.942830e-04 3 1  ON 51
ci_53                -1.039163e-03 3 1  ON 52
ci_54                -9.793917e-04 3 1  ON 53
ci_55                -6.265596e-04 3 1  ON 54
ci_56                 1.739525e-03 3 1  ON 55
ci_57                 1.722009e-03 3 1  ON 56
ci_58                -9.494870e-04 3 1  ON 57
ci_59                -9.279971e-04 3 1  ON 58
ci_60                 7.019522e-04 3 1  ON 59
ci_61                 7.905157e-04 3 1  ON 60
ci_62                -5.422306e-04 3 1  ON 61
ci_63                -7.101375e-04 3 1  ON 62
ci_64                -5.586526e-04 3 1  ON 63
ci_65                -4.355331e-04 3 1  ON 64
ci_66                -7.933885e-04 3 1  ON 65
ci_67                -6.751048e-04 3 1  ON 66
ci_68                -4.353979e-04 3 1  ON 67
ci_69                -2.810832e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.8107
    reference variance = 0.687935
====================================================
  Execution time = 2.4980e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9595e-01
  Total weights = 1.9635e+06
  Execution time = 3.5724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479962491974
                                         uncertainty =       0.003141531926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479962491974
                                         uncertainty =       0.003141531926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489861928
  error estimate for blocks of size 2^( 2) =       0.000510305669
  error estimate for blocks of size 2^( 3) =       0.000529816501
  error estimate for blocks of size 2^( 4) =       0.000544449734
  error estimate for blocks of size 2^( 5) =       0.000554457529
  error estimate for blocks of size 2^( 6) =       0.000559922825
  error estimate for blocks of size 2^( 7) =       0.000562289994

      target function =      -0.709601541016
              le_mean =     -22.818741909552
             les_mean =     521.191358807714
             stat err =       0.000555280020
             autocorr =       1.284921863767
   target nu stat err =       0.000555280020
   target dn stat err =       0.004202400421
      target stat err =       0.003012632007
              std dev =       0.692769382857
             le_variance =       0.479929417825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479610259568
                                         uncertainty =       0.003130543456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479610259568
                                         uncertainty =       0.003130543456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489682166
  error estimate for blocks of size 2^( 2) =       0.000510134856
  error estimate for blocks of size 2^( 3) =       0.000529654866
  error estimate for blocks of size 2^( 4) =       0.000544294079
  error estimate for blocks of size 2^( 5) =       0.000554304329
  error estimate for blocks of size 2^( 6) =       0.000559786745
  error estimate for blocks of size 2^( 7) =       0.000562159403

      target function =      -0.709522813040
              le_mean =     -22.818740249510
             les_mean =     521.191394645956
             stat err =       0.000555136139
             autocorr =       1.285199137096
   target nu stat err =       0.000555136139
   target dn stat err =       0.004214731320
      target stat err =       0.003020484002
              std dev =       0.692515161007
             le_variance =       0.479577248225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479778230856
                                         uncertainty =       0.003135805438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479778230856
                                         uncertainty =       0.003135805438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489767901
  error estimate for blocks of size 2^( 2) =       0.000510216107
  error estimate for blocks of size 2^( 3) =       0.000529731632
  error estimate for blocks of size 2^( 4) =       0.000544367956
  error estimate for blocks of size 2^( 5) =       0.000554377078
  error estimate for blocks of size 2^( 6) =       0.000559850882
  error estimate for blocks of size 2^( 7) =       0.000562220907

      target function =      -0.709892175985
              le_mean =     -22.818740457182
             les_mean =     521.190880621286
             stat err =       0.000555204206
             autocorr =       1.285064299151
   target nu stat err =       0.000555204206
   target dn stat err =       0.004160496267
      target stat err =       0.002985984974
              std dev =       0.692636407303
             le_variance =       0.479745192722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479938823713
                                         uncertainty =       0.003140800013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479938823713
                                         uncertainty =       0.003140800013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489849852
  error estimate for blocks of size 2^( 2) =       0.000510294151
  error estimate for blocks of size 2^( 3) =       0.000529805563
  error estimate for blocks of size 2^( 4) =       0.000544439179
  error estimate for blocks of size 2^( 5) =       0.000554447137
  error estimate for blocks of size 2^( 6) =       0.000559913495
  error estimate for blocks of size 2^( 7) =       0.000562281003

      target function =      -0.709715334456
              le_mean =     -22.818741650189
             les_mean =     521.191185683923
             stat err =       0.000555270204
             autocorr =       1.284939786772
   target nu stat err =       0.000555270204
   target dn stat err =       0.004183419707
      target stat err =       0.003000424520
              std dev =       0.692752303876
             le_variance =       0.479905754526


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709601541016        initial
     1.4901e+00     1.4901e+01             5.7553e-04        -0.709522813040
     5.9605e+00     5.9605e+01             1.4563e-04        -0.709892175985  <--
     2.3842e+01     2.3842e+02             3.6520e-05        -0.709715334456

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 4.2896e+01
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_01                 1.391737e-01 3 1  ON 0
ci_02                -3.686509e-02 3 1  ON 1
ci_03                -3.666269e-02 3 1  ON 2
ci_04                 3.295799e-02 3 1  ON 3
ci_05                -2.665977e-02 3 1  ON 4
ci_06                -2.620504e-02 3 1  ON 5
ci_07                 2.794634e-02 3 1  ON 6
ci_08                -8.948583e-03 3 1  ON 7
ci_09                -1.130263e-02 3 1  ON 8
ci_10                -1.120321e-02 3 1  ON 9
ci_11                 1.361844e-02 3 1  ON 10
ci_12                 8.890298e-03 3 1  ON 11
ci_13                 1.256265e-02 3 1  ON 12
ci_14                 1.250907e-02 3 1  ON 13
ci_15                 8.275441e-03 3 1  ON 14
ci_16                 8.318904e-03 3 1  ON 15
ci_17                -8.630174e-03 3 1  ON 16
ci_18                -8.171677e-03 3 1  ON 17
ci_19                 9.767773e-03 3 1  ON 18
ci_20                 7.591315e-03 3 1  ON 19
ci_21                 9.089780e-03 3 1  ON 20
ci_22                 9.175619e-03 3 1  ON 21
ci_23                 5.228792e-03 3 1  ON 22
ci_24                 4.754664e-03 3 1  ON 23
ci_25                 3.490721e-03 3 1  ON 24
ci_26                 3.464915e-03 3 1  ON 25
ci_27                 3.552240e-03 3 1  ON 26
ci_28                 2.539439e-03 3 1  ON 27
ci_29                 2.498865e-03 3 1  ON 28
ci_30                -2.141892e-03 3 1  ON 29
ci_31                -2.209757e-03 3 1  ON 30
ci_32                -1.551234e-03 3 1  ON 31
ci_33                -1.534023e-03 3 1  ON 32
ci_34                 1.444222e-03 3 1  ON 33
ci_35                 1.521457e-03 3 1  ON 34
ci_36                -1.412327e-03 3 1  ON 35
ci_37                -1.460101e-03 3 1  ON 36
ci_38                -9.869100e-04 3 1  ON 37
ci_39                -1.024260e-03 3 1  ON 38
ci_40                -1.636951e-03 3 1  ON 39
ci_41                -1.209055e-03 3 1  ON 40
ci_42                -9.735485e-04 3 1  ON 41
ci_43                -2.373200e-03 3 1  ON 42
ci_44                -1.666483e-03 3 1  ON 43
ci_45                -8.982333e-04 3 1  ON 44
ci_46                -7.885127e-04 3 1  ON 45
ci_47                 2.759099e-05 3 1  ON 46
ci_48                -9.253468e-05 3 1  ON 47
ci_49                -1.157991e-03 3 1  ON 48
ci_50                -8.987744e-04 3 1  ON 49
ci_51                 7.159023e-04 3 1  ON 50
ci_52                 5.942830e-04 3 1  ON 51
ci_53                -1.039163e-03 3 1  ON 52
ci_54                -9.793917e-04 3 1  ON 53
ci_55                -6.265596e-04 3 1  ON 54
ci_56                 1.739525e-03 3 1  ON 55
ci_57                 1.722009e-03 3 1  ON 56
ci_58                -9.494870e-04 3 1  ON 57
ci_59                -9.279971e-04 3 1  ON 58
ci_60                 7.019522e-04 3 1  ON 59
ci_61                 7.905157e-04 3 1  ON 60
ci_62                -5.422306e-04 3 1  ON 61
ci_63                -7.101375e-04 3 1  ON 62
ci_64                -5.586526e-04 3 1  ON 63
ci_65                -4.355331e-04 3 1  ON 64
ci_66                -7.933885e-04 3 1  ON 65
ci_67                -6.751048e-04 3 1  ON 66
ci_68                -4.353979e-04 3 1  ON 67
ci_69                -2.810832e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3250e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.8709
    reference variance = 0.990484
====================================================
  Execution time = 2.5759e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8221e-01
  Total weights = 1.963839417e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469200042874
                                         uncertainty =       0.002078867786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469200042874
                                         uncertainty =       0.002078867786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484411662
  error estimate for blocks of size 2^( 2) =       0.000505453481
  error estimate for blocks of size 2^( 3) =       0.000525662451
  error estimate for blocks of size 2^( 4) =       0.000540928038
  error estimate for blocks of size 2^( 5) =       0.000549908390
  error estimate for blocks of size 2^( 6) =       0.000555188270
  error estimate for blocks of size 2^( 7) =       0.000557644695

      target function =      -0.719717064398
              le_mean =     -22.818120519949
             les_mean =     521.148834233371
             stat err =       0.000550917348
             autocorr =       1.293432342815
   target nu stat err =       0.000550917348
   target dn stat err =       0.002676144597
      target stat err =       0.002016255554
              std dev =       0.685061542445
             le_variance =       0.469309316937


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281812051995e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.719721921060       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.719817573073       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.719834254549       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.719837723340       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.719838689669       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.719838889008       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.719838897339       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.719838924477       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.719838922780       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.719838923210       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.719838924359       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 5.270110e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.719721921060       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.719746415044       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.719750650930       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.719751522264       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.719751761003       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.719751808918       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.719751810443       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.719751817073       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.719751816642       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.719751816747       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 1.334506e-04

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.719721921060       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.719728081970       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.719729145099       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.719729363179       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.719729422675       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.719729434532       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.719729434878       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.719729436526       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.719729436418       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.719729436444       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 3.347093e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.775907 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0332e+01
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_01                 1.390402e-01 3 1  ON 0
ci_02                -3.676654e-02 3 1  ON 1
ci_03                -3.658075e-02 3 1  ON 2
ci_04                 3.284620e-02 3 1  ON 3
ci_05                -2.660567e-02 3 1  ON 4
ci_06                -2.615538e-02 3 1  ON 5
ci_07                 2.793886e-02 3 1  ON 6
ci_08                -8.896763e-03 3 1  ON 7
ci_09                -1.127008e-02 3 1  ON 8
ci_10                -1.116541e-02 3 1  ON 9
ci_11                 1.361659e-02 3 1  ON 10
ci_12                 8.877071e-03 3 1  ON 11
ci_13                 1.255952e-02 3 1  ON 12
ci_14                 1.251318e-02 3 1  ON 13
ci_15                 8.251775e-03 3 1  ON 14
ci_16                 8.305370e-03 3 1  ON 15
ci_17                -8.616424e-03 3 1  ON 16
ci_18                -8.155183e-03 3 1  ON 17
ci_19                 9.760228e-03 3 1  ON 18
ci_20                 7.572485e-03 3 1  ON 19
ci_21                 9.085788e-03 3 1  ON 20
ci_22                 9.175212e-03 3 1  ON 21
ci_23                 5.227492e-03 3 1  ON 22
ci_24                 4.755287e-03 3 1  ON 23
ci_25                 3.480335e-03 3 1  ON 24
ci_26                 3.456356e-03 3 1  ON 25
ci_27                 3.548825e-03 3 1  ON 26
ci_28                 2.533178e-03 3 1  ON 27
ci_29                 2.474995e-03 3 1  ON 28
ci_30                -2.122719e-03 3 1  ON 29
ci_31                -2.198454e-03 3 1  ON 30
ci_32                -1.539160e-03 3 1  ON 31
ci_33                -1.540262e-03 3 1  ON 32
ci_34                 1.434057e-03 3 1  ON 33
ci_35                 1.523450e-03 3 1  ON 34
ci_36                -1.409390e-03 3 1  ON 35
ci_37                -1.454502e-03 3 1  ON 36
ci_38                -9.782887e-04 3 1  ON 37
ci_39                -1.019470e-03 3 1  ON 38
ci_40                -1.638561e-03 3 1  ON 39
ci_41                -1.208449e-03 3 1  ON 40
ci_42                -9.771164e-04 3 1  ON 41
ci_43                -2.378837e-03 3 1  ON 42
ci_44                -1.672275e-03 3 1  ON 43
ci_45                -8.961938e-04 3 1  ON 44
ci_46                -7.868492e-04 3 1  ON 45
ci_47                 3.678832e-05 3 1  ON 46
ci_48                -8.316667e-05 3 1  ON 47
ci_49                -1.143810e-03 3 1  ON 48
ci_50                -8.994909e-04 3 1  ON 49
ci_51                 7.162824e-04 3 1  ON 50
ci_52                 5.929883e-04 3 1  ON 51
ci_53                -1.038596e-03 3 1  ON 52
ci_54                -9.775777e-04 3 1  ON 53
ci_55                -6.210838e-04 3 1  ON 54
ci_56                 1.737495e-03 3 1  ON 55
ci_57                 1.715902e-03 3 1  ON 56
ci_58                -9.494920e-04 3 1  ON 57
ci_59                -9.228796e-04 3 1  ON 58
ci_60                 6.927835e-04 3 1  ON 59
ci_61                 7.941897e-04 3 1  ON 60
ci_62                -5.400396e-04 3 1  ON 61
ci_63                -7.005467e-04 3 1  ON 62
ci_64                -5.536503e-04 3 1  ON 63
ci_65                -4.327255e-04 3 1  ON 64
ci_66                -7.887930e-04 3 1  ON 65
ci_67                -6.740186e-04 3 1  ON 66
ci_68                -4.505576e-04 3 1  ON 67
ci_69                -2.874347e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.8492
    reference variance = 0.236232
====================================================
  Execution time = 2.6569e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9096e-01
  Total weights = 1.9637e+06
  Execution time = 3.6267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474847840097
                                         uncertainty =       0.003575479837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474847840097
                                         uncertainty =       0.003575479837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487197273
  error estimate for blocks of size 2^( 2) =       0.000508268298
  error estimate for blocks of size 2^( 3) =       0.000528042485
  error estimate for blocks of size 2^( 4) =       0.000543507721
  error estimate for blocks of size 2^( 5) =       0.000553120054
  error estimate for blocks of size 2^( 6) =       0.000559914411
  error estimate for blocks of size 2^( 7) =       0.000565815912

      target function =      -0.713285439953
              le_mean =     -22.817201262008
             les_mean =     521.115801780442
             stat err =       0.000555589524
             autocorr =       1.300464194546
   target nu stat err =       0.000555589524
   target dn stat err =       0.004614986734
      target stat err =       0.003325681131
              std dev =       0.689000991301
             le_variance =       0.474722366013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474522206550
                                         uncertainty =       0.003554488222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474522206550
                                         uncertainty =       0.003554488222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487030122
  error estimate for blocks of size 2^( 2) =       0.000508106547
  error estimate for blocks of size 2^( 3) =       0.000527888753
  error estimate for blocks of size 2^( 4) =       0.000543363595
  error estimate for blocks of size 2^( 5) =       0.000552985936
  error estimate for blocks of size 2^( 6) =       0.000559778067
  error estimate for blocks of size 2^( 7) =       0.000565683115

      target function =      -0.713644268451
              le_mean =     -22.817203542429
             les_mean =     521.115401599311
             stat err =       0.000555452678
             autocorr =       1.300716009824
   target nu stat err =       0.000555452678
   target dn stat err =       0.004568372435
      target stat err =       0.003296278125
              std dev =       0.688764603340
             le_variance =       0.474396678814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474678836343
                                         uncertainty =       0.003564533558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474678836343
                                         uncertainty =       0.003564533558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487110530
  error estimate for blocks of size 2^( 2) =       0.000508184291
  error estimate for blocks of size 2^( 3) =       0.000527962556
  error estimate for blocks of size 2^( 4) =       0.000543432643
  error estimate for blocks of size 2^( 5) =       0.000553049981
  error estimate for blocks of size 2^( 6) =       0.000559843233
  error estimate for blocks of size 2^( 7) =       0.000565746592

      target function =      -0.713234252916
              le_mean =     -22.817202060035
             les_mean =     521.115910347795
             stat err =       0.000555518112
             autocorr =       1.300592994584
   target nu stat err =       0.000555518112
   target dn stat err =       0.004606110377
      target stat err =       0.003318983701
              std dev =       0.688878318061
             le_variance =       0.474553337094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474826307657
                                         uncertainty =       0.003574089899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474826307657
                                         uncertainty =       0.003574089899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487186222
  error estimate for blocks of size 2^( 2) =       0.000508257588
  error estimate for blocks of size 2^( 3) =       0.000528032283
  error estimate for blocks of size 2^( 4) =       0.000543498129
  error estimate for blocks of size 2^( 5) =       0.000553111083
  error estimate for blocks of size 2^( 6) =       0.000559905285
  error estimate for blocks of size 2^( 7) =       0.000565807008

      target function =      -0.713302749395
              le_mean =     -22.817201312932
             les_mean =     521.115779779193
             stat err =       0.000555580376
             autocorr =       1.300480363733
   target nu stat err =       0.000555580376
   target dn stat err =       0.004611375273
      target stat err =       0.003323308390
              std dev =       0.688985363151
             le_variance =       0.474700830636


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.713285439953        initial
     1.4901e+00     1.4901e+01             5.2701e-04        -0.713644268451  <--
     5.9605e+00     5.9605e+01             1.3345e-04        -0.713234252916
     2.3842e+01     2.3842e+02             3.3471e-05        -0.713302749395

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 4.4649e+01
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_01                 1.386467e-01 3 1  ON 0
ci_02                -3.647933e-02 3 1  ON 1
ci_03                -3.634199e-02 3 1  ON 2
ci_04                 3.252159e-02 3 1  ON 3
ci_05                -2.644839e-02 3 1  ON 4
ci_06                -2.601097e-02 3 1  ON 5
ci_07                 2.791722e-02 3 1  ON 6
ci_08                -8.746279e-03 3 1  ON 7
ci_09                -1.117487e-02 3 1  ON 8
ci_10                -1.105496e-02 3 1  ON 9
ci_11                 1.361136e-02 3 1  ON 10
ci_12                 8.838620e-03 3 1  ON 11
ci_13                 1.255069e-02 3 1  ON 12
ci_14                 1.252569e-02 3 1  ON 13
ci_15                 8.182739e-03 3 1  ON 14
ci_16                 8.265985e-03 3 1  ON 15
ci_17                -8.576113e-03 3 1  ON 16
ci_18                -8.106833e-03 3 1  ON 17
ci_19                 9.738399e-03 3 1  ON 18
ci_20                 7.517807e-03 3 1  ON 19
ci_21                 9.074259e-03 3 1  ON 20
ci_22                 9.174153e-03 3 1  ON 21
ci_23                 5.223686e-03 3 1  ON 22
ci_24                 4.757163e-03 3 1  ON 23
ci_25                 3.450114e-03 3 1  ON 24
ci_26                 3.431552e-03 3 1  ON 25
ci_27                 3.539066e-03 3 1  ON 26
ci_28                 2.514817e-03 3 1  ON 27
ci_29                 2.405414e-03 3 1  ON 28
ci_30                -2.066484e-03 3 1  ON 29
ci_31                -2.165258e-03 3 1  ON 30
ci_32                -1.504370e-03 3 1  ON 31
ci_33                -1.558602e-03 3 1  ON 32
ci_34                 1.404753e-03 3 1  ON 33
ci_35                 1.529570e-03 3 1  ON 34
ci_36                -1.400856e-03 3 1  ON 35
ci_37                -1.438291e-03 3 1  ON 36
ci_38                -9.532317e-04 3 1  ON 37
ci_39                -1.005516e-03 3 1  ON 38
ci_40                -1.643069e-03 3 1  ON 39
ci_41                -1.206962e-03 3 1  ON 40
ci_42                -9.876653e-04 3 1  ON 41
ci_43                -2.395168e-03 3 1  ON 42
ci_44                -1.688993e-03 3 1  ON 43
ci_45                -8.902840e-04 3 1  ON 44
ci_46                -7.820739e-04 3 1  ON 45
ci_47                 6.381055e-05 3 1  ON 46
ci_48                -5.564881e-05 3 1  ON 47
ci_49                -1.102733e-03 3 1  ON 48
ci_50                -9.015274e-04 3 1  ON 49
ci_51                 7.173096e-04 3 1  ON 50
ci_52                 5.891569e-04 3 1  ON 51
ci_53                -1.037015e-03 3 1  ON 52
ci_54                -9.723049e-04 3 1  ON 53
ci_55                -6.051535e-04 3 1  ON 54
ci_56                 1.731501e-03 3 1  ON 55
ci_57                 1.698135e-03 3 1  ON 56
ci_58                -9.494832e-04 3 1  ON 57
ci_59                -9.080081e-04 3 1  ON 58
ci_60                 6.656391e-04 3 1  ON 59
ci_61                 8.051456e-04 3 1  ON 60
ci_62                -5.336198e-04 3 1  ON 61
ci_63                -6.724342e-04 3 1  ON 62
ci_64                -5.390201e-04 3 1  ON 63
ci_65                -4.246146e-04 3 1  ON 64
ci_66                -7.753536e-04 3 1  ON 65
ci_67                -6.708703e-04 3 1  ON 66
ci_68                -4.946989e-04 3 1  ON 67
ci_69                -3.060587e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4987e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.8323
    reference variance = 0.314404
====================================================
  Execution time = 2.5776e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5361e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9082e-01
  Total weights = 1.963705746e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474515254673
                                         uncertainty =       0.002612840744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474515254673
                                         uncertainty =       0.002612840744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487064045
  error estimate for blocks of size 2^( 2) =       0.000507526186
  error estimate for blocks of size 2^( 3) =       0.000527172866
  error estimate for blocks of size 2^( 4) =       0.000542263352
  error estimate for blocks of size 2^( 5) =       0.000551170696
  error estimate for blocks of size 2^( 6) =       0.000555973313
  error estimate for blocks of size 2^( 7) =       0.000559016009

      target function =      -0.713526297954
              le_mean =     -22.817734248603
             les_mean =     521.139812989972
             stat err =       0.000552105843
             autocorr =       1.284909509096
   target nu stat err =       0.000552105843
   target dn stat err =       0.003188908656
      target stat err =       0.002335002392
              std dev =       0.688812578667
             le_variance =       0.474462768530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281773424860e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713533072868       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713834016203       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713889376302       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713898041058       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713900608295       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713901546732       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713901841797       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713901737819       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713901764488       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713901757978       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713901736168       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 1.811219e-03

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713533072868       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713615294439       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713629961467       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713632155846       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713632761432       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713632977898       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713633040959       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713633015473       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713633021853       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713633019949       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713633015020       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 4.757495e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713533072868       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713554116466       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713557837937       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713558387664       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713558536343       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713558589213       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713558604268       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713558597946       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713558599522       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713558599029       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713558597834       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 1.204711e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.780000 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0385e+01
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_01                 1.381709e-01 3 1  ON 0
ci_02                -3.610546e-02 3 1  ON 1
ci_03                -3.599875e-02 3 1  ON 2
ci_04                 3.216334e-02 3 1  ON 3
ci_05                -2.621369e-02 3 1  ON 4
ci_06                -2.584728e-02 3 1  ON 5
ci_07                 2.786972e-02 3 1  ON 6
ci_08                -8.597329e-03 3 1  ON 7
ci_09                -1.104869e-02 3 1  ON 8
ci_10                -1.098136e-02 3 1  ON 9
ci_11                 1.362970e-02 3 1  ON 10
ci_12                 8.774595e-03 3 1  ON 11
ci_13                 1.255912e-02 3 1  ON 12
ci_14                 1.249012e-02 3 1  ON 13
ci_15                 8.107109e-03 3 1  ON 14
ci_16                 8.192031e-03 3 1  ON 15
ci_17                -8.476460e-03 3 1  ON 16
ci_18                -8.116685e-03 3 1  ON 17
ci_19                 9.726014e-03 3 1  ON 18
ci_20                 7.497251e-03 3 1  ON 19
ci_21                 9.078395e-03 3 1  ON 20
ci_22                 9.184312e-03 3 1  ON 21
ci_23                 5.196589e-03 3 1  ON 22
ci_24                 4.679801e-03 3 1  ON 23
ci_25                 3.442440e-03 3 1  ON 24
ci_26                 3.400098e-03 3 1  ON 25
ci_27                 3.481978e-03 3 1  ON 26
ci_28                 2.488169e-03 3 1  ON 27
ci_29                 2.382906e-03 3 1  ON 28
ci_30                -2.015939e-03 3 1  ON 29
ci_31                -2.144832e-03 3 1  ON 30
ci_32                -1.470738e-03 3 1  ON 31
ci_33                -1.511388e-03 3 1  ON 32
ci_34                 1.375932e-03 3 1  ON 33
ci_35                 1.545672e-03 3 1  ON 34
ci_36                -1.356689e-03 3 1  ON 35
ci_37                -1.425877e-03 3 1  ON 36
ci_38                -9.588758e-04 3 1  ON 37
ci_39                -9.770554e-04 3 1  ON 38
ci_40                -1.625881e-03 3 1  ON 39
ci_41                -1.136709e-03 3 1  ON 40
ci_42                -9.513676e-04 3 1  ON 41
ci_43                -2.382342e-03 3 1  ON 42
ci_44                -1.686148e-03 3 1  ON 43
ci_45                -8.846720e-04 3 1  ON 44
ci_46                -7.571324e-04 3 1  ON 45
ci_47                 1.128292e-04 3 1  ON 46
ci_48                -5.192377e-05 3 1  ON 47
ci_49                -1.081862e-03 3 1  ON 48
ci_50                -8.900138e-04 3 1  ON 49
ci_51                 6.790465e-04 3 1  ON 50
ci_52                 5.708942e-04 3 1  ON 51
ci_53                -1.037626e-03 3 1  ON 52
ci_54                -9.683726e-04 3 1  ON 53
ci_55                -6.024581e-04 3 1  ON 54
ci_56                 1.740655e-03 3 1  ON 55
ci_57                 1.703072e-03 3 1  ON 56
ci_58                -9.181520e-04 3 1  ON 57
ci_59                -9.031807e-04 3 1  ON 58
ci_60                 5.762296e-04 3 1  ON 59
ci_61                 7.167462e-04 3 1  ON 60
ci_62                -5.184805e-04 3 1  ON 61
ci_63                -6.617560e-04 3 1  ON 62
ci_64                -5.673527e-04 3 1  ON 63
ci_65                -4.075955e-04 3 1  ON 64
ci_66                -7.815046e-04 3 1  ON 65
ci_67                -6.656477e-04 3 1  ON 66
ci_68                -5.270605e-04 3 1  ON 67
ci_69                -3.327002e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.8028
    reference variance = 0.34844
====================================================
  Execution time = 2.5358e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8791e-01
  Total weights = 1.9639e+06
  Execution time = 3.6077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474341948651
                                         uncertainty =       0.002246300327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474341948651
                                         uncertainty =       0.002246300327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486983927
  error estimate for blocks of size 2^( 2) =       0.000507828254
  error estimate for blocks of size 2^( 3) =       0.000527226984
  error estimate for blocks of size 2^( 4) =       0.000542360024
  error estimate for blocks of size 2^( 5) =       0.000551257343
  error estimate for blocks of size 2^( 6) =       0.000555892460
  error estimate for blocks of size 2^( 7) =       0.000556718853

      target function =      -0.715342341608
              le_mean =     -22.818633698091
             les_mean =     521.178345309880
             stat err =       0.000551557170
             autocorr =       1.282778919010
   target nu stat err =       0.000551557170
   target dn stat err =       0.002916729815
      target stat err =       0.002160429999
              std dev =       0.688699274190
             le_variance =       0.474306690269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473452630781
                                         uncertainty =       0.002229650902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473452630781
                                         uncertainty =       0.002229650902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486526019
  error estimate for blocks of size 2^( 2) =       0.000507391862
  error estimate for blocks of size 2^( 3) =       0.000526816321
  error estimate for blocks of size 2^( 4) =       0.000541963806
  error estimate for blocks of size 2^( 5) =       0.000550891298
  error estimate for blocks of size 2^( 6) =       0.000555533660
  error estimate for blocks of size 2^( 7) =       0.000556367063

      target function =      -0.715174556021
              le_mean =     -22.818643328439
             les_mean =     521.179018703039
             stat err =       0.000551188957
             autocorr =       1.283479316762
   target nu stat err =       0.000551188957
   target dn stat err =       0.003046437648
      target stat err =       0.002249272711
              std dev =       0.688051693981
             le_variance =       0.473415133590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473832605354
                                         uncertainty =       0.002236827726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473832605354
                                         uncertainty =       0.002236827726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486721750
  error estimate for blocks of size 2^( 2) =       0.000507577043
  error estimate for blocks of size 2^( 3) =       0.000526989152
  error estimate for blocks of size 2^( 4) =       0.000542129327
  error estimate for blocks of size 2^( 5) =       0.000551043019
  error estimate for blocks of size 2^( 6) =       0.000555682776
  error estimate for blocks of size 2^( 7) =       0.000556512504

      target function =      -0.715786818020
              le_mean =     -22.818634857542
             les_mean =     521.177777920600
             stat err =       0.000551341907
             autocorr =       1.283159073216
   target nu stat err =       0.000551341907
   target dn stat err =       0.002922325402
      target stat err =       0.002166855682
              std dev =       0.688328500496
             le_variance =       0.473796124595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474273431050
                                         uncertainty =       0.002245028100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474273431050
                                         uncertainty =       0.002245028100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486948670
  error estimate for blocks of size 2^( 2) =       0.000507794359
  error estimate for blocks of size 2^( 3) =       0.000527194730
  error estimate for blocks of size 2^( 4) =       0.000542328718
  error estimate for blocks of size 2^( 5) =       0.000551228388
  error estimate for blocks of size 2^( 6) =       0.000555864132
  error estimate for blocks of size 2^( 7) =       0.000556689859

      target function =      -0.715057205473
              le_mean =     -22.818633332938
             les_mean =     521.178726671151
             stat err =       0.000551527774
             autocorr =       1.282827932949
   target nu stat err =       0.000551527774
   target dn stat err =       0.003648437270
      target stat err =       0.002668278282
              std dev =       0.688649413085
             le_variance =       0.474238014142


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.715342341608        initial
     3.7253e-01     3.7253e+00             1.8112e-03        -0.715174556021
     1.4901e+00     1.4901e+01             4.7575e-04        -0.715786818020  <--
     5.9605e+00     5.9605e+01             1.2047e-04        -0.715057205473

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 4.3461e+01
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_01                 1.381709e-01 3 1  ON 0
ci_02                -3.610546e-02 3 1  ON 1
ci_03                -3.599875e-02 3 1  ON 2
ci_04                 3.216334e-02 3 1  ON 3
ci_05                -2.621369e-02 3 1  ON 4
ci_06                -2.584728e-02 3 1  ON 5
ci_07                 2.786972e-02 3 1  ON 6
ci_08                -8.597329e-03 3 1  ON 7
ci_09                -1.104869e-02 3 1  ON 8
ci_10                -1.098136e-02 3 1  ON 9
ci_11                 1.362970e-02 3 1  ON 10
ci_12                 8.774595e-03 3 1  ON 11
ci_13                 1.255912e-02 3 1  ON 12
ci_14                 1.249012e-02 3 1  ON 13
ci_15                 8.107109e-03 3 1  ON 14
ci_16                 8.192031e-03 3 1  ON 15
ci_17                -8.476460e-03 3 1  ON 16
ci_18                -8.116685e-03 3 1  ON 17
ci_19                 9.726014e-03 3 1  ON 18
ci_20                 7.497251e-03 3 1  ON 19
ci_21                 9.078395e-03 3 1  ON 20
ci_22                 9.184312e-03 3 1  ON 21
ci_23                 5.196589e-03 3 1  ON 22
ci_24                 4.679801e-03 3 1  ON 23
ci_25                 3.442440e-03 3 1  ON 24
ci_26                 3.400098e-03 3 1  ON 25
ci_27                 3.481978e-03 3 1  ON 26
ci_28                 2.488169e-03 3 1  ON 27
ci_29                 2.382906e-03 3 1  ON 28
ci_30                -2.015939e-03 3 1  ON 29
ci_31                -2.144832e-03 3 1  ON 30
ci_32                -1.470738e-03 3 1  ON 31
ci_33                -1.511388e-03 3 1  ON 32
ci_34                 1.375932e-03 3 1  ON 33
ci_35                 1.545672e-03 3 1  ON 34
ci_36                -1.356689e-03 3 1  ON 35
ci_37                -1.425877e-03 3 1  ON 36
ci_38                -9.588758e-04 3 1  ON 37
ci_39                -9.770554e-04 3 1  ON 38
ci_40                -1.625881e-03 3 1  ON 39
ci_41                -1.136709e-03 3 1  ON 40
ci_42                -9.513676e-04 3 1  ON 41
ci_43                -2.382342e-03 3 1  ON 42
ci_44                -1.686148e-03 3 1  ON 43
ci_45                -8.846720e-04 3 1  ON 44
ci_46                -7.571324e-04 3 1  ON 45
ci_47                 1.128292e-04 3 1  ON 46
ci_48                -5.192377e-05 3 1  ON 47
ci_49                -1.081862e-03 3 1  ON 48
ci_50                -8.900138e-04 3 1  ON 49
ci_51                 6.790465e-04 3 1  ON 50
ci_52                 5.708942e-04 3 1  ON 51
ci_53                -1.037626e-03 3 1  ON 52
ci_54                -9.683726e-04 3 1  ON 53
ci_55                -6.024581e-04 3 1  ON 54
ci_56                 1.740655e-03 3 1  ON 55
ci_57                 1.703072e-03 3 1  ON 56
ci_58                -9.181520e-04 3 1  ON 57
ci_59                -9.031807e-04 3 1  ON 58
ci_60                 5.762296e-04 3 1  ON 59
ci_61                 7.167462e-04 3 1  ON 60
ci_62                -5.184805e-04 3 1  ON 61
ci_63                -6.617560e-04 3 1  ON 62
ci_64                -5.673527e-04 3 1  ON 63
ci_65                -4.075955e-04 3 1  ON 64
ci_66                -7.815046e-04 3 1  ON 65
ci_67                -6.656477e-04 3 1  ON 66
ci_68                -5.270605e-04 3 1  ON 67
ci_69                -3.327002e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3852e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.89
    reference variance = 0.373671
====================================================
  Execution time = 2.5720e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8739e-01
  Total weights = 1.963641473e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473164066021
                                         uncertainty =       0.002935353430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473164066021
                                         uncertainty =       0.002935353430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486412591
  error estimate for blocks of size 2^( 2) =       0.000507598345
  error estimate for blocks of size 2^( 3) =       0.000527330226
  error estimate for blocks of size 2^( 4) =       0.000542812730
  error estimate for blocks of size 2^( 5) =       0.000553522132
  error estimate for blocks of size 2^( 6) =       0.000560596520
  error estimate for blocks of size 2^( 7) =       0.000564833202

      target function =      -0.715973377259
              le_mean =     -22.817832608861
             les_mean =     521.140874375291
             stat err =       0.000555441146
             autocorr =       1.303966641554
   target nu stat err =       0.000555441146
   target dn stat err =       0.003693987198
      target stat err =       0.002704737938
              std dev =       0.687891282431
             le_variance =       0.473194416445


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281783260886e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.715982693226       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.716258912300       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.716308733018       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.716317929200       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.716321331109       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.716321978587       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.716322262225       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.716322332599       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.716322314386       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.716322317646       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.716322326537       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 1.613789e-03

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.715982693226       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.716058164254       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.716071384435       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.716073742896       residual = 9.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.716074582660       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.716074718639       residual = 9.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.716074780934       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.716074796241       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.716074791571       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.716074792228       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 4.243513e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.715982693226       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.716002009445       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.716005365298       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.716005958306       residual = 8.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.716006167180       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.716006199409       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.716006214413       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.716006218089       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.716006216919       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.716006217074       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 1.074842e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.783704 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0317e+01
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_01                 1.377466e-01 3 1  ON 0
ci_02                -3.577435e-02 3 1  ON 1
ci_03                -3.564863e-02 3 1  ON 2
ci_04                 3.180193e-02 3 1  ON 3
ci_05                -2.603887e-02 3 1  ON 4
ci_06                -2.560835e-02 3 1  ON 5
ci_07                 2.780384e-02 3 1  ON 6
ci_08                -8.431175e-03 3 1  ON 7
ci_09                -1.089841e-02 3 1  ON 8
ci_10                -1.090508e-02 3 1  ON 9
ci_11                 1.357862e-02 3 1  ON 10
ci_12                 8.722832e-03 3 1  ON 11
ci_13                 1.254704e-02 3 1  ON 12
ci_14                 1.253288e-02 3 1  ON 13
ci_15                 8.043540e-03 3 1  ON 14
ci_16                 8.165121e-03 3 1  ON 15
ci_17                -8.408277e-03 3 1  ON 16
ci_18                -8.082180e-03 3 1  ON 17
ci_19                 9.697395e-03 3 1  ON 18
ci_20                 7.460242e-03 3 1  ON 19
ci_21                 9.048677e-03 3 1  ON 20
ci_22                 9.131916e-03 3 1  ON 21
ci_23                 5.187440e-03 3 1  ON 22
ci_24                 4.711327e-03 3 1  ON 23
ci_25                 3.402664e-03 3 1  ON 24
ci_26                 3.417647e-03 3 1  ON 25
ci_27                 3.475773e-03 3 1  ON 26
ci_28                 2.484112e-03 3 1  ON 27
ci_29                 2.363137e-03 3 1  ON 28
ci_30                -1.980859e-03 3 1  ON 29
ci_31                -2.090357e-03 3 1  ON 30
ci_32                -1.452572e-03 3 1  ON 31
ci_33                -1.466281e-03 3 1  ON 32
ci_34                 1.404675e-03 3 1  ON 33
ci_35                 1.468952e-03 3 1  ON 34
ci_36                -1.321187e-03 3 1  ON 35
ci_37                -1.411053e-03 3 1  ON 36
ci_38                -9.656825e-04 3 1  ON 37
ci_39                -9.594860e-04 3 1  ON 38
ci_40                -1.615043e-03 3 1  ON 39
ci_41                -1.111046e-03 3 1  ON 40
ci_42                -9.445103e-04 3 1  ON 41
ci_43                -2.356940e-03 3 1  ON 42
ci_44                -1.678107e-03 3 1  ON 43
ci_45                -8.472758e-04 3 1  ON 44
ci_46                -7.776423e-04 3 1  ON 45
ci_47                 1.704048e-04 3 1  ON 46
ci_48                -2.868501e-05 3 1  ON 47
ci_49                -1.049043e-03 3 1  ON 48
ci_50                -8.906172e-04 3 1  ON 49
ci_51                 6.669626e-04 3 1  ON 50
ci_52                 5.772141e-04 3 1  ON 51
ci_53                -1.005239e-03 3 1  ON 52
ci_54                -9.586731e-04 3 1  ON 53
ci_55                -6.224478e-04 3 1  ON 54
ci_56                 1.761746e-03 3 1  ON 55
ci_57                 1.701648e-03 3 1  ON 56
ci_58                -9.203936e-04 3 1  ON 57
ci_59                -9.144108e-04 3 1  ON 58
ci_60                 6.024809e-04 3 1  ON 59
ci_61                 6.975417e-04 3 1  ON 60
ci_62                -5.180771e-04 3 1  ON 61
ci_63                -6.696328e-04 3 1  ON 62
ci_64                -5.252920e-04 3 1  ON 63
ci_65                -4.125630e-04 3 1  ON 64
ci_66                -7.552085e-04 3 1  ON 65
ci_67                -6.687919e-04 3 1  ON 66
ci_68                -5.206622e-04 3 1  ON 67
ci_69                -3.480124e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.8408
    reference variance = 0.339977
====================================================
  Execution time = 2.5079e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8734e-01
  Total weights = 1.9635e+06
  Execution time = 3.6127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471945806073
                                         uncertainty =       0.002850841225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471945806073
                                         uncertainty =       0.002850841225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485804331
  error estimate for blocks of size 2^( 2) =       0.000506700108
  error estimate for blocks of size 2^( 3) =       0.000527097327
  error estimate for blocks of size 2^( 4) =       0.000541572210
  error estimate for blocks of size 2^( 5) =       0.000551508117
  error estimate for blocks of size 2^( 6) =       0.000554629113
  error estimate for blocks of size 2^( 7) =       0.000557342085

      target function =      -0.701889611386
              le_mean =     -22.818095583191
             les_mean =     521.172548937776
             stat err =       0.000551262881
             autocorr =       1.287640821477
   target nu stat err =       0.000551262881
   target dn stat err =       0.019959314272
      target stat err =       0.013765863029
              std dev =       0.687031073954
             le_variance =       0.472011696578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471144307683
                                         uncertainty =       0.002873838088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471144307683
                                         uncertainty =       0.002873838088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485392489
  error estimate for blocks of size 2^( 2) =       0.000506315961
  error estimate for blocks of size 2^( 3) =       0.000526744110
  error estimate for blocks of size 2^( 4) =       0.000541271488
  error estimate for blocks of size 2^( 5) =       0.000551237137
  error estimate for blocks of size 2^( 6) =       0.000554355516
  error estimate for blocks of size 2^( 7) =       0.000557028801

      target function =      -0.703417583134
              le_mean =     -22.818108035745
             les_mean =     521.171009149237
             stat err =       0.000550973235
             autocorr =       1.288471751574
   target nu stat err =       0.000550973235
   target dn stat err =       0.017045985991
      target stat err =       0.011810108178
              std dev =       0.686448641284
             le_variance =       0.471211737120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471481118240
                                         uncertainty =       0.002862972317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471481118240
                                         uncertainty =       0.002862972317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485565581
  error estimate for blocks of size 2^( 2) =       0.000506477181
  error estimate for blocks of size 2^( 3) =       0.000526889862
  error estimate for blocks of size 2^( 4) =       0.000541389587
  error estimate for blocks of size 2^( 5) =       0.000551346181
  error estimate for blocks of size 2^( 6) =       0.000554465063
  error estimate for blocks of size 2^( 7) =       0.000557149205

      target function =      -0.715368493538
              le_mean =     -22.818099539172
             les_mean =     521.153909677824
             stat err =       0.000551087509
             autocorr =       1.288087440110
   target nu stat err =       0.000551087509
   target dn stat err =       0.003683867234
      target stat err =       0.002693292166
              std dev =       0.686693430063
             le_variance =       0.471547866892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471879243545
                                         uncertainty =       0.002852523655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471879243545
                                         uncertainty =       0.002852523655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485770136
  error estimate for blocks of size 2^( 2) =       0.000506669257
  error estimate for blocks of size 2^( 3) =       0.000527068306
  error estimate for blocks of size 2^( 4) =       0.000541543543
  error estimate for blocks of size 2^( 5) =       0.000551485380
  error estimate for blocks of size 2^( 6) =       0.000554605738
  error estimate for blocks of size 2^( 7) =       0.000557313075

      target function =      -0.714736865919
              le_mean =     -22.818097372731
             les_mean =     521.154693099995
             stat err =       0.000551236934
             autocorr =       1.287700882223
   target nu stat err =       0.000551236934
   target dn stat err =       0.003828011875
      target stat err =       0.002789529047
              std dev =       0.686982714339
             le_variance =       0.471945249801


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.701889611386        initial
     3.7253e-01     3.7253e+00             1.6138e-03        -0.703417583134
     1.4901e+00     1.4901e+01             4.2435e-04        -0.715368493538  <--
     5.9605e+00     5.9605e+01             1.0748e-04        -0.714736865919

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 4.3180e+01
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_01                 1.377466e-01 3 1  ON 0
ci_02                -3.577435e-02 3 1  ON 1
ci_03                -3.564863e-02 3 1  ON 2
ci_04                 3.180193e-02 3 1  ON 3
ci_05                -2.603887e-02 3 1  ON 4
ci_06                -2.560835e-02 3 1  ON 5
ci_07                 2.780384e-02 3 1  ON 6
ci_08                -8.431175e-03 3 1  ON 7
ci_09                -1.089841e-02 3 1  ON 8
ci_10                -1.090508e-02 3 1  ON 9
ci_11                 1.357862e-02 3 1  ON 10
ci_12                 8.722832e-03 3 1  ON 11
ci_13                 1.254704e-02 3 1  ON 12
ci_14                 1.253288e-02 3 1  ON 13
ci_15                 8.043540e-03 3 1  ON 14
ci_16                 8.165121e-03 3 1  ON 15
ci_17                -8.408277e-03 3 1  ON 16
ci_18                -8.082180e-03 3 1  ON 17
ci_19                 9.697395e-03 3 1  ON 18
ci_20                 7.460242e-03 3 1  ON 19
ci_21                 9.048677e-03 3 1  ON 20
ci_22                 9.131916e-03 3 1  ON 21
ci_23                 5.187440e-03 3 1  ON 22
ci_24                 4.711327e-03 3 1  ON 23
ci_25                 3.402664e-03 3 1  ON 24
ci_26                 3.417647e-03 3 1  ON 25
ci_27                 3.475773e-03 3 1  ON 26
ci_28                 2.484112e-03 3 1  ON 27
ci_29                 2.363137e-03 3 1  ON 28
ci_30                -1.980859e-03 3 1  ON 29
ci_31                -2.090357e-03 3 1  ON 30
ci_32                -1.452572e-03 3 1  ON 31
ci_33                -1.466281e-03 3 1  ON 32
ci_34                 1.404675e-03 3 1  ON 33
ci_35                 1.468952e-03 3 1  ON 34
ci_36                -1.321187e-03 3 1  ON 35
ci_37                -1.411053e-03 3 1  ON 36
ci_38                -9.656825e-04 3 1  ON 37
ci_39                -9.594860e-04 3 1  ON 38
ci_40                -1.615043e-03 3 1  ON 39
ci_41                -1.111046e-03 3 1  ON 40
ci_42                -9.445103e-04 3 1  ON 41
ci_43                -2.356940e-03 3 1  ON 42
ci_44                -1.678107e-03 3 1  ON 43
ci_45                -8.472758e-04 3 1  ON 44
ci_46                -7.776423e-04 3 1  ON 45
ci_47                 1.704048e-04 3 1  ON 46
ci_48                -2.868501e-05 3 1  ON 47
ci_49                -1.049043e-03 3 1  ON 48
ci_50                -8.906172e-04 3 1  ON 49
ci_51                 6.669626e-04 3 1  ON 50
ci_52                 5.772141e-04 3 1  ON 51
ci_53                -1.005239e-03 3 1  ON 52
ci_54                -9.586731e-04 3 1  ON 53
ci_55                -6.224478e-04 3 1  ON 54
ci_56                 1.761746e-03 3 1  ON 55
ci_57                 1.701648e-03 3 1  ON 56
ci_58                -9.203936e-04 3 1  ON 57
ci_59                -9.144108e-04 3 1  ON 58
ci_60                 6.024809e-04 3 1  ON 59
ci_61                 6.975417e-04 3 1  ON 60
ci_62                -5.180771e-04 3 1  ON 61
ci_63                -6.696328e-04 3 1  ON 62
ci_64                -5.252920e-04 3 1  ON 63
ci_65                -4.125630e-04 3 1  ON 64
ci_66                -7.552085e-04 3 1  ON 65
ci_67                -6.687919e-04 3 1  ON 66
ci_68                -5.206622e-04 3 1  ON 67
ci_69                -3.480124e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3503e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.8118
    reference variance = 0.57996
====================================================
  Execution time = 2.5737e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5361e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9230e-01
  Total weights = 1.963588616e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474367516187
                                         uncertainty =       0.002393262509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474367516187
                                         uncertainty =       0.002393262509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487026600
  error estimate for blocks of size 2^( 2) =       0.000508187874
  error estimate for blocks of size 2^( 3) =       0.000528358807
  error estimate for blocks of size 2^( 4) =       0.000542804786
  error estimate for blocks of size 2^( 5) =       0.000550749755
  error estimate for blocks of size 2^( 6) =       0.000555107201
  error estimate for blocks of size 2^( 7) =       0.000559054611

      target function =      -0.712482822589
              le_mean =     -22.818618718754
             les_mean =     521.181664764733
             stat err =       0.000551929088
             autocorr =       1.284284387175
   target nu stat err =       0.000551929088
   target dn stat err =       0.003780035409
      target stat err =       0.002741067698
              std dev =       0.688759622970
             le_variance =       0.474389818234


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281861871875e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712492626357       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712758767494       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712804102232       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712814248086       residual = 9.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712816858938       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712818099233       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712818271498       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712818330082       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712818316598       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712818309407       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.712818317633       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 1.707575e-03

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712492626357       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712565198975       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712577198246       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712579786981       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712580407692       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712580697216       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712580733028       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712580745465       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712580742210       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712580740682       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 4.484340e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712492626357       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712511190416       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712514234229       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712514884192       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712515036933       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712515107881       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712515116368       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712515119333       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712515118530       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712515118166       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 1.135513e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.787410 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0362e+01
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_01                 1.372981e-01 3 1  ON 0
ci_02                -3.539899e-02 3 1  ON 1
ci_03                -3.529861e-02 3 1  ON 2
ci_04                 3.147012e-02 3 1  ON 3
ci_05                -2.589406e-02 3 1  ON 4
ci_06                -2.536524e-02 3 1  ON 5
ci_07                 2.775950e-02 3 1  ON 6
ci_08                -8.284447e-03 3 1  ON 7
ci_09                -1.077343e-02 3 1  ON 8
ci_10                -1.082726e-02 3 1  ON 9
ci_11                 1.347788e-02 3 1  ON 10
ci_12                 8.670013e-03 3 1  ON 11
ci_13                 1.257199e-02 3 1  ON 12
ci_14                 1.260440e-02 3 1  ON 13
ci_15                 8.028066e-03 3 1  ON 14
ci_16                 8.108645e-03 3 1  ON 15
ci_17                -8.353011e-03 3 1  ON 16
ci_18                -8.032396e-03 3 1  ON 17
ci_19                 9.669554e-03 3 1  ON 18
ci_20                 7.475359e-03 3 1  ON 19
ci_21                 9.052368e-03 3 1  ON 20
ci_22                 9.171680e-03 3 1  ON 21
ci_23                 5.177724e-03 3 1  ON 22
ci_24                 4.750106e-03 3 1  ON 23
ci_25                 3.360030e-03 3 1  ON 24
ci_26                 3.413498e-03 3 1  ON 25
ci_27                 3.474656e-03 3 1  ON 26
ci_28                 2.444842e-03 3 1  ON 27
ci_29                 2.324256e-03 3 1  ON 28
ci_30                -2.001128e-03 3 1  ON 29
ci_31                -2.068012e-03 3 1  ON 30
ci_32                -1.437817e-03 3 1  ON 31
ci_33                -1.494664e-03 3 1  ON 32
ci_34                 1.397756e-03 3 1  ON 33
ci_35                 1.468460e-03 3 1  ON 34
ci_36                -1.296773e-03 3 1  ON 35
ci_37                -1.383587e-03 3 1  ON 36
ci_38                -9.312058e-04 3 1  ON 37
ci_39                -9.496317e-04 3 1  ON 38
ci_40                -1.602205e-03 3 1  ON 39
ci_41                -1.077052e-03 3 1  ON 40
ci_42                -9.710842e-04 3 1  ON 41
ci_43                -2.323729e-03 3 1  ON 42
ci_44                -1.659791e-03 3 1  ON 43
ci_45                -7.898970e-04 3 1  ON 44
ci_46                -7.675532e-04 3 1  ON 45
ci_47                 2.369015e-04 3 1  ON 46
ci_48                 2.176474e-06 3 1  ON 47
ci_49                -1.020116e-03 3 1  ON 48
ci_50                -8.839198e-04 3 1  ON 49
ci_51                 6.735795e-04 3 1  ON 50
ci_52                 5.812888e-04 3 1  ON 51
ci_53                -1.010441e-03 3 1  ON 52
ci_54                -9.359838e-04 3 1  ON 53
ci_55                -6.112555e-04 3 1  ON 54
ci_56                 1.771957e-03 3 1  ON 55
ci_57                 1.692371e-03 3 1  ON 56
ci_58                -9.040660e-04 3 1  ON 57
ci_59                -9.241214e-04 3 1  ON 58
ci_60                 5.727768e-04 3 1  ON 59
ci_61                 6.618338e-04 3 1  ON 60
ci_62                -5.265741e-04 3 1  ON 61
ci_63                -6.489596e-04 3 1  ON 62
ci_64                -4.831504e-04 3 1  ON 63
ci_65                -4.245749e-04 3 1  ON 64
ci_66                -7.506091e-04 3 1  ON 65
ci_67                -6.588046e-04 3 1  ON 66
ci_68                -5.562449e-04 3 1  ON 67
ci_69                -4.024915e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.7651
    reference variance = 0.616671
====================================================
  Execution time = 2.4994e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9186e-01
  Total weights = 1.9638e+06
  Execution time = 3.5889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477260631785
                                         uncertainty =       0.003001236442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477260631785
                                         uncertainty =       0.003001236442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488483943
  error estimate for blocks of size 2^( 2) =       0.000509686811
  error estimate for blocks of size 2^( 3) =       0.000528778001
  error estimate for blocks of size 2^( 4) =       0.000543361031
  error estimate for blocks of size 2^( 5) =       0.000552943485
  error estimate for blocks of size 2^( 6) =       0.000557945732
  error estimate for blocks of size 2^( 7) =       0.000559401643

      target function =      -0.711163715557
              le_mean =     -22.819163664437
             les_mean =     521.208403506600
             stat err =       0.000553412973
             autocorr =       1.283506540112
   target nu stat err =       0.000553412973
   target dn stat err =       0.004287812134
      target stat err =       0.003086644788
              std dev =       0.690820616893
             le_variance =       0.477233124724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476465089871
                                         uncertainty =       0.002995997539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476465089871
                                         uncertainty =       0.002995997539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488077035
  error estimate for blocks of size 2^( 2) =       0.000509307963
  error estimate for blocks of size 2^( 3) =       0.000528430378
  error estimate for blocks of size 2^( 4) =       0.000543044207
  error estimate for blocks of size 2^( 5) =       0.000552634429
  error estimate for blocks of size 2^( 6) =       0.000557659527
  error estimate for blocks of size 2^( 7) =       0.000559100749

      target function =      -0.711703728391
              le_mean =     -22.819165112667
             les_mean =     521.207710236398
             stat err =       0.000553109728
             autocorr =       1.284238973480
   target nu stat err =       0.000553109728
   target dn stat err =       0.003988338324
      target stat err =       0.002882421169
              std dev =       0.690245163048
             le_variance =       0.476438385111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476804134473
                                         uncertainty =       0.002997214476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476804134473
                                         uncertainty =       0.002997214476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488250498
  error estimate for blocks of size 2^( 2) =       0.000509467962
  error estimate for blocks of size 2^( 3) =       0.000528575827
  error estimate for blocks of size 2^( 4) =       0.000543174888
  error estimate for blocks of size 2^( 5) =       0.000552761540
  error estimate for blocks of size 2^( 6) =       0.000557777113
  error estimate for blocks of size 2^( 7) =       0.000559222858

      target function =      -0.712511701812
              le_mean =     -22.819161504351
             les_mean =     521.206408877176
             stat err =       0.000553234100
             autocorr =       1.283903825555
   target nu stat err =       0.000553234100
   target dn stat err =       0.003841270198
      target stat err =       0.002786292053
              std dev =       0.690490475405
             le_variance =       0.476777096625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477198625532
                                         uncertainty =       0.003000603419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477198625532
                                         uncertainty =       0.003000603419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488452240
  error estimate for blocks of size 2^( 2) =       0.000509657098
  error estimate for blocks of size 2^( 3) =       0.000528750499
  error estimate for blocks of size 2^( 4) =       0.000543336027
  error estimate for blocks of size 2^( 5) =       0.000552918442
  error estimate for blocks of size 2^( 6) =       0.000557923249
  error estimate for blocks of size 2^( 7) =       0.000559377078

      target function =      -0.712588464865
              le_mean =     -22.819162586901
             les_mean =     521.206350836678
             stat err =       0.000553388699
             autocorr =       1.283560547568
   target nu stat err =       0.000553388699
   target dn stat err =       0.003777642596
      target stat err =       0.002742578466
              std dev =       0.690775783006
             le_variance =       0.477171182388


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.711163715557        initial
     3.7253e-01     3.7253e+00             1.7076e-03        -0.711703728391
     1.4901e+00     1.4901e+01             4.4843e-04        -0.712511701812
     5.9605e+00     5.9605e+01             1.1355e-04        -0.712588464865  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 4.2977e+01
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_01                 1.376330e-01 3 1  ON 0
ci_02                -3.567854e-02 3 1  ON 1
ci_03                -3.555927e-02 3 1  ON 2
ci_04                 3.171698e-02 3 1  ON 3
ci_05                -2.600177e-02 3 1  ON 4
ci_06                -2.554619e-02 3 1  ON 5
ci_07                 2.779254e-02 3 1  ON 6
ci_08                -8.393644e-03 3 1  ON 7
ci_09                -1.086657e-02 3 1  ON 8
ci_10                -1.088526e-02 3 1  ON 9
ci_11                 1.355300e-02 3 1  ON 10
ci_12                 8.709325e-03 3 1  ON 11
ci_13                 1.255336e-02 3 1  ON 12
ci_14                 1.255095e-02 3 1  ON 13
ci_15                 8.039592e-03 3 1  ON 14
ci_16                 8.150705e-03 3 1  ON 15
ci_17                -8.394198e-03 3 1  ON 16
ci_18                -8.069521e-03 3 1  ON 17
ci_19                 9.690249e-03 3 1  ON 18
ci_20                 7.464097e-03 3 1  ON 19
ci_21                 9.049593e-03 3 1  ON 20
ci_22                 9.142014e-03 3 1  ON 21
ci_23                 5.184944e-03 3 1  ON 22
ci_24                 4.721110e-03 3 1  ON 23
ci_25                 3.391761e-03 3 1  ON 24
ci_26                 3.416578e-03 3 1  ON 25
ci_27                 3.475464e-03 3 1  ON 26
ci_28                 2.474124e-03 3 1  ON 27
ci_29                 2.353255e-03 3 1  ON 28
ci_30                -1.985994e-03 3 1  ON 29
ci_31                -2.084680e-03 3 1  ON 30
ci_32                -1.448760e-03 3 1  ON 31
ci_33                -1.473512e-03 3 1  ON 32
ci_34                 1.402857e-03 3 1  ON 33
ci_35                 1.468768e-03 3 1  ON 34
ci_36                -1.314945e-03 3 1  ON 35
ci_37                -1.404020e-03 3 1  ON 36
ci_38                -9.568621e-04 3 1  ON 37
ci_39                -9.569669e-04 3 1  ON 38
ci_40                -1.611759e-03 3 1  ON 39
ci_41                -1.102323e-03 3 1  ON 40
ci_42                -9.512807e-04 3 1  ON 41
ci_43                -2.348514e-03 3 1  ON 42
ci_44                -1.673473e-03 3 1  ON 43
ci_45                -8.326020e-04 3 1  ON 44
ci_46                -7.750682e-04 3 1  ON 45
ci_47                 1.872879e-04 3 1  ON 46
ci_48                -2.085995e-05 3 1  ON 47
ci_49                -1.041644e-03 3 1  ON 48
ci_50                -8.888979e-04 3 1  ON 49
ci_51                 6.686772e-04 3 1  ON 50
ci_52                 5.782760e-04 3 1  ON 51
ci_53                -1.006582e-03 3 1  ON 52
ci_54                -9.528566e-04 3 1  ON 53
ci_55                -6.195722e-04 3 1  ON 54
ci_56                 1.764358e-03 3 1  ON 55
ci_57                 1.699271e-03 3 1  ON 56
ci_58                -9.162228e-04 3 1  ON 57
ci_59                -9.169014e-04 3 1  ON 58
ci_60                 5.949746e-04 3 1  ON 59
ci_61                 6.884654e-04 3 1  ON 60
ci_62                -5.202674e-04 3 1  ON 61
ci_63                -6.643508e-04 3 1  ON 62
ci_64                -5.145056e-04 3 1  ON 63
ci_65                -4.156318e-04 3 1  ON 64
ci_66                -7.540357e-04 3 1  ON 65
ci_67                -6.662371e-04 3 1  ON 66
ci_68                -5.297647e-04 3 1  ON 67
ci_69                -3.619305e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.8325
    reference variance = 0.521364
====================================================
  Execution time = 2.5893e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9233e-01
  Total weights = 1.963680680e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475242230259
                                         uncertainty =       0.002631868774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475242230259
                                         uncertainty =       0.002631868774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487485697
  error estimate for blocks of size 2^( 2) =       0.000508759297
  error estimate for blocks of size 2^( 3) =       0.000528486502
  error estimate for blocks of size 2^( 4) =       0.000543595427
  error estimate for blocks of size 2^( 5) =       0.000552007916
  error estimate for blocks of size 2^( 6) =       0.000556619599
  error estimate for blocks of size 2^( 7) =       0.000559641772

      target function =      -0.712444652505
              le_mean =     -22.817574340795
             les_mean =     521.134026654898
             stat err =       0.000552966178
             autocorr =       1.286688387574
   target nu stat err =       0.000552966178
   target dn stat err =       0.004137673646
      target stat err =       0.002985908352
              std dev =       0.689408884572
             le_variance =       0.475284610127


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281757434080e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712456285015       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712528330974       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712540295012       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712542368905       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712542958780       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712543117564       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712543194419       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712543194003       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712543197538       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712543199132       residual = 6.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 4.917457e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712456285015       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712474717172       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712477752430       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712478270751       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712478416292       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712478454548       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712478473346       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712478473183       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712478474037       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712478474443       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 1.245188e-04

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712456285015       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712460920114       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712461681733       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712461811289       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712461847548       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712461857021       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.712461861694       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.712461861650       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.712461861861       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.712461861963       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 3.123033e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.790960 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0476e+01
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_01                 1.375085e-01 3 1  ON 0
ci_02                -3.560982e-02 3 1  ON 1
ci_03                -3.548311e-02 3 1  ON 2
ci_04                 3.162557e-02 3 1  ON 3
ci_05                -2.593850e-02 3 1  ON 4
ci_06                -2.549949e-02 3 1  ON 5
ci_07                 2.778737e-02 3 1  ON 6
ci_08                -8.355087e-03 3 1  ON 7
ci_09                -1.083815e-02 3 1  ON 8
ci_10                -1.085811e-02 3 1  ON 9
ci_11                 1.353762e-02 3 1  ON 10
ci_12                 8.713138e-03 3 1  ON 11
ci_13                 1.255360e-02 3 1  ON 12
ci_14                 1.255070e-02 3 1  ON 13
ci_15                 8.045478e-03 3 1  ON 14
ci_16                 8.136396e-03 3 1  ON 15
ci_17                -8.378863e-03 3 1  ON 16
ci_18                -8.050827e-03 3 1  ON 17
ci_19                 9.699080e-03 3 1  ON 18
ci_20                 7.448222e-03 3 1  ON 19
ci_21                 9.048684e-03 3 1  ON 20
ci_22                 9.139384e-03 3 1  ON 21
ci_23                 5.179611e-03 3 1  ON 22
ci_24                 4.719374e-03 3 1  ON 23
ci_25                 3.393126e-03 3 1  ON 24
ci_26                 3.440916e-03 3 1  ON 25
ci_27                 3.462132e-03 3 1  ON 26
ci_28                 2.471804e-03 3 1  ON 27
ci_29                 2.337973e-03 3 1  ON 28
ci_30                -1.976034e-03 3 1  ON 29
ci_31                -2.082652e-03 3 1  ON 30
ci_32                -1.433292e-03 3 1  ON 31
ci_33                -1.469800e-03 3 1  ON 32
ci_34                 1.403648e-03 3 1  ON 33
ci_35                 1.448331e-03 3 1  ON 34
ci_36                -1.311800e-03 3 1  ON 35
ci_37                -1.396469e-03 3 1  ON 36
ci_38                -9.570867e-04 3 1  ON 37
ci_39                -9.545718e-04 3 1  ON 38
ci_40                -1.611083e-03 3 1  ON 39
ci_41                -1.101743e-03 3 1  ON 40
ci_42                -9.569396e-04 3 1  ON 41
ci_43                -2.344891e-03 3 1  ON 42
ci_44                -1.666088e-03 3 1  ON 43
ci_45                -8.274254e-04 3 1  ON 44
ci_46                -7.689027e-04 3 1  ON 45
ci_47                 1.866934e-04 3 1  ON 46
ci_48                 4.849490e-06 3 1  ON 47
ci_49                -1.042417e-03 3 1  ON 48
ci_50                -8.884793e-04 3 1  ON 49
ci_51                 6.566224e-04 3 1  ON 50
ci_52                 5.750774e-04 3 1  ON 51
ci_53                -1.006676e-03 3 1  ON 52
ci_54                -9.525698e-04 3 1  ON 53
ci_55                -6.179760e-04 3 1  ON 54
ci_56                 1.766303e-03 3 1  ON 55
ci_57                 1.697141e-03 3 1  ON 56
ci_58                -9.186061e-04 3 1  ON 57
ci_59                -9.142995e-04 3 1  ON 58
ci_60                 5.936287e-04 3 1  ON 59
ci_61                 6.992744e-04 3 1  ON 60
ci_62                -5.158932e-04 3 1  ON 61
ci_63                -6.590316e-04 3 1  ON 62
ci_64                -5.182401e-04 3 1  ON 63
ci_65                -4.191920e-04 3 1  ON 64
ci_66                -7.561011e-04 3 1  ON 65
ci_67                -6.725385e-04 3 1  ON 66
ci_68                -5.304329e-04 3 1  ON 67
ci_69                -3.648321e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.6618
    reference variance = 1.97541
====================================================
  Execution time = 2.5308e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8813e-01
  Total weights = 1.9639e+06
  Execution time = 3.8355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471877746819
                                         uncertainty =       0.002320328839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471877746819
                                         uncertainty =       0.002320328839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485784913
  error estimate for blocks of size 2^( 2) =       0.000506705410
  error estimate for blocks of size 2^( 3) =       0.000526567748
  error estimate for blocks of size 2^( 4) =       0.000541509989
  error estimate for blocks of size 2^( 5) =       0.000551261891
  error estimate for blocks of size 2^( 6) =       0.000554919590
  error estimate for blocks of size 2^( 7) =       0.000555733445

      target function =      -0.715473514004
              le_mean =     -22.817659737732
             les_mean =     521.133679744371
             stat err =       0.000550856229
             autocorr =       1.285844596726
   target nu stat err =       0.000550856229
   target dn stat err =       0.003406736222
      target stat err =       0.002498622406
              std dev =       0.687003611694
             le_variance =       0.471973962480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471690405681
                                         uncertainty =       0.002326676406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471690405681
                                         uncertainty =       0.002326676406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485688365
  error estimate for blocks of size 2^( 2) =       0.000506616225
  error estimate for blocks of size 2^( 3) =       0.000526487531
  error estimate for blocks of size 2^( 4) =       0.000541444207
  error estimate for blocks of size 2^( 5) =       0.000551202858
  error estimate for blocks of size 2^( 6) =       0.000554863122
  error estimate for blocks of size 2^( 7) =       0.000555683351

      target function =      -0.715112145829
              le_mean =     -22.817662498571
             les_mean =     521.134310666979
             stat err =       0.000550798384
             autocorr =       1.286085720656
   target nu stat err =       0.000550798384
   target dn stat err =       0.003485693513
      target stat err =       0.002551228530
              std dev =       0.686867072528
             le_variance =       0.471786375323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471780092453
                                         uncertainty =       0.002323459547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471780092453
                                         uncertainty =       0.002323459547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485734590
  error estimate for blocks of size 2^( 2) =       0.000506658879
  error estimate for blocks of size 2^( 3) =       0.000526525772
  error estimate for blocks of size 2^( 4) =       0.000541475399
  error estimate for blocks of size 2^( 5) =       0.000551230755
  error estimate for blocks of size 2^( 6) =       0.000554889825
  error estimate for blocks of size 2^( 7) =       0.000555706902

      target function =      -0.715525614578
              le_mean =     -22.817660898718
             les_mean =     521.133659844295
             stat err =       0.000550825720
             autocorr =       1.285968580560
   target nu stat err =       0.000550825720
   target dn stat err =       0.003420362968
      target stat err =       0.002508486114
              std dev =       0.686932445585
             le_variance =       0.471876184797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471865248326
                                         uncertainty =       0.002320709984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471865248326
                                         uncertainty =       0.002320709984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485778473
  error estimate for blocks of size 2^( 2) =       0.000506699442
  error estimate for blocks of size 2^( 3) =       0.000526562353
  error estimate for blocks of size 2^( 4) =       0.000541505512
  error estimate for blocks of size 2^( 5) =       0.000551257851
  error estimate for blocks of size 2^( 6) =       0.000554915724
  error estimate for blocks of size 2^( 7) =       0.000555729981

      target function =      -0.715478857941
              le_mean =     -22.817659848695
             les_mean =     521.133677330315
             stat err =       0.000550852267
             autocorr =       1.285860194866
   target nu stat err =       0.000550852267
   target dn stat err =       0.003408357745
      target stat err =       0.002499789889
              std dev =       0.686994504155
             le_variance =       0.471961448740


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.715473514004        initial
     1.4901e+00     1.4901e+01             4.9175e-04        -0.715112145829
     5.9605e+00     5.9605e+01             1.2452e-04        -0.715525614578  <--
     2.3842e+01     2.3842e+02             3.1230e-05        -0.715478857941

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 4.3832e+01
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_01                 1.375085e-01 3 1  ON 0
ci_02                -3.560982e-02 3 1  ON 1
ci_03                -3.548311e-02 3 1  ON 2
ci_04                 3.162557e-02 3 1  ON 3
ci_05                -2.593850e-02 3 1  ON 4
ci_06                -2.549949e-02 3 1  ON 5
ci_07                 2.778737e-02 3 1  ON 6
ci_08                -8.355087e-03 3 1  ON 7
ci_09                -1.083815e-02 3 1  ON 8
ci_10                -1.085811e-02 3 1  ON 9
ci_11                 1.353762e-02 3 1  ON 10
ci_12                 8.713138e-03 3 1  ON 11
ci_13                 1.255360e-02 3 1  ON 12
ci_14                 1.255070e-02 3 1  ON 13
ci_15                 8.045478e-03 3 1  ON 14
ci_16                 8.136396e-03 3 1  ON 15
ci_17                -8.378863e-03 3 1  ON 16
ci_18                -8.050827e-03 3 1  ON 17
ci_19                 9.699080e-03 3 1  ON 18
ci_20                 7.448222e-03 3 1  ON 19
ci_21                 9.048684e-03 3 1  ON 20
ci_22                 9.139384e-03 3 1  ON 21
ci_23                 5.179611e-03 3 1  ON 22
ci_24                 4.719374e-03 3 1  ON 23
ci_25                 3.393126e-03 3 1  ON 24
ci_26                 3.440916e-03 3 1  ON 25
ci_27                 3.462132e-03 3 1  ON 26
ci_28                 2.471804e-03 3 1  ON 27
ci_29                 2.337973e-03 3 1  ON 28
ci_30                -1.976034e-03 3 1  ON 29
ci_31                -2.082652e-03 3 1  ON 30
ci_32                -1.433292e-03 3 1  ON 31
ci_33                -1.469800e-03 3 1  ON 32
ci_34                 1.403648e-03 3 1  ON 33
ci_35                 1.448331e-03 3 1  ON 34
ci_36                -1.311800e-03 3 1  ON 35
ci_37                -1.396469e-03 3 1  ON 36
ci_38                -9.570867e-04 3 1  ON 37
ci_39                -9.545718e-04 3 1  ON 38
ci_40                -1.611083e-03 3 1  ON 39
ci_41                -1.101743e-03 3 1  ON 40
ci_42                -9.569396e-04 3 1  ON 41
ci_43                -2.344891e-03 3 1  ON 42
ci_44                -1.666088e-03 3 1  ON 43
ci_45                -8.274254e-04 3 1  ON 44
ci_46                -7.689027e-04 3 1  ON 45
ci_47                 1.866934e-04 3 1  ON 46
ci_48                 4.849490e-06 3 1  ON 47
ci_49                -1.042417e-03 3 1  ON 48
ci_50                -8.884793e-04 3 1  ON 49
ci_51                 6.566224e-04 3 1  ON 50
ci_52                 5.750774e-04 3 1  ON 51
ci_53                -1.006676e-03 3 1  ON 52
ci_54                -9.525698e-04 3 1  ON 53
ci_55                -6.179760e-04 3 1  ON 54
ci_56                 1.766303e-03 3 1  ON 55
ci_57                 1.697141e-03 3 1  ON 56
ci_58                -9.186061e-04 3 1  ON 57
ci_59                -9.142995e-04 3 1  ON 58
ci_60                 5.936287e-04 3 1  ON 59
ci_61                 6.992744e-04 3 1  ON 60
ci_62                -5.158932e-04 3 1  ON 61
ci_63                -6.590316e-04 3 1  ON 62
ci_64                -5.182401e-04 3 1  ON 63
ci_65                -4.191920e-04 3 1  ON 64
ci_66                -7.561011e-04 3 1  ON 65
ci_67                -6.725385e-04 3 1  ON 66
ci_68                -5.304329e-04 3 1  ON 67
ci_69                -3.648321e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4314e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.8279
    reference variance = 0.31764
====================================================
  Execution time = 2.5686e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9498e-01
  Total weights = 1.963422770e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476989006174
                                         uncertainty =       0.002517050857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476989006174
                                         uncertainty =       0.002517050857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488317082
  error estimate for blocks of size 2^( 2) =       0.000508862635
  error estimate for blocks of size 2^( 3) =       0.000528878504
  error estimate for blocks of size 2^( 4) =       0.000543939138
  error estimate for blocks of size 2^( 5) =       0.000554713915
  error estimate for blocks of size 2^( 6) =       0.000560743818
  error estimate for blocks of size 2^( 7) =       0.000562137127

      target function =      -0.710582966706
              le_mean =     -22.818503763378
             les_mean =     521.179090627109
             stat err =       0.000555383499
             autocorr =       1.293546695963
   target nu stat err =       0.000555383499
   target dn stat err =       0.004632235595
      target stat err =       0.003318873558
              std dev =       0.690584640683
             le_variance =       0.476907145947


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281850376338e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710597649827       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710656681394       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710666428194       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710667993978       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710668646747       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710668889296       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710668942281       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710668934546       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710668932663       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710668939638       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.710668936894       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 3.391500e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710597649827       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710612754999       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710615227627       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710615621227       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710615784156       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710615843298       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710615855874       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710615853974       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710615853515       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710615855214       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 8.593235e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710597649827       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710601448465       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710602068898       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710602167428       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710602208140       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710602222829       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710602225931       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710602225458       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710602225344       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710602225766       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 2.155396e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.794693 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0310e+01
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_01                 1.374226e-01 3 1  ON 0
ci_02                -3.552459e-02 3 1  ON 1
ci_03                -3.541532e-02 3 1  ON 2
ci_04                 3.154915e-02 3 1  ON 3
ci_05                -2.589047e-02 3 1  ON 4
ci_06                -2.544688e-02 3 1  ON 5
ci_07                 2.777748e-02 3 1  ON 6
ci_08                -8.318253e-03 3 1  ON 7
ci_09                -1.080621e-02 3 1  ON 8
ci_10                -1.084029e-02 3 1  ON 9
ci_11                 1.353190e-02 3 1  ON 10
ci_12                 8.690747e-03 3 1  ON 11
ci_13                 1.255379e-02 3 1  ON 12
ci_14                 1.256598e-02 3 1  ON 13
ci_15                 8.032926e-03 3 1  ON 14
ci_16                 8.121660e-03 3 1  ON 15
ci_17                -8.368140e-03 3 1  ON 16
ci_18                -8.026072e-03 3 1  ON 17
ci_19                 9.692087e-03 3 1  ON 18
ci_20                 7.440713e-03 3 1  ON 19
ci_21                 9.042859e-03 3 1  ON 20
ci_22                 9.140146e-03 3 1  ON 21
ci_23                 5.172342e-03 3 1  ON 22
ci_24                 4.722597e-03 3 1  ON 23
ci_25                 3.387831e-03 3 1  ON 24
ci_26                 3.448897e-03 3 1  ON 25
ci_27                 3.465180e-03 3 1  ON 26
ci_28                 2.469411e-03 3 1  ON 27
ci_29                 2.328792e-03 3 1  ON 28
ci_30                -1.967562e-03 3 1  ON 29
ci_31                -2.080155e-03 3 1  ON 30
ci_32                -1.416826e-03 3 1  ON 31
ci_33                -1.462240e-03 3 1  ON 32
ci_34                 1.391668e-03 3 1  ON 33
ci_35                 1.450900e-03 3 1  ON 34
ci_36                -1.313138e-03 3 1  ON 35
ci_37                -1.388786e-03 3 1  ON 36
ci_38                -9.452239e-04 3 1  ON 37
ci_39                -9.533177e-04 3 1  ON 38
ci_40                -1.611069e-03 3 1  ON 39
ci_41                -1.094718e-03 3 1  ON 40
ci_42                -9.531447e-04 3 1  ON 41
ci_43                -2.338251e-03 3 1  ON 42
ci_44                -1.677102e-03 3 1  ON 43
ci_45                -8.306824e-04 3 1  ON 44
ci_46                -7.610764e-04 3 1  ON 45
ci_47                 1.970115e-04 3 1  ON 46
ci_48                 1.534650e-05 3 1  ON 47
ci_49                -1.042422e-03 3 1  ON 48
ci_50                -8.897536e-04 3 1  ON 49
ci_51                 6.464406e-04 3 1  ON 50
ci_52                 5.812771e-04 3 1  ON 51
ci_53                -1.009109e-03 3 1  ON 52
ci_54                -9.535018e-04 3 1  ON 53
ci_55                -6.146569e-04 3 1  ON 54
ci_56                 1.767772e-03 3 1  ON 55
ci_57                 1.694407e-03 3 1  ON 56
ci_58                -9.194243e-04 3 1  ON 57
ci_59                -9.224272e-04 3 1  ON 58
ci_60                 6.052737e-04 3 1  ON 59
ci_61                 6.896105e-04 3 1  ON 60
ci_62                -5.167158e-04 3 1  ON 61
ci_63                -6.579218e-04 3 1  ON 62
ci_64                -5.170111e-04 3 1  ON 63
ci_65                -4.210757e-04 3 1  ON 64
ci_66                -7.526671e-04 3 1  ON 65
ci_67                -6.679291e-04 3 1  ON 66
ci_68                -5.325577e-04 3 1  ON 67
ci_69                -3.700990e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.779
    reference variance = 0.387101
====================================================
  Execution time = 2.5004e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9680e-01
  Total weights = 1.9639e+06
  Execution time = 3.5776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472439664790
                                         uncertainty =       0.003059919018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472439664790
                                         uncertainty =       0.003059919018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486021727
  error estimate for blocks of size 2^( 2) =       0.000507423077
  error estimate for blocks of size 2^( 3) =       0.000527073694
  error estimate for blocks of size 2^( 4) =       0.000541785454
  error estimate for blocks of size 2^( 5) =       0.000551750700
  error estimate for blocks of size 2^( 6) =       0.000557515980
  error estimate for blocks of size 2^( 7) =       0.000558939735

      target function =      -0.709467953848
              le_mean =     -22.818716881089
             les_mean =     521.190389426856
             stat err =       0.000552497967
             autocorr =       1.292260293016
   target nu stat err =       0.000552497967
   target dn stat err =       0.005820242983
      target stat err =       0.004136846491
              std dev =       0.687338518224
             le_variance =       0.472434238634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472326192208
                                         uncertainty =       0.003068254464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472326192208
                                         uncertainty =       0.003068254464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485963324
  error estimate for blocks of size 2^( 2) =       0.000507366722
  error estimate for blocks of size 2^( 3) =       0.000527025228
  error estimate for blocks of size 2^( 4) =       0.000541742695
  error estimate for blocks of size 2^( 5) =       0.000551716594
  error estimate for blocks of size 2^( 6) =       0.000557484217
  error estimate for blocks of size 2^( 7) =       0.000558901460

      target function =      -0.708266786030
              le_mean =     -22.818714040707
             les_mean =     521.191948461546
             stat err =       0.000552461242
             autocorr =       1.292399084380
   target nu stat err =       0.000552461242
   target dn stat err =       0.007308208278
      target stat err =       0.005160366247
              std dev =       0.687255924044
             le_variance =       0.472320705134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472371494173
                                         uncertainty =       0.003063232552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472371494173
                                         uncertainty =       0.003063232552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485986660
  error estimate for blocks of size 2^( 2) =       0.000507389361
  error estimate for blocks of size 2^( 3) =       0.000527044146
  error estimate for blocks of size 2^( 4) =       0.000541758917
  error estimate for blocks of size 2^( 5) =       0.000551728515
  error estimate for blocks of size 2^( 6) =       0.000557495436
  error estimate for blocks of size 2^( 7) =       0.000558915867

      target function =      -0.708778363637
              le_mean =     -22.818715304191
             les_mean =     521.191290068333
             stat err =       0.000552474684
             autocorr =       1.292337859972
   target nu stat err =       0.000552474684
   target dn stat err =       0.006417721365
      target stat err =       0.004545623019
              std dev =       0.687288925543
             le_variance =       0.472366067174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472430192913
                                         uncertainty =       0.003060270432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472430192913
                                         uncertainty =       0.003060270432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486016856
  error estimate for blocks of size 2^( 2) =       0.000507418396
  error estimate for blocks of size 2^( 3) =       0.000527069457
  error estimate for blocks of size 2^( 4) =       0.000541781500
  error estimate for blocks of size 2^( 5) =       0.000551747156
  error estimate for blocks of size 2^( 6) =       0.000557512319
  error estimate for blocks of size 2^( 7) =       0.000558935528

      target function =      -0.705365865455
              le_mean =     -22.818716708511
             les_mean =     521.196204717608
             stat err =       0.000552494126
             autocorr =       1.292268224489
   target nu stat err =       0.000552494126
   target dn stat err =       0.008267820943
      target stat err =       0.005783411040
              std dev =       0.687331629745
             le_variance =       0.472424769247


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709467953848        initial  <--
     1.4901e+00     1.4901e+01             3.3915e-04        -0.708266786030
     5.9605e+00     5.9605e+01             8.5932e-05        -0.708778363637
     2.3842e+01     2.3842e+02             2.1554e-05        -0.705365865455

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9468
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_01                 1.375085e-01 3 1  ON 0
ci_02                -3.560982e-02 3 1  ON 1
ci_03                -3.548311e-02 3 1  ON 2
ci_04                 3.162557e-02 3 1  ON 3
ci_05                -2.593850e-02 3 1  ON 4
ci_06                -2.549949e-02 3 1  ON 5
ci_07                 2.778737e-02 3 1  ON 6
ci_08                -8.355087e-03 3 1  ON 7
ci_09                -1.083815e-02 3 1  ON 8
ci_10                -1.085811e-02 3 1  ON 9
ci_11                 1.353762e-02 3 1  ON 10
ci_12                 8.713138e-03 3 1  ON 11
ci_13                 1.255360e-02 3 1  ON 12
ci_14                 1.255070e-02 3 1  ON 13
ci_15                 8.045478e-03 3 1  ON 14
ci_16                 8.136396e-03 3 1  ON 15
ci_17                -8.378863e-03 3 1  ON 16
ci_18                -8.050827e-03 3 1  ON 17
ci_19                 9.699080e-03 3 1  ON 18
ci_20                 7.448222e-03 3 1  ON 19
ci_21                 9.048684e-03 3 1  ON 20
ci_22                 9.139384e-03 3 1  ON 21
ci_23                 5.179611e-03 3 1  ON 22
ci_24                 4.719374e-03 3 1  ON 23
ci_25                 3.393126e-03 3 1  ON 24
ci_26                 3.440916e-03 3 1  ON 25
ci_27                 3.462132e-03 3 1  ON 26
ci_28                 2.471804e-03 3 1  ON 27
ci_29                 2.337973e-03 3 1  ON 28
ci_30                -1.976034e-03 3 1  ON 29
ci_31                -2.082652e-03 3 1  ON 30
ci_32                -1.433292e-03 3 1  ON 31
ci_33                -1.469800e-03 3 1  ON 32
ci_34                 1.403648e-03 3 1  ON 33
ci_35                 1.448331e-03 3 1  ON 34
ci_36                -1.311800e-03 3 1  ON 35
ci_37                -1.396469e-03 3 1  ON 36
ci_38                -9.570867e-04 3 1  ON 37
ci_39                -9.545718e-04 3 1  ON 38
ci_40                -1.611083e-03 3 1  ON 39
ci_41                -1.101743e-03 3 1  ON 40
ci_42                -9.569396e-04 3 1  ON 41
ci_43                -2.344891e-03 3 1  ON 42
ci_44                -1.666088e-03 3 1  ON 43
ci_45                -8.274254e-04 3 1  ON 44
ci_46                -7.689027e-04 3 1  ON 45
ci_47                 1.866934e-04 3 1  ON 46
ci_48                 4.849490e-06 3 1  ON 47
ci_49                -1.042417e-03 3 1  ON 48
ci_50                -8.884793e-04 3 1  ON 49
ci_51                 6.566224e-04 3 1  ON 50
ci_52                 5.750774e-04 3 1  ON 51
ci_53                -1.006676e-03 3 1  ON 52
ci_54                -9.525698e-04 3 1  ON 53
ci_55                -6.179760e-04 3 1  ON 54
ci_56                 1.766303e-03 3 1  ON 55
ci_57                 1.697141e-03 3 1  ON 56
ci_58                -9.186061e-04 3 1  ON 57
ci_59                -9.142995e-04 3 1  ON 58
ci_60                 5.936287e-04 3 1  ON 59
ci_61                 6.992744e-04 3 1  ON 60
ci_62                -5.158932e-04 3 1  ON 61
ci_63                -6.590316e-04 3 1  ON 62
ci_64                -5.182401e-04 3 1  ON 63
ci_65                -4.191920e-04 3 1  ON 64
ci_66                -7.561011e-04 3 1  ON 65
ci_67                -6.725385e-04 3 1  ON 66
ci_68                -5.304329e-04 3 1  ON 67
ci_69                -3.648321e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3262e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.7824
    reference variance = 0.505219
====================================================
  Execution time = 2.5901e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.8758e-01
  Total weights = 1.963845785e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6485e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471840613681
                                         uncertainty =       0.002137224467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471840613681
                                         uncertainty =       0.002137224467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485696454
  error estimate for blocks of size 2^( 2) =       0.000506911430
  error estimate for blocks of size 2^( 3) =       0.000526977034
  error estimate for blocks of size 2^( 4) =       0.000542890781
  error estimate for blocks of size 2^( 5) =       0.000553783266
  error estimate for blocks of size 2^( 6) =       0.000559073332
  error estimate for blocks of size 2^( 7) =       0.000563539487

      target function =      -0.715821055601
              le_mean =     -22.817111216818
             les_mean =     521.108145209800
             stat err =       0.000554821717
             autocorr =       1.304899419840
   target nu stat err =       0.000554821717
   target dn stat err =       0.003138743073
      target stat err =       0.002313357782
              std dev =       0.686878512402
             le_variance =       0.471802090799


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281711121682e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.715827646574       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.715834507609       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.715835661601       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.715835944435       residual = 8.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.715836033942       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.715836058038       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.715836057512       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.715836057886       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.715836057740       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.715836057651       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+01 is 4.072925e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.715827646574       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.715829365933       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.715829654890       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.715829725653       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.715829748017       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.715829754016       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.715829753879       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.715829753972       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.715829753936       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.715829753914       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+01 is 1.019581e-05

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.715827646574       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.715828076671       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.715828148939       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.715828166633       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.715828172223       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.715828173721       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.715828173687       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.715828173710       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.715828173701       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.715828173696       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+02 is 2.549799e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.798163 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0558e+01
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_01                 1.374983e-01 3 1  ON 0
ci_02                -3.560311e-02 3 1  ON 1
ci_03                -3.547580e-02 3 1  ON 2
ci_04                 3.161674e-02 3 1  ON 3
ci_05                -2.593227e-02 3 1  ON 4
ci_06                -2.549371e-02 3 1  ON 5
ci_07                 2.778607e-02 3 1  ON 6
ci_08                -8.351559e-03 3 1  ON 7
ci_09                -1.083502e-02 3 1  ON 8
ci_10                -1.085513e-02 3 1  ON 9
ci_11                 1.353652e-02 3 1  ON 10
ci_12                 8.710652e-03 3 1  ON 11
ci_13                 1.255353e-02 3 1  ON 12
ci_14                 1.255206e-02 3 1  ON 13
ci_15                 8.045122e-03 3 1  ON 14
ci_16                 8.134660e-03 3 1  ON 15
ci_17                -8.376549e-03 3 1  ON 16
ci_18                -8.049088e-03 3 1  ON 17
ci_19                 9.698505e-03 3 1  ON 18
ci_20                 7.446598e-03 3 1  ON 19
ci_21                 9.047821e-03 3 1  ON 20
ci_22                 9.139391e-03 3 1  ON 21
ci_23                 5.179854e-03 3 1  ON 22
ci_24                 4.718496e-03 3 1  ON 23
ci_25                 3.392017e-03 3 1  ON 24
ci_26                 3.440909e-03 3 1  ON 25
ci_27                 3.462013e-03 3 1  ON 26
ci_28                 2.470472e-03 3 1  ON 27
ci_29                 2.337194e-03 3 1  ON 28
ci_30                -1.975934e-03 3 1  ON 29
ci_31                -2.083121e-03 3 1  ON 30
ci_32                -1.432359e-03 3 1  ON 31
ci_33                -1.469732e-03 3 1  ON 32
ci_34                 1.402538e-03 3 1  ON 33
ci_35                 1.447379e-03 3 1  ON 34
ci_36                -1.311668e-03 3 1  ON 35
ci_37                -1.396129e-03 3 1  ON 36
ci_38                -9.563466e-04 3 1  ON 37
ci_39                -9.541809e-04 3 1  ON 38
ci_40                -1.611023e-03 3 1  ON 39
ci_41                -1.101804e-03 3 1  ON 40
ci_42                -9.570851e-04 3 1  ON 41
ci_43                -2.344549e-03 3 1  ON 42
ci_44                -1.666362e-03 3 1  ON 43
ci_45                -8.270939e-04 3 1  ON 44
ci_46                -7.682411e-04 3 1  ON 45
ci_47                 1.871350e-04 3 1  ON 46
ci_48                 5.446971e-06 3 1  ON 47
ci_49                -1.042557e-03 3 1  ON 48
ci_50                -8.879515e-04 3 1  ON 49
ci_51                 6.562219e-04 3 1  ON 50
ci_52                 5.747001e-04 3 1  ON 51
ci_53                -1.006901e-03 3 1  ON 52
ci_54                -9.525494e-04 3 1  ON 53
ci_55                -6.178197e-04 3 1  ON 54
ci_56                 1.766490e-03 3 1  ON 55
ci_57                 1.697092e-03 3 1  ON 56
ci_58                -9.186111e-04 3 1  ON 57
ci_59                -9.133116e-04 3 1  ON 58
ci_60                 5.931173e-04 3 1  ON 59
ci_61                 6.987943e-04 3 1  ON 60
ci_62                -5.155508e-04 3 1  ON 61
ci_63                -6.590668e-04 3 1  ON 62
ci_64                -5.175381e-04 3 1  ON 63
ci_65                -4.185890e-04 3 1  ON 64
ci_66                -7.562103e-04 3 1  ON 65
ci_67                -6.727816e-04 3 1  ON 66
ci_68                -5.314669e-04 3 1  ON 67
ci_69                -3.651703e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.8112
    reference variance = 0.542003
====================================================
  Execution time = 2.5034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8884e-01
  Total weights = 1.9638e+06
  Execution time = 3.6102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472246184349
                                         uncertainty =       0.002869103899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472246184349
                                         uncertainty =       0.002869103899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485878891
  error estimate for blocks of size 2^( 2) =       0.000506781207
  error estimate for blocks of size 2^( 3) =       0.000526695529
  error estimate for blocks of size 2^( 4) =       0.000541653533
  error estimate for blocks of size 2^( 5) =       0.000550268751
  error estimate for blocks of size 2^( 6) =       0.000557636707
  error estimate for blocks of size 2^( 7) =       0.000560851263

      target function =      -0.714992498708
              le_mean =     -22.818900328132
             les_mean =     521.191007730201
             stat err =       0.000552602564
             autocorr =       1.293509812790
   target nu stat err =       0.000552602564
   target dn stat err =       0.003360734926
      target stat err =       0.002467969918
              std dev =       0.687136517267
             le_variance =       0.472156593361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472221323796
                                         uncertainty =       0.002868124686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472221323796
                                         uncertainty =       0.002868124686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485866110
  error estimate for blocks of size 2^( 2) =       0.000506769250
  error estimate for blocks of size 2^( 3) =       0.000526684411
  error estimate for blocks of size 2^( 4) =       0.000541642900
  error estimate for blocks of size 2^( 5) =       0.000550258162
  error estimate for blocks of size 2^( 6) =       0.000557626276
  error estimate for blocks of size 2^( 7) =       0.000560841148

      target function =      -0.714822325065
              le_mean =     -22.818900133476
             les_mean =     521.191236414555
             stat err =       0.000552592122
             autocorr =       1.293528977990
   target nu stat err =       0.000552592122
   target dn stat err =       0.003401114669
      target stat err =       0.002494980622
              std dev =       0.687118442718
             le_variance =       0.472131754323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472233706290
                                         uncertainty =       0.002868612612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472233706290
                                         uncertainty =       0.002868612612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485872476
  error estimate for blocks of size 2^( 2) =       0.000506775205
  error estimate for blocks of size 2^( 3) =       0.000526689952
  error estimate for blocks of size 2^( 4) =       0.000541648201
  error estimate for blocks of size 2^( 5) =       0.000550263441
  error estimate for blocks of size 2^( 6) =       0.000557631477
  error estimate for blocks of size 2^( 7) =       0.000560846184

      target function =      -0.714925112974
              le_mean =     -22.818900228935
             les_mean =     521.191097274391
             stat err =       0.000552597326
             autocorr =       1.293519446765
   target nu stat err =       0.000552597326
   target dn stat err =       0.003374960115
      target stat err =       0.002477435869
              std dev =       0.687127445316
             le_variance =       0.472144126106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472244621511
                                         uncertainty =       0.002869042379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472244621511
                                         uncertainty =       0.002869042379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485878088
  error estimate for blocks of size 2^( 2) =       0.000506780455
  error estimate for blocks of size 2^( 3) =       0.000526694830
  error estimate for blocks of size 2^( 4) =       0.000541652865
  error estimate for blocks of size 2^( 5) =       0.000550268086
  error estimate for blocks of size 2^( 6) =       0.000557636053
  error estimate for blocks of size 2^( 7) =       0.000560850627

      target function =      -0.714985664699
              le_mean =     -22.818900315489
             les_mean =     521.191016693456
             stat err =       0.000552601908
             autocorr =       1.293511020376
   target nu stat err =       0.000552601908
   target dn stat err =       0.003362075017
      target stat err =       0.002468858414
              std dev =       0.687135381040
             le_variance =       0.472155031877


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.714992498708        initial  <--
     1.4901e+01     1.4901e+02             4.0729e-05        -0.714822325065
     5.9605e+01     5.9605e+02             1.0196e-05        -0.714925112974
     2.3842e+02     2.3842e+03             2.5498e-06        -0.714985664699

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.1357
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_01                 1.375085e-01 3 1  ON 0
ci_02                -3.560982e-02 3 1  ON 1
ci_03                -3.548311e-02 3 1  ON 2
ci_04                 3.162557e-02 3 1  ON 3
ci_05                -2.593850e-02 3 1  ON 4
ci_06                -2.549949e-02 3 1  ON 5
ci_07                 2.778737e-02 3 1  ON 6
ci_08                -8.355087e-03 3 1  ON 7
ci_09                -1.083815e-02 3 1  ON 8
ci_10                -1.085811e-02 3 1  ON 9
ci_11                 1.353762e-02 3 1  ON 10
ci_12                 8.713138e-03 3 1  ON 11
ci_13                 1.255360e-02 3 1  ON 12
ci_14                 1.255070e-02 3 1  ON 13
ci_15                 8.045478e-03 3 1  ON 14
ci_16                 8.136396e-03 3 1  ON 15
ci_17                -8.378863e-03 3 1  ON 16
ci_18                -8.050827e-03 3 1  ON 17
ci_19                 9.699080e-03 3 1  ON 18
ci_20                 7.448222e-03 3 1  ON 19
ci_21                 9.048684e-03 3 1  ON 20
ci_22                 9.139384e-03 3 1  ON 21
ci_23                 5.179611e-03 3 1  ON 22
ci_24                 4.719374e-03 3 1  ON 23
ci_25                 3.393126e-03 3 1  ON 24
ci_26                 3.440916e-03 3 1  ON 25
ci_27                 3.462132e-03 3 1  ON 26
ci_28                 2.471804e-03 3 1  ON 27
ci_29                 2.337973e-03 3 1  ON 28
ci_30                -1.976034e-03 3 1  ON 29
ci_31                -2.082652e-03 3 1  ON 30
ci_32                -1.433292e-03 3 1  ON 31
ci_33                -1.469800e-03 3 1  ON 32
ci_34                 1.403648e-03 3 1  ON 33
ci_35                 1.448331e-03 3 1  ON 34
ci_36                -1.311800e-03 3 1  ON 35
ci_37                -1.396469e-03 3 1  ON 36
ci_38                -9.570867e-04 3 1  ON 37
ci_39                -9.545718e-04 3 1  ON 38
ci_40                -1.611083e-03 3 1  ON 39
ci_41                -1.101743e-03 3 1  ON 40
ci_42                -9.569396e-04 3 1  ON 41
ci_43                -2.344891e-03 3 1  ON 42
ci_44                -1.666088e-03 3 1  ON 43
ci_45                -8.274254e-04 3 1  ON 44
ci_46                -7.689027e-04 3 1  ON 45
ci_47                 1.866934e-04 3 1  ON 46
ci_48                 4.849490e-06 3 1  ON 47
ci_49                -1.042417e-03 3 1  ON 48
ci_50                -8.884793e-04 3 1  ON 49
ci_51                 6.566224e-04 3 1  ON 50
ci_52                 5.750774e-04 3 1  ON 51
ci_53                -1.006676e-03 3 1  ON 52
ci_54                -9.525698e-04 3 1  ON 53
ci_55                -6.179760e-04 3 1  ON 54
ci_56                 1.766303e-03 3 1  ON 55
ci_57                 1.697141e-03 3 1  ON 56
ci_58                -9.186061e-04 3 1  ON 57
ci_59                -9.142995e-04 3 1  ON 58
ci_60                 5.936287e-04 3 1  ON 59
ci_61                 6.992744e-04 3 1  ON 60
ci_62                -5.158932e-04 3 1  ON 61
ci_63                -6.590316e-04 3 1  ON 62
ci_64                -5.182401e-04 3 1  ON 63
ci_65                -4.191920e-04 3 1  ON 64
ci_66                -7.561011e-04 3 1  ON 65
ci_67                -6.725385e-04 3 1  ON 66
ci_68                -5.304329e-04 3 1  ON 67
ci_69                -3.648321e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3700e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.8488
    reference variance = 0.412009
====================================================
  Execution time = 2.5735e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9581e-01
  Total weights = 1.963631879e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478427163582
                                         uncertainty =       0.002881834816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478427163582
                                         uncertainty =       0.002881834816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489085451
  error estimate for blocks of size 2^( 2) =       0.000510206432
  error estimate for blocks of size 2^( 3) =       0.000530264518
  error estimate for blocks of size 2^( 4) =       0.000545025591
  error estimate for blocks of size 2^( 5) =       0.000554572017
  error estimate for blocks of size 2^( 6) =       0.000562474445
  error estimate for blocks of size 2^( 7) =       0.000567363748

      target function =      -0.709995366320
              le_mean =     -22.818265430642
             les_mean =     521.169045823730
             stat err =       0.000557358950
             autocorr =       1.298674971337
   target nu stat err =       0.000557358950
   target dn stat err =       0.004112864077
      target stat err =       0.002952253415
              std dev =       0.691671278468
             le_variance =       0.478409157458


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281826543064e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710006803853       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710007541191       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710007687478       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710007724120       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710007739950       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710007745100       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710007745196       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710007745245       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710007745259       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710007745263       residual = 8.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 5.173746e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710006803853       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710006988233       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710007024810       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710007033971       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710007037928       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710007039216       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710007039240       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710007039252       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710007039255       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710007039255       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 1.293598e-06

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710006803853       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710006849951       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710006859095       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710006861385       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710006862380       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710006862707       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710006862702       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710006862706       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710006862706       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710006862705       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 3.234095e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.801642 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0342e+01
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_01                 1.375072e-01 3 1  ON 0
ci_02                -3.560907e-02 3 1  ON 1
ci_03                -3.548235e-02 3 1  ON 2
ci_04                 3.162465e-02 3 1  ON 3
ci_05                -2.593776e-02 3 1  ON 4
ci_06                -2.549912e-02 3 1  ON 5
ci_07                 2.778743e-02 3 1  ON 6
ci_08                -8.354823e-03 3 1  ON 7
ci_09                -1.083810e-02 3 1  ON 8
ci_10                -1.085793e-02 3 1  ON 9
ci_11                 1.353758e-02 3 1  ON 10
ci_12                 8.713105e-03 3 1  ON 11
ci_13                 1.255365e-02 3 1  ON 12
ci_14                 1.255080e-02 3 1  ON 13
ci_15                 8.045534e-03 3 1  ON 14
ci_16                 8.136352e-03 3 1  ON 15
ci_17                -8.378731e-03 3 1  ON 16
ci_18                -8.050784e-03 3 1  ON 17
ci_19                 9.699041e-03 3 1  ON 18
ci_20                 7.448127e-03 3 1  ON 19
ci_21                 9.048793e-03 3 1  ON 20
ci_22                 9.139416e-03 3 1  ON 21
ci_23                 5.179618e-03 3 1  ON 22
ci_24                 4.719104e-03 3 1  ON 23
ci_25                 3.393027e-03 3 1  ON 24
ci_26                 3.440762e-03 3 1  ON 25
ci_27                 3.461883e-03 3 1  ON 26
ci_28                 2.471532e-03 3 1  ON 27
ci_29                 2.337975e-03 3 1  ON 28
ci_30                -1.975966e-03 3 1  ON 29
ci_31                -2.082899e-03 3 1  ON 30
ci_32                -1.433309e-03 3 1  ON 31
ci_33                -1.469689e-03 3 1  ON 32
ci_34                 1.403615e-03 3 1  ON 33
ci_35                 1.448269e-03 3 1  ON 34
ci_36                -1.311745e-03 3 1  ON 35
ci_37                -1.396369e-03 3 1  ON 36
ci_38                -9.569885e-04 3 1  ON 37
ci_39                -9.544729e-04 3 1  ON 38
ci_40                -1.611112e-03 3 1  ON 39
ci_41                -1.101721e-03 3 1  ON 40
ci_42                -9.568414e-04 3 1  ON 41
ci_43                -2.344835e-03 3 1  ON 42
ci_44                -1.666040e-03 3 1  ON 43
ci_45                -8.274132e-04 3 1  ON 44
ci_46                -7.689520e-04 3 1  ON 45
ci_47                 1.867877e-04 3 1  ON 46
ci_48                 4.906065e-06 3 1  ON 47
ci_49                -1.042368e-03 3 1  ON 48
ci_50                -8.884757e-04 3 1  ON 49
ci_51                 6.564829e-04 3 1  ON 50
ci_52                 5.751054e-04 3 1  ON 51
ci_53                -1.006564e-03 3 1  ON 52
ci_54                -9.525936e-04 3 1  ON 53
ci_55                -6.179724e-04 3 1  ON 54
ci_56                 1.766300e-03 3 1  ON 55
ci_57                 1.697301e-03 3 1  ON 56
ci_58                -9.184243e-04 3 1  ON 57
ci_59                -9.143417e-04 3 1  ON 58
ci_60                 5.937476e-04 3 1  ON 59
ci_61                 6.991691e-04 3 1  ON 60
ci_62                -5.159511e-04 3 1  ON 61
ci_63                -6.590988e-04 3 1  ON 62
ci_64                -5.182766e-04 3 1  ON 63
ci_65                -4.192059e-04 3 1  ON 64
ci_66                -7.560385e-04 3 1  ON 65
ci_67                -6.725818e-04 3 1  ON 66
ci_68                -5.303866e-04 3 1  ON 67
ci_69                -3.649521e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.7936
    reference variance = 0.277165
====================================================
  Execution time = 2.5172e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9060e-01
  Total weights = 1.9639e+06
  Execution time = 3.5990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475375325266
                                         uncertainty =       0.002438808225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475375325266
                                         uncertainty =       0.002438808225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487551324
  error estimate for blocks of size 2^( 2) =       0.000508215136
  error estimate for blocks of size 2^( 3) =       0.000527355315
  error estimate for blocks of size 2^( 4) =       0.000541929868
  error estimate for blocks of size 2^( 5) =       0.000551351583
  error estimate for blocks of size 2^( 6) =       0.000557954410
  error estimate for blocks of size 2^( 7) =       0.000560763074

      target function =      -0.713700577808
              le_mean =     -22.818825555053
             les_mean =     521.189400451913
             stat err =       0.000552999734
             autocorr =       1.286498144655
   target nu stat err =       0.000552999734
   target dn stat err =       0.003556443339
      target stat err =       0.002595282911
              std dev =       0.689501694615
             le_variance =       0.475412586876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475373000356
                                         uncertainty =       0.002438771591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475373000356
                                         uncertainty =       0.002438771591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487550133
  error estimate for blocks of size 2^( 2) =       0.000508214035
  error estimate for blocks of size 2^( 3) =       0.000527354306
  error estimate for blocks of size 2^( 4) =       0.000541928916
  error estimate for blocks of size 2^( 5) =       0.000551350683
  error estimate for blocks of size 2^( 6) =       0.000557953546
  error estimate for blocks of size 2^( 7) =       0.000560762209

      target function =      -0.713702460719
              le_mean =     -22.818825589314
             les_mean =     521.189399372021
             stat err =       0.000552998838
             autocorr =       1.286500263283
   target nu stat err =       0.000552998838
   target dn stat err =       0.003556956301
      target stat err =       0.002595653608
              std dev =       0.689500010652
             le_variance =       0.475410264689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475374162355
                                         uncertainty =       0.002438789897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475374162355
                                         uncertainty =       0.002438789897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487550728
  error estimate for blocks of size 2^( 2) =       0.000508214585
  error estimate for blocks of size 2^( 3) =       0.000527354811
  error estimate for blocks of size 2^( 4) =       0.000541929392
  error estimate for blocks of size 2^( 5) =       0.000551351133
  error estimate for blocks of size 2^( 6) =       0.000557953978
  error estimate for blocks of size 2^( 7) =       0.000560762641

      target function =      -0.713701528047
              le_mean =     -22.818825572160
             les_mean =     521.189399898585
             stat err =       0.000552999286
             autocorr =       1.286499204237
   target nu stat err =       0.000552999286
   target dn stat err =       0.003556699650
      target stat err =       0.002595468202
              std dev =       0.689500852303
             le_variance =       0.475411425326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475375179872
                                         uncertainty =       0.002438805933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475375179872
                                         uncertainty =       0.002438805933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487551249
  error estimate for blocks of size 2^( 2) =       0.000508215067
  error estimate for blocks of size 2^( 3) =       0.000527355252
  error estimate for blocks of size 2^( 4) =       0.000541929808
  error estimate for blocks of size 2^( 5) =       0.000551351527
  error estimate for blocks of size 2^( 6) =       0.000557954356
  error estimate for blocks of size 2^( 7) =       0.000560763020

      target function =      -0.713700697556
              le_mean =     -22.818825557188
             les_mean =     521.189400381262
             stat err =       0.000552999678
             autocorr =       1.286498277120
   target nu stat err =       0.000552999678
   target dn stat err =       0.003556475354
      target stat err =       0.002595306062
              std dev =       0.689501589304
             le_variance =       0.475412441652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.713700577808        initial
     1.4901e+02     1.4901e+03             5.1737e-06        -0.713702460719  <--
     5.9605e+02     5.9605e+03             1.2936e-06        -0.713701528047
     2.3842e+03     2.3842e+04             3.2341e-07        -0.713700697556

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 4.3235e+01
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_01                 1.375033e-01 3 1  ON 0
ci_02                -3.560681e-02 3 1  ON 1
ci_03                -3.548008e-02 3 1  ON 2
ci_04                 3.162191e-02 3 1  ON 3
ci_05                -2.593556e-02 3 1  ON 4
ci_06                -2.549800e-02 3 1  ON 5
ci_07                 2.778763e-02 3 1  ON 6
ci_08                -8.354030e-03 3 1  ON 7
ci_09                -1.083797e-02 3 1  ON 8
ci_10                -1.085739e-02 3 1  ON 9
ci_11                 1.353749e-02 3 1  ON 10
ci_12                 8.713004e-03 3 1  ON 11
ci_13                 1.255379e-02 3 1  ON 12
ci_14                 1.255111e-02 3 1  ON 13
ci_15                 8.045701e-03 3 1  ON 14
ci_16                 8.136218e-03 3 1  ON 15
ci_17                -8.378334e-03 3 1  ON 16
ci_18                -8.050656e-03 3 1  ON 17
ci_19                 9.698921e-03 3 1  ON 18
ci_20                 7.447840e-03 3 1  ON 19
ci_21                 9.049121e-03 3 1  ON 20
ci_22                 9.139511e-03 3 1  ON 21
ci_23                 5.179640e-03 3 1  ON 22
ci_24                 4.718294e-03 3 1  ON 23
ci_25                 3.392730e-03 3 1  ON 24
ci_26                 3.440303e-03 3 1  ON 25
ci_27                 3.461134e-03 3 1  ON 26
ci_28                 2.470715e-03 3 1  ON 27
ci_29                 2.337984e-03 3 1  ON 28
ci_30                -1.975763e-03 3 1  ON 29
ci_31                -2.083639e-03 3 1  ON 30
ci_32                -1.433359e-03 3 1  ON 31
ci_33                -1.469356e-03 3 1  ON 32
ci_34                 1.403515e-03 3 1  ON 33
ci_35                 1.448084e-03 3 1  ON 34
ci_36                -1.311581e-03 3 1  ON 35
ci_37                -1.396071e-03 3 1  ON 36
ci_38                -9.566943e-04 3 1  ON 37
ci_39                -9.541763e-04 3 1  ON 38
ci_40                -1.611200e-03 3 1  ON 39
ci_41                -1.101654e-03 3 1  ON 40
ci_42                -9.565470e-04 3 1  ON 41
ci_43                -2.344666e-03 3 1  ON 42
ci_44                -1.665895e-03 3 1  ON 43
ci_45                -8.273765e-04 3 1  ON 44
ci_46                -7.691000e-04 3 1  ON 45
ci_47                 1.870703e-04 3 1  ON 46
ci_48                 5.075755e-06 3 1  ON 47
ci_49                -1.042219e-03 3 1  ON 48
ci_50                -8.884649e-04 3 1  ON 49
ci_51                 6.560646e-04 3 1  ON 50
ci_52                 5.751894e-04 3 1  ON 51
ci_53                -1.006230e-03 3 1  ON 52
ci_54                -9.526648e-04 3 1  ON 53
ci_55                -6.179618e-04 3 1  ON 54
ci_56                 1.766291e-03 3 1  ON 55
ci_57                 1.697780e-03 3 1  ON 56
ci_58                -9.178791e-04 3 1  ON 57
ci_59                -9.144683e-04 3 1  ON 58
ci_60                 5.941041e-04 3 1  ON 59
ci_61                 6.988530e-04 3 1  ON 60
ci_62                -5.161246e-04 3 1  ON 61
ci_63                -6.593001e-04 3 1  ON 62
ci_64                -5.183861e-04 3 1  ON 63
ci_65                -4.192476e-04 3 1  ON 64
ci_66                -7.558509e-04 3 1  ON 65
ci_67                -6.727119e-04 3 1  ON 66
ci_68                -5.302476e-04 3 1  ON 67
ci_69                -3.653120e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3583e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.7369
    reference variance = 0.341747
====================================================
  Execution time = 2.5670e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8726e-01
  Total weights = 1.963530983e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471624031583
                                         uncertainty =       0.002217054330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471624031583
                                         uncertainty =       0.002217054330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485660145
  error estimate for blocks of size 2^( 2) =       0.000507020225
  error estimate for blocks of size 2^( 3) =       0.000526773417
  error estimate for blocks of size 2^( 4) =       0.000541180987
  error estimate for blocks of size 2^( 5) =       0.000550566227
  error estimate for blocks of size 2^( 6) =       0.000555514973
  error estimate for blocks of size 2^( 7) =       0.000558507188

      target function =      -0.716066273926
              le_mean =     -22.817849522139
             les_mean =     521.141521772939
             stat err =       0.000551442344
             autocorr =       1.289244515020
   target nu stat err =       0.000551442344
   target dn stat err =       0.002990794943
      target stat err =       0.002213630716
              std dev =       0.686827163443
             le_variance =       0.471731552443


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281784952214e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.716072298178       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.716075031778       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.716075480675       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.716075593539       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.716075616899       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.716075619185       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.716075619457       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.716075619773       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.716075619614       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.716075619569       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 1.970377e-05

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.716072298178       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.716072982232       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.716073094523       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.716073122745       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.716073128579       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.716073129149       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.716073129217       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.716073129295       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.716073129256       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.716073129244       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 4.928517e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.716072298178       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.716072469232       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.716072497309       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.716072504365       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.716072505823       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.716072505966       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.716072505983       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.716072506002       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.716072505991       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.716072505990       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 1.232290e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.805138 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0293e+01
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_01                 1.374984e-01 3 1  ON 0
ci_02                -3.560364e-02 3 1  ON 1
ci_03                -3.547709e-02 3 1  ON 2
ci_04                 3.161853e-02 3 1  ON 3
ci_05                -2.593360e-02 3 1  ON 4
ci_06                -2.549601e-02 3 1  ON 5
ci_07                 2.778714e-02 3 1  ON 6
ci_08                -8.352749e-03 3 1  ON 7
ci_09                -1.083713e-02 3 1  ON 8
ci_10                -1.085684e-02 3 1  ON 9
ci_11                 1.353689e-02 3 1  ON 10
ci_12                 8.712085e-03 3 1  ON 11
ci_13                 1.255398e-02 3 1  ON 12
ci_14                 1.255123e-02 3 1  ON 13
ci_15                 8.044652e-03 3 1  ON 14
ci_16                 8.135510e-03 3 1  ON 15
ci_17                -8.378213e-03 3 1  ON 16
ci_18                -8.049907e-03 3 1  ON 17
ci_19                 9.698505e-03 3 1  ON 18
ci_20                 7.447674e-03 3 1  ON 19
ci_21                 9.049445e-03 3 1  ON 20
ci_22                 9.139339e-03 3 1  ON 21
ci_23                 5.179522e-03 3 1  ON 22
ci_24                 4.717864e-03 3 1  ON 23
ci_25                 3.392461e-03 3 1  ON 24
ci_26                 3.440124e-03 3 1  ON 25
ci_27                 3.460994e-03 3 1  ON 26
ci_28                 2.470400e-03 3 1  ON 27
ci_29                 2.337458e-03 3 1  ON 28
ci_30                -1.975415e-03 3 1  ON 29
ci_31                -2.083298e-03 3 1  ON 30
ci_32                -1.433052e-03 3 1  ON 31
ci_33                -1.468812e-03 3 1  ON 32
ci_34                 1.403417e-03 3 1  ON 33
ci_35                 1.447600e-03 3 1  ON 34
ci_36                -1.311515e-03 3 1  ON 35
ci_37                -1.395633e-03 3 1  ON 36
ci_38                -9.565973e-04 3 1  ON 37
ci_39                -9.538894e-04 3 1  ON 38
ci_40                -1.611184e-03 3 1  ON 39
ci_41                -1.101428e-03 3 1  ON 40
ci_42                -9.565648e-04 3 1  ON 41
ci_43                -2.345188e-03 3 1  ON 42
ci_44                -1.666377e-03 3 1  ON 43
ci_45                -8.270233e-04 3 1  ON 44
ci_46                -7.689711e-04 3 1  ON 45
ci_47                 1.874119e-04 3 1  ON 46
ci_48                 5.567092e-06 3 1  ON 47
ci_49                -1.042088e-03 3 1  ON 48
ci_50                -8.884852e-04 3 1  ON 49
ci_51                 6.558755e-04 3 1  ON 50
ci_52                 5.750528e-04 3 1  ON 51
ci_53                -1.006232e-03 3 1  ON 52
ci_54                -9.527841e-04 3 1  ON 53
ci_55                -6.183869e-04 3 1  ON 54
ci_56                 1.766290e-03 3 1  ON 55
ci_57                 1.697616e-03 3 1  ON 56
ci_58                -9.179782e-04 3 1  ON 57
ci_59                -9.141932e-04 3 1  ON 58
ci_60                 5.944860e-04 3 1  ON 59
ci_61                 6.984391e-04 3 1  ON 60
ci_62                -5.160820e-04 3 1  ON 61
ci_63                -6.590581e-04 3 1  ON 62
ci_64                -5.183767e-04 3 1  ON 63
ci_65                -4.190392e-04 3 1  ON 64
ci_66                -7.555743e-04 3 1  ON 65
ci_67                -6.727445e-04 3 1  ON 66
ci_68                -5.301335e-04 3 1  ON 67
ci_69                -3.652964e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.8726
    reference variance = 0.489718
====================================================
  Execution time = 2.5057e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8781e-01
  Total weights = 1.9636e+06
  Execution time = 3.5999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472177495306
                                         uncertainty =       0.002004518405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472177495306
                                         uncertainty =       0.002004518405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485862065
  error estimate for blocks of size 2^( 2) =       0.000506944711
  error estimate for blocks of size 2^( 3) =       0.000527540993
  error estimate for blocks of size 2^( 4) =       0.000542630867
  error estimate for blocks of size 2^( 5) =       0.000552060732
  error estimate for blocks of size 2^( 6) =       0.000558081018
  error estimate for blocks of size 2^( 7) =       0.000561592685

      target function =      -0.715689337256
              le_mean =     -22.818424885200
             les_mean =     521.168323952176
             stat err =       0.000553591326
             autocorr =       1.298232776719
   target nu stat err =       0.000553591326
   target dn stat err =       0.003049734486
      target stat err =       0.002254606693
              std dev =       0.687112721782
             le_variance =       0.472123892435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472167730186
                                         uncertainty =       0.002004184618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472167730186
                                         uncertainty =       0.002004184618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485857038
  error estimate for blocks of size 2^( 2) =       0.000506940029
  error estimate for blocks of size 2^( 3) =       0.000527536668
  error estimate for blocks of size 2^( 4) =       0.000542626800
  error estimate for blocks of size 2^( 5) =       0.000552056913
  error estimate for blocks of size 2^( 6) =       0.000558077305
  error estimate for blocks of size 2^( 7) =       0.000561589068

      target function =      -0.715687487152
              le_mean =     -22.818424923363
             les_mean =     521.168328267633
             stat err =       0.000553587522
             autocorr =       1.298241800348
   target nu stat err =       0.000553587522
   target dn stat err =       0.003051240909
      target stat err =       0.002255640961
              std dev =       0.687105612383
             le_variance =       0.472114122568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472172605303
                                         uncertainty =       0.002004351361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472172605303
                                         uncertainty =       0.002004351361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485859548
  error estimate for blocks of size 2^( 2) =       0.000506942366
  error estimate for blocks of size 2^( 3) =       0.000527538827
  error estimate for blocks of size 2^( 4) =       0.000542628830
  error estimate for blocks of size 2^( 5) =       0.000552058820
  error estimate for blocks of size 2^( 6) =       0.000558079159
  error estimate for blocks of size 2^( 7) =       0.000561590875

      target function =      -0.715688550589
              le_mean =     -22.818424903913
             les_mean =     521.168325900130
             stat err =       0.000553589421
             autocorr =       1.298237297555
   target nu stat err =       0.000553589421
   target dn stat err =       0.003050460606
      target stat err =       0.002255105850
              std dev =       0.687109161676
             le_variance =       0.472119000060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472176883561
                                         uncertainty =       0.002004497519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472176883561
                                         uncertainty =       0.002004497519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485861750
  error estimate for blocks of size 2^( 2) =       0.000506944418
  error estimate for blocks of size 2^( 3) =       0.000527540722
  error estimate for blocks of size 2^( 4) =       0.000542630612
  error estimate for blocks of size 2^( 5) =       0.000552060493
  error estimate for blocks of size 2^( 6) =       0.000558080786
  error estimate for blocks of size 2^( 7) =       0.000561592459

      target function =      -0.715689253946
              le_mean =     -22.818424887498
             les_mean =     521.168324172818
             stat err =       0.000553591088
             autocorr =       1.298233342500
   target nu stat err =       0.000553591088
   target dn stat err =       0.003049822343
      target stat err =       0.002254667159
              std dev =       0.687112276410
             le_variance =       0.472123280394


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.715689337256        initial  <--
     3.7253e+01     3.7253e+02             1.9704e-05        -0.715687487152
     1.4901e+02     1.4901e+03             4.9285e-06        -0.715688550589
     5.9605e+02     5.9605e+03             1.2323e-06        -0.715689253946

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9808
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_01                 1.375033e-01 3 1  ON 0
ci_02                -3.560681e-02 3 1  ON 1
ci_03                -3.548008e-02 3 1  ON 2
ci_04                 3.162191e-02 3 1  ON 3
ci_05                -2.593556e-02 3 1  ON 4
ci_06                -2.549800e-02 3 1  ON 5
ci_07                 2.778763e-02 3 1  ON 6
ci_08                -8.354030e-03 3 1  ON 7
ci_09                -1.083797e-02 3 1  ON 8
ci_10                -1.085739e-02 3 1  ON 9
ci_11                 1.353749e-02 3 1  ON 10
ci_12                 8.713004e-03 3 1  ON 11
ci_13                 1.255379e-02 3 1  ON 12
ci_14                 1.255111e-02 3 1  ON 13
ci_15                 8.045701e-03 3 1  ON 14
ci_16                 8.136218e-03 3 1  ON 15
ci_17                -8.378334e-03 3 1  ON 16
ci_18                -8.050656e-03 3 1  ON 17
ci_19                 9.698921e-03 3 1  ON 18
ci_20                 7.447840e-03 3 1  ON 19
ci_21                 9.049121e-03 3 1  ON 20
ci_22                 9.139511e-03 3 1  ON 21
ci_23                 5.179640e-03 3 1  ON 22
ci_24                 4.718294e-03 3 1  ON 23
ci_25                 3.392730e-03 3 1  ON 24
ci_26                 3.440303e-03 3 1  ON 25
ci_27                 3.461134e-03 3 1  ON 26
ci_28                 2.470715e-03 3 1  ON 27
ci_29                 2.337984e-03 3 1  ON 28
ci_30                -1.975763e-03 3 1  ON 29
ci_31                -2.083639e-03 3 1  ON 30
ci_32                -1.433359e-03 3 1  ON 31
ci_33                -1.469356e-03 3 1  ON 32
ci_34                 1.403515e-03 3 1  ON 33
ci_35                 1.448084e-03 3 1  ON 34
ci_36                -1.311581e-03 3 1  ON 35
ci_37                -1.396071e-03 3 1  ON 36
ci_38                -9.566943e-04 3 1  ON 37
ci_39                -9.541763e-04 3 1  ON 38
ci_40                -1.611200e-03 3 1  ON 39
ci_41                -1.101654e-03 3 1  ON 40
ci_42                -9.565470e-04 3 1  ON 41
ci_43                -2.344666e-03 3 1  ON 42
ci_44                -1.665895e-03 3 1  ON 43
ci_45                -8.273765e-04 3 1  ON 44
ci_46                -7.691000e-04 3 1  ON 45
ci_47                 1.870703e-04 3 1  ON 46
ci_48                 5.075755e-06 3 1  ON 47
ci_49                -1.042219e-03 3 1  ON 48
ci_50                -8.884649e-04 3 1  ON 49
ci_51                 6.560646e-04 3 1  ON 50
ci_52                 5.751894e-04 3 1  ON 51
ci_53                -1.006230e-03 3 1  ON 52
ci_54                -9.526648e-04 3 1  ON 53
ci_55                -6.179618e-04 3 1  ON 54
ci_56                 1.766291e-03 3 1  ON 55
ci_57                 1.697780e-03 3 1  ON 56
ci_58                -9.178791e-04 3 1  ON 57
ci_59                -9.144683e-04 3 1  ON 58
ci_60                 5.941041e-04 3 1  ON 59
ci_61                 6.988530e-04 3 1  ON 60
ci_62                -5.161246e-04 3 1  ON 61
ci_63                -6.593001e-04 3 1  ON 62
ci_64                -5.183861e-04 3 1  ON 63
ci_65                -4.192476e-04 3 1  ON 64
ci_66                -7.558509e-04 3 1  ON 65
ci_67                -6.727119e-04 3 1  ON 66
ci_68                -5.302476e-04 3 1  ON 67
ci_69                -3.653120e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4280e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.8322
    reference variance = 0.416819
====================================================
  Execution time = 2.5729e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9446e-01
  Total weights = 1.963863265e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474750095838
                                         uncertainty =       0.002894982424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474750095838
                                         uncertainty =       0.002894982424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487177227
  error estimate for blocks of size 2^( 2) =       0.000508406925
  error estimate for blocks of size 2^( 3) =       0.000528349769
  error estimate for blocks of size 2^( 4) =       0.000543040747
  error estimate for blocks of size 2^( 5) =       0.000551913968
  error estimate for blocks of size 2^( 6) =       0.000556949097
  error estimate for blocks of size 2^( 7) =       0.000557824695

      target function =      -0.710931800099
              le_mean =     -22.818219715906
             les_mean =     521.165614703023
             stat err =       0.000552432127
             autocorr =       1.285831013727
   target nu stat err =       0.000552432127
   target dn stat err =       0.005842206500
      target stat err =       0.004166280725
              std dev =       0.688972641210
             le_variance =       0.474683300336


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281821971591e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710955566738       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710955955327       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710956004531       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710956013254       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710956015872       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710956017039       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710956017415       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710956017404       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710956017364       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710956017361       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 1.797719e-06

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710955566738       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710955663894       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710955676196       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710955678377       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710955679031       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710955679323       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710955679416       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710955679414       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710955679405       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710955679398       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+03 is 4.494533e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.710955566738       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.710955591027       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.710955594103       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.710955594648       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.710955594821       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.710955594885       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710955594905       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.710955594903       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.710955594898       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.710955594905       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+03 is 1.123648e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.808631 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0305e+01
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_01                 1.375029e-01 3 1  ON 0
ci_02                -3.560645e-02 3 1  ON 1
ci_03                -3.547967e-02 3 1  ON 2
ci_04                 3.162157e-02 3 1  ON 3
ci_05                -2.593542e-02 3 1  ON 4
ci_06                -2.549777e-02 3 1  ON 5
ci_07                 2.778762e-02 3 1  ON 6
ci_08                -8.353941e-03 3 1  ON 7
ci_09                -1.083785e-02 3 1  ON 8
ci_10                -1.085744e-02 3 1  ON 9
ci_11                 1.353747e-02 3 1  ON 10
ci_12                 8.712940e-03 3 1  ON 11
ci_13                 1.255381e-02 3 1  ON 12
ci_14                 1.255111e-02 3 1  ON 13
ci_15                 8.045625e-03 3 1  ON 14
ci_16                 8.135991e-03 3 1  ON 15
ci_17                -8.378159e-03 3 1  ON 16
ci_18                -8.050633e-03 3 1  ON 17
ci_19                 9.698866e-03 3 1  ON 18
ci_20                 7.447830e-03 3 1  ON 19
ci_21                 9.049090e-03 3 1  ON 20
ci_22                 9.139535e-03 3 1  ON 21
ci_23                 5.179614e-03 3 1  ON 22
ci_24                 4.718270e-03 3 1  ON 23
ci_25                 3.392733e-03 3 1  ON 24
ci_26                 3.440053e-03 3 1  ON 25
ci_27                 3.461123e-03 3 1  ON 26
ci_28                 2.470626e-03 3 1  ON 27
ci_29                 2.337903e-03 3 1  ON 28
ci_30                -1.975755e-03 3 1  ON 29
ci_31                -2.083584e-03 3 1  ON 30
ci_32                -1.433345e-03 3 1  ON 31
ci_33                -1.469365e-03 3 1  ON 32
ci_34                 1.403543e-03 3 1  ON 33
ci_35                 1.448047e-03 3 1  ON 34
ci_36                -1.311563e-03 3 1  ON 35
ci_37                -1.396028e-03 3 1  ON 36
ci_38                -9.566763e-04 3 1  ON 37
ci_39                -9.541582e-04 3 1  ON 38
ci_40                -1.611202e-03 3 1  ON 39
ci_41                -1.101643e-03 3 1  ON 40
ci_42                -9.565964e-04 3 1  ON 41
ci_43                -2.344691e-03 3 1  ON 42
ci_44                -1.665859e-03 3 1  ON 43
ci_45                -8.274254e-04 3 1  ON 44
ci_46                -7.690673e-04 3 1  ON 45
ci_47                 1.871038e-04 3 1  ON 46
ci_48                 5.109350e-06 3 1  ON 47
ci_49                -1.042257e-03 3 1  ON 48
ci_50                -8.884497e-04 3 1  ON 49
ci_51                 6.560477e-04 3 1  ON 50
ci_52                 5.751232e-04 3 1  ON 51
ci_53                -1.006193e-03 3 1  ON 52
ci_54                -9.526077e-04 3 1  ON 53
ci_55                -6.179740e-04 3 1  ON 54
ci_56                 1.766293e-03 3 1  ON 55
ci_57                 1.697775e-03 3 1  ON 56
ci_58                -9.178820e-04 3 1  ON 57
ci_59                -9.145060e-04 3 1  ON 58
ci_60                 5.940495e-04 3 1  ON 59
ci_61                 6.988309e-04 3 1  ON 60
ci_62                -5.160806e-04 3 1  ON 61
ci_63                -6.592839e-04 3 1  ON 62
ci_64                -5.183883e-04 3 1  ON 63
ci_65                -4.191967e-04 3 1  ON 64
ci_66                -7.557878e-04 3 1  ON 65
ci_67                -6.727276e-04 3 1  ON 66
ci_68                -5.303021e-04 3 1  ON 67
ci_69                -3.654547e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.8157
    reference variance = 0.502721
====================================================
  Execution time = 2.5078e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9202e-01
  Total weights = 1.9635e+06
  Execution time = 3.5870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477535389034
                                         uncertainty =       0.002548987203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477535389034
                                         uncertainty =       0.002548987203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488584533
  error estimate for blocks of size 2^( 2) =       0.000509309394
  error estimate for blocks of size 2^( 3) =       0.000528840180
  error estimate for blocks of size 2^( 4) =       0.000543406307
  error estimate for blocks of size 2^( 5) =       0.000552865724
  error estimate for blocks of size 2^( 6) =       0.000557277824
  error estimate for blocks of size 2^( 7) =       0.000562368021

      target function =      -0.712691941103
              le_mean =     -22.818730839791
             les_mean =     521.186495435674
             stat err =       0.000553979469
             autocorr =       1.285606059503
   target nu stat err =       0.000553979469
   target dn stat err =       0.003037830203
      target stat err =       0.002229183811
              std dev =       0.690962872376
             le_variance =       0.477429691003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477534289391
                                         uncertainty =       0.002548967407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477534289391
                                         uncertainty =       0.002548967407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488583970
  error estimate for blocks of size 2^( 2) =       0.000509308865
  error estimate for blocks of size 2^( 3) =       0.000528839697
  error estimate for blocks of size 2^( 4) =       0.000543405876
  error estimate for blocks of size 2^( 5) =       0.000552865340
  error estimate for blocks of size 2^( 6) =       0.000557277449
  error estimate for blocks of size 2^( 7) =       0.000562367661

      target function =      -0.712690349300
              le_mean =     -22.818730824747
             les_mean =     521.186496987125
             stat err =       0.000553979082
             autocorr =       1.285607220607
   target nu stat err =       0.000553979082
   target dn stat err =       0.003037962085
      target stat err =       0.002229264847
              std dev =       0.690962077274
             le_variance =       0.477428592231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477534839122
                                         uncertainty =       0.002548977303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477534839122
                                         uncertainty =       0.002548977303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488584251
  error estimate for blocks of size 2^( 2) =       0.000509309129
  error estimate for blocks of size 2^( 3) =       0.000528839938
  error estimate for blocks of size 2^( 4) =       0.000543406092
  error estimate for blocks of size 2^( 5) =       0.000552865532
  error estimate for blocks of size 2^( 6) =       0.000557277636
  error estimate for blocks of size 2^( 7) =       0.000562367841

      target function =      -0.712691240761
              le_mean =     -22.818730832268
             les_mean =     521.186496076924
             stat err =       0.000553979275
             autocorr =       1.285606640108
   target nu stat err =       0.000553979275
   target dn stat err =       0.003037894719
      target stat err =       0.002229223926
              std dev =       0.690962474760
             le_variance =       0.477429141526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477535320289
                                         uncertainty =       0.002548985965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477535320289
                                         uncertainty =       0.002548985965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488584497
  error estimate for blocks of size 2^( 2) =       0.000509309361
  error estimate for blocks of size 2^( 3) =       0.000528840150
  error estimate for blocks of size 2^( 4) =       0.000543406280
  error estimate for blocks of size 2^( 5) =       0.000552865700
  error estimate for blocks of size 2^( 6) =       0.000557277800
  error estimate for blocks of size 2^( 7) =       0.000562367998

      target function =      -0.712691862798
              le_mean =     -22.818730838850
             les_mean =     521.186495502830
             stat err =       0.000553979445
             autocorr =       1.285606132084
   target nu stat err =       0.000553979445
   target dn stat err =       0.003037838137
      target stat err =       0.002229188791
              std dev =       0.690962822670
             le_variance =       0.477429622312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.712691941103        initial  <--
     3.7253e+02     3.7253e+03             1.7977e-06        -0.712690349300
     1.4901e+03     1.4901e+04             4.4945e-07        -0.712691240761
     5.9605e+03     5.9605e+04             1.1236e-07        -0.712691862798

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0623
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_01                 1.375033e-01 3 1  ON 0
ci_02                -3.560681e-02 3 1  ON 1
ci_03                -3.548008e-02 3 1  ON 2
ci_04                 3.162191e-02 3 1  ON 3
ci_05                -2.593556e-02 3 1  ON 4
ci_06                -2.549800e-02 3 1  ON 5
ci_07                 2.778763e-02 3 1  ON 6
ci_08                -8.354030e-03 3 1  ON 7
ci_09                -1.083797e-02 3 1  ON 8
ci_10                -1.085739e-02 3 1  ON 9
ci_11                 1.353749e-02 3 1  ON 10
ci_12                 8.713004e-03 3 1  ON 11
ci_13                 1.255379e-02 3 1  ON 12
ci_14                 1.255111e-02 3 1  ON 13
ci_15                 8.045701e-03 3 1  ON 14
ci_16                 8.136218e-03 3 1  ON 15
ci_17                -8.378334e-03 3 1  ON 16
ci_18                -8.050656e-03 3 1  ON 17
ci_19                 9.698921e-03 3 1  ON 18
ci_20                 7.447840e-03 3 1  ON 19
ci_21                 9.049121e-03 3 1  ON 20
ci_22                 9.139511e-03 3 1  ON 21
ci_23                 5.179640e-03 3 1  ON 22
ci_24                 4.718294e-03 3 1  ON 23
ci_25                 3.392730e-03 3 1  ON 24
ci_26                 3.440303e-03 3 1  ON 25
ci_27                 3.461134e-03 3 1  ON 26
ci_28                 2.470715e-03 3 1  ON 27
ci_29                 2.337984e-03 3 1  ON 28
ci_30                -1.975763e-03 3 1  ON 29
ci_31                -2.083639e-03 3 1  ON 30
ci_32                -1.433359e-03 3 1  ON 31
ci_33                -1.469356e-03 3 1  ON 32
ci_34                 1.403515e-03 3 1  ON 33
ci_35                 1.448084e-03 3 1  ON 34
ci_36                -1.311581e-03 3 1  ON 35
ci_37                -1.396071e-03 3 1  ON 36
ci_38                -9.566943e-04 3 1  ON 37
ci_39                -9.541763e-04 3 1  ON 38
ci_40                -1.611200e-03 3 1  ON 39
ci_41                -1.101654e-03 3 1  ON 40
ci_42                -9.565470e-04 3 1  ON 41
ci_43                -2.344666e-03 3 1  ON 42
ci_44                -1.665895e-03 3 1  ON 43
ci_45                -8.273765e-04 3 1  ON 44
ci_46                -7.691000e-04 3 1  ON 45
ci_47                 1.870703e-04 3 1  ON 46
ci_48                 5.075755e-06 3 1  ON 47
ci_49                -1.042219e-03 3 1  ON 48
ci_50                -8.884649e-04 3 1  ON 49
ci_51                 6.560646e-04 3 1  ON 50
ci_52                 5.751894e-04 3 1  ON 51
ci_53                -1.006230e-03 3 1  ON 52
ci_54                -9.526648e-04 3 1  ON 53
ci_55                -6.179618e-04 3 1  ON 54
ci_56                 1.766291e-03 3 1  ON 55
ci_57                 1.697780e-03 3 1  ON 56
ci_58                -9.178791e-04 3 1  ON 57
ci_59                -9.144683e-04 3 1  ON 58
ci_60                 5.941041e-04 3 1  ON 59
ci_61                 6.988530e-04 3 1  ON 60
ci_62                -5.161246e-04 3 1  ON 61
ci_63                -6.593001e-04 3 1  ON 62
ci_64                -5.183861e-04 3 1  ON 63
ci_65                -4.192476e-04 3 1  ON 64
ci_66                -7.558509e-04 3 1  ON 65
ci_67                -6.727119e-04 3 1  ON 66
ci_68                -5.302476e-04 3 1  ON 67
ci_69                -3.653120e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3373e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.9207
    reference variance = 0.745546
====================================================
  Execution time = 2.5901e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5321e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 5.0017e-01
  Total weights = 1.963607076e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478619620266
                                         uncertainty =       0.003208322322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478619620266
                                         uncertainty =       0.003208322322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489182805
  error estimate for blocks of size 2^( 2) =       0.000510355470
  error estimate for blocks of size 2^( 3) =       0.000530762381
  error estimate for blocks of size 2^( 4) =       0.000545571124
  error estimate for blocks of size 2^( 5) =       0.000554673904
  error estimate for blocks of size 2^( 6) =       0.000559734834
  error estimate for blocks of size 2^( 7) =       0.000560906119

      target function =      -0.706901062503
              le_mean =     -22.817796975215
             les_mean =     521.152031852349
             stat err =       0.000555221495
             autocorr =       1.288220414819
   target nu stat err =       0.000555221495
   target dn stat err =       0.007311607127
      target stat err =       0.005136656830
              std dev =       0.691808956892
             le_variance =       0.478599632835


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281779697522e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706937529935       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706937556835       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706937561804       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706937562702       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706937563105       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706937563168       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.706937563164       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.706937563166       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.706937563156       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.706937563157       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+03 is 1.774142e-07

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706937529935       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706937536661       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706937537903       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706937538126       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706937538228       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706937538244       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.706937538243       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.706937538242       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.706937538226       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.706937538241       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+04 is 4.435378e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -2.3533e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.706937529935       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.706937531617       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.706937531927       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.706937531983       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.706937532097       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.706937532076       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.706937532000       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.706937532146       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.706937532050       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.706937532012       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+04 is 1.108846e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.812135 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0473e+01
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_01                 1.375033e-01 3 1  ON 0
ci_02                -3.560678e-02 3 1  ON 1
ci_03                -3.548005e-02 3 1  ON 2
ci_04                 3.162188e-02 3 1  ON 3
ci_05                -2.593554e-02 3 1  ON 4
ci_06                -2.549798e-02 3 1  ON 5
ci_07                 2.778762e-02 3 1  ON 6
ci_08                -8.354013e-03 3 1  ON 7
ci_09                -1.083795e-02 3 1  ON 8
ci_10                -1.085738e-02 3 1  ON 9
ci_11                 1.353748e-02 3 1  ON 10
ci_12                 8.712995e-03 3 1  ON 11
ci_13                 1.255379e-02 3 1  ON 12
ci_14                 1.255111e-02 3 1  ON 13
ci_15                 8.045692e-03 3 1  ON 14
ci_16                 8.136214e-03 3 1  ON 15
ci_17                -8.378329e-03 3 1  ON 16
ci_18                -8.050646e-03 3 1  ON 17
ci_19                 9.698919e-03 3 1  ON 18
ci_20                 7.447833e-03 3 1  ON 19
ci_21                 9.049121e-03 3 1  ON 20
ci_22                 9.139507e-03 3 1  ON 21
ci_23                 5.179637e-03 3 1  ON 22
ci_24                 4.718286e-03 3 1  ON 23
ci_25                 3.392728e-03 3 1  ON 24
ci_26                 3.440300e-03 3 1  ON 25
ci_27                 3.461137e-03 3 1  ON 26
ci_28                 2.470711e-03 3 1  ON 27
ci_29                 2.337980e-03 3 1  ON 28
ci_30                -1.975764e-03 3 1  ON 29
ci_31                -2.083638e-03 3 1  ON 30
ci_32                -1.433358e-03 3 1  ON 31
ci_33                -1.469352e-03 3 1  ON 32
ci_34                 1.403511e-03 3 1  ON 33
ci_35                 1.448082e-03 3 1  ON 34
ci_36                -1.311580e-03 3 1  ON 35
ci_37                -1.396069e-03 3 1  ON 36
ci_38                -9.566920e-04 3 1  ON 37
ci_39                -9.541738e-04 3 1  ON 38
ci_40                -1.611198e-03 3 1  ON 39
ci_41                -1.101653e-03 3 1  ON 40
ci_42                -9.565464e-04 3 1  ON 41
ci_43                -2.344662e-03 3 1  ON 42
ci_44                -1.665896e-03 3 1  ON 43
ci_45                -8.273769e-04 3 1  ON 44
ci_46                -7.690973e-04 3 1  ON 45
ci_47                 1.870719e-04 3 1  ON 46
ci_48                 5.078843e-06 3 1  ON 47
ci_49                -1.042216e-03 3 1  ON 48
ci_50                -8.884641e-04 3 1  ON 49
ci_51                 6.560612e-04 3 1  ON 50
ci_52                 5.751879e-04 3 1  ON 51
ci_53                -1.006227e-03 3 1  ON 52
ci_54                -9.526643e-04 3 1  ON 53
ci_55                -6.179618e-04 3 1  ON 54
ci_56                 1.766294e-03 3 1  ON 55
ci_57                 1.697781e-03 3 1  ON 56
ci_58                -9.178751e-04 3 1  ON 57
ci_59                -9.144700e-04 3 1  ON 58
ci_60                 5.941018e-04 3 1  ON 59
ci_61                 6.988520e-04 3 1  ON 60
ci_62                -5.161267e-04 3 1  ON 61
ci_63                -6.592991e-04 3 1  ON 62
ci_64                -5.183853e-04 3 1  ON 63
ci_65                -4.192457e-04 3 1  ON 64
ci_66                -7.558525e-04 3 1  ON 65
ci_67                -6.727125e-04 3 1  ON 66
ci_68                -5.302503e-04 3 1  ON 67
ci_69                -3.653175e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.9152
    reference variance = 0.489166
====================================================
  Execution time = 2.5104e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8763e-01
  Total weights = 1.9636e+06
  Execution time = 3.5960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471965559622
                                         uncertainty =       0.002311092960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471965559622
                                         uncertainty =       0.002311092960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485779032
  error estimate for blocks of size 2^( 2) =       0.000506399674
  error estimate for blocks of size 2^( 3) =       0.000526180144
  error estimate for blocks of size 2^( 4) =       0.000540807529
  error estimate for blocks of size 2^( 5) =       0.000550705191
  error estimate for blocks of size 2^( 6) =       0.000556257598
  error estimate for blocks of size 2^( 7) =       0.000560812946

      target function =      -0.715813831023
              le_mean =     -22.818416026307
             les_mean =     521.167744975386
             stat err =       0.000552145816
             autocorr =       1.291903397932
   target nu stat err =       0.000552145816
   target dn stat err =       0.003174025604
      target stat err =       0.002341463382
              std dev =       0.686995295539
             le_variance =       0.471962536093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471965459854
                                         uncertainty =       0.002311089744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471965459854
                                         uncertainty =       0.002311089744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485778981
  error estimate for blocks of size 2^( 2) =       0.000506399626
  error estimate for blocks of size 2^( 3) =       0.000526180100
  error estimate for blocks of size 2^( 4) =       0.000540807488
  error estimate for blocks of size 2^( 5) =       0.000550705152
  error estimate for blocks of size 2^( 6) =       0.000556257558
  error estimate for blocks of size 2^( 7) =       0.000560812906

      target function =      -0.715813991356
              le_mean =     -22.818416026326
             les_mean =     521.167744752612
             stat err =       0.000552145776
             autocorr =       1.291903484374
   target nu stat err =       0.000552145776
   target dn stat err =       0.003174022280
      target stat err =       0.002341462078
              std dev =       0.686995222909
             le_variance =       0.471962436300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471965509737
                                         uncertainty =       0.002311091352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471965509737
                                         uncertainty =       0.002311091352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485779006
  error estimate for blocks of size 2^( 2) =       0.000506399650
  error estimate for blocks of size 2^( 3) =       0.000526180122
  error estimate for blocks of size 2^( 4) =       0.000540807508
  error estimate for blocks of size 2^( 5) =       0.000550705171
  error estimate for blocks of size 2^( 6) =       0.000556257578
  error estimate for blocks of size 2^( 7) =       0.000560812926

      target function =      -0.715813911265
              le_mean =     -22.818416026316
             les_mean =     521.167744863891
             stat err =       0.000552145796
             autocorr =       1.291903441151
   target nu stat err =       0.000552145796
   target dn stat err =       0.003174023940
      target stat err =       0.002341462729
              std dev =       0.686995259224
             le_variance =       0.471962486196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471965553386
                                         uncertainty =       0.002311092759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471965553386
                                         uncertainty =       0.002311092759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485779029
  error estimate for blocks of size 2^( 2) =       0.000506399671
  error estimate for blocks of size 2^( 3) =       0.000526180142
  error estimate for blocks of size 2^( 4) =       0.000540807526
  error estimate for blocks of size 2^( 5) =       0.000550705189
  error estimate for blocks of size 2^( 6) =       0.000556257596
  error estimate for blocks of size 2^( 7) =       0.000560812943

      target function =      -0.715813841061
              le_mean =     -22.818416026308
             les_mean =     521.167744961437
             stat err =       0.000552145813
             autocorr =       1.291903403327
   target nu stat err =       0.000552145813
   target dn stat err =       0.003174025396
      target stat err =       0.002341463301
              std dev =       0.686995291000
             le_variance =       0.471962529856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.715813831023        initial
     3.7253e+03     3.7253e+04             1.7741e-07        -0.715813991356  <--
     1.4901e+04     1.4901e+05             4.4354e-08        -0.715813911265
     5.9605e+04     5.9605e+05             1.1088e-08        -0.715813841061

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 4.3176e+01
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_01                 1.375031e-01 3 1  ON 0
ci_02                -3.560669e-02 3 1  ON 1
ci_03                -3.547994e-02 3 1  ON 2
ci_04                 3.162178e-02 3 1  ON 3
ci_05                -2.593548e-02 3 1  ON 4
ci_06                -2.549792e-02 3 1  ON 5
ci_07                 2.778761e-02 3 1  ON 6
ci_08                -8.353963e-03 3 1  ON 7
ci_09                -1.083792e-02 3 1  ON 8
ci_10                -1.085735e-02 3 1  ON 9
ci_11                 1.353746e-02 3 1  ON 10
ci_12                 8.712966e-03 3 1  ON 11
ci_13                 1.255378e-02 3 1  ON 12
ci_14                 1.255110e-02 3 1  ON 13
ci_15                 8.045663e-03 3 1  ON 14
ci_16                 8.136199e-03 3 1  ON 15
ci_17                -8.378314e-03 3 1  ON 16
ci_18                -8.050619e-03 3 1  ON 17
ci_19                 9.698915e-03 3 1  ON 18
ci_20                 7.447811e-03 3 1  ON 19
ci_21                 9.049122e-03 3 1  ON 20
ci_22                 9.139494e-03 3 1  ON 21
ci_23                 5.179626e-03 3 1  ON 22
ci_24                 4.718261e-03 3 1  ON 23
ci_25                 3.392722e-03 3 1  ON 24
ci_26                 3.440293e-03 3 1  ON 25
ci_27                 3.461143e-03 3 1  ON 26
ci_28                 2.470699e-03 3 1  ON 27
ci_29                 2.337967e-03 3 1  ON 28
ci_30                -1.975767e-03 3 1  ON 29
ci_31                -2.083635e-03 3 1  ON 30
ci_32                -1.433355e-03 3 1  ON 31
ci_33                -1.469342e-03 3 1  ON 32
ci_34                 1.403501e-03 3 1  ON 33
ci_35                 1.448078e-03 3 1  ON 34
ci_36                -1.311580e-03 3 1  ON 35
ci_37                -1.396062e-03 3 1  ON 36
ci_38                -9.566852e-04 3 1  ON 37
ci_39                -9.541661e-04 3 1  ON 38
ci_40                -1.611192e-03 3 1  ON 39
ci_41                -1.101652e-03 3 1  ON 40
ci_42                -9.565446e-04 3 1  ON 41
ci_43                -2.344651e-03 3 1  ON 42
ci_44                -1.665900e-03 3 1  ON 43
ci_45                -8.273778e-04 3 1  ON 44
ci_46                -7.690893e-04 3 1  ON 45
ci_47                 1.870766e-04 3 1  ON 46
ci_48                 5.088104e-06 3 1  ON 47
ci_49                -1.042209e-03 3 1  ON 48
ci_50                -8.884619e-04 3 1  ON 49
ci_51                 6.560510e-04 3 1  ON 50
ci_52                 5.751832e-04 3 1  ON 51
ci_53                -1.006218e-03 3 1  ON 52
ci_54                -9.526629e-04 3 1  ON 53
ci_55                -6.179619e-04 3 1  ON 54
ci_56                 1.766303e-03 3 1  ON 55
ci_57                 1.697784e-03 3 1  ON 56
ci_58                -9.178631e-04 3 1  ON 57
ci_59                -9.144749e-04 3 1  ON 58
ci_60                 5.940949e-04 3 1  ON 59
ci_61                 6.988488e-04 3 1  ON 60
ci_62                -5.161330e-04 3 1  ON 61
ci_63                -6.592959e-04 3 1  ON 62
ci_64                -5.183830e-04 3 1  ON 63
ci_65                -4.192400e-04 3 1  ON 64
ci_66                -7.558575e-04 3 1  ON 65
ci_67                -6.727144e-04 3 1  ON 66
ci_68                -5.302583e-04 3 1  ON 67
ci_69                -3.653338e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3655e+01 secs
  Total Execution time = 7.3986e+03 secs

=========================================================
  A new xml input file : FORM.s099.cont.xml
